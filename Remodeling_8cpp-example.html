<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Remodeling.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Remodeling.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Integration points are taken from OOFEM <a href="http://www.oofem.org/resources/doc/oofemrefman/microplanematerial_8C_source.html">http://www.oofem.org/resources/doc/oofemrefman/microplanematerial_8C_source.html</a></p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file Remodeling.cpp</span></div>
<div class="line"><span class="comment"> * \example Remodeling.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brief Integration points are taken from OOFEM</span></div>
<div class="line"><span class="comment"> * &lt;http://www.oofem.org/resources/doc/oofemrefman/microplanematerial_8C_source.html&gt;</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/*</span></div>
<div class="line"><span class="comment"> * This file is part of MoFEM.</span></div>
<div class="line"><span class="comment"> * MoFEM is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><span class="comment"> * the terms of the GNU Lesser General Public License as published by the</span></div>
<div class="line"><span class="comment"> * Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><span class="comment"> * option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * MoFEM is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> * License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> * License along with MoFEM. If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;boost/program_options.hpp&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespacestd.html">std</a>;</div>
<div class="line"><span class="keyword">namespace </span>po = boost::program_options;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ElasticMaterials_8hpp.html">ElasticMaterials.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="Remodeling_8hpp.html">Remodeling.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef WITH_ADOL_C</span></div>
<div class="line"><span class="preprocessor">#error &quot;MoFEM need to be compiled with ADOL-C&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TENSOR1_VEC_PTR(VEC) &amp;VEC[0], &amp;VEC[1], &amp;VEC[2]</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SYMMETRIC_TENSOR4_MAT_PTR(MAT)                                         \</span></div>
<div class="line"><span class="preprocessor">  &amp;MAT(0, 0), &amp;MAT(0, 1), &amp;MAT(0, 2), &amp;MAT(0, 3), &amp;MAT(0, 4), &amp;MAT(0, 5),      \</span></div>
<div class="line"><span class="preprocessor">      &amp;MAT(1, 0), &amp;MAT(1, 1), &amp;MAT(1, 2), &amp;MAT(1, 3), &amp;MAT(1, 4), &amp;MAT(1, 5),  \</span></div>
<div class="line"><span class="preprocessor">      &amp;MAT(2, 0), &amp;MAT(2, 1), &amp;MAT(2, 2), &amp;MAT(2, 3), &amp;MAT(2, 4), &amp;MAT(2, 5),  \</span></div>
<div class="line"><span class="preprocessor">      &amp;MAT(3, 0), &amp;MAT(3, 1), &amp;MAT(3, 2), &amp;MAT(3, 3), &amp;MAT(3, 4), &amp;MAT(3, 5),  \</span></div>
<div class="line"><span class="preprocessor">      &amp;MAT(4, 0), &amp;MAT(4, 1), &amp;MAT(4, 2), &amp;MAT(4, 3), &amp;MAT(4, 4), &amp;MAT(4, 5),  \</span></div>
<div class="line"><span class="preprocessor">      &amp;MAT(5, 0), &amp;MAT(5, 1), &amp;MAT(5, 2), &amp;MAT(5, 3), &amp;MAT(5, 4), &amp;MAT(5, 5)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TENSOR4_MAT_PTR(MAT) &amp;MAT(0, 0), MAT.size2()</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define TENSOR2_MAT_PTR(MAT)                                                   \</span></div>
<div class="line"><span class="preprocessor">  &amp;MAT(0, 0), &amp;MAT(1, 0), &amp;MAT(2, 0), &amp;MAT(3, 0), &amp;MAT(4, 0), &amp;MAT(5, 0),      \</span></div>
<div class="line"><span class="preprocessor">      &amp;MAT(6, 0), &amp;MAT(7, 0), &amp;MAT(8, 0)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SYMMETRIC_TENSOR2_MAT_PTR(MAT)                                         \</span></div>
<div class="line"><span class="preprocessor">  &amp;MAT(0, 0), &amp;MAT(0, 1), &amp;MAT(0, 2), &amp;MAT(0, 3), &amp;MAT(0, 4), &amp;MAT(0, 5)</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SYMMETRIC_TENSOR2_VEC_PTR(VEC)                                         \</span></div>
<div class="line"><span class="preprocessor">  &amp;VEC[0], &amp;VEC[1], &amp;VEC[2], &amp;VEC[3], &amp;VEC[4], &amp;VEC[5]</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceBoneRemodeling.html">BoneRemodeling</a> {</div>
<div class="line"> </div>
<div class="line"><a name="a0"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::CommonData::getParameters() {</div>
<div class="line"> </div>
<div class="line">  PetscBool flg_config = PETSC_FALSE;</div>
<div class="line">  is_atom_testing = PETSC_FALSE;</div>
<div class="line">  with_adol_c = PETSC_FALSE;</div>
<div class="line">  <span class="keywordtype">char</span> my_config_file_name[255];</div>
<div class="line">  <span class="keywordtype">double</span> <a name="a1"></a><a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a> = 5.0e+9; <span class="comment">// Set here some typical value for bone 5 GPa</span></div>
<div class="line">  <span class="keywordtype">double</span> <a name="a2"></a><a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a> = 0.3;    <span class="comment">// Set here some typical value for bone</span></div>
<div class="line">  <a name="a3"></a><a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = 4.0e-5;       <span class="comment">// Set here some typical value for bone. days/ m2 // this</span></div>
<div class="line">                    <span class="comment">// parameters governs how fast we can achieve equilibrium</span></div>
<div class="line">  <a name="a4"></a><a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = 3.25;         <span class="comment">// Set some parameter typical for bone</span></div>
<div class="line">  <a name="a5"></a><a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = 2.25;         <span class="comment">// Set Some parameter typical for bone</span></div>
<div class="line">  rHo_ref = 1000;   <span class="comment">// Set Some parameter typical for bone. kg/m3</span></div>
<div class="line">  pSi_ref = 2.75e4; <span class="comment">// Set Some parameter typical for bone. energy / volume unit</span></div>
<div class="line">                    <span class="comment">// J/m3 = Pa</span></div>
<div class="line">  rHo_max = rHo_ref + 0.5 * rHo_ref;</div>
<div class="line">  rHo_min = rHo_ref - 0.5 * rHo_ref;</div>
<div class="line">  b = 0;</div>
<div class="line">  R0 = 0.0; <span class="comment">// Set Some parameter typical for bone.</span></div>
<div class="line">  cUrrent_psi = 0.0;</div>
<div class="line">  cUrrent_mass = 0.0;</div>
<div class="line">  nOremodellingBlock = <span class="keyword">false</span>;</div>
<div class="line">  less_post_proc = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <a name="a6"></a><a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a name="a7"></a><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Bone remodeling parameters&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// config file</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_config&quot;</span>, <span class="stringliteral">&quot;configuration file name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;my_config.in&quot;</span>, my_config_file_name, 255,</div>
<div class="line">                            &amp;flg_config);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (flg_config) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Config file: %s loaded.\n&quot;</span>,</div>
<div class="line">                       my_config_file_name);</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line">      ifstream ini_file(my_config_file_name);</div>
<div class="line">      <span class="keywordflow">if</span> (!ini_file.is_open()) {</div>
<div class="line">        SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;*** -my_config does not exist ***&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      po::variables_map vm;</div>
<div class="line">      po::options_description config_file_options;</div>
<div class="line">      <span class="comment">// std::cout &lt;&lt; my_config_file_name &lt;&lt; std::endl;</span></div>
<div class="line"> </div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;young_modulus&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;poisson_ratio&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;c&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;m&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;n&quot;</span>, po::value&lt;double&gt;(&amp;<a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;rHo_ref&quot;</span>, po::value&lt;double&gt;(&amp;rHo_ref)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;pSi_ref&quot;</span>, po::value&lt;double&gt;(&amp;pSi_ref)-&gt;default_value(1));</div>
<div class="line">      config_file_options.add_options()(</div>
<div class="line">          <span class="stringliteral">&quot;R0&quot;</span>, po::value&lt;double&gt;(&amp;R0)-&gt;default_value(1));</div>
<div class="line"> </div>
<div class="line">      po::parsed_options parsed =</div>
<div class="line">          parse_config_file(ini_file, config_file_options, <span class="keyword">true</span>);</div>
<div class="line">      store(parsed, vm);</div>
<div class="line">      po::notify(vm);</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception &amp;ex) {</div>
<div class="line">      std::ostringstream ss;</div>
<div class="line">      ss &lt;&lt; ex.what() &lt;&lt; std::endl;</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a name="a8"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a>, ss.str().c_str());</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-young_modulus&quot;</span>, <span class="stringliteral">&quot;get young modulus&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, &amp;<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-poisson_ratio&quot;</span>, <span class="stringliteral">&quot;get poisson_ratio&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>, &amp;<a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-c&quot;</span>, <span class="stringliteral">&quot;density evolution (growth) velocity [d/m^2]&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, &amp;<a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-m&quot;</span>, <span class="stringliteral">&quot;algorithmic exponent&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>,</div>
<div class="line">                            PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-n&quot;</span>, <span class="stringliteral">&quot;porosity exponent&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>, &amp;<a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-b&quot;</span>, <span class="stringliteral">&quot;bell function exponent&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, b, &amp;b, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-rho_ref&quot;</span>, <span class="stringliteral">&quot;reference bone density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, rHo_ref,</div>
<div class="line">                            &amp;rHo_ref, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-rho_max&quot;</span>, <span class="stringliteral">&quot;reference bone density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, rHo_max,</div>
<div class="line">                            &amp;rHo_max, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-rho_min&quot;</span>, <span class="stringliteral">&quot;reference bone density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, rHo_min,</div>
<div class="line">                            &amp;rHo_min, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-psi_ref&quot;</span>, <span class="stringliteral">&quot;reference energy density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, pSi_ref,</div>
<div class="line">                            &amp;pSi_ref, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-r0&quot;</span>, <span class="stringliteral">&quot;mass source&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, R0, &amp;R0, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_is_atom_test&quot;</span>,</div>
<div class="line">                          <span class="stringliteral">&quot;is used with testing, exit with error when diverged&quot;</span>,</div>
<div class="line">                          <span class="stringliteral">&quot;&quot;</span>, is_atom_testing, &amp;is_atom_testing, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-less_post_proc&quot;</span>,</div>
<div class="line">                          <span class="stringliteral">&quot;is used to reduce output file size&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          less_post_proc, &amp;less_post_proc, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line">      <span class="stringliteral">&quot;-with_adolc&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;calculate the material tangent with automatic differentiation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      with_adol_c, &amp;with_adol_c, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a name="a9"></a><a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = <a name="a10"></a><a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line">  <a name="a11"></a><a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = <a name="a12"></a><a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Young&#39;s modulus E[Pa]:                %4.3g\n&quot;</span>,</div>
<div class="line">                     <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Poisson ratio nu[-]                   %4.3g\n&quot;</span>,</div>
<div class="line">                     <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Lame coefficient lambda[Pa]:          %4.3g\n&quot;</span>, <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Lame coefficient mu[Pa]:              %4.3g\n&quot;</span>, <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Density growth velocity [d/m2]        %4.3g\n&quot;</span>, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Algorithmic exponent m[-]:            %4.3g\n&quot;</span>, <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Porosity exponent n[-]:               %4.3g\n&quot;</span>, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Reference density rHo_ref[kg/m3]:     %4.3g\n&quot;</span>, rHo_ref);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Reference energy pSi_ref[Pa]:         %4.3g\n&quot;</span>, pSi_ref);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Mass conduction R0[kg/m3s]:           %4.3g\n&quot;</span>, R0);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                     <span class="stringliteral">&quot;Bell function coefficent b[-]:        %4.3g\n&quot;</span>, b);</div>
<div class="line">  <span class="keywordflow">if</span> (b != 0) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                       <span class="stringliteral">&quot;Max density rHo_max[kg/m3]:         %4.3g\n&quot;</span>, rHo_max);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                       <span class="stringliteral">&quot;Min density rHo_min[kg/m3]:         %4.3g\n&quot;</span>, rHo_min);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a name="a13"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line">  CHKERRQ(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"> </div>
<div class="line">  <a name="a14"></a><a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">double</span> Remodeling::CommonData::getCFromDensity(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a name="a15"></a><a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) {</div>
<div class="line">  <span class="keywordtype">double</span> mid_rho = 0.5 * (rHo_max + rHo_min);</div>
<div class="line">  <span class="keywordtype">double</span> var_h = (<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> - mid_rho) / (rHo_max - mid_rho);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 1 / (1 + (b != 0) * pow(var_h, 2 * b));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">double</span> Remodeling::CommonData::getCFromDensityDiff(<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) {</div>
<div class="line">  <span class="keywordtype">double</span> mid_rho = 0.5 * (rHo_max + rHo_min);</div>
<div class="line">  <span class="keywordtype">double</span> var_h = (<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> - mid_rho) / (rHo_max - mid_rho);</div>
<div class="line">  <span class="keywordflow">return</span> (b != 0) * (-2) * b * pow(var_h, 2 * b - 1) /</div>
<div class="line">         ((rHo_max - mid_rho) * pow(pow(var_h, 2 * b) + 1, 2));</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpGetRhoTimeDirevative::OpGetRhoTimeDirevative(</div>
<div class="line">    Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a name="a16"></a><a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;RHO&quot;</span>, <a name="a17"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpGetRhoTimeDirevative::doWork(<span class="keywordtype">int</span> side, EntityType <a name="a18"></a><a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                               <a name="a19"></a><a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">  <span class="keywordflow">if</span> (!nb_gauss_pts)</div>
<div class="line">    <a name="a20"></a><a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = data.getN().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> base_function = data.getFTensor0N();</div>
<div class="line">  commonData.data.vecRhoDt.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBVERTEX) {</div>
<div class="line">    commonData.data.vecRhoDt.clear();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (nb_dofs == 0)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keywordtype">double</span> *array;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArray(getFEMethod()-&gt;ts_u_t, &amp;array);</div>
<div class="line">  <span class="keyword">auto</span> drho_dt = <a name="a21"></a><a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecRhoDt);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg &lt; nb_gauss_pts; gg++) {</div>
<div class="line">    <span class="keywordtype">int</span> bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; bb &lt; nb_dofs; bb++) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> field_data = array[data.getLocalIndices()[bb]];</div>
<div class="line">      drho_dt += field_data * base_function;</div>
<div class="line">      ++base_function;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// It is possible to have more base functions than dofs</span></div>
<div class="line">    <span class="keywordflow">for</span> (; bb != nb_base_functions; bb++)</div>
<div class="line">      ++base_function;</div>
<div class="line">    ++drho_dt;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArray(getFEMethod()-&gt;ts_u_t, &amp;array);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a name="a22"></a><a class="code" href="structOpCalculateStress.html#aa8fb336855ab8b3de4fa7c8d739a0728">OpCalculateStress::OpCalculateStress</a>(Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line">  doVertices = <span class="keyword">true</span>;</div>
<div class="line">  doEdges = <span class="keyword">false</span>;</div>
<div class="line">  doQuads = <span class="keyword">false</span>;</div>
<div class="line">  doTris = <span class="keyword">false</span>;</div>
<div class="line">  doTets = <span class="keyword">false</span>;</div>
<div class="line">  doPrisms = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a name="a23"></a><a class="code" href="structOpCalculateStress.html#a9bc89d8801014833b9aebda666bac8ed">OpCalculateStress::doWork</a>(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                          <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> != MBVERTEX)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(9);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!commonData.data.gradDispPtr) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a name="a24"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Gradient at integration points of displacement is not calculated&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">auto</span> grad = getFTensor2FromMat&lt;3, 3&gt;(*commonData.data.gradDispPtr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line">  <span class="keywordflow">if</span> (!commonData.data.rhoPtr) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Density at integration points is not calculated&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"> </div>
<div class="line">  commonData.data.vecPsi.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> psi = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line">  commonData.data.vecR.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> <a name="a25"></a><a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecR);</div>
<div class="line"> </div>
<div class="line">  commonData.data.matInvF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> invF = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matInvF);</div>
<div class="line">  commonData.data.vecDetF.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> det_f = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecDetF);</div>
<div class="line">  <a name="a26"></a><a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line">  matS.resize(nb_gauss_pts, 6, <span class="keyword">false</span>);</div>
<div class="line">  <a name="_a27"></a><a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a name="a28"></a><a class="code" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line">  commonData.data.matP.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> <a name="a29"></a><a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matF = commonData.data.matGradientOfDeformation;</div>
<div class="line">  matF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <a name="_a30"></a><a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> <a name="a31"></a><a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a name="a32"></a><a class="code" href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(matF));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = commonData.c;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = commonData.n;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = commonData.m;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> psi_ref = commonData.pSi_ref;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = commonData.lambda;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = commonData.mu;</div>
<div class="line">  <a name="_a33"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a name="a34"></a><a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a name="_a35"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a name="a36"></a><a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'J', 3&gt;</a> <a name="a37"></a><a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get deformation gradient</span></div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(0, 0) += 1;</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(1, 1) += 1;</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(2, 2) += 1;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a38"></a><a class="code" href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">determinantTensor3by3</a>(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a39"></a><a class="code" href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f, invF);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> log_det = log(det_f);</div>
<div class="line">    psi = <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) - 3 - 2 * log_det;</div>
<div class="line">    psi *= 0.5 * <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    psi += 0.5 * <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det * log_det;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> coef = <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det - <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> * <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) + coef * invF(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    S(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = invF(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) ^ <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> kp = commonData.getCFromDensity(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp * (pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> - <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * psi - psi_ref);</div>
<div class="line"> </div>
<div class="line">    ++det_f;</div>
<div class="line">    ++invF;</div>
<div class="line">    ++grad;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++psi;</div>
<div class="line">    ++S;</div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    ++<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line">    ++<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpCalculateStressTangentWithAdolc::OpCalculateStressTangentWithAdolc(</div>
<div class="line">    Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line">  doVertices = <span class="keyword">true</span>;</div>
<div class="line">  doEdges = <span class="keyword">false</span>;</div>
<div class="line">  doQuads = <span class="keyword">false</span>;</div>
<div class="line">  doTris = <span class="keyword">false</span>;</div>
<div class="line">  doTets = <span class="keyword">false</span>;</div>
<div class="line">  doPrisms = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpCalculateStressTangentWithAdolc::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> != MBVERTEX)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> grad = getFTensor2FromMat&lt;3, 3&gt;(*commonData.data.gradDispPtr);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line"> </div>
<div class="line">  vecC.resize(6, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> C(<a name="a40"></a><a class="code" href="Remodeling_8cpp.html#a0a80843c43c1fe98a79754f2051a2001">SYMMETRIC_TENSOR2_VEC_PTR</a>(vecC));</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;dS_dC = commonData.data.matMaterialTangent;</div>
<div class="line">  dS_dC.resize(6, 6 * nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  dS_dC.clear();</div>
<div class="line">  <a name="_a41"></a><a class="code" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;double *, 3, 3&gt;</a> D1(<a name="a42"></a><a class="code" href="Remodeling_8cpp.html#a882b61442aebc50fe467fe15a09ee85c">SYMMETRIC_TENSOR4_MAT_PTR</a>(dS_dC), 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line">  matS.resize(nb_gauss_pts, 6, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;dP_dF = commonData.data.matPushedMaterialTangent;</div>
<div class="line">  dP_dF.resize(81, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matF = commonData.data.matGradientOfDeformation;</div>
<div class="line">  matF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(matF));</div>
<div class="line">  <a name="_a43"></a><a class="code" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double *, 3, 3, 3, 3&gt;</a> D2(<a name="a44"></a><a class="code" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(dP_dF));</div>
<div class="line">  commonData.data.matP.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line">  commonData.data.vecPsi.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> psi = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a name="_a45"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a name="a46"></a><a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'J', 3&gt;</a> <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'K', 3&gt;</a> <a name="a47"></a><a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'L', 3&gt;</a> <a name="a48"></a><a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get deformation gradient</span></div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(0, 0) += 1;</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(1, 1) += 1;</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(2, 2) += 1;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Calculate Green defamation Tensor0</span></div>
<div class="line">    <span class="comment">// ^ that means multiplication of Tensor 2 which result in symmetric Tensor</span></div>
<div class="line">    <span class="comment">// rank 2.</span></div>
<div class="line">    C(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) ^ <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Calculate free energy</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> recordFreeEnergy_dC&lt;FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;&gt;,</div>
<div class="line">                               <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a>&gt;(</div>
<div class="line">        commonData, C, psi);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> r_g = ::gradient(commonData.tAg, 6, &amp;vecC[0], &amp;matS(gg, 0));</div>
<div class="line">    <span class="keywordflow">if</span> (r_g &lt; 0) {</div>
<div class="line">      <span class="comment">// That means that energy function is not smooth and derivative</span></div>
<div class="line">      <span class="comment">// can not be calculated,</span></div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a name="a49"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>,</div>
<div class="line">              <span class="stringliteral">&quot;ADOL-C function evaluation with error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Scale energy density and 2nd Piola Stress</span></div>
<div class="line">    S(0, 0) *= 2;</div>
<div class="line">    S(1, 1) *= 2;</div>
<div class="line">    S(2, 2) *= 2;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Calculate 1st Piola-Stress tensor</span></div>
<div class="line">    <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * S(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> is = 6 * gg;</div>
<div class="line">    <span class="keywordtype">double</span> *hessian_ptr[6] = {&amp;dS_dC(0, is), &amp;dS_dC(1, is), &amp;dS_dC(2, is),</div>
<div class="line">                              &amp;dS_dC(3, is), &amp;dS_dC(4, is), &amp;dS_dC(5, is)};</div>
<div class="line">    <span class="keywordtype">int</span> r_h = ::hessian(commonData.tAg, 6, &amp;vecC[0], hessian_ptr);</div>
<div class="line">    <span class="keywordflow">if</span> (r_h &lt; 0) {</div>
<div class="line">      <span class="comment">// That means that energy function is not smooth and derivative</span></div>
<div class="line">      <span class="comment">// can not be calculated,</span></div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>,</div>
<div class="line">              <span class="stringliteral">&quot;ADOL-C function evaluation with error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// FIXME: TODO: Here tensor 4 with two minor symmetries is used, since</span></div>
<div class="line">    <span class="comment">// \psi_{,ijkl} = \psi_{,klij} = \psi_{,lkji} = ... there is additional</span></div>
<div class="line">    <span class="comment">// major symmetry. That is 21 independent components not 36 how is now</span></div>
<div class="line">    <span class="comment">// implemented using Tenso4_ddg.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// That way we have to fill off-diagonal part for dS_dC. In future that</span></div>
<div class="line">    <span class="comment">// need to be fixed by implementation of Tenso4 with additional major</span></div>
<div class="line">    <span class="comment">// symmetries. Pleas consider doing such implementation by yourself. You</span></div>
<div class="line">    <span class="comment">// have support of MoFEM developing team to guide you through this process.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// This deteriorate efficiency.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">// TODO: Implement matrix with more symmetries.</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 6; ii++) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj &lt; ii; jj++) {</div>
<div class="line">        dS_dC(jj, is + ii) = dS_dC(ii, is + jj);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// As result that symmetry of deformation gradient C is used, terms which</span></div>
<div class="line">    <span class="comment">// have mixed indices are two time to big, and terms which has two times</span></div>
<div class="line">    <span class="comment">// midxed index are four times to big. Those terms are not multiplied.</span></div>
<div class="line">    D1(0, 0, 0, 0) *= 4;</div>
<div class="line">    D1(1, 1, 1, 1) *= 4;</div>
<div class="line">    D1(2, 2, 2, 2) *= 4;</div>
<div class="line"> </div>
<div class="line">    D1(0, 0, 1, 1) *= 4;</div>
<div class="line">    D1(1, 1, 0, 0) *= 4;</div>
<div class="line">    D1(1, 1, 2, 2) *= 4;</div>
<div class="line">    D1(2, 2, 1, 1) *= 4;</div>
<div class="line">    D1(0, 0, 2, 2) *= 4;</div>
<div class="line">    D1(2, 2, 0, 0) *= 4;</div>
<div class="line"> </div>
<div class="line">    D1(0, 0, 0, 1) *= 2;</div>
<div class="line">    D1(0, 0, 0, 2) *= 2;</div>
<div class="line">    D1(0, 0, 1, 2) *= 2;</div>
<div class="line">    D1(0, 1, 0, 0) *= 2;</div>
<div class="line">    D1(0, 2, 0, 0) *= 2;</div>
<div class="line">    D1(1, 2, 0, 0) *= 2;</div>
<div class="line"> </div>
<div class="line">    D1(1, 1, 0, 1) *= 2;</div>
<div class="line">    D1(1, 1, 0, 2) *= 2;</div>
<div class="line">    D1(1, 1, 1, 2) *= 2;</div>
<div class="line">    D1(0, 1, 1, 1) *= 2;</div>
<div class="line">    D1(0, 2, 1, 1) *= 2;</div>
<div class="line">    D1(1, 2, 1, 1) *= 2;</div>
<div class="line"> </div>
<div class="line">    D1(2, 2, 0, 1) *= 2;</div>
<div class="line">    D1(2, 2, 0, 2) *= 2;</div>
<div class="line">    D1(2, 2, 1, 2) *= 2;</div>
<div class="line">    D1(0, 1, 2, 2) *= 2;</div>
<div class="line">    D1(0, 2, 2, 2) *= 2;</div>
<div class="line">    D1(1, 2, 2, 2) *= 2;</div>
<div class="line"> </div>
<div class="line">    D2(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) = (<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * (D1(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) * <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>)));</div>
<div class="line">    <span class="comment">// D2(i, J, k, L) += I(i, k) * S(J, L);</span></div>
<div class="line"> </div>
<div class="line">    ++grad;</div>
<div class="line">    ++S;</div>
<div class="line">    ++<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">    ++D1;</div>
<div class="line">    ++D2;</div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    ++psi;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a name="a50"></a><a class="code" href="structOpPostProcStress.html#a0f791f1e62ed3fc3a7a72dc3946490fc">OpPostProcStress::OpPostProcStress</a>(<a name="a51"></a><a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;post_proc_mesh,</div>
<div class="line">                                   std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts,</div>
<div class="line">                                   Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data), postProcMesh(post_proc_mesh),</div>
<div class="line">      mapGaussPts(map_gauss_pts) {</div>
<div class="line">  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line">  doVertices = <span class="keyword">true</span>;</div>
<div class="line">  doEdges = <span class="keyword">false</span>;</div>
<div class="line">  doQuads = <span class="keyword">false</span>;</div>
<div class="line">  doTris = <span class="keyword">false</span>;</div>
<div class="line">  doTets = <span class="keyword">false</span>;</div>
<div class="line">  doPrisms = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a name="a52"></a><a class="code" href="structOpPostProcStress.html#adc555582171e7be6434277c8808a3395">OpPostProcStress::doWork</a>(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                         <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> != MBVERTEX)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(9);</div>
<div class="line">  <span class="keywordtype">double</span> def_VAL[9];</div>
<div class="line">  bzero(def_VAL, 9 * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"> </div>
<div class="line">  Tag th_piola2;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;Piola_Stress2&quot;</span>, 9, MB_TYPE_DOUBLE,</div>
<div class="line">                                     th_piola2, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line">                                     def_VAL);</div>
<div class="line"> </div>
<div class="line">  Tag th_psi;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;psi&quot;</span>, 1, MB_TYPE_DOUBLE, th_psi,</div>
<div class="line">                                     MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"> </div>
<div class="line">  Tag th_rho;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;RHO&quot;</span>, 1, MB_TYPE_DOUBLE, th_rho,</div>
<div class="line">                                     MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"> </div>
<div class="line">  Tag th_piola1;</div>
<div class="line">  Tag principal;</div>
<div class="line">  Tag th_prin_stress_vect1, th_prin_stress_vect2, th_prin_stress_vect3;</div>
<div class="line">  Tag th_R;</div>
<div class="line">  Tag th_grad_rho;</div>
<div class="line">  <span class="keywordflow">if</span> (!commonData.less_post_proc) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;Piola_Stress1&quot;</span>, 9, MB_TYPE_DOUBLE,</div>
<div class="line">                                       th_piola1, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line">                                       def_VAL);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;Principal_stress&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line">                                       principal, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line">                                       def_VAL);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;Principal_stress_S1&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line">                                       th_prin_stress_vect1,</div>
<div class="line">                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;Principal_stress_S2&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line">                                       th_prin_stress_vect2,</div>
<div class="line">                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;Principal_stress_S3&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line">                                       th_prin_stress_vect3,</div>
<div class="line">                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;R&quot;</span>, 1, MB_TYPE_DOUBLE, th_R,</div>
<div class="line">                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_get_handle(<span class="stringliteral">&quot;grad_rho&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line">                                       th_grad_rho,</div>
<div class="line">                                       MB_TAG_CREAT | MB_TAG_SPARSE, def_VAL);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line">  <span class="keyword">auto</span> psi = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecR);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line">  <span class="keyword">auto</span> grad_rho = getFTensor1FromMat&lt;3&gt;(*commonData.data.gradRhoPtr);</div>
<div class="line"> </div>
<div class="line">  <a name="a53"></a><a class="code" href="namespaceMoFEM_1_1Types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MatrixDouble3by3</a> stress(3, 3);</div>
<div class="line">  <a name="a54"></a><a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> eigen_values(3);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MatrixDouble3by3</a> eigen_vectors(3, 3);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> val = psi;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_psi, &amp;mapGaussPts[gg], 1, &amp;val);</div>
<div class="line">    val = <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_rho, &amp;mapGaussPts[gg], 1, &amp;val);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// S is symmetric tensor, need to map it to non-symmetric tensor to save it</span></div>
<div class="line">    <span class="comment">// on moab tag to be viable in paraview.</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ii++) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; jj++) {</div>
<div class="line">        stress(ii, jj) = S(ii, jj);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_piola2, &amp;mapGaussPts[gg], 1,</div>
<div class="line">                                     &amp;stress(0, 0));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!commonData.less_post_proc) {</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ii++) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; jj++) {</div>
<div class="line">          stress(ii, jj) = <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(ii, jj);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_piola1, &amp;mapGaussPts[gg], 1,</div>
<div class="line">                                       &amp;stress(0, 0));</div>
<div class="line">      val = <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_R, &amp;mapGaussPts[gg], 1, &amp;val);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> t2[] = {grad_rho(0), grad_rho(1), grad_rho(2)};</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_grad_rho, &amp;mapGaussPts[gg], 1, t2);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add calculation of eigen values, i.e. prinple stresses.</span></div>
<div class="line">      noalias(eigen_vectors) = stress;</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> prin_stress_vect1(3);</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> prin_stress_vect2(3);</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> prin_stress_vect3(3);</div>
<div class="line">      <span class="comment">// LAPACK - eigenvalues and vectors. Applied twice for initial creates</span></div>
<div class="line">      <span class="comment">// memory space</span></div>
<div class="line">      <span class="keywordtype">int</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = 3, lda = 3, info, lwork = -1;</div>
<div class="line">      <span class="keywordtype">double</span> wkopt;</div>
<div class="line">      info = <a name="a55"></a><a class="code" href="lapack__wrap_8h.html#a9d34be2f8a6a32580830207f2b827529">lapack_dsyev</a>(<span class="charliteral">&#39;V&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>, &amp;(eigen_vectors.data()[0]), lda,</div>
<div class="line">                          &amp;(eigen_values.data()[0]), &amp;wkopt, lwork);</div>
<div class="line">      <span class="keywordflow">if</span> (info != 0)</div>
<div class="line">        SETERRQ1(PETSC_COMM_SELF, 1,</div>
<div class="line">                 <span class="stringliteral">&quot;something is wrong with lapack_dsyev info = %d&quot;</span>, info);</div>
<div class="line">      lwork = (<a name="a56"></a><a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>)wkopt;</div>
<div class="line">      <span class="keywordtype">double</span> work[lwork];</div>
<div class="line">      info = <a class="code" href="lapack__wrap_8h.html#a9d34be2f8a6a32580830207f2b827529">lapack_dsyev</a>(<span class="charliteral">&#39;V&#39;</span>, <span class="charliteral">&#39;U&#39;</span>, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>, &amp;(eigen_vectors.data()[0]), lda,</div>
<div class="line">                          &amp;(eigen_values.data()[0]), work, lwork);</div>
<div class="line">      <span class="keywordflow">if</span> (info != 0)</div>
<div class="line">        SETERRQ1(PETSC_COMM_SELF, 1,</div>
<div class="line">                 <span class="stringliteral">&quot;something is wrong with lapack_dsyev info = %d&quot;</span>, info);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii &lt; 3; ii++) {</div>
<div class="line">        prin_stress_vect1[ii] = eigen_vectors(0, ii);</div>
<div class="line">        prin_stress_vect2[ii] = eigen_vectors(1, ii);</div>
<div class="line">        prin_stress_vect3[ii] = eigen_vectors(2, ii);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(principal, &amp;mapGaussPts[gg], 1,</div>
<div class="line">                                       &amp;eigen_values[0]);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_prin_stress_vect1, &amp;mapGaussPts[gg],</div>
<div class="line">                                       1, &amp;*prin_stress_vect1.begin());</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_prin_stress_vect2, &amp;mapGaussPts[gg],</div>
<div class="line">                                       1, &amp;*prin_stress_vect2.begin());</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcMesh.tag_set_data(th_prin_stress_vect3, &amp;mapGaussPts[gg],</div>
<div class="line">                                       1, &amp;*prin_stress_vect3.begin());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ++S;</div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    ++psi;</div>
<div class="line">    ++<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++grad_rho;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpCalculateStressTangent::OpCalculateStressTangent(</div>
<div class="line">    Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  <span class="comment">// Set that this operator is executed only for vertices on element</span></div>
<div class="line">  doVertices = <span class="keyword">true</span>;</div>
<div class="line">  doEdges = <span class="keyword">false</span>;</div>
<div class="line">  doQuads = <span class="keyword">false</span>;</div>
<div class="line">  doTris = <span class="keyword">false</span>;</div>
<div class="line">  doTets = <span class="keyword">false</span>;</div>
<div class="line">  doPrisms = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpCalculateStressTangent::doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                                <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> != MBVERTEX)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> grad = getFTensor2FromMat&lt;3, 3&gt;(*commonData.data.gradDispPtr);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = commonData.data.gradDispPtr-&gt;size2();</div>
<div class="line"> </div>
<div class="line">  commonData.data.matInvF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> invF = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matInvF);</div>
<div class="line">  commonData.data.vecDetF.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> det_f = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecDetF);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;dP_dF = commonData.data.matPushedMaterialTangent;</div>
<div class="line">  dP_dF.resize(81, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matF = commonData.data.matGradientOfDeformation;</div>
<div class="line">  matF.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a>(matF));</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double *, 3, 3, 3, 3&gt;</a> D2(<a class="code" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(dP_dF));</div>
<div class="line">  commonData.data.matP.resize(9, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line">  commonData.data.vecPsi.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> psi = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'J', 3&gt;</a> <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'K', 3&gt;</a> <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'L', 3&gt;</a> <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = commonData.lambda;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = commonData.mu;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get deformation gradient</span></div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(0, 0) += 1;</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(1, 1) += 1;</div>
<div class="line">    <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(2, 2) += 1;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">determinantTensor3by3</a>(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, det_f, invF);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> log_det = log(det_f);</div>
<div class="line">    psi = <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) - 3 - 2 * log_det;</div>
<div class="line">    psi *= 0.5 * <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    psi += 0.5 * <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det * log_det;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> var = <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det - <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> * <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) + var * invF(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> coef = <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> - <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * log_det;</div>
<div class="line">    <span class="comment">// TODO: This can be improved by utilising the symmetries of the D2 tensor</span></div>
<div class="line"> </div>
<div class="line">    D2(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) =</div>
<div class="line">        invF(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (invF(<a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>) + invF(<a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (invF(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * coef);</div>
<div class="line"> </div>
<div class="line">    D2(0, 0, 0, 0) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(0, 1, 0, 1) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(0, 2, 0, 2) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(1, 0, 1, 0) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(1, 1, 1, 1) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(1, 2, 1, 2) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(2, 0, 2, 0) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(2, 1, 2, 1) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    D2(2, 2, 2, 2) += <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line"> </div>
<div class="line">    ++det_f;</div>
<div class="line">    ++invF;</div>
<div class="line">    ++grad;</div>
<div class="line">    ++<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">    ++D2;</div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    ++psi;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpAssmbleStressRhs::OpAssmbleStressRhs(Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpAssmbleStressRhs::doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                           <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  nF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = data.getN().size2();</div>
<div class="line">  <span class="keyword">auto</span> diff_base_functions = data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// MatrixDouble &amp;matS = commonData.data.matS;</span></div>
<div class="line">  <span class="comment">// MatrixDouble &amp;matF = commonData.data.matGradientOfDeformation;</span></div>
<div class="line">  <span class="comment">// FTensor::Tensor2&lt;double*,3,3&gt; F(TENSOR2_MAT_PTR(matF));</span></div>
<div class="line">  <span class="comment">// FTensor::Tensor2_symmetric&lt;double*,3&gt; S(SYMMETRIC_TENSOR2_MAT_PTR(matS),6);</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = commonData.n;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'J', 3&gt;</a> <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get volume and integration weight</span></div>
<div class="line">    <span class="keywordtype">double</span> <a name="a57"></a><a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line">    <span class="keywordtype">double</span> <a name="a58"></a><a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; bb != nb_dofs / 3; bb++) {</div>
<div class="line">      <span class="keywordtype">double</span> *ptr = &amp;nF[3 * bb];</div>
<div class="line">      <a name="_a59"></a><a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> t1(ptr, &amp;ptr[1], &amp;ptr[2]);</div>
<div class="line">      t1(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * diff_base_functions(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">      <span class="comment">// t1(i) += 0.5*a*diff_base_functions(J)*(F(i,I)*S(I,J));</span></div>
<div class="line">      <span class="comment">// t1(i) += 0.5*a*diff_base_functions(I)*(F(i,J)*S(I,J));</span></div>
<div class="line">      ++diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Could be that we base more base functions than needed to approx. disp.</span></div>
<div class="line">    <span class="comment">// field.</span></div>
<div class="line">    <span class="keywordflow">for</span> (; bb != nb_base_functions; bb++) {</div>
<div class="line">      ++diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    <span class="comment">// ++S;</span></div>
<div class="line">    <span class="comment">// ++F;</span></div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Assemble internal force vector for time solver (TS)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a60"></a><a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line">      getFEMethod()-&gt;ts_F, <span class="comment">/// Get the right hand side vector for time solver</span></div>
<div class="line"><span class="comment"></span>      nb_dofs, &amp;*data.getIndices().begin(), &amp;*nF.begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpAssmbleRhoRhs::OpAssmbleRhoRhs(Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">UserDataOperator::OPROW</a>),</div>
<div class="line">      commonData(common_data) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpAssmbleRhoRhs::doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                        <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  nF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = data.getN().size2();</div>
<div class="line">  <span class="keyword">auto</span> base_functions = data.getFTensor0N();</div>
<div class="line">  <span class="keyword">auto</span> diff_base_functions = data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line">  <span class="keywordflow">if</span> (!commonData.data.rhoPtr) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;rhoPtsr is null&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line">  <span class="keywordflow">if</span> (!commonData.data.gradRhoPtr) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;gradRhoPtr is null&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">auto</span> grad_rho = getFTensor1FromMat&lt;3&gt;(*commonData.data.gradRhoPtr);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecR);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (commonData.data.vecRhoDt.size() != nb_gauss_pts) {</div>
<div class="line">    commonData.data.vecRhoDt.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">    commonData.data.vecRhoDt.clear();</div>
<div class="line">    <span class="comment">// SETERRQ(PETSC_COMM_SELF,MOFEM_DATA_INCONSISTENCY,&quot;Time derivative of</span></div>
<div class="line">    <span class="comment">// density at integration not calculated&quot;);</span></div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">auto</span> drho_dt = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecRhoDt);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> R0 = commonData.R0;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get volume and integration weight</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; bb != nb_dofs; bb++) {</div>
<div class="line">      nF[bb] += <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * base_functions * drho_dt; <span class="comment">// Density rate term</span></div>
<div class="line">      nF[bb] -= <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * base_functions * <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;       <span class="comment">// Source term</span></div>
<div class="line">      nF[bb] -= <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * R0 * diff_base_functions(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * grad_rho(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>); <span class="comment">// Gradient term</span></div>
<div class="line">      ++base_functions;</div>
<div class="line">      ++diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Could be that we base more base functions than needed to approx. density</span></div>
<div class="line">    <span class="comment">// field.</span></div>
<div class="line">    <span class="keywordflow">for</span> (; bb != nb_base_functions; bb++) {</div>
<div class="line">      ++base_functions;</div>
<div class="line">      ++diff_base_functions;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Increment quantities for integration pts.</span></div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++grad_rho;</div>
<div class="line">    ++drho_dt;</div>
<div class="line">    ++<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Assemble internal force vector for time solver (TS)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line">      getFEMethod()-&gt;ts_F, <span class="comment">/// Get the right hand side vector for time solver</span></div>
<div class="line"><span class="comment"></span>      nb_dofs, &amp;*data.getIndices().begin(), &amp;*nF.begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpAssmbleRhoLhs_dRho::OpAssmbleRhoLhs_dRho(Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;RHO&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>, <a name="a61"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">UserDataOperator::OPROWCOL</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  sYmm = <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpAssmbleRhoLhs_dRho::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                             EntityType col_type,</div>
<div class="line">                             <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;row_data,</div>
<div class="line">                             <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;col_data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line">  locK_rho_rho.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">  locK_rho_rho.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">  <span class="keywordflow">if</span> (!row_nb_gauss_pts)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> ts_a = getFEMethod()-&gt;ts_a;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> R0 = commonData.R0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = commonData.c;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = commonData.n;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = commonData.m;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> psi_ref = commonData.pSi_ref;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line">  <span class="keyword">auto</span> psi = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line">  <span class="keyword">auto</span> row_base_functions = row_data.getFTensor0N();</div>
<div class="line">  <span class="keyword">auto</span> row_diff_base_functions = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get volume and integration weight</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> kp = commonData.getCFromDensity(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> kp_diff = commonData.getCFromDensityDiff(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp * ((<a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> - <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) / <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) * pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> - <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * psi;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> a_diff =</div>
<div class="line">        <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp_diff * (pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> - <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) * psi - psi_ref);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> row_bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; row_bb != row_nb_dofs; row_bb++) {</div>
<div class="line">      <span class="keyword">auto</span> col_base_functions = col_data.getFTensor0N(gg, 0);</div>
<div class="line">      <span class="keyword">auto</span> col_diff_base_functions = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_bb = 0; col_bb != col_nb_dofs; col_bb++) {</div>
<div class="line">        locK_rho_rho(row_bb, col_bb) +=</div>
<div class="line">            ts_a * <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * row_base_functions * col_base_functions;</div>
<div class="line">        locK_rho_rho(row_bb, col_bb) -=</div>
<div class="line">            <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * R0 * row_diff_base_functions(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * col_diff_base_functions(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">        locK_rho_rho(row_bb, col_bb) -=</div>
<div class="line">            <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * row_base_functions * col_base_functions;</div>
<div class="line">        locK_rho_rho(row_bb, col_bb) -=</div>
<div class="line">            a_diff * <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * row_base_functions * col_base_functions;</div>
<div class="line"> </div>
<div class="line">        ++col_base_functions;</div>
<div class="line">        ++col_diff_base_functions;</div>
<div class="line">      }</div>
<div class="line">      ++row_base_functions;</div>
<div class="line">      ++row_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; row_bb != row_nb_base_functions; row_bb++) {</div>
<div class="line">      ++row_base_functions;</div>
<div class="line">      ++row_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    ++psi;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// cerr &lt;&lt; locK_rho_rho &lt;&lt; endl;</span></div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a62"></a><a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs,</div>
<div class="line">                      &amp;*row_data.getIndices().begin(), col_nb_dofs,</div>
<div class="line">                      &amp;*col_data.getIndices().begin(), &amp;locK_rho_rho(0, 0),</div>
<div class="line">                      ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// is symmetric</span></div>
<div class="line">  <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">    transLocK_rho_rho.resize(col_nb_dofs, row_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">    noalias(transLocK_rho_rho) = trans(locK_rho_rho);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, col_nb_dofs,</div>
<div class="line">                        &amp;*col_data.getIndices().begin(), row_nb_dofs,</div>
<div class="line">                        &amp;*row_data.getIndices().begin(),</div>
<div class="line">                        &amp;transLocK_rho_rho(0, 0), ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpAssmbleRhoLhs_dF::OpAssmbleRhoLhs_dF(Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;RHO&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">UserDataOperator::OPROWCOL</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  sYmm = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpAssmbleRhoLhs_dF::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                           EntityType col_type,</div>
<div class="line">                           <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;row_data,</div>
<div class="line">                           <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;col_data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line">  locK_rho_F.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">  locK_rho_F.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_base_functions = col_data.getN().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = commonData.c;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = commonData.n;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> = commonData.m;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line"> </div>
<div class="line">  <a name="_a63"></a><a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t1;</div>
<div class="line">  <span class="keyword">auto</span> col_diff_base_functions = col_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get volume and integration weight</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> kp = commonData.getCFromDensity(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * kp * pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> - <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> col_bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; col_bb != col_nb_dofs / 3; col_bb++) {</div>
<div class="line">      t1(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * col_diff_base_functions(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">      <span class="keyword">auto</span> row_base_functions = row_data.getFTensor0N(gg, 0);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row_bb = 0; row_bb != row_nb_dofs; row_bb++) {</div>
<div class="line">        <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(&amp;locK_rho_F(row_bb, 3 * col_bb + 0),</div>
<div class="line">                                        &amp;locK_rho_F(row_bb, 3 * col_bb + 1),</div>
<div class="line">                                        &amp;locK_rho_F(row_bb, 3 * col_bb + 2));</div>
<div class="line">        <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) -= row_base_functions * t1(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        ++row_base_functions;</div>
<div class="line">      }</div>
<div class="line">      ++col_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; col_bb != col_nb_base_functions; col_bb++) {</div>
<div class="line">      ++col_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs,</div>
<div class="line">                      &amp;*row_data.getIndices().begin(), col_nb_dofs,</div>
<div class="line">                      &amp;*col_data.getIndices().begin(), &amp;locK_rho_F(0, 0),</div>
<div class="line">                      ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> ADOLC&gt;</div>
<div class="line">OpAssmbleStressLhs_dF&lt;ADOLC&gt;::OpAssmbleStressLhs_dF(</div>
<div class="line">    Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">UserDataOperator::OPROWCOL</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  sYmm = <span class="keyword">true</span>;</div>
<div class="line">}</div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">bool</span> ADOLC&gt;</div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpAssmbleStressLhs_dF&lt;ADOLC&gt;::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type, EntityType col_type,</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;row_data,</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;col_data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">bool</span> diagonal_block = (row_type == col_type) &amp;&amp; (row_side == col_side);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line">  locK_P_F.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">  locK_P_F.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;matS = commonData.data.matS;</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;dP_dF = commonData.data.matPushedMaterialTangent;</div>
<div class="line">  <span class="comment">// MatrixDouble &amp;dS_dC = commonData.data.matMaterialTangent;</span></div>
<div class="line">  <span class="comment">// MatrixDouble &amp;matF = commonData.data.matGradientOfDeformation;</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> t0;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = commonData.n;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a name="_a64"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a name="a65"></a><a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'J', 3&gt;</a> <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'K', 3&gt;</a> <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'L', 3&gt;</a> <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> row_diff_base_functions = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;double *, 3, 3, 3, 3&gt;</a> D2(<a class="code" href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a>(dP_dF));</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double *, 3&gt;</a> S(<a class="code" href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a>(matS), 6);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// FTensor::Tensor4_ddg&lt;double*,3,3&gt; D1(SYMMETRIC_TENSOR4_MAT_PTR(dS_dC),6);</span></div>
<div class="line">  <span class="comment">// FTensor::Tensor2&lt;double*,3,3&gt; F(TENSOR2_MAT_PTR(matF));</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get volume and integration weight</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> row_bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> col_diff_base_functions = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> final_bb = diagonal_block ? row_bb + 1 : col_nb_dofs / 3;</div>
<div class="line">      <span class="keywordtype">int</span> col_bb = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (; col_bb != final_bb; col_bb++) {</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> t_assemble(</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 2),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 2),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 2));</div>
<div class="line"> </div>
<div class="line">        diffDiff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) =</div>
<div class="line">            <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * row_diff_base_functions(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * col_diff_base_functions(<a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// TODO: FIXME: Tensor D2 has major symmetry, we do not have such tensor</span></div>
<div class="line">        <span class="comment">// implemented at the moment. Using tensor with major symmetry will</span></div>
<div class="line">        <span class="comment">// improve code efficiency.</span></div>
<div class="line">        t_assemble(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += diffDiff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) * D2(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (ADOLC) {</div>
<div class="line">          <span class="comment">// Stress stiffening part (only with adolc since it is using dS / dC</span></div>
<div class="line">          <span class="comment">// derrivative. Check OpCalculateStressTangentWithAdolc operator)</span></div>
<div class="line">          t0 = diffDiff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>) * S(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>);</div>
<div class="line">          t_assemble(0, 0) += t0;</div>
<div class="line">          t_assemble(1, 1) += t0;</div>
<div class="line">          t_assemble(2, 2) += t0;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// Next base function for column</span></div>
<div class="line">        ++col_diff_base_functions;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      ++row_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; row_bb != row_nb_base_functions; row_bb++) {</div>
<div class="line">      ++row_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ++D1;</span></div>
<div class="line">    ++D2;</div>
<div class="line">    ++S;</div>
<div class="line">    <span class="comment">// ++F;</span></div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Copy of symmetric part for assemble</span></div>
<div class="line">  <span class="keywordflow">if</span> (diagonal_block) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> row_bb = 0; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line">      <span class="keywordtype">int</span> col_bb = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (; col_bb != row_bb + 1; col_bb++) {</div>
<div class="line">        <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> t_assemble(</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 0, 3 * col_bb + 2),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 1, 3 * col_bb + 2),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * row_bb + 2, 3 * col_bb + 2));</div>
<div class="line">        <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double *, 3, 3&gt;</a> t_off_side(</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 0, 3 * row_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 0, 3 * row_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 0, 3 * row_bb + 2),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 1, 3 * row_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 1, 3 * row_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 1, 3 * row_bb + 2),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 2, 3 * row_bb + 0),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 2, 3 * row_bb + 1),</div>
<div class="line">            &amp;locK_P_F(3 * col_bb + 2, 3 * row_bb + 2));</div>
<div class="line">        t_off_side(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = t_assemble(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_ind = &amp;*row_data.getIndices().begin();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *col_ind = &amp;*col_data.getIndices().begin();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs, row_ind, col_nb_dofs,</div>
<div class="line">                      col_ind, &amp;locK_P_F(0, 0), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (row_type != col_type || row_side != col_side) {</div>
<div class="line">    transLocK_P_F.resize(col_nb_dofs, row_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">    noalias(transLocK_P_F) = trans(locK_P_F);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, col_nb_dofs, col_ind, row_nb_dofs,</div>
<div class="line">                        row_ind, &amp;transLocK_P_F(0, 0), ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">OpAssmbleStressLhs_dRho::OpAssmbleStressLhs_dRho(</div>
<div class="line">    Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">UserDataOperator::OPROWCOL</a>),</div>
<div class="line">      commonData(common_data) {</div>
<div class="line">  sYmm = <span class="keyword">false</span>; <span class="comment">// This is off-diagonal (upper-left), so no symmetric</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpAssmbleStressLhs_dRho::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                                EntityType col_type,</div>
<div class="line">                                <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;row_data,</div>
<div class="line">                                <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;col_data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!row_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span> (!col_nb_dofs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set size can clear local tangent matrix</span></div>
<div class="line">  locK_P_RHO.resize(row_nb_dofs, col_nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">  locK_P_RHO.clear();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t1;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> = commonData.n;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> rho_ref = commonData.rHo_ref;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', 3&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a> = getFTensor2FromMat&lt;3, 3&gt;(commonData.data.matP);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_functions = row_data.getN().size2();</div>
<div class="line">  <span class="keyword">auto</span> row_diff_base_functions = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != row_nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get volume and integration weight</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getVolume() * getGaussPts()(3, gg);</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * (<a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a> / <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>) * pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rho_ref, <a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> row_bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; row_bb != row_nb_dofs / 3; row_bb++) {</div>
<div class="line">      t1(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * row_diff_base_functions(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * <a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">      <span class="keyword">auto</span> base_functions = col_data.getFTensor0N(gg, 0);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> col_bb = 0; col_bb != col_nb_dofs; col_bb++) {</div>
<div class="line">        <span class="comment">// if(base_functions!=col_data.getN(gg)[col_bb]) {</span></div>
<div class="line">        <span class="comment">//   cerr &lt;&lt; &quot;Error&quot; &lt;&lt; endl;</span></div>
<div class="line">        <span class="comment">// }</span></div>
<div class="line">        <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(&amp;locK_P_RHO(3 * row_bb + 0, col_bb),</div>
<div class="line">                                        &amp;locK_P_RHO(3 * row_bb + 1, col_bb),</div>
<div class="line">                                        &amp;locK_P_RHO(3 * row_bb + 2, col_bb));</div>
<div class="line">        <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += t1(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * base_functions;</div>
<div class="line">        ++base_functions;</div>
<div class="line">      }</div>
<div class="line">      ++row_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; row_bb != row_nb_base_functions; row_bb++) {</div>
<div class="line">      ++row_diff_base_functions;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    ++<a class="code" href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">P</a>;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_nb_dofs,</div>
<div class="line">                      &amp;*row_data.getIndices().begin(), col_nb_dofs,</div>
<div class="line">                      &amp;*col_data.getIndices().begin(), &amp;locK_P_RHO(0, 0),</div>
<div class="line">                      ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a name="a66"></a><a class="code" href="structMonitorPostProc.html#ad6f70f52c3f4c77276fc985a3f7a2795">MonitorPostProc::MonitorPostProc</a>(<a name="_a67"></a><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                 Remodeling::CommonData &amp;common_data)</div>
<div class="line">    : mField(m_field), commonData(common_data), postProc(m_field),</div>
<div class="line">      postProcElastic(m_field),</div>
<div class="line">      <span class="comment">// densityMaps(m_field),</span></div>
<div class="line">      iNit(<span class="keyword">false</span>) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a68"></a><a class="code" href="structMonitorPostProc.html#a6d18eec583bf6954ef3789baf7f6b8c8">MonitorPostProc::preProcess</a>() {</div>
<div class="line">  <a name="a69"></a><a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a70"></a><a class="code" href="structMonitorPostProc.html#a695bc88c72bd41eeac7ef7f6d628d014">MonitorPostProc::operator()</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a71"></a><a class="code" href="structMonitorPostProc.html#a5f9f4333af411bf4de37445782aca1b5">MonitorPostProc::postProcess</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  PetscBool mass_postproc = PETSC_FALSE;</div>
<div class="line">  PetscBool equilibrium_flg = PETSC_FALSE;</div>
<div class="line">  PetscBool analysis_mesh_flg = PETSC_FALSE;</div>
<div class="line">  rate = 1;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Bone remodeling post-process&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line">      <span class="stringliteral">&quot;-mass_postproc&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;is used for testing, calculates mass and energy at each time step&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      mass_postproc, &amp;mass_postproc, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-analysis_mesh&quot;</span>,</div>
<div class="line">                          <span class="stringliteral">&quot;saves analysis mesh at each time step&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          analysis_mesh_flg, &amp;analysis_mesh_flg, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line">      <span class="stringliteral">&quot;-equilibrium_stop_rate&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;is used to stop calculations when equilibium state is achieved&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">      rate, &amp;rate, &amp;equilibrium_flg);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line">  CHKERRQ(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!iNit) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                             <span class="stringliteral">&quot;Bone remodeling post-process&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    pRT = 1;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_output_prt&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;frequncy how often results are dumped on hard disk&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;&quot;</span>, 1, &amp;pRT, NULL);</div>
<div class="line">    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line">    CHKERRQ(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.generateReferenceElementMesh();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.addFieldValuesPostProc(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.addFieldValuesPostProc(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (!commonData.less_post_proc) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.addFieldValuesGradientPostProc(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// CHKERR postProc.addFieldValuesPostProc(&quot;RHO&quot;);</span></div>
<div class="line">    <span class="comment">// CHKERR postProc.addFieldValuesGradientPostProc(&quot;RHO&quot;);</span></div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <span class="keyword">auto</span> &amp;list_of_operators = postProc.getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      list_of_operators.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a72"></a><a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line">      list_of_operators.push_back(<span class="keyword">new</span> <a name="_a73"></a><a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(</div>
<div class="line">          <span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line">      <span class="comment">// Get displacement gradient at integration points</span></div>
<div class="line">      list_of_operators.push_back(<span class="keyword">new</span> <a name="_a74"></a><a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, commonData.data.gradDispPtr));</div>
<div class="line">      list_of_operators.push_back(<span class="keyword">new</span> <a name="_a75"></a><a class="code" href="structOpCalculateStress.html">OpCalculateStress</a>(commonData));</div>
<div class="line">      list_of_operators.push_back(<span class="keyword">new</span> <a name="_a76"></a><a class="code" href="structOpPostProcStress.html">OpPostProcStress</a>(</div>
<div class="line">          postProc.postProcMesh, postProc.mapGaussPts, commonData));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.generateReferenceElementMesh();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.addFieldValuesPostProc(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.addFieldValuesPostProc(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.addFieldValuesGradientPostProc(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">    std::map&lt;int, NonlinearElasticElement::BlockData&gt;::iterator sit =</div>
<div class="line">        commonData.elasticPtr-&gt;setOfBlocks.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (; sit != commonData.elasticPtr-&gt;setOfBlocks.end(); sit++) {</div>
<div class="line">      postProcElastic.getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a77"></a><a class="code" href="structPostProcStress.html">PostProcStress</a>(</div>
<div class="line">          postProcElastic.postProcMesh, postProcElastic.mapGaussPts,</div>
<div class="line">          <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, sit-&gt;second, postProcElastic.commonData));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    iNit = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (mass_postproc) {</div>
<div class="line">    <a name="a78"></a><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> mass_vec;</div>
<div class="line">    <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> energ_vec;</div>
<div class="line">    <span class="keywordtype">int</span> mass_vec_ghost[] = {0};</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecCreateGhost(PETSC_COMM_WORLD, (!mField.get_comm_rank()) ? 1 : 0,</div>
<div class="line">                          1, 1, mass_vec_ghost, &amp;mass_vec);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(mass_vec);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(mass_vec, &amp;energ_vec);</div>
<div class="line"> </div>
<div class="line">    Remodeling::Fe energyCalc(mField);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a79"></a><a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, energyCalc, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                       <span class="keyword">true</span>);</div>
<div class="line">    energyCalc.getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line">    energyCalc.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line">    energyCalc.getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>,</div>
<div class="line">                                                 commonData.data.gradDispPtr));</div>
<div class="line">    energyCalc.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structOpCalculateStress.html">OpCalculateStress</a>(commonData));</div>
<div class="line">    energyCalc.getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpMassAndEnergyCalculation(<span class="stringliteral">&quot;RHO&quot;</span>, commonData, energ_vec, mass_vec));</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a80"></a><a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(commonData.dm, <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line">                                    &amp;energyCalc);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(mass_vec);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(mass_vec);</div>
<div class="line">    <span class="keywordtype">double</span> mass_sum;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSum(mass_vec, &amp;mass_sum);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(energ_vec);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(energ_vec);</div>
<div class="line">    <span class="keywordtype">double</span> energ_sum;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSum(energ_vec, &amp;energ_sum);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                       <span class="stringliteral">&quot;Time: %g Mass: %6.5g Elastic energy: %6.5g \n&quot;</span>, ts_t,</div>
<div class="line">                       mass_sum, energ_sum);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;mass_vec);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;energ_vec);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (equilibrium_flg) {</div>
<div class="line">      <span class="keywordtype">double</span> equilibrium_rate =</div>
<div class="line">          fabs(energ_sum - commonData.cUrrent_psi) / energ_sum;</div>
<div class="line">      <span class="keywordtype">double</span> equilibrium_mass_rate =</div>
<div class="line">          fabs(mass_sum - commonData.cUrrent_mass) / mass_sum;</div>
<div class="line">      <span class="keywordflow">if</span> (equilibrium_rate &lt; rate) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(</div>
<div class="line">            PETSC_COMM_WORLD,</div>
<div class="line">            <span class="stringliteral">&quot;Energy equilibrium state is achieved! Difference = %0.6g %%. \n&quot;</span>,</div>
<div class="line">            equilibrium_rate * 100);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (equilibrium_mass_rate &lt; rate) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(</div>
<div class="line">            PETSC_COMM_WORLD,</div>
<div class="line">            <span class="stringliteral">&quot;Mass equilibrium state is achieved! Difference = %0.6g %%. \n&quot;</span>,</div>
<div class="line">            equilibrium_mass_rate * 100);</div>
<div class="line">      }</div>
<div class="line">      commonData.cUrrent_psi = energ_sum;</div>
<div class="line">      commonData.cUrrent_mass = mass_sum;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> step;</div>
<div class="line"><span class="preprocessor">#if PETSC_VERSION_LE(3, 8, 0)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStepNumber(ts, &amp;step);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepNumber(ts, &amp;step);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> ((step) % pRT == 0) {</div>
<div class="line"> </div>
<div class="line">    ostringstream sss;</div>
<div class="line">    sss &lt;&lt; <span class="stringliteral">&quot;out_&quot;</span> &lt;&lt; step &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(commonData.dm, <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, &amp;postProc);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.postProcMesh.write_file(sss.str().c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line">                                            <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (analysis_mesh_flg) {</div>
<div class="line">      ostringstream ttt;</div>
<div class="line">      ttt &lt;&lt; <span class="stringliteral">&quot;analysis_mesh_&quot;</span> &lt;&lt; step &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().write_file(ttt.str().c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line">                                          <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (commonData.nOremodellingBlock) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(commonData.dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                      &amp;postProcElastic);</div>
<div class="line">      ostringstream ss;</div>
<div class="line">      ss &lt;&lt; <span class="stringliteral">&quot;out_elastic_&quot;</span> &lt;&lt; step &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcElastic.postProcMesh.write_file(ss.str().c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::getParameters() {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Bone remodeling&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  commonData.oRder = 2;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_order&quot;</span>, <span class="stringliteral">&quot;default approximation order&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 2,</div>
<div class="line">                         &amp;commonData.oRder, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line">  CHKERRQ(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_type(0, MBTET, commonData.tEts_all);</div>
<div class="line">  <span class="keywordflow">for</span> (<a name="a81"></a><a class="code" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(mField, <a name="a82"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line">    <span class="keywordtype">string</span> name = it-&gt;getName();</div>
<div class="line">    <span class="keywordflow">if</span> (name.compare(0, 14, <span class="stringliteral">&quot;NO_REMODELLING&quot;</span>) == 0) {</div>
<div class="line">      commonData.nOremodellingBlock = <span class="keyword">true</span>;</div>
<div class="line">      <a name="_a83"></a><a class="code" href="classEntityHandle.html">EntityHandle</a> meshset = it-&gt;getMeshset();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> this-&gt;mField.get_moab().get_entities_by_type(</div>
<div class="line">          meshset, MBTET, commonData.tEts_block, <span class="keyword">true</span>);</div>
<div class="line">      commonData.tEts_all =</div>
<div class="line">          subtract(commonData.tEts_all, commonData.tEts_block);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::addFields() {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Seed all mesh entities to MoFEM database, those entities can be potentially</span></div>
<div class="line">  <span class="comment">// used as finite elements or as entities which carry some approximation</span></div>
<div class="line">  <span class="comment">// field.</span></div>
<div class="line">  commonData.bitLevel.set(0);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a name="_a84"></a><a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line">      0, 3, commonData.bitLevel);</div>
<div class="line">  <span class="keywordtype">int</span> <a name="a85"></a><a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = commonData.oRder;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add displacement field</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a name="a86"></a><a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                          <span class="comment">/*AINSWORTH_LOBATTO_BASE*/</span> <a name="a87"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3,</div>
<div class="line">                          MB_TAG_SPARSE, <a name="a88"></a><a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">  <span class="comment">// Add field representing ho-geometry</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3,</div>
<div class="line">                          MB_TAG_SPARSE, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Check if density is available, if not add density field.</span></div>
<div class="line">  <span class="keywordtype">bool</span> add_rho_field = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_field(<span class="stringliteral">&quot;RHO&quot;</span>)) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<span class="stringliteral">&quot;RHO&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1,</div>
<div class="line">                            MB_TAG_SPARSE, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// FIXME</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(commonData.tEts_all, MBTET, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <span class="comment">// CHKERR mField.add_ents_to_field_by_type(0,MBTET,&quot;RHO&quot;);</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.synchronise_field_entities(<span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    add_rho_field = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBVERTEX, <span class="stringliteral">&quot;RHO&quot;</span>, 1);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBEDGE, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> - 1);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTRI, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> - 1);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTET, <span class="stringliteral">&quot;RHO&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> - 1);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add entities to field</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(0, MBTET, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(0, MBTET, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set approximation order to entities</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBVERTEX, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, 1);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBEDGE, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTRI, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBTET, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Assumes that geometry is approximated using 2nd order polynomials.</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Apply 2nd order only on skin</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Skinner skin(&amp;mField.get_moab());</span></div>
<div class="line">    <span class="comment">// Range faces,tets;</span></div>
<div class="line">    <span class="comment">// CHKERR mField.get_moab().get_entities_by_type(0,MBTET,tets);</span></div>
<div class="line">    <span class="comment">// CHKERR skin.find_skin(0,tets,false,faces);</span></div>
<div class="line">    <span class="comment">// Range edges;</span></div>
<div class="line">    <span class="comment">// CHKERR mField.get_moab().get_adjacencies(</span></div>
<div class="line">    <span class="comment">// faces,1,false,edges,moab::Interface::UNION</span></div>
<div class="line">    <span class="comment">// );</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBEDGE, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(0, MBVERTEX, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Build fields</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_fields();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// If order was not set from CT scans set homogenous order equal to</span></div>
<div class="line">  <span class="comment">// reference bone density</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_rho_field) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a name="_a89"></a><a class="code" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;setField(commonData.rHo_ref,</div>
<div class="line">                                                      MBVERTEX, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">    <span class="comment">// const DofEntity_multiIndex *dofs_ptr;</span></div>
<div class="line">    <span class="comment">// CHKERR mField.get_dofs(&amp;dofs_ptr);</span></div>
<div class="line">    <span class="comment">// for(_IT_GET_DOFS_FIELD_BY_NAME_FOR_LOOP_(mField,&quot;RHO&quot;,dit)) {</span></div>
<div class="line">    <span class="comment">//   cerr &lt;&lt; (*dit)-&gt;getFieldData() &lt;&lt; endl;</span></div>
<div class="line">    <span class="comment">// }</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Project geometry given on 10-node tets on ho-geometry</span></div>
<div class="line">  <a name="_a90"></a><a class="code" href="structMoFEM_1_1Projection10NodeCoordsOnField.html">Projection10NodeCoordsOnField</a> ent_method_material(mField,</div>
<div class="line">                                                    <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.loop_dofs(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_material);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::addElements() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(<span class="stringliteral">&quot;FE_REMODELLING&quot;</span>, <span class="stringliteral">&quot;RHO&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(commonData.tEts_all, MBTET,</div>
<div class="line">                                                   <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(<span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(<span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (commonData.nOremodellingBlock) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(commonData.tEts_block,</div>
<div class="line">                                                     MBTET, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  </div>
<div class="line">  commonData.elasticMaterialsPtr =</div>
<div class="line">      boost::shared_ptr&lt;ElasticMaterials&gt;(<span class="keyword">new</span> <a name="_a91"></a><a class="code" href="structElasticMaterials.html">ElasticMaterials</a>(mField));</div>
<div class="line">  commonData.elasticPtr = boost::shared_ptr&lt;NonlinearElasticElement&gt;(</div>
<div class="line">      <span class="keyword">new</span> <a name="_a92"></a><a class="code" href="structNonlinearElasticElement.html">NonlinearElasticElement</a>(mField, 10));</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> commonData.elasticMaterialsPtr-&gt;setBlocks(</div>
<div class="line">      commonData.elasticPtr-&gt;setOfBlocks);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> commonData.elasticPtr-&gt;addElement(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> commonData.elasticPtr-&gt;setOperators(</div>
<div class="line">      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_adjacencies(commonData.bitLevel);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Allocate memory for density and gradient of displacements at integration</span></div>
<div class="line">  <span class="comment">// points</span></div>
<div class="line">  commonData.data.rhoPtr = boost::shared_ptr&lt;VectorDouble&gt;(<span class="keyword">new</span> <a name="a93"></a><a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a>());</div>
<div class="line">  commonData.data.gradRhoPtr =</div>
<div class="line">      boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>());</div>
<div class="line">  commonData.data.gradDispPtr =</div>
<div class="line">      boost::shared_ptr&lt;MatrixDouble&gt;(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add operators Rhs</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *(commonData.feRhs), <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line">                     <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> &amp;list_of_operators_rhs = commonData.feRhs-&gt;getOpPtrVector();</div>
<div class="line">  <span class="comment">// Get density at integration points</span></div>
<div class="line">  list_of_operators_rhs.push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line">  list_of_operators_rhs.push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line">  list_of_operators_rhs.push_back(<span class="keyword">new</span> OpGetRhoTimeDirevative(commonData));</div>
<div class="line">  <span class="comment">// Get displacement gradient at integration points</span></div>
<div class="line">  list_of_operators_rhs.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, commonData.data.gradDispPtr));</div>
<div class="line">  list_of_operators_rhs.push_back(<span class="keyword">new</span> <a class="code" href="structOpCalculateStress.html">OpCalculateStress</a>(commonData));</div>
<div class="line">  list_of_operators_rhs.push_back(<span class="keyword">new</span> OpAssmbleStressRhs(commonData));</div>
<div class="line">  list_of_operators_rhs.push_back(<span class="keyword">new</span> OpAssmbleRhoRhs(commonData));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add operators Lhs</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *(commonData.feLhs), <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line">                     <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> &amp;list_of_operators_lhs = commonData.feLhs-&gt;getOpPtrVector();</div>
<div class="line">  <span class="comment">// Get density at integration points</span></div>
<div class="line">  list_of_operators_lhs.push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.rhoPtr));</div>
<div class="line">  list_of_operators_rhs.push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;RHO&quot;</span>, commonData.data.gradRhoPtr));</div>
<div class="line">  <span class="comment">// Get displacement gradient at integration points</span></div>
<div class="line">  list_of_operators_lhs.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, commonData.data.gradDispPtr));</div>
<div class="line">  <span class="keywordflow">if</span> (commonData.with_adol_c) {</div>
<div class="line">    list_of_operators_lhs.push_back(</div>
<div class="line">        <span class="keyword">new</span> OpCalculateStressTangentWithAdolc(commonData));</div>
<div class="line">    list_of_operators_lhs.push_back(</div>
<div class="line">        <span class="keyword">new</span> OpAssmbleStressLhs_dF&lt;true&gt;(commonData));</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    list_of_operators_lhs.push_back(<span class="keyword">new</span> OpCalculateStressTangent(commonData));</div>
<div class="line">    list_of_operators_lhs.push_back(</div>
<div class="line">        <span class="keyword">new</span> OpAssmbleStressLhs_dF&lt;false&gt;(commonData));</div>
<div class="line">  }</div>
<div class="line">  list_of_operators_lhs.push_back(<span class="keyword">new</span> OpAssmbleRhoLhs_dRho(commonData));</div>
<div class="line">  list_of_operators_lhs.push_back(<span class="keyword">new</span> OpAssmbleRhoLhs_dF(commonData));</div>
<div class="line">  list_of_operators_lhs.push_back(<span class="keyword">new</span> OpAssmbleStressLhs_dRho(commonData));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::addMomentumFluxes() {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// Add Neumann forces elements</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MetaNeummanForces::addNeumannBCElements(mField, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a94"></a><a class="code" href="structMetaNodalForces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a>(mField, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a95"></a><a class="code" href="structMetaEdgeForces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a>(mField, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// forces and pressures on surface</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MetaNeummanForces::setMomentumFluxOperators(</div>
<div class="line">      mField, commonData.neumannForces, PETSC_NULL, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <span class="comment">// noadl forces</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a96"></a><a class="code" href="structMetaNodalForces.html#a84ba4b4c66e9df18c139cb81808cadc2">MetaNodalForces::setOperators</a>(mField, commonData.nodalForces,</div>
<div class="line">                                       PETSC_NULL, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line">  <span class="comment">// edge forces</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a97"></a><a class="code" href="structMetaEdgeForces.html#a46625c9571b0469a5c4a7aa1c8f6c272">MetaEdgeForces::setOperators</a>(mField, commonData.edgeForces, PETSC_NULL,</div>
<div class="line">                                      <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (boost::ptr_map&lt;string, NeummanForcesSurface&gt;::iterator mit =</div>
<div class="line">           commonData.neumannForces.begin();</div>
<div class="line">       mit != commonData.neumannForces.end(); mit++) {</div>
<div class="line">    mit-&gt;second-&gt;methodsOp.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a98"></a><a class="code" href="structTimeForceScale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">for</span> (boost::ptr_map&lt;string, NodalForce&gt;::iterator mit =</div>
<div class="line">           commonData.nodalForces.begin();</div>
<div class="line">       mit != commonData.nodalForces.end(); mit++) {</div>
<div class="line">    mit-&gt;second-&gt;methodsOp.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structTimeForceScale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">for</span> (boost::ptr_map&lt;string, EdgeForce&gt;::iterator mit =</div>
<div class="line">           commonData.edgeForces.begin();</div>
<div class="line">       mit != commonData.edgeForces.end(); mit++) {</div>
<div class="line">    mit-&gt;second-&gt;methodsOp.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structTimeForceScale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>, <span class="keyword">false</span>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::buildDM() {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  commonData.dm_name = <span class="stringliteral">&quot;DM_REMODELING&quot;</span>;</div>
<div class="line">  <span class="comment">// Register DM problem</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a99"></a><a class="code" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(commonData.dm_name);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;commonData.dm);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(commonData.dm, commonData.dm_name);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a100"></a><a class="code" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(commonData.dm, PETSC_TRUE);</div>
<div class="line">  <span class="comment">// Create DM instance</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a101"></a><a class="code" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(commonData.dm, &amp;mField, commonData.dm_name,</div>
<div class="line">                            commonData.bitLevel);</div>
<div class="line">  <span class="comment">// Configure DM form line command options (DM itself, solvers,</span></div>
<div class="line">  <span class="comment">// pre-conditioners, ... )</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(commonData.dm);</div>
<div class="line">  <span class="comment">// Add elements to dm (only one here)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a102"></a><a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;FE_REMODELLING&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (mField.check_finite_element(<span class="stringliteral">&quot;FORCE_FE&quot;</span>)) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;FORCE_FE&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (mField.check_finite_element(<span class="stringliteral">&quot;PRESSURE_FE&quot;</span>)) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(commonData.dm, <span class="stringliteral">&quot;PRESSURE_FE&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  mField.getInterface&lt;<a name="_a103"></a><a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_TRUE;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(commonData.dm);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> Remodeling::solveDM() {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = commonData.F;</div>
<div class="line">  <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a name="a104"></a><a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a> = commonData.D;</div>
<div class="line">  Mat <a name="a105"></a><a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a> = commonData.A;</div>
<div class="line">  DM dm = commonData.dm;</div>
<div class="line">  TS ts = commonData.ts;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIFunction(ts, <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, PETSC_NULL, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIJacobian(ts, <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>, <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>, PETSC_NULL, PETSC_NULL);</div>
<div class="line">  <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line"><span class="preprocessor">#if PETSC_VERSION_GE(3, 8, 0)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetMaxTime(ts, ftime);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, dm);</div>
<div class="line"> </div>
<div class="line">  SNES snes;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">  KSP ksp;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetKSP(snes, &amp;ksp);</div>
<div class="line">  PC pc;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(ksp, &amp;pc);</div>
<div class="line">  PetscBool is_pcfs = PETSC_FALSE;</div>
<div class="line">  PetscObjectTypeCompare((PetscObject)pc, PCFIELDSPLIT, &amp;is_pcfs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up FIELDSPLIT</span></div>
<div class="line">  <span class="comment">// Only is user set -pc_type fieldsplit</span></div>
<div class="line">  <span class="keywordflow">if</span> (is_pcfs == PETSC_TRUE) {</div>
<div class="line">    IS is_disp, is_rho;</div>
<div class="line">    <span class="keyword">const</span> <a name="_a106"></a><a class="code" href="structMoFEM_1_1Problem.html">MoFEM::Problem</a> *problem_ptr;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a107"></a><a class="code" href="group__dm.html#ga4cafea643e191089b31207ebb16842c9">DMMoFEMGetProblemPtr</a>(dm, &amp;problem_ptr);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a name="_a108"></a><a class="code" href="structMoFEM_1_1ISManager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line">        problem_ptr-&gt;<a name="a109"></a><a class="code" href="structMoFEM_1_1Problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <a name="a110"></a><a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;DISPLACEMENTS&quot;</span>, 0, 3, &amp;is_disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ISManager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line">        problem_ptr-&gt;<a class="code" href="structMoFEM_1_1Problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;RHO&quot;</span>, 0, 1, &amp;is_rho);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISSort(is_disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISSort(is_rho);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is_disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is_rho);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;is_disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;is_rho);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Monitor</span></div>
<div class="line">  <a name="_a111"></a><a class="code" href="structMonitorPostProc.html">MonitorPostProc</a> post_proc(mField, commonData);</div>
<div class="line">  <a name="_a112"></a><a class="code" href="structMoFEM_1_1TsCtx.html">TsCtx</a> *<a name="a113"></a><a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>;</div>
<div class="line">  <a name="a114"></a><a class="code" href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">DMMoFEMGetTsCtx</a>(dm, &amp;<a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>-&gt;<a name="a115"></a><a class="code" href="structMoFEM_1_1TsCtx.html#acff5d8c90f86442e86bd19337c8e30a5">getPostProcessMonitor</a>().push_back(&amp;post_proc);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, <a name="a116"></a><a class="code" href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">TsMonitorSet</a>, <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>, PETSC_NULL);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if PETSC_VERSION_GE(3, 7, 0)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetExactFinalTime(ts, TS_EXACTFINALTIME_STEPOVER);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTime(ts, &amp;ftime);</div>
<div class="line">  PetscInt steps, snesfails, rejects, nonlinits, linits;</div>
<div class="line"><span class="preprocessor">#if PETSC_VERSION_LE(3, 8, 0)</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStepNumber(ts, &amp;steps);</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepNumber(ts, &amp;steps);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESFailures(ts, &amp;snesfails);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepRejections(ts, &amp;rejects);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESIterations(ts, &amp;nonlinits);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetKSPIterations(ts, &amp;linits);</div>
<div class="line">  PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">              <span class="stringliteral">&quot;steps %D (%D rejected, %D SNES fails), ftime %g, nonlinits %D, &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;linits %D\n&quot;</span>,</div>
<div class="line">              steps, rejects, snesfails, ftime, nonlinits, linits);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (commonData.is_atom_testing) {</div>
<div class="line">    <span class="keywordflow">if</span> (commonData.cUrrent_psi &lt; 1.67 || commonData.cUrrent_psi &gt; 1.68)</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a name="a117"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;atom test diverged&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpMassAndEnergyCalculation::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, EntityType row_type,</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (row_type != MBVERTEX)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">  <span class="comment">// commonData.data.vecPsi.resize(nb_gauss_pts,false);</span></div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*commonData.data.rhoPtr);</div>
<div class="line">  <span class="keyword">auto</span> psi = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData.data.vecPsi);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> energy = 0;</div>
<div class="line">  <span class="keywordtype">double</span> mass = 0;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg &lt; nb_gauss_pts; gg++) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume() * getGaussPts()(3, gg);</div>
<div class="line">    energy += vol * psi;</div>
<div class="line">    mass += vol * <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line"> </div>
<div class="line">    ++psi;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(energVec, 0, energy, ADD_VALUES);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(massVec, 0, mass, ADD_VALUES);</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace BoneRemodeling</span></div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a2a1a0695ea7feb3a1e73a8707ef9f083"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">MoFEM::Types::VectorDouble3</a></div><div class="ttdeci">VectorBoundedArray&lt; double, 3 &gt; VectorDouble3</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00092">Types.hpp:92</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a></div><div class="ttdeci">@ MOFEM_STD_EXCEPTION_THROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00039">definitions.h:39</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a5f9f4333af411bf4de37445782aca1b5"><div class="ttname"><a href="structMonitorPostProc.html#a5f9f4333af411bf4de37445782aca1b5">MonitorPostProc::postProcess</a></div><div class="ttdeci">MoFEMErrorCode postProcess()</div><div class="ttdoc">function is run at the end of loop</div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00133">nonlinear_dynamics.cpp:133</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:8</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a882b61442aebc50fe467fe15a09ee85c"><div class="ttname"><a href="Remodeling_8cpp.html#a882b61442aebc50fe467fe15a09ee85c">SYMMETRIC_TENSOR4_MAT_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR4_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition:</b> <a href="Remodeling_8cpp_source.html#l00040">Remodeling.cpp:40</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a0447f1370e525557f8d7c6a1ed22be14"><div class="ttname"><a href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a></div><div class="ttdeci">double young_modulus</div><div class="ttdoc">Young modulus.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00121">plastic.cpp:121</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMetaNodalForces_html_a8e0b96853208e8320b7268f96f4fd8ee"><div class="ttname"><a href="structMetaNodalForces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition:</b> <a href="NodalForce_8hpp_source.html#l00092">NodalForce.hpp:92</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00140">plastic.cpp:140</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00674">HODataOperators.hpp:674</a></div></div>
<div class="ttc" id="astructNonlinearElasticElement_html"><div class="ttname"><a href="structNonlinearElasticElement.html">NonlinearElasticElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of nonlinear elastic element</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00027">HookeElement.hpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_acff5d8c90f86442e86bd19337c8e30a5"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#acff5d8c90f86442e86bd19337c8e30a5">MoFEM::TsCtx::getPostProcessMonitor</a></div><div class="ttdeci">BasicMethodsSequence &amp; getPostProcessMonitor()</div><div class="ttdoc">Get the postProcess to do Monitor object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00144">TsCtx.hpp:144</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html_a0f791f1e62ed3fc3a7a72dc3946490fc"><div class="ttname"><a href="structOpPostProcStress.html#a0f791f1e62ed3fc3a7a72dc3946490fc">OpPostProcStress::OpPostProcStress</a></div><div class="ttdeci">OpPostProcStress(moab::Interface &amp;post_proc_mesh, std::vector&lt; EntityHandle &gt; &amp;map_gauss_pts, DataAtIntegrationPts &amp;common_data, BlockData &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00436">ElasticityMixedFormulation.hpp:436</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_aff752f795f2d1fdbee680e2e1630d50c"><div class="ttname"><a href="Remodeling_8cpp.html#aff752f795f2d1fdbee680e2e1630d50c">TENSOR4_MAT_PTR</a></div><div class="ttdeci">#define TENSOR4_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition:</b> <a href="Remodeling_8cpp_source.html#l00048">Remodeling.cpp:48</a></div></div>
<div class="ttc" id="afem__tools_8h_html_ae1ddae80f6ff785f38a0c3bfb9259932"><div class="ttname"><a href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a></div><div class="ttdeci">#define LAMBDA(E, NU)</div><div class="ttdef"><b>Definition:</b> <a href="fem__tools_8h_source.html#l00022">fem_tools.h:22</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aBasicFiniteElements_8hpp_html"><div class="ttname"><a href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Projection10NodeCoordsOnField_html"><div class="ttname"><a href="structMoFEM_1_1Projection10NodeCoordsOnField.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_a771a8d2443d7bec47aef196b5d23ade2"><div class="ttname"><a href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a></div><div class="ttdeci">FTensor::Index&lt; 'J', DIM1 &gt; J</div><div class="ttdef"><b>Definition:</b> <a href="level__set_8cpp_source.html#l00030">level_set.cpp:30</a></div></div>
<div class="ttc" id="astructElasticMaterials_html"><div class="ttname"><a href="structElasticMaterials.html">ElasticMaterials</a></div><div class="ttdoc">Manage setting parameters and constitutive equations for nonlinear/linear elastic materials.</div><div class="ttdef"><b>Definition:</b> <a href="ElasticMaterials_8hpp_source.html#l00024">ElasticMaterials.hpp:24</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2__symmetric_html"><div class="ttname"><a href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor2__symmetric__value_8hpp_source.html#l00013">Tensor2_symmetric_value.hpp:13</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition:</b> <a href="level__set_8cpp_source.html#l01932">level_set.cpp:1932</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">MoFEM::ForcesAndSourcesCore::UserDataOperator::OPROWCOL</a></div><div class="ttdeci">@ OPROWCOL</div><div class="ttdoc">operator doWork is executed on FE rows &amp;columns</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00569">ForcesAndSourcesCore.hpp:569</a></div></div>
<div class="ttc" id="aRemodeling_8hpp_html"><div class="ttname"><a href="Remodeling_8hpp.html">Remodeling.hpp</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt; double *, 3, 3 &gt;</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">MoFEM::OpCalculateScalarFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01293">UserDataOperators.hpp:1293</a></div></div>
<div class="ttc" id="astructOpPostProcStress_html"><div class="ttname"><a href="structOpPostProcStress.html">OpPostProcStress</a></div><div class="ttdef"><b>Definition:</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00429">ElasticityMixedFormulation.hpp:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a99b759dd71581f497626034776727d3d"><div class="ttname"><a href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a></div><div class="ttdeci">constexpr IntegrationType I</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00031">operators_tests.cpp:31</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a7064ec9e939c81c212cc726272c0e088"><div class="ttname"><a href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">MoFEM::invertTensor3by3</a></div><div class="ttdeci">MoFEMErrorCode invertTensor3by3(ublas::matrix&lt; T, L, A &gt; &amp;jac_data, ublas::vector&lt; T, A &gt; &amp;det_data, ublas::matrix&lt; T, L, A &gt; &amp;inv_jac_data)</div><div class="ttdoc">Calculate inverse of tensor rank 2 at integration points.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01588">Templates.hpp:1588</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1654dd29ff9af437332ec55af104ff48"><div class="ttname"><a href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">MoFEM::TsMonitorSet</a></div><div class="ttdeci">PetscErrorCode TsMonitorSet(TS ts, PetscInt step, PetscReal t, Vec u, void *ctx)</div><div class="ttdoc">Set monitor for TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8cpp_source.html#l00259">TsCtx.cpp:259</a></div></div>
<div class="ttc" id="astructMetaNodalForces_html_a84ba4b4c66e9df18c139cb81808cadc2"><div class="ttname"><a href="structMetaNodalForces.html#a84ba4b4c66e9df18c139cb81808cadc2">MetaNodalForces::setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, NodalForce &gt; &amp;nodal_forces, Vec F, const std::string field_name)</div><div class="ttdoc">Set integration point operators.</div><div class="ttdef"><b>Definition:</b> <a href="NodalForce_8hpp_source.html#l00128">NodalForce.hpp:128</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructPostProcStress_html"><div class="ttname"><a href="structPostProcStress.html">PostProcStress</a></div><div class="ttdef"><b>Definition:</b> <a href="PostProcStresses_8hpp_source.html#l00017">PostProcStresses.hpp:17</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a4f20638920306c93091822d641af4749"><div class="ttname"><a href="Remodeling_8cpp.html#a4f20638920306c93091822d641af4749">SYMMETRIC_TENSOR2_MAT_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR2_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition:</b> <a href="Remodeling_8cpp_source.html#l00054">Remodeling.cpp:54</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a695bc88c72bd41eeac7ef7f6d628d014"><div class="ttname"><a href="structMonitorPostProc.html#a695bc88c72bd41eeac7ef7f6d628d014">MonitorPostProc::operator()</a></div><div class="ttdeci">MoFEMErrorCode operator()()</div><div class="ttdoc">function is run for every finite element</div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00128">nonlinear_dynamics.cpp:128</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ISManager_html"><div class="ttname"><a href="structMoFEM_1_1ISManager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition:</b> <a href="ISManager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="astructTimeForceScale_html"><div class="ttname"><a href="structTimeForceScale.html">TimeForceScale</a></div><div class="ttdoc">Force scale operator for reading two columns.</div><div class="ttdef"><b>Definition:</b> <a href="tutorials_2src_2TimeForceScale_8hpp_source.html#l00018">TimeForceScale.hpp:18</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aa464ad90a188180427136b22e078ec7d"><div class="ttname"><a href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">MoFEM::getFTensor0FromVec</a></div><div class="ttdeci">static auto getFTensor0FromVec(ublas::vector&lt; T, A &gt; &amp;data)</div><div class="ttdoc">Get tensor rank 0 (scalar) form data vector.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l00135">Templates.hpp:135</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#afe126bba33dea88b653abccb8b07feedacf00a0516290b19a340cc5455ef03492">EshelbianPlasticity::P</a></div><div class="ttdeci">@ P</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianContact_8cpp_source.html#l00197">EshelbianContact.cpp:197</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValues.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00082">UserDataOperators.hpp:82</a></div></div>
<div class="ttc" id="anamespaceBoneRemodeling_html"><div class="ttname"><a href="namespaceBoneRemodeling.html">BoneRemodeling</a></div><div class="ttdef"><b>Definition:</b> <a href="DensityMaps_8hpp_source.html#l00027">DensityMaps.hpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html">MoFEM::TsCtx</a></div><div class="ttdoc">Interface for Time Stepping (TS) solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00017">TsCtx.hpp:17</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a571fc4d0022947a6d01a56a53d5668e6"><div class="ttname"><a href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a></div><div class="ttdeci">double poisson_ratio</div><div class="ttdoc">Poisson ratio.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00122">plastic.cpp:122</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_ad6f70f52c3f4c77276fc985a3f7a2795"><div class="ttname"><a href="structMonitorPostProc.html#ad6f70f52c3f4c77276fc985a3f7a2795">MonitorPostProc::MonitorPostProc</a></div><div class="ttdeci">MonitorPostProc(MoFEM::Interface &amp;m_field, std::map&lt; int, NonlinearElasticElement::BlockData &gt; &amp;set_of_blocks, NonlinearElasticElement::MyVolumeFE &amp;fe_elastic_energy, ConvectiveMassElement::MyVolumeFE &amp;fe_kinetic_energy)</div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00045">nonlinear_dynamics.cpp:45</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a123875fb03925a9640697591e972412c"><div class="ttname"><a href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">MoFEM::L</a></div><div class="ttdeci">VectorDouble L</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00124">Projection10NodeCoordsOnField.cpp:124</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a></div><div class="ttdeci">@ MOFEM_OPERATION_UNSUCCESSFUL</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00034">definitions.h:34</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor4_html"><div class="ttname"><a href="classFTensor_1_1Tensor4.html">FTensor::Tensor4</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor4__value_8hpp_source.html#l00018">Tensor4_value.hpp:18</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html_a6d18eec583bf6954ef3789baf7f6b8c8"><div class="ttname"><a href="structMonitorPostProc.html#a6d18eec583bf6954ef3789baf7f6b8c8">MonitorPostProc::preProcess</a></div><div class="ttdeci">MoFEMErrorCode preProcess()</div><div class="ttdoc">function is run at the beginning of loop</div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00080">nonlinear_dynamics.cpp:80</a></div></div>
<div class="ttc" id="aElasticMaterials_8hpp_html"><div class="ttname"><a href="ElasticMaterials_8hpp.html">ElasticMaterials.hpp</a></div><div class="ttdoc">Elastic materials.</div></div>
<div class="ttc" id="astructOpPostProcStress_html_adc555582171e7be6434277c8808a3395"><div class="ttname"><a href="structOpPostProcStress.html#adc555582171e7be6434277c8808a3395">OpPostProcStress::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int side, EntityType type, EntitiesFieldData::EntData &amp;data)</div><div class="ttdef"><b>Definition:</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00451">ElasticityMixedFormulation.hpp:451</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a1342a5bb82a44eb578a7246723649d11"><div class="ttname"><a href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a></div><div class="ttdeci">EntitiesFieldData::EntData EntData</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00037">child_and_parent.cpp:37</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', 3 &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">MoFEM::OpCalculateVectorFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01535">UserDataOperators.hpp:1535</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a7e74026b069250283fc770ea21369587"><div class="ttname"><a href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">convert.n</a></div><div class="ttdeci">n</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00082">convert.py:82</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html_a9bc89d8801014833b9aebda666bac8ed"><div class="ttname"><a href="structOpCalculateStress.html#a9bc89d8801014833b9aebda666bac8ed">OpCalculateStress::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntData &amp;row_data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div></div>
<div class="ttc" id="astructMetaEdgeForces_html_ad4ba172a5f79e0c41430c6dcecdd95f8"><div class="ttname"><a href="structMetaEdgeForces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition:</b> <a href="EdgeForce_8hpp_source.html#l00062">EdgeForce.hpp:62</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae3a0416ae2eb4b327e43ef2dfc21a15a"><div class="ttname"><a href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">MoFEM::determinantTensor3by3</a></div><div class="ttdeci">static auto determinantTensor3by3(T &amp;t)</div><div class="ttdoc">Calculate the determinant of a 3x3 matrix or a tensor of rank 2.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01540">Templates.hpp:1540</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html_aa8fb336855ab8b3de4fa7c8d739a0728"><div class="ttname"><a href="structOpCalculateStress.html#aa8fb336855ab8b3de4fa7c8d739a0728">OpCalculateStress::OpCalculateStress</a></div><div class="ttdeci">OpCalculateStress(const std::string row_field, const std::string col_field, boost::shared_ptr&lt; DataAtIntegrationPts &gt; data_at_pts)</div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition:</b> <a href="enable__if_8hpp_source.html#l00005">enable_if.hpp:5</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Ddg_html"><div class="ttname"><a href="classFTensor_1_1Ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition:</b> <a href="Ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:7</a></div></div>
<div class="ttc" id="alapack__wrap_8h_html_a9d34be2f8a6a32580830207f2b827529"><div class="ttname"><a href="lapack__wrap_8h.html#a9d34be2f8a6a32580830207f2b827529">lapack_dsyev</a></div><div class="ttdeci">static __CLPK_integer lapack_dsyev(char jobz, char uplo, __CLPK_integer n, __CLPK_doublereal *a, __CLPK_integer lda, __CLPK_doublereal *w, __CLPK_doublereal *work, __CLPK_integer lwork)</div><div class="ttdef"><b>Definition:</b> <a href="lapack__wrap_8h_source.html#l00261">lapack_wrap.h:261</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a582835fd072f2ee1a3370455cf2b57cc"><div class="ttname"><a href="Remodeling_8cpp.html#a582835fd072f2ee1a3370455cf2b57cc">TENSOR2_MAT_PTR</a></div><div class="ttdeci">#define TENSOR2_MAT_PTR(MAT)</div><div class="ttdef"><b>Definition:</b> <a href="Remodeling_8cpp_source.html#l00050">Remodeling.cpp:50</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_a74577585cf12d1712ab9c57616d49205"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a></div><div class="ttdeci">double mu</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00098">dynamic_first_order_con_law.cpp:98</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition:</b> <a href="incompressible__elasticity_8cpp_source.html#l00199">incompressible_elasticity.cpp:199</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="agroup__dm_html_ga4cafea643e191089b31207ebb16842c9"><div class="ttname"><a href="group__dm.html#ga4cafea643e191089b31207ebb16842c9">MoFEM::DMMoFEMGetProblemPtr</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetProblemPtr(DM dm, const MoFEM::Problem **problem_ptr)</div><div class="ttdoc">Get pointer to problem data structure.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00426">DMMoFEM.cpp:426</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_ac1d820a203fd9a7f34f3a3257b2d38b7"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MoFEM::Types::MatrixDouble3by3</a></div><div class="ttdeci">MatrixBoundedArray&lt; double, 9 &gt; MatrixDouble3by3</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00105">Types.hpp:105</a></div></div>
<div class="ttc" id="agroup__dm_html_ga81d1702e6a5cbe505aa79e94c4aa9d74"><div class="ttname"><a href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">MoFEM::DMMoFEMGetTsCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetTsCtx(DM dm, MoFEM::TsCtx **ts_ctx)</div><div class="ttdoc">get MoFEM::TsCtx data structure</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01142">DMMoFEM.cpp:1142</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html"><div class="ttname"><a href="structOpCalculateStress.html">OpCalculateStress</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00153">HookeElement.hpp:153</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html_a6078a7f940fe823a1c1ccb4cc277e03e"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">ReactionDiffusionEquation::D</a></div><div class="ttdeci">const double D</div><div class="ttdoc">diffusivity</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00020">reaction_diffusion.cpp:20</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="aRemodeling_8cpp_html_a0a80843c43c1fe98a79754f2051a2001"><div class="ttname"><a href="Remodeling_8cpp.html#a0a80843c43c1fe98a79754f2051a2001">SYMMETRIC_TENSOR2_VEC_PTR</a></div><div class="ttdeci">#define SYMMETRIC_TENSOR2_VEC_PTR(VEC)</div><div class="ttdef"><b>Definition:</b> <a href="Remodeling_8cpp_source.html#l00057">Remodeling.cpp:57</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html"><div class="ttname"><a href="structMoFEM_1_1Problem.html">MoFEM::Problem</a></div><div class="ttdoc">keeps basic data about problem</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00054">ProblemsMultiIndices.hpp:54</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html"><div class="ttname"><a href="structMonitorPostProc.html">MonitorPostProc</a></div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00030">nonlinear_dynamics.cpp:30</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html_ac27123017bcc40cd4259e674a7318b3c"><div class="ttname"><a href="structMoFEM_1_1Problem.html#ac27123017bcc40cd4259e674a7318b3c">MoFEM::Problem::getName</a></div><div class="ttdeci">auto getName() const</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00372">ProblemsMultiIndices.hpp:372</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FieldBlas_html"><div class="ttname"><a href="structMoFEM_1_1FieldBlas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition:</b> <a href="FieldBlas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a0cf798297f89cab062647ff3ac11632d"><div class="ttname"><a href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a></div><div class="ttdeci">#define MU(E, NU)</div><div class="ttdef"><b>Definition:</b> <a href="fem__tools_8h_source.html#l00023">fem_tools.h:23</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">MoFEM::ForcesAndSourcesCore::UserDataOperator::OPROW</a></div><div class="ttdeci">@ OPROW</div><div class="ttdoc">operator doWork function is executed on FE rows</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00567">ForcesAndSourcesCore.hpp:567</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01123">DMMoFEM.cpp:1123</a></div></div>
<div class="ttc" id="astructMetaEdgeForces_html_a46625c9571b0469a5c4a7aa1c8f6c272"><div class="ttname"><a href="structMetaEdgeForces.html#a46625c9571b0469a5c4a7aa1c8f6c272">MetaEdgeForces::setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, EdgeForce &gt; &amp;edge_forces, Vec F, const std::string field_name, std::string mesh_node_positions=&quot;MESH_NODE_POSITIONS&quot;)</div><div class="ttdoc">Set integration point operators.</div><div class="ttdef"><b>Definition:</b> <a href="EdgeForce_8hpp_source.html#l00097">EdgeForce.hpp:97</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>