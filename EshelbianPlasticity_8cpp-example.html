<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: EshelbianPlasticity.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">EshelbianPlasticity.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>Eshelbian plasticity implementation.</p>
<p>Eshelbian plasticity implementation</p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file EshelbianPlasticity.cpp</span></div>
<div class="line"><span class="comment"> * \example EshelbianPlasticity.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brief Eshelbian plasticity implementation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SINGULARITY</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="CGGTonsorialBubbleBase_8hpp.html">CGGTonsorialBubbleBase.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianPlasticity_8hpp.html">EshelbianPlasticity.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/math/constants/constants.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cholesky_8hpp.html">cholesky.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#ifdef ENABLE_PYTHON_BINDING</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python/def.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python/numpy.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>bp = boost::python;</div>
<div class="line"><span class="keyword">namespace </span>np = boost::python::numpy;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">  #pragma message &quot;With ENABLE_PYTHON_BINDING&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">  #pragma message &quot;Without ENABLE_PYTHON_BINDING&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianAux_8hpp.html">EshelbianAux.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianContact_8hpp.html">EshelbianContact.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quad_8h.html">phg-quadrule/quad.h</a>&gt;</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;queue&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceEshelbianPlasticity.html">EshelbianPlasticity</a> {</div>
<div class="line"><span class="keyword">struct </span>VolUserDataOperatorStabAssembly</div>
<div class="line">    : <span class="keyword">public</span> <a id="_a0" name="_a0"></a><a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolumeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <span class="keyword">using </span>VolumeElementForcesAndSourcesCore::UserDataOperator::UserDataOperator;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>FaceUserDataOperatorStabAssembly</div>
<div class="line">    : <span class="keyword">public</span> <a id="_a1" name="_a1"></a><a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <span class="keyword">using </span>FaceElementForcesAndSourcesCore::UserDataOperator::UserDataOperator;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace EshelbianPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a2" name="a2"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a559a80330b1f767e8e9b59d89a31eac5">send_type</a>(<a id="_a3" name="_a3"></a><a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, <a id="_a4" name="_a4"></a><a class="code hl_class" href="classRange.html">Range</a> r,</div>
<div class="line">                      <span class="keyword">const</span> EntityType type) {</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a id="a5" name="a5"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a id="a6" name="a6"></a><a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dim = CN::Dimension(type);</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;int&gt; sendcounts(pcomm-&gt;size());</div>
<div class="line">  std::vector&lt;int&gt; displs(pcomm-&gt;size());</div>
<div class="line">  std::vector&lt;int&gt; sendbuf(<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size());</div>
<div class="line">  <span class="keywordflow">if</span> (pcomm-&gt;rank() == 0) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = 1; p != pcomm-&gt;size(); p++) {</div>
<div class="line">      <span class="keyword">auto</span> part_ents = m_field.<a id="a7" name="a7"></a><a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a8" name="_a8"></a><a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()</div>
<div class="line">                           -&gt;getPartEntities(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), p)</div>
<div class="line">                           .subset_by_dimension(<a id="a9" name="a9"></a><a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">      <a id="a10" name="a10"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(part_ents, dim, <span class="keyword">true</span>, faces,</div>
<div class="line">                                                moab::Interface::UNION);</div>
<div class="line">      faces = intersect(faces, r);</div>
<div class="line">      sendcounts[p] = faces.size();</div>
<div class="line">      displs[p] = sendbuf.size();</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : faces) {</div>
<div class="line">        <span class="keyword">auto</span> <span class="keywordtype">id</span> = <a class="code hl_function" href="namespaceMoFEM.html#a49ed784a72b0b18b4cd6f983539fe3b5">id_from_handle</a>(f);</div>
<div class="line">        sendbuf.push_back(<span class="keywordtype">id</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> recv_data;</div>
<div class="line">  MPI_Scatter(sendcounts.data(), 1, MPI_INT, &amp;recv_data, 1, MPI_INT, 0,</div>
<div class="line">              pcomm-&gt;comm());</div>
<div class="line">  std::vector&lt;int&gt; recvbuf(recv_data);</div>
<div class="line">  MPI_Scatterv(sendbuf.data(), sendcounts.data(), displs.data(), MPI_INT,</div>
<div class="line">               recvbuf.data(), recv_data, MPI_INT, 0, pcomm-&gt;comm());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (pcomm-&gt;rank() &gt; 0) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;f : recvbuf) {</div>
<div class="line">      <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.insert(<a class="code hl_function" href="namespaceMoFEM.html#afbff5c771275ba60387bc33d5dd981b2">ent_form_type_and_id</a>(type, f));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a11" name="a11"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                 <span class="keyword">const</span> std::string block_name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mesh_mng = m_field.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a12" name="_a12"></a><a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bcs = mesh_mng-&gt;<a id="a13" name="a13"></a><a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line"> </div>
<div class="line">      std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % block_name).str())</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bcs) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a id="a14" name="a14"></a><a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(bc-&gt;getMeshsetIdEntitiesByDimension(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), dim,</div>
<div class="line">                                                       faces, <span class="keyword">true</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;get meshset ents&quot;</span>);</div>
<div class="line">    <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.merge(faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a15" name="a15"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a718f0d15355f2dc01f5d980449529b34">get_range_from_block_map</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                     <span class="keyword">const</span> std::string block_name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">  std::map&lt;std::string, Range&gt; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mesh_mng = m_field.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bcs = mesh_mng-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line"> </div>
<div class="line">      std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % block_name).str())</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bcs) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(bc-&gt;getMeshsetIdEntitiesByDimension(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), dim,</div>
<div class="line">                                                       faces, <span class="keyword">true</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;get meshset ents&quot;</span>);</div>
<div class="line">    <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>[bc-&gt;getName()] = faces;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a16" name="a16"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a652208c3378b6381518790e0b1cdfc96">get_block_meshset</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, <span class="keyword">const</span> <span class="keywordtype">int</span> ms_id,</div>
<div class="line">                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cubit_bc_type) {</div>
<div class="line">  <span class="keyword">auto</span> mesh_mng = m_field.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  EntityHandle meshset;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mesh_mng-&gt;<a id="a17" name="a17"></a><a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(ms_id, cubit_bc_type, meshset);</div>
<div class="line">  <span class="keywordflow">return</span> meshset;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a18" name="a18"></a><a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab::Interface &amp;moab, <span class="keyword">const</span> std::string name,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code hl_class" href="classRange.html">Range</a> r, std::vector&lt;Tag&gt; tags = {}) {</div>
<div class="line">  <a id="a19" name="a19"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> out_meshset = <a class="code hl_function" href="namespaceMoFEM.html#ad17eefd5d88d2b51c71ec46cae8569ac">get_temp_meshset_ptr</a>(moab);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(*out_meshset, r);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size()) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, out_meshset-&gt;get_ptr(), 1,</div>
<div class="line">                           tags.data(), tags.size());</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a id="a20" name="a20"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::warning) &lt;&lt; <span class="stringliteral">&quot;Empty range for &quot;</span> &lt;&lt; name;</div>
<div class="line">  }</div>
<div class="line">  <a id="a21" name="a21"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a22" name="a22"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;skin) {</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> boundary_ents;</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin,</div>
<div class="line">                                       PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                       PSTATUS_NOT, -1, &amp;boundary_ents),</div>
<div class="line">                 <span class="stringliteral">&quot;filter_pstatus&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a23" name="a23"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="classRange.html">Range</a> skin) {</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> owner_ents;</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin, PSTATUS_NOT_OWNED, PSTATUS_NOT, -1,</div>
<div class="line">                                       &amp;owner_ents),</div>
<div class="line">                 <span class="stringliteral">&quot;filter_pstatus&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> owner_ents;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a24" name="a24"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="classRange.html">Range</a> body_ents) {</div>
<div class="line">  Skinner skin(&amp;m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> skin_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents), <span class="stringliteral">&quot;find_skin&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a25" name="a25"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#af63d38d75712794be9ff9cde96486dfa">get_crack_front_edges</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                  <a class="code hl_class" href="classRange.html">Range</a> crack_faces) {</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <span class="keyword">auto</span> &amp;moab = m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> crack_skin_without_bdy;</div>
<div class="line">  <span class="keywordflow">if</span> (pcomm-&gt;rank() == 0) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> crack_edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(crack_faces, 1, <span class="keyword">true</span>, crack_edges,</div>
<div class="line">                                moab::Interface::UNION);</div>
<div class="line">    <span class="keyword">auto</span> crack_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, crack_faces);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">        m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents),</div>
<div class="line">        <span class="stringliteral">&quot;get_entities_by_dimension&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, body_ents);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> body_skin_edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(body_skin, 1, <span class="keyword">true</span>, body_skin_edges,</div>
<div class="line">                                        moab::Interface::UNION),</div>
<div class="line">                   <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">    crack_skin_without_bdy = subtract(crack_skin, body_skin_edges);</div>
<div class="line">    <span class="keyword">auto</span> front_edges_map = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a718f0d15355f2dc01f5d980449529b34">get_range_from_block_map</a>(m_field, <span class="stringliteral">&quot;FRONT&quot;</span>, 1);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a id="a26" name="a26"></a><a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : front_edges_map) {</div>
<div class="line">      <span class="keyword">auto</span> add_front = subtract(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, crack_edges);</div>
<div class="line">      <span class="keyword">auto</span> <a id="a27" name="a27"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = intersect(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, crack_edges);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>.empty()) {</div>
<div class="line">        crack_skin_without_bdy.merge(add_front);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keyword">auto</span> i_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> adj_i_skin;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(i_skin, 1, <span class="keyword">true</span>, adj_i_skin,</div>
<div class="line">                                    moab::Interface::UNION);</div>
<div class="line">        adj_i_skin = subtract(intersect(adj_i_skin, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second), crack_edges);</div>
<div class="line">        crack_skin_without_bdy.merge(adj_i_skin);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a559a80330b1f767e8e9b59d89a31eac5">send_type</a>(m_field, crack_skin_without_bdy, MBEDGE);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a28" name="a28"></a><a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a711a5a75b4797d9d4f46d1a45dccaf32">get_two_sides_of_crack_surface</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                           <a class="code hl_class" href="classRange.html">Range</a> crack_faces) {</div>
<div class="line"> </div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;get_two_sides_of_crack_surface&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!pcomm-&gt;rank()) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> impl = [&amp;](<span class="keyword">auto</span> &amp;saids) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> &amp;moab = m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> dim) {</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                           e, dim, <span class="keyword">true</span>, adj, moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> adj;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_conn = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, <span class="keyword">true</span>),</div>
<div class="line">                       <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> conn;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a id="a29" name="a29"></a><a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                          body_ents);</div>
<div class="line">      <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, body_ents);</div>
<div class="line">      <span class="keyword">auto</span> body_skin_edges = get_adj(body_skin, 1);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> crack_skin =</div>
<div class="line">          subtract(<a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, crack_faces), body_skin_edges);</div>
<div class="line">      <span class="keyword">auto</span> crack_skin_conn = get_conn(crack_skin);</div>
<div class="line">      <span class="keyword">auto</span> crack_skin_conn_edges = get_adj(crack_skin_conn, 1);</div>
<div class="line">      <span class="keyword">auto</span> crack_edges = get_adj(crack_faces, 1);</div>
<div class="line">      crack_edges = subtract(crack_edges, crack_skin);</div>
<div class="line">      <span class="keyword">auto</span> all_tets = get_adj(crack_edges, 3);</div>
<div class="line">      crack_edges = subtract(crack_edges, crack_skin_conn_edges);</div>
<div class="line">      <span class="keyword">auto</span> crack_conn = get_conn(crack_edges);</div>
<div class="line">      all_tets.merge(get_adj(crack_conn, 3));</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;crack_faces.vtk&quot;</span>, crack_faces);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;all_crack_tets.vtk&quot;</span>, all_tets);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;crack_edges_all.vtk&quot;</span>,</div>
<div class="line">                          crack_edges);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (crack_faces.size()) {</div>
<div class="line">        <span class="keyword">auto</span> grow = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">          <span class="keyword">auto</span> crack_faces_conn = get_conn(crack_faces);</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> <a id="a30" name="a30"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line">          <span class="keyword">auto</span> size_r = 0;</div>
<div class="line">          <span class="keywordflow">while</span> (size_r != <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size() &amp;&amp; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size() &gt; 0) {</div>
<div class="line">            size_r = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size();</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(r, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">true</span>);</div>
<div class="line">            <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = subtract(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, crack_faces_conn);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.size()) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>, r,</div>
<div class="line">                                          moab::Interface::UNION);</div>
<div class="line">              <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = intersect(r, all_tets);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.empty()) {</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> all_tets_ord = all_tets;</div>
<div class="line">        <span class="keywordflow">while</span> (all_tets.size()) {</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> faces = get_adj(unite(saids.first, saids.second), 2);</div>
<div class="line">          faces = subtract(crack_faces, faces);</div>
<div class="line">          <span class="keywordflow">if</span> (faces.size()) {</div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> tets;</div>
<div class="line">            <span class="keyword">auto</span> fit = faces.begin();</div>
<div class="line">            <span class="keywordflow">for</span> (; fit != faces.end(); ++fit) {</div>
<div class="line">              tets = intersect(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(*fit, *fit), 3), all_tets);</div>
<div class="line">              <span class="keywordflow">if</span> (tets.size() == 2) {</div>
<div class="line">                <span class="keywordflow">break</span>;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">if</span> (tets.empty()) {</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">              saids.first.insert(tets[0]);</div>
<div class="line">              saids.first = grow(saids.first);</div>
<div class="line">              all_tets = subtract(all_tets, saids.first);</div>
<div class="line">              <span class="keywordflow">if</span> (tets.size() == 2) {</div>
<div class="line">                saids.second.insert(tets[1]);</div>
<div class="line">                saids.second = grow(saids.second);</div>
<div class="line">                all_tets = subtract(all_tets, saids.second);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        saids.first = subtract(all_tets_ord, saids.second);</div>
<div class="line">        saids.second = subtract(all_tets_ord, saids.first);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    std::pair&lt;Range, Range&gt; saids;</div>
<div class="line">    <span class="keywordflow">if</span> (crack_faces.size())</div>
<div class="line">      <a id="a31" name="a31"></a><a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(impl(saids), <span class="stringliteral">&quot;get crack both sides&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> saids;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;get_two_sides_of_crack_surface &lt;- done&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> std::pair&lt;Range, Range&gt;();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespaceEshelbianPlasticity.html">EshelbianPlasticity</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SetIntegrationAtFrontVolume {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a7dc972d07b328600c38de68bd13b3d85">SetIntegrationAtFrontVolume</a>(boost::shared_ptr&lt;Range&gt; front_nodes,</div>
<div class="line">                              boost::shared_ptr&lt;Range&gt; front_edges)</div>
<div class="line">      : <a id="a32" name="a32"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>(front_nodes), <a id="a33" name="a33"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>(front_edges){};</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a34" name="a34"></a><a class="code hl_function" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1b019460b638fe37940b91de58a6e910">operator()</a>(<a id="_a35" name="_a35"></a><a class="code hl_struct" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                            <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numNodes = 4;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numEdges = 6;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> refinementLevels = 4;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = fe_raw_ptr-&gt;<a id="a36" name="a36"></a><a class="code hl_variable" href="structMoFEM_1_1ForcesAndSourcesCore.html#ac1d7ee38dde697833773a3b8cb197a76">mField</a>;</div>
<div class="line">    <span class="keyword">auto</span> fe_ptr = <span class="keyword">static_cast&lt;</span>Fe *<span class="keyword">&gt;</span>(fe_raw_ptr);</div>
<div class="line">    <span class="keyword">auto</span> fe_handle = fe_ptr-&gt;getFEEntityHandle();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_base_quadrature = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordtype">int</span> rule = 2 * order_data + 1;</div>
<div class="line">      <span class="keywordflow">if</span> (rule &lt; <a id="a37" name="a37"></a><a class="code hl_define" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a38" name="a38"></a><a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;dim != 3) {</div>
<div class="line">          SETERRQ(m_field.<a id="a39" name="a39"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a id="a40" name="a40"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                  <span class="stringliteral">&quot;wrong dimension&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a id="a41" name="a41"></a><a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &lt; rule) {</div>
<div class="line">          SETERRQ2(m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;wrong order %d != %d&quot;</span>, <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a id="a42" name="a42"></a><a class="code hl_variable" href="structQUAD__.html#a4ceb3af6a1dd055a067f6c3c1f6d4c86">order</a>, rule);</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a id="a43" name="a43"></a><a class="code hl_variable" href="structQUAD__.html#ad40798bbebc1ea30e30dfcde923eccaa">npoints</a>;</div>
<div class="line">        <span class="keyword">auto</span> &amp;gauss_pts = fe_ptr-&gt;gaussPts;</div>
<div class="line">        gauss_pts.resize(4, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[1], 4,</div>
<div class="line">                    &amp;gauss_pts(0, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[2], 4,</div>
<div class="line">                    &amp;gauss_pts(1, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[3], 4,</div>
<div class="line">                    &amp;gauss_pts(2, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;weights, 1,</div>
<div class="line">                    &amp;gauss_pts(3, 0), 1);</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a id="a44" name="a44"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a id="a45" name="a45"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4,</div>
<div class="line">                                                              <span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        cblas_dcopy(4 * nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points, 1, shape_ptr,</div>
<div class="line">                    1);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;rule &gt; quadrature order %d &lt; %d&quot;</span>, rule, <a class="code hl_define" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_base_quadrature();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>-&gt;size() &amp;&amp; <a id="a46" name="a46"></a><a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">EshelbianCore::setSingularity</a>) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_nodes = [&amp;]() {</div>
<div class="line">        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">        <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(fe_handle, conn, num_nodes,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        std::bitset&lt;numNodes&gt; singular_nodes;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn = 0; nn != numNodes; ++nn) {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>-&gt;find(conn[nn]) != <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>-&gt;end()) {</div>
<div class="line">            singular_nodes.set(nn);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_nodes.reset(nn);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_nodes;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_edges = [&amp;]() {</div>
<div class="line">        std::bitset&lt;numEdges&gt; singular_edges;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">          EntityHandle edge;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(fe_handle, 1, ee, edge);</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>-&gt;find(edge) != <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>-&gt;end()) {</div>
<div class="line">            singular_edges.set(ee);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_edges.reset(ee);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_edges;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_gauss_pts = [&amp;](<span class="keyword">auto</span> &amp;ref_gauss_pts) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        fe_ptr-&gt;gaussPts.swap(ref_gauss_pts);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a47" name="a47"></a><a class="code hl_function" href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a>(shape_ptr, &amp;fe_ptr-&gt;gaussPts(0, 0),</div>
<div class="line">                          &amp;fe_ptr-&gt;gaussPts(1, 0), &amp;fe_ptr-&gt;gaussPts(2, 0),</div>
<div class="line">                          nb_gauss_pts);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> singular_nodes = get_singular_nodes();</div>
<div class="line">      <span class="keywordflow">if</span> (singular_nodes.count()) {</div>
<div class="line">        <span class="keyword">auto</span> it_map_ref_coords = <a id="a48" name="a48"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>.find(singular_nodes.to_ulong());</div>
<div class="line">        <span class="keywordflow">if</span> (it_map_ref_coords != <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>.end()) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(it_map_ref_coords-&gt;second);</div>
<div class="line">          <a id="a49" name="a49"></a><a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> refine_quadrature = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> max_level = refinementLevels;</div>
<div class="line">            EntityHandle tet;</div>
<div class="line"> </div>
<div class="line">            moab::Core moab_ref;</div>
<div class="line">            <span class="keywordtype">double</span> base_coords[] = {0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1};</div>
<div class="line">            EntityHandle nodes[4];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 4; nn++)</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_vertex(&amp;base_coords[3 * nn], nodes[nn]);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_element(MBTET, nodes, 4, tet);</div>
<div class="line">            <a id="_a50" name="_a50"></a><a class="code hl_struct" href="structMoFEM_1_1CoreTmp.html">MoFEM::CoreTmp</a>&lt;-1&gt; mofem_ref_core(moab_ref, PETSC_COMM_SELF, -2);</div>
<div class="line">            <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field_ref = mofem_ref_core;</div>
<div class="line">            {</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> tets(tet, tet);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                  tets, 1, <span class="keyword">true</span>, edges, moab::Interface::UNION);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a51" name="_a51"></a><a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevel(</div>
<div class="line">                  tets, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(0), <span class="keyword">false</span>, <a id="a52" name="a52"></a><a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> nodes_at_front;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_nodes[nn]) {</div>
<div class="line">                EntityHandle ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tet, 0, nn, ent);</div>
<div class="line">                nodes_at_front.insert(ent);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> singular_edges = get_singular_edges();</div>
<div class="line"> </div>
<div class="line">            EntityHandle meshset;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_meshset(MESHSET_SET, meshset);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_edges[ee]) {</div>
<div class="line">                EntityHandle ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tet, 1, ee, ent);</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.add_entities(meshset, &amp;ent, 1);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// refine mesh</span></div>
<div class="line">            <span class="keyword">auto</span> *m_ref = m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a53" name="_a53"></a><a class="code hl_struct" href="structMoFEM_1_1MeshRefinement.html">MeshRefinement</a>&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != max_level; ll++) {</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(<a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll),</div>
<div class="line">                                                 <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE,</div>
<div class="line">                                                 edges);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> ref_edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_adjacencies(</div>
<div class="line">                  nodes_at_front, 1, <span class="keyword">true</span>, ref_edges, moab::Interface::UNION);</div>
<div class="line">              ref_edges = intersect(ref_edges, edges);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_entities_by_type(meshset, MBEDGE, ents, <span class="keyword">true</span>);</div>
<div class="line">              ref_edges = intersect(ref_edges, ents);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> tets;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">                      <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll), <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;addVerticesInTheMiddleOfEdges(</div>
<div class="line">                  ref_edges, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;refineTets(tets, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;updateMeshsetByEntitiesChildren(meshset,</div>
<div class="line">                                                    <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1),</div>
<div class="line">                                                    meshset, MBEDGE, <span class="keyword">true</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// get ref coords</span></div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> tets;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                -&gt;getEntitiesByTypeAndRefLevel(<a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(max_level),</div>
<div class="line">                                               <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line">                                               tets);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab_ref, <span class="stringliteral">&quot;ref_tets.vtk&quot;</span>, tets);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> ref_coords(tets.size(), 12, <span class="keyword">false</span>);</div>
<div class="line">            <span class="keywordtype">int</span> tt = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (Range::iterator tit = tets.begin(); tit != tets.end();</div>
<div class="line">                 tit++, tt++) {</div>
<div class="line">              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">              <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_connectivity(*tit, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_coords(conn, num_nodes, &amp;ref_coords(tt, 0));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> ref_gauss_pts(4, nb_gauss_pts * ref_coords.size1());</div>
<div class="line">            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;shape_n =</div>
<div class="line">                data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>);</div>
<div class="line">            <span class="keywordtype">int</span> gg = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tt = 0; tt != ref_coords.size1(); tt++) {</div>
<div class="line">              <span class="keywordtype">double</span> *tet_coords = &amp;ref_coords(tt, 0);</div>
<div class="line">              <span class="keywordtype">double</span> det = Tools::tetVolume(tet_coords);</div>
<div class="line">              det *= 6;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ggg = 0; ggg != nb_gauss_pts; ++ggg, ++gg) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">                  ref_gauss_pts(dd, gg) =</div>
<div class="line">                      shape_n(ggg, 0) * tet_coords[3 * 0 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 1) * tet_coords[3 * 1 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 2) * tet_coords[3 * 2 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 3) * tet_coords[3 * 3 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>];</div>
<div class="line">                }</div>
<div class="line">                ref_gauss_pts(3, gg) = fe_ptr-&gt;gaussPts(3, ggg) * det;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>[singular_nodes.to_ulong()].swap(ref_gauss_pts);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>[singular_nodes.to_ulong()]);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine_quadrature();</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keyword">struct </span>Fe : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> {</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::dataOnElement;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::ForcesAndSourcesCore;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>;</div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> std::map&lt;long int, MatrixDouble&gt; <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SetIntegrationAtFrontFace {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a id="a54" name="a54"></a><a class="code hl_typedef" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#acfb56894c8f6f6f19efb78873efb4d18">FunRule</a> = boost::function&lt;<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>(<span class="keywordtype">int</span>)&gt;;</div>
<div class="line">  <a class="code hl_typedef" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#acfb56894c8f6f6f19efb78873efb4d18">FunRule</a> <a id="a55" name="a55"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a1ac01e671446b017b5e60b592229bc51">funRule</a> = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2 * (p + 1); };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbdb6a592360dd706ccd289d8503c01a">SetIntegrationAtFrontFace</a>(boost::shared_ptr&lt;Range&gt; front_nodes,</div>
<div class="line">                            boost::shared_ptr&lt;Range&gt; front_edges)</div>
<div class="line">      : <a id="a56" name="a56"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>(front_nodes), <a id="a57" name="a57"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>(front_edges){};</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbdb6a592360dd706ccd289d8503c01a">SetIntegrationAtFrontFace</a>(boost::shared_ptr&lt;Range&gt; front_nodes,</div>
<div class="line">                            boost::shared_ptr&lt;Range&gt; front_edges,</div>
<div class="line">                            <a class="code hl_typedef" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#acfb56894c8f6f6f19efb78873efb4d18">FunRule</a> fun_rule)</div>
<div class="line">      : <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>(front_nodes), <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>(front_edges), <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a1ac01e671446b017b5e60b592229bc51">funRule</a>(fun_rule){};</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a58" name="a58"></a><a class="code hl_function" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad294721b379a4a6cea8db53b27fac1ec">operator()</a>(<a class="code hl_struct" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                            <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numNodes = 3;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numEdges = 3;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> refinementLevels = 4;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = fe_raw_ptr-&gt;<a class="code hl_variable" href="structMoFEM_1_1ForcesAndSourcesCore.html#ac1d7ee38dde697833773a3b8cb197a76">mField</a>;</div>
<div class="line">    <span class="keyword">auto</span> fe_ptr = <span class="keyword">static_cast&lt;</span>Fe *<span class="keyword">&gt;</span>(fe_raw_ptr);</div>
<div class="line">    <span class="keyword">auto</span> fe_handle = fe_ptr-&gt;getFEEntityHandle();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_base_quadrature = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordtype">int</span> rule = <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a1ac01e671446b017b5e60b592229bc51">funRule</a>(order_data);</div>
<div class="line">      <span class="keywordflow">if</span> (rule &lt; <a id="a59" name="a59"></a><a class="code hl_define" href="quad_8h.html#a054557173149016194334ebfa52bdfff">QUAD_2D_TABLE_SIZE</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a60" name="a60"></a><a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;dim != 2) {</div>
<div class="line">          SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;wrong dimension&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &lt; rule) {</div>
<div class="line">          SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;wrong order %d != %d&quot;</span>, <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, rule);</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;<a class="code hl_variable" href="structQUAD__.html#ad40798bbebc1ea30e30dfcde923eccaa">npoints</a>;</div>
<div class="line">        fe_ptr-&gt;gaussPts.resize(3, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;points[1], 3,</div>
<div class="line">                    &amp;fe_ptr-&gt;gaussPts(0, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;points[2], 3,</div>
<div class="line">                    &amp;fe_ptr-&gt;gaussPts(1, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;weights, 1,</div>
<div class="line">                    &amp;fe_ptr-&gt;gaussPts(2, 0), 1);</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 3,</div>
<div class="line">                                                              <span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        cblas_dcopy(3 * nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;points, 1, shape_ptr,</div>
<div class="line">                    1);</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getDiffN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(3, 2, <span class="keyword">false</span>);</div>
<div class="line">        std::copy(</div>
<div class="line">            Tools::diffShapeFunMBTRI.begin(), Tools::diffShapeFunMBTRI.end(),</div>
<div class="line">            data-&gt;dataOnEntities[MBVERTEX][0].getDiffN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin());</div>
<div class="line"> </div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;rule &gt; quadrature order %d &lt; %d&quot;</span>, rule, <a class="code hl_define" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_base_quadrature();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>-&gt;size() &amp;&amp; <a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">EshelbianCore::setSingularity</a>) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_nodes = [&amp;]() {</div>
<div class="line">        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">        <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(fe_handle, conn, num_nodes,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        std::bitset&lt;numNodes&gt; singular_nodes;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn = 0; nn != numNodes; ++nn) {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>-&gt;find(conn[nn]) != <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>-&gt;end()) {</div>
<div class="line">            singular_nodes.set(nn);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_nodes.reset(nn);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_nodes;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_edges = [&amp;]() {</div>
<div class="line">        std::bitset&lt;numEdges&gt; singular_edges;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">          EntityHandle edge;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(fe_handle, 1, ee, edge);</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>-&gt;find(edge) != <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>-&gt;end()) {</div>
<div class="line">            singular_edges.set(ee);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_edges.reset(ee);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_edges;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_gauss_pts = [&amp;](<span class="keyword">auto</span> &amp;ref_gauss_pts) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        fe_ptr-&gt;gaussPts.swap(ref_gauss_pts);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a61" name="a61"></a><a class="code hl_function" href="fem__tools_8h.html#af39e9dc2be2d3d367f56d6277553ba00">ShapeMBTRI</a>(shape_ptr, &amp;fe_ptr-&gt;gaussPts(0, 0),</div>
<div class="line">                          &amp;fe_ptr-&gt;gaussPts(1, 0), nb_gauss_pts);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> singular_nodes = get_singular_nodes();</div>
<div class="line">      <span class="keywordflow">if</span> (singular_nodes.count()) {</div>
<div class="line">        <span class="keyword">auto</span> it_map_ref_coords = <a id="a62" name="a62"></a><a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>.find(singular_nodes.to_ulong());</div>
<div class="line">        <span class="keywordflow">if</span> (it_map_ref_coords != <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>.end()) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(it_map_ref_coords-&gt;second);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> refine_quadrature = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> max_level = refinementLevels;</div>
<div class="line"> </div>
<div class="line">            moab::Core moab_ref;</div>
<div class="line">            <span class="keywordtype">double</span> base_coords[] = {0, 0, 0, 1, 0, 0, 0, 1, 0};</div>
<div class="line">            EntityHandle nodes[numNodes];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++)</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_vertex(&amp;base_coords[3 * nn], nodes[nn]);</div>
<div class="line">            EntityHandle tri;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_element(MBTRI, nodes, numNodes, tri);</div>
<div class="line">            <a class="code hl_struct" href="structMoFEM_1_1CoreTmp.html">MoFEM::CoreTmp</a>&lt;-1&gt; mofem_ref_core(moab_ref, PETSC_COMM_SELF, -2);</div>
<div class="line">            <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field_ref = mofem_ref_core;</div>
<div class="line">            {</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> tris(tri, tri);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                  tris, 1, <span class="keyword">true</span>, edges, moab::Interface::UNION);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevel(</div>
<div class="line">                  tris, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(0), <span class="keyword">false</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> nodes_at_front;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_nodes[nn]) {</div>
<div class="line">                EntityHandle ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tri, 0, nn, ent);</div>
<div class="line">                nodes_at_front.insert(ent);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> singular_edges = get_singular_edges();</div>
<div class="line"> </div>
<div class="line">            EntityHandle meshset;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_meshset(MESHSET_SET, meshset);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_edges[ee]) {</div>
<div class="line">                EntityHandle ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tri, 1, ee, ent);</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.add_entities(meshset, &amp;ent, 1);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// refine mesh</span></div>
<div class="line">            <span class="keyword">auto</span> *m_ref = m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshRefinement.html">MeshRefinement</a>&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != max_level; ll++) {</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(<a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll),</div>
<div class="line">                                                 <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE,</div>
<div class="line">                                                 edges);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> ref_edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_adjacencies(</div>
<div class="line">                  nodes_at_front, 1, <span class="keyword">true</span>, ref_edges, moab::Interface::UNION);</div>
<div class="line">              ref_edges = intersect(ref_edges, edges);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_entities_by_type(meshset, MBEDGE, ents, <span class="keyword">true</span>);</div>
<div class="line">              ref_edges = intersect(ref_edges, ents);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> tris;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">                      <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll), <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTRI, tris);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;addVerticesInTheMiddleOfEdges(</div>
<div class="line">                  ref_edges, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;refineTris(tris, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;updateMeshsetByEntitiesChildren(meshset,</div>
<div class="line">                                                    <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1),</div>
<div class="line">                                                    meshset, MBEDGE, <span class="keyword">true</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// get ref coords</span></div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> tris;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                -&gt;getEntitiesByTypeAndRefLevel(<a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(max_level),</div>
<div class="line">                                               <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTRI,</div>
<div class="line">                                               tris);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab_ref, <span class="stringliteral">&quot;ref_tris.vtk&quot;</span>, tris);</div>
<div class="line">              SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;debug&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> ref_coords(tris.size(), 9, <span class="keyword">false</span>);</div>
<div class="line">            <span class="keywordtype">int</span> tt = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (Range::iterator tit = tris.begin(); tit != tris.end();</div>
<div class="line">                 tit++, tt++) {</div>
<div class="line">              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">              <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_connectivity(*tit, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_coords(conn, num_nodes, &amp;ref_coords(tt, 0));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> ref_gauss_pts(3, nb_gauss_pts * ref_coords.size1());</div>
<div class="line">            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;shape_n =</div>
<div class="line">                data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>);</div>
<div class="line">            <span class="keywordtype">int</span> gg = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tt = 0; tt != ref_coords.size1(); tt++) {</div>
<div class="line">              <span class="keywordtype">double</span> *tri_coords = &amp;ref_coords(tt, 0);</div>
<div class="line">              <a id="_a63" name="_a63"></a><a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_normal;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Tools::getTriNormal(tri_coords, &amp;t_normal(0));</div>
<div class="line">              <span class="keyword">auto</span> det = t_normal.<a id="a64" name="a64"></a><a class="code hl_function" href="classFTensor_1_1Tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>();</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ggg = 0; ggg != nb_gauss_pts; ++ggg, ++gg) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 2; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">                  ref_gauss_pts(dd, gg) =</div>
<div class="line">                      shape_n(ggg, 0) * tri_coords[3 * 0 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 1) * tri_coords[3 * 1 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 2) * tri_coords[3 * 2 + <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>];</div>
<div class="line">                }</div>
<div class="line">                ref_gauss_pts(2, gg) = fe_ptr-&gt;gaussPts(2, ggg) * det;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>[singular_nodes.to_ulong()].swap(ref_gauss_pts);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(<a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>[singular_nodes.to_ulong()]);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine_quadrature();</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keyword">struct </span>Fe : <span class="keyword">public</span> <a class="code hl_struct" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> {</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::dataOnElement;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::ForcesAndSourcesCore;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>;</div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> std::map&lt;long int, MatrixDouble&gt; <a class="code hl_variable" href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a id="a65" name="a65"></a><a class="code hl_variable" href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a> = exp(1);</div>
<div class="line">boost::function&lt;double(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a66" name="a66"></a><a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianCore::f</a> = <a id="a67" name="a67"></a><a class="code hl_function" href="structEshelbianCore.html#add41a67a6d5f76559b0657f214048e8c">EshelbianCore::f_log_e</a>;</div>
<div class="line">boost::function&lt;double(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a68" name="a68"></a><a class="code hl_variable" href="structEshelbianCore.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianCore::d_f</a> =</div>
<div class="line">    <a id="a69" name="a69"></a><a class="code hl_function" href="structEshelbianCore.html#ac1cb92ee0356ce898bfecc6c30a83b87">EshelbianCore::d_f_log_e</a>;</div>
<div class="line">boost::function&lt;double(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a70" name="a70"></a><a class="code hl_variable" href="structEshelbianCore.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianCore::dd_f</a> =</div>
<div class="line">    <a id="a71" name="a71"></a><a class="code hl_function" href="structEshelbianCore.html#a50a7cd87dab88c005a77cc1843141fa7">EshelbianCore::dd_f_log_e</a>;</div>
<div class="line">boost::function&lt;double(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a72" name="a72"></a><a class="code hl_variable" href="structEshelbianCore.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianCore::inv_f</a> =</div>
<div class="line">    <a id="a73" name="a73"></a><a class="code hl_function" href="structEshelbianCore.html#ae0d5b73078de40a8ce3ca5a8863c6939">EshelbianCore::inv_f_log_e</a>;</div>
<div class="line">boost::function&lt;double(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a74" name="a74"></a><a class="code hl_variable" href="structEshelbianCore.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianCore::inv_d_f</a> =</div>
<div class="line">    <a id="a75" name="a75"></a><a class="code hl_function" href="structEshelbianCore.html#a7604bd31d1a798243a324bb5182ed8d3">EshelbianCore::inv_d_f_log_e</a>;</div>
<div class="line">boost::function&lt;double(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a76" name="a76"></a><a class="code hl_variable" href="structEshelbianCore.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianCore::inv_dd_f</a> =</div>
<div class="line">    <a id="a77" name="a77"></a><a class="code hl_function" href="structEshelbianCore.html#abc4d27f47349318bcd8cae743385e83a">EshelbianCore::inv_dd_f_log_e</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a78" name="a78"></a><a class="code hl_function" href="structEshelbianCore.html#a7ec2050d610e40a8a05a3dcabe0b40df">EshelbianCore::query_interface</a>(boost::typeindex::type_index type_index,</div>
<div class="line">                               <a id="_a79" name="_a79"></a><a class="code hl_struct" href="structMoFEM_1_1UnknownInterface.html">UnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line">  *iface = <span class="keyword">const_cast&lt;</span><a id="_a80" name="_a80"></a><a class="code hl_struct" href="structEshelbianCore.html">EshelbianCore</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a81" name="a81"></a><a class="code hl_function" href="structOpJacobian.html#ae8b1e124a71d3c85bff23022318278d7">OpJacobian::doWork</a>(<span class="keywordtype">int</span> side, EntityType type, <a id="_a82" name="_a82"></a><a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (evalRhs)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evaluateRhs(data);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (evalLhs)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evaluateLhs(data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a id="a83" name="a83"></a><a class="code hl_function" href="structEshelbianCore.html#af5300bd764a6432f701ebff075f6e5ba">EshelbianCore::EshelbianCore</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : mField(m_field) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(getOptions(), <span class="stringliteral">&quot;getOptions failed&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a id="a84" name="a84"></a><a class="code hl_function" href="structEshelbianCore.html#ac07c5f6b76ff465acb78b4cb487fe32e">EshelbianCore::~EshelbianCore</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a85" name="a85"></a><a class="code hl_function" href="structEshelbianCore.html#a6ce37c333084d7776612a9165edd487a">EshelbianCore::getOptions</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_rots[] = {<span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;moderate&quot;</span>, <span class="stringliteral">&quot;large&quot;</span>, <span class="stringliteral">&quot;no_h1&quot;</span>};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_symm[] = {<span class="stringliteral">&quot;symm&quot;</span>, <span class="stringliteral">&quot;not_symm&quot;</span>};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_release[] = {<span class="stringliteral">&quot;griffith_force&quot;</span>, <span class="stringliteral">&quot;griffith_skelton&quot;</span>};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_stretches[] = {<span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;log&quot;</span>};</div>
<div class="line">  PetscInt choice_rot = <a id="a86" name="a86"></a><a class="code hl_variable" href="structEshelbianCore.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a>;</div>
<div class="line">  PetscInt choice_grad = <a id="a87" name="a87"></a><a class="code hl_variable" href="structEshelbianCore.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a>;</div>
<div class="line">  PetscInt choice_symm = <a id="a88" name="a88"></a><a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a>;</div>
<div class="line">  PetscInt choice_release = <a id="a89" name="a89"></a><a class="code hl_variable" href="structEshelbianCore.html#ae8387101883105f158f223898dcc0cb8">EshelbianCore::energyReleaseSelector</a>;</div>
<div class="line">  PetscInt choice_stretch = StretchSelector::LOG;</div>
<div class="line">  <span class="keywordtype">char</span> analytical_expr_file_name[255] = <span class="stringliteral">&quot;analytical_expr.py&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Eshelbian plasticity&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-space_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for space&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a id="a90" name="a90"></a><a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-space_h1_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for space&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a id="a91" name="a91"></a><a class="code hl_variable" href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-material_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for material&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, <a id="a92" name="a92"></a><a class="code hl_variable" href="structEshelbianCore.html#a2975cb8401f36e568b72eb027375fe40">materialOrder</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a2975cb8401f36e568b72eb027375fe40">materialOrder</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_u&quot;</span>, <span class="stringliteral">&quot;viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a93" name="a93"></a><a class="code hl_variable" href="structEshelbianCore.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="structEshelbianCore.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_w&quot;</span>, <span class="stringliteral">&quot;viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a94" name="a94"></a><a class="code hl_variable" href="structEshelbianCore.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="structEshelbianCore.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_omega&quot;</span>, <span class="stringliteral">&quot;rot viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a id="a95" name="a95"></a><a class="code hl_variable" href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-density_alpha_rho&quot;</span>, <span class="stringliteral">&quot;density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a96" name="a96"></a><a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-rotations&quot;</span>, <span class="stringliteral">&quot;rotations&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_rots,</div>
<div class="line">                           LARGE_ROT + 1, list_rots[choice_rot], &amp;choice_rot,</div>
<div class="line">                           PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-grad&quot;</span>, <span class="stringliteral">&quot;gradient of defamation approximate&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                           list_rots, NO_H1_CONFIGURATION + 1,</div>
<div class="line">                           list_rots[choice_grad], &amp;choice_grad, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-symm&quot;</span>, <span class="stringliteral">&quot;symmetric variant&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_symm, 2,</div>
<div class="line">                           list_symm[choice_symm], &amp;choice_symm, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-exponent_base&quot;</span>, <span class="stringliteral">&quot;exponent_base&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">exponentBase</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(</div>
<div class="line">      <span class="stringliteral">&quot;-stretches&quot;</span>, <span class="stringliteral">&quot;stretches&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_stretches, StretchSelector::LOG + 1,</div>
<div class="line">      list_stretches[choice_stretch], &amp;choice_stretch, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-no_stretch&quot;</span>, <span class="stringliteral">&quot;do not solve for stretch&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a97" name="a97"></a><a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-set_singularity&quot;</span>, <span class="stringliteral">&quot;set singularity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-l2_user_base_scale&quot;</span>, <span class="stringliteral">&quot;streach scale&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a98" name="a98"></a><a class="code hl_variable" href="structEshelbianCore.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// dynamic relaxation</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-dynamic_relaxation&quot;</span>, <span class="stringliteral">&quot;dynamic time relaxation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a99" name="a99"></a><a class="code hl_variable" href="structEshelbianCore.html#a5d5c5ee0702329b9063b5e2c1ab13979">dynamicRelaxation</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a5d5c5ee0702329b9063b5e2c1ab13979">dynamicRelaxation</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// contact parameters</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-contact_max_post_proc_ref_level&quot;</span>, <span class="stringliteral">&quot;refinement level&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, <a id="a100" name="a100"></a><a class="code hl_variable" href="structEshelbianCore.html#a767ea904eb33f7f44cbdef68cfe7cdfc">contactRefinementLevels</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a767ea904eb33f7f44cbdef68cfe7cdfc">contactRefinementLevels</a>,</div>
<div class="line">                         PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// cracking parameters</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-cracking_on&quot;</span>, <span class="stringliteral">&quot;cracking ON&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a101" name="a101"></a><a class="code hl_variable" href="structEshelbianCore.html#a41356565364f05177e0256f536e42603">crackingOn</a>,</div>
<div class="line">                          &amp;<a class="code hl_variable" href="structEshelbianCore.html#a41356565364f05177e0256f536e42603">crackingOn</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-cracking_start_time&quot;</span>, <span class="stringliteral">&quot;cracking start time&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a id="a102" name="a102"></a><a class="code hl_variable" href="structEshelbianCore.html#a685963c45d9df97616feedef0e5d24a3">crackingStartTime</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a685963c45d9df97616feedef0e5d24a3">crackingStartTime</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-griffith_energy&quot;</span>, <span class="stringliteral">&quot;Griffith energy&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a id="a103" name="a103"></a><a class="code hl_variable" href="structEshelbianCore.html#a4e1702cd98e773ce63013875ceea4d77">griffithEnergy</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a4e1702cd98e773ce63013875ceea4d77">griffithEnergy</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-energy_release_variant&quot;</span>, <span class="stringliteral">&quot;energy release variant&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;&quot;</span>, list_release, 2, list_release[choice_release],</div>
<div class="line">                           &amp;choice_release, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-nb_J_integral_levels&quot;</span>, <span class="stringliteral">&quot;Number of J integarl levels&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, <a id="a104" name="a104"></a><a class="code hl_variable" href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">nbJIntegralLevels</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">nbJIntegralLevels</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// internal stress</span></div>
<div class="line">  <span class="keywordtype">char</span> tag_name[255] = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-internal_stress_tag_name&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;internal stress tag name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, tag_name, 255,</div>
<div class="line">                            PETSC_NULL);</div>
<div class="line">  <a id="a105" name="a105"></a><a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a> = string(tag_name);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line">      <span class="stringliteral">&quot;-internal_stress_interp_order&quot;</span>, <span class="stringliteral">&quot;internal stress interpolation order&quot;</span>,</div>
<div class="line">      <span class="stringliteral">&quot;&quot;</span>, <a id="a106" name="a106"></a><a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-internal_stress_voigt&quot;</span>, <span class="stringliteral">&quot;Voigt index notation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a107" name="a107"></a><a class="code hl_variable" href="structEshelbianCore.html#ab85ab2a5287eb2124aea7db52e8e4556">internalStressVoigt</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#ab85ab2a5287eb2124aea7db52e8e4556">internalStressVoigt</a>,</div>
<div class="line">                          PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">PetscOptionsGetString</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-analytical_expr_file&quot;</span>,</div>
<div class="line">                               analytical_expr_file_name, 255, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  PetscOptionsEnd();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a> != 0 &amp;&amp; <a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a> != 1) {</div>
<div class="line">    SETERRQ1(PETSC_COMM_WORLD, <a id="a108" name="a108"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>,</div>
<div class="line">             <span class="stringliteral">&quot;Unsupported internal stress interpolation order %d&quot;</span>,</div>
<div class="line">             <a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>) {</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a> = PETSC_TRUE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17">RotSelector</a><span class="keyword">&gt;</span>(choice_rot);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17">RotSelector</a><span class="keyword">&gt;</span>(choice_grad);</div>
<div class="line">  <a id="a109" name="a109"></a><a class="code hl_variable" href="structEshelbianCore.html#a0fa131247db161516b235b0a567300ad">EshelbianCore::stretchSelector</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6">StretchSelector</a><span class="keyword">&gt;</span>(choice_stretch);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceEshelbianPlasticity.html#ae337388c661d8b90487c846cd2f361fa">SymmetrySelector</a><span class="keyword">&gt;</span>(choice_symm);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#ae8387101883105f158f223898dcc0cb8">EshelbianCore::energyReleaseSelector</a> =</div>
<div class="line">      <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9a">EnergyReleaseSelector</a><span class="keyword">&gt;</span>(choice_release);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="structEshelbianCore.html#a0fa131247db161516b235b0a567300ad">EshelbianCore::stretchSelector</a>) {</div>
<div class="line">  <span class="keywordflow">case</span> StretchSelector::LINEAR:</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianCore::f</a> = <a id="a110" name="a110"></a><a class="code hl_function" href="structEshelbianCore.html#afa60d86e456beaabddc2df730598719d">f_linear</a>;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianCore::d_f</a> = <a id="a111" name="a111"></a><a class="code hl_function" href="structEshelbianCore.html#aeb84ef335d710054abe0411d4672d3eb">d_f_linear</a>;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianCore::dd_f</a> = <a id="a112" name="a112"></a><a class="code hl_function" href="structEshelbianCore.html#a98338d042e94f47e4b0cc5a6e4ede06f">dd_f_linear</a>;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianCore::inv_f</a> = <a id="a113" name="a113"></a><a class="code hl_function" href="structEshelbianCore.html#a1b2cd0d3b7edf33d32a29531faff5d43">inv_f_linear</a>;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianCore::inv_d_f</a> = <a id="a114" name="a114"></a><a class="code hl_function" href="structEshelbianCore.html#aae203dfeaee5453b2400a66b729b7005">inv_d_f_linear</a>;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianCore::inv_dd_f</a> = <a id="a115" name="a115"></a><a class="code hl_function" href="structEshelbianCore.html#ab8a03cc8007a0a926b9387941141303f">inv_dd_f_linear</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> StretchSelector::LOG:</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a> != exp(1)) {</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianCore::f</a> = <a id="a116" name="a116"></a><a class="code hl_function" href="structEshelbianCore.html#aec89ac53f8bdf554768e788c8aa48282">f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianCore::d_f</a> = <a id="a117" name="a117"></a><a class="code hl_function" href="structEshelbianCore.html#a6591b5a3838e0c8dc4452ec9924f1eeb">d_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianCore::dd_f</a> = <a id="a118" name="a118"></a><a class="code hl_function" href="structEshelbianCore.html#a227e7b13b2bd905c1803d2bc65eacf82">dd_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianCore::inv_f</a> = <a id="a119" name="a119"></a><a class="code hl_function" href="structEshelbianCore.html#a8b49e02a24c217a6abc9df5ca4bd7330">inv_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianCore::inv_d_f</a> = <a id="a120" name="a120"></a><a class="code hl_function" href="structEshelbianCore.html#a2767660e68cb6e73ceaf90c95670cc4d">inv_d_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianCore::inv_dd_f</a> = <a id="a121" name="a121"></a><a class="code hl_function" href="structEshelbianCore.html#aafaa9cff0830a9a3e5e5cb00c072b47d">inv_dd_f_log</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianCore::f</a> = <a class="code hl_function" href="structEshelbianCore.html#add41a67a6d5f76559b0657f214048e8c">f_log_e</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianCore::d_f</a> = <a class="code hl_function" href="structEshelbianCore.html#ac1cb92ee0356ce898bfecc6c30a83b87">d_f_log_e</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianCore::dd_f</a> = <a class="code hl_function" href="structEshelbianCore.html#a50a7cd87dab88c005a77cc1843141fa7">dd_f_log_e</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianCore::inv_f</a> = <a class="code hl_function" href="structEshelbianCore.html#a8b49e02a24c217a6abc9df5ca4bd7330">inv_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianCore::inv_d_f</a> = <a class="code hl_function" href="structEshelbianCore.html#a2767660e68cb6e73ceaf90c95670cc4d">inv_d_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianCore::inv_dd_f</a> = <a class="code hl_function" href="structEshelbianCore.html#aafaa9cff0830a9a3e5e5cb00c072b47d">inv_dd_f_log</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(<a id="a122" name="a122"></a><a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Unknown stretch&quot;</span>);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;spaceOrder: -space_order &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;spaceH1Order: -space_h1_order &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;materialOrder: -material_order &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a2975cb8401f36e568b72eb027375fe40">materialOrder</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaU: -viscosity_alpha_u&quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaW: -viscosity_alpha_w &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;alphaOmega: -viscosity_alpha_omega &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaRho: -density_alpha_rho &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Rotations: -rotations &quot;</span> &lt;&lt; list_rots[<a class="code hl_variable" href="structEshelbianCore.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a>];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Gradient of deformation &quot;</span></div>
<div class="line">                               &lt;&lt; list_rots[<a class="code hl_variable" href="structEshelbianCore.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a>];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Symmetry: -symm &quot;</span> &lt;&lt; list_symm[<a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a>];</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">exponentBase</a> != exp(1))</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Base exponent: -exponent_base &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a>;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Base exponent e&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Stretch: -stretches &quot;</span> &lt;&lt; list_stretches[choice_stretch];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;No stretch: -no_stretch &quot;</span> &lt;&lt; (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Dynamic relaxation: -dynamic_relaxation &quot;</span> &lt;&lt; (<a class="code hl_variable" href="structEshelbianCore.html#a5d5c5ee0702329b9063b5e2c1ab13979">dynamicRelaxation</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Singularity: -set_singularity &quot;</span> &lt;&lt; (<a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;L2 user base scale: -l2_user_base_scale &quot;</span> &lt;&lt; (<a class="code hl_variable" href="structEshelbianCore.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Cracking on: -cracking_on &quot;</span> &lt;&lt; (<a class="code hl_variable" href="structEshelbianCore.html#a41356565364f05177e0256f536e42603">crackingOn</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Cracking start time: -cracking_start_time &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a685963c45d9df97616feedef0e5d24a3">crackingStartTime</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Griffith energy: -griffith_energy &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a4e1702cd98e773ce63013875ceea4d77">griffithEnergy</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Energy release variant: -energy_release_variant &quot;</span></div>
<div class="line">      &lt;&lt; list_release[<a class="code hl_variable" href="structEshelbianCore.html#ae8387101883105f158f223898dcc0cb8">EshelbianCore::energyReleaseSelector</a>];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Number of J integral levels: -nb_J_integral_levels &quot;</span></div>
<div class="line">      &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">nbJIntegralLevels</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ENABLE_PYTHON_BINDING</span></div>
<div class="line">  <span class="keyword">auto</span> file_exists = [](std::string myfile) {</div>
<div class="line">    std::ifstream file(myfile.c_str());</div>
<div class="line">    <span class="keywordflow">if</span> (file) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (file_exists(analytical_expr_file_name)) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; analytical_expr_file_name &lt;&lt; <span class="stringliteral">&quot; file found&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <a id="a123" name="a123"></a><a class="code hl_variable" href="structEshelbianCore.html#aa00b5c9f71aa0f555fab7e4400d809c8">AnalyticalExprPythonPtr</a> = boost::make_shared&lt;AnalyticalExprPython&gt;();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#aa00b5c9f71aa0f555fab7e4400d809c8">AnalyticalExprPythonPtr</a>-&gt;analyticalExprInit(</div>
<div class="line">        analytical_expr_file_name);</div>
<div class="line">    AnalyticalExprPythonWeakPtr = <a class="code hl_variable" href="structEshelbianCore.html#aa00b5c9f71aa0f555fab7e4400d809c8">AnalyticalExprPythonPtr</a>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::warning)</div>
<div class="line">        &lt;&lt; analytical_expr_file_name &lt;&lt; <span class="stringliteral">&quot; file NOT found&quot;</span>;</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a> == -1)</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a> = <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a124" name="a124"></a><a class="code hl_function" href="structEshelbianCore.html#a0ccbbae7b9f76b00b39760756c85ca7b">EshelbianCore::addFields</a>(<span class="keyword">const</span> EntityHandle meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tets = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> tets;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(meshset, MBTET, tets);</div>
<div class="line">    <span class="keywordflow">return</span> tets;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tets_skin = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> tets_skin_part;</div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, get_tets(), <span class="keyword">false</span>, tets_skin_part);</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> tets_skin;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(tets_skin_part,</div>
<div class="line">                                 PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;tets_skin);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> subtract_boundary_conditions = [&amp;](<span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="comment">// That mean, that hybrid field on all faces on which traction is applied,</span></div>
<div class="line">    <span class="comment">// on other faces, or enforcing displacements as</span></div>
<div class="line">    <span class="comment">// natural boundary condition.</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a125" name="a125"></a><a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>) {</div>
<div class="line">        tets_skin = subtract(tets_skin, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a126" name="a126"></a><a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>) {</div>
<div class="line">        tets_skin = subtract(tets_skin, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }      </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a127" name="a127"></a><a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>) {</div>
<div class="line">        tets_skin = subtract(tets_skin, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_blockset = [&amp;](<span class="keyword">auto</span> block_name, <span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="keyword">auto</span> crack_faces =</div>
<div class="line">        <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;block_name&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    tets_skin.merge(crack_faces);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> subtract_blockset = [&amp;](<span class="keyword">auto</span> block_name, <span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="keyword">auto</span> contact_range =</div>
<div class="line">        <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, block_name, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    tets_skin = subtract(tets_skin, contact_range);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_stress_trace_faces = [&amp;](<span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(get_tets(), <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                             faces, moab::Interface::UNION);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> trace_faces = subtract(faces, tets_skin);</div>
<div class="line">    <span class="keywordflow">return</span> trace_faces;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> tets = get_tets();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// remove also contact faces, i.e. that is also kind of hybrid field but</span></div>
<div class="line">  <span class="comment">// named but used to enforce contact conditions</span></div>
<div class="line">  <span class="keyword">auto</span> trace_faces = get_stress_trace_faces(</div>
<div class="line"> </div>
<div class="line">      subtract_blockset(<span class="stringliteral">&quot;CONTACT&quot;</span>,</div>
<div class="line">                        subtract_boundary_conditions(get_tets_skin()))</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <a id="a128" name="a128"></a><a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a> = boost::make_shared&lt;Range&gt;(intersect(</div>
<div class="line">      trace_faces, <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1)));</div>
<div class="line">  <a id="a129" name="a129"></a><a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a> =</div>
<div class="line">      boost::make_shared&lt;Range&gt;(subtract(trace_faces, *<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>));</div>
<div class="line">  <span class="comment">// materialSkeletonFaces =</span></div>
<div class="line">  <span class="comment">//     boost::make_shared&lt;Range&gt;(get_stress_trace_faces(Range()));</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>-&gt;size())</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      <span class="stringliteral">&quot;contact_faces_&quot;</span> +</div>
<div class="line">                          std::to_string(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a130" name="a130"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                      *<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>-&gt;size())</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      <span class="stringliteral">&quot;skeleton_faces_&quot;</span> +</div>
<div class="line">                          std::to_string(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                      *<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>);</div>
<div class="line">    <span class="comment">// if (skeletonFaces-&gt;size())</span></div>
<div class="line">    <span class="comment">//   CHKERR save_range(mField.get_moab(), &quot;material_skeleton_faces.vtk&quot;,</span></div>
<div class="line">    <span class="comment">//                     *materialSkeletonFaces);</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_broken_hdiv_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a id="a131" name="a131"></a><a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                               <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a> base = <a id="a132" name="a132"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_side_map_hdiv = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> std::vector&lt;</div>
<div class="line"> </div>
<div class="line">          std::pair&lt;EntityType,</div>
<div class="line">                    std::function&lt;<a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(<a class="code hl_typedef" href="structMoFEM_1_1BaseFunction.html#a401db54065b0887d68f81f7f806a08d4">BaseFunction::DofsSideMap</a> &amp;)&gt;</div>
<div class="line"> </div>
<div class="line">                    &gt;&gt;{</div>
<div class="line"> </div>
<div class="line">          {MBTET,</div>
<div class="line">           [&amp;](<a class="code hl_typedef" href="structMoFEM_1_1BaseFunction.html#a401db54065b0887d68f81f7f806a08d4">BaseFunction::DofsSideMap</a> &amp;dofs_side_map) -&gt; <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> {</div>
<div class="line">             <span class="keywordflow">return</span> TetPolynomialBase::setDofsSideMap(<a id="a133" name="a133"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, <a id="a134" name="a134"></a><a class="code hl_enumvalue" href="definitions_8h.html#a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4">DISCONTINUOUS</a>, base,</div>
<div class="line">                                                      dofs_side_map);</div>
<div class="line">           }}</div>
<div class="line"> </div>
<div class="line">      };</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a135" name="a135"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a4a1460f62976a6d7224b1c280cecedfc">add_broken_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, base, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                   get_side_map_hdiv(), MB_TAG_DENSE, <a id="a136" name="a136"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a137" name="a137"></a><a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a138" name="a138"></a><a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_l2_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a139" name="a139"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a id="a140" name="a140"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a id="a141" name="a141"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_h1_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBVERTEX, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBEDGE, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTRI, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_l2_field_by_range = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> field_dim, <a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, field_dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(r);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a142" name="a142"></a><a class="code hl_function" href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">add_ents_to_field_by_dim</a>(r, dim, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(r, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_bubble_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, <a id="a143" name="a143"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>, dim, MB_TAG_DENSE,</div>
<div class="line">                            <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// Modify field</span></div>
<div class="line">    <span class="keyword">auto</span> field_ptr = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a144" name="a144"></a><a class="code hl_function" href="group__mofem__field.html#ga01ac334d9339ed5f1b0bcfa12a8daf1d">get_field_structure</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <span class="keyword">auto</span> field_order_table =</div>
<div class="line">        <span class="keyword">const_cast&lt;</span><a id="_a145" name="_a145"></a><a class="code hl_struct" href="structMoFEM_1_1Field.html">Field</a> *<span class="keyword">&gt;</span>(field_ptr)-&gt;getFieldOrderTable();</div>
<div class="line">    <span class="keyword">auto</span> get_cgg_bubble_order_zero = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 0; };</div>
<div class="line">    <span class="keyword">auto</span> get_cgg_bubble_order_tet = [](<span class="keywordtype">int</span> p) {</div>
<div class="line">      <span class="keywordflow">return</span> <a id="a146" name="a146"></a><a class="code hl_define" href="CGGTonsorialBubbleBase_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a>(p);</div>
<div class="line">    };</div>
<div class="line">    field_order_table[MBVERTEX] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBEDGE] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBTRI] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBTET] = get_cgg_bubble_order_tet;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTRI, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_user_l2_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                           <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>, dim, MB_TAG_DENSE,</div>
<div class="line">                            <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// Modify field</span></div>
<div class="line">    <span class="keyword">auto</span> field_ptr = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga01ac334d9339ed5f1b0bcfa12a8daf1d">get_field_structure</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <span class="keyword">auto</span> field_order_table =</div>
<div class="line">        <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="structMoFEM_1_1Field.html">Field</a> *<span class="keyword">&gt;</span>(field_ptr)-&gt;getFieldOrderTable();</div>
<div class="line">    <span class="keyword">auto</span> zero_dofs = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 0; };</div>
<div class="line">    <span class="keyword">auto</span> dof_l2_tet = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> <a id="a147" name="a147"></a><a class="code hl_define" href="h1__hdiv__hcurl__l2_8h.html#afff51d616c826e4714c19b69816fa74f">NBVOLUMETET_L2</a>(p); };</div>
<div class="line">    field_order_table[MBVERTEX] = zero_dofs;</div>
<div class="line">    field_order_table[MBEDGE] = zero_dofs;</div>
<div class="line">    field_order_table[MBTRI] = zero_dofs;</div>
<div class="line">    field_order_table[MBTET] = dof_l2_tet;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// spatial fields</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_broken_hdiv_field(<a id="a148" name="a148"></a><a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_bubble_field(<a id="a149" name="a149"></a><a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(<a id="a150" name="a150"></a><a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 3);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(<a id="a151" name="a151"></a><a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 3);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_user_l2_field(<a id="a152" name="a152"></a><a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a> ? -1 : <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, 6);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>)</div>
<div class="line">    SETERRQ(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No skeleton faces&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>)</div>
<div class="line">    SETERRQ(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No contact faces&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_hybridised_disp = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> faces = *<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>;</div>
<div class="line">    <span class="keyword">auto</span> skin = subtract_boundary_conditions(get_tets_skin());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;bc : *<a id="a153" name="a153"></a><a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>) {</div>
<div class="line">      faces.merge(intersect(bc.faces, skin));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> faces;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(<a id="a154" name="a154"></a><a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 2, 3,</div>
<div class="line">                               get_hybridised_disp());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(<a id="a155" name="a155"></a><a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 2, 3,</div>
<div class="line">                               <a class="code hl_class" href="classRange.html">Range</a>(*<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// spatial displacement</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_h1_field(<a id="a156" name="a156"></a><a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>, 3);</div>
<div class="line">  <span class="comment">// material positions</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_h1_field(<a id="a157" name="a157"></a><a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, 2, 3);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Eshelby stress</span></div>
<div class="line">  <span class="comment">// CHKERR add_broken_hdiv_field(eshelbyStress, spaceOrder);</span></div>
<div class="line">  <span class="comment">// CHKERR add_l2_field(materialL2Disp, spaceOrder - 1, 3);</span></div>
<div class="line">  <span class="comment">// CHKERR add_l2_field_by_range(hybridMaterialDisp, spaceOrder - 1, 2, 3,</span></div>
<div class="line">  <span class="comment">//                              Range(*materialSkeletonFaces));</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a158" name="a158"></a><a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a159" name="a159"></a><a class="code hl_function" href="structEshelbianCore.html#a33a23a7598af848601fa49a1eb8554a0">EshelbianCore::projectGeometry</a>(<span class="keyword">const</span> EntityHandle meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> meshset_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_handle(meshset, meshset_ents);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> project_ho_geometry = [&amp;](<span class="keyword">auto</span> field) {</div>
<div class="line">    <a id="_a160" name="_a160"></a><a class="code hl_struct" href="structMoFEM_1_1Projection10NodeCoordsOnField.html">Projection10NodeCoordsOnField</a> ent_method(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a161" name="a161"></a><a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(field, ent_method);</div>
<div class="line">  };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> project_ho_geometry(<a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front_edges = [&amp;](<span class="keyword">auto</span> &amp;front_edges) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> front_crack_nodes;</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> crack_front_edges_with_both_nodes_not_at_front;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">      <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(front_edges, front_crack_nodes, <span class="keyword">true</span>);</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> crack_front_edges;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(front_crack_nodes, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">false</span>,</div>
<div class="line">                                  crack_front_edges, moab::Interface::UNION);</div>
<div class="line">      crack_front_edges =</div>
<div class="line">          intersect(subtract(crack_front_edges, front_edges), meshset_ents);</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> crack_front_edges_nodes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(crack_front_edges, crack_front_edges_nodes,</div>
<div class="line">                                   <span class="keyword">true</span>);</div>
<div class="line">      crack_front_edges_nodes =</div>
<div class="line">          subtract(crack_front_edges_nodes, front_crack_nodes);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(</div>
<div class="line">          crack_front_edges_nodes, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">false</span>,</div>
<div class="line">          crack_front_edges_with_both_nodes_not_at_front,</div>
<div class="line">          moab::Interface::UNION);</div>
<div class="line">      crack_front_edges_with_both_nodes_not_at_front = intersect(</div>
<div class="line">          crack_front_edges_with_both_nodes_not_at_front, meshset_ents);</div>
<div class="line">      crack_front_edges_with_both_nodes_not_at_front = intersect(</div>
<div class="line">          crack_front_edges_with_both_nodes_not_at_front, crack_front_edges);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    front_crack_nodes = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a559a80330b1f767e8e9b59d89a31eac5">send_type</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, front_crack_nodes, MBVERTEX);</div>
<div class="line">    crack_front_edges_with_both_nodes_not_at_front = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a559a80330b1f767e8e9b59d89a31eac5">send_type</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, crack_front_edges_with_both_nodes_not_at_front, MBEDGE);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(boost::make_shared&lt;Range&gt;(front_crack_nodes),</div>
<div class="line">                          boost::make_shared&lt;Range&gt;(</div>
<div class="line">                              crack_front_edges_with_both_nodes_not_at_front));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a id="a162" name="a162"></a><a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a> = boost::make_shared&lt;Range&gt;(</div>
<div class="line">      <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CRACK&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line">  <a id="a163" name="a163"></a><a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a> =</div>
<div class="line">      boost::make_shared&lt;Range&gt;(<a class="code hl_function" href="EshelbianPlasticity_8cpp.html#af63d38d75712794be9ff9cde96486dfa">get_crack_front_edges</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>));</div>
<div class="line">  <span class="keyword">auto</span> [front_vertices, front_adj_edges] = get_adj_front_edges(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">  <a id="a164" name="a164"></a><a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a> = front_vertices;</div>
<div class="line">  <a id="a165" name="a165"></a><a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a> = front_adj_edges;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a41356565364f05177e0256f536e42603">crackingOn</a>) {</div>
<div class="line">    <span class="keyword">auto</span> rank = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>();</div>
<div class="line">    <span class="comment">// CHKERR save_range(mField.get_moab(),</span></div>
<div class="line">    <span class="comment">//                   (boost::format(&quot;meshset_ents_%d.vtk&quot;) % rank).str(),</span></div>
<div class="line">    <span class="comment">//                   meshset_ents);</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;crack_faces_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;front_edges_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      *<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">    <span class="comment">// CHKERR save_range(mField.get_moab(),</span></div>
<div class="line">    <span class="comment">//                   (boost::format(&quot;front_vertices_%d.vtk&quot;) % rank).str(),</span></div>
<div class="line">    <span class="comment">//                   *frontVertices);</span></div>
<div class="line">    <span class="comment">// CHKERR save_range(mField.get_moab(),</span></div>
<div class="line">    <span class="comment">//                   (boost::format(&quot;front_adj_edges_%d.vtk&quot;) % rank).str(),</span></div>
<div class="line">    <span class="comment">//                   *frontAdjEdges);</span></div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_singular_dofs = [&amp;](<span class="keyword">auto</span> &amp;front_adj_edges, <span class="keyword">auto</span> &amp;front_vertices) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a id="a166" name="a166"></a><a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> = 1;</div>
<div class="line">    <span class="keywordtype">double</span> beta = 0;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-singularity_eps&quot;</span>, &amp;beta,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Singularity eps &quot;</span> &lt;&lt; beta;</div>
<div class="line">    <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> -= beta;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> edge : front_adj_edges) {</div>
<div class="line">      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">      <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edge, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordtype">double</span> coords[6];</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, coords);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> dir[3] = {coords[3] - coords[0], coords[4] - coords[1],</div>
<div class="line">                             coords[5] - coords[2]};</div>
<div class="line">      <span class="keywordtype">double</span> dof[3] = {0, 0, 0};</div>
<div class="line">      <span class="keywordflow">if</span> (front_vertices.find(conn[0]) != front_vertices.end()) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">          dof[<a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] = -dir[<a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] * <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (front_vertices.find(conn[1]) != front_vertices.end()) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">          dof[<a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] = +dir[<a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] * <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<a id="a167" name="a167"></a><a class="code hl_define" href="group__mofem__access.html#gaead3887ddc924ad6d2a0993bfb4a9b27">_IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_</a>(</div>
<div class="line">               <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, edge, dit)) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = dit-&gt;get()-&gt;getEntDofIdx();</div>
<div class="line">        <span class="keywordflow">if</span> (idx &gt; 2) {</div>
<div class="line">          dit-&gt;get()-&gt;getFieldData() = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          dit-&gt;get()-&gt;getFieldData() = dof[idx];</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_singular_dofs(*<a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>, *<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a168" name="a168"></a><a class="code hl_function" href="structEshelbianCore.html#a0c39ec57ae27dba1a6fe02b45d971d68">EshelbianCore::addVolumeFiniteElement</a>(<span class="keyword">const</span> EntityHandle meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set finite element fields</span></div>
<div class="line">  <span class="keyword">auto</span> add_field_to_fe = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string fe,</div>
<div class="line">                                <span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a169" name="a169"></a><a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a170" name="a170"></a><a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a171" name="a171"></a><a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a172" name="a172"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a173" name="a173"></a><a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>)) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a174" name="a174"></a><a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a175" name="a175"></a><a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(meshset, MBTET,</div>
<div class="line">                                                     <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build finite elements data structures</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a176" name="a176"></a><a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// if (!mField.check_finite_element(materialVolumeElement)) {</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   Range front_edges = get_range_from_block(mField, &quot;FRONT&quot;, SPACE_DIM - 2);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   Range front_elements;</span></div>
<div class="line">  <span class="comment">//   for (auto l = 0; l != frontLayers; ++l) {</span></div>
<div class="line">  <span class="comment">//     Range front_elements_layer;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_adjacencies(front_edges, SPACE_DIM, true,</span></div>
<div class="line">  <span class="comment">//                                              front_elements_layer,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     front_elements.merge(front_elements_layer);</span></div>
<div class="line">  <span class="comment">//     front_edges.clear();</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_adjacencies(front_elements_layer,</span></div>
<div class="line">  <span class="comment">//                                              SPACE_DIM - 2, true,</span></div>
<div class="line">  <span class="comment">//                                              front_edges,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//   }</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   CHKERR mField.add_finite_element(materialVolumeElement, MF_ZERO);</span></div>
<div class="line">  <span class="comment">//   CHKERR mField.add_ents_to_finite_element_by_type(front_elements, MBTET,</span></div>
<div class="line">  <span class="comment">//                                                    materialVolumeElement);</span></div>
<div class="line">  <span class="comment">//   // CHKERR add_field_to_fe(materialVolumeElement, eshelbyStress);</span></div>
<div class="line">  <span class="comment">//   // CHKERR add_field_to_fe(materialVolumeElement, materialL2Disp);</span></div>
<div class="line">  <span class="comment">//   CHKERR mField.build_finite_elements(materialVolumeElement);</span></div>
<div class="line">  <span class="comment">// }</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a177" name="a177"></a><a class="code hl_function" href="structEshelbianCore.html#a14d44e8866e1201657b06ce8d1d82206">EshelbianCore::addBoundaryFiniteElement</a>(<span class="keyword">const</span> EntityHandle meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> meshset_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_handle(meshset, meshset_ents);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_fe_adjacency = [&amp;](<span class="keyword">auto</span> fe_name) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a id="a178" name="a178"></a><a class="code hl_variable" href="structEshelbianCore.html#a912ebbcc505570f26b497c1a788c49c0">parentAdjSkeletonFunctionDim2</a> =</div>
<div class="line">        boost::make_shared&lt;ParentFiniteElementAdjacencyFunctionSkeleton&lt;2&gt;&gt;(</div>
<div class="line">            <a id="a179" name="a179"></a><a class="code hl_variable" href="structEshelbianCore.html#acdf2dd025fc4286ff5719a079c2e61ac">bitAdjParent</a>, <a id="a180" name="a180"></a><a class="code hl_variable" href="structEshelbianCore.html#aaf238d1b79dcea860e0648463d07e698">bitAdjParentMask</a>, <a id="a181" name="a181"></a><a class="code hl_variable" href="structEshelbianCore.html#a2363fb172da13a753995b83e0555f565">bitAdjEnt</a>, <a id="a182" name="a182"></a><a class="code hl_variable" href="structEshelbianCore.html#af87b5b277e9ed4a79838f7a04bf7c36f">bitAdjEntMask</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a183" name="a183"></a><a class="code hl_function" href="group__mofem__fe.html#ga9c5d28e66a86646de9e733b34ea03a71">modify_finite_element_adjacency_table</a>(</div>
<div class="line">        fe_name, MBTRI, *<a class="code hl_variable" href="structEshelbianCore.html#a912ebbcc505570f26b497c1a788c49c0">parentAdjSkeletonFunctionDim2</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set finite element fields</span></div>
<div class="line">  <span class="keyword">auto</span> add_field_to_fe = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string fe,</div>
<div class="line">                                <span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(fe, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a184" name="a184"></a><a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> natural_bc_elements;</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a185" name="a185"></a><a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a186" name="a186"></a><a class="code hl_variable" href="structEshelbianCore.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a187" name="a187"></a><a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    natural_bc_elements = intersect(natural_bc_elements, meshset_ents);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(natural_bc_elements, MBTRI,</div>
<div class="line">                                                     <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(<a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a> = [&amp;](<span class="keyword">auto</span> &amp;body_ents) {</div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> skin_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents);</div>
<div class="line">    <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a> = [&amp;](<span class="keyword">auto</span> &amp;&amp;skin) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> boundary_ents;</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;boundary_ents);</div>
<div class="line">    <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a188" name="a188"></a><a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(meshset, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                       body_ents);</div>
<div class="line">    <span class="keyword">auto</span> skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(body_ents));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(skin, MBTRI, <a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">    <span class="comment">// CHKERR add_field_to_fe(skinElement, hybridSpatialDisp);</span></div>
<div class="line">    <span class="comment">// CHKERR add_field_to_fe(skinElement, hybridMaterialDisp);</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a189" name="a189"></a><a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>) {</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Contact elements &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>-&gt;size();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(*<a class="code hl_variable" href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>, MBTRI,</div>
<div class="line">                                                       <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a190" name="a190"></a><a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>)</div>
<div class="line">      SETERRQ(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No skeleton faces&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Skeleton elements &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>-&gt;size();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(*<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>, MBTRI,</div>
<div class="line">                                                     <a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   if (!mField.check_finite_element(materialSkeletonElement)) {</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//     Range front_edges = get_range_from_block(mField, &quot;FRONT&quot;, SPACE_DIM -</span></div>
<div class="line">  <span class="comment">//     2);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//     Range front_elements;</span></div>
<div class="line">  <span class="comment">//     for (auto l = 0; l != frontLayers; ++l) {</span></div>
<div class="line">  <span class="comment">//       Range front_elements_layer;</span></div>
<div class="line">  <span class="comment">//       CHKERR mField.get_moab().get_adjacencies(front_edges, SPACE_DIM,</span></div>
<div class="line">  <span class="comment">//       true,</span></div>
<div class="line">  <span class="comment">//                                                front_elements_layer,</span></div>
<div class="line">  <span class="comment">//                                                moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//       front_elements.merge(front_elements_layer);</span></div>
<div class="line">  <span class="comment">//       front_edges.clear();</span></div>
<div class="line">  <span class="comment">//       CHKERR mField.get_moab().get_adjacencies(front_elements_layer,</span></div>
<div class="line">  <span class="comment">//                                                SPACE_DIM - 2, true,</span></div>
<div class="line">  <span class="comment">//                                                front_edges,</span></div>
<div class="line">  <span class="comment">//                                                moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     }</span></div>
<div class="line">  <span class="comment">//     Range body_ents;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_entities_by_dimension(0, SPACE_DIM,</span></div>
<div class="line">  <span class="comment">//     body_ents); Range front_elements_faces; CHKERR</span></div>
<div class="line">  <span class="comment">//     mField.get_moab().get_adjacencies(front_elements, SPACE_DIM - 1,</span></div>
<div class="line">  <span class="comment">//                                              true, front_elements_faces,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     auto body_skin = filter_true_skin(get_skin(body_ents));</span></div>
<div class="line">  <span class="comment">//     auto front_elements_skin = filter_true_skin(get_skin(front_elements));</span></div>
<div class="line">  <span class="comment">//     Range material_skeleton_faces =</span></div>
<div class="line">  <span class="comment">//         subtract(front_elements_faces, front_elements_skin);</span></div>
<div class="line">  <span class="comment">//     material_skeleton_faces.merge(intersect(front_elements_skin,</span></div>
<div class="line">  <span class="comment">//     body_skin));</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">  <span class="comment">//     CHKERR save_range(mField.get_moab(), &quot;front_elements.vtk&quot;,</span></div>
<div class="line">  <span class="comment">//     front_elements); CHKERR save_range(mField.get_moab(),</span></div>
<div class="line">  <span class="comment">//     &quot;front_elements_skin.vtk&quot;,</span></div>
<div class="line">  <span class="comment">//                       front_elements_skin);</span></div>
<div class="line">  <span class="comment">//     CHKERR save_range(mField.get_moab(), &quot;material_skeleton_faces.vtk&quot;,</span></div>
<div class="line">  <span class="comment">//                       material_skeleton_faces);</span></div>
<div class="line">  <span class="comment">// #endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//     CHKERR mField.add_finite_element(materialSkeletonElement, MF_ZERO);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.add_ents_to_finite_element_by_type(</span></div>
<div class="line">  <span class="comment">//         material_skeleton_faces, MBTRI, materialSkeletonElement);</span></div>
<div class="line">  <span class="comment">//     // CHKERR add_field_to_fe(materialSkeletonElement, eshelbyStress);</span></div>
<div class="line">  <span class="comment">//     // CHKERR add_field_to_fe(materialSkeletonElement, hybridMaterialDisp);</span></div>
<div class="line">  <span class="comment">//     CHKERR set_fe_adjacency(materialSkeletonElement);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.build_finite_elements(materialSkeletonElement);</span></div>
<div class="line">  <span class="comment">//   }</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a191" name="a191"></a><a class="code hl_function" href="structEshelbianCore.html#ac9225b726d868b3097e7fc41be2b3acc">EshelbianCore::addDMs</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a id="a192" name="a192"></a><a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line">                                     <span class="keyword">const</span> EntityHandle meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// find adjacencies between finite elements and dofs</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a193" name="a193"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a id="a194" name="a194"></a><a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create coupled problem</span></div>
<div class="line">  <a id="a195" name="a195"></a><a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a> = <a class="code hl_function" href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, &amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;ESHELBY_PLASTICITY&quot;</span>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line">                            <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a196" name="_a196"></a><a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_TRUE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> remove_dofs_on_broken_skin = [&amp;](<span class="keyword">const</span> std::string prb_name) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d : {0, 1, 2}) {</div>
<div class="line">      std::vector&lt;boost::weak_ptr&lt;NumeredDofEntity&gt;&gt; dofs_to_remove;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()</div>
<div class="line">          -&gt;getSideDofsOnBrokenSpaceEntities(</div>
<div class="line">              dofs_to_remove, prb_name, <a id="a197" name="a197"></a><a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">              (*<a id="a198" name="a198"></a><a class="code hl_variable" href="structEshelbianCore.html#a33c6e981d0e2ce7570cb47031d622724">bcSpatialFreeTractionVecPtr</a>)[<a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>], <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>, <a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>);</div>
<div class="line">      <span class="comment">// remove piola dofs, i.e. traction free boundary</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;removeDofs(prb_name, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">                                                                dofs_to_remove);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;removeDofs(prb_name, <a id="a199" name="a199"></a><a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>,</div>
<div class="line">                                                                dofs_to_remove);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_dofs_on_broken_skin(<span class="stringliteral">&quot;ESHELBY_PLASTICITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create elastic sub-problem</span></div>
<div class="line">  <a id="a200" name="a200"></a><a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a> = <a class="code hl_function" href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// dmMaterial = createDM(mField.get_comm(), &quot;DMMOFEM&quot;);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMCreateSubDM(dmMaterial, dM, &quot;MATERIAL_PROBLEM&quot;);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetDestroyProblem(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddSubFieldRow(dmMaterial, eshelbyStress);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddSubFieldRow(dmMaterial, materialL2Disp);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterh elementVolumeName);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterial, naturalBcElement);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterial, skinElement);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetSquareProblem(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetIsPartitioned(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMSetUp(dmMaterial);</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_zero_block = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a id="a201" name="a201"></a><a class="code hl_variable" href="structEshelbianCore.html#aec7eec34db87d222944bbaf74cf7c0f3">solTSStep</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_section = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    PetscSection section;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a202" name="_a202"></a><a class="code hl_struct" href="structMoFEM_1_1ISManager.html">ISManager</a>&gt;()-&gt;sectionCreate(<span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>,</div>
<div class="line">                                                           &amp;section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetSection(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetGlobalSection(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionDestroy(&amp;section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_zero_block();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section();</div>
<div class="line"> </div>
<div class="line">  <a id="a203" name="a203"></a><a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a> = <a class="code hl_function" href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, <a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <span class="stringliteral">&quot;PROJECT_SPATIAL&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// CHKERR mField.getInterface&lt;BcManager&gt;()</span></div>
<div class="line">  <span class="comment">//     -&gt;pushMarkDOFsOnEntities&lt;DisplacementCubitBcData&gt;(</span></div>
<div class="line">  <span class="comment">//         &quot;PROJECT_SPATIAL&quot;, spatialH1Disp, true, false);</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BcDisp::BcDisp(std::string name, std::vector&lt;double&gt; attr, <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">    flags[ii] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(attr[ii + 3]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCDisp &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCDisp vals &quot;</span> &lt;&lt; vals[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCDisp flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCDisp nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BcRot::BcRot(std::string name, std::vector&lt;double&gt; attr, <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(attr.size(), <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != attr.size(); ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">  }</div>
<div class="line">  theta = attr[3];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">TractionBc::TractionBc(std::string name, std::vector&lt;double&gt; attr, <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">    flags[ii] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(attr[ii + 3]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCForce &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCForce vals &quot;</span> &lt;&lt; vals[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCForce flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCForce nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">NormalDisplacementBc::NormalDisplacementBc(std::string name,</div>
<div class="line">                                           std::vector&lt;double&gt; attr,</div>
<div class="line">                                           <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line"> </div>
<div class="line">  blockName = name;</div>
<div class="line">  <span class="keywordflow">if</span> (attr.size() &lt; 1) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Wrong size of normal displacement BC&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  val = attr[0];</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add NormalDisplacementBc &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add NormalDisplacementBc val &quot;</span> &lt;&lt; val;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add NormalDisplacementBc nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">PressureBc::PressureBc(std::string name, std::vector&lt;double&gt; attr, <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line"> </div>
<div class="line">  blockName = name;</div>
<div class="line">  <span class="keywordflow">if</span> (attr.size() &lt; 1) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Wrong size of normal displacement BC&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  val = attr[0];</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add PressureBc &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add PressureBc val &quot;</span> &lt;&lt; val;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add PressureBc nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">ExternalStrain::ExternalStrain(std::string name, std::vector&lt;double&gt; attr,</div>
<div class="line">                           <a class="code hl_class" href="classRange.html">Range</a> ents)</div>
<div class="line">    : blockName(name), ents(ents) {</div>
<div class="line"> </div>
<div class="line">  blockName = name;</div>
<div class="line">  <span class="keywordflow">if</span> (attr.size() &lt; 1) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Wrong size of external strain attribute&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  val = attr[0];</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add ExternalStrain &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add ExternalStrain val &quot;</span> &lt;&lt; val;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add ExternalStrain nb. of tets &quot;</span> &lt;&lt; ents.size();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">AnalyticalDisplacementBc::AnalyticalDisplacementBc(std::string name,</div>
<div class="line">                                                   std::vector&lt;double&gt; attr,</div>
<div class="line">                                                   <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line"> </div>
<div class="line">  blockName = name;</div>
<div class="line">  <span class="keywordflow">if</span> (attr.size() &lt; 3) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Wrong size of analytical displacement BC&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    flags[ii] = attr[ii];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add AnalyticalDisplacementBc &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add AnalyticalDisplacementBc flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1]</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add AnalyticalDisplacementBc nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">AnalyticalTractionBc::AnalyticalTractionBc(std::string name,</div>
<div class="line">                                                   std::vector&lt;double&gt; attr,</div>
<div class="line">                                                   <a class="code hl_class" href="classRange.html">Range</a> faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line"> </div>
<div class="line">  blockName = name;</div>
<div class="line">  <span class="keywordflow">if</span> (attr.size() &lt; 3) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                      <span class="stringliteral">&quot;Wrong size of analytical traction BC&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    flags[ii] = attr[ii];</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add AnalyticalTractionBc &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add AnalyticalTractionBc flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1]</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add AnalyticalTractionBc nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a204" name="a204"></a><a class="code hl_function" href="structEshelbianCore.html#a44780924071e102fcb49da8bc01637e8">EshelbianCore::getTractionFreeBc</a>(<span class="keyword">const</span> EntityHandle meshset,</div>
<div class="line">                                 boost::shared_ptr&lt;TractionFreeBc&gt; &amp;bc_ptr,</div>
<div class="line">                                 <span class="keyword">const</span> std::string contact_set_name) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get skin from all tets</span></div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> tets;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(meshset, MBTET, tets);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> tets_skin_part;</div>
<div class="line">  Skinner skin(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, tets_skin_part);</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> tets_skin;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(tets_skin_part,</div>
<div class="line">                               PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                               PSTATUS_NOT, -1, &amp;tets_skin);</div>
<div class="line"> </div>
<div class="line">  bc_ptr-&gt;resize(3);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; ++<a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>)</div>
<div class="line">    (*bc_ptr)[<a class="code hl_function" href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] = tets_skin;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do not remove dofs on which traction is applied</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[0])</div>
<div class="line">        (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[1])</div>
<div class="line">        (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[2])</div>
<div class="line">        (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do not remove dofs on which rotation is applied</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[0])</div>
<div class="line">        (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[1])</div>
<div class="line">        (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[2])</div>
<div class="line">        (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line">        </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// remove contact</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a205" name="a205"></a><a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(</div>
<div class="line">           <a class="code hl_namespace" href="namespacestd.html">std</a>::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % contact_set_name).str()))) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 2, faces,</div>
<div class="line">                                              <span class="keyword">true</span>);</div>
<div class="line">    (*bc_ptr)[0] = subtract((*bc_ptr)[0], faces);</div>
<div class="line">    (*bc_ptr)[1] = subtract((*bc_ptr)[1], faces);</div>
<div class="line">    (*bc_ptr)[2] = subtract((*bc_ptr)[2], faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Set integration rule on element</span></div>
<div class="line"><span class="comment"> * \param order on row</span></div>
<div class="line"><span class="comment"> * \param order on column</span></div>
<div class="line"><span class="comment"> * \param order on data</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Use maximal oder on data in order to determine integration rule</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a206" name="_a206"></a><a class="code hl_struct" href="structVolRule.html">VolRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a207" name="a207"></a><a class="code hl_function" href="structVolRule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * p_data + 1;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a208" name="_a208"></a><a class="code hl_struct" href="structFaceRule.html">FaceRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a209" name="a209"></a><a class="code hl_function" href="structFaceRule.html#aa4dbe8a983fafee94833d9f28e4eb5bf">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * (p_data + 1);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">CGGUserPolynomialBase::CGGUserPolynomialBase(</div>
<div class="line">    boost::shared_ptr&lt;CachePhi&gt; cache_phi_otr)</div>
<div class="line">    : <a id="_a210" name="_a210"></a><a class="code hl_class" href="classTetPolynomialBase.html">TetPolynomialBase</a>(), cachePhiPtr(cache_phi_otr) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> CGGUserPolynomialBase::query_interface(</div>
<div class="line">    boost::typeindex::type_index type_index,</div>
<div class="line">    <a id="_a211" name="_a211"></a><a class="code hl_struct" href="structMoFEM_1_1BaseFunctionUnknownInterface.html">BaseFunctionUnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line">  *iface = <span class="keyword">const_cast&lt;</span>CGGUserPolynomialBase *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">CGGUserPolynomialBase::getValue(<a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;pts,</div>
<div class="line">                                boost::shared_ptr&lt;BaseFunctionCtx&gt; ctx_ptr) {</div>
<div class="line">  <a id="a212" name="a212"></a><a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"> </div>
<div class="line">  this-&gt;cTx = ctx_ptr-&gt;<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a213" name="_a213"></a><a class="code hl_struct" href="structMoFEM_1_1EntPolynomialBaseCtx.html">EntPolynomialBaseCtx</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nb_gauss_pts = pts.size2();</div>
<div class="line">  <span class="keywordflow">if</span> (!nb_gauss_pts) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (pts.size1() &lt; 3) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Wrong dimension of pts, should be at least 3 rows with &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;coordinates&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> base = this-&gt;cTx-&gt;bAse;</div>
<div class="line">  <a id="_a214" name="_a214"></a><a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData.html">EntitiesFieldData</a> &amp;data = this-&gt;cTx-&gt;dAta;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (this-&gt;cTx-&gt;sPace) {</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>:</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getValueHdivForCGGBubble(pts);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>:</div>
<div class="line">    data.<a id="a215" name="a215"></a><a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getN(base).resize(nb_gauss_pts, 4, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Tools::shapeFunMBTET(</div>
<div class="line">        &amp;*data.<a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getN(base).data().begin(),</div>
<div class="line">        &amp;pts(0, 0), &amp;pts(1, 0), &amp;pts(2, 0), nb_gauss_pts);</div>
<div class="line">    data.<a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getDiffN(base).resize(4, 3, <span class="keyword">false</span>);</div>
<div class="line">    std::copy(Tools::diffShapeFunMBTET.begin(), Tools::diffShapeFunMBTET.end(),</div>
<div class="line">              data.<a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getDiffN(base).data().begin());</div>
<div class="line">    this-&gt;cTx-&gt;basePolynomialsType0 = <a id="a216" name="a216"></a><a class="code hl_function" href="group__mofem__base__functions.html#ga176a495a81c85ce580624a284726521e">Legendre_polynomials</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getValueL2AinsworthBase(pts);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not yet implemented&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">CGGUserPolynomialBase::getValueHdivForCGGBubble(<a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;pts) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// This should be used only in case USER_BASE is selected</span></div>
<div class="line">  <span class="keywordflow">if</span> (this-&gt;cTx-&gt;bAse != <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Wrong base, should be USER_BASE&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// get access to data structures on element</span></div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData.html">EntitiesFieldData</a> &amp;data = this-&gt;cTx-&gt;dAta;</div>
<div class="line">  <span class="comment">// Get approximation order on element. Note that bubble functions are only</span></div>
<div class="line">  <span class="comment">// on tetrahedron.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = data.<a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getOrder();<span class="comment"></span></div>
<div class="line"><span class="comment">  /// number of integration points</span></div>
<div class="line"><span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = pts.size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> check_cache = [<span class="keyword">this</span>](<span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keywordtype">int</span> nb_gauss_pts) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line">    <span class="keywordflow">if</span> (cachePhiPtr) {</div>
<div class="line">      <span class="keywordflow">return</span> cachePhiPtr-&gt;get&lt;0&gt;() == <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &amp;&amp;</div>
<div class="line">             cachePhiPtr-&gt;get&lt;1&gt;() == nb_gauss_pts;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (check_cache(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, nb_gauss_pts)) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;mat = cachePhiPtr-&gt;get&lt;2&gt;();</div>
<div class="line">    <span class="keyword">auto</span> &amp;<a id="a217" name="a217"></a><a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = data.<a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>);</div>
<div class="line">    <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(mat.size1(), mat.size2(), <span class="keyword">false</span>);</div>
<div class="line">    noalias(<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>) = mat;</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// calculate shape functions, i.e. barycentric coordinates</span></div>
<div class="line">    shapeFun.resize(nb_gauss_pts, 4, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a>(&amp;*shapeFun.data().begin(), &amp;pts(0, 0), &amp;pts(1, 0),</div>
<div class="line">                      &amp;pts(2, 0), nb_gauss_pts);</div>
<div class="line">    <span class="comment">// derivatives of shape functions</span></div>
<div class="line">    <span class="keywordtype">double</span> diff_shape_fun[12];</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a218" name="a218"></a><a class="code hl_function" href="fem__tools_8h.html#a19deff62572d607bc77ed2f82fa639cc">ShapeDiffMBTET</a>(diff_shape_fun);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = <a class="code hl_define" href="CGGTonsorialBubbleBase_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a>(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <span class="comment">// get base functions and set size</span></div>
<div class="line">    <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = data.<a class="code hl_variable" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>);</div>
<div class="line">    <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(nb_gauss_pts, 9 * nb_base_functions, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// finally calculate base functions</span></div>
<div class="line">    <a id="_a219" name="_a219"></a><a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 9&gt;</a>, 3, 3&gt; t_phi(</div>
<div class="line">        &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 0), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 1), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 2),</div>
<div class="line"> </div>
<div class="line">        &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 3), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 4), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 5),</div>
<div class="line"> </div>
<div class="line">        &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 6), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 7), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 8));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceEshelbianPlasticity.html#a68543d06189d85f76d53dfc14a39ecf5">CGG_BubbleBase_MBTET</a>(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, &amp;shapeFun(0, 0), diff_shape_fun, t_phi,</div>
<div class="line">                                nb_gauss_pts);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cachePhiPtr) {</div>
<div class="line">      cachePhiPtr-&gt;get&lt;0&gt;() = <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>;</div>
<div class="line">      cachePhiPtr-&gt;get&lt;1&gt;() = nb_gauss_pts;</div>
<div class="line">      cachePhiPtr-&gt;get&lt;2&gt;().resize(<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size1(), <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size2(), <span class="keyword">false</span>);</div>
<div class="line">      noalias(cachePhiPtr-&gt;get&lt;2&gt;()) = <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a220" name="a220"></a><a class="code hl_function" href="structEshelbianCore.html#a4530aa6762e72237e130380c7ce2ba86">EshelbianCore::setBaseVolumeElementOps</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_rhs, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_lhs, <span class="keyword">const</span> <span class="keywordtype">bool</span> calc_rates,</div>
<div class="line">    <a id="_a221" name="_a221"></a><a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> var_vec,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; fe) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bubble_cache =</div>
<div class="line">      boost::make_shared&lt;CGGUserPolynomialBase::CachePhi&gt;(0, 0, <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>());</div>
<div class="line">  fe-&gt;getUserPolynomialBase() =</div>
<div class="line">      boost::make_shared&lt;CGGUserPolynomialBase&gt;(bubble_cache);</div>
<div class="line">  EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">      fe-&gt;getOpPtrVector(), {HDIV, H1, L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set integration rule</span></div>
<div class="line">  fe-&gt;getRuleHook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  fe-&gt;setRuleHook = SetIntegrationAtFrontVolume(<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  <span class="comment">// fe-&gt;getRuleHook = VolRule();</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a id="a222" name="a222"></a><a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>) {</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a> =</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt;(<span class="keyword">new</span> <a id="_a223" name="_a223"></a><a class="code hl_struct" href="structDataAtIntegrationPts.html">DataAtIntegrationPts</a>());</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;physicsPtr = <a id="a224" name="a224"></a><a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate fields values</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a225" name="_a225"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts()));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a226" name="_a226"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), MBMAXTYPE));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a227" name="_a227"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorDivergence.html">OpCalculateHVecTensorDivergence&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getDivPAtPts()));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a228" name="_a228"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchTensorAtPts(), MBTET));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a229" name="_a229"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisAtPts(), MBTET));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxis0AtPts(), <a class="code hl_variable" href="structEshelbianCore.html#aec7eec34db87d222944bbaf74cf7c0f3">solTSStep</a>, MBTET));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2AtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// H1 displacements</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWH1AtPts()));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a230" name="_a230"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWGradH1AtPts()));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// velocities</span></div>
<div class="line">  <span class="keywordflow">if</span> (calc_rates) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a231" name="_a231"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">OpCalculateVectorFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2DotAtPts(), MBTET));</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a232" name="_a232"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValuesDot.html">OpCalculateTensor2SymmetricFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchDotTensorAtPts(), MBTET));</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a233" name="_a233"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradientDot.html">OpCalculateVectorFieldGradientDot&lt;6, 3&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getGradLogStretchDotTensorAtPts(),</div>
<div class="line">              MBTET));</div>
<div class="line">    }</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">OpCalculateVectorFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisDotAtPts(), MBTET));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradientDot.html">OpCalculateVectorFieldGradientDot&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisGradDotAtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// acceleration</span></div>
<div class="line">    <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">OpCalculateVectorFieldValuesDotDot&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2DotDotAtPts(), MBTET));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// variations</span></div>
<div class="line">  <span class="keywordflow">if</span> (var_vec.<a id="a234" name="a234"></a><a class="code hl_function" href="structMoFEM_1_1SmartPetscObj.html#ab83f85c53d250afafd28487980674a97">use_count</a>()) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(), boost::make_shared&lt;double&gt;(1),</div>
<div class="line">        var_vec));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(), boost::make_shared&lt;double&gt;(1),</div>
<div class="line">        var_vec, MBMAXTYPE));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarRotAxisPts(), var_vec, MBTET));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorDivergence.html">OpCalculateHVecTensorDivergence&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getDivVarPiolaPts(), var_vec));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarWL2Pts(), var_vec, MBTET));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateVarStretchFromStress(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarLogStreachPts(), var_vec, MBTET));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate other derived quantities</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a235" name="_a235"></a><a class="code hl_struct" href="structOpCalculateRotationAndSpatialGradient.html">OpCalculateRotationAndSpatialGradient</a>(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, ((do_rhs || do_lhs) &amp;&amp; calc_rates) ? <a class="code hl_variable" href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a> : 0.));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// evaluate integration points</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpJacobian(</div>
<div class="line">        tag, do_rhs, do_lhs, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a236" name="a236"></a><a class="code hl_function" href="structEshelbianCore.html#a7e7a066d74bb6e8258720b709490e138">EshelbianCore::setVolumeElementOps</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_elastic, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_material,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe_rhs,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe_lhs) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** Contact requires that body is marked */</span></div>
<div class="line">  <span class="keyword">auto</span> get_body_range = [<span class="keyword">this</span>](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr :</div>
<div class="line">         <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(<a class="code hl_namespace" href="namespacestd.html">std</a>::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_ptr-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                                                            dim, ents, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;by dim&quot;</span>);</div>
<div class="line">      map[m_ptr-&gt;getMeshsetId()] = ents;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> rule_contact = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> o) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  <span class="keyword">auto</span> refine = Tools::refineTriangle(<a class="code hl_variable" href="structEshelbianCore.html#a767ea904eb33f7f44cbdef68cfe7cdfc">contactRefinementLevels</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_rule_contact = [refine](</div>
<div class="line"> </div>
<div class="line">                              <a class="code hl_struct" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                              <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data</div>
<div class="line"> </div>
<div class="line">                          ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> rule = 2 * order_data;</div>
<div class="line">    fe_raw_ptr-&gt;<a id="a237" name="a237"></a><a class="code hl_variable" href="structMoFEM_1_1ForcesAndSourcesCore.html#a91c6f5f96b8f4ec76ed7c87ea96bbd9c">gaussPts</a> = Tools::refineTriangleIntegrationPts(rule, refine);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Right hand side</span></div>
<div class="line">  fe_rhs = boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#a4530aa6762e72237e130380c7ce2ba86">setBaseVolumeElementOps</a>(tag, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(),</div>
<div class="line">                                 fe_rhs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a238" name="_a238"></a><a class="code hl_struct" href="structOpSpatialEquilibrium.html">OpSpatialEquilibrium</a>(<a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>, <a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a239" name="_a239"></a><a class="code hl_struct" href="structOpSpatialRotation.html">OpSpatialRotation</a>(<a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>));</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      <span class="comment">// do nothing - no stretch approximation</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>.empty()) {</div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a240" name="_a240"></a><a class="code hl_struct" href="structOpGetInternalStress.html">OpGetInternalStress&lt;0&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>));</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="structOpGetInternalStress.html">OpGetInternalStress&lt;1&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>));</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          SETERRQ1(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;Unsupported internal stress interpolation order %d&quot;</span>,</div>
<div class="line">                   <a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ab85ab2a5287eb2124aea7db52e8e4556">internalStressVoigt</a>) {</div>
<div class="line">          fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a id="_a241" name="_a241"></a><a class="code hl_struct" href="structOpSpatialPhysicalInternalStress.html">OpSpatialPhysicalInternalStress&lt;true&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>,</div>
<div class="line">                                                        <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="structOpSpatialPhysicalInternalStress.html">OpSpatialPhysicalInternalStress&lt;false&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>,</div>
<div class="line">                                                         <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a242" name="_a242"></a><a class="code hl_struct" href="structOpSpatialPhysicalExternalStrain.html">OpSpatialPhysicalExternalStrain</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a id="a243" name="a243"></a><a class="code hl_variable" href="structEshelbianCore.html#a0ad247d6694e42cb585396f1f02aa1a3">externalStrainVecPtr</a>, <a id="a244" name="a244"></a><a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSpatialPhysical(<a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">                                                     <a class="code hl_variable" href="structEshelbianCore.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>));</div>
<div class="line">    }</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a245" name="_a245"></a><a class="code hl_struct" href="structOpSpatialConsistencyP.html">OpSpatialConsistencyP</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a246" name="_a246"></a><a class="code hl_struct" href="structOpSpatialConsistencyBubble.html">OpSpatialConsistencyBubble</a>(<a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a247" name="_a247"></a><a class="code hl_struct" href="structOpSpatialConsistencyDivTerm.html">OpSpatialConsistencyDivTerm</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_hybridisation = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a id="_a248" name="_a248"></a><a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a id="_a249" name="_a249"></a><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a id="_a250" name="_a250"></a><a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line">      <span class="comment">// op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = FaceRule();</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      };</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook =</div>
<div class="line">          SetIntegrationAtFrontFace(<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly one</span></div>
<div class="line">      <span class="comment">// domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a id="_a251" name="_a251"></a><a class="code hl_struct" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a252" name="_a252"></a><a class="code hl_struct" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, broken_data_ptr));</div>
<div class="line">      <span class="keyword">auto</span> flux_mat_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;SPACE_DIM, SPACE_DIM&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                               flux_mat_ptr));</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a253" name="_a253"></a><a class="code hl_struct" href="structMoFEM_1_1OpSetFlux.html">OpSetFlux&lt;SideEleOp&gt;</a>(broken_data_ptr, flux_mat_ptr));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Assemble on skeleton</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keyword">using </span>OpC_dHybrid = <a id="_a254" name="_a254"></a><a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a id="a255" name="a255"></a><a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;<a id="_a256" name="_a256"></a><a class="code hl_class" href="classLinearForm.html">::LinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDHybrid&lt;SPACE_DIM&gt;;</div>
<div class="line">      <span class="keyword">using </span>OpC_dBroken = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;<a class="code hl_class" href="classLinearForm.html">::LinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDFlux&lt;SPACE_DIM&gt;;</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC_dHybrid(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, broken_data_ptr, boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line">      <span class="keyword">auto</span> hybrid_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>,</div>
<div class="line">                                                      hybrid_ptr));</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC_dBroken(</div>
<div class="line">          broken_data_ptr, hybrid_ptr, boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_contact = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule_contact;</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook = set_rule_contact;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly</span></div>
<div class="line">      <span class="comment">// one domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Data storing contact fields</span></div>
<div class="line">      <span class="keyword">auto</span> contact_common_data_ptr =</div>
<div class="line">          boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_domain_side = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">        <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">        op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">            boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">        EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">            op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                   broken_data_ptr));</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a257" name="_a257"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">        pip.push_back(op_loop_domain_side);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_contact_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// get body id and SDF range</span></div>
<div class="line">        <span class="keyword">auto</span> contact_sfd_map_range_ptr =</div>
<div class="line">            boost::make_shared&lt;std::map&lt;int, Range&gt;&gt;(</div>
<div class="line">                get_body_range(<span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">        <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">            <a id="a258" name="a258"></a><a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">            <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), <span class="keyword">nullptr</span>,</div>
<div class="line">            <span class="keyword">nullptr</span>));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a259" name="_a259"></a><a class="code hl_struct" href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Rhs.html">EshelbianPlasticity::OpConstrainBoundaryL2Rhs</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>,</div>
<div class="line">            contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a260" name="_a260"></a><a class="code hl_struct" href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivRhs.html">EshelbianPlasticity::OpConstrainBoundaryHDivRhs&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                broken_data_ptr, contact_common_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>));</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push ops to face/side pipeline</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_domain_side(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_contact_rhs(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_hybridisation(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_contact(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Body forces</span></div>
<div class="line">    <span class="keyword">using </span>BodyNaturalBC =</div>
<div class="line">        <a id="_a261" name="_a261"></a><a class="code hl_struct" href="structMoFEM_1_1NaturalBC.html">NaturalBC&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;</a>::</div>
<div class="line">            Assembly&lt;PETSC&gt;::LinearForm&lt;<a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="thermo__elastic_8cpp.html#ae7c94e41d241c2484ddfe347db0156d6">OpBodyForce</a> =</div>
<div class="line">        BodyNaturalBC::OpFlux&lt;NaturalMeshsetType&lt;BLOCKSET&gt;, 1, 3&gt;;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> body_time_scale =</div>
<div class="line">        boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;body_force.txt&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> BodyNaturalBC::AddFluxToPipeline&lt;OpBodyForce&gt;::add(</div>
<div class="line">        fe_rhs-&gt;getOpPtrVector(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, {body_time_scale},</div>
<div class="line">        <span class="stringliteral">&quot;BODY_FORCE&quot;</span>, Sev::inform);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Left hand side</span></div>
<div class="line">  fe_lhs = boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#a4530aa6762e72237e130380c7ce2ba86">setBaseVolumeElementOps</a>(tag, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(),</div>
<div class="line">                                 fe_lhs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a262" name="_a262"></a><a class="code hl_struct" href="structOpSpatialConsistency__dP__dP.html">OpSpatialConsistency_dP_dP</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a263" name="_a263"></a><a class="code hl_struct" href="structOpSpatialConsistency__dBubble__dP.html">OpSpatialConsistency_dBubble_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a264" name="_a264"></a><a class="code hl_struct" href="structOpSpatialConsistency__dBubble__dBubble.html">OpSpatialConsistency_dBubble_dBubble</a>(<a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>,</div>
<div class="line">                                                   <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSpatialPhysical_du_du(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a265" name="_a265"></a><a class="code hl_struct" href="structOpSpatialPhysical__du__dP.html">OpSpatialPhysical_du_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">true</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a266" name="_a266"></a><a class="code hl_struct" href="structOpSpatialPhysical__du__dBubble.html">OpSpatialPhysical_du_dBubble</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">true</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a267" name="_a267"></a><a class="code hl_struct" href="structOpSpatialPhysical__du__domega.html">OpSpatialPhysical_du_domega</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">true</span> : false));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a268" name="_a268"></a><a class="code hl_struct" href="structOpSpatialEquilibrium__dw__dP.html">OpSpatialEquilibrium_dw_dP</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">true</span>));</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a269" name="_a269"></a><a class="code hl_struct" href="structOpSpatialEquilibrium__dw__dw.html">OpSpatialEquilibrium_dw_dw</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>, <a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>));</div>
<div class="line"> </div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a270" name="_a270"></a><a class="code hl_struct" href="structOpSpatialConsistency__dP__domega.html">OpSpatialConsistency_dP_domega</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">true</span> : false));</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a271" name="_a271"></a><a class="code hl_struct" href="structOpSpatialConsistency__dBubble__domega.html">OpSpatialConsistency_dBubble_domega</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">true</span> : false));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">false</span> : true) {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a272" name="_a272"></a><a class="code hl_struct" href="structOpSpatialRotation__domega__du.html">OpSpatialRotation_domega_du</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">false</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a273" name="_a273"></a><a class="code hl_struct" href="structOpSpatialRotation__domega__dP.html">OpSpatialRotation_domega_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">false</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a274" name="_a274"></a><a class="code hl_struct" href="structOpSpatialRotation__domega__dBubble.html">OpSpatialRotation_domega_dBubble</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">false</span>));</div>
<div class="line">    }</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a275" name="_a275"></a><a class="code hl_struct" href="structOpSpatialRotation__domega__domega.html">OpSpatialRotation_domega_domega</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_hybridisation = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line">      <span class="comment">// op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = FaceRule();</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      };</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook =</div>
<div class="line">          SetIntegrationAtFrontFace(<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly one</span></div>
<div class="line">      <span class="comment">// domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, broken_data_ptr));</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keyword">using </span>OpC = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;<a id="_a276" name="_a276"></a><a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrain&lt;SPACE_DIM&gt;;</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpC(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, broken_data_ptr,</div>
<div class="line">                  boost::make_shared&lt;double&gt;(1.0), <span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line"> </div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_contact = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule_contact;</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook = set_rule_contact;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly</span></div>
<div class="line">      <span class="comment">// one domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Data storing contact fields</span></div>
<div class="line">      <span class="keyword">auto</span> contact_common_data_ptr =</div>
<div class="line">          boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_domain_side = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">        <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">        op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">            boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">        EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">            op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                   broken_data_ptr));</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">        pip.push_back(op_loop_domain_side);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_contact_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">        <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">            <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), <span class="keyword">nullptr</span>,</div>
<div class="line">            <span class="keyword">nullptr</span>));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// get body id and SDF range</span></div>
<div class="line">        <span class="keyword">auto</span> contact_sfd_map_range_ptr =</div>
<div class="line">            boost::make_shared&lt;std::map&lt;int, Range&gt;&gt;(</div>
<div class="line">                get_body_range(<span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a277" name="_a277"></a><a class="code hl_struct" href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dU</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>,</div>
<div class="line">            contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a278" name="_a278"></a><a class="code hl_struct" href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dP.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dP&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, broken_data_ptr, contact_common_data_ptr,</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a279" name="_a279"></a><a class="code hl_struct" href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivLhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryHDivLhs_dU&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                broken_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr,</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>));</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push ops to face/side pipeline</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_domain_side(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_contact_lhs(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_hybridisation(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_contact(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (add_material) {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a280" name="a280"></a><a class="code hl_function" href="structEshelbianCore.html#a99a3132d0ad53b6ca41822303148d2d6">EshelbianCore::setFaceElementOps</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> add_elastic, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_material,</div>
<div class="line">    boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; &amp;fe_rhs,</div>
<div class="line">    boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; &amp;fe_lhs) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  fe_rhs = boost::make_shared&lt;FaceElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">  fe_lhs = boost::make_shared&lt;FaceElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set integration rule</span></div>
<div class="line">  <span class="comment">// fe_rhs-&gt;getRuleHook = [](int, int, int p) { return 2 * (p + 1); };</span></div>
<div class="line">  <span class="comment">// fe_lhs-&gt;getRuleHook = [](int, int, int p) { return 2 * (p + 1); };</span></div>
<div class="line">  fe_rhs-&gt;getRuleHook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  fe_lhs-&gt;getRuleHook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  fe_rhs-&gt;setRuleHook = SetIntegrationAtFrontFace(<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  fe_lhs-&gt;setRuleHook = SetIntegrationAtFrontFace(<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_broken_op_side = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="comment">// Iterate over domain FEs adjacent to boundary.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, broken_data_ptr));</div>
<div class="line">      boost::shared_ptr&lt;double&gt; piola_scale_ptr(<span class="keyword">new</span> <span class="keywordtype">double</span>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSetScale(piola_scale_ptr,</div>
<div class="line">                                              <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> piola_stress_mat_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                               piola_stress_mat_ptr));</div>
<div class="line">      pip.push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keywordflow">return</span> std::make_tuple(broken_data_ptr, piola_scale_ptr,</div>
<div class="line">                             piola_stress_mat_ptr);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_rhs = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> [broken_data_ptr, piola_scale_ptr, piola_stress_mat_ptr] =</div>
<div class="line">          get_broken_op_side(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a281" name="_a281"></a><a class="code hl_struct" href="structOpDispBc.html">OpDispBc</a>(broken_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>, <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a282" name="_a282"></a><a class="code hl_struct" href="structOpAnalyticalDispBc.html">OpAnalyticalDispBc</a>(</div>
<div class="line">          broken_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a>,</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a283" name="_a283"></a><a class="code hl_struct" href="structOpRotationBc.html">OpRotationBc</a>(</div>
<div class="line">          broken_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>, <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line"> </div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a284" name="_a284"></a><a class="code hl_struct" href="structOpBrokenTractionBc.html">OpBrokenTractionBc</a>(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>,</div>
<div class="line">                                 piola_scale_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a285" name="_a285"></a><a class="code hl_struct" href="structOpBrokenPressureBc.html">OpBrokenPressureBc</a>(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>,</div>
<div class="line">                                 piola_scale_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a286" name="_a286"></a><a class="code hl_struct" href="structOpBrokenAnalyticalTractionBc.html">OpBrokenAnalyticalTractionBc</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>, piola_scale_ptr,</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> hybrid_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>,</div>
<div class="line">                                                      hybrid_ptr));</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a287" name="_a287"></a><a class="code hl_struct" href="structOpNormalDispRhsBc.html">OpNormalDispRhsBc</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, hybrid_ptr, piola_stress_mat_ptr,</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>, <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_normal_disp_bc_faces = [&amp;]() {</div>
<div class="line">        <span class="keyword">auto</span> faces =</div>
<div class="line">            <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;NORMAL_DISPLACEMENT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">        <span class="keywordflow">return</span> boost::make_shared&lt;Range&gt;(faces);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span>OpC_dBroken = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;<a class="code hl_class" href="classLinearForm.html">::LinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDFlux&lt;SPACE_DIM&gt;;</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC_dBroken(</div>
<div class="line">          broken_data_ptr, hybrid_ptr, boost::make_shared&lt;double&gt;(1.0),</div>
<div class="line">          get_normal_disp_bc_faces()));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_lhs = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> [broken_data_ptr, piola_scale_ptr, piola_stress_mat_ptr] =</div>
<div class="line">          get_broken_op_side(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a288" name="_a288"></a><a class="code hl_struct" href="structOpNormalDispLhsBc__dU.html">OpNormalDispLhsBc_dU</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>, <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a289" name="_a289"></a><a class="code hl_struct" href="structOpNormalDispLhsBc__dP.html">OpNormalDispLhsBc_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, broken_data_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>,</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_normal_disp_bc_faces = [&amp;]() {</div>
<div class="line">        <span class="keyword">auto</span> faces =</div>
<div class="line">            <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;NORMAL_DISPLACEMENT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">        <span class="keywordflow">return</span> boost::make_shared&lt;Range&gt;(faces);</div>
<div class="line">      };</div>
<div class="line">      </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span>OpC = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrain&lt;SPACE_DIM&gt;;</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, broken_data_ptr, boost::make_shared&lt;double&gt;(1.0),</div>
<div class="line">          <span class="keyword">true</span>, <span class="keyword">true</span>, get_normal_disp_bc_faces()));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_rhs();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_lhs();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a290" name="a290"></a><a class="code hl_function" href="structEshelbianCore.html#a973fec6048052976e4167d61468443fb">EshelbianCore::setContactElementRhsOps</a>(</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ContactTree&gt; &amp;fe_contact_tree</div>
<div class="line"> </div>
<div class="line">) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** Contact requires that body is marked */</span></div>
<div class="line">  <span class="keyword">auto</span> get_body_range = [<span class="keyword">this</span>](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim, <span class="keyword">auto</span> sev) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr :</div>
<div class="line">         <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(<a class="code hl_namespace" href="namespacestd.html">std</a>::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_ptr-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                                                            dim, ents, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;by dim&quot;</span>);</div>
<div class="line">      map[m_ptr-&gt;getMeshsetId()] = ents;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSYNC&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Meshset: &quot;</span> &lt;&lt; m_ptr-&gt;getMeshsetId() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                               &lt;&lt; ents.size() &lt;&lt; <span class="stringliteral">&quot; entities&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a id="a291" name="a291"></a><a class="code hl_define" href="LogManager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), sev);</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_map_skin = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> skin_faces;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, <span class="keyword">false</span>, skin_faces);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin_faces,</div>
<div class="line">                                           PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                           PSTATUS_NOT, -1, <span class="keyword">nullptr</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;filter&quot;</span>);</div>
<div class="line">      <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.swap(skin_faces);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* The above code is written in C++ and it appears to be defining and using</span></div>
<div class="line"><span class="comment">  various operations on boundary elements and side elements. */</span></div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> = <a id="_a292" name="_a292"></a><a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">  <span class="keyword">using </span><a id="_a293" name="_a293"></a><a class="code hl_class" href="classBoundaryEleOp.html">BoundaryEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> contact_common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calcs_side_traction = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">        <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">    op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">        boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">    EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">    op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line">    pip.push_back(op_loop_domain_side);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_contact_three = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> tree_moab_ptr = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">    fe_contact_tree = boost::make_shared&lt;ContactTree&gt;(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, tree_moab_ptr, <a class="code hl_variable" href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>,</div>
<div class="line">        get_body_range(<span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::inform));</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calcs_side_traction(fe_contact_tree-&gt;getOpPtrVector());</div>
<div class="line">    <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpMoveNode(fe_contact_tree, contact_common_data_ptr, u_h1_ptr));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_contact_three();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a294" name="a294"></a><a class="code hl_function" href="structEshelbianCore.html#a086c46eedf160d647dd5261161545ed4">EshelbianCore::setElasticElementOps</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add contact operators. Note that only for rhs. THe lhs is assembled with</span></div>
<div class="line">  <span class="comment">// volume element, to enable schur complement evaluation.</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#a973fec6048052976e4167d61468443fb">setContactElementRhsOps</a>(<a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#a7e7a066d74bb6e8258720b709490e138">setVolumeElementOps</a>(tag, <span class="keyword">true</span>, <span class="keyword">false</span>, <a id="a295" name="a295"></a><a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>, <a id="a296" name="a296"></a><a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#a99a3132d0ad53b6ca41822303148d2d6">setFaceElementOps</a>(<span class="keyword">true</span>, <span class="keyword">false</span>, <a id="a297" name="a297"></a><a class="code hl_variable" href="structEshelbianCore.html#a2d854849515a43de7542231c5dc29570">elasticBcRhs</a>, <a id="a298" name="a298"></a><a class="code hl_variable" href="structEshelbianCore.html#a3fa759a191f5c61035bc28d824acea64">elasticBcLhs</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> adj_cache =</div>
<div class="line">      boost::make_shared&lt;ForcesAndSourcesCore::UserDataOperator::AdjCache&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_op_contact_bc = [&amp;]() {</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;SideEle&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy, adj_cache);</div>
<div class="line">    <span class="keywordflow">return</span> op_loop_side;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a299" name="a299"></a><a class="code hl_function" href="structEshelbianCore.html#a74019c5d29e41cf539cd905c55497f00">EshelbianCore::setElasticElementToTs</a>(DM dm) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; null;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">DMMoFEMTSSetI2Function</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">DMMoFEMTSSetI2Function</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a2d854849515a43de7542231c5dc29570">elasticBcRhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">DMMoFEMTSSetI2Jacobian</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">DMMoFEMTSSetI2Jacobian</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a3fa759a191f5c61035bc28d824acea64">elasticBcLhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a2d854849515a43de7542231c5dc29570">elasticBcRhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm, <a class="code hl_variable" href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a3fa759a191f5c61035bc28d824acea64">elasticBcLhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="EshelbianMonitor_8cpp.html">impl/EshelbianMonitor.cpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SetUpSchurImpl_8cpp.html">impl/SetUpSchurImpl.cpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSElasticPostStep_8cpp.html">impl/TSElasticPostStep.cpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>solve_elastic_setup {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keyword">auto</span> setup(<a class="code hl_struct" href="structEshelbianCore.html">EshelbianCore</a> *ep_ptr, TS ts, Vec x,</div>
<div class="line">                           <span class="keywordtype">bool</span> set_ts_monitor) {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ENABLE_PYTHON_BINDING</span></div>
<div class="line">    <span class="keyword">auto</span> setup_sdf = [&amp;]() {</div>
<div class="line">      boost::shared_ptr&lt;ContactOps::SDFPython&gt; sdf_python_ptr;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> file_exists = [](std::string myfile) {</div>
<div class="line">        std::ifstream file(myfile.c_str());</div>
<div class="line">        <span class="keywordflow">if</span> (file) {</div>
<div class="line">          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">char</span> sdf_file_name[255] = <span class="stringliteral">&quot;sdf.py&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">PetscOptionsGetString</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-sdf_file&quot;</span>,</div>
<div class="line">                                   sdf_file_name, 255, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (file_exists(sdf_file_name)) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; sdf_file_name &lt;&lt; <span class="stringliteral">&quot; file found&quot;</span>;</div>
<div class="line">        sdf_python_ptr = boost::make_shared&lt;ContactOps::SDFPython&gt;();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sdf_python_ptr-&gt;sdfInit(sdf_file_name);</div>
<div class="line">        ContactOps::sdfPythonWeakPtr = sdf_python_ptr;</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;SdfPython initialized&quot;</span>;</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::warning) &lt;&lt; sdf_file_name &lt;&lt; <span class="stringliteral">&quot; file NOT found&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> sdf_python_ptr;</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> sdf_python_ptr = setup_sdf();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_ts_monitor = [&amp;]() {</div>
<div class="line">      boost::shared_ptr&lt;TsCtx&gt; <a id="a300" name="a300"></a><a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>;</div>
<div class="line">      <a class="code hl_function" href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">DMMoFEMGetTsCtx</a>(ep_ptr-&gt;<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">      <span class="keywordflow">if</span> (set_ts_monitor) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, TsMonitorSet, <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.get(), PETSC_NULL);</div>
<div class="line">        <span class="keyword">auto</span> monitor_ptr = boost::make_shared&lt;EshelbianMonitor&gt;(*ep_ptr);</div>
<div class="line">        <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>-&gt;<a id="a301" name="a301"></a><a class="code hl_function" href="structMoFEM_1_1TsCtx.html#a3980182510ce819db5b281b6df595130">getLoopsMonitor</a>().push_back(</div>
<div class="line">            <a id="_a302" name="_a302"></a><a class="code hl_struct" href="structMoFEM_1_1PairNameFEMethodPtr.html">TsCtx::PairNameFEMethodPtr</a>(ep_ptr-&gt;<a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, monitor_ptr));</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;TS monitor setup&quot;</span>;</div>
<div class="line">      <span class="keywordflow">return</span> std::make_tuple(<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_snes_monitor = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">      SNES snes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">      PetscViewerAndFormat *vf;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscViewerAndFormatCreate(PETSC_VIEWER_STDOUT_WORLD,</div>
<div class="line">                                        PETSC_VIEWER_DEFAULT, &amp;vf);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(</div>
<div class="line">          snes,</div>
<div class="line">          (<a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal,</div>
<div class="line">                             <span class="keywordtype">void</span> *))SNESMonitorFields,</div>
<div class="line">          vf, (<a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(<span class="keywordtype">void</span> **))PetscViewerAndFormatDestroy);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;SNES monitor setup&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_section = [&amp;]() {</div>
<div class="line">      PetscSection section_raw;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMGetSection(ep_ptr-&gt;<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, &amp;section_raw);</div>
<div class="line">      <span class="keywordtype">int</span> num_fields;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetNumFields(section_raw, &amp;num_fields);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ff = 0; ff != num_fields; ff++) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetFieldName(section_raw, ff, &amp;<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">        <a id="a303" name="a303"></a><a class="code hl_define" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform, <span class="stringliteral">&quot;Field %d name %s&quot;</span>, ff, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> section_raw;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_vector_on_mesh = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(ep_ptr-&gt;<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, x, INSERT_VALUES,</div>
<div class="line">                                     SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Vector set on mesh&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_schur_block_solver = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Setting up Schur block solver&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSAppendOptionsPrefix(ts, <span class="stringliteral">&quot;elastic_&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, ep_ptr-&gt;<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line">      <span class="comment">// Adding field split solver</span></div>
<div class="line">      boost::shared_ptr&lt;EshelbianCore::SetUpSchur&gt; schur_ptr;</div>
<div class="line">      <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a> == AssemblyType::BLOCK_MAT) {</div>
<div class="line">        schur_ptr =</div>
<div class="line">            <a id="a304" name="a304"></a><a class="code hl_function" href="structEshelbianCore_1_1SetUpSchur.html#a6eb28d3a5bfe67448e57dd15eaee5318">EshelbianCore::SetUpSchur::createSetUpSchur</a>(ep_ptr-&gt;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, ep_ptr);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(schur_ptr-&gt;setUp(ts), <span class="stringliteral">&quot;setup schur&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Setting up Schur block solver done&quot;</span>;</div>
<div class="line">      <span class="keywordflow">return</span> schur_ptr;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Warning: sequence of construction is not guaranteed for tuple. You have</span></div>
<div class="line">    <span class="comment">// to enforce order by proper packaging.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ENABLE_PYTHON_BINDING</span></div>
<div class="line">    <span class="keywordflow">return</span> std::make_tuple(setup_sdf(), setup_ts_monitor(),</div>
<div class="line">                           setup_snes_monitor(), setup_section(),</div>
<div class="line">                           set_vector_on_mesh(), setup_schur_block_solver());</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <span class="keywordflow">return</span> std::make_tuple(setup_ts_monitor(), setup_snes_monitor(),</div>
<div class="line">                           setup_section(), set_vector_on_mesh(),</div>
<div class="line">                           setup_schur_block_solver());</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a305" name="a305"></a><a class="code hl_function" href="structEshelbianCore.html#a64e2ddd4583aa15ef34929b7c16f6abf">EshelbianCore::solveElastic</a>(TS ts, Vec x) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  PetscBool debug_model = PETSC_FALSE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-debug_model&quot;</span>, &amp;debug_model,</div>
<div class="line">                             PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (debug_model == PETSC_TRUE) {</div>
<div class="line">    <span class="keyword">auto</span> ts_ctx_ptr = <a class="code hl_function" href="namespaceMoFEM.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line">    <span class="keyword">auto</span> post_proc = [&amp;](TS ts, PetscReal <a id="a306" name="a306"></a><a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> u, <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> u_t, <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> u_tt, <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a id="a307" name="a307"></a><a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,</div>
<div class="line">                         <span class="keywordtype">void</span> *ctx) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      SNES snes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">      <span class="keywordtype">int</span> it;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetIterationNumber(snes, &amp;it);</div>
<div class="line">      std::string file_name = <span class="stringliteral">&quot;snes_iteration_&quot;</span> + std::to_string(it) + <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a308" name="a308"></a><a class="code hl_function" href="structEshelbianCore.html#af6c7c52dde40c4a5f90afda29a7dad8f">postProcessResults</a>(1, file_name, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      std::string file_skel_name =</div>
<div class="line">          <span class="stringliteral">&quot;snes_iteration_skel_&quot;</span> + std::to_string(it) + <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_material_force_tag = [&amp;]() {</div>
<div class="line">        <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">        Tag tag;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.tag_get_handle(<span class="stringliteral">&quot;MaterialForce&quot;</span>, tag),</div>
<div class="line">                       <span class="stringliteral">&quot;can&#39;t get tag&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> tag;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a309" name="a309"></a><a class="code hl_function" href="structEshelbianCore.html#a4d633c514ed211820d8cd66fd2e5b2ff">calculateFaceMaterialForce</a>(1, ts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a310" name="a310"></a><a class="code hl_function" href="structEshelbianCore.html#a1816ba2425a829869dce4bbc30225fd8">postProcessSkeletonResults</a>(1, file_skel_name, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,</div>
<div class="line">                                        {get_material_force_tag()});</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    ts_ctx_ptr-&gt;tsDebugHook = post_proc;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> storage = solve_elastic_setup::setup(<span class="keyword">this</span>, ts, x, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">    <a class="code hl_typedef" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> xx;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(x, &amp;xx);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(xx);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TS2SetSolution(ts, x, xx);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;xx);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, x);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(ts);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPreStep(ts, <a id="a311" name="a311"></a><a class="code hl_function" href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, <a id="a312" name="a312"></a><a class="code hl_function" href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a313" name="a313"></a><a class="code hl_function" href="structTSElasticPostStep.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a>(<span class="keyword">this</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a314" name="a314"></a><a class="code hl_function" href="structTSElasticPostStep.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a>();</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line"> </div>
<div class="line">  SNES snes;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">  <span class="keywordtype">int</span> lin_solver_iterations;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetLinearSolveIterations(snes, &amp;lin_solver_iterations);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Number of linear solver iterations &quot;</span> &lt;&lt; lin_solver_iterations;</div>
<div class="line"> </div>
<div class="line">  PetscBool test_cook_flg = PETSC_FALSE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-test_cook&quot;</span>, &amp;test_cook_flg,</div>
<div class="line">                             PETSC_NULL);</div>
<div class="line">  <span class="keywordflow">if</span> (test_cook_flg) {</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> expected_lin_solver_iterations = 11;</div>
<div class="line">    <span class="keywordflow">if</span> (lin_solver_iterations &gt; expected_lin_solver_iterations)</div>
<div class="line">      SETERRQ2(</div>
<div class="line">          PETSC_COMM_SELF, <a id="a315" name="a315"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Expected number of iterations is different than expected %d &gt; %d&quot;</span>,</div>
<div class="line">          lin_solver_iterations, expected_lin_solver_iterations);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  PetscBool test_sslv116_flag = PETSC_FALSE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-test_sslv116&quot;</span>,</div>
<div class="line">                             &amp;test_sslv116_flag, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (test_sslv116_flag) {</div>
<div class="line">    <span class="keywordtype">double</span> max_val = 0.0;</div>
<div class="line">    <span class="keywordtype">double</span> min_val = 0.0;</div>
<div class="line">    <span class="keyword">auto</span> field_min_max = [&amp;](boost::shared_ptr&lt;FieldEntity&gt; ent_ptr) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">      <span class="keyword">auto</span> ent_type = ent_ptr-&gt;getEntType();</div>
<div class="line">      <span class="keywordflow">if</span> (ent_type == MBVERTEX) {</div>
<div class="line">        max_val = std::max(ent_ptr-&gt;getEntFieldData()[<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1], max_val);</div>
<div class="line">        min_val = std::min(ent_ptr-&gt;getEntFieldData()[<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1], min_val);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a316" name="_a316"></a><a class="code hl_struct" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;fieldLambdaOnEntities(</div>
<div class="line">        field_min_max, <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> global_max_val = 0.0;</div>
<div class="line">    <span class="keywordtype">double</span> global_min_val = 0.0;</div>
<div class="line">    MPI_Allreduce(&amp;max_val, &amp;global_max_val, 1, MPI_DOUBLE, MPI_MAX,</div>
<div class="line">                  <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">    MPI_Allreduce(&amp;min_val, &amp;global_min_val, 1, MPI_DOUBLE, MPI_MIN,</div>
<div class="line">                  <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Max &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a> &lt;&lt; <span class="stringliteral">&quot; value: &quot;</span> &lt;&lt; global_max_val;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Min &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a> &lt;&lt; <span class="stringliteral">&quot; value: &quot;</span> &lt;&lt; global_min_val;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> ref_max_val = 0.00767;</div>
<div class="line">    <span class="keywordtype">double</span> ref_min_val = -0.00329;</div>
<div class="line">    <span class="keywordflow">if</span> (std::abs(global_max_val - ref_max_val) &gt; 1e-5) {</div>
<div class="line">      SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">               <span class="stringliteral">&quot;Incorrect max value of the displacement field: %f != %f&quot;</span>,</div>
<div class="line">               global_max_val, ref_max_val);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (std::abs(global_min_val - ref_min_val) &gt; 4e-5) {</div>
<div class="line">      SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">               <span class="stringliteral">&quot;Incorrect min value of the displacement field: %f != %f&quot;</span>,</div>
<div class="line">               global_min_val, ref_min_val);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a317" name="a317"></a><a class="code hl_function" href="structEshelbianCore.html#a7980928dbcfa5bf174ac19e22784fe95">gettingNorms</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a318" name="a318"></a><a class="code hl_function" href="structEshelbianCore.html#a832337ab1645d6112dda0d6c0573088b">EshelbianCore::solveDynamicRelaxation</a>(TS ts, Vec x) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> storage = solve_elastic_setup::setup(<span class="keyword">this</span>, ts, x, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> final_time = 1;</div>
<div class="line">  <span class="keywordtype">double</span> delta_time = 0.1;</div>
<div class="line">  <span class="keywordtype">int</span> max_it = 10;</div>
<div class="line">  PetscBool ts_h1_update = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Dynamic Relaxation Options&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-dynamic_final_time&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;dynamic relaxation final time&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, final_time,</div>
<div class="line">                            &amp;final_time, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-dynamic_delta_time&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;dynamic relaxation final time&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, delta_time,</div>
<div class="line">                            &amp;delta_time, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-dynamic_max_it&quot;</span>, <span class="stringliteral">&quot;dynamic relaxation iterations&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         max_it, &amp;max_it, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-dynamic_h1_update&quot;</span>, <span class="stringliteral">&quot;update each ts step&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          ts_h1_update, &amp;ts_h1_update, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  PetscOptionsEnd();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> setup_ts_monitor = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> monitor_ptr = boost::make_shared&lt;EshelbianMonitor&gt;(*<span class="keyword">this</span>);</div>
<div class="line">    <span class="keywordflow">return</span> monitor_ptr;</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">auto</span> monitor_ptr = setup_ts_monitor();</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(ts);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structTSElasticPostStep.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a>(<span class="keyword">this</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> ts_delta_time;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStep(ts, &amp;ts_delta_time);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ts_h1_update) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPreStep(ts, <a class="code hl_function" href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, <a class="code hl_function" href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>(ts);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>(ts);</div>
<div class="line"> </div>
<div class="line">  <a id="a319" name="a319"></a><a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> = 0;</div>
<div class="line">  <a id="a320" name="a320"></a><a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> = 0;</div>
<div class="line">  monitor_ptr-&gt;ts_u = PETSC_NULL;</div>
<div class="line">  monitor_ptr-&gt;ts_t = <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a>;</div>
<div class="line">  monitor_ptr-&gt;ts_step = <a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, monitor_ptr);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;IT &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> &lt;&lt; <span class="stringliteral">&quot; Time &quot;</span></div>
<div class="line">                               &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> &lt;&lt; <span class="stringliteral">&quot; delta time &quot;</span> &lt;&lt; delta_time;</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> += delta_time;</div>
<div class="line">  ++<a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (; <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> &lt; final_time; <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> += delta_time) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;IT &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> &lt;&lt; <span class="stringliteral">&quot; Time &quot;</span></div>
<div class="line">                                 &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> &lt;&lt; <span class="stringliteral">&quot; delta time &quot;</span> &lt;&lt; delta_time;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetStepNumber(ts, 0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetTime(ts, 0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetTimeStep(ts, ts_delta_time);</div>
<div class="line">    <span class="keywordflow">if</span> (!ts_h1_update) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>(ts);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, PETSC_NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (!ts_h1_update) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>(ts);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    monitor_ptr-&gt;ts_u = PETSC_NULL;</div>
<div class="line">    monitor_ptr-&gt;ts_t = <a class="code hl_variable" href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a>;</div>
<div class="line">    monitor_ptr-&gt;ts_step = <a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, monitor_ptr);</div>
<div class="line"> </div>
<div class="line">    ++<a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> &gt; max_it)</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structTSElasticPostStep.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a>();</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a321" name="a321"></a><a class="code hl_function" href="structEshelbianCore.html#a3e38767261f39bd323b727fd31959284">EshelbianCore::setBlockTagsOnSkin</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_block = [&amp;](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line">    <span class="keyword">auto</span> set_tag_impl = [&amp;](<span class="keyword">auto</span> name) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> mesh_mng = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> bcs = mesh_mng-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line"> </div>
<div class="line">          std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str())</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bcs) {</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), dim, r,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        map[bc-&gt;getMeshsetId()] = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag_impl(name);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(name, map);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_skin = [&amp;](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map.second) {</div>
<div class="line">      <span class="keyword">auto</span> s = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second));</div>
<div class="line">      <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.swap(s);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    Tag <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">    <span class="keyword">auto</span> name = map.first;</div>
<div class="line">    <span class="keywordtype">int</span> def_val[] = {-1};</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(name, 1, MB_TYPE_INTEGER, th,</div>
<div class="line">                                         MB_TAG_SPARSE | MB_TAG_CREAT, def_val),</div>
<div class="line">        <span class="stringliteral">&quot;create tag&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map.second) {</div>
<div class="line">      <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_clear_data(th, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, &amp;<span class="keywordtype">id</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;clear tag&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a id="a322" name="a322"></a><a class="code hl_variable" href="structEshelbianCore.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(set_tag(set_skin(set_block(<span class="stringliteral">&quot;BODY&quot;</span>, 3))));</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(set_tag(set_skin(set_block(<span class="stringliteral">&quot;MAT_ELASTIC&quot;</span>, 3))));</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(</div>
<div class="line">      set_tag(set_skin(set_block(<span class="stringliteral">&quot;MAT_NEOHOOKEAN&quot;</span>, 3))));</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(set_tag(set_block(<span class="stringliteral">&quot;CONTACT&quot;</span>, 2)));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a class="code hl_function" href="structEshelbianCore.html#af6c7c52dde40c4a5f90afda29a7dad8f">EshelbianCore::postProcessResults</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> std::string file,</div>
<div class="line">                                  Vec f_residual, Vec var_vector,</div>
<div class="line">                                  std::vector&lt;Tag&gt; tags_to_transfer) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// mark crack surface</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a41356565364f05177e0256f536e42603">crackingOn</a>) {</div>
<div class="line">    Tag <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">    rval = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;CRACK&quot;</span>, th);</div>
<div class="line">    <span class="keywordflow">if</span> (rval == MB_SUCCESS) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_delete(th);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> def_val[] = {0};</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(</div>
<div class="line">        <span class="stringliteral">&quot;CRACK&quot;</span>, 1, MB_TYPE_INTEGER, th, MB_TAG_SPARSE | MB_TAG_CREAT, def_val);</div>
<div class="line">    <span class="keywordtype">int</span> mark[] = {1};</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_clear_data(th, *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, mark);</div>
<div class="line">    tags_to_transfer.push_back(th);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_tag = [&amp;](<span class="keyword">auto</span> name, <span class="keyword">auto</span> dim) {</div>
<div class="line">      <span class="keyword">auto</span> &amp;mob = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">      Tag tag;</div>
<div class="line">      <span class="keywordtype">double</span> def_val[] = {0., 0., 0.};</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(mob.tag_get_handle(name, dim, MB_TYPE_DOUBLE, tag,</div>
<div class="line">                                        MB_TAG_CREAT | MB_TAG_SPARSE, def_val),</div>
<div class="line">                     <span class="stringliteral">&quot;create tag&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> tag;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    tags_to_transfer.push_back(get_tag(<span class="stringliteral">&quot;MaterialForce&quot;</span>, 3));</div>
<div class="line">    <span class="comment">// tags_to_transfer.push_back(get_tag(&quot;GriffithForce&quot;, 1));</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// add tags to transfer</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : <a class="code hl_variable" href="structEshelbianCore.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>) {</div>
<div class="line">    tags_to_transfer.push_back(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>) {</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a> =</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt;(<span class="keyword">new</span> <a class="code hl_struct" href="structDataAtIntegrationPts.html">DataAtIntegrationPts</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span>exclude_sdf {</div>
<div class="line">    exclude_sdf(<a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;r) : map(<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {}</div>
<div class="line">    <span class="keywordtype">bool</span> operator()(<a id="_a323" name="_a323"></a><a class="code hl_class" href="classFEMethod.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">      <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">      <span class="keywordflow">if</span> (map.find(ent) != map.end()) {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>-&gt;exeTestHook =</div>
<div class="line">      exclude_sdf(<a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_post_proc = [&amp;](<span class="keyword">auto</span> &amp;post_proc_mesh, <span class="keyword">auto</span> sense) {</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceEle</a> = <a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">    <span class="keyword">auto</span> post_proc_ptr =</div>
<div class="line">        boost::make_shared&lt;PostProcBrokenMeshInMoabBaseCont&lt;FaceEle&gt;&gt;(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, post_proc_mesh);</div>
<div class="line">    EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">        post_proc_ptr-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> domain_ops = [&amp;](<span class="keyword">auto</span> &amp;fe, <span class="keywordtype">int</span> sense) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      fe.getUserPolynomialBase() =</div>
<div class="line">          boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line">      EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">          fe.getOpPtrVector(), {HDIV, H1, L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      <span class="keyword">auto</span> piola_scale_ptr = boost::make_shared&lt;double&gt;(1.0);</div>
<div class="line">      fe.getOpPtrVector().push_back(<a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSetScale(</div>
<div class="line">          piola_scale_ptr, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), piola_scale_ptr));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), piola_scale_ptr,</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(), MBMAXTYPE));</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">        fe.getOpPtrVector().push_back(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchTensorAtPts(), MBTET));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(var_vector, <span class="keyword">true</span>);</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec));</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec, MBMAXTYPE));</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarRotAxisPts(), vec, MBTET));</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateVarStretchFromStress(</div>
<div class="line">                  <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                  <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarLogStreachPts(), vec, MBTET));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisAtPts(), MBTET));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxis0AtPts(), <a class="code hl_variable" href="structEshelbianCore.html#aec7eec34db87d222944bbaf74cf7c0f3">solTSStep</a>, MBTET));</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2AtPts(), MBTET));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWH1AtPts()));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWGradH1AtPts()));</div>
<div class="line">      <span class="comment">// evaluate derived quantities</span></div>
<div class="line">      fe.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structOpCalculateRotationAndSpatialGradient.html">OpCalculateRotationAndSpatialGradient</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// evaluate integration points</span></div>
<div class="line">      fe.getOpPtrVector().push_back(<a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpJacobian(</div>
<div class="line">          tag, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      <span class="keywordflow">if</span> (<span class="keyword">auto</span> op =</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateEnergy(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">nullptr</span>)) {</div>
<div class="line">        fe.getOpPtrVector().push_back(op);</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a324" name="_a324"></a><a class="code hl_struct" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// // post-proc</span></div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a id="_a325" name="_a325"></a><a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab</a>&lt;</div>
<div class="line">          <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">          <a id="_a326" name="_a326"></a><a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCoreOnSide_1_1UserDataOperator.html">VolumeElementForcesAndSourcesCoreOnSide::UserDataOperator</a>&gt;;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">struct </span>OpSidePPMap : <span class="keyword">public</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> {</div>
<div class="line">        OpSidePPMap(moab::Interface &amp;post_proc_mesh,</div>
<div class="line">                    std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts,</div>
<div class="line">                    DataMapVec data_map_scalar, DataMapMat data_map_vec,</div>
<div class="line">                    DataMapMat data_map_mat, DataMapMat data_symm_map_mat,</div>
<div class="line">                    <span class="keywordtype">int</span> sense)</div>
<div class="line">            : <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(post_proc_mesh, map_gauss_pts, data_map_scalar,</div>
<div class="line">                      data_map_vec, data_map_mat, data_symm_map_mat),</div>
<div class="line">              tagSense(sense) {}</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line">                              <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (tagSense != OpPPMap::getSkeletonSense())</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> OpPPMap::doWork(side, type, data);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">private</span>:</div>
<div class="line">        <span class="keywordtype">int</span> tagSense;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      OpPPMap::DataMapMat vec_fields;</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;SpatialDisplacementL2&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2AtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;SpatialDisplacementH1&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWH1AtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;Omega&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisAtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;ContactDisplacement&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getContactL2AtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;AngularMomentum&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLeviKirchhoffAtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;X&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLargeXH1AtPts();</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(var_vector, <span class="keyword">true</span>);</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;VarOmega&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarRotAxisPts();</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;VarSpatialDisplacementL2&quot;</span>] =</div>
<div class="line">            boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, vec_fields[<span class="stringliteral">&quot;VarSpatialDisplacementL2&quot;</span>], vec, MBTET));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>);</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;ResSpatialDisplacementL2&quot;</span>] =</div>
<div class="line">            boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, vec_fields[<span class="stringliteral">&quot;ResSpatialDisplacementL2&quot;</span>], vec, MBTET));</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;ResOmega&quot;</span>] = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, vec_fields[<span class="stringliteral">&quot;ResOmega&quot;</span>], vec, MBTET));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      OpPPMap::DataMapMat mat_fields;</div>
<div class="line">      mat_fields[<span class="stringliteral">&quot;PiolaStress&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts();</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        mat_fields[<span class="stringliteral">&quot;VarPiolaStress&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>);</div>
<div class="line">        mat_fields[<span class="stringliteral">&quot;ResPiolaStress&quot;</span>] = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, mat_fields[<span class="stringliteral">&quot;ResPiolaStress&quot;</span>],</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec));</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, mat_fields[<span class="stringliteral">&quot;ResPiolaStress&quot;</span>],</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec, MBMAXTYPE));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>.empty()) {</div>
<div class="line">        mat_fields[<a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getInternalStressAtPts();</div>
<div class="line">        <span class="keywordflow">switch</span> (<a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>) {</div>
<div class="line">        <span class="keywordflow">case</span> 0:</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="structOpGetInternalStress.html">OpGetInternalStress&lt;0&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>));</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">case</span> 1:</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="structOpGetInternalStress.html">OpGetInternalStress&lt;1&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">internalStressTagName</a>));</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        <span class="keywordflow">default</span>:</div>
<div class="line">          SETERRQ1(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;Unsupported internal stress interpolation order %d&quot;</span>,</div>
<div class="line">                   <a class="code hl_variable" href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">internalStressInterpOrder</a>);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      OpPPMap::DataMapMat mat_fields_symm;</div>
<div class="line">      mat_fields_symm[<span class="stringliteral">&quot;LogSpatialStretch&quot;</span>] =</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchTensorAtPts();</div>
<div class="line">      mat_fields_symm[<span class="stringliteral">&quot;SpatialStretch&quot;</span>] = <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getStretchTensorAtPts();</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        mat_fields_symm[<span class="stringliteral">&quot;VarLogSpatialStretch&quot;</span>] =</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarLogStreachPts();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">          mat_fields_symm[<span class="stringliteral">&quot;ResLogSpatialStretch&quot;</span>] =</div>
<div class="line">              boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                  <a class="code hl_variable" href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, mat_fields_symm[<span class="stringliteral">&quot;ResLogSpatialStretch&quot;</span>], vec,</div>
<div class="line">                  MBTET));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">new</span> OpSidePPMap(</div>
<div class="line"> </div>
<div class="line">              post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              vec_fields,</div>
<div class="line"> </div>
<div class="line">              mat_fields,</div>
<div class="line"> </div>
<div class="line">              mat_fields_symm,</div>
<div class="line"> </div>
<div class="line">              sense</div>
<div class="line"> </div>
<div class="line">              )</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a327" name="_a327"></a><a class="code hl_struct" href="structOpPostProcDataStructure.html">OpPostProcDataStructure</a>(</div>
<div class="line">          post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, sense));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>,</div>
<div class="line">                                            <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getContactL2AtPts()));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> X_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// H1 material positions</span></div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">                                            <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLargeXH1AtPts()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// domain</span></div>
<div class="line">    <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;VolumeElementForcesAndSourcesCoreOnSide&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">    domain_ops(*(op_loop_side-&gt;getSideFEPtr()), sense);</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(op_loop_side);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> post_proc_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// contact</span></div>
<div class="line">  <span class="keyword">auto</span> calcs_side_traction_and_displacements = [&amp;](<span class="keyword">auto</span> &amp;post_proc_ptr,</div>
<div class="line">                                                   <span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> contact_common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line">    <span class="comment">// evaluate traction</span></div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">        <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_class" href="classSideEleOp.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">    op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">        boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line">    EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">    op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line">    pip.push_back(op_loop_domain_side);</div>
<div class="line">    <span class="comment">// evaluate contact displacement and contact conditions</span></div>
<div class="line">    <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">        <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1),</div>
<div class="line">        &amp;post_proc_ptr-&gt;getPostProcMesh(), &amp;post_proc_ptr-&gt;getMapGaussPts()));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">auto</span> op_this = <span class="keyword">new</span> <a id="_a328" name="_a328"></a><a class="code hl_struct" href="structMoFEM_1_1OpLoopThis.html">OpLoopThis&lt;BoundaryEle&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">      pip.push_back(op_this);</div>
<div class="line">      <span class="keyword">auto</span> contact_residual = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_this-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_residual,</div>
<div class="line">              <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>)));</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line">      op_this-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">new</span> <a id="a329" name="a329"></a><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">              post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              {{<span class="stringliteral">&quot;res_contact&quot;</span>, contact_residual}},</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              {}</div>
<div class="line"> </div>
<div class="line">              )</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_mesh = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">  <span class="keyword">auto</span> post_proc_ptr = get_post_proc(post_proc_mesh, 1);</div>
<div class="line">  <span class="keyword">auto</span> post_proc_negative_sense_ptr = get_post_proc(post_proc_mesh, -1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calcs_side_traction_and_displacements(post_proc_ptr,</div>
<div class="line">                                               post_proc_ptr-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> own_tets =</div>
<div class="line">      CommInterface::getPartEntities(mField.get_moab(), mField.get_comm_rank())</div>
<div class="line">          .subset_by_dimension(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> own_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(own_tets, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                           own_faces, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_post_negative = [&amp;](<span class="keyword">auto</span> &amp;&amp;ents) {</div>
<div class="line">    <span class="keyword">auto</span> crack_faces_pos = ents;</div>
<div class="line">    <span class="keyword">auto</span> crack_faces_neg = crack_faces_pos;</div>
<div class="line">    <span class="keyword">auto</span> skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(mField, own_tets);</div>
<div class="line">    <span class="keyword">auto</span> crack_on_proc_skin = intersect(crack_faces_pos, skin);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : crack_on_proc_skin) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> tet;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(&amp;f, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">false</span>, tet);</div>
<div class="line">      tet = intersect(tet, own_tets);</div>
<div class="line">      <span class="keywordtype">int</span> side_number, sense, offset;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().side_number(tet[0], f, side_number, sense,</div>
<div class="line">                                           offset);</div>
<div class="line">      <span class="keywordflow">if</span> (sense == 1) {</div>
<div class="line">        crack_faces_neg.erase(f);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        crack_faces_pos.erase(f);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(crack_faces_pos, crack_faces_neg);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_crack_faces = [&amp;](<span class="keyword">auto</span> crack_faces) {</div>
<div class="line">    <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> dim) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(e, dim, <span class="keyword">true</span>, adj,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      <span class="keywordflow">return</span> adj;</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> tets = get_adj(crack_faces, 3);</div>
<div class="line">    <span class="keyword">auto</span> faces = subtract(get_adj(tets, 2), crack_faces);</div>
<div class="line">    tets = subtract(tets, get_adj(faces, 3));</div>
<div class="line">    <span class="keywordflow">return</span> subtract(crack_faces, get_adj(tets, 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> [crack_faces_pos, crack_faces_neg] =</div>
<div class="line">      get_post_negative(intersect(own_faces, get_crack_faces(*crackFaces)));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> only_crack_faces = [&amp;](<a class="code hl_class" href="classFEMethod.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">    <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keywordflow">if</span> (crack_faces_pos.find(ent) == crack_faces_pos.end()) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> only_negative_crack_faces = [&amp;](<a class="code hl_class" href="classFEMethod.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">    <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keywordflow">if</span> (crack_faces_neg.find(ent) == crack_faces_neg.end()) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> skeleton_faces = *skeletonFaces;</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> adj_front;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(*frontEdges, 2, <span class="keyword">true</span>, adj_front,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">    adj_front = intersect(adj_front, skeleton_faces);</div>
<div class="line">    adj_front = subtract(adj_front, *crackFaces);</div>
<div class="line">    adj_front = intersect(own_faces, adj_front);</div>
<div class="line">    <span class="keywordflow">return</span> adj_front;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  post_proc_ptr-&gt;setTagsToTransfer(tags_to_transfer);</div>
<div class="line">  post_proc_negative_sense_ptr-&gt;setTagsToTransfer(tags_to_transfer);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_begin =</div>
<div class="line">      <a id="_a330" name="_a330"></a><a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoabBaseBeginImpl.html">PostProcBrokenMeshInMoabBaseBegin</a>(mField, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dM, post_proc_begin.getFEMethod());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, skinElement, post_proc_ptr);</div>
<div class="line">  post_proc_ptr-&gt;exeTestHook = only_crack_faces;</div>
<div class="line">  post_proc_negative_sense_ptr-&gt;exeTestHook = only_negative_crack_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(</div>
<div class="line">      dM, skeletonElement, post_proc_ptr, 0, mField.get_comm_size());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(dM, skeletonElement,</div>
<div class="line">                                              post_proc_negative_sense_ptr, 0,</div>
<div class="line">                                              mField.get_comm_size());</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> [adj_front_pos, adj_front_neg] =</div>
<div class="line">        get_post_negative(<a class="code hl_function" href="EshelbianPlasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(mField, get_adj_front()));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> only_front_faces_pos = [adj_front_pos](<a class="code hl_class" href="classFEMethod.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">      <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">      <span class="keywordflow">if</span> (adj_front_pos.find(ent) == adj_front_pos.end()) {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> only_front_faces_neg = [adj_front_neg](<a class="code hl_class" href="classFEMethod.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">      <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">      <span class="keywordflow">if</span> (adj_front_neg.find(ent) == adj_front_neg.end()) {</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    post_proc_ptr-&gt;exeTestHook = only_front_faces_pos;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(</div>
<div class="line">        dM, skeletonElement, post_proc_ptr, 0, mField.get_comm_size());</div>
<div class="line">    post_proc_negative_sense_ptr-&gt;exeTestHook = only_front_faces_neg;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(dM, skeletonElement,</div>
<div class="line">                                                post_proc_negative_sense_ptr, 0,</div>
<div class="line">                                                mField.get_comm_size());</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">auto</span> post_proc_end = <a id="_a331" name="_a331"></a><a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoabBaseEndImpl.html">PostProcBrokenMeshInMoabBaseEnd</a>(mField, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(dM, post_proc_end.getFEMethod());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_end.writeFile(file.c_str());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a class="code hl_function" href="structEshelbianCore.html#a1816ba2425a829869dce4bbc30225fd8">EshelbianCore::postProcessSkeletonResults</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> std::string file,</div>
<div class="line">                                          Vec f_residual,</div>
<div class="line">                                          std::vector&lt;Tag&gt; tags_to_transfer) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceEle</a> = <a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_mesh = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">  <span class="keyword">auto</span> post_proc_ptr =</div>
<div class="line">      boost::make_shared&lt;PostProcBrokenMeshInMoabBaseCont&lt;FaceEle&gt;&gt;(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, post_proc_mesh);</div>
<div class="line">  EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">      post_proc_ptr-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> hybrid_disp = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, hybrid_disp));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> hybrid_res = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, hybrid_disp));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">          post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;hybrid_disp&quot;</span>, hybrid_disp}},</div>
<div class="line"> </div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {}</div>
<div class="line"> </div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">    <span class="keyword">auto</span> hybrid_res = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            hybridSpatialDisp, hybrid_res,</div>
<div class="line">            <a class="code hl_struct" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>)));</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">            post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;res_hybrid&quot;</span>, hybrid_res}},</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {}</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  post_proc_ptr-&gt;setTagsToTransfer(tags_to_transfer);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_begin =</div>
<div class="line">      <a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoabBaseBeginImpl.html">PostProcBrokenMeshInMoabBaseBegin</a>(mField, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dM, post_proc_begin.getFEMethod());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, skeletonElement, post_proc_ptr);</div>
<div class="line">  <span class="keyword">auto</span> post_proc_end = <a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoabBaseEndImpl.html">PostProcBrokenMeshInMoabBaseEnd</a>(mField, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(dM, post_proc_end.getFEMethod());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_end.writeFile(file.c_str());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structEshelbianCore.html#a4d633c514ed211820d8cd66fd2e5b2ff">EshelbianCore::calculateFaceMaterialForce</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag, TS ts) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tags_vec = [&amp;](std::vector&lt;std::pair&lt;std::string, int&gt;&gt; names) {</div>
<div class="line">    std::vector&lt;Tag&gt; tags;</div>
<div class="line">    tags.reserve(names.size());</div>
<div class="line">    <span class="keyword">auto</span> create_and_clean = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a id="a332" name="a332"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> : names) {</div>
<div class="line">        tags.push_back(Tag());</div>
<div class="line">        <span class="keyword">auto</span> &amp;tag = tags.back();</div>
<div class="line">        <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">        <span class="keyword">auto</span> rval = moab.tag_get_handle(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>.first.c_str(), tag);</div>
<div class="line">        <span class="keywordflow">if</span> (rval == MB_SUCCESS) {</div>
<div class="line">          moab.tag_delete(tag);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordtype">double</span> def_val[] = {0., 0., 0.};</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>.first.c_str(), <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>.second, MB_TYPE_DOUBLE,</div>
<div class="line">                                   tag, MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(create_and_clean(), <span class="stringliteral">&quot;create_and_clean&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> tags;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> ExhangeTags { MATERIALFORCE, AREAGROWTH, GRIFFITHFORCE, FACEPRESSURE };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> tags = get_tags_vec({{<span class="stringliteral">&quot;MaterialForce&quot;</span>, 3},</div>
<div class="line">                            {<span class="stringliteral">&quot;AreaGrowth&quot;</span>, 3},</div>
<div class="line">                            {<span class="stringliteral">&quot;GriffithForce&quot;</span>, 1},</div>
<div class="line">                            {<span class="stringliteral">&quot;FacePressure&quot;</span>, 1}});</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calculate_material_forces = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * @brief Create element to integration faces energies</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keyword">auto</span> get_face_material_force_fe = [&amp;]() {</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceEle</a> = <a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">      <span class="keyword">auto</span> fe_ptr = boost::make_shared&lt;FaceEle&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">      fe_ptr-&gt;getRuleHook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">      fe_ptr-&gt;setRuleHook =</div>
<div class="line">          SetIntegrationAtFrontFace(<a class="code hl_variable" href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      EshelbianPlasticity::AddHOOps&lt;2, 2, 3&gt;::add(</div>
<div class="line">          fe_ptr-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getGradHybridDispAtPts()));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side =</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;VolumeElementForcesAndSourcesCoreOnSide&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                               <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts()));</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), MBMAXTYPE));</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">                <a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      } </div>
<div class="line"> </div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a333" name="_a333"></a><a class="code hl_struct" href="structOpFaceSideMaterialForce.html">OpFaceSideMaterialForce</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a334" name="_a334"></a><a class="code hl_struct" href="structOpFaceMaterialForce.html">OpFaceMaterialForce</a>(<a class="code hl_variable" href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> integrate_face_material_force_fe = [&amp;](<span class="keyword">auto</span> &amp;&amp;face_energy_fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, face_energy_fe, 0, <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a335" name="a335"></a><a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> face_exchange = CommInterface::createEntitiesPetscVector(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 2, 3, Sev::inform);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> print_loc_size = [<span class="keyword">this</span>](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">auto</span> str, <span class="keyword">auto</span> sev) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordtype">int</span> size;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetLocalSize(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second, &amp;size);</div>
<div class="line">        <span class="keywordtype">int</span> low, high;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetOwnershipRange(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second, &amp;low, &amp;high);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSYNC&quot;</span>, sev) &lt;&lt; str &lt;&lt; <span class="stringliteral">&quot; local size &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span></div>
<div class="line">                                 &lt;&lt; low &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; high &lt;&lt; <span class="stringliteral">&quot; ) &quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="LogManager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), sev);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(face_exchange, <span class="stringliteral">&quot;material face_exchange&quot;</span>,</div>
<div class="line">                            Sev::verbose);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), face_exchange, tags[ExhangeTags::MATERIALFORCE]);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a id="a336" name="a336"></a><a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a>, tags[ExhangeTags::FACEPRESSURE]);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                          <span class="stringliteral">&quot;front_skin_faces_material_force_&quot;</span> +</div>
<div class="line">                              std::to_string(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                          *<a class="code hl_variable" href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>);</div>
<div class="line">      }</div>
<div class="line">      <span class="comment">// #endif</span></div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> integrate_face_material_force_fe(get_face_material_force_fe());</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calculate_front_material_force = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a id="a337" name="a337"></a><a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a338" name="a338"></a><a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_conn = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(&amp;e, 1, conn, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> conn;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_conn_range = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> conn;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> dim) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;e, 1, dim, <span class="keyword">true</span>, adj),</div>
<div class="line">                     <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> adj;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_adj_range = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> dim) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(e, dim, <span class="keyword">true</span>, adj,</div>
<div class="line">                                                       moab::Interface::UNION),</div>
<div class="line">                     <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> adj;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_material_force = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">auto</span> <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line">      <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> material_forces(<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size(), 3, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th, r, material_forces.data().data()),</div>
<div class="line">          <span class="stringliteral">&quot;get data&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> material_forces;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> crack_edges = get_adj_range(*<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, 1);</div>
<div class="line">      <span class="keyword">auto</span> front_nodes = get_conn_range(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">      <span class="keyword">auto</span> body_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;EDGES&quot;</span>, 1);</div>
<div class="line">      <span class="comment">// auto front_block_edges = get_range_from_block(mField, &quot;FRONT&quot;, 1);</span></div>
<div class="line">      <span class="comment">// front_block_edges = subtract(front_block_edges, crack_edges);</span></div>
<div class="line">      <span class="comment">// auto front_block_edges_conn = get_conn_range(front_block_edges);</span></div>
<div class="line"> </div>
<div class="line">      <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> all_skin_faces;</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> all_front_faces;</div>
<div class="line">      <span class="comment">// #endif</span></div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> calculate_edge_direction = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">        <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, num_nodes, <span class="keyword">true</span>),</div>
<div class="line">            <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">        std::array&lt;double, 6&gt; coords;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(conn, num_nodes, coords.data()),</div>
<div class="line">            <span class="stringliteral">&quot;get coords&quot;</span>);</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; t_p0{</div>
<div class="line">            &amp;coords[0], &amp;coords[1], &amp;coords[2]};</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; t_p1{</div>
<div class="line">            &amp;coords[3], &amp;coords[4], &amp;coords[5]};</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_dir;</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        t_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_p1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_p0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        <span class="keywordflow">return</span> t_dir;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// take bubble tets at node, and then avarage over the edges</span></div>
<div class="line">      <span class="keyword">auto</span> calculate_force_through_node = [&amp;]() {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a339" name="a339"></a><a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, K);</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, L);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                           body_ents);</div>
<div class="line">        <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line">        <span class="keyword">auto</span> body_skin_conn = get_conn_range(body_skin);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// calculate nodal material force</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> : front_nodes) {</div>
<div class="line">          <span class="keyword">auto</span> adj_tets = get_adj(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 3);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt; <a class="code hl_variable" href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">nbJIntegralLevels</a>; ++ll) {</div>
<div class="line">            <span class="keyword">auto</span> conn = get_conn_range(adj_tets);</div>
<div class="line">            adj_tets = get_adj_range(conn, 3);</div>
<div class="line">          }</div>
<div class="line">          <span class="keyword">auto</span> skin_faces = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, adj_tets);</div>
<div class="line">          <span class="keyword">auto</span> material_forces = get_material_force(skin_faces, tags[0]);</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">            all_skin_faces.merge(skin_faces);</div>
<div class="line">          }</div>
<div class="line">          <span class="comment">// #endif</span></div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> calculate_node_material_force = [&amp;]() {</div>
<div class="line">            <span class="keyword">auto</span> t_face_T =</div>
<div class="line">                getFTensor1FromPtr&lt;SPACE_DIM&gt;(material_forces.data().data());</div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_node_force{0., 0., 0.};</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> face : skin_faces) {</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_face_force_tmp{0., 0., 0.};</div>
<div class="line">              t_face_force_tmp(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = t_face_T(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">              ++t_face_T;</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> face_tets = intersect(get_adj(face, 3), adj_tets);</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (face_tets.empty()) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (face_tets.size() != 1) {</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                  <span class="stringliteral">&quot;face_tets.size() != 1&quot;</span>);</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">              <span class="keywordtype">int</span> side_number, sense, offset;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(face_tets[0], face,</div>
<div class="line">                                                           side_number, sense,</div>
<div class="line">                                                           offset),</div>
<div class="line">                             <span class="stringliteral">&quot;moab side number&quot;</span>);</div>
<div class="line">              t_face_force_tmp(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) *= sense;</div>
<div class="line">              t_node_force(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) += t_face_force_tmp(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> t_node_force;</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> calculate_crack_area_growth_direction = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>,</div>
<div class="line">                                                           <span class="keyword">auto</span> &amp;t_node_force) {</div>
<div class="line">            <span class="comment">// if skin is on body surface, project the direction on it</span></div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_project{0., 0., 0.};</div>
<div class="line">            <span class="keyword">auto</span> boundary_node = intersect(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>), body_skin_conn);</div>
<div class="line">            <span class="keywordflow">if</span> (boundary_node.size()) {</div>
<div class="line">              <span class="keyword">auto</span> faces = intersect(get_adj(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 2), body_skin);</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> : faces) {</div>
<div class="line">                <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_normal_face;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a340" name="_a340"></a><a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;getTriNormal(</div>
<div class="line">                    <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, &amp;t_normal_face(0));</div>
<div class="line">                t_project(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) += t_normal_face(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">              }</div>
<div class="line">              t_project.normalize();</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> adj_faces = intersect(get_adj(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 2), *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (adj_faces.empty()) {</div>
<div class="line">              <span class="keyword">auto</span> adj_edges =</div>
<div class="line">                  intersect(get_adj(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 1), unite(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, body_edges));</div>
<div class="line">              <span class="keywordtype">double</span> <a id="a341" name="a341"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : adj_edges) {</div>
<div class="line">                <span class="keyword">auto</span> t_dir = calculate_edge_direction(e);</div>
<div class="line">                <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> += t_dir.l2();</div>
<div class="line">              }</div>
<div class="line">              <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> /= 2;</div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_area_dir{0., 0., 0.};</div>
<div class="line">              t_area_dir(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = -t_node_force(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) / t_node_force.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>();</div>
<div class="line">              t_area_dir(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) *= <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> / 2;</div>
<div class="line">              <span class="keywordflow">return</span> t_area_dir;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// calculate surface projection matrix</span></div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_Q;</div>
<div class="line">            <span class="keyword">auto</span> <a id="a342" name="a342"></a><a class="code hl_variable" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a id="_a343" name="_a343"></a><a class="code hl_class" href="classFTensor_1_1Kronecker__Delta.html">FTensor::Kronecker_Delta&lt;double&gt;</a>();</div>
<div class="line">            t_Q(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = <a class="code hl_variable" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (boundary_node.size()) {</div>
<div class="line">              t_Q(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) -= t_project(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_project(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// calculate direction</span></div>
<div class="line">            <span class="keyword">auto</span> front_edges = get_adj(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 1);</div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_area_dir{0., 0., 0.};</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> : adj_faces) {</div>
<div class="line">              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">              <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, conn, num_nodes,</div>
<div class="line">                                                        <span class="keyword">true</span>);</div>
<div class="line">              std::array&lt;double, 9&gt; coords;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(conn, num_nodes,</div>
<div class="line">                                                  coords.data());</div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_face_normal;</div>
<div class="line">              <a id="_a344" name="_a344"></a><a class="code hl_class" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_d_normal;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;getTriNormal(</div>
<div class="line">                  coords.data(), &amp;t_face_normal(0), &amp;t_d_normal(0, 0, 0));</div>
<div class="line">              <span class="keyword">auto</span> n_it = std::find(conn, conn + num_nodes, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line">              <span class="keyword">auto</span> n_index = std::distance(conn, n_it);</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_face_hessian{</div>
<div class="line">                  t_d_normal(0, n_index, 0), t_d_normal(0, n_index, 1),</div>
<div class="line">                  t_d_normal(0, n_index, 2),</div>
<div class="line"> </div>
<div class="line">                  t_d_normal(1, n_index, 0), t_d_normal(1, n_index, 1),</div>
<div class="line">                  t_d_normal(1, n_index, 2),</div>
<div class="line"> </div>
<div class="line">                  t_d_normal(2, n_index, 0), t_d_normal(2, n_index, 1),</div>
<div class="line">                  t_d_normal(2, n_index, 2)};</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_projected_hessian;</div>
<div class="line">              t_projected_hessian(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) =</div>
<div class="line">                  t_Q(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, K) * (t_face_hessian(K, L) * t_Q(L, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>));</div>
<div class="line">              t_face_normal.<a id="a345" name="a345"></a><a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">              t_area_dir(K) +=</div>
<div class="line">                  t_face_normal(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_projected_hessian(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, K) / 2.;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> t_area_dir;</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> t_node_force = calculate_node_material_force();</div>
<div class="line">          t_node_force(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) /= <a class="code hl_variable" href="structEshelbianCore.html#a4e1702cd98e773ce63013875ceea4d77">griffithEnergy</a>; <span class="comment">// scale all by griffith energy</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(tags[ExhangeTags::MATERIALFORCE],</div>
<div class="line">                                             &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 1, &amp;t_node_force(0)),</div>
<div class="line">              <span class="stringliteral">&quot;set data&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> get_area_dir = [&amp;]() {</div>
<div class="line">            <span class="keyword">auto</span> t_area_dir =</div>
<div class="line">                calculate_crack_area_growth_direction(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, t_node_force);</div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">nbJIntegralLevels</a>) {</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> seed_n = <a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> adj_edges;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> &lt; <a class="code hl_variable" href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">nbJIntegralLevels</a>; ++<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) {</div>
<div class="line">                adj_edges.merge(intersect(get_adj_range(seed_n, 1),</div>
<div class="line">                                          unite(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, body_edges)));</div>
<div class="line">                seed_n = get_conn_range(adj_edges);</div>
<div class="line">              }</div>
<div class="line">              <span class="keyword">auto</span> skin_adj_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, adj_edges);</div>
<div class="line">              skin_adj_edges.merge(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>));</div>
<div class="line">              seed_n = subtract(seed_n, skin_adj_edges);</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keyword">auto</span> sn : seed_n) {</div>
<div class="line">                <span class="keyword">auto</span> t_area_dir_sn =</div>
<div class="line">                    calculate_crack_area_growth_direction(sn, t_node_force);</div>
<div class="line">                t_area_dir(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) += t_area_dir_sn(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">return</span> t_area_dir;</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> t_area_dir = get_area_dir();</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(tags[ExhangeTags::AREAGROWTH], &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>,</div>
<div class="line">                                             1, &amp;t_area_dir(0)),</div>
<div class="line">              <span class="stringliteral">&quot;set data&quot;</span>);</div>
<div class="line">          <span class="keyword">auto</span> griffith = -t_node_force(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_area_dir(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) /</div>
<div class="line">                          (t_area_dir(K) * t_area_dir(K));</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(tags[ExhangeTags::GRIFFITHFORCE],</div>
<div class="line">                                             &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, 1, &amp;griffith),</div>
<div class="line">              <span class="stringliteral">&quot;set data&quot;</span>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> ave_node_force = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : *<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>) {</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> conn = get_conn(e);</div>
<div class="line">            <span class="keyword">auto</span> data = get_material_force(conn, th);</div>
<div class="line">            <span class="keyword">auto</span> t_node = getFTensor1FromPtr&lt;SPACE_DIM&gt;(data.data().data());</div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_edge{0., 0., 0.};</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> : conn) {</div>
<div class="line">              t_edge(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) += t_node(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">              ++t_node;</div>
<div class="line">            }</div>
<div class="line">            t_edge(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) /= conn.size();</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_edge_direction =</div>
<div class="line">                calculate_edge_direction(e);</div>
<div class="line">            t_edge_direction.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">            <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">            <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, K);</div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_cross;</div>
<div class="line">            t_cross(K) =</div>
<div class="line">                <a id="a346" name="a346"></a><a class="code hl_function" href="namespaceFTensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a>(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, K) * t_edge_direction(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_edge(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">            t_edge(K) = <a class="code hl_function" href="namespaceFTensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a>(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, K) * t_edge_direction(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) *</div>
<div class="line">                        t_cross(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th, &amp;e, 1, &amp;t_edge(0));</div>
<div class="line">          }</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> ave_node_griffith_energy = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : *<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>) {</div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_edge_force;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(</div>
<div class="line">                tags[ExhangeTags::MATERIALFORCE], &amp;e, 1, &amp;t_edge_force(0));</div>
<div class="line">            <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_edge_area_dir;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(tags[ExhangeTags::AREAGROWTH],</div>
<div class="line">                                                  &amp;e, 1, &amp;t_edge_area_dir(0));</div>
<div class="line">            <span class="keywordtype">double</span> griffith_energy = -t_edge_force(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_edge_area_dir(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) /</div>
<div class="line">                                     (t_edge_area_dir(K) * t_edge_area_dir(K));</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th, &amp;e, 1, &amp;griffith_energy);</div>
<div class="line">          }</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ave_node_force(tags[ExhangeTags::MATERIALFORCE]);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ave_node_force(tags[ExhangeTags::AREAGROWTH]);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ave_node_griffith_energy(tags[ExhangeTags::GRIFFITHFORCE]);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calculate_force_through_node();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// calculate face cross</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : *<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>) {</div>
<div class="line">        <span class="keyword">auto</span> adj_faces = get_adj(e, 2);</div>
<div class="line">        <span class="keyword">auto</span> crack_face = intersect(get_adj(e, 2), *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">          all_front_faces.merge(adj_faces);</div>
<div class="line">        }</div>
<div class="line">        <span class="comment">// #endif</span></div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_edge_force;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(tags[ExhangeTags::MATERIALFORCE],</div>
<div class="line">                                              &amp;e, 1, &amp;t_edge_force(0));</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_edge_direction =</div>
<div class="line">            calculate_edge_direction(e);</div>
<div class="line">        t_edge_direction.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, K);</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_cross;</div>
<div class="line">        t_cross(K) = <a class="code hl_function" href="namespaceFTensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a>(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, K) * t_edge_direction(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) *</div>
<div class="line">                     t_edge_force(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> : adj_faces) {</div>
<div class="line">          <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_normal;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;getTriNormal(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, &amp;t_normal(0));</div>
<div class="line">          t_normal.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">          <span class="keywordtype">int</span> side_number, sense, offset;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, e, side_number, sense,</div>
<div class="line">                                               offset);</div>
<div class="line">          <span class="keyword">auto</span> dot = -sense * t_cross(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_normal(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(</div>
<div class="line">                             tags[ExhangeTags::GRIFFITHFORCE], &amp;<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, 1, &amp;dot),</div>
<div class="line">                         <span class="stringliteral">&quot;set data&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        <span class="keywordtype">int</span> ts_step;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepNumber(ts, &amp;ts_step);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                          <span class="stringliteral">&quot;front_edges_material_force_&quot;</span> +</div>
<div class="line">                              std::to_string(ts_step) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                          *<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                          <span class="stringliteral">&quot;front_skin_faces_material_force_&quot;</span> +</div>
<div class="line">                              std::to_string(ts_step) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                          all_skin_faces);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                          <span class="stringliteral">&quot;front_faces_material_force_&quot;</span> +</div>
<div class="line">                              std::to_string(ts_step) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                          all_front_faces);</div>
<div class="line">      }</div>
<div class="line">      <span class="comment">// #endif</span></div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> edge_exchange = CommInterface::createEntitiesPetscVector(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 1, 3, Sev::inform);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), edge_exchange, tags[ExhangeTags::MATERIALFORCE]);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), edge_exchange, tags[ExhangeTags::AREAGROWTH]);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a id="a347" name="a347"></a><a class="code hl_variable" href="structEshelbianCore.html#ab1bb40274b0b343f49fc45bc2d3de293">edgeExchange</a>, tags[ExhangeTags::GRIFFITHFORCE]);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> print_results = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_conn_range = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> conn;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_tag_data = [&amp;](<span class="keyword">auto</span> &amp;ents, <span class="keyword">auto</span> tag, <span class="keyword">auto</span> dim) {</div>
<div class="line">      std::vector&lt;double&gt; data(ents.size() * dim);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(tag, ents, data.data()),</div>
<div class="line">                     <span class="stringliteral">&quot;get data&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> data;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">      <span class="keyword">auto</span> at_nodes = [&amp;]() {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keyword">auto</span> conn = get_conn_range(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">        <span class="keyword">auto</span> material_force =</div>
<div class="line">            get_tag_data(conn, tags[ExhangeTags::MATERIALFORCE], 3);</div>
<div class="line">        <span class="keyword">auto</span> area_growth = get_tag_data(conn, tags[ExhangeTags::AREAGROWTH], 3);</div>
<div class="line">        <span class="keyword">auto</span> griffith_force =</div>
<div class="line">            get_tag_data(conn, tags[ExhangeTags::GRIFFITHFORCE], 1);</div>
<div class="line">        std::vector&lt;double&gt; coords(conn.size() * 3);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(conn, coords.data()),</div>
<div class="line">                       <span class="stringliteral">&quot;get coords&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Material force at nodes&quot;</span>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> &lt; conn.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Node &quot;</span> &lt;&lt; conn[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] &lt;&lt; <span class="stringliteral">&quot; coords &quot;</span></div>
<div class="line">              &lt;&lt; coords[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; coords[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">              &lt;&lt; coords[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 2] &lt;&lt; <span class="stringliteral">&quot; material force &quot;</span></div>
<div class="line">              &lt;&lt; material_force[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">              &lt;&lt; material_force[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">              &lt;&lt; material_force[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 2] &lt;&lt; <span class="stringliteral">&quot; area growth &quot;</span></div>
<div class="line">              &lt;&lt; area_growth[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; area_growth[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 1]</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; area_growth[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> * 3 + 2] &lt;&lt; <span class="stringliteral">&quot; griffith force &quot;</span></div>
<div class="line">              &lt;&lt; griffith_force[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>];</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      at_nodes();</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calculate_material_forces();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calculate_front_material_force();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_results();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a348" name="a348"></a><a class="code hl_function" href="structEshelbianCore.html#a8acc61f8b8b3e19a7a32e16f7eb1fa5b">EshelbianCore::calculateOrientation</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag,</div>
<div class="line">                                                   <span class="keywordtype">bool</span> set_orientation) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keyword">auto</span> sev = Sev::verbose;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, 3, body_ents);</div>
<div class="line">  <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> body_skin_edges;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(body_skin, 1, <span class="keyword">false</span>, body_skin_edges,</div>
<div class="line">                                           moab::Interface::UNION);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> boundary_skin_verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(body_skin_edges,</div>
<div class="line">                                            boundary_skin_verts, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> geometry_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;EDGES&quot;</span>, 1);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> geometry_edges_verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(geometry_edges,</div>
<div class="line">                                            geometry_edges_verts, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> crack_faces_verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, crack_faces_verts,</div>
<div class="line">                                            <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> crack_faces_edges;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">      *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, 1, <span class="keyword">true</span>, crack_faces_edges, moab::Interface::UNION);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> crack_faces_tets;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">      *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, 3, <span class="keyword">true</span>, crack_faces_tets, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> front_verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, front_verts, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> front_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, 2, <span class="keyword">true</span>, front_faces,</div>
<div class="line">                                           moab::Interface::UNION);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> front_verts_edges;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">      front_verts, 1, <span class="keyword">true</span>, front_verts_edges, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tags_vec = [&amp;](<span class="keyword">auto</span> tag_name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::vector&lt;Tag&gt; tags(1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dim &gt; 3)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;dim&gt;3&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_and_clean = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">      <span class="keyword">auto</span> rval = moab.tag_get_handle(tag_name, tags[0]);</div>
<div class="line">      <span class="keywordflow">if</span> (rval == MB_SUCCESS) {</div>
<div class="line">        moab.tag_delete(tags[0]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordtype">double</span> def_val[] = {0., 0., 0.};</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(tag_name, dim, MB_TYPE_DOUBLE, tags[0],</div>
<div class="line">                                 MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(create_and_clean(), <span class="stringliteral">&quot;create_and_clean&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> tags;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front = [&amp;](<span class="keywordtype">bool</span> subtract_crack) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> adj_front;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                             adj_front, moab::Interface::UNION);</div>
<div class="line">    <span class="keywordflow">if</span> (subtract_crack)</div>
<div class="line">      adj_front = subtract(adj_front, *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    <span class="keywordflow">return</span> adj_front;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a id="a349" name="a349"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a>(<span class="stringliteral">&quot;SELF&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> th_front_position = get_tags_vec(<span class="stringliteral">&quot;FrontPosition&quot;</span>, 3);</div>
<div class="line">  <span class="keyword">auto</span> th_max_face_energy = get_tags_vec(<span class="stringliteral">&quot;MaxFaceEnergy&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_crack_adj_tets = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> crack_faces_conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(r, crack_faces_conn);</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> crack_faces_conn_tets;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(crack_faces_conn, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                               <span class="keyword">true</span>, crack_faces_conn_tets,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      <span class="keywordflow">return</span> crack_faces_conn_tets;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_layers_for_sides = [&amp;](<span class="keyword">auto</span> &amp;side) {</div>
<div class="line">      std::vector&lt;Range&gt; layers;</div>
<div class="line">      <span class="keyword">auto</span> get = [&amp;]() {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keywordtype">int</span> dim) {</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(r, dim, <span class="keyword">true</span>, adj,</div>
<div class="line">                                                   moab::Interface::UNION);</div>
<div class="line">          <span class="keywordflow">return</span> adj;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_tets = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) { <span class="keywordflow">return</span> get_adj(r, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>); };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> front_nodes;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, front_nodes,</div>
<div class="line">                                                  <span class="keyword">true</span>);</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> front_faces = get_adj(front_nodes, 2);</div>
<div class="line">        front_faces = subtract(front_faces, *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">        <span class="keyword">auto</span> front_tets = get_tets(front_nodes);</div>
<div class="line">        <span class="keyword">auto</span> front_side = intersect(side, front_tets);</div>
<div class="line">        layers.push_back(front_side);</div>
<div class="line">        <span class="keywordflow">for</span> (;;) {</div>
<div class="line">          <span class="keyword">auto</span> adj_faces = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, layers.back());</div>
<div class="line">          adj_faces = intersect(adj_faces, front_faces);</div>
<div class="line">          <span class="keyword">auto</span> adj_faces_tets = get_tets(adj_faces);</div>
<div class="line">          adj_faces_tets = intersect(adj_faces_tets, front_tets);</div>
<div class="line">          layers.push_back(unite(layers.back(), adj_faces_tets));</div>
<div class="line">          <span class="keywordflow">if</span> (layers.back().size() == layers[layers.size() - 2].size()) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(get(), <span class="stringliteral">&quot;get_layers_for_sides&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> layers;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> sides_pair = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a711a5a75b4797d9d4f46d1a45dccaf32">get_two_sides_of_crack_surface</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    <span class="keyword">auto</span> layers_top = get_layers_for_sides(sides_pair.first);</div>
<div class="line">    <span class="keyword">auto</span> layers_bottom = get_layers_for_sides(sides_pair.second);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">          <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">          <span class="stringliteral">&quot;crack_tets_&quot;</span> +</div>
<div class="line">              boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">          get_crack_adj_tets(*<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;sides_first.vtk&quot;</span>, sides_pair.first);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;sides_second.vtk&quot;</span>,</div>
<div class="line">                        sides_pair.second);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Nb. layers &quot;</span> &lt;&lt; layers_top.size();</div>
<div class="line">      <span class="keywordtype">int</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;r : layers_top) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Layer &quot;</span> &lt;&lt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> &lt;&lt; <span class="stringliteral">&quot; size &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">            <span class="stringliteral">&quot;layers_top_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>, r);</div>
<div class="line">        ++<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;r : layers_bottom) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Layer &quot;</span> &lt;&lt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> &lt;&lt; <span class="stringliteral">&quot; size &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">            <span class="stringliteral">&quot;layers_bottom_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>, r);</div>
<div class="line">        ++<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_cross = [&amp;](<span class="keyword">auto</span> t_dir, <span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>) {</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_normal;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;getTriNormal(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, &amp;t_normal(0));</div>
<div class="line">      t_normal.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_cross;</div>
<div class="line">      <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a350" name="a350"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a351" name="a351"></a><a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line">      t_cross(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_function" href="namespaceFTensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_normal(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_dir(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line">      <span class="keywordflow">return</span> t_cross;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_sense = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <span class="keyword">auto</span> e) {</div>
<div class="line">      <span class="keywordtype">int</span> side, sense, offset;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, e, side, sense, offset),</div>
<div class="line">                     <span class="stringliteral">&quot;get sense&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> std::make_tuple(side, sense, offset);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> calculate_edge_direction = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> normalize = <span class="keyword">true</span>) {</div>
<div class="line">      <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line">      std::array&lt;double, 6&gt; coords;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(conn, num_nodes, coords.data());</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; t_p0{</div>
<div class="line">          &amp;coords[0], &amp;coords[1], &amp;coords[2]};</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; t_p1{</div>
<div class="line">          &amp;coords[3], &amp;coords[4], &amp;coords[5]};</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_dir;</div>
<div class="line">      <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_p1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_p0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <span class="keywordflow">if</span> (normalize)</div>
<div class="line">        t_dir.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">      <span class="keywordflow">return</span> t_dir;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> evaluate_face_energy_and_set_orientation = [&amp;](<span class="keyword">auto</span> front_edges,</div>
<div class="line">                                                        <span class="keyword">auto</span> front_faces,</div>
<div class="line">                                                        <span class="keyword">auto</span> &amp;sides_pair,</div>
<div class="line">                                                        <span class="keyword">auto</span> th_position) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      Tag th_face_energy;</div>
<div class="line">      Tag th_material_force;</div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code hl_variable" href="structEshelbianCore.html#ae8387101883105f158f223898dcc0cb8">energyReleaseSelector</a>) {</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9aaf0450ba88e72057e299572c0cb42a8c3">GRIFFITH_FORCE</a>:</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9aa8430cfd5241f35fe229c7eb6be7f2580">GRIFFITH_SKELETON</a>:</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;GriffithForce&quot;</span>,</div>
<div class="line">                                                th_face_energy);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;MaterialForce&quot;</span>,</div>
<div class="line">                                                th_material_force);</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONG,</div>
<div class="line">                <span class="stringliteral">&quot;Unknown energy release selector&quot;</span>);</div>
<div class="line">      };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      /**</span></div>
<div class="line"><span class="comment">       * Iterate over front edges, get adjacent faces, find maximal face energy.</span></div>
<div class="line"><span class="comment">       * Maximal face energy is stored in the edge. Maximal face energy is</span></div>
<div class="line"><span class="comment">       * magnitude of edge Griffith force.</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keyword">auto</span> find_maximal_face_energy = [&amp;](<span class="keyword">auto</span> front_edges, <span class="keyword">auto</span> front_faces,</div>
<div class="line">                                          <span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, 3, body_ents);</div>
<div class="line">        <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> max_faces;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : front_edges) {</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">double</span> griffith_force;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_face_energy, &amp;e, 1,</div>
<div class="line">                                                &amp;griffith_force);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;e, 1, 2, <span class="keyword">false</span>, faces);</div>
<div class="line">          faces = subtract(intersect(faces, front_faces), body_skin);</div>
<div class="line">          std::vector&lt;double&gt; face_energy(faces.size());</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_face_energy, faces,</div>
<div class="line">                                                face_energy.data());</div>
<div class="line">          <span class="keyword">auto</span> max_energy_it =</div>
<div class="line">              std::max_element(face_energy.begin(), face_energy.end());</div>
<div class="line">          <span class="keywordtype">double</span> max_energy =</div>
<div class="line">              max_energy_it != face_energy.end() ? *max_energy_it : 0;</div>
<div class="line"> </div>
<div class="line">          edge_face_max_energy_map[e] =</div>
<div class="line">              std::make_tuple(faces[max_energy_it - face_energy.begin()],</div>
<div class="line">                              griffith_force, <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(0));</div>
<div class="line">          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Edge &quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; griffith force &quot;</span> &lt;&lt; griffith_force</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot; max face energy &quot;</span> &lt;&lt; max_energy &lt;&lt; <span class="stringliteral">&quot; factor &quot;</span></div>
<div class="line">              &lt;&lt; max_energy / griffith_force;</div>
<div class="line"> </div>
<div class="line">          max_faces.insert(faces[max_energy_it - face_energy.begin()]);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">              <span class="stringliteral">&quot;max_faces_&quot;</span> +</div>
<div class="line">                  boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) +</div>
<div class="line">                  <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">              max_faces);</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      /**</span></div>
<div class="line"><span class="comment">       * For each front edge, find maximal face energy and orientation. This is</span></div>
<div class="line"><span class="comment">       * by finding angle between edge material force and maximal face normal</span></div>
<div class="line"><span class="comment">       *</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keyword">auto</span> calculate_face_orientation = [&amp;](<span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> up_down_face = [&amp;](</div>
<div class="line"> </div>
<div class="line">                                <span class="keyword">auto</span> &amp;face_angle_map_up,</div>
<div class="line">                                <span class="keyword">auto</span> &amp;face_angle_map_down</div>
<div class="line"> </div>
<div class="line">                            ) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">            <span class="keyword">auto</span> e = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">            <span class="keyword">auto</span> [max_face, energy, opt_angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> faces;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;e, 1, 2, <span class="keyword">false</span>, faces);</div>
<div class="line">            faces = intersect(faces, front_faces);</div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> adj_tets; <span class="comment">// tetrahedrons adjacent to the face</span></div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;max_face, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                     <span class="keyword">false</span>, adj_tets,</div>
<div class="line">                                                     moab::Interface::UNION);</div>
<div class="line">            <span class="keywordflow">if</span> (adj_tets.size()) {</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> adj_tets; <span class="comment">// tetrahedrons adjacent to the face</span></div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;max_face, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                       <span class="keyword">false</span>, adj_tets,</div>
<div class="line">                                                       moab::Interface::UNION);</div>
<div class="line">              <span class="keywordflow">if</span> (adj_tets.size()) {</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_class" href="classRange.html">Range</a> adj_tets_faces;</div>
<div class="line">                <span class="comment">// get faces</span></div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                    adj_tets, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">false</span>, adj_tets_faces,</div>
<div class="line">                    moab::Interface::UNION);</div>
<div class="line">                adj_tets_faces = intersect(adj_tets_faces, faces);</div>
<div class="line">                <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// cross product of face normal and edge direction</span></div>
<div class="line">                <span class="keyword">auto</span> t_cross_max =</div>
<div class="line">                    get_cross(calculate_edge_direction(e, <span class="keyword">true</span>), max_face);</div>
<div class="line">                <span class="keyword">auto</span> [side_max, sense_max, offset_max] = get_sense(max_face, e);</div>
<div class="line">                t_cross_max(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= sense_max;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : adj_tets) {</div>
<div class="line">                  <a class="code hl_class" href="classRange.html">Range</a> adj_tets_faces;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                      &amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">false</span>, adj_tets_faces);</div>
<div class="line">                  adj_tets_faces = intersect(adj_tets_faces, faces);</div>
<div class="line">                  adj_tets_faces =</div>
<div class="line">                      subtract(adj_tets_faces, <a class="code hl_class" href="classRange.html">Range</a>(max_face, max_face));</div>
<div class="line"> </div>
<div class="line">                  <span class="keywordflow">if</span> (adj_tets_faces.size() == 1) {</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">// cross product of adjacent face normal and edge</span></div>
<div class="line">                    <span class="comment">// direction</span></div>
<div class="line">                    <span class="keyword">auto</span> t_cross = get_cross(calculate_edge_direction(e, <span class="keyword">true</span>),</div>
<div class="line">                                             adj_tets_faces[0]);</div>
<div class="line">                    <span class="keyword">auto</span> [side, sense, offset] =</div>
<div class="line">                        get_sense(adj_tets_faces[0], e);</div>
<div class="line">                    t_cross(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= sense;</div>
<div class="line">                    <span class="keywordtype">double</span> dot = t_cross(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_cross_max(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    <span class="keyword">auto</span> angle = std::acos(dot);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordtype">double</span> face_energy;</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(</div>
<div class="line">                        th_face_energy, adj_tets_faces, &amp;face_energy);</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">auto</span> [side_face, sense_face, offset_face] =</div>
<div class="line">                        get_sense(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, max_face);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (sense_face &gt; 0) {</div>
<div class="line">                      face_angle_map_up[e] = std::make_tuple(face_energy, angle,</div>
<div class="line">                                                             adj_tets_faces[0]);</div>
<div class="line"> </div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                      face_angle_map_down[e] = std::make_tuple(</div>
<div class="line">                          face_energy, -angle, adj_tets_faces[0]);</div>
<div class="line">                    }</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> calc_optimal_angle = [&amp;](</div>
<div class="line"> </div>
<div class="line">                                      <span class="keyword">auto</span> &amp;face_angle_map_up,</div>
<div class="line">                                      <span class="keyword">auto</span> &amp;face_angle_map_down</div>
<div class="line"> </div>
<div class="line">                                  ) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">            <span class="keyword">auto</span> e = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">            <span class="keyword">auto</span> &amp;[max_face, e0, <a id="a352" name="a352"></a><a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a>] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (std::abs(e0) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (face_angle_map_up.find(e) == face_angle_map_up.end() ||</div>
<div class="line">                  face_angle_map_down.find(e) == face_angle_map_down.end()) {</div>
<div class="line">                <span class="comment">// Do nothing</span></div>
<div class="line">              } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">switch</span> (<a class="code hl_variable" href="structEshelbianCore.html#ae8387101883105f158f223898dcc0cb8">energyReleaseSelector</a>) {</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9aaf0450ba88e72057e299572c0cb42a8c3">GRIFFITH_FORCE</a>:</div>
<div class="line">                <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9aa8430cfd5241f35fe229c7eb6be7f2580">GRIFFITH_SKELETON</a>: {</div>
<div class="line"> </div>
<div class="line">                  Tag th_material_force;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;MaterialForce&quot;</span>,</div>
<div class="line">                                                          th_material_force);</div>
<div class="line">                  <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_material_force;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(</div>
<div class="line">                      th_material_force, &amp;e, 1, &amp;t_material_force(0));</div>
<div class="line">                  <span class="keyword">auto</span> material_force_magnitude = t_material_force.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>();</div>
<div class="line">                  <span class="keywordflow">if</span> (material_force_magnitude &lt;</div>
<div class="line">                      std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">                    <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> = 0;</div>
<div class="line"> </div>
<div class="line">                  } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">auto</span> t_edge_dir = calculate_edge_direction(e, <span class="keyword">true</span>);</div>
<div class="line">                    <span class="keyword">auto</span> t_cross_max = get_cross(t_edge_dir, max_face);</div>
<div class="line">                    <span class="keyword">auto</span> [side, sense, offset] = get_sense(max_face, e);</div>
<div class="line">                    t_cross_max(sense) *= sense;</div>
<div class="line"> </div>
<div class="line">                    <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">                    <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">                    <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, K);</div>
<div class="line"> </div>
<div class="line">                    t_material_force.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">                    t_cross_max.normalize();</div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_cross;</div>
<div class="line">                    t_cross(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = <a class="code hl_function" href="namespaceFTensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a>(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, K) *</div>
<div class="line">                                 t_material_force(<a class="code hl_variable" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) * t_cross_max(K);</div>
<div class="line">                    <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> = -std::asin(t_cross(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) * t_edge_dir(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>));</div>
<div class="line"> </div>
<div class="line">                    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev)</div>
<div class="line">                        &lt;&lt; <span class="stringliteral">&quot;Optimal angle &quot;</span> &lt;&lt; <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> &lt;&lt; <span class="stringliteral">&quot; energy &quot;</span> &lt;&lt; e0;</div>
<div class="line">                  }</div>
<div class="line">                  <span class="keywordflow">break</span>;</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">default</span>: {</div>
<div class="line"> </div>
<div class="line">                  SETERRQ(PETSC_COMM_SELF, PETSC_ERR_ARG_WRONG,</div>
<div class="line">                          <span class="stringliteral">&quot;Unknown energy release selector&quot;</span>);</div>
<div class="line">                }</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        std::map&lt;EntityHandle, std::tuple&lt;double, double, EntityHandle&gt;&gt;</div>
<div class="line">            face_angle_map_up;</div>
<div class="line">        std::map&lt;EntityHandle, std::tuple&lt;double, double, EntityHandle&gt;&gt;</div>
<div class="line">            face_angle_map_down;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> up_down_face(face_angle_map_up, face_angle_map_down);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calc_optimal_angle(face_angle_map_up, face_angle_map_down);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">          <span class="keyword">auto</span> th_angle = get_tags_vec(<span class="stringliteral">&quot;Angle&quot;</span>, 1);</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> up;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : face_angle_map_up) {</div>
<div class="line">            <span class="keyword">auto</span> [e, <a id="a353" name="a353"></a><a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, face] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            up.insert(face);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_angle[0], &amp;face, 1, &amp;<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>);</div>
<div class="line">          }</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> down;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : face_angle_map_down) {</div>
<div class="line">            <span class="keyword">auto</span> [e, <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, face] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            down.insert(face);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_angle[0], &amp;face, 1, &amp;<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> max_energy_faces;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">            <span class="keyword">auto</span> [face, e, angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            max_energy_faces.insert(face);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_angle[0], &amp;face, 1,</div>
<div class="line">                                                  &amp;angle);</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;up_faces.vtk&quot;</span>, up);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;down_faces.vtk&quot;</span>, down);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;max_energy_faces.vtk&quot;</span>,</div>
<div class="line">                              max_energy_faces);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_conn = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, <span class="keyword">true</span>),</div>
<div class="line">                       <span class="stringliteral">&quot;get conn&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> conn;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> dim) {</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                           e, dim, <span class="keyword">false</span>, adj, moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> adj;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_coords = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_coords;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, &amp;t_coords(0)),</div>
<div class="line">                       <span class="stringliteral">&quot;get coords&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> t_coords;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// calulate normal of the max energy face</span></div>
<div class="line">      <span class="keyword">auto</span> get_rotated_normal = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <span class="keyword">auto</span> angle) {</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">        <span class="keyword">auto</span> t_edge_dir = calculate_edge_direction(e, <span class="keyword">true</span>);</div>
<div class="line">        <span class="keyword">auto</span> [side, sense, offset] = get_sense(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, e);</div>
<div class="line">        t_edge_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= sense;</div>
<div class="line">        t_edge_dir.normalize();</div>
<div class="line">        t_edge_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= angle;</div>
<div class="line">        <span class="keyword">auto</span> t_R = <a id="a354" name="a354"></a><a class="code hl_function" href="structLieGroups_1_1SO3.html#af80491b46de29b3959da57bb3bfce5b9">LieGroups::SO3::exp</a>(t_edge_dir, angle);</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_normal;</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;getTriNormal(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, &amp;t_normal(0));</div>
<div class="line">        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_rotated_normal;</div>
<div class="line">        t_rotated_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_R(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_normal(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">        <span class="keywordflow">return</span> std::make_tuple(t_normal, t_rotated_normal);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_coord = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">auto</span> &amp;adj_vertex_tets_verts, <span class="keyword">auto</span> &amp;coords,</div>
<div class="line">                           <span class="keyword">auto</span> &amp;t_move, <span class="keyword">auto</span> gamma) {</div>
<div class="line">        <span class="keyword">auto</span> index = adj_vertex_tets_verts.index(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line">        <span class="keywordflow">if</span> (index &gt;= 0) {</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {0, 1, 2}) {</div>
<div class="line">            coords[3 * index + ii] += gamma * t_move(ii);</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> tets_quality = [&amp;](<span class="keyword">auto</span> quality, <span class="keyword">auto</span> &amp;adj_vertex_tets_verts,</div>
<div class="line">                              <span class="keyword">auto</span> &amp;adj_vertex_tets, <span class="keyword">auto</span> &amp;coords) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : adj_vertex_tets) {</div>
<div class="line">          <span class="keyword">const</span> EntityHandle *conn;</div>
<div class="line">          <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line">          std::array&lt;double, 12&gt; tet_coords;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 0; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> != 4; ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) {</div>
<div class="line">            <span class="keyword">auto</span> index = adj_vertex_tets_verts.index(conn[<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>]);</div>
<div class="line">            <span class="keywordflow">if</span> (index &lt; 0) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Wrong index&quot;</span>);</div>
<div class="line">            }</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">              tet_coords[3 * <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> + ii] = coords[3 * index + ii];</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordtype">double</span> q = Tools::volumeLengthQuality(tet_coords.data());</div>
<div class="line">          <span class="keywordflow">if</span> (!std::isnormal(q))</div>
<div class="line">            q = -2;</div>
<div class="line">          quality = std::min(quality, q);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> quality;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> calculate_free_face_node_displacement =</div>
<div class="line">          [&amp;](<span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">            <span class="comment">// get edges adjacent to vertex along which nodes are moving</span></div>
<div class="line">            <span class="keyword">auto</span> get_vertex_edges = [&amp;](<span class="keyword">auto</span> vertex) {</div>
<div class="line">              <a class="code hl_class" href="classRange.html">Range</a> vertex_edges; <span class="comment">// edges adjacent to vertex</span></div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> impl = [&amp;]() {</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(vertex, 1, <span class="keyword">false</span>,</div>
<div class="line">                                                         vertex_edges);</div>
<div class="line">                vertex_edges = subtract(vertex_edges, front_verts_edges);</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (boundary_skin_verts.size() &amp;&amp;</div>
<div class="line">                    boundary_skin_verts.find(vertex[0]) !=</div>
<div class="line">                        boundary_skin_verts.end()) {</div>
<div class="line">                  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Boundary vertex&quot;</span>;</div>
<div class="line">                  vertex_edges = intersect(vertex_edges, body_skin_edges);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (geometry_edges_verts.size() &amp;&amp;</div>
<div class="line">                    geometry_edges_verts.find(vertex[0]) !=</div>
<div class="line">                        geometry_edges_verts.end()) {</div>
<div class="line">                  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Geometry edge vertex&quot;</span>;</div>
<div class="line">                  vertex_edges = intersect(vertex_edges, geometry_edges);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (crack_faces_verts.size() &amp;&amp;</div>
<div class="line">                    crack_faces_verts.find(vertex[0]) !=</div>
<div class="line">                        crack_faces_verts.end()) {</div>
<div class="line">                  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Crack face vertex&quot;</span>;</div>
<div class="line">                  vertex_edges = intersect(vertex_edges, crack_faces_edges);</div>
<div class="line">                }</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">              };</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(impl(), <span class="stringliteral">&quot;get_vertex_edges&quot;</span>);</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">return</span> vertex_edges;</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// vector of rotated faces, edge along node is moved, moved edge,</span></div>
<div class="line">            <span class="comment">// moved displacement, quality, cardinality, gamma</span></div>
<div class="line">            <span class="keyword">using </span>Bundle = std::vector&lt;</div>
<div class="line"> </div>
<div class="line">                std::tuple&lt;EntityHandle, EntityHandle, EntityHandle,</div>
<div class="line">                           <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>, double, double, <span class="keywordtype">double</span>&gt;</div>
<div class="line"> </div>
<div class="line">                &gt;;</div>
<div class="line">            std::map&lt;EntityHandle, Bundle&gt; edge_bundle_map;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> edge = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">              <span class="keyword">auto</span> &amp;[max_face, energy, opt_angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line"> </div>
<div class="line">              <span class="comment">// calculate rotation of max energy face</span></div>
<div class="line">              <span class="keyword">auto</span> [t_normal, t_rotated_normal] =</div>
<div class="line">                  get_rotated_normal(edge, max_face, opt_angle);</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> front_vertex = get_conn(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first));</div>
<div class="line">              <span class="keyword">auto</span> adj_tets = get_adj(<a class="code hl_class" href="classRange.html">Range</a>(max_face, max_face), 3);</div>
<div class="line">              <span class="keyword">auto</span> adj_tets_faces = get_adj(adj_tets, 2);</div>
<div class="line">              <span class="keyword">auto</span> adj_front_faces = subtract(</div>
<div class="line">                  intersect(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(edge, edge), 2), adj_tets_faces),</div>
<div class="line">                  *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">              <span class="keywordflow">if</span> (adj_front_faces.size() &gt; 3)</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                  <span class="stringliteral">&quot;adj_front_faces.size()&gt;3&quot;</span>);</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_material_force;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_material_force, &amp;edge, 1,</div>
<div class="line">                                                    &amp;t_material_force(0));</div>
<div class="line">              std::vector&lt;double&gt; griffith_energy(adj_front_faces.size());</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(</div>
<div class="line">                  th_face_energy, adj_front_faces, griffith_energy.data());</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> set_edge_bundle = [&amp;](<span class="keyword">auto</span> min_gamma) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> rotated_f : adj_front_faces) {</div>
<div class="line"> </div>
<div class="line">                  <span class="keywordtype">double</span> rotated_face_energy =</div>
<div class="line">                      griffith_energy[adj_front_faces.index(rotated_f)];</div>
<div class="line"> </div>
<div class="line">                  <span class="keyword">auto</span> vertex = subtract(get_conn(<a class="code hl_class" href="classRange.html">Range</a>(rotated_f, rotated_f)),</div>
<div class="line">                                         front_vertex);</div>
<div class="line">                  <span class="keywordflow">if</span> (vertex.size() != 1) {</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                      <span class="stringliteral">&quot;Wrong number of vertex to move&quot;</span>);</div>
<div class="line">                  }</div>
<div class="line">                  <span class="keyword">auto</span> front_vertex_edges_vertex = get_conn(</div>
<div class="line">                      intersect(get_adj(front_vertex, 1), crack_faces_edges));</div>
<div class="line">                  vertex = subtract(</div>
<div class="line">                      vertex, front_vertex_edges_vertex); <span class="comment">// vertex free to move</span></div>
<div class="line">                  <span class="keywordflow">if</span> (vertex.empty()) {</div>
<div class="line">                    <span class="keywordflow">continue</span>;</div>
<div class="line">                  }</div>
<div class="line"> </div>
<div class="line">                  <span class="keyword">auto</span> face_cardinality = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <span class="keyword">auto</span> &amp;seen_front_edges) {</div>
<div class="line">                    <span class="keyword">auto</span> whole_front =</div>
<div class="line">                        unite(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>,</div>
<div class="line">                              subtract(body_skin_edges, crack_faces_edges));</div>
<div class="line">                    <span class="keyword">auto</span> faces = <a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>);</div>
<div class="line">                    <span class="keywordtype">int</span> <a id="a355" name="a355"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (; <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> &lt; 10; ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">                      <span class="keyword">auto</span> front_edges =</div>
<div class="line">                          subtract(get_adj(faces, 1), seen_front_edges);</div>
<div class="line">                      <span class="keywordflow">if</span> (front_edges.size() == 0) {</div>
<div class="line">                        <span class="keywordflow">return</span> 0;</div>
<div class="line">                      }</div>
<div class="line">                      <span class="keyword">auto</span> front_connected_edges =</div>
<div class="line">                          intersect(front_edges, whole_front);</div>
<div class="line">                      <span class="keywordflow">if</span> (front_connected_edges.size()) {</div>
<div class="line">                        seen_front_edges.merge(front_connected_edges);</div>
<div class="line">                        <span class="keywordflow">return</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>;</div>
<div class="line">                      }</div>
<div class="line">                      faces.merge(get_adj(front_edges, 2));</div>
<div class="line">                      ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>;</div>
<div class="line">                    }</div>
<div class="line">                    <span class="keywordflow">return</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>;</div>
<div class="line">                  };</div>
<div class="line"> </div>
<div class="line">                  <a class="code hl_class" href="classRange.html">Range</a> seen_edges = <a class="code hl_class" href="classRange.html">Range</a>(edge, edge);</div>
<div class="line">                  <span class="keywordtype">double</span> rotated_face_cardinality = face_cardinality(</div>
<div class="line">                      rotated_f,</div>
<div class="line">                      seen_edges); <span class="comment">// add cardinality of max energy</span></div>
<div class="line">                                   <span class="comment">// face to rotated face cardinality</span></div>
<div class="line">                  <span class="comment">// rotated_face_cardinality +=</span></div>
<div class="line">                  <span class="comment">//     face_cardinality(max_face, seen_edges);</span></div>
<div class="line">                  rotated_face_cardinality = std::max(rotated_face_cardinality,</div>
<div class="line">                                                      1.); <span class="comment">// at least one edge</span></div>
<div class="line"> </div>
<div class="line">                  <span class="keyword">auto</span> t_vertex_coords = get_coords(vertex);</div>
<div class="line">                  <span class="keyword">auto</span> vertex_edges = get_vertex_edges(vertex);</div>
<div class="line"> </div>
<div class="line">                  EntityHandle f0 = front_vertex[0];</div>
<div class="line">                  EntityHandle f1 = front_vertex[1];</div>
<div class="line">                  <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_v_e0, t_v_e1;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;f0, 1, &amp;t_v_e0(0));</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;f1, 1, &amp;t_v_e1(0));</div>
<div class="line"> </div>
<div class="line">                  <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> e_used_to_move_detection : vertex_edges) {</div>
<div class="line">                    <span class="keyword">auto</span> edge_conn = get_conn(<a class="code hl_class" href="classRange.html">Range</a>(e_used_to_move_detection,</div>
<div class="line">                                                    e_used_to_move_detection));</div>
<div class="line">                    edge_conn = subtract(edge_conn, vertex);</div>
<div class="line">                    <span class="comment">// Find displacement of the edge such that dot porduct with</span></div>
<div class="line">                    <span class="comment">// normal is zero.</span></div>
<div class="line">                    <span class="comment">//</span></div>
<div class="line">                    <span class="comment">// { (t_v0 - t_vertex_coords) + gamma * (t_v3 -</span></div>
<div class="line">                    <span class="comment">// t_vertex_coords) } * n = 0</span></div>
<div class="line">                    <span class="comment">// where t_v0 is the edge vertex, t_v3 is the edge end</span></div>
<div class="line">                    <span class="comment">// point, n is the rotated normal of the face gamma is the</span></div>
<div class="line">                    <span class="comment">// factor by which the edge is moved</span></div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_v0;</div>
<div class="line">                    t_v0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = (t_v_e0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_v_e1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2;</div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_v3;</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(edge_conn, &amp;t_v3(0));</div>
<div class="line">                    <span class="keyword">auto</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> =</div>
<div class="line">                        (t_v0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_rotated_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    <span class="keyword">auto</span> b =</div>
<div class="line">                        (t_v3(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_rotated_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    <span class="keyword">auto</span> gamma = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> / b;</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> =</div>
<div class="line">                        std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line">                    <span class="keywordflow">if</span> (std::isnormal(gamma) &amp;&amp; gamma &lt; 1.0 - <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> &amp;&amp;</div>
<div class="line">                        gamma &gt; -0.1) {</div>
<div class="line">                      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_move;</div>
<div class="line">                      t_move(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = gamma * (t_v3(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">                      <span class="keyword">auto</span> check_rotated_face_directoon = [&amp;]() {</div>
<div class="line">                        <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_delta;</div>
<div class="line">                        t_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_move(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_v0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                        t_delta.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">                        <span class="keyword">auto</span> dot =</div>
<div class="line">                            (t_material_force(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / t_material_force.<a class="code hl_function" href="classFTensor_1_1Tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>()) *</div>
<div class="line">                            t_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                        <span class="keywordflow">return</span> -dot &gt; 0 ? true : <span class="keyword">false</span>;</div>
<div class="line">                      };</div>
<div class="line"> </div>
<div class="line">                      <span class="keywordflow">if</span> (check_rotated_face_directoon()) {</div>
<div class="line"> </div>
<div class="line">                        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">                            &lt;&lt; <span class="stringliteral">&quot;Crack edge &quot;</span> &lt;&lt; edge &lt;&lt; <span class="stringliteral">&quot; moved face &quot;</span></div>
<div class="line">                            &lt;&lt; rotated_f</div>
<div class="line">                            &lt;&lt; <span class="stringliteral">&quot; edge: &quot;</span> &lt;&lt; e_used_to_move_detection</div>
<div class="line">                            &lt;&lt; <span class="stringliteral">&quot; face direction/energy &quot;</span> &lt;&lt; rotated_face_energy</div>
<div class="line">                            &lt;&lt; <span class="stringliteral">&quot; face cardinality &quot;</span> &lt;&lt; rotated_face_cardinality</div>
<div class="line">                            &lt;&lt; <span class="stringliteral">&quot; gamma: &quot;</span> &lt;&lt; gamma;</div>
<div class="line"> </div>
<div class="line">                        <span class="keyword">auto</span> &amp;bundle = edge_bundle_map[edge];</div>
<div class="line">                        bundle.emplace_back(rotated_f, e_used_to_move_detection,</div>
<div class="line">                                            vertex[0], t_move, 1,</div>
<div class="line">                                            rotated_face_cardinality, gamma);</div>
<div class="line">                      }</div>
<div class="line">                    }</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">              };</div>
<div class="line"> </div>
<div class="line">              set_edge_bundle(std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line">              <span class="keywordflow">if</span> (edge_bundle_map[edge].empty()) {</div>
<div class="line">                set_edge_bundle(-1.);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> edge_bundle_map;</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_sort_by_energy = [&amp;](<span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">        std::map&lt;double, std::tuple&lt;EntityHandle, EntityHandle, double&gt;&gt;</div>
<div class="line">            sort_by_energy;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">          <span class="keyword">auto</span> e = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">          <span class="keyword">auto</span> &amp;[max_face, energy, opt_angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            sort_by_energy[energy] = std::make_tuple(e, max_face, opt_angle);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> sort_by_energy;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">auto</span> &amp;&amp;adj_edges_map, <span class="keyword">auto</span> &amp;&amp;sort_by_energy) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        Tag th_face_pressure;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;FacePressure&quot;</span>, th_face_pressure),</div>
<div class="line">            <span class="stringliteral">&quot;get tag&quot;</span>);</div>
<div class="line">        <span class="keyword">auto</span> get_face_pressure = [&amp;](<span class="keyword">auto</span> face) {</div>
<div class="line">          <span class="keywordtype">double</span> pressure;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_face_pressure, &amp;face,</div>
<div class="line">                                                        1, &amp;pressure),</div>
<div class="line">                         <span class="stringliteral">&quot;get rag data&quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> pressure;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Number of edges to check &quot;</span> &lt;&lt; sort_by_energy.size();</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">enum</span> face_energy { POSITIVE, NEGATIVE };</div>
<div class="line">        <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> skip_negative = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> fe : {face_energy::POSITIVE, face_energy::NEGATIVE}) {</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// iterate edges wih maximal energy, and make them seed. Such edges,</span></div>
<div class="line">          <span class="comment">// will most likely will have also smallest node displacement</span></div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = sort_by_energy.rbegin(); it != sort_by_energy.rend();</div>
<div class="line">               ++it) {</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> energy = it-&gt;first;</div>
<div class="line">            <span class="keyword">auto</span> [max_edge, max_face, opt_angle] = it-&gt;second;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> face_pressure = get_face_pressure(max_face);</div>
<div class="line">            <span class="keywordflow">if</span> (skip_negative) {</div>
<div class="line">              <span class="keywordflow">if</span> (fe == face_energy::POSITIVE) {</div>
<div class="line">                <span class="keywordflow">if</span> (face_pressure &lt; 0) {</div>
<div class="line">                  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;Skip negative face &quot;</span> &lt;&lt; max_face &lt;&lt; <span class="stringliteral">&quot; with energy &quot;</span></div>
<div class="line">                      &lt;&lt; energy &lt;&lt; <span class="stringliteral">&quot; and pressure &quot;</span> &lt;&lt; face_pressure;</div>
<div class="line">                  <span class="keywordflow">continue</span>;</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Check face &quot;</span> &lt;&lt; max_face &lt;&lt; <span class="stringliteral">&quot; edge &quot;</span> &lt;&lt; max_edge</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; energy &quot;</span> &lt;&lt; energy &lt;&lt; <span class="stringliteral">&quot; optimal angle &quot;</span> &lt;&lt; opt_angle</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; face pressure &quot;</span> &lt;&lt; face_pressure;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> jt = adj_edges_map.find(max_edge);</div>
<div class="line">            <span class="keywordflow">if</span> (jt == adj_edges_map.end()) {</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::warning)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;Edge &quot;</span> &lt;&lt; max_edge &lt;&lt; <span class="stringliteral">&quot; not found in adj_edges_map&quot;</span>;</div>
<div class="line">              <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <span class="keyword">auto</span> &amp;bundle = jt-&gt;second;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> find_max_in_bundle_impl = [&amp;](<span class="keyword">auto</span> edge, <span class="keyword">auto</span> &amp;bundle,</div>
<div class="line">                                               <span class="keyword">auto</span> gamma) {</div>
<div class="line">              <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">              EntityHandle vertex_max = 0;</div>
<div class="line">              EntityHandle face_max = 0;</div>
<div class="line">              EntityHandle move_edge_max = 0;</div>
<div class="line">              <span class="keywordtype">double</span> max_quality = -2;</div>
<div class="line">              <span class="keywordtype">double</span> max_quality_evaluated = -2;</div>
<div class="line">              <span class="keywordtype">double</span> min_cardinality = std::numeric_limits&lt;double&gt;::max();</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_move_last{0., 0., 0.};</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;b : bundle) {</div>
<div class="line">                <span class="keyword">auto</span> &amp;[face, move_edge, vertex, t_move, quality, cardinality,</div>
<div class="line">                       edge_gamma] = b;</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">auto</span> adj_vertex_tets = get_adj(<a class="code hl_class" href="classRange.html">Range</a>(vertex, vertex), 3);</div>
<div class="line">                <span class="keyword">auto</span> adj_vertex_tets_verts = get_conn(adj_vertex_tets);</div>
<div class="line">                std::vector&lt;double&gt; coords(3 * adj_vertex_tets_verts.size());</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(</div>
<div class="line">                                   adj_vertex_tets_verts, coords.data()),</div>
<div class="line">                               <span class="stringliteral">&quot;get coords&quot;</span>);</div>
<div class="line"> </div>
<div class="line">                set_coord(vertex, adj_vertex_tets_verts, coords, t_move, gamma);</div>
<div class="line">                quality = tets_quality(quality, adj_vertex_tets_verts,</div>
<div class="line">                                       adj_vertex_tets, coords);</div>
<div class="line"> </div>
<div class="line">                <span class="keyword">auto</span> eval_quality = [](<span class="keyword">auto</span> q, <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, <span class="keyword">auto</span> edge_gamma) {</div>
<div class="line">                  <span class="keywordflow">if</span> (q &lt; 0) {</div>
<div class="line">                    <span class="keywordflow">return</span> q;</div>
<div class="line">                  } <span class="keywordflow">else</span> {</div>
<div class="line">                    <span class="keywordflow">return</span> ((edge_gamma &lt; 0) ? (q / 2) : q) / pow(<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>, 2);</div>
<div class="line">                  }</div>
<div class="line">                };</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (eval_quality(quality, cardinality, edge_gamma) &gt;=</div>
<div class="line">                    max_quality_evaluated) {</div>
<div class="line">                  max_quality = quality;</div>
<div class="line">                  min_cardinality = cardinality;</div>
<div class="line">                  vertex_max = vertex;</div>
<div class="line">                  face_max = face;</div>
<div class="line">                  move_edge_max = move_edge;</div>
<div class="line">                  t_move_last(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_move(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                  max_quality_evaluated =</div>
<div class="line">                      eval_quality(max_quality, min_cardinality, edge_gamma);</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">return</span> std::make_tuple(vertex_max, face_max, t_move_last,</div>
<div class="line">                                     max_quality, min_cardinality);</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> find_max_in_bundle = [&amp;](<span class="keyword">auto</span> edge, <span class="keyword">auto</span> &amp;bundle) {</div>
<div class="line">              <span class="keyword">auto</span> b_org_bundle = bundle;</div>
<div class="line">              <span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = find_max_in_bundle_impl(edge, bundle, 1.);</div>
<div class="line">              <span class="keyword">auto</span> &amp;[vertex_max, face_max, t_move_last, max_quality,</div>
<div class="line">                     cardinality] = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">              <span class="keywordflow">if</span> (max_quality &lt; 0) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">double</span> gamma = 0.95; gamma &gt;= 0.45; gamma -= 0.05) {</div>
<div class="line">                  bundle = b_org_bundle;</div>
<div class="line">                  <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = find_max_in_bundle_impl(edge, bundle, gamma);</div>
<div class="line">                  <span class="keyword">auto</span> &amp;[vertex_max, face_max, t_move_last, max_quality,</div>
<div class="line">                         cardinality] = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">                  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::warning)</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;Back tracking: gamma &quot;</span> &lt;&lt; gamma &lt;&lt; <span class="stringliteral">&quot; edge &quot;</span> &lt;&lt; edge</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot; quality &quot;</span> &lt;&lt; max_quality &lt;&lt; <span class="stringliteral">&quot; cardinality &quot;</span></div>
<div class="line">                      &lt;&lt; cardinality;</div>
<div class="line">                  <span class="keywordflow">if</span> (max_quality &gt; 0.01) {</div>
<div class="line">                    <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">                    t_move_last(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) *= gamma;</div>
<div class="line">                    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">                <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>);</div>
<div class="line">                t_move_last(<a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>) = 0;</div>
<div class="line">              }</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// set tags with displacement of node and face energy</span></div>
<div class="line">            <span class="keyword">auto</span> set_tag_to_vertex_and_face = [&amp;](<span class="keyword">auto</span> &amp;&amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">auto</span> &amp;quality) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">              <span class="keyword">auto</span> &amp;[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, t_move, q, cardinality] = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> ((q &gt; 0 &amp;&amp; std::isnormal(q)) &amp;&amp; energy &gt; 0) {</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                    &lt;&lt; <span class="stringliteral">&quot;Set tag: vertex &quot;</span> &lt;&lt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> &lt;&lt; <span class="stringliteral">&quot; face &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                    &lt;&lt; max_edge &lt;&lt; <span class="stringliteral">&quot; move &quot;</span> &lt;&lt; t_move &lt;&lt; <span class="stringliteral">&quot; energy &quot;</span> &lt;&lt; energy</div>
<div class="line">                    &lt;&lt; <span class="stringliteral">&quot; quality &quot;</span> &lt;&lt; q &lt;&lt; <span class="stringliteral">&quot; cardinality &quot;</span> &lt;&lt; cardinality;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_position[0], &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1,</div>
<div class="line">                                                      &amp;t_move(0));</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_max_face_energy[0], &amp;<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>,</div>
<div class="line">                                                      1, &amp;energy);</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">              quality = q;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">            };</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> quality = -2;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag_to_vertex_and_face(</div>
<div class="line"> </div>
<div class="line">                find_max_in_bundle(max_edge, bundle),</div>
<div class="line"> </div>
<div class="line">                quality</div>
<div class="line"> </div>
<div class="line">            );</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (quality &gt; 0 &amp;&amp; std::isnormal(quality) &amp;&amp; energy &gt; 0) {</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;Crack face set with quality: &quot;</span> &lt;&lt; quality;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (!skip_negative)</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// map: {edge, {face, energy, optimal_angle}}</span></div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Calculate orientation&quot;</span>;</div>
<div class="line">      std::map&lt;EntityHandle, std::tuple&lt;EntityHandle, double, double&gt;&gt;</div>
<div class="line">          edge_face_max_energy_map;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> find_maximal_face_energy(front_edges, front_faces,</div>
<div class="line">                                      edge_face_max_energy_map);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calculate_face_orientation(edge_face_max_energy_map);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Calculate node positions&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag(</div>
<div class="line"> </div>
<div class="line">          calculate_free_face_node_displacement(edge_face_max_energy_map),</div>
<div class="line">          get_sort_by_energy(edge_face_max_energy_map)</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Front edges &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>-&gt;size();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evaluate_face_energy_and_set_orientation(</div>
<div class="line">        *<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, get_adj_front(<span class="keyword">false</span>), sides_pair, th_front_position);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// exchange positions and energies from processor zero to all other</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a id="a356" name="a356"></a><a class="code hl_variable" href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>.second);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                             SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                           SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;updateEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>, th_front_position[0]);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a>.second);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                             SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a>.second, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;updateEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a>, th_max_face_energy[0]);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_max_moved_faces = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> max_moved_faces;</div>
<div class="line">    <span class="keyword">auto</span> adj_front = get_adj_front(<span class="keyword">false</span>);</div>
<div class="line">    std::vector&lt;double&gt; face_energy(adj_front.size());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_max_face_energy[0], adj_front,</div>
<div class="line">                                          face_energy.data());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != adj_front.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (face_energy[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">        max_moved_faces.insert(adj_front[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> boost::make_shared&lt;Range&gt;(max_moved_faces);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// move all faces with energy larger than 0</span></div>
<div class="line">  <a id="a357" name="a357"></a><a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a> = get_max_moved_faces();</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Number of of moved faces: &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>-&gt;size();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">        <span class="stringliteral">&quot;max_moved_faces_&quot;</span> +</div>
<div class="line">            boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">        *<a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>);</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a358" name="a358"></a><a class="code hl_function" href="structEshelbianCore.html#a90305e24905e60449369cef8928bda5e">EshelbianCore::setNewFrontCoordinates</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  Tag th_front_position;</div>
<div class="line">  <span class="keyword">auto</span> rval =</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;FrontPosition&quot;</span>, th_front_position);</div>
<div class="line">  <span class="keywordflow">if</span> (rval == MB_SUCCESS &amp;&amp; <a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> verts;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>, verts, <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(verts);</div>
<div class="line">    std::vector&lt;double&gt; coords(3 * verts.size());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(verts, coords.data());</div>
<div class="line">    std::vector&lt;double&gt; pos(3 * verts.size());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_front_position, verts, pos.data());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != 3 * verts.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">      coords[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] += pos[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>];</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().set_coords(verts, coords.data());</div>
<div class="line">    <span class="keywordtype">double</span> zero[] = {0., 0., 0.};</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_clear_data(th_front_position, verts, zero);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">        <span class="stringliteral">&quot;set_coords_faces_&quot;</span> +</div>
<div class="line">            boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">        *<a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>);</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a359" name="a359"></a><a class="code hl_function" href="structEshelbianCore.html#ac8bb12e0051c67e32fc448679f97d6bc">EshelbianCore::addCrackSurfaces</a>(<span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> potential_crack_debug = <span class="keyword">false</span>;</div>
<div class="line">  <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (potential_crack_debug) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> add_ents = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;POTENTIAL&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> crack_front_verts;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, crack_front_verts,</div>
<div class="line">                                              <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_front_verts);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> crack_front_faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(crack_front_verts, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1,</div>
<div class="line">                                             <span class="keyword">true</span>, crack_front_faces,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line">    crack_front_faces = intersect(crack_front_faces, add_ents);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_front_faces);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;addEntitiesToMeshset(</div>
<div class="line">        <a id="a360" name="a360"></a><a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a id="a361" name="a361"></a><a class="code hl_variable" href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>, crack_front_faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_crack_faces = [&amp;]() {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>) {</div>
<div class="line">      <span class="keywordflow">return</span> unite(*<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, *<a class="code hl_variable" href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">maxMovedFaces</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> *<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>;</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_extended_crack_faces = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> get_faces_of_crack_front_verts = [&amp;](<span class="keyword">auto</span> crack_faces_org) {</div>
<div class="line">      ParallelComm *pcomm =</div>
<div class="line">          ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> crack_faces;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (!pcomm-&gt;rank()) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_nodes = [&amp;](<span class="keyword">auto</span> &amp;&amp;e) {</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> nodes;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, nodes, <span class="keyword">true</span>),</div>
<div class="line">                         <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> nodes;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> &amp;&amp;e, <span class="keyword">auto</span> dim,</div>
<div class="line">                           <span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> = moab::Interface::UNION) {</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(e, dim, <span class="keyword">true</span>, adj, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>),</div>
<div class="line">              <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> adj;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                           body_ents);</div>
<div class="line">        <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line">        <span class="keyword">auto</span> body_skin_edges = get_adj(body_skin, 1, moab::Interface::UNION);</div>
<div class="line">        <span class="keyword">auto</span> geometry_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;EDGES&quot;</span>, 1);</div>
<div class="line">        <span class="keyword">auto</span> front_block_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;FRONT&quot;</span>, 1);</div>
<div class="line">        <span class="keyword">auto</span> front_block_nodes = get_nodes(front_block_edges);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">size_t</span> s;</div>
<div class="line">        <span class="keywordflow">do</span> {</div>
<div class="line">          s = crack_faces.size();</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> crack_face_nodes = get_nodes(crack_faces_org);</div>
<div class="line">          <span class="keyword">auto</span> crack_faces_edges =</div>
<div class="line">              get_adj(crack_faces_org, 1, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> crack_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, crack_faces_org);</div>
<div class="line">          front_block_edges = subtract(front_block_edges, crack_skin);</div>
<div class="line">          <span class="keyword">auto</span> crack_skin_nodes = get_nodes(crack_skin);</div>
<div class="line">          crack_skin_nodes.merge(front_block_nodes);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> crack_skin_faces =</div>
<div class="line">              get_adj(crack_skin, 2, moab::Interface::UNION);</div>
<div class="line">          crack_skin_faces =</div>
<div class="line">              subtract(subtract(crack_skin_faces, crack_faces_org), body_skin);</div>
<div class="line"> </div>
<div class="line">          crack_faces = crack_faces_org;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> : crack_skin_faces) {</div>
<div class="line">            <span class="keyword">auto</span> edges = intersect(</div>
<div class="line">                get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>), 1, moab::Interface::UNION), crack_skin);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// if other edge is part of body skin, e.g. crack punching through</span></div>
<div class="line">            <span class="comment">// body surface</span></div>
<div class="line">            <span class="keywordflow">if</span> (edges.size() == 2) {</div>
<div class="line">              edges.merge(</div>
<div class="line">                  intersect(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>), 1, moab::Interface::UNION),</div>
<div class="line">                            body_skin_edges));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (edges.size() == 2) {</div>
<div class="line">              <span class="keyword">auto</span> edge_conn = get_nodes(<a class="code hl_class" href="classRange.html">Range</a>(edges));</div>
<div class="line">              <span class="keyword">auto</span> faces = intersect(get_adj(edges, 2, moab::Interface::UNION),</div>
<div class="line">                                     crack_faces_org);</div>
<div class="line">              <span class="keywordflow">if</span> (faces.size() == 2) {</div>
<div class="line">                <span class="keyword">auto</span> edge0_conn = get_nodes(<a class="code hl_class" href="classRange.html">Range</a>(edges[0], edges[0]));</div>
<div class="line">                <span class="keyword">auto</span> edge1_conn = get_nodes(<a class="code hl_class" href="classRange.html">Range</a>(edges[1], edges[1]));</div>
<div class="line">                <span class="keyword">auto</span> edges_conn = intersect(intersect(edge0_conn, edge1_conn),</div>
<div class="line">                                            crack_skin_nodes); <span class="comment">// node at apex</span></div>
<div class="line">                <span class="keywordflow">if</span> (edges_conn.size() == 1) {</div>
<div class="line"> </div>
<div class="line">                  <span class="keyword">auto</span> node_edges =</div>
<div class="line">                      subtract(intersect(get_adj(edges_conn, 1,</div>
<div class="line">                                                 moab::Interface::INTERSECT),</div>
<div class="line">                                         crack_faces_edges),</div>
<div class="line">                               crack_skin); <span class="comment">// nodes on crack surface, but not</span></div>
<div class="line">                                            <span class="comment">// at the skin</span></div>
<div class="line"> </div>
<div class="line">                  <span class="keywordflow">if</span> (node_edges.size()) {</div>
<div class="line">                    <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_v0;</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(edges_conn, &amp;t_v0(0));</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">auto</span> get_t_dir = [&amp;](<span class="keyword">auto</span> e_conn) {</div>
<div class="line">                      <span class="keyword">auto</span> other_node = subtract(e_conn, edges_conn);</div>
<div class="line">                      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_dir;</div>
<div class="line">                      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(other_node,</div>
<div class="line">                                                          &amp;t_dir(0));</div>
<div class="line">                      t_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) -= t_v0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                      <span class="keywordflow">return</span> t_dir;</div>
<div class="line">                    };</div>
<div class="line"> </div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_ave_dir;</div>
<div class="line">                    t_ave_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) =</div>
<div class="line">                        get_t_dir(edge0_conn)(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + get_t_dir(edge1_conn)(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_crack_surface_ave_dir;</div>
<div class="line">                    t_crack_surface_ave_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = 0;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : node_edges) {</div>
<div class="line">                      <span class="keyword">auto</span> e_conn = get_nodes(<a class="code hl_class" href="classRange.html">Range</a>(e, e));</div>
<div class="line">                      <span class="keyword">auto</span> t_dir = get_t_dir(e_conn);</div>
<div class="line">                      t_crack_surface_ave_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += t_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    }</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">auto</span> dot = t_ave_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_crack_surface_ave_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    <span class="comment">// ave edges is in opposite direction to crack surface, so</span></div>
<div class="line">                    <span class="comment">// thus crack is not turning back</span></div>
<div class="line">                    <span class="keywordflow">if</span> (dot &lt; -std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">                      crack_faces.insert(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>);</div>
<div class="line">                    }</div>
<div class="line">                  } <span class="keywordflow">else</span> {</div>
<div class="line">                    crack_faces.insert(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>);</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (edges.size() == 3) {</div>
<div class="line">              crack_faces.insert(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// if other edge is part of geometry edge, e.g. keyway</span></div>
<div class="line">            <span class="keywordflow">if</span> (edges.size() == 1) {</div>
<div class="line">              edges.merge(</div>
<div class="line">                  intersect(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>), 1, moab::Interface::UNION),</div>
<div class="line">                            geometry_edges));</div>
<div class="line">              edges.merge(</div>
<div class="line">                  intersect(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>), 1, moab::Interface::UNION),</div>
<div class="line">                            front_block_edges));</div>
<div class="line">              <span class="keywordflow">if</span> (edges.size() == 2) {</div>
<div class="line">                crack_faces.insert(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>);</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          crack_faces_org = crack_faces;</div>
<div class="line"> </div>
<div class="line">        } <span class="keywordflow">while</span> (s != crack_faces.size());</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> crack_faces; <span class="comment">// send_type(mField, crack_faces, MBTRI);</span></div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> get_faces_of_crack_front_verts(get_crack_faces());</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;new_crack_surface_debug.vtk&quot;</span>,</div>
<div class="line">                      get_extended_crack_faces());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> reconstruct_crack_faces = [&amp;](<span class="keyword">auto</span> crack_faces) {</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> impl = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> new_crack_faces;</div>
<div class="line">      <span class="keywordflow">if</span> (!pcomm-&gt;rank()) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_nodes = [&amp;](<span class="keyword">auto</span> &amp;&amp;e) {</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> nodes;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, nodes, <span class="keyword">true</span>),</div>
<div class="line">                         <span class="stringliteral">&quot;get connectivity&quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> nodes;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> &amp;&amp;e, <span class="keyword">auto</span> dim,</div>
<div class="line">                           <span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> = moab::Interface::UNION) {</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> adj;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">              <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(e, dim, <span class="keyword">true</span>, adj, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>),</div>
<div class="line">              <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> adj;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_test_on_crack_surface = [&amp;]() {</div>
<div class="line">          <span class="keyword">auto</span> crack_faces_nodes =</div>
<div class="line">              get_nodes(crack_faces); <span class="comment">// nodes on crac faces</span></div>
<div class="line">          <span class="keyword">auto</span> crack_faces_tets =</div>
<div class="line">              get_adj(crack_faces_nodes, 3,</div>
<div class="line">                      moab::Interface::UNION); <span class="comment">// adjacent</span></div>
<div class="line">                                               <span class="comment">// tets to</span></div>
<div class="line">                                               <span class="comment">// crack</span></div>
<div class="line">                                               <span class="comment">// faces throug nodes</span></div>
<div class="line">          <span class="keyword">auto</span> crack_faces_tets_nodes =</div>
<div class="line">              get_nodes(crack_faces_tets); <span class="comment">// nodes on crack faces tets</span></div>
<div class="line">          crack_faces_tets_nodes =</div>
<div class="line">              subtract(crack_faces_tets_nodes, crack_faces_nodes);</div>
<div class="line">          crack_faces_tets =</div>
<div class="line">              subtract(crack_faces_tets, get_adj(crack_faces_tets_nodes, 3,</div>
<div class="line">                                                 moab::Interface::UNION));</div>
<div class="line">          new_crack_faces =</div>
<div class="line">              get_adj(crack_faces_tets, 2,</div>
<div class="line">                      moab::Interface::UNION); <span class="comment">// adjacency faces to crack</span></div>
<div class="line">                                               <span class="comment">// faces through tets</span></div>
<div class="line">          new_crack_faces.merge(crack_faces);  <span class="comment">// add original crack faces</span></div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> std::make_tuple(new_crack_faces, crack_faces_tets);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> carck_faces_test_edges = [&amp;](<span class="keyword">auto</span> faces, <span class="keyword">auto</span> tets) {</div>
<div class="line">          <span class="keyword">auto</span> adj_tets_faces = get_adj(tets, 2, moab::Interface::UNION);</div>
<div class="line">          <span class="keyword">auto</span> adj_faces_edges = get_adj(subtract(faces, adj_tets_faces), 1,</div>
<div class="line">                                         moab::Interface::UNION);</div>
<div class="line">          <span class="keyword">auto</span> adj_tets_edges = get_adj(tets, 1, moab::Interface::UNION);</div>
<div class="line">          <span class="keyword">auto</span> geometry_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;EDGES&quot;</span>, 1);</div>
<div class="line">          <span class="keyword">auto</span> front_block_edges = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;FRONT&quot;</span>, 1);</div>
<div class="line">          adj_faces_edges.merge(geometry_edges);    <span class="comment">// geometry edges</span></div>
<div class="line">          adj_faces_edges.merge(front_block_edges); <span class="comment">// front block edges</span></div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> boundary_tets_edges = intersect(adj_tets_edges, adj_faces_edges);</div>
<div class="line">          <span class="keyword">auto</span> boundary_test_nodes = get_nodes(boundary_tets_edges);</div>
<div class="line">          <span class="keyword">auto</span> boundary_test_nodes_edges =</div>
<div class="line">              get_adj(boundary_test_nodes, 1, moab::Interface::UNION);</div>
<div class="line">          <span class="keyword">auto</span> boundary_test_nodes_edges_nodes = subtract(</div>
<div class="line">              get_nodes(boundary_test_nodes_edges), boundary_test_nodes);</div>
<div class="line"> </div>
<div class="line">          boundary_tets_edges =</div>
<div class="line">              subtract(boundary_test_nodes_edges,</div>
<div class="line">                       get_adj(boundary_test_nodes_edges_nodes, 1,</div>
<div class="line">                               moab::Interface::UNION));</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                             body_ents);</div>
<div class="line">          <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> body_skin_edges = get_adj(body_skin, 1, moab::Interface::UNION);</div>
<div class="line">          body_skin_edges = intersect(get_adj(tets, 1, moab::Interface::UNION),</div>
<div class="line">                                      body_skin_edges);</div>
<div class="line">          body_skin = intersect(body_skin, adj_tets_faces);</div>
<div class="line">          body_skin_edges = subtract(</div>
<div class="line">              body_skin_edges, get_adj(body_skin, 1, moab::Interface::UNION));</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;body_skin_edges.vtk&quot;</span>, body_skin_edges);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : body_skin_edges) {</div>
<div class="line">            <span class="keyword">auto</span> adj_tet = intersect(</div>
<div class="line">                get_adj(<a class="code hl_class" href="classRange.html">Range</a>(e, e), 3, moab::Interface::INTERSECT), tets);</div>
<div class="line">            <span class="keywordflow">if</span> (adj_tet.size() == 1) {</div>
<div class="line">              boundary_tets_edges.insert(e);</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> boundary_tets_edges;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> p = get_test_on_crack_surface();</div>
<div class="line">        <span class="keyword">auto</span> &amp;[new_crack_faces, crack_faces_tets] = p;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;hole_crack_faces_debug.vtk&quot;</span>,</div>
<div class="line">                            crack_faces);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;new_crack_faces_debug.vtk&quot;</span>,</div>
<div class="line">                            new_crack_faces);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;new_crack_tets_debug.vtk&quot;</span>,</div>
<div class="line">                            crack_faces_tets);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> boundary_tets_edges =</div>
<div class="line">            carck_faces_test_edges(new_crack_faces, crack_faces_tets);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;boundary_tets_edges.vtk&quot;</span>,</div>
<div class="line">                          boundary_tets_edges);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> resolve_surface = [&amp;](<span class="keyword">auto</span> boundary_tets_edges,</div>
<div class="line">                                   <span class="keyword">auto</span> crack_faces_tets) {</div>
<div class="line">          <span class="keyword">auto</span> boundary_tets_edges_nodes = get_nodes(boundary_tets_edges);</div>
<div class="line">          <span class="keyword">auto</span> crack_faces_tets_faces =</div>
<div class="line">              get_adj(crack_faces_tets, 2, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> all_removed_faces;</div>
<div class="line">          <a class="code hl_class" href="classRange.html">Range</a> all_removed_tets;</div>
<div class="line">          <span class="keywordtype">int</span> counter = 0;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> size = 0;</div>
<div class="line">          <span class="keywordflow">while</span> (size != crack_faces_tets.size()) {</div>
<div class="line">            <span class="keyword">auto</span> tets_faces =</div>
<div class="line">                get_adj(crack_faces_tets, 2, moab::Interface::UNION);</div>
<div class="line">            <span class="keyword">auto</span> skin_tets = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, crack_faces_tets);</div>
<div class="line">            <span class="keyword">auto</span> skin_skin =</div>
<div class="line">                <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, subtract(crack_faces_tets_faces, tets_faces));</div>
<div class="line">            <span class="keyword">auto</span> skin_skin_nodes = get_nodes(skin_skin);</div>
<div class="line"> </div>
<div class="line">            size = crack_faces_tets.size();</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::inform)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Crack faces tets size &quot;</span> &lt;&lt; crack_faces_tets.size()</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; crack faces size &quot;</span> &lt;&lt; crack_faces_tets_faces.size();</div>
<div class="line">            <span class="keyword">auto</span> skin_tets_nodes = subtract(</div>
<div class="line">                get_nodes(skin_tets),</div>
<div class="line">                boundary_tets_edges_nodes); <span class="comment">// not remove tets which are</span></div>
<div class="line">                                            <span class="comment">// adjagasent to crack faces nodes</span></div>
<div class="line">            skin_tets_nodes = subtract(skin_tets_nodes, skin_skin_nodes);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> removed_nodes;</div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> tets_to_remove;</div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> faces_to_remove;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> : skin_tets_nodes) {</div>
<div class="line">              <span class="keyword">auto</span> tets =</div>
<div class="line">                  intersect(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>), 3, moab::Interface::INTERSECT),</div>
<div class="line">                            crack_faces_tets);</div>
<div class="line">              <span class="keywordflow">if</span> (tets.size() == 0) {</div>
<div class="line">                <span class="keywordflow">continue</span>;</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> hole_detetction = [&amp;]() {</div>
<div class="line">                <span class="keyword">auto</span> adj_tets =</div>
<div class="line">                    get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>), 3, moab::Interface::INTERSECT);</div>
<div class="line">                adj_tets =</div>
<div class="line">                    subtract(adj_tets,</div>
<div class="line">                             crack_faces_tets); <span class="comment">// tetst adjacent to the node</span></div>
<div class="line">                                                <span class="comment">// but not part of crack surface</span></div>
<div class="line">                <span class="keywordflow">if</span> (adj_tets.size() == 0) {</div>
<div class="line">                  <span class="keywordflow">return</span> std::make_pair(</div>
<div class="line">                      intersect(</div>
<div class="line">                          get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>), 2, moab::Interface::INTERSECT),</div>
<div class="line">                          tets_faces),</div>
<div class="line">                      tets);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                std::vector&lt;Range&gt; tets_groups;</div>
<div class="line">                <span class="keyword">auto</span> test_adj_tets = adj_tets;</div>
<div class="line">                <span class="keywordflow">while</span> (test_adj_tets.size()) {</div>
<div class="line">                  <span class="keyword">auto</span> seed_size = 0;</div>
<div class="line">                  <a class="code hl_class" href="classRange.html">Range</a> seed = <a class="code hl_class" href="classRange.html">Range</a>(test_adj_tets[0], test_adj_tets[0]);</div>
<div class="line">                  <span class="keywordflow">while</span> (seed.size() != seed_size) {</div>
<div class="line">                    <span class="keyword">auto</span> adj_faces =</div>
<div class="line">                        subtract(get_adj(seed, 2, moab::Interface::UNION),</div>
<div class="line">                                 tets_faces); <span class="comment">// edges which are not</span></div>
<div class="line">                                              <span class="comment">// part of the node</span></div>
<div class="line">                    seed_size = seed.size();</div>
<div class="line">                    seed.merge(</div>
<div class="line">                        intersect(get_adj(adj_faces, 3, moab::Interface::UNION),</div>
<div class="line">                                  test_adj_tets ));</div>
<div class="line">                  }</div>
<div class="line">                  tets_groups.push_back(seed);</div>
<div class="line">                  test_adj_tets = subtract(test_adj_tets, seed);</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">if</span> (tets_groups.size() == 1) {</div>
<div class="line"> </div>
<div class="line">                  <span class="keywordflow">return</span> std::make_pair(</div>
<div class="line">                      intersect(</div>
<div class="line">                          get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>), 2, moab::Interface::INTERSECT),</div>
<div class="line">                          tets_faces),</div>
<div class="line">                      tets);</div>
<div class="line"> </div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_class" href="classRange.html">Range</a> tets_to_remove;</div>
<div class="line">                <a class="code hl_class" href="classRange.html">Range</a> faces_to_remove;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;r : tets_groups) {</div>
<div class="line">                  <span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> = get_adj(r, 2, moab::Interface::UNION);</div>
<div class="line">                  <span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> = intersect(get_adj(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, 3, moab::Interface::UNION),</div>
<div class="line">                                     crack_faces_tets); <span class="comment">// tets</span></div>
<div class="line"> </div>
<div class="line">                  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>.size() &gt; faces_to_remove.size() ||</div>
<div class="line">                      faces_to_remove.size() == 0) {</div>
<div class="line">                    faces_to_remove = <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>;</div>
<div class="line">                    tets_to_remove = <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>; <span class="comment">// largest group of tets</span></div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                    &lt;&lt; <span class="stringliteral">&quot;Hole detection: faces to remove &quot;</span></div>
<div class="line">                    &lt;&lt; faces_to_remove.size() &lt;&lt; <span class="stringliteral">&quot; tets to remove &quot;</span></div>
<div class="line">                    &lt;&lt; tets_to_remove.size();</div>
<div class="line">                <span class="keywordflow">return</span> std::make_pair(faces_to_remove, tets_to_remove);</div>
<div class="line">              };</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (tets.size() &lt; tets_to_remove.size() ||</div>
<div class="line">                  tets_to_remove.size() == 0) {</div>
<div class="line">                removed_nodes = <a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line">                <span class="keyword">auto</span> [h_faces_to_remove, h_tets_to_remove] =</div>
<div class="line">                    hole_detetction(); <span class="comment">// find faces and tets to remove</span></div>
<div class="line">                faces_to_remove = h_faces_to_remove;</div>
<div class="line">                tets_to_remove = h_tets_to_remove;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// intersect(</span></div>
<div class="line">                <span class="comment">//     get_adj(Range(n, n), 2, moab::Interface::INTERSECT),</span></div>
<div class="line">                <span class="comment">//     tets_faces);</span></div>
<div class="line"> </div>
<div class="line">              } <span class="comment">// find tets which is largest adjacencty size, so that it is</span></div>
<div class="line">                <span class="comment">// removed first, and then faces are removed</span></div>
<div class="line">              all_removed_faces.merge(faces_to_remove);</div>
<div class="line">              all_removed_tets.merge(tets_to_remove);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            crack_faces_tets = subtract(crack_faces_tets, tets_to_remove);</div>
<div class="line">            crack_faces_tets_faces =</div>
<div class="line">                subtract(crack_faces_tets_faces, faces_to_remove);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">              <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                         <span class="stringliteral">&quot;removed_nodes_&quot;</span> +</div>
<div class="line">                             boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                         removed_nodes);</div>
<div class="line">              <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                         <span class="stringliteral">&quot;faces_to_remove_&quot;</span> +</div>
<div class="line">                             boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                         faces_to_remove);</div>
<div class="line">              <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                         <span class="stringliteral">&quot;tets_to_remove_&quot;</span> +</div>
<div class="line">                             boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                         tets_to_remove);</div>
<div class="line">              <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                         <span class="stringliteral">&quot;crack_faces_tets_faces_&quot;</span> +</div>
<div class="line">                             boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                         crack_faces_tets_faces);</div>
<div class="line">              <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                         <span class="stringliteral">&quot;crack_faces_tets_&quot;</span> +</div>
<div class="line">                             boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                         crack_faces_tets);</div>
<div class="line">            }</div>
<div class="line">            counter++;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> cese_internal_faces = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">            <span class="keyword">auto</span> skin_tets = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, crack_faces_tets);</div>
<div class="line">            <span class="keyword">auto</span> adj_faces = get_adj(skin_tets, 2, moab::Interface::UNION);</div>
<div class="line">            adj_faces =</div>
<div class="line">                subtract(adj_faces, skin_tets); <span class="comment">// remove skin tets faces</span></div>
<div class="line">            <span class="keyword">auto</span> adj_tets = get_adj(adj_faces, 3,</div>
<div class="line">                                    moab::Interface::UNION); <span class="comment">// tets which are</span></div>
<div class="line">                                                             <span class="comment">// adjacent to skin</span></div>
<div class="line">            crack_faces_tets =</div>
<div class="line">                subtract(crack_faces_tets,</div>
<div class="line">                         adj_tets); <span class="comment">// remove tets which are adjacent to</span></div>
<div class="line">                                    <span class="comment">// skin, so that they are not removed</span></div>
<div class="line">            crack_faces_tets_faces =</div>
<div class="line">                subtract(crack_faces_tets_faces, adj_faces);</div>
<div class="line"> </div>
<div class="line">            all_removed_faces.merge(adj_faces);</div>
<div class="line">            all_removed_tets.merge(adj_tets);</div>
<div class="line">            </div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Remove internal faces size &quot;</span> &lt;&lt; adj_faces.size()</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; tets size &quot;</span> &lt;&lt; adj_tets.size();</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> case_only_one_free_edge = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : <a class="code hl_class" href="classRange.html">Range</a>(crack_faces_tets)) {</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> adj_faces = get_adj(</div>
<div class="line">                  <a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>), 2,</div>
<div class="line">                  moab::Interface::UNION); <span class="comment">// faces of tet which can be removed</span></div>
<div class="line">              <span class="keyword">auto</span> crack_surface_edges =</div>
<div class="line">                  get_adj(subtract(unite(crack_faces_tets_faces, crack_faces),</div>
<div class="line">                                   adj_faces),</div>
<div class="line">                          1,</div>
<div class="line">                          moab::Interface::UNION); <span class="comment">// edges not on the tet but</span></div>
<div class="line">                                                   <span class="comment">// on crack surface</span></div>
<div class="line">              <span class="keyword">auto</span> adj_edges =</div>
<div class="line">                  subtract(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>), 1, moab::Interface::INTERSECT),</div>
<div class="line">                           crack_surface_edges); <span class="comment">// free edges</span></div>
<div class="line">              adj_edges = subtract(</div>
<div class="line">                  adj_edges,</div>
<div class="line">                  boundary_tets_edges); <span class="comment">// edges which are not part of gemetry</span></div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (adj_edges.size() == 1) {</div>
<div class="line">                crack_faces_tets =</div>
<div class="line">                    subtract(crack_faces_tets,</div>
<div class="line">                             <a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>)); <span class="comment">// remove tets which are adjacent to</span></div>
<div class="line">                                           <span class="comment">// skin, so that they are not removed</span></div>
<div class="line"> </div>
<div class="line">                <span class="keyword">auto</span> faces_to_remove =</div>
<div class="line">                    get_adj(adj_edges, 2, moab::Interface::UNION); <span class="comment">// faces</span></div>
<div class="line">                                                                   <span class="comment">// which can</span></div>
<div class="line">                                                                   <span class="comment">// be removed</span></div>
<div class="line">                crack_faces_tets_faces =</div>
<div class="line">                    subtract(crack_faces_tets_faces, faces_to_remove);</div>
<div class="line"> </div>
<div class="line">                all_removed_faces.merge(faces_to_remove);</div>
<div class="line">                all_removed_tets.merge(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>));</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Remove free one edges &quot;</span>;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            crack_faces_tets = subtract(crack_faces_tets, all_removed_tets);</div>
<div class="line">            crack_faces_tets_faces =</div>
<div class="line">                subtract(crack_faces_tets_faces, all_removed_faces);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> cese_flat_tet = [&amp;](<span class="keyword">auto</span> max_adj_edges) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="classRange.html">Range</a> body_ents;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                               body_ents);</div>
<div class="line">            <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line">            <span class="keyword">auto</span> body_skin_edges =</div>
<div class="line">                get_adj(body_skin, 1, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : <a class="code hl_class" href="classRange.html">Range</a>(crack_faces_tets)) {</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> adj_faces = get_adj(</div>
<div class="line">                  <a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>), 2,</div>
<div class="line">                  moab::Interface::UNION); <span class="comment">// faces of tet which can be removed</span></div>
<div class="line">              <span class="keyword">auto</span> crack_surface_edges =</div>
<div class="line">                  get_adj(subtract(unite(crack_faces_tets_faces, crack_faces),</div>
<div class="line">                                   adj_faces),</div>
<div class="line">                          1,</div>
<div class="line">                          moab::Interface::UNION); <span class="comment">// edges not on the tet but</span></div>
<div class="line">                                                   <span class="comment">// on crack surface</span></div>
<div class="line">              <span class="keyword">auto</span> adj_edges =</div>
<div class="line">                  subtract(get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>), 1, moab::Interface::INTERSECT),</div>
<div class="line">                           crack_surface_edges); <span class="comment">// free edges</span></div>
<div class="line">              adj_edges = subtract(adj_edges, body_skin_edges);</div>
<div class="line"> </div>
<div class="line">              <span class="keyword">auto</span> tet_edges = get_adj(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>), 1,</div>
<div class="line">                                          moab::Interface::UNION); <span class="comment">// edges of</span></div>
<div class="line">                                                                    <span class="comment">// tet</span></div>
<div class="line">              tet_edges = subtract(tet_edges, adj_edges);</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : tet_edges) {</div>
<div class="line">                <span class="keyword">constexpr</span> <span class="keywordtype">int</span> opposite_edge[] = {5, 3, 4, 1, 2, 0};</div>
<div class="line">                <span class="keyword">auto</span> get_side = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">                  <span class="keywordtype">int</span> side, sense, offset;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">                      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, e, side, sense, offset),</div>
<div class="line">                      <span class="stringliteral">&quot;get side number failed&quot;</span>);</div>
<div class="line">                  <span class="keywordflow">return</span> side;</div>
<div class="line">                };</div>
<div class="line">                <span class="keyword">auto</span> get_side_ent = [&amp;](<span class="keyword">auto</span> side) {</div>
<div class="line">                  EntityHandle side_edge;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">                      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, 1, side, side_edge),</div>
<div class="line">                      <span class="stringliteral">&quot;get side failed&quot;</span>);</div>
<div class="line">                  <span class="keywordflow">return</span> side_edge;</div>
<div class="line">                };</div>
<div class="line">                adj_edges.erase(get_side_ent(opposite_edge[get_side(e)]));</div>
<div class="line">              }</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (adj_edges.size() &lt;= max_adj_edges) {</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">double</span> dot = 1;</div>
<div class="line">                <a class="code hl_class" href="classRange.html">Range</a> faces_to_remove;</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : adj_edges) {</div>
<div class="line">                  <span class="keyword">auto</span> edge_adj_faces =</div>
<div class="line">                      get_adj(<a class="code hl_class" href="classRange.html">Range</a>(e, e), 2, moab::Interface::UNION);</div>
<div class="line">                  edge_adj_faces = intersect(edge_adj_faces, adj_faces);</div>
<div class="line">                  <span class="keywordflow">if</span> (edge_adj_faces.size() != 2) {</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                      <span class="stringliteral">&quot;Adj faces size is not 2 for edge &quot;</span> +</div>
<div class="line">                                          boost::lexical_cast&lt;std::string&gt;(e));</div>
<div class="line">                  }</div>
<div class="line"> </div>
<div class="line">                  <span class="keyword">auto</span> get_normal = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>) {</div>
<div class="line">                    <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_n;</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">                        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;<a id="a362" name="a362"></a><a class="code hl_function" href="structMoFEM_1_1Tools.html#a7ec3e255948d70b798459a3021761d5b">getTriNormal</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, &amp;t_n(0)),</div>
<div class="line">                        <span class="stringliteral">&quot;get tri normal failed&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> t_n;</div>
<div class="line">                  };</div>
<div class="line">                  <span class="keyword">auto</span> t_n0 = get_normal(edge_adj_faces[0]);</div>
<div class="line">                  <span class="keyword">auto</span> t_n1 = get_normal(edge_adj_faces[1]);</div>
<div class="line">                  <span class="keyword">auto</span> get_sense = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>) {</div>
<div class="line">                    <span class="keywordtype">int</span> side, sense, offset;</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>, side,</div>
<div class="line">                                                                 sense, offset),</div>
<div class="line">                                   <span class="stringliteral">&quot;get side number failed&quot;</span>);</div>
<div class="line">                    <span class="keywordflow">return</span> sense;</div>
<div class="line">                  };</div>
<div class="line">                  <span class="keyword">auto</span> sense0 = get_sense(edge_adj_faces[0]);</div>
<div class="line">                  <span class="keyword">auto</span> sense1 = get_sense(edge_adj_faces[1]);</div>
<div class="line">                  t_n0.normalize();</div>
<div class="line">                  t_n1.normalize();</div>
<div class="line"> </div>
<div class="line">                  <a class="code hl_define" href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                  <span class="keyword">auto</span> dot_e = (sense0 * sense1) * t_n0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_n1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                  <span class="keywordflow">if</span> (dot_e &lt; dot || e == adj_edges[0]) {</div>
<div class="line">                    dot = dot_e;</div>
<div class="line">                    faces_to_remove = edge_adj_faces;</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                all_removed_faces.merge(faces_to_remove);</div>
<div class="line">                all_removed_tets.merge(<a class="code hl_class" href="classRange.html">Range</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>));</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">                    &lt;&lt; <span class="stringliteral">&quot;Remove free edges on flat tet, with considered nb. of &quot;</span></div>
<div class="line">                       <span class="stringliteral">&quot;edges &quot;</span></div>
<div class="line">                    &lt;&lt; adj_edges.size();</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            crack_faces_tets = subtract(crack_faces_tets, all_removed_tets);</div>
<div class="line">            crack_faces_tets_faces =</div>
<div class="line">                subtract(crack_faces_tets_faces, all_removed_faces);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(case_only_one_free_edge(),</div>
<div class="line">                            <span class="stringliteral">&quot;Case only one free edge failed&quot;</span>);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> max_adj_edges : {0, 1, 2, 3}) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(cese_flat_tet(max_adj_edges),</div>
<div class="line">                              <span class="stringliteral">&quot;Case only one free edge failed&quot;</span>);</div>
<div class="line">          }</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(cese_internal_faces(),</div>
<div class="line">                            <span class="stringliteral">&quot;Case internal faces failed&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">            <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                       <span class="stringliteral">&quot;crack_faces_tets_faces_&quot;</span> +</div>
<div class="line">                           boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                       crack_faces_tets_faces);</div>
<div class="line">            <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                       <span class="stringliteral">&quot;crack_faces_tets_&quot;</span> +</div>
<div class="line">                           boost::lexical_cast&lt;std::string&gt;(counter) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                       crack_faces_tets);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">return</span> std::make_tuple(crack_faces_tets_faces, crack_faces_tets,</div>
<div class="line">                                 all_removed_faces, all_removed_tets);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> [resolved_faces, resolved_tets, all_removed_faces,</div>
<div class="line">              all_removed_tets] =</div>
<div class="line">            resolve_surface(boundary_tets_edges, crack_faces_tets);</div>
<div class="line">        resolved_faces.merge(subtract(crack_faces, all_removed_faces));</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;resolved_faces.vtk&quot;</span>,</div>
<div class="line">                            resolved_faces);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;resolved_tets.vtk&quot;</span>,</div>
<div class="line">                            resolved_tets);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        crack_faces = resolved_faces;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(impl(), <span class="stringliteral">&quot;resolve new crack surfaces&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> crack_faces; <span class="comment">// send_type(mField, crack_faces, MBTRI);</span></div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> resolve_consisten_crack_extension = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> crack_meshset =</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(</div>
<div class="line">            <a class="code hl_variable" href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>);</div>
<div class="line">    <span class="keyword">auto</span> meshset = crack_meshset-&gt;getMeshset();</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> old_crack_faces;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(meshset, MBTRI,</div>
<div class="line">                                                    old_crack_faces);</div>
<div class="line">      <span class="keyword">auto</span> extendeded_crack_faces = get_extended_crack_faces();</div>
<div class="line">      <span class="keyword">auto</span> reconstructed_crack_faces =</div>
<div class="line">          subtract(reconstruct_crack_faces(extendeded_crack_faces),</div>
<div class="line">                   subtract(*<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, old_crack_faces));</div>
<div class="line">      <span class="keywordflow">if</span> (<a id="a363" name="a363"></a><a class="code hl_variable" href="structEshelbianCore.html#a394869ab1071f6b21a9f74c3ba2ccdd5">nbCrackFaces</a> &gt;= reconstructed_crack_faces.size()) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::warning)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;No new crack faces to add, skipping adding to meshset&quot;</span>;</div>
<div class="line">        extendeded_crack_faces = subtract(</div>
<div class="line">            extendeded_crack_faces, subtract(*<a class="code hl_variable" href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, old_crack_faces));</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Number crack faces size (extended) &quot;</span></div>
<div class="line">            &lt;&lt; extendeded_crack_faces.size();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().clear_meshset(&amp;meshset, 1);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset, extendeded_crack_faces);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().clear_meshset(&amp;meshset, 1);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset,</div>
<div class="line">                                              reconstructed_crack_faces);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSELF&quot;</span>, Sev::inform)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Number crack faces size (reconstructed) &quot;</span></div>
<div class="line">            &lt;&lt; reconstructed_crack_faces.size();</div>
<div class="line">        <a class="code hl_variable" href="structEshelbianCore.html#a394869ab1071f6b21a9f74c3ba2ccdd5">nbCrackFaces</a> = reconstructed_crack_faces.size();</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> crack_faces;</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(meshset, MBTRI,</div>
<div class="line">                                                    crack_faces);</div>
<div class="line">    }</div>
<div class="line">    crack_faces = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a559a80330b1f767e8e9b59d89a31eac5">send_type</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, crack_faces, MBTRI);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().clear_meshset(&amp;meshset, 1);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset, crack_faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> resolve_consisten_crack_extension();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a364" name="a364"></a><a class="code hl_function" href="structEshelbianCore.html#ad4d96dc6ab5dd848b7d8eebf1a08030b">EshelbianCore::saveOrgCoords</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> crack_faces =</div>
<div class="line">      <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CRACK_COMPUTED&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> conn;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(crack_faces, conn, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(0, MBVERTEX, verts);</div>
<div class="line">  verts = subtract(verts, conn);</div>
<div class="line">  std::vector&lt;double&gt; coords(3 * verts.size());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(verts, coords.data());</div>
<div class="line">  <span class="keywordtype">double</span> def_coords[] = {0., 0., 0.};</div>
<div class="line">  Tag th_org_coords;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(</div>
<div class="line">      <span class="stringliteral">&quot;ORG_COORDS&quot;</span>, 3, MB_TYPE_DOUBLE, th_org_coords,</div>
<div class="line">      MB_TAG_CREAT | MB_TAG_DENSE, def_coords);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_org_coords, verts, coords.data());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a365" name="a365"></a><a class="code hl_function" href="structEshelbianCore.html#a113994efe4dd1803d84aeab5c6230096">EshelbianCore::createCrackSurfaceMeshset</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> meshset_mng = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <span class="keywordflow">while</span> (meshset_mng-&gt;checkMeshset(<a class="code hl_variable" href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line">    ++<a class="code hl_variable" href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Crack added surface meshset &quot;</span> &lt;&lt; <a class="code hl_variable" href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> meshset_mng-&gt;<a id="a366" name="a366"></a><a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>, <span class="stringliteral">&quot;CRACK_COMPUTED&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structEshelbianCore.html#a7980928dbcfa5bf174ac19e22784fe95">EshelbianCore::gettingNorms</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_fe =</div>
<div class="line">      boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_rule_hook = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) -&gt; <span class="keywordtype">int</span> {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * (p);</div>
<div class="line">  };</div>
<div class="line">  post_proc_norm_fe-&gt;getRuleHook = post_proc_norm_rule_hook;</div>
<div class="line"> </div>
<div class="line">  post_proc_norm_fe-&gt;getUserPolynomialBase() =</div>
<div class="line">      boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">      post_proc_norm_fe-&gt;getOpPtrVector(), {L2, H1, HDIV}, <a class="code hl_variable" href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> NORMS { U_NORM_L2 = 0, U_NORM_H1, PIOLA_NORM, U_ERROR_L2, LAST_NORM };</div>
<div class="line">  <span class="keyword">auto</span> norms_vec =</div>
<div class="line">      <a class="code hl_function" href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">createVectorMPI</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), LAST_NORM, PETSC_DETERMINE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(norms_vec);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> u_l2_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, u_l2_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a id="_a367" name="_a367"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_l2_ptr, norms_vec, U_NORM_L2));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_h1_ptr, norms_vec, U_NORM_H1));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_l2_ptr, norms_vec, U_ERROR_L2,</div>
<div class="line">                                         u_h1_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> piola_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, piola_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(<a class="code hl_variable" href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, piola_ptr,</div>
<div class="line">                                              MBMAXTYPE));</div>
<div class="line"> </div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a id="_a368" name="_a368"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalcNormL2Tensor2.html">OpCalcNormL2Tensor2&lt;3, 3&gt;</a>(piola_ptr, norms_vec, PIOLA_NORM));</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;({post_proc_norm_fe.get()});</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a369" name="a369"></a><a class="code hl_function" href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">loop_finite_elements</a>(<span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>,</div>
<div class="line">                                     *post_proc_norm_fe);</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;({post_proc_norm_fe.get()});</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(norms_vec);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(norms_vec);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> *norms;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(norms_vec, &amp;norms);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;norm_u: &quot;</span> &lt;&lt; std::sqrt(norms[U_NORM_L2]);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;norm_u_h1: &quot;</span> &lt;&lt; std::sqrt(norms[U_NORM_H1]);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;norm_error_u_l2: &quot;</span> &lt;&lt; std::sqrt(norms[U_ERROR_L2]);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;norm_piola: &quot;</span> &lt;&lt; std::sqrt(norms[PIOLA_NORM]);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(norms_vec, &amp;norms);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a370" name="a370"></a><a class="code hl_function" href="structEshelbianCore.html#acd3d79e5922a80cab13f88ff96518c2a">EshelbianCore::getSpatialDispBc</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a371" name="_a371"></a><a class="code hl_struct" href="structMoFEM_1_1BcManager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;<a id="a372" name="a372"></a><a class="code hl_function" href="structMoFEM_1_1BcManager.html#ad0bbc182baa1622340dbf96ce6da5ef2">pushMarkDOFsOnEntities</a>&lt;<a id="_a373" name="_a373"></a><a class="code hl_struct" href="structMoFEM_1_1DisplacementCubitBcData.html">DisplacementCubitBcData</a>&gt;(</div>
<div class="line">      <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a> = boost::make_shared&lt;BcDispVec&gt;();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> disp_bc = bc.second-&gt;dispBcPtr) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> [<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, block_name] =</div>
<div class="line">          BcManager::extractStringFromBlockId(bc.first, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Field name: &quot;</span> &lt;&lt; <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> &lt;&lt; <span class="stringliteral">&quot; Block name: &quot;</span> &lt;&lt; block_name;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;Displacement BC: &quot;</span> &lt;&lt; *disp_bc;</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;double&gt; block_attributes(6, 0.);</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag1 == 1) {</div>
<div class="line">        block_attributes[0] = disp_bc-&gt;data.value1;</div>
<div class="line">        block_attributes[3] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag2 == 1) {</div>
<div class="line">        block_attributes[1] = disp_bc-&gt;data.value2;</div>
<div class="line">        block_attributes[4] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag3 == 1) {</div>
<div class="line">        block_attributes[2] = disp_bc-&gt;data.value3;</div>
<div class="line">        block_attributes[5] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> faces = bc.second-&gt;bcEnts.subset_by_dimension(2);</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>-&gt;emplace_back(block_name, block_attributes, faces);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// old way of naming blocksets for displacement BCs</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a374" name="a374"></a><a class="code hl_function" href="structEshelbianCore.html#a56636af14eb66349e0d1fce731e9206e">getBc</a>(<a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>, <span class="stringliteral">&quot;SPATIAL_DISP_BC&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a> =</div>
<div class="line">      boost::make_shared&lt;NormalDisplacementBcVec&gt;();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keyword">auto</span> block_name = <span class="stringliteral">&quot;(.*)NORMAL_DISPLACEMENT(.*)&quot;</span>;</div>
<div class="line">    std::regex reg_name(block_name);</div>
<div class="line">    <span class="keywordflow">if</span> (std::regex_match(bc.first, reg_name)) {</div>
<div class="line">      <span class="keyword">auto</span> [<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, block_name] =</div>
<div class="line">          BcManager::extractStringFromBlockId(bc.first, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Field name: &quot;</span> &lt;&lt; <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> &lt;&lt; <span class="stringliteral">&quot; Block name: &quot;</span> &lt;&lt; block_name;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>-&gt;emplace_back(</div>
<div class="line">          block_name, bc.second-&gt;bcAttributes,</div>
<div class="line">          bc.second-&gt;bcEnts.subset_by_dimension(2));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a> =</div>
<div class="line">      boost::make_shared&lt;AnalyticalDisplacementBcVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keyword">auto</span> block_name = <span class="stringliteral">&quot;(.*)ANALYTICAL_DISPLACEMENT(.*)&quot;</span>;</div>
<div class="line">    std::regex reg_name(block_name);</div>
<div class="line">    <span class="keywordflow">if</span> (std::regex_match(bc.first, reg_name)) {</div>
<div class="line">      <span class="keyword">auto</span> [<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, block_name] =</div>
<div class="line">          BcManager::extractStringFromBlockId(bc.first, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Field name: &quot;</span> &lt;&lt; <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> &lt;&lt; <span class="stringliteral">&quot; Block name: &quot;</span> &lt;&lt; block_name;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">bcSpatialAnalyticalDisplacementVecPtr</a>-&gt;emplace_back(</div>
<div class="line">          block_name, bc.second-&gt;bcAttributes,</div>
<div class="line">          bc.second-&gt;bcEnts.subset_by_dimension(2));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_displacement =</div>
<div class="line">      boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;disp_history.txt&quot;</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;bc : *<a class="code hl_variable" href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Add time scaling displacement BC: &quot;</span> &lt;&lt; bc.blockName;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>[bc.blockName] =</div>
<div class="line">        <a id="_a375" name="_a375"></a><a class="code hl_struct" href="structMoFEM_1_1GetBlockScalingMethod.html">GetBlockScalingMethod&lt;DynamicRelaxationTimeScale&gt;::get</a>(</div>
<div class="line">            ts_displacement, <span class="stringliteral">&quot;disp_history&quot;</span>, <span class="stringliteral">&quot;.txt&quot;</span>, bc.blockName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_normal_displacement =</div>
<div class="line">      boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;normal_disp_history.txt&quot;</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;bc : *<a class="code hl_variable" href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">bcSpatialNormalDisplacementVecPtr</a>) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Add time scaling normal displacement BC: &quot;</span> &lt;&lt; bc.blockName;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>[bc.blockName] =</div>
<div class="line">        <a class="code hl_struct" href="structMoFEM_1_1GetBlockScalingMethod.html">GetBlockScalingMethod&lt;DynamicRelaxationTimeScale&gt;::get</a>(</div>
<div class="line">            ts_normal_displacement, <span class="stringliteral">&quot;normal_disp_history&quot;</span>, <span class="stringliteral">&quot;.txt&quot;</span>,</div>
<div class="line">            bc.blockName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a376" name="a376"></a><a class="code hl_function" href="structEshelbianCore.html#abe81e33c3abf7e604dfafb99cac6eca4">EshelbianCore::getSpatialTractionBc</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1BcManager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1BcManager.html#ad0bbc182baa1622340dbf96ce6da5ef2">pushMarkDOFsOnEntities</a>&lt;<a id="_a377" name="_a377"></a><a class="code hl_struct" href="structMoFEM_1_1ForceCubitBcData.html">ForceCubitBcData</a>&gt;(<span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                          <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a> = boost::make_shared&lt;TractionBcVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> force_bc = bc.second-&gt;forceBcPtr) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> [<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, block_name] =</div>
<div class="line">          BcManager::extractStringFromBlockId(bc.first, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Field name: &quot;</span> &lt;&lt; <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> &lt;&lt; <span class="stringliteral">&quot; Block name: &quot;</span> &lt;&lt; block_name;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;Force BC: &quot;</span> &lt;&lt; *force_bc;</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;double&gt; block_attributes(6, 0.);</div>
<div class="line">      block_attributes[0] = -force_bc-&gt;data.value3 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[3] = 1;</div>
<div class="line">      block_attributes[1] = -force_bc-&gt;data.value4 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[4] = 1;</div>
<div class="line">      block_attributes[2] = -force_bc-&gt;data.value5 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[5] = 1;</div>
<div class="line">      <span class="keyword">auto</span> faces = bc.second-&gt;bcEnts.subset_by_dimension(2);</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>-&gt;emplace_back(block_name, block_attributes,</div>
<div class="line">                                            faces);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#a56636af14eb66349e0d1fce731e9206e">getBc</a>(<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>, <span class="stringliteral">&quot;SPATIAL_TRACTION_BC&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a> = boost::make_shared&lt;PressureBcVec&gt;();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keyword">auto</span> block_name = <span class="stringliteral">&quot;(.*)PRESSURE(.*)&quot;</span>;</div>
<div class="line">    std::regex reg_name(block_name);</div>
<div class="line">    <span class="keywordflow">if</span> (std::regex_match(bc.first, reg_name)) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> [<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, block_name] =</div>
<div class="line">          BcManager::extractStringFromBlockId(bc.first, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Field name: &quot;</span> &lt;&lt; <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> &lt;&lt; <span class="stringliteral">&quot; Block name: &quot;</span> &lt;&lt; block_name;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>-&gt;emplace_back(</div>
<div class="line">          block_name, bc.second-&gt;bcAttributes,</div>
<div class="line">          bc.second-&gt;bcEnts.subset_by_dimension(2));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a> =</div>
<div class="line">      boost::make_shared&lt;AnalyticalTractionBcVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keyword">auto</span> block_name = <span class="stringliteral">&quot;(.*)ANALYTICAL_TRACTION(.*)&quot;</span>;</div>
<div class="line">    std::regex reg_name(block_name);</div>
<div class="line">    <span class="keywordflow">if</span> (std::regex_match(bc.first, reg_name)) {</div>
<div class="line">      <span class="keyword">auto</span> [<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, block_name] =</div>
<div class="line">          BcManager::extractStringFromBlockId(bc.first, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Field name: &quot;</span> &lt;&lt; <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> &lt;&lt; <span class="stringliteral">&quot; Block name: &quot;</span> &lt;&lt; block_name;</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">bcSpatialAnalyticalTractionVecPtr</a>-&gt;emplace_back(</div>
<div class="line">          block_name, bc.second-&gt;bcAttributes,</div>
<div class="line">          bc.second-&gt;bcEnts.subset_by_dimension(2));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_traction =</div>
<div class="line">      boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;traction_history.txt&quot;</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;bc : *<a class="code hl_variable" href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">bcSpatialTractionVecPtr</a>) {</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>[bc.blockName] =</div>
<div class="line">        <a class="code hl_struct" href="structMoFEM_1_1GetBlockScalingMethod.html">GetBlockScalingMethod&lt;DynamicRelaxationTimeScale&gt;::get</a>(</div>
<div class="line">            ts_traction, <span class="stringliteral">&quot;traction_history&quot;</span>, <span class="stringliteral">&quot;.txt&quot;</span>, bc.blockName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_pressure =</div>
<div class="line">      boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;pressure_history.txt&quot;</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;bc : *<a class="code hl_variable" href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">bcSpatialPressureVecPtr</a>) {</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>[bc.blockName] =</div>
<div class="line">        <a class="code hl_struct" href="structMoFEM_1_1GetBlockScalingMethod.html">GetBlockScalingMethod&lt;DynamicRelaxationTimeScale&gt;::get</a>(</div>
<div class="line">            ts_pressure, <span class="stringliteral">&quot;pressure_history&quot;</span>, <span class="stringliteral">&quot;.txt&quot;</span>, bc.blockName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a378" name="a378"></a><a class="code hl_function" href="structEshelbianCore.html#abe428bafdc99ed99e87012f5726e825f">EshelbianCore::getExternalStrain</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="structEshelbianCore.html#abe428bafdc99ed99e87012f5726e825f">getExternalStrain</a> = [&amp;](boost::shared_ptr&lt;ExternalStrainVec&gt; &amp;ext_strain_vec_ptr,</div>
<div class="line">                             <span class="keyword">const</span> std::string block_name,</div>
<div class="line">                             <span class="keyword">const</span> <span class="keywordtype">int</span> nb_attributes) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> it : <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(</div>
<div class="line">             <a class="code hl_namespace" href="namespacestd.html">std</a>::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % block_name).str()))</div>
<div class="line">    ) {</div>
<div class="line">      std::vector&lt;double&gt; block_attributes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> it-&gt;getAttributes(block_attributes);</div>
<div class="line">      <span class="keywordflow">if</span> (block_attributes.size() &lt; nb_attributes) {</div>
<div class="line">        SETERRQ3(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;In block %s expected %d attributes, but given %ld&quot;</span>,</div>
<div class="line">                 it-&gt;getName().c_str(), nb_attributes, block_attributes.size());</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_block_ents = [&amp;]() {</div>
<div class="line">        <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_handle(it-&gt;meshset, ents,</div>
<div class="line">                                                        <span class="keyword">true</span>);</div>
<div class="line">        <span class="keywordflow">return</span> ents;</div>
<div class="line">      };</div>
<div class="line">      <span class="keyword">auto</span> Ents = get_block_ents();</div>
<div class="line">      ext_strain_vec_ptr-&gt;emplace_back(it-&gt;getName(), block_attributes,</div>
<div class="line">                               get_block_ents());</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a0ad247d6694e42cb585396f1f02aa1a3">externalStrainVecPtr</a> = boost::make_shared&lt;ExternalStrainVec&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structEshelbianCore.html#abe428bafdc99ed99e87012f5726e825f">getExternalStrain</a>(<a class="code hl_variable" href="structEshelbianCore.html#a0ad247d6694e42cb585396f1f02aa1a3">externalStrainVecPtr</a>, <span class="stringliteral">&quot;EXTERNALSTRAIN&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_pre_stretch =</div>
<div class="line">      boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;externalstrain_history.txt&quot;</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;ext_strain_block: *<a class="code hl_variable" href="structEshelbianCore.html#a0ad247d6694e42cb585396f1f02aa1a3">externalStrainVecPtr</a>) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Add time scaling external strain: &quot;</span> &lt;&lt; ext_strain_block.blockName;</div>
<div class="line">    <a class="code hl_variable" href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">timeScaleMap</a>[ext_strain_block.blockName] =</div>
<div class="line">        <a class="code hl_struct" href="structMoFEM_1_1GetBlockScalingMethod.html">GetBlockScalingMethod&lt;DynamicRelaxationTimeScale&gt;::get</a>(</div>
<div class="line">            ts_pre_stretch, <span class="stringliteral">&quot;externalstrain_history&quot;</span>, <span class="stringliteral">&quot;.txt&quot;</span>, ext_strain_block.blockName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a379" name="a379"></a><a class="code hl_function" href="structEshelbianCore.html#ae1b21da25a876c11c40d9878f299c8a3">EshelbianCore::createExchangeVectors</a>(<a class="code hl_enumeration" href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">Sev</a> sev) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> print_loc_size = [<span class="keyword">this</span>](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">auto</span> str, <span class="keyword">auto</span> sev) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordtype">int</span> size;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetLocalSize(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second, &amp;size);</div>
<div class="line">    <span class="keywordtype">int</span> low, high;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetOwnershipRange(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second, &amp;low, &amp;high);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSYNC&quot;</span>, sev) &lt;&lt; str &lt;&lt; <span class="stringliteral">&quot; local size &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; low</div>
<div class="line">                             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; high &lt;&lt; <span class="stringliteral">&quot; ) &quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="LogManager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), sev);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a id="a380" name="a380"></a><a class="code hl_variable" href="structEshelbianCore.html#ad481b72d51e6377015a74f929bc6a672">volumeExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 3, 1, sev);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="structEshelbianCore.html#ad481b72d51e6377015a74f929bc6a672">volumeExchange</a>, <span class="stringliteral">&quot;volumeExchange&quot;</span>, sev);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 2, 1, Sev::inform);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">faceExchange</a>, <span class="stringliteral">&quot;faceExchange&quot;</span>, sev);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#ab1bb40274b0b343f49fc45bc2d3de293">edgeExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 1, 1, Sev::inform);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="structEshelbianCore.html#ab1bb40274b0b343f49fc45bc2d3de293">edgeExchange</a>, <span class="stringliteral">&quot;edgeExchange&quot;</span>, sev);</div>
<div class="line">  <a class="code hl_variable" href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 0, 3, Sev::inform);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>, <span class="stringliteral">&quot;vertexExchange&quot;</span>, sev);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a381" name="a381"></a><a class="code hl_function" href="structEshelbianCore.html#a4e17c2f50f7938051a7447594733527a">EshelbianCore::calculateCrackArea</a>(boost::shared_ptr&lt;double&gt; area_ptr) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!area_ptr) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a382" name="a382"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a>, <span class="stringliteral">&quot;area_ptr is null&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> success;</div>
<div class="line">  *area_ptr = 0;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Calculate crack area&quot;</span>;</div>
<div class="line">    <span class="keyword">auto</span> crack_faces = <a class="code hl_function" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CRACK&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a> : crack_faces) {</div>
<div class="line">      *area_ptr += <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;getTriArea(<a class="code hl_variable" href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">f</a>);</div>
<div class="line">    }</div>
<div class="line">    success = MPI_Bcast(area_ptr.get(), 1, MPI_DOUBLE, 0, <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    success = MPI_Bcast(area_ptr.get(), 1, MPI_DOUBLE, 0, <a class="code hl_variable" href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">if</span> (success != MPI_SUCCESS) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a383" name="a383"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;bcast failed&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace EshelbianPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianContact_8cpp.html">impl/EshelbianContact.cpp</a>&gt;</span></div>
<div class="ttc" id="aCGGTonsorialBubbleBase_8hpp_html"><div class="ttname"><a href="CGGTonsorialBubbleBase_8hpp.html">CGGTonsorialBubbleBase.hpp</a></div><div class="ttdoc">Implementation of tonsorial bubble base div(v) = 0.</div></div>
<div class="ttc" id="aCGGTonsorialBubbleBase_8hpp_html_af88c539f45e4ad3e7407169d8539d25e"><div class="ttname"><a href="CGGTonsorialBubbleBase_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a></div><div class="ttdeci">#define NBVOLUMETET_CCG_BUBBLE(P)</div><div class="ttdoc">Bubble function for CGG H div space.</div><div class="ttdef"><b>Definition</b> <a href="CGGTonsorialBubbleBase_8hpp_source.html#l00019">CGGTonsorialBubbleBase.hpp:19</a></div></div>
<div class="ttc" id="aEshelbianAux_8hpp_html"><div class="ttname"><a href="EshelbianAux_8hpp.html">EshelbianAux.hpp</a></div><div class="ttdoc">Auxilary functions for Eshelbian plasticity.</div></div>
<div class="ttc" id="aEshelbianContact_8cpp_html"><div class="ttname"><a href="EshelbianContact_8cpp.html">EshelbianContact.cpp</a></div></div>
<div class="ttc" id="aEshelbianContact_8hpp_html"><div class="ttname"><a href="EshelbianContact_8hpp.html">EshelbianContact.hpp</a></div></div>
<div class="ttc" id="aEshelbianMonitor_8cpp_html"><div class="ttname"><a href="EshelbianMonitor_8cpp.html">EshelbianMonitor.cpp</a></div><div class="ttdoc">Contains definition of EshelbianMonitor class.</div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_a559a80330b1f767e8e9b59d89a31eac5"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#a559a80330b1f767e8e9b59d89a31eac5">send_type</a></div><div class="ttdeci">static auto send_type(MoFEM::Interface &amp;m_field, Range r, const EntityType type)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00054">EshelbianPlasticity.cpp:54</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_a652208c3378b6381518790e0b1cdfc96"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#a652208c3378b6381518790e0b1cdfc96">get_block_meshset</a></div><div class="ttdeci">static auto get_block_meshset(MoFEM::Interface &amp;m_field, const int ms_id, const unsigned int cubit_bc_type)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00144">EshelbianPlasticity.cpp:144</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_a682702e0fce3d077405cdabd7af01877"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a></div><div class="ttdeci">static auto get_range_from_block(MoFEM::Interface &amp;m_field, const std::string block_name, int dim)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00100">EshelbianPlasticity.cpp:100</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_a711a5a75b4797d9d4f46d1a45dccaf32"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#a711a5a75b4797d9d4f46d1a45dccaf32">get_two_sides_of_crack_surface</a></div><div class="ttdeci">static auto get_two_sides_of_crack_surface(MoFEM::Interface &amp;m_field, Range crack_faces)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00234">EshelbianPlasticity.cpp:234</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_a718f0d15355f2dc01f5d980449529b34"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#a718f0d15355f2dc01f5d980449529b34">get_range_from_block_map</a></div><div class="ttdeci">static auto get_range_from_block_map(MoFEM::Interface &amp;m_field, const std::string block_name, int dim)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00122">EshelbianPlasticity.cpp:122</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_ac47fc7a580388e34129fdde590829ace"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a></div><div class="ttdeci">static auto filter_owners(MoFEM::Interface &amp;m_field, Range skin)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00177">EshelbianPlasticity.cpp:177</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_acbdb074a26e17860f61191108d21d8a8"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a></div><div class="ttdeci">static auto filter_true_skin(MoFEM::Interface &amp;m_field, Range &amp;&amp;skin)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00166">EshelbianPlasticity.cpp:166</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_acd5f3538620db1687d2800eafd99e75d"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a></div><div class="ttdeci">static auto get_skin(MoFEM::Interface &amp;m_field, Range body_ents)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00187">EshelbianPlasticity.cpp:187</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_af63d38d75712794be9ff9cde96486dfa"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#af63d38d75712794be9ff9cde96486dfa">get_crack_front_edges</a></div><div class="ttdeci">static auto get_crack_front_edges(MoFEM::Interface &amp;m_field, Range crack_faces)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00194">EshelbianPlasticity.cpp:194</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8hpp_html"><div class="ttname"><a href="EshelbianPlasticity_8hpp.html">EshelbianPlasticity.hpp</a></div><div class="ttdoc">Eshelbian plasticity interface.</div></div>
<div class="ttc" id="aLogManager_8hpp_html_a3b22f6000e678d07d69a2c790177a352"><div class="ttname"><a href="LogManager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a></div><div class="ttdeci">#define MOFEM_LOG_SEVERITY_SYNC(comm, severity)</div><div class="ttdoc">Synchronise &quot;SYNC&quot; on curtain severity level.</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00360">LogManager.hpp:360</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00319">LogManager.hpp:319</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aSetUpSchurImpl_8cpp_html"><div class="ttname"><a href="SetUpSchurImpl_8cpp.html">SetUpSchurImpl.cpp</a></div></div>
<div class="ttc" id="aTSElasticPostStep_8cpp_html"><div class="ttname"><a href="TSElasticPostStep_8cpp.html">TSElasticPostStep.cpp</a></div></div>
<div class="ttc" id="aTemplates_8hpp_html_ab9006f32b4309540b5b2a3a4d9fa82ff"><div class="ttname"><a href="Templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a></div><div class="ttdeci">#define FTENSOR_INDEX(DIM, I)</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l02013">Templates.hpp:2013</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="acheck__base__functions__derivatives__on__tet_8cpp_html_a3d8c24629d725b9ef8c238cf27c9b158"><div class="ttname"><a href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a></div><div class="ttdeci">static const double eps</div><div class="ttdef"><b>Definition</b> <a href="check__base__functions__derivatives__on__tet_8cpp_source.html#l00011">check_base_functions_derivatives_on_tet.cpp:11</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_abd1f0351e167546d82adc28b4dd0e681"><div class="ttname"><a href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryEle BoundaryEle</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00039">child_and_parent.cpp:39</a></div></div>
<div class="ttc" id="acholesky_8hpp_html"><div class="ttname"><a href="cholesky_8hpp.html">cholesky.hpp</a></div><div class="ttdoc">cholesky decomposition</div></div>
<div class="ttc" id="aclassBiLinearForm_html"><div class="ttname"><a href="classBiLinearForm.html">BiLinearForm</a></div></div>
<div class="ttc" id="aclassBoundaryEleOp_html"><div class="ttname"><a href="classBoundaryEleOp.html">BoundaryEleOp</a></div></div>
<div class="ttc" id="aclassFEMethod_html"><div class="ttname"><a href="classFEMethod.html">FEMethod</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Kronecker__Delta_html"><div class="ttname"><a href="classFTensor_1_1Kronecker__Delta.html">FTensor::Kronecker_Delta</a></div><div class="ttdoc">Kronecker Delta class.</div><div class="ttdef"><b>Definition</b> <a href="Kronecker__Delta_8hpp_source.html#l00015">Kronecker_Delta.hpp:15</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html_acd2e7c8da26f682eb6c6b1017f817c19"><div class="ttname"><a href="classFTensor_1_1Tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">FTensor::Tensor1::normalize</a></div><div class="ttdeci">Tensor1&lt; T, Tensor_Dim &gt; normalize()</div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00077">Tensor1_value.hpp:77</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html_afebf8aa1d76c7b1f048efd271154adc6"><div class="ttname"><a href="classFTensor_1_1Tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">FTensor::Tensor1::l2</a></div><div class="ttdeci">T l2() const</div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00084">Tensor1_value.hpp:84</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor3_html"><div class="ttname"><a href="classFTensor_1_1Tensor3.html">FTensor::Tensor3</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor3__value_8hpp_source.html#l00012">Tensor3_value.hpp:13</a></div></div>
<div class="ttc" id="aclassLinearForm_html"><div class="ttname"><a href="classLinearForm.html">LinearForm</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="aclassSideEleOp_html"><div class="ttname"><a href="classSideEleOp.html">SideEleOp</a></div></div>
<div class="ttc" id="aclassTetPolynomialBase_html"><div class="ttname"><a href="classTetPolynomialBase.html">TetPolynomialBase</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a></div><div class="ttdeci">@ VERBOSE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00222">definitions.h:222</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a></div><div class="ttdeci">@ COL</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a></div><div class="ttdeci">FieldApproximationBase</div><div class="ttdoc">approximation base</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00058">definitions.h:58</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a></div><div class="ttdeci">@ USER_BASE</div><div class="ttdoc">user implemented approximation base</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00068">definitions.h:68</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a></div><div class="ttdeci">@ NOBASE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00059">definitions.h:59</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a></div><div class="ttdeci">@ DEMKOWICZ_JACOBI_BASE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00067">definitions.h:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00612">definitions.h:612</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00463">definitions.h:463</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a></div><div class="ttdeci">@ HDIV</div><div class="ttdoc">field with continuous normal traction</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00087">definitions.h:87</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4"><div class="ttname"><a href="definitions_8h.html#a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4">DISCONTINUOUS</a></div><div class="ttdeci">@ DISCONTINUOUS</div><div class="ttdoc">Broken continuity (No effect on L2 space)</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00101">definitions.h:101</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a793899f524a281eb88e3ff2b01ce6acb"><div class="ttname"><a href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a></div><div class="ttdeci">#define CHK_MOAB_THROW(err, msg)</div><div class="ttdoc">Check error code of MoAB function and throw MoFEM exception.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00592">definitions.h:592</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a></div><div class="ttdeci">@ MOFEM_OPERATION_UNSUCCESSFUL</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00034">definitions.h:34</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a></div><div class="ttdeci">@ MOFEM_INVALID_DATA</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00036">definitions.h:36</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a></div><div class="ttdeci">@ MOFEM_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00032">definitions.h:32</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00456">definitions.h:456</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a19deff62572d607bc77ed2f82fa639cc"><div class="ttname"><a href="fem__tools_8h.html#a19deff62572d607bc77ed2f82fa639cc">ShapeDiffMBTET</a></div><div class="ttdeci">PetscErrorCode ShapeDiffMBTET(double *diffN)</div><div class="ttdoc">calculate derivatives of shape functions</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8c_source.html#l00319">fem_tools.c:319</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a7878f2dbe482129374d1d05c05f3c670"><div class="ttname"><a href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a></div><div class="ttdeci">PetscErrorCode ShapeMBTET(double *N, const double *G_X, const double *G_Y, const double *G_Z, int DIM)</div><div class="ttdoc">calculate shape functions</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8c_source.html#l00306">fem_tools.c:306</a></div></div>
<div class="ttc" id="afem__tools_8h_html_af39e9dc2be2d3d367f56d6277553ba00"><div class="ttname"><a href="fem__tools_8h.html#af39e9dc2be2d3d367f56d6277553ba00">ShapeMBTRI</a></div><div class="ttdeci">PetscErrorCode ShapeMBTRI(double *N, const double *X, const double *Y, const int G_DIM)</div><div class="ttdoc">calculate shape functions on triangle</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8c_source.html#l00182">fem_tools.c:182</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a52438586143ef05bfe922220a317c144"><div class="ttname"><a href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a></div><div class="ttdeci">constexpr auto t_kd</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00139">free_surface.cpp:139</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01113">DMMoFEM.cpp:1113</a></div></div>
<div class="ttc" id="agroup__dm_html_ga175a29f4cdd0e7b7ae6cc2a0d7ed1704"><div class="ttname"><a href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">MoFEM::DMMoFEMCreateSubDM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateSubDM(DM subdm, DM dm, const char problem_name[])</div><div class="ttdoc">Must be called by user to set Sub DM MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00215">DMMoFEM.cpp:215</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00488">DMMoFEM.cpp:488</a></div></div>
<div class="ttc" id="agroup__dm_html_ga27babc6dfb0df28667682a98b5822739"><div class="ttname"><a href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">MoFEM::DMMoFEMSetSquareProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetSquareProblem(DM dm, PetscBool square_problem)</div><div class="ttdoc">set squared problem</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00450">DMMoFEM.cpp:450</a></div></div>
<div class="ttc" id="agroup__dm_html_ga286b3dbf0959ea028035e1d808a9403a"><div class="ttname"><a href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">MoFEM::DMMoFEMTSSetIFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00790">DMMoFEM.cpp:790</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga3fcdbd5c74eba11ee82492e57d730756"><div class="ttname"><a href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">MoFEM::DMoFEMPostProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPostProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00546">DMMoFEM.cpp:546</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00514">DMMoFEM.cpp:514</a></div></div>
<div class="ttc" id="agroup__dm_html_ga62400e040ecf09a00b7ec3767fc7f124"><div class="ttname"><a href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">MoFEM::DMMoFEMAddSubFieldRow</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldRow(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00238">DMMoFEM.cpp:238</a></div></div>
<div class="ttc" id="agroup__dm_html_ga81d1702e6a5cbe505aa79e94c4aa9d74"><div class="ttname"><a href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">MoFEM::DMMoFEMGetTsCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetTsCtx(DM dm, MoFEM::TsCtx **ts_ctx)</div><div class="ttdoc">get MoFEM::TsCtx data structure</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01132">DMMoFEM.cpp:1132</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00576">DMMoFEM.cpp:576</a></div></div>
<div class="ttc" id="agroup__dm_html_gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3"><div class="ttname"><a href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">MoFEM::DMMoFEMTSSetIJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIJacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00843">DMMoFEM.cpp:843</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8hpp_source.html#l01102">DMMoFEM.hpp:1102</a></div></div>
<div class="ttc" id="agroup__dm_html_gacb6892c50af6ca032cc69aeead61cd1e"><div class="ttname"><a href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">MoFEM::DMMoFEMTSSetI2Jacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetI2Jacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01007">DMMoFEM.cpp:1007</a></div></div>
<div class="ttc" id="agroup__dm_html_gacdda38385eb99fd6fa1257f4cd143053"><div class="ttname"><a href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">MoFEM::DMMoFEMTSSetI2Function</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetI2Function(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00965">DMMoFEM.cpp:965</a></div></div>
<div class="ttc" id="agroup__dm_html_gaef66c04ab918f0e5e965838b12726405"><div class="ttname"><a href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">MoFEM::DMoFEMLoopFiniteElementsUpAndLowRank</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElementsUpAndLowRank(DM dm, const char fe_name[], MoFEM::FEMethod *method, int low_rank, int up_rank, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00557">DMMoFEM.cpp:557</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00536">DMMoFEM.cpp:536</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_gaead3887ddc924ad6d2a0993bfb4a9b27"><div class="ttname"><a href="group__mofem__access.html#gaead3887ddc924ad6d2a0993bfb4a9b27">_IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_(MFIELD, NAME, ENT, IT)</div><div class="ttdoc">loop over all dofs from a moFEM field and particular field</div><div class="ttdef"><b>Definition</b> <a href="Interface_8hpp_source.html#l01917">Interface.hpp:1917</a></div></div>
<div class="ttc" id="agroup__mofem__base__functions_html_ga176a495a81c85ce580624a284726521e"><div class="ttname"><a href="group__mofem__base__functions.html#ga176a495a81c85ce580624a284726521e">Legendre_polynomials</a></div><div class="ttdeci">PetscErrorCode Legendre_polynomials(int p, double s, double *diff_s, double *L, double *diffL, const int dim)</div><div class="ttdoc">Calculate Legendre approximation basis.</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00015">base_functions.c:15</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga9c5d28e66a86646de9e733b34ea03a71"><div class="ttname"><a href="group__mofem__fe.html#ga9c5d28e66a86646de9e733b34ea03a71">MoFEM::CoreInterface::modify_finite_element_adjacency_table</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_adjacency_table(const std::string &amp;fe_name, const EntityType type, ElementAdjacencyFunct function)=0</div><div class="ttdoc">modify finite element table, only for advanced user</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gacbb3bbf1fa80b85848bc3cfcd604182b"><div class="ttname"><a href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">MoFEM::CoreInterface::add_ents_to_finite_element_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_type(const EntityHandle entities, const EntityType type, const std::string name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga01ac334d9339ed5f1b0bcfa12a8daf1d"><div class="ttname"><a href="group__mofem__field.html#ga01ac334d9339ed5f1b0bcfa12a8daf1d">MoFEM::CoreInterface::get_field_structure</a></div><div class="ttdeci">virtual const Field * get_field_structure(const std::string &amp;name, enum MoFEMTypes bh=MF_EXIST) const =0</div><div class="ttdoc">get field structure</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga3f2352d1e29c591592c37cc89d0e4eb4"><div class="ttname"><a href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">MoFEM::CoreInterface::add_ents_to_field_by_dim</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_dim(const Range &amp;ents, const int dim, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__field_html_gaa584a5c9cc28f5ae0a7088d130683be8"><div class="ttname"><a href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">MoFEM::CoreInterface::add_ents_to_field_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_type(const Range &amp;ents, const EntityType type, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__forms_html_gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced"><div class="ttname"><a href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">MoFEM::GAUSS</a></div><div class="ttdeci">@ GAUSS</div><div class="ttdef"><b>Definition</b> <a href="FormsIntegrators_8hpp_source.html#l00136">FormsIntegrators.hpp:136</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00316">LogManager.hpp:316</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga1d256cf4cf0b698de94c0907f7f0fe93"><div class="ttname"><a href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">MoFEM::LogManager::SeverityLevel</a></div><div class="ttdeci">SeverityLevel</div><div class="ttdoc">Severity levels.</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00033">LogManager.hpp:33</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga47d7053307c012af4b78f8a09e21fa83"><div class="ttname"><a href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a></div><div class="ttdeci">#define MOFEM_LOG_CHANNEL(channel)</div><div class="ttdoc">Set and reset channel.</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00292">LogManager.hpp:292</a></div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="agroup__mofem__loops_html_gab3dc3302de79f29b26605579d77797c9"><div class="ttname"><a href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">MoFEM::CoreInterface::loop_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_finite_elements(const std::string problem_name, const std::string &amp;fe_name, FEMethod &amp;method, boost::shared_ptr&lt; NumeredEntFiniteElement_multiIndex &gt; fe_ptr=nullptr, MoFEMTypes bh=MF_EXIST, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr(), int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over finite elements.</div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga1ca1b58c9fb5abc1be1e62729577daa8"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">MoFEM::MeshsetsManager::getMeshset</a></div><div class="ttdeci">MoFEMErrorCode getMeshset(const int ms_id, const unsigned int cubit_bc_type, EntityHandle &amp;meshset) const</div><div class="ttdoc">get meshset from CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8cpp_source.html#l00719">MeshsetsManager.cpp:719</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga9fbf1b71bc44b8a83c7f69f1cfba8125"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">MoFEM::MeshsetsManager::addMeshset</a></div><div class="ttdeci">MoFEMErrorCode addMeshset(const CubitBCType cubit_bc_type, const int ms_id, const std::string name=&quot;&quot;)</div><div class="ttdoc">add cubit meshset</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8cpp_source.html#l00396">MeshsetsManager.cpp:396</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa54e3cb5e57c57a8d03d9c4c7a21a80a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">MoFEM::MeshsetsManager::getCubitMeshsetPtr</a></div><div class="ttdeci">MoFEMErrorCode getCubitMeshsetPtr(const int ms_id, const CubitBCType cubit_bc_type, const CubitMeshSets **cubit_meshset_ptr) const</div><div class="ttdoc">get cubit meshset</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8cpp_source.html#l00589">MeshsetsManager.cpp:589</a></div></div>
<div class="ttc" id="ah1__hdiv__hcurl__l2_8h_html_afff51d616c826e4714c19b69816fa74f"><div class="ttname"><a href="h1__hdiv__hcurl__l2_8h.html#afff51d616c826e4714c19b69816fa74f">NBVOLUMETET_L2</a></div><div class="ttdeci">#define NBVOLUMETET_L2(P)</div><div class="ttdoc">Number of base functions on tetrahedron for L2 space.</div><div class="ttdef"><b>Definition</b> <a href="h1__hdiv__hcurl__l2_8h_source.html#l00027">h1_hdiv_hcurl_l2.h:27</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="ahcurl__check__approx__in__2d_8cpp_html_a6c7cb8ddd43ff771629f497cdde37cf0"><div class="ttname"><a href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a></div><div class="ttdeci">constexpr double a0</div><div class="ttdef"><b>Definition</b> <a href="hcurl__check__approx__in__2d_8cpp_source.html#l00037">hcurl_check_approx_in_2d.cpp:37</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_a771a8d2443d7bec47aef196b5d23ade2"><div class="ttname"><a href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a></div><div class="ttdeci">FTensor::Index&lt; 'J', DIM1 &gt; J</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l00030">level_set.cpp:30</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l01932">level_set.cpp:1932</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition</b> <a href="MatrixFunction_8hpp_source.html#l00064">MatrixFunction.hpp:64</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html"><div class="ttname"><a href="namespaceEshelbianPlasticity.html">EshelbianPlasticity</a></div><div class="ttdef"><b>Definition</b> <a href="CGGTonsorialBubbleBase_8hpp_source.html#l00011">CGGTonsorialBubbleBase.hpp:11</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_a68543d06189d85f76d53dfc14a39ecf5"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#a68543d06189d85f76d53dfc14a39ecf5">EshelbianPlasticity::CGG_BubbleBase_MBTET</a></div><div class="ttdeci">MoFEMErrorCode CGG_BubbleBase_MBTET(const int p, const double *N, const double *diffN, FTensor::Tensor2&lt; FTensor::PackPtr&lt; double *, 9 &gt;, 3, 3 &gt; &amp;phi, const int gdim)</div><div class="ttdoc">Calculate CGGT tonsorial bubble base.</div><div class="ttdef"><b>Definition</b> <a href="CGGTonsorialBubbleBase_8cpp_source.html#l00020">CGGTonsorialBubbleBase.cpp:20</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_a9a8b1d5aaedc0a0225c4c83bed2d60f6"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6">EshelbianPlasticity::StretchSelector</a></div><div class="ttdeci">StretchSelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8hpp_source.html#l00052">EshelbianPlasticity.hpp:52</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_aad51dbcb3d4d470a0d589df584a43e17"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17">EshelbianPlasticity::RotSelector</a></div><div class="ttdeci">RotSelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8hpp_source.html#l00051">EshelbianPlasticity.hpp:51</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_ab5c6383b3ae44d5fa5c2ee36f94a1e9a"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9a">EshelbianPlasticity::EnergyReleaseSelector</a></div><div class="ttdeci">EnergyReleaseSelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8hpp_source.html#l00053">EshelbianPlasticity.hpp:53</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_ab5c6383b3ae44d5fa5c2ee36f94a1e9aa8430cfd5241f35fe229c7eb6be7f2580"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9aa8430cfd5241f35fe229c7eb6be7f2580">EshelbianPlasticity::GRIFFITH_SKELETON</a></div><div class="ttdeci">@ GRIFFITH_SKELETON</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8hpp_source.html#l00053">EshelbianPlasticity.hpp:53</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_ab5c6383b3ae44d5fa5c2ee36f94a1e9aaf0450ba88e72057e299572c0cb42a8c3"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#ab5c6383b3ae44d5fa5c2ee36f94a1e9aaf0450ba88e72057e299572c0cb42a8c3">EshelbianPlasticity::GRIFFITH_FORCE</a></div><div class="ttdeci">@ GRIFFITH_FORCE</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8hpp_source.html#l00053">EshelbianPlasticity.hpp:53</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_ae337388c661d8b90487c846cd2f361fa"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#ae337388c661d8b90487c846cd2f361fa">EshelbianPlasticity::SymmetrySelector</a></div><div class="ttdeci">SymmetrySelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8hpp_source.html#l00050">EshelbianPlasticity.hpp:50</a></div></div>
<div class="ttc" id="anamespaceFTensor_html_a50ff153c38920d1001276f5d857e0599"><div class="ttname"><a href="namespaceFTensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a></div><div class="ttdeci">constexpr std::enable_if&lt;(Dim0&lt;=2 &amp;&amp;Dim1&lt;=2), Tensor2_Expr&lt; Levi_Civita&lt; T &gt;, T, Dim0, Dim1, i, j &gt; &gt;::type levi_civita(const Index&lt; i, Dim0 &gt; &amp;, const Index&lt; j, Dim1 &gt; &amp;)</div><div class="ttdoc">levi_civita functions to make for easy adhoc use</div><div class="ttdef"><b>Definition</b> <a href="Levi__Civita_8hpp_source.html#l00617">Levi_Civita.hpp:617</a></div></div>
<div class="ttc" id="anamespaceFTensor_html_ad4a6ecc7f7a6e3b3903a9cff27887f39"><div class="ttname"><a href="namespaceFTensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">FTensor::dd</a></div><div class="ttdeci">const Tensor2_symmetric_Expr&lt; const ddTensor0&lt; T, Dim, i, j &gt;, typename promote&lt; T, double &gt;::V, Dim, i, j &gt; dd(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index1, const Index&lt; j, Dim &gt; index2, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition</b> <a href="ddTensor0_8hpp_source.html#l00033">ddTensor0.hpp:33</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1808931312a0a80aad5a5e769aa9e536"><div class="ttname"><a href="namespaceMoFEM.html#a1808931312a0a80aad5a5e769aa9e536">MoFEM::getDMTsCtx</a></div><div class="ttdeci">auto getDMTsCtx(DM dm)</div><div class="ttdoc">Get TS context data structure used by DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8hpp_source.html#l01144">DMMoFEM.hpp:1144</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2ae9847dc65a4ed504f68633851f8ddf"><div class="ttname"><a href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">MoFEM::DMMoFEMSetDestroyProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetDestroyProblem(DM dm, PetscBool destroy_problem)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00434">DMMoFEM.cpp:434</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a49ed784a72b0b18b4cd6f983539fe3b5"><div class="ttname"><a href="namespaceMoFEM.html#a49ed784a72b0b18b4cd6f983539fe3b5">MoFEM::id_from_handle</a></div><div class="ttdeci">auto id_from_handle(const EntityHandle h)</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01890">Templates.hpp:1890</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedPetsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedPetsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a77d94d2111c0c988bc3100b3910cc25c"><div class="ttname"><a href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">MoFEM::createVectorMPI</a></div><div class="ttdeci">auto createVectorMPI(MPI_Comm comm, PetscInt n, PetscInt N)</div><div class="ttdoc">Create MPI Vector.</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00202">PetscSmartObj.hpp:202</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_acd15202cb7502a684f8276aae2b4ed70"><div class="ttname"><a href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">MoFEM::PetscOptionsGetString</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetString(PetscOptions *, const char pre[], const char name[], char str[], size_t size, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedPetsc_8hpp_source.html#l00172">DeprecatedPetsc.hpp:172</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad17eefd5d88d2b51c71ec46cae8569ac"><div class="ttname"><a href="namespaceMoFEM.html#ad17eefd5d88d2b51c71ec46cae8569ac">MoFEM::get_temp_meshset_ptr</a></div><div class="ttdeci">auto get_temp_meshset_ptr(moab::Interface &amp;moab)</div><div class="ttdoc">Create smart pointer to temporary meshset.</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01886">Templates.hpp:1886</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae6b64312d73966f4cc41953bc77a4ba3"><div class="ttname"><a href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">MoFEM::createDM</a></div><div class="ttdeci">auto createDM(MPI_Comm comm, const std::string dm_type_name)</div><div class="ttdoc">Creates smart DM object.</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00141">PetscSmartObj.hpp:141</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_afbff5c771275ba60387bc33d5dd981b2"><div class="ttname"><a href="namespaceMoFEM.html#afbff5c771275ba60387bc33d5dd981b2">MoFEM::ent_form_type_and_id</a></div><div class="ttdeci">auto ent_form_type_and_id(const EntityType type, const EntityID id)</div><div class="ttdoc">get entity handle from type and id</div><div class="ttdef"><b>Definition</b> <a href="Templates_8hpp_source.html#l01906">Templates.hpp:1906</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespacesdf__hertz__2d__axisymm__plane_html_a8204f26163e5d184298bc6fa855b88ea"><div class="ttname"><a href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">sdf_hertz_2d_axisymm_plane.d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition</b> <a href="sdf__hertz__2d__axisymm__plane_8py_source.html#l00004">sdf_hertz_2d_axisymm_plane.py:4</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="namespacestd.html">std</a></div><div class="ttdef"><b>Definition</b> <a href="enable__if_8hpp_source.html#l00005">enable_if.hpp:6</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a99b759dd71581f497626034776727d3d"><div class="ttname"><a href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a></div><div class="ttdeci">constexpr IntegrationType I</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00031">operators_tests.cpp:31</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ae9faec98b784e677f51cf7ede5a592b4"><div class="ttname"><a href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::SideEle SideEle</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00061">plastic.cpp:61</a></div></div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition</b> <a href="plate_8cpp_source.html#l00058">plate.cpp:58</a></div></div>
<div class="ttc" id="apoisson__2d__dis__galerkin_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">static double phi</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__dis__galerkin_8cpp_source.html#l00030">poisson_2d_dis_galerkin.cpp:30</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="aquad_8h_html"><div class="ttname"><a href="quad_8h.html">quad.h</a></div></div>
<div class="ttc" id="aquad_8h_html_a054557173149016194334ebfa52bdfff"><div class="ttname"><a href="quad_8h.html#a054557173149016194334ebfa52bdfff">QUAD_2D_TABLE_SIZE</a></div><div class="ttdeci">#define QUAD_2D_TABLE_SIZE</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00174">quad.h:174</a></div></div>
<div class="ttc" id="aquad_8h_html_a1595ef6e1d0b6c71455660b4d9219cb6"><div class="ttname"><a href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a></div><div class="ttdeci">#define QUAD_3D_TABLE_SIZE</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00186">quad.h:186</a></div></div>
<div class="ttc" id="aquad_8h_html_a8a7ef1fada6eeb66c2958ecb8480f040"><div class="ttname"><a href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a></div><div class="ttdeci">static QUAD *const QUAD_2D_TABLE[]</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00175">quad.h:175</a></div></div>
<div class="ttc" id="aquad_8h_html_aeda07179568bdfe515fdb7368b7adec4"><div class="ttname"><a href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a></div><div class="ttdeci">static QUAD *const QUAD_3D_TABLE[]</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00187">quad.h:187</a></div></div>
<div class="ttc" id="ascalar__check__approximation_8cpp_html_a9e6f88bbff7880d45f1d2c50fbf8ee76"><div class="ttname"><a href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a></div><div class="ttdeci">PipelineManager::ElementsAndOpsByDim&lt; SPACE_DIM &gt;::FaceSideEle EleOnSide</div><div class="ttdef"><b>Definition</b> <a href="scalar__check__approximation_8cpp_source.html#l00027">scalar_check_approximation.cpp:27</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructDataAtIntegrationPts_html"><div class="ttname"><a href="structDataAtIntegrationPts.html">DataAtIntegrationPts</a></div><div class="ttdef"><b>Definition</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00020">ElasticityMixedFormulation.hpp:20</a></div></div>
<div class="ttc" id="astructEshelbianCore_1_1SetUpSchur_html_a6eb28d3a5bfe67448e57dd15eaee5318"><div class="ttname"><a href="structEshelbianCore_1_1SetUpSchur.html#a6eb28d3a5bfe67448e57dd15eaee5318">EshelbianCore::SetUpSchur::createSetUpSchur</a></div><div class="ttdeci">static boost::shared_ptr&lt; SetUpSchur &gt; createSetUpSchur(MoFEM::Interface &amp;m_field, EshelbianCore *ep_core_ptr)</div><div class="ttdef"><b>Definition</b> <a href="SetUpSchurImpl_8cpp_source.html#l00592">SetUpSchurImpl.cpp:592</a></div></div>
<div class="ttc" id="astructEshelbianCore_html"><div class="ttname"><a href="structEshelbianCore.html">EshelbianCore</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00012">EshelbianCore.hpp:12</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a0529d7544a0444bc591f0a52e00cd551"><div class="ttname"><a href="structEshelbianCore.html#a0529d7544a0444bc591f0a52e00cd551">EshelbianCore::alphaW</a></div><div class="ttdeci">double alphaW</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00140">EshelbianCore.hpp:140</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a085b68a8c557803c873d7cdc6a796cc3"><div class="ttname"><a href="structEshelbianCore.html#a085b68a8c557803c873d7cdc6a796cc3">EshelbianCore::alphaRho</a></div><div class="ttdeci">double alphaRho</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00142">EshelbianCore.hpp:142</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a086c46eedf160d647dd5261161545ed4"><div class="ttname"><a href="structEshelbianCore.html#a086c46eedf160d647dd5261161545ed4">EshelbianCore::setElasticElementOps</a></div><div class="ttdeci">MoFEMErrorCode setElasticElementOps(const int tag)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03145">EshelbianPlasticity.cpp:3145</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a0ad247d6694e42cb585396f1f02aa1a3"><div class="ttname"><a href="structEshelbianCore.html#a0ad247d6694e42cb585396f1f02aa1a3">EshelbianCore::externalStrainVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; ExternalStrainVec &gt; externalStrainVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00157">EshelbianCore.hpp:157</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a0c39ec57ae27dba1a6fe02b45d971d68"><div class="ttname"><a href="structEshelbianCore.html#a0c39ec57ae27dba1a6fe02b45d971d68">EshelbianCore::addVolumeFiniteElement</a></div><div class="ttdeci">MoFEMErrorCode addVolumeFiniteElement(const EntityHandle meshset=0)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l01516">EshelbianPlasticity.cpp:1516</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a0ccbbae7b9f76b00b39760756c85ca7b"><div class="ttname"><a href="structEshelbianCore.html#a0ccbbae7b9f76b00b39760756c85ca7b">EshelbianCore::addFields</a></div><div class="ttdeci">MoFEMErrorCode addFields(const EntityHandle meshset=0)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l01140">EshelbianPlasticity.cpp:1140</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a0fa131247db161516b235b0a567300ad"><div class="ttname"><a href="structEshelbianCore.html#a0fa131247db161516b235b0a567300ad">EshelbianCore::stretchSelector</a></div><div class="ttdeci">static enum StretchSelector stretchSelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00017">EshelbianCore.hpp:17</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a10755de9e354c68d35fbaa4df6721cc4"><div class="ttname"><a href="structEshelbianCore.html#a10755de9e354c68d35fbaa4df6721cc4">EshelbianCore::frontAdjEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontAdjEdges</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00336">EshelbianCore.hpp:336</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a113994efe4dd1803d84aeab5c6230096"><div class="ttname"><a href="structEshelbianCore.html#a113994efe4dd1803d84aeab5c6230096">EshelbianCore::createCrackSurfaceMeshset</a></div><div class="ttdeci">MoFEMErrorCode createCrackSurfaceMeshset()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06572">EshelbianPlasticity.cpp:6572</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a14d44e8866e1201657b06ce8d1d82206"><div class="ttname"><a href="structEshelbianCore.html#a14d44e8866e1201657b06ce8d1d82206">EshelbianCore::addBoundaryFiniteElement</a></div><div class="ttdeci">MoFEMErrorCode addBoundaryFiniteElement(const EntityHandle meshset=0)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l01579">EshelbianPlasticity.cpp:1579</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a15ab431478033e2a923274d52611f715"><div class="ttname"><a href="structEshelbianCore.html#a15ab431478033e2a923274d52611f715">EshelbianCore::skeletonElement</a></div><div class="ttdeci">const std::string skeletonElement</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00128">EshelbianCore.hpp:128</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a1816ba2425a829869dce4bbc30225fd8"><div class="ttname"><a href="structEshelbianCore.html#a1816ba2425a829869dce4bbc30225fd8">EshelbianCore::postProcessSkeletonResults</a></div><div class="ttdeci">MoFEMErrorCode postProcessSkeletonResults(const int tag, const std::string file, Vec f_residual=PETSC_NULL, std::vector&lt; Tag &gt; tags_to_transfer={})</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l04092">EshelbianPlasticity.cpp:4092</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a1b2cd0d3b7edf33d32a29531faff5d43"><div class="ttname"><a href="structEshelbianCore.html#a1b2cd0d3b7edf33d32a29531faff5d43">EshelbianCore::inv_f_linear</a></div><div class="ttdeci">static double inv_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00082">EshelbianCore.hpp:82</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a1d675f655047fd0548308a22ebc73430"><div class="ttname"><a href="structEshelbianCore.html#a1d675f655047fd0548308a22ebc73430">EshelbianCore::bcSpatialTractionVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; TractionBcVec &gt; bcSpatialTractionVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00151">EshelbianCore.hpp:151</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a1d8cc6e9d9b36b23f91a57c9d5a371ff"><div class="ttname"><a href="structEshelbianCore.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">EshelbianCore::contactFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; contactFaces</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00333">EshelbianCore.hpp:333</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a211ebd365f858409286dbe3a973daead"><div class="ttname"><a href="structEshelbianCore.html#a211ebd365f858409286dbe3a973daead">EshelbianCore::dynamicTime</a></div><div class="ttdeci">static double dynamicTime</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00026">EshelbianCore.hpp:26</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a227e7b13b2bd905c1803d2bc65eacf82"><div class="ttname"><a href="structEshelbianCore.html#a227e7b13b2bd905c1803d2bc65eacf82">EshelbianCore::dd_f_log</a></div><div class="ttdeci">static double dd_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00063">EshelbianCore.hpp:63</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2363fb172da13a753995b83e0555f565"><div class="ttname"><a href="structEshelbianCore.html#a2363fb172da13a753995b83e0555f565">EshelbianCore::bitAdjEnt</a></div><div class="ttdeci">BitRefLevel bitAdjEnt</div><div class="ttdoc">bit ref level for parent</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00348">EshelbianCore.hpp:348</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a23fa1126c211ab3a7d43f3fa23d48dbb"><div class="ttname"><a href="structEshelbianCore.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianCore::inv_dd_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_dd_f</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00048">EshelbianCore.hpp:48</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a243cf95e3c9987fef696e3c5547995e3"><div class="ttname"><a href="structEshelbianCore.html#a243cf95e3c9987fef696e3c5547995e3">EshelbianCore::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00095">EshelbianCore.hpp:95</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a268e2c36941c7d4d519030d525750b15"><div class="ttname"><a href="structEshelbianCore.html#a268e2c36941c7d4d519030d525750b15">EshelbianCore::spatialL2Disp</a></div><div class="ttdeci">const std::string spatialL2Disp</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00114">EshelbianCore.hpp:114</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2767660e68cb6e73ceaf90c95670cc4d"><div class="ttname"><a href="structEshelbianCore.html#a2767660e68cb6e73ceaf90c95670cc4d">EshelbianCore::inv_d_f_log</a></div><div class="ttdeci">static double inv_d_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00071">EshelbianCore.hpp:71</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a27952a5bc21bdea52329611993df67e2"><div class="ttname"><a href="structEshelbianCore.html#a27952a5bc21bdea52329611993df67e2">EshelbianCore::timeScaleMap</a></div><div class="ttdeci">std::map&lt; std::string, boost::shared_ptr&lt; ScalingMethod &gt; &gt; timeScaleMap</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00159">EshelbianCore.hpp:159</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2975cb8401f36e568b72eb027375fe40"><div class="ttname"><a href="structEshelbianCore.html#a2975cb8401f36e568b72eb027375fe40">EshelbianCore::materialOrder</a></div><div class="ttdeci">int materialOrder</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00138">EshelbianCore.hpp:138</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2ab70613ca1c05f21fc1092acf0b0585"><div class="ttname"><a href="structEshelbianCore.html#a2ab70613ca1c05f21fc1092acf0b0585">EshelbianCore::l2UserBaseScale</a></div><div class="ttdeci">static PetscBool l2UserBaseScale</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00030">EshelbianCore.hpp:30</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2cba5b9f29b7035eaa04f7cf24bb0e01"><div class="ttname"><a href="structEshelbianCore.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">EshelbianCore::dM</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dM</div><div class="ttdoc">Coupled problem all fields.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00107">EshelbianCore.hpp:107</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2d854849515a43de7542231c5dc29570"><div class="ttname"><a href="structEshelbianCore.html#a2d854849515a43de7542231c5dc29570">EshelbianCore::elasticBcRhs</a></div><div class="ttdeci">boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; elasticBcRhs</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00104">EshelbianCore.hpp:104</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a2e815fbb4f64bd271101a6bb8072c2d9"><div class="ttname"><a href="structEshelbianCore.html#a2e815fbb4f64bd271101a6bb8072c2d9">EshelbianCore::internalStressInterpOrder</a></div><div class="ttdeci">static int internalStressInterpOrder</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00037">EshelbianCore.hpp:37</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a33a23a7598af848601fa49a1eb8554a0"><div class="ttname"><a href="structEshelbianCore.html#a33a23a7598af848601fa49a1eb8554a0">EshelbianCore::projectGeometry</a></div><div class="ttdeci">MoFEMErrorCode projectGeometry(const EntityHandle meshset=0)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l01389">EshelbianPlasticity.cpp:1389</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a33c6e981d0e2ce7570cb47031d622724"><div class="ttname"><a href="structEshelbianCore.html#a33c6e981d0e2ce7570cb47031d622724">EshelbianCore::bcSpatialFreeTractionVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; TractionFreeBc &gt; bcSpatialFreeTractionVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00152">EshelbianCore.hpp:152</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a394869ab1071f6b21a9f74c3ba2ccdd5"><div class="ttname"><a href="structEshelbianCore.html#a394869ab1071f6b21a9f74c3ba2ccdd5">EshelbianCore::nbCrackFaces</a></div><div class="ttdeci">int nbCrackFaces</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00369">EshelbianCore.hpp:369</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a3bc0c136f40a18991a5f1aca01b5bd20"><div class="ttname"><a href="structEshelbianCore.html#a3bc0c136f40a18991a5f1aca01b5bd20">EshelbianCore::materialH1Positions</a></div><div class="ttdeci">const std::string materialH1Positions</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00117">EshelbianCore.hpp:117</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a3e38767261f39bd323b727fd31959284"><div class="ttname"><a href="structEshelbianCore.html#a3e38767261f39bd323b727fd31959284">EshelbianCore::setBlockTagsOnSkin</a></div><div class="ttdeci">MoFEMErrorCode setBlockTagsOnSkin()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03540">EshelbianPlasticity.cpp:3540</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a3f4520cca364a7edbf442bb09054566b"><div class="ttname"><a href="structEshelbianCore.html#a3f4520cca364a7edbf442bb09054566b">EshelbianCore::listTagsToTransfer</a></div><div class="ttdeci">std::vector&lt; Tag &gt; listTagsToTransfer</div><div class="ttdoc">list of tags to transfer to postprocessor</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00360">EshelbianCore.hpp:360</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a3fa759a191f5c61035bc28d824acea64"><div class="ttname"><a href="structEshelbianCore.html#a3fa759a191f5c61035bc28d824acea64">EshelbianCore::elasticBcLhs</a></div><div class="ttdeci">boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; elasticBcLhs</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00103">EshelbianCore.hpp:103</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a41356565364f05177e0256f536e42603"><div class="ttname"><a href="structEshelbianCore.html#a41356565364f05177e0256f536e42603">EshelbianCore::crackingOn</a></div><div class="ttdeci">static PetscBool crackingOn</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00022">EshelbianCore.hpp:22</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a44780924071e102fcb49da8bc01637e8"><div class="ttname"><a href="structEshelbianCore.html#a44780924071e102fcb49da8bc01637e8">EshelbianCore::getTractionFreeBc</a></div><div class="ttdeci">MoFEMErrorCode getTractionFreeBc(const EntityHandle meshset, boost::shared_ptr&lt; TractionFreeBc &gt; &amp;bc_ptr, const std::string contact_set_name)</div><div class="ttdoc">Remove all, but entities where kinematic constrains are applied.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l02066">EshelbianPlasticity.cpp:2066</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4530aa6762e72237e130380c7ce2ba86"><div class="ttname"><a href="structEshelbianCore.html#a4530aa6762e72237e130380c7ce2ba86">EshelbianCore::setBaseVolumeElementOps</a></div><div class="ttdeci">MoFEMErrorCode setBaseVolumeElementOps(const int tag, const bool do_rhs, const bool do_lhs, const bool calc_rates, SmartPetscObj&lt; Vec &gt; ver_vec, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; fe)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l02300">EshelbianPlasticity.cpp:2300</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4d633c514ed211820d8cd66fd2e5b2ff"><div class="ttname"><a href="structEshelbianCore.html#a4d633c514ed211820d8cd66fd2e5b2ff">EshelbianCore::calculateFaceMaterialForce</a></div><div class="ttdeci">MoFEMErrorCode calculateFaceMaterialForce(const int tag, TS ts)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l04174">EshelbianPlasticity.cpp:4174</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4e1702cd98e773ce63013875ceea4d77"><div class="ttname"><a href="structEshelbianCore.html#a4e1702cd98e773ce63013875ceea4d77">EshelbianCore::griffithEnergy</a></div><div class="ttdeci">static double griffithEnergy</div><div class="ttdoc">Griffith energy.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00032">EshelbianCore.hpp:32</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4e17c2f50f7938051a7447594733527a"><div class="ttname"><a href="structEshelbianCore.html#a4e17c2f50f7938051a7447594733527a">EshelbianCore::calculateCrackArea</a></div><div class="ttdeci">MoFEMErrorCode calculateCrackArea(boost::shared_ptr&lt; double &gt; area_ptr)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06909">EshelbianPlasticity.cpp:6909</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4e79454d5317f6599db6f06305d2ac3b"><div class="ttname"><a href="structEshelbianCore.html#a4e79454d5317f6599db6f06305d2ac3b">EshelbianCore::elasticFeRhs</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; elasticFeRhs</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00101">EshelbianCore.hpp:101</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4ed1752ba8de143ae8e6733d8713adf5"><div class="ttname"><a href="structEshelbianCore.html#a4ed1752ba8de143ae8e6733d8713adf5">EshelbianCore::dynamicStep</a></div><div class="ttdeci">static int dynamicStep</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00028">EshelbianCore.hpp:28</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a4fa3cc82efef2655314eaecdaed879dc"><div class="ttname"><a href="structEshelbianCore.html#a4fa3cc82efef2655314eaecdaed879dc">EshelbianCore::elementVolumeName</a></div><div class="ttdeci">const std::string elementVolumeName</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00125">EshelbianCore.hpp:125</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a50a7cd87dab88c005a77cc1843141fa7"><div class="ttname"><a href="structEshelbianCore.html#a50a7cd87dab88c005a77cc1843141fa7">EshelbianCore::dd_f_log_e</a></div><div class="ttdeci">static double dd_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00052">EshelbianCore.hpp:52</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a5246a7a72fbbc8943410a3de2b95647b"><div class="ttname"><a href="structEshelbianCore.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a></div><div class="ttdeci">static enum RotSelector rotSelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00015">EshelbianCore.hpp:15</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a54c8137ebc1f4abc27e14b7098aa05a6"><div class="ttname"><a href="structEshelbianCore.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a></div><div class="ttdeci">static enum RotSelector gradApproximator</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00016">EshelbianCore.hpp:16</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a56636af14eb66349e0d1fce731e9206e"><div class="ttname"><a href="structEshelbianCore.html#a56636af14eb66349e0d1fce731e9206e">EshelbianCore::getBc</a></div><div class="ttdeci">MoFEMErrorCode getBc(boost::shared_ptr&lt; BC &gt; &amp;bc_vec_ptr, const std::string block_name, const int nb_attributes)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00162">EshelbianCore.hpp:162</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a59364cd43d5094f0921953a4ab320c7f"><div class="ttname"><a href="structEshelbianCore.html#a59364cd43d5094f0921953a4ab320c7f">EshelbianCore::vertexExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector vertexExchange</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00357">EshelbianCore.hpp:357</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a5b883dfed933920248c7e23bf940d6e0"><div class="ttname"><a href="structEshelbianCore.html#a5b883dfed933920248c7e23bf940d6e0">EshelbianCore::bcSpatialRotationVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; BcRotVec &gt; bcSpatialRotationVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00150">EshelbianCore.hpp:150</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a5ce308e926b2d341c1169aad97b2b058"><div class="ttname"><a href="structEshelbianCore.html#a5ce308e926b2d341c1169aad97b2b058">EshelbianCore::maxMovedFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; maxMovedFaces</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00340">EshelbianCore.hpp:340</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a5d5c5ee0702329b9063b5e2c1ab13979"><div class="ttname"><a href="structEshelbianCore.html#a5d5c5ee0702329b9063b5e2c1ab13979">EshelbianCore::dynamicRelaxation</a></div><div class="ttdeci">static PetscBool dynamicRelaxation</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00020">EshelbianCore.hpp:20</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a624aed4afbee14e9087456a050c48387"><div class="ttname"><a href="structEshelbianCore.html#a624aed4afbee14e9087456a050c48387">EshelbianCore::spatialH1Disp</a></div><div class="ttdeci">const std::string spatialH1Disp</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00116">EshelbianCore.hpp:116</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a64e2ddd4583aa15ef34929b7c16f6abf"><div class="ttname"><a href="structEshelbianCore.html#a64e2ddd4583aa15ef34929b7c16f6abf">EshelbianCore::solveElastic</a></div><div class="ttdeci">MoFEMErrorCode solveElastic(TS ts, Vec x)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03319">EshelbianPlasticity.cpp:3319</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a6591b5a3838e0c8dc4452ec9924f1eeb"><div class="ttname"><a href="structEshelbianCore.html#a6591b5a3838e0c8dc4452ec9924f1eeb">EshelbianCore::d_f_log</a></div><div class="ttdeci">static double d_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00060">EshelbianCore.hpp:60</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a66dd0e5924196ed6d8ace9a121ef36bc"><div class="ttname"><a href="structEshelbianCore.html#a66dd0e5924196ed6d8ace9a121ef36bc">EshelbianCore::bcSpatialNormalDisplacementVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; NormalDisplacementBcVec &gt; bcSpatialNormalDisplacementVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00153">EshelbianCore.hpp:153</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a685963c45d9df97616feedef0e5d24a3"><div class="ttname"><a href="structEshelbianCore.html#a685963c45d9df97616feedef0e5d24a3">EshelbianCore::crackingStartTime</a></div><div class="ttdeci">static double crackingStartTime</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00023">EshelbianCore.hpp:23</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a6ce37c333084d7776612a9165edd487a"><div class="ttname"><a href="structEshelbianCore.html#a6ce37c333084d7776612a9165edd487a">EshelbianCore::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00919">EshelbianPlasticity.cpp:919</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a70d5bde9f06329fff6c2c75ebcd55623"><div class="ttname"><a href="structEshelbianCore.html#a70d5bde9f06329fff6c2c75ebcd55623">EshelbianCore::piolaStress</a></div><div class="ttdeci">const std::string piolaStress</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00112">EshelbianCore.hpp:112</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a74019c5d29e41cf539cd905c55497f00"><div class="ttname"><a href="structEshelbianCore.html#a74019c5d29e41cf539cd905c55497f00">EshelbianCore::setElasticElementToTs</a></div><div class="ttdeci">MoFEMErrorCode setElasticElementToTs(DM dm)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03168">EshelbianPlasticity.cpp:3168</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a7604bd31d1a798243a324bb5182ed8d3"><div class="ttname"><a href="structEshelbianCore.html#a7604bd31d1a798243a324bb5182ed8d3">EshelbianCore::inv_d_f_log_e</a></div><div class="ttdeci">static double inv_d_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00054">EshelbianCore.hpp:54</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a767ea904eb33f7f44cbdef68cfe7cdfc"><div class="ttname"><a href="structEshelbianCore.html#a767ea904eb33f7f44cbdef68cfe7cdfc">EshelbianCore::contactRefinementLevels</a></div><div class="ttdeci">int contactRefinementLevels</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00144">EshelbianCore.hpp:144</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a7980928dbcfa5bf174ac19e22784fe95"><div class="ttname"><a href="structEshelbianCore.html#a7980928dbcfa5bf174ac19e22784fe95">EshelbianCore::gettingNorms</a></div><div class="ttdeci">MoFEMErrorCode gettingNorms()</div><div class="ttdoc">[Getting norms]</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06584">EshelbianPlasticity.cpp:6584</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a7cd6409c576d393175207b84e0fcb8c9"><div class="ttname"><a href="structEshelbianCore.html#a7cd6409c576d393175207b84e0fcb8c9">EshelbianCore::spaceOrder</a></div><div class="ttdeci">int spaceOrder</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00136">EshelbianCore.hpp:136</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a7e7a066d74bb6e8258720b709490e138"><div class="ttname"><a href="structEshelbianCore.html#a7e7a066d74bb6e8258720b709490e138">EshelbianCore::setVolumeElementOps</a></div><div class="ttdeci">MoFEMErrorCode setVolumeElementOps(const int tag, const bool add_elastic, const bool add_material, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; &amp;fe_rhs, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; &amp;fe_lhs)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l02421">EshelbianPlasticity.cpp:2421</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a7ec2050d610e40a8a05a3dcabe0b40df"><div class="ttname"><a href="structEshelbianCore.html#a7ec2050d610e40a8a05a3dcabe0b40df">EshelbianCore::query_interface</a></div><div class="ttdeci">MoFEMErrorCode query_interface(boost::typeindex::type_index type_index, UnknownInterface **iface) const</div><div class="ttdoc">Getting interface of core database.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00895">EshelbianPlasticity.cpp:895</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a820bda27c3f0993550839c0e34fa6fa5"><div class="ttname"><a href="structEshelbianCore.html#a820bda27c3f0993550839c0e34fa6fa5">EshelbianCore::bubbleField</a></div><div class="ttdeci">const std::string bubbleField</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00123">EshelbianCore.hpp:123</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a832337ab1645d6112dda0d6c0573088b"><div class="ttname"><a href="structEshelbianCore.html#a832337ab1645d6112dda0d6c0573088b">EshelbianCore::solveDynamicRelaxation</a></div><div class="ttdeci">MoFEMErrorCode solveDynamicRelaxation(TS ts, Vec x)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03449">EshelbianPlasticity.cpp:3449</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a83771030c2c3ce00d9313996de065376"><div class="ttname"><a href="structEshelbianCore.html#a83771030c2c3ce00d9313996de065376">EshelbianCore::bcSpatialAnalyticalDisplacementVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; AnalyticalDisplacementBcVec &gt; bcSpatialAnalyticalDisplacementVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00154">EshelbianCore.hpp:154</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a872472e8bf68a52c384c7b1db5aaa084"><div class="ttname"><a href="structEshelbianCore.html#a872472e8bf68a52c384c7b1db5aaa084">EshelbianCore::alphaU</a></div><div class="ttdeci">double alphaU</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00139">EshelbianCore.hpp:139</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a8acc61f8b8b3e19a7a32e16f7eb1fa5b"><div class="ttname"><a href="structEshelbianCore.html#a8acc61f8b8b3e19a7a32e16f7eb1fa5b">EshelbianCore::calculateOrientation</a></div><div class="ttdeci">MoFEMErrorCode calculateOrientation(const int tag, bool set_orientation)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l04746">EshelbianPlasticity.cpp:4746</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a8b49e02a24c217a6abc9df5ca4bd7330"><div class="ttname"><a href="structEshelbianCore.html#a8b49e02a24c217a6abc9df5ca4bd7330">EshelbianCore::inv_f_log</a></div><div class="ttdeci">static double inv_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00068">EshelbianCore.hpp:68</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a8b6bd30743f5710ddc93c0e003734bcf"><div class="ttname"><a href="structEshelbianCore.html#a8b6bd30743f5710ddc93c0e003734bcf">EshelbianCore::elasticFeLhs</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; elasticFeLhs</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00102">EshelbianCore.hpp:102</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a8bf2c044ba26ef8bd7312338957d1aff"><div class="ttname"><a href="structEshelbianCore.html#a8bf2c044ba26ef8bd7312338957d1aff">EshelbianCore::noStretch</a></div><div class="ttdeci">static PetscBool noStretch</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00018">EshelbianCore.hpp:18</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a90305e24905e60449369cef8928bda5e"><div class="ttname"><a href="structEshelbianCore.html#a90305e24905e60449369cef8928bda5e">EshelbianCore::setNewFrontCoordinates</a></div><div class="ttdeci">MoFEMErrorCode setNewFrontCoordinates()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l05776">EshelbianPlasticity.cpp:5776</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a912ebbcc505570f26b497c1a788c49c0"><div class="ttname"><a href="structEshelbianCore.html#a912ebbcc505570f26b497c1a788c49c0">EshelbianCore::parentAdjSkeletonFunctionDim2</a></div><div class="ttdeci">boost::shared_ptr&lt; ParentFiniteElementAdjacencyFunctionSkeleton&lt; 2 &gt; &gt; parentAdjSkeletonFunctionDim2</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00343">EshelbianCore.hpp:343</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a936e33bf8856af5e152b56abaa83a8e1"><div class="ttname"><a href="structEshelbianCore.html#a936e33bf8856af5e152b56abaa83a8e1">EshelbianCore::contactTreeRhs</a></div><div class="ttdeci">boost::shared_ptr&lt; ContactTree &gt; contactTreeRhs</div><div class="ttdoc">Make a contact tree.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00105">EshelbianCore.hpp:105</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a96ee7d95b3ebb53145897b2ad6f3af2c"><div class="ttname"><a href="structEshelbianCore.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a></div><div class="ttdeci">static double exponentBase</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00042">EshelbianCore.hpp:42</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a973fec6048052976e4167d61468443fb"><div class="ttname"><a href="structEshelbianCore.html#a973fec6048052976e4167d61468443fb">EshelbianCore::setContactElementRhsOps</a></div><div class="ttdeci">MoFEMErrorCode setContactElementRhsOps(boost::shared_ptr&lt; ContactTree &gt; &amp;fe_contact_tree)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03046">EshelbianPlasticity.cpp:3046</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a98338d042e94f47e4b0cc5a6e4ede06f"><div class="ttname"><a href="structEshelbianCore.html#a98338d042e94f47e4b0cc5a6e4ede06f">EshelbianCore::dd_f_linear</a></div><div class="ttdeci">static double dd_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00080">EshelbianCore.hpp:80</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_a99a3132d0ad53b6ca41822303148d2d6"><div class="ttname"><a href="structEshelbianCore.html#a99a3132d0ad53b6ca41822303148d2d6">EshelbianCore::setFaceElementOps</a></div><div class="ttdeci">MoFEMErrorCode setFaceElementOps(const bool add_elastic, const bool add_material, boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; &amp;fe_rhs, boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; &amp;fe_lhs)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l02901">EshelbianPlasticity.cpp:2901</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aa00b5c9f71aa0f555fab7e4400d809c8"><div class="ttname"><a href="structEshelbianCore.html#aa00b5c9f71aa0f555fab7e4400d809c8">EshelbianCore::AnalyticalExprPythonPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; AnalyticalExprPython &gt; AnalyticalExprPythonPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00099">EshelbianCore.hpp:99</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aa1d0ed0c1c01316acde2753c3c1f0733"><div class="ttname"><a href="structEshelbianCore.html#aa1d0ed0c1c01316acde2753c3c1f0733">EshelbianCore::spaceH1Order</a></div><div class="ttdeci">int spaceH1Order</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00137">EshelbianCore.hpp:137</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aa5f11b90ad8c461a7dadf74478653104"><div class="ttname"><a href="structEshelbianCore.html#aa5f11b90ad8c461a7dadf74478653104">EshelbianCore::skeletonFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; skeletonFaces</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00338">EshelbianCore.hpp:338</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aa69db0ae4b4608a3cd24d92e0191cad0"><div class="ttname"><a href="structEshelbianCore.html#aa69db0ae4b4608a3cd24d92e0191cad0">EshelbianCore::physicalEquations</a></div><div class="ttdeci">boost::shared_ptr&lt; PhysicalEquations &gt; physicalEquations</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00098">EshelbianCore.hpp:98</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aaa49e9f07f0027b8905bec41e11cabb5"><div class="ttname"><a href="structEshelbianCore.html#aaa49e9f07f0027b8905bec41e11cabb5">EshelbianCore::rotAxis</a></div><div class="ttdeci">const std::string rotAxis</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00122">EshelbianCore.hpp:122</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aae203dfeaee5453b2400a66b729b7005"><div class="ttname"><a href="structEshelbianCore.html#aae203dfeaee5453b2400a66b729b7005">EshelbianCore::inv_d_f_linear</a></div><div class="ttdeci">static double inv_d_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00083">EshelbianCore.hpp:83</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aaf238d1b79dcea860e0648463d07e698"><div class="ttname"><a href="structEshelbianCore.html#aaf238d1b79dcea860e0648463d07e698">EshelbianCore::bitAdjParentMask</a></div><div class="ttdeci">BitRefLevel bitAdjParentMask</div><div class="ttdoc">bit ref level for parent parent</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00346">EshelbianCore.hpp:346</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aafaa9cff0830a9a3e5e5cb00c072b47d"><div class="ttname"><a href="structEshelbianCore.html#aafaa9cff0830a9a3e5e5cb00c072b47d">EshelbianCore::inv_dd_f_log</a></div><div class="ttdeci">static double inv_dd_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00074">EshelbianCore.hpp:74</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aafc4229f9ca50146bbb5d7d51c7482ef"><div class="ttname"><a href="structEshelbianCore.html#aafc4229f9ca50146bbb5d7d51c7482ef">EshelbianCore::contactDisp</a></div><div class="ttdeci">const std::string contactDisp</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00120">EshelbianCore.hpp:120</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab044f8f937f13870116659ed15897b37"><div class="ttname"><a href="structEshelbianCore.html#ab044f8f937f13870116659ed15897b37">EshelbianCore::internalStressTagName</a></div><div class="ttdeci">static std::string internalStressTagName</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00035">EshelbianCore.hpp:35</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab0f304517b059efe9c099a16f8c96bc4"><div class="ttname"><a href="structEshelbianCore.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a></div><div class="ttdeci">static enum SymmetrySelector symmetrySelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00014">EshelbianCore.hpp:14</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab1bb40274b0b343f49fc45bc2d3de293"><div class="ttname"><a href="structEshelbianCore.html#ab1bb40274b0b343f49fc45bc2d3de293">EshelbianCore::edgeExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector edgeExchange</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00356">EshelbianCore.hpp:356</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab3a74e8bad817899b61feff3720d6243"><div class="ttname"><a href="structEshelbianCore.html#ab3a74e8bad817899b61feff3720d6243">EshelbianCore::dmPrjSpatial</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dmPrjSpatial</div><div class="ttdoc">Projection spatial displacement.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00110">EshelbianCore.hpp:110</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab45e7deb10ac286200a45b8ed18d46c0"><div class="ttname"><a href="structEshelbianCore.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianCore::f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; f</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00043">EshelbianCore.hpp:43</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab71b3402dafb45b0d6d87cbea4dc3200"><div class="ttname"><a href="structEshelbianCore.html#ab71b3402dafb45b0d6d87cbea4dc3200">EshelbianCore::bcSpatialDispVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; BcDispVec &gt; bcSpatialDispVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00149">EshelbianCore.hpp:149</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab80783a2910e61c39f8e09c389ebce28"><div class="ttname"><a href="structEshelbianCore.html#ab80783a2910e61c39f8e09c389ebce28">EshelbianCore::skinElement</a></div><div class="ttdeci">const std::string skinElement</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00127">EshelbianCore.hpp:127</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab85ab2a5287eb2124aea7db52e8e4556"><div class="ttname"><a href="structEshelbianCore.html#ab85ab2a5287eb2124aea7db52e8e4556">EshelbianCore::internalStressVoigt</a></div><div class="ttdeci">static PetscBool internalStressVoigt</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00039">EshelbianCore.hpp:39</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ab8a03cc8007a0a926b9387941141303f"><div class="ttname"><a href="structEshelbianCore.html#ab8a03cc8007a0a926b9387941141303f">EshelbianCore::inv_dd_f_linear</a></div><div class="ttdeci">static double inv_dd_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00084">EshelbianCore.hpp:84</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_abc4d27f47349318bcd8cae743385e83a"><div class="ttname"><a href="structEshelbianCore.html#abc4d27f47349318bcd8cae743385e83a">EshelbianCore::inv_dd_f_log_e</a></div><div class="ttdeci">static double inv_dd_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00055">EshelbianCore.hpp:55</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_abe428bafdc99ed99e87012f5726e825f"><div class="ttname"><a href="structEshelbianCore.html#abe428bafdc99ed99e87012f5726e825f">EshelbianCore::getExternalStrain</a></div><div class="ttdeci">MoFEMErrorCode getExternalStrain()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06830">EshelbianPlasticity.cpp:6830</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_abe81e33c3abf7e604dfafb99cac6eca4"><div class="ttname"><a href="structEshelbianCore.html#abe81e33c3abf7e604dfafb99cac6eca4">EshelbianCore::getSpatialTractionBc</a></div><div class="ttdeci">MoFEMErrorCode getSpatialTractionBc()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06746">EshelbianPlasticity.cpp:6746</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_abfb627d240daa3e65a6c556d486c3775"><div class="ttname"><a href="structEshelbianCore.html#abfb627d240daa3e65a6c556d486c3775">EshelbianCore::setSingularity</a></div><div class="ttdeci">static PetscBool setSingularity</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00019">EshelbianCore.hpp:19</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ac07c5f6b76ff465acb78b4cb487fe32e"><div class="ttname"><a href="structEshelbianCore.html#ac07c5f6b76ff465acb78b4cb487fe32e">EshelbianCore::~EshelbianCore</a></div><div class="ttdeci">virtual ~EshelbianCore()</div></div>
<div class="ttc" id="astructEshelbianCore_html_ac1cb92ee0356ce898bfecc6c30a83b87"><div class="ttname"><a href="structEshelbianCore.html#ac1cb92ee0356ce898bfecc6c30a83b87">EshelbianCore::d_f_log_e</a></div><div class="ttdeci">static double d_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00051">EshelbianCore.hpp:51</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ac26447e92e73ca32ffe8130dc935dae6"><div class="ttname"><a href="structEshelbianCore.html#ac26447e92e73ca32ffe8130dc935dae6">EshelbianCore::bcSpatialAnalyticalTractionVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; AnalyticalTractionBcVec &gt; bcSpatialAnalyticalTractionVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00155">EshelbianCore.hpp:155</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ac8679fd9e50259c4b65dcd1a21485556"><div class="ttname"><a href="structEshelbianCore.html#ac8679fd9e50259c4b65dcd1a21485556">EshelbianCore::nbJIntegralLevels</a></div><div class="ttdeci">static int nbJIntegralLevels</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00024">EshelbianCore.hpp:24</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ac8bb12e0051c67e32fc448679f97d6bc"><div class="ttname"><a href="structEshelbianCore.html#ac8bb12e0051c67e32fc448679f97d6bc">EshelbianCore::addCrackSurfaces</a></div><div class="ttdeci">MoFEMErrorCode addCrackSurfaces(const bool debug=false)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l05815">EshelbianPlasticity.cpp:5815</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ac9225b726d868b3097e7fc41be2b3acc"><div class="ttname"><a href="structEshelbianCore.html#ac9225b726d868b3097e7fc41be2b3acc">EshelbianCore::addDMs</a></div><div class="ttdeci">MoFEMErrorCode addDMs(const BitRefLevel bit=BitRefLevel().set(0), const EntityHandle meshset=0)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l01779">EshelbianPlasticity.cpp:1779</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ac9603548235b69643ca7b25eebbf7382"><div class="ttname"><a href="structEshelbianCore.html#ac9603548235b69643ca7b25eebbf7382">EshelbianCore::alphaOmega</a></div><div class="ttdeci">double alphaOmega</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00141">EshelbianCore.hpp:141</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_acd3d79e5922a80cab13f88ff96518c2a"><div class="ttname"><a href="structEshelbianCore.html#acd3d79e5922a80cab13f88ff96518c2a">EshelbianCore::getSpatialDispBc</a></div><div class="ttdeci">MoFEMErrorCode getSpatialDispBc()</div><div class="ttdoc">[Getting norms]</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06652">EshelbianPlasticity.cpp:6652</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_acdf2dd025fc4286ff5719a079c2e61ac"><div class="ttname"><a href="structEshelbianCore.html#acdf2dd025fc4286ff5719a079c2e61ac">EshelbianCore::bitAdjParent</a></div><div class="ttdeci">BitRefLevel bitAdjParent</div><div class="ttdoc">bit ref level for parent</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00345">EshelbianCore.hpp:345</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ad481b72d51e6377015a74f929bc6a672"><div class="ttname"><a href="structEshelbianCore.html#ad481b72d51e6377015a74f929bc6a672">EshelbianCore::volumeExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector volumeExchange</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00354">EshelbianCore.hpp:354</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ad4d96dc6ab5dd848b7d8eebf1a08030b"><div class="ttname"><a href="structEshelbianCore.html#ad4d96dc6ab5dd848b7d8eebf1a08030b">EshelbianCore::saveOrgCoords</a></div><div class="ttdeci">MoFEMErrorCode saveOrgCoords()</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06552">EshelbianPlasticity.cpp:6552</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ad555ca904803947040a57fd7f056de86"><div class="ttname"><a href="structEshelbianCore.html#ad555ca904803947040a57fd7f056de86">EshelbianCore::naturalBcElement</a></div><div class="ttdeci">const std::string naturalBcElement</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00126">EshelbianCore.hpp:126</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_add0b04f5998d17d579b7b5192cb1ccec"><div class="ttname"><a href="structEshelbianCore.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianCore::dd_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; dd_f</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00045">EshelbianCore.hpp:45</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_add41a67a6d5f76559b0657f214048e8c"><div class="ttname"><a href="structEshelbianCore.html#add41a67a6d5f76559b0657f214048e8c">EshelbianCore::f_log_e</a></div><div class="ttdeci">static double f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00050">EshelbianCore.hpp:50</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_adf7e1000f83af8932625eacd97fcf29b"><div class="ttname"><a href="structEshelbianCore.html#adf7e1000f83af8932625eacd97fcf29b">EshelbianCore::addCrackMeshsetId</a></div><div class="ttdeci">static int addCrackMeshsetId</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00031">EshelbianCore.hpp:31</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae0d5b73078de40a8ce3ca5a8863c6939"><div class="ttname"><a href="structEshelbianCore.html#ae0d5b73078de40a8ce3ca5a8863c6939">EshelbianCore::inv_f_log_e</a></div><div class="ttdeci">static double inv_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00053">EshelbianCore.hpp:53</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae1b21da25a876c11c40d9878f299c8a3"><div class="ttname"><a href="structEshelbianCore.html#ae1b21da25a876c11c40d9878f299c8a3">EshelbianCore::createExchangeVectors</a></div><div class="ttdeci">MoFEMErrorCode createExchangeVectors(Sev sev)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l06877">EshelbianPlasticity.cpp:6877</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae29198561959eabf72440debf723bf03"><div class="ttname"><a href="structEshelbianCore.html#ae29198561959eabf72440debf723bf03">EshelbianCore::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00097">EshelbianCore.hpp:97</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae30a1bd4e4b24d06251fae84c4922978"><div class="ttname"><a href="structEshelbianCore.html#ae30a1bd4e4b24d06251fae84c4922978">EshelbianCore::crackFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; crackFaces</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00334">EshelbianCore.hpp:334</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae4d99bb98048fba86b627784979fc1e3"><div class="ttname"><a href="structEshelbianCore.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianCore::d_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; d_f</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00044">EshelbianCore.hpp:44</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae7f8e5ee2904085fee03a8f784b71901"><div class="ttname"><a href="structEshelbianCore.html#ae7f8e5ee2904085fee03a8f784b71901">EshelbianCore::frontVertices</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontVertices</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00337">EshelbianCore.hpp:337</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae8387101883105f158f223898dcc0cb8"><div class="ttname"><a href="structEshelbianCore.html#ae8387101883105f158f223898dcc0cb8">EshelbianCore::energyReleaseSelector</a></div><div class="ttdeci">static enum EnergyReleaseSelector energyReleaseSelector</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00033">EshelbianCore.hpp:33</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_ae9ec3b2026489759599ce71e048ca5a6"><div class="ttname"><a href="structEshelbianCore.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianCore::inv_d_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_d_f</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00047">EshelbianCore.hpp:47</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aea2d34678dea9dde4e33e4398d181b05"><div class="ttname"><a href="structEshelbianCore.html#aea2d34678dea9dde4e33e4398d181b05">EshelbianCore::bcSpatialPressureVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; PressureBcVec &gt; bcSpatialPressureVecPtr</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00156">EshelbianCore.hpp:156</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aeb84ef335d710054abe0411d4672d3eb"><div class="ttname"><a href="structEshelbianCore.html#aeb84ef335d710054abe0411d4672d3eb">EshelbianCore::d_f_linear</a></div><div class="ttdeci">static double d_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00079">EshelbianCore.hpp:79</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aec476e20bd019e3cb5d0d1584518e31c"><div class="ttname"><a href="structEshelbianCore.html#aec476e20bd019e3cb5d0d1584518e31c">EshelbianCore::hybridSpatialDisp</a></div><div class="ttdeci">const std::string hybridSpatialDisp</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00118">EshelbianCore.hpp:118</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aec7eec34db87d222944bbaf74cf7c0f3"><div class="ttname"><a href="structEshelbianCore.html#aec7eec34db87d222944bbaf74cf7c0f3">EshelbianCore::solTSStep</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; solTSStep</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00352">EshelbianCore.hpp:352</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aec89ac53f8bdf554768e788c8aa48282"><div class="ttname"><a href="structEshelbianCore.html#aec89ac53f8bdf554768e788c8aa48282">EshelbianCore::f_log</a></div><div class="ttdeci">static double f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00057">EshelbianCore.hpp:57</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_aed90af306007a2750053f12415168c7e"><div class="ttname"><a href="structEshelbianCore.html#aed90af306007a2750053f12415168c7e">EshelbianCore::faceExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector faceExchange</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00355">EshelbianCore.hpp:355</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af24d4b3e9aa4f578300ee454fe66fe9e"><div class="ttname"><a href="structEshelbianCore.html#af24d4b3e9aa4f578300ee454fe66fe9e">EshelbianCore::dmElastic</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dmElastic</div><div class="ttdoc">Elastic problem.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00108">EshelbianCore.hpp:108</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af5300bd764a6432f701ebff075f6e5ba"><div class="ttname"><a href="structEshelbianCore.html#af5300bd764a6432f701ebff075f6e5ba">EshelbianCore::EshelbianCore</a></div><div class="ttdeci">EshelbianCore(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00913">EshelbianPlasticity.cpp:913</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af61a919de6b8c2c847562e9dc864db72"><div class="ttname"><a href="structEshelbianCore.html#af61a919de6b8c2c847562e9dc864db72">EshelbianCore::frontEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontEdges</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00335">EshelbianCore.hpp:335</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af6c7c52dde40c4a5f90afda29a7dad8f"><div class="ttname"><a href="structEshelbianCore.html#af6c7c52dde40c4a5f90afda29a7dad8f">EshelbianCore::postProcessResults</a></div><div class="ttdeci">MoFEMErrorCode postProcessResults(const int tag, const std::string file, Vec f_residual=PETSC_NULL, Vec var_vec=PETSC_NULL, std::vector&lt; Tag &gt; tags_to_transfer={})</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l03601">EshelbianPlasticity.cpp:3601</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af7ccd7dc45717d0ffb0f183b95c81919"><div class="ttname"><a href="structEshelbianCore.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianCore::inv_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_f</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00046">EshelbianCore.hpp:46</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af7fd8cd195c5edee463761f2c8e785b1"><div class="ttname"><a href="structEshelbianCore.html#af7fd8cd195c5edee463761f2c8e785b1">EshelbianCore::stretchTensor</a></div><div class="ttdeci">const std::string stretchTensor</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00121">EshelbianCore.hpp:121</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_af87b5b277e9ed4a79838f7a04bf7c36f"><div class="ttname"><a href="structEshelbianCore.html#af87b5b277e9ed4a79838f7a04bf7c36f">EshelbianCore::bitAdjEntMask</a></div><div class="ttdeci">BitRefLevel bitAdjEntMask</div><div class="ttdoc">bit ref level for parent parent</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00349">EshelbianCore.hpp:349</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_afa60d86e456beaabddc2df730598719d"><div class="ttname"><a href="structEshelbianCore.html#afa60d86e456beaabddc2df730598719d">EshelbianCore::f_linear</a></div><div class="ttdeci">static double f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00078">EshelbianCore.hpp:78</a></div></div>
<div class="ttc" id="astructEshelbianCore_html_affca8de1319ab1c42f5a3fa6545996d7"><div class="ttname"><a href="structEshelbianCore.html#affca8de1319ab1c42f5a3fa6545996d7">EshelbianCore::contactElement</a></div><div class="ttdeci">const std::string contactElement</div><div class="ttdef"><b>Definition</b> <a href="EshelbianCore_8hpp_source.html#l00129">EshelbianCore.hpp:129</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryHDivLhs__dU_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivLhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryHDivLhs_dU</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianContact_8hpp_source.html#l00198">EshelbianContact.hpp:198</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryHDivRhs_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivRhs.html">EshelbianPlasticity::OpConstrainBoundaryHDivRhs</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianContact_8hpp_source.html#l00134">EshelbianContact.hpp:134</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dP_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dP.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianContact_8hpp_source.html#l00172">EshelbianContact.hpp:172</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dU_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dU</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianContact_8hpp_source.html#l00155">EshelbianContact.hpp:155</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryL2Rhs_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Rhs.html">EshelbianPlasticity::OpConstrainBoundaryL2Rhs</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianContact_8hpp_source.html#l00118">EshelbianContact.hpp:118</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_a1ac01e671446b017b5e60b592229bc51"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a1ac01e671446b017b5e60b592229bc51">EshelbianPlasticity::SetIntegrationAtFrontFace::funRule</a></div><div class="ttdeci">FunRule funRule</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00619">EshelbianPlasticity.cpp:619</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_a55a01ba77a1e9a4e923d95a00214d5ea"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#a55a01ba77a1e9a4e923d95a00214d5ea">EshelbianPlasticity::SetIntegrationAtFrontFace::frontNodes</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontNodes</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00875">EshelbianPlasticity.cpp:875</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_abbdb6a592360dd706ccd289d8503c01a"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbdb6a592360dd706ccd289d8503c01a">EshelbianPlasticity::SetIntegrationAtFrontFace::SetIntegrationAtFrontFace</a></div><div class="ttdeci">SetIntegrationAtFrontFace(boost::shared_ptr&lt; Range &gt; front_nodes, boost::shared_ptr&lt; Range &gt; front_edges)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00621">EshelbianPlasticity.cpp:621</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_abbf66122eef1dc218551708d7fc511b5"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#abbf66122eef1dc218551708d7fc511b5">EshelbianPlasticity::SetIntegrationAtFrontFace::frontEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontEdges</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00876">EshelbianPlasticity.cpp:876</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_acfb56894c8f6f6f19efb78873efb4d18"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#acfb56894c8f6f6f19efb78873efb4d18">EshelbianPlasticity::SetIntegrationAtFrontFace::FunRule</a></div><div class="ttdeci">boost::function&lt; int(int)&gt; FunRule</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00618">EshelbianPlasticity.cpp:618</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_ad294721b379a4a6cea8db53b27fac1ec"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad294721b379a4a6cea8db53b27fac1ec">EshelbianPlasticity::SetIntegrationAtFrontFace::operator()</a></div><div class="ttdeci">MoFEMErrorCode operator()(ForcesAndSourcesCore *fe_raw_ptr, int order_row, int order_col, int order_data)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00630">EshelbianPlasticity.cpp:630</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontFace_html_ad6a979fd7063ce295a2d5838ff85ee21"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontFace.html#ad6a979fd7063ce295a2d5838ff85ee21">EshelbianPlasticity::SetIntegrationAtFrontFace::mapRefCoords</a></div><div class="ttdeci">static std::map&lt; long int, MatrixDouble &gt; mapRefCoords</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00878">EshelbianPlasticity.cpp:878</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontVolume_html_a1b019460b638fe37940b91de58a6e910"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1b019460b638fe37940b91de58a6e910">EshelbianPlasticity::SetIntegrationAtFrontVolume::operator()</a></div><div class="ttdeci">MoFEMErrorCode operator()(ForcesAndSourcesCore *fe_raw_ptr, int order_row, int order_col, int order_data)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00366">EshelbianPlasticity.cpp:366</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontVolume_html_a1e20c2dfc8d0572a6a3ba832fc309894"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a1e20c2dfc8d0572a6a3ba832fc309894">EshelbianPlasticity::SetIntegrationAtFrontVolume::frontNodes</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontNodes</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00610">EshelbianPlasticity.cpp:610</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontVolume_html_a624e7331dfc478ad470f2e0a40fb7cc5"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a624e7331dfc478ad470f2e0a40fb7cc5">EshelbianPlasticity::SetIntegrationAtFrontVolume::mapRefCoords</a></div><div class="ttdeci">static std::map&lt; long int, MatrixDouble &gt; mapRefCoords</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00613">EshelbianPlasticity.cpp:613</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontVolume_html_a7dc972d07b328600c38de68bd13b3d85"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#a7dc972d07b328600c38de68bd13b3d85">EshelbianPlasticity::SetIntegrationAtFrontVolume::SetIntegrationAtFrontVolume</a></div><div class="ttdeci">SetIntegrationAtFrontVolume(boost::shared_ptr&lt; Range &gt; front_nodes, boost::shared_ptr&lt; Range &gt; front_edges)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00362">EshelbianPlasticity.cpp:362</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1SetIntegrationAtFrontVolume_html_ab7b229f126666030c6df2f79152acd6c"><div class="ttname"><a href="structEshelbianPlasticity_1_1SetIntegrationAtFrontVolume.html#ab7b229f126666030c6df2f79152acd6c">EshelbianPlasticity::SetIntegrationAtFrontVolume::frontEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontEdges</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00611">EshelbianPlasticity.cpp:611</a></div></div>
<div class="ttc" id="astructFaceRule_html"><div class="ttname"><a href="structFaceRule.html">FaceRule</a></div><div class="ttdoc">Set integration rule to boundary elements.</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00091">simple_interface.cpp:91</a></div></div>
<div class="ttc" id="astructFaceRule_html_aa4dbe8a983fafee94833d9f28e4eb5bf"><div class="ttname"><a href="structFaceRule.html#aa4dbe8a983fafee94833d9f28e4eb5bf">FaceRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00092">simple_interface.cpp:92</a></div></div>
<div class="ttc" id="astructLieGroups_1_1SO3_html_af80491b46de29b3959da57bb3bfce5b9"><div class="ttname"><a href="structLieGroups_1_1SO3.html#af80491b46de29b3959da57bb3bfce5b9">LieGroups::SO3::exp</a></div><div class="ttdeci">static auto exp(A &amp;&amp;t_w_vee, B &amp;&amp;theta)</div><div class="ttdef"><b>Definition</b> <a href="Lie_8hpp_source.html#l00048">Lie.hpp:48</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BaseFunctionUnknownInterface_html"><div class="ttname"><a href="structMoFEM_1_1BaseFunctionUnknownInterface.html">MoFEM::BaseFunctionUnknownInterface</a></div><div class="ttdef"><b>Definition</b> <a href="BaseFunction_8hpp_source.html#l00013">BaseFunction.hpp:13</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BaseFunction_html_a401db54065b0887d68f81f7f806a08d4"><div class="ttname"><a href="structMoFEM_1_1BaseFunction.html#a401db54065b0887d68f81f7f806a08d4">MoFEM::BaseFunction::DofsSideMap</a></div><div class="ttdeci">multi_index_container&lt; DofsSideMapData, indexed_by&lt; ordered_non_unique&lt; tag&lt; TypeSide_mi_tag &gt;, composite_key&lt; DofsSideMapData, member&lt; DofsSideMapData, EntityType, &amp;DofsSideMapData::type &gt;, member&lt; DofsSideMapData, int, &amp;DofsSideMapData::side &gt; &gt; &gt;, ordered_unique&lt; tag&lt; EntDofIdx_mi_tag &gt;, member&lt; DofsSideMapData, int, &amp;DofsSideMapData::dof &gt; &gt; &gt; &gt; DofsSideMap</div><div class="ttdoc">Map entity stype and side to element/entity dof index.</div><div class="ttdef"><b>Definition</b> <a href="BaseFunction_8hpp_source.html#l00055">BaseFunction.hpp:73</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BcManager_html"><div class="ttname"><a href="structMoFEM_1_1BcManager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition</b> <a href="BcManager_8hpp_source.html#l00029">BcManager.hpp:29</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BcManager_html_ad0bbc182baa1622340dbf96ce6da5ef2"><div class="ttname"><a href="structMoFEM_1_1BcManager.html#ad0bbc182baa1622340dbf96ce6da5ef2">MoFEM::BcManager::pushMarkDOFsOnEntities</a></div><div class="ttdeci">MoFEMErrorCode pushMarkDOFsOnEntities(const std::string problem_name, const std::string block_name, const std::string field_name, int lo, int hi, bool get_low_dim_ents=true)</div><div class="ttdoc">Mark block DOFs.</div><div class="ttdef"><b>Definition</b> <a href="BcManager_8cpp_source.html#l00110">BcManager.cpp:110</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="BitRefManager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CommInterface_html"><div class="ttname"><a href="structMoFEM_1_1CommInterface.html">MoFEM::CommInterface</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="CommInterface_8hpp_source.html#l00021">CommInterface.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a093526a60371b07213a0be2aaf7afa35"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a093526a60371b07213a0be2aaf7afa35">MoFEM::CoreInterface::get_comm_size</a></div><div class="ttdeci">virtual int get_comm_size() const =0</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a4a1460f62976a6d7224b1c280cecedfc"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a4a1460f62976a6d7224b1c280cecedfc">MoFEM::CoreInterface::add_broken_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_broken_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const std::vector&lt; std::pair&lt; EntityType, std::function&lt; MoFEMErrorCode(BaseFunction::DofsSideMap &amp;)&gt; &gt; &gt; list_dof_side_map, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a63fc22416f2a0fbdea7406d3aa21fd17"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">MoFEM::CoreInterface::check_finite_element</a></div><div class="ttdeci">virtual bool check_finite_element(const std::string &amp;name) const =0</div><div class="ttdoc">Check if finite element is in database.</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a8008ad16315eb609dcb0fd88746b991a"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a9b2bc8c1b980f49d31a0b5f7fbe756f5"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp.html">MoFEM::CoreTmp</a></div><div class="ttdef"><b>Definition</b> <a href="Core_8hpp_source.html#l00036">Core.hpp:36</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DisplacementCubitBcData_html"><div class="ttname"><a href="structMoFEM_1_1DisplacementCubitBcData.html">MoFEM::DisplacementCubitBcData</a></div><div class="ttdoc">Definition of the displacement bc data structure.</div><div class="ttdef"><b>Definition</b> <a href="BCData_8hpp_source.html#l00072">BCData.hpp:72</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntPolynomialBaseCtx_html"><div class="ttname"><a href="structMoFEM_1_1EntPolynomialBaseCtx.html">MoFEM::EntPolynomialBaseCtx</a></div><div class="ttdoc">Class used to pass element data to calculate base functions on tet,triangle,edge.</div><div class="ttdef"><b>Definition</b> <a href="EntPolynomialBaseCtx_8hpp_source.html#l00022">EntPolynomialBaseCtx.hpp:22</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData.html">MoFEM::EntitiesFieldData</a></div><div class="ttdoc">data structure for finite element entity</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l00040">EntitiesFieldData.hpp:40</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_html_a7cb7671c28a28a884b3b7590c821244f"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">MoFEM::EntitiesFieldData::dataOnEntities</a></div><div class="ttdeci">std::array&lt; boost::ptr_vector&lt; EntData &gt;, MBMAXTYPE &gt; dataOnEntities</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l00057">EntitiesFieldData.hpp:57</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00094">FaceElementForcesAndSourcesCore.hpp:95</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FieldBlas_html"><div class="ttname"><a href="structMoFEM_1_1FieldBlas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition</b> <a href="FieldBlas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Field_html"><div class="ttname"><a href="structMoFEM_1_1Field.html">MoFEM::Field</a></div><div class="ttdoc">Provide data structure for (tensor) field approximation.</div><div class="ttdef"><b>Definition</b> <a href="FieldMultiIndices_8hpp_source.html#l00051">FieldMultiIndices.hpp:51</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForceCubitBcData_html"><div class="ttname"><a href="structMoFEM_1_1ForceCubitBcData.html">MoFEM::ForceCubitBcData</a></div><div class="ttdoc">Definition of the force bc data structure.</div><div class="ttdef"><b>Definition</b> <a href="BCData_8hpp_source.html#l00135">BCData.hpp:135</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html">MoFEM::ForcesAndSourcesCore</a></div><div class="ttdoc">structure to get information form mofem into EntitiesFieldData</div><div class="ttdef"><b>Definition</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00022">ForcesAndSourcesCore.hpp:22</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_a91c6f5f96b8f4ec76ed7c87ea96bbd9c"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#a91c6f5f96b8f4ec76ed7c87ea96bbd9c">MoFEM::ForcesAndSourcesCore::gaussPts</a></div><div class="ttdeci">MatrixDouble gaussPts</div><div class="ttdoc">Matrix of integration points.</div><div class="ttdef"><b>Definition</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00109">ForcesAndSourcesCore.hpp:109</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_ac1d7ee38dde697833773a3b8cb197a76"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#ac1d7ee38dde697833773a3b8cb197a76">MoFEM::ForcesAndSourcesCore::mField</a></div><div class="ttdeci">Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00024">ForcesAndSourcesCore.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FormsIntegrators_1_1Assembly_html"><div class="ttname"><a href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">MoFEM::FormsIntegrators::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition</b> <a href="FormsIntegrators_8hpp_source.html#l00317">FormsIntegrators.hpp:317</a></div></div>
<div class="ttc" id="astructMoFEM_1_1GetBlockScalingMethod_html"><div class="ttname"><a href="structMoFEM_1_1GetBlockScalingMethod.html">MoFEM::GetBlockScalingMethod</a></div><div class="ttdoc">get time scaling method</div><div class="ttdef"><b>Definition</b> <a href="ScalingMethod_8hpp_source.html#l00107">ScalingMethod.hpp:107</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ISManager_html"><div class="ttname"><a href="structMoFEM_1_1ISManager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition</b> <a href="ISManager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html">MoFEM::MeshRefinement</a></div><div class="ttdoc">Mesh refinement interface.</div><div class="ttdef"><b>Definition</b> <a href="MeshRefinement_8hpp_source.html#l00026">MeshRefinement.hpp:26</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astructMoFEM_1_1NaturalBC_html"><div class="ttname"><a href="structMoFEM_1_1NaturalBC.html">MoFEM::NaturalBC</a></div><div class="ttdoc">Natural boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="Natural_8hpp_source.html#l00057">Natural.hpp:57</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpBrokenLoopSide_html"><div class="ttname"><a href="structMoFEM_1_1OpBrokenLoopSide.html">MoFEM::OpBrokenLoopSide</a></div><div class="ttdef"><b>Definition</b> <a href="FormsBrokenSpaceConstraintImpl_8hpp_source.html#l00015">FormsBrokenSpaceConstraintImpl.hpp:15</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalcNormL2Tensor1_html"><div class="ttname"><a href="structMoFEM_1_1OpCalcNormL2Tensor1.html">MoFEM::OpCalcNormL2Tensor1</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor1.</div><div class="ttdef"><b>Definition</b> <a href="NormsOperators_8hpp_source.html#l00044">NormsOperators.hpp:44</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalcNormL2Tensor2_html"><div class="ttname"><a href="structMoFEM_1_1OpCalcNormL2Tensor2.html">MoFEM::OpCalcNormL2Tensor2</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor2.</div><div class="ttdef"><b>Definition</b> <a href="NormsOperators_8hpp_source.html#l00072">NormsOperators.hpp:72</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHTensorTensorField_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHTensorTensorField.html">MoFEM::OpCalculateHTensorTensorField</a></div><div class="ttdoc">Calculate tenor field using tensor base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l02871">UserDataOperators.hpp:2872</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorDivergence_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorDivergence.html">MoFEM::OpCalculateHVecTensorDivergence</a></div><div class="ttdoc">Calculate divergence of tonsorial field using vectorial base.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l02966">UserDataOperators.hpp:2967</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorField_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorField.html">MoFEM::OpCalculateHVecTensorField</a></div><div class="ttdoc">Calculate tenor field using vectorial base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l02644">UserDataOperators.hpp:2645</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorTrace_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">MoFEM::OpCalculateHVecTensorTrace</a></div><div class="ttdoc">Calculate trace of vector (Hdiv/Hcurl) space.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l03200">UserDataOperators.hpp:3200</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateTensor2SymmetricFieldValuesDot_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValuesDot.html">MoFEM::OpCalculateTensor2SymmetricFieldValuesDot</a></div><div class="ttdoc">Calculate symmetric tensor field rates ant integratio pts.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01097">UserDataOperators.hpp:1098</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateTensor2SymmetricFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">MoFEM::OpCalculateTensor2SymmetricFieldValues</a></div><div class="ttdoc">Calculate symmetric tensor field values at integration pts.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01003">UserDataOperators.hpp:1004</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradientDot_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradientDot.html">MoFEM::OpCalculateVectorFieldGradientDot</a></div><div class="ttdoc">Get field gradients time derivative at integration pts for scalar field rank 0, i....</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01576">UserDataOperators.hpp:1577</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">MoFEM::OpCalculateVectorFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar field rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01561">UserDataOperators.hpp:1563</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">MoFEM::OpCalculateVectorFieldValuesFromPetscVecImpl</a></div><div class="ttdoc">Approximate field values for given petsc vector.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l00597">UserDataOperators.hpp:598</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldValues.html">MoFEM::OpCalculateVectorFieldValues</a></div><div class="ttdoc">Get values at integration pts for tensor field rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l00468">UserDataOperators.hpp:470</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpGetBrokenBaseSideData_html"><div class="ttname"><a href="structMoFEM_1_1OpGetBrokenBaseSideData.html">MoFEM::OpGetBrokenBaseSideData</a></div><div class="ttdef"><b>Definition</b> <a href="FormsBrokenSpaceConstraintImpl_8hpp_source.html#l00068">FormsBrokenSpaceConstraintImpl.hpp:68</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpLoopSide_html"><div class="ttname"><a href="structMoFEM_1_1OpLoopSide.html">MoFEM::OpLoopSide</a></div><div class="ttdoc">Element used to execute operators on side of the element.</div><div class="ttdef"><b>Definition</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l01307">ForcesAndSourcesCore.hpp:1307</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpLoopThis_html"><div class="ttname"><a href="structMoFEM_1_1OpLoopThis.html">MoFEM::OpLoopThis</a></div><div class="ttdoc">Execute &quot;this&quot; element in the operator.</div><div class="ttdef"><b>Definition</b> <a href="DGProjection_8hpp_source.html#l00068">DGProjection.hpp:68</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00709">PostProcBrokenMeshInMoabBase.hpp:709</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetFlux_html"><div class="ttname"><a href="structMoFEM_1_1OpSetFlux.html">MoFEM::OpSetFlux</a></div><div class="ttdef"><b>Definition</b> <a href="FormsBrokenSpaceConstraintImpl_8hpp_source.html#l00139">FormsBrokenSpaceConstraintImpl.hpp:139</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PairNameFEMethodPtr_html"><div class="ttname"><a href="structMoFEM_1_1PairNameFEMethodPtr.html">MoFEM::PairNameFEMethodPtr</a></div><div class="ttdef"><b>Definition</b> <a href="AuxPETSc_8hpp_source.html#l00012">AuxPETSc.hpp:12</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim_html"><div class="ttname"><a href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">MoFEM::PipelineManager::ElementsAndOpsByDim</a></div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00038">PipelineManager.hpp:38</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoabBaseBeginImpl_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoabBaseBeginImpl.html">MoFEM::PostProcBrokenMeshInMoabBaseBeginImpl</a></div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00864">PostProcBrokenMeshInMoabBase.hpp:865</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoabBaseEndImpl_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoabBaseEndImpl.html">MoFEM::PostProcBrokenMeshInMoabBaseEndImpl</a></div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00911">PostProcBrokenMeshInMoabBase.hpp:912</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Projection10NodeCoordsOnField_html"><div class="ttname"><a href="structMoFEM_1_1Projection10NodeCoordsOnField.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SmartPetscObj_html"><div class="ttname"><a href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj</a></div><div class="ttdoc">intrusive_ptr for managing petsc objects</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00082">PetscSmartObj.hpp:83</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SmartPetscObj_html_ab83f85c53d250afafd28487980674a97"><div class="ttname"><a href="structMoFEM_1_1SmartPetscObj.html#ab83f85c53d250afafd28487980674a97">MoFEM::SmartPetscObj::use_count</a></div><div class="ttdeci">int use_count() const</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00109">PetscSmartObj.hpp:109</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Tools_html"><div class="ttname"><a href="structMoFEM_1_1Tools.html">MoFEM::Tools</a></div><div class="ttdoc">Auxiliary tools.</div><div class="ttdef"><b>Definition</b> <a href="Tools_8hpp_source.html#l00019">Tools.hpp:19</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Tools_html_a7ec3e255948d70b798459a3021761d5b"><div class="ttname"><a href="structMoFEM_1_1Tools.html#a7ec3e255948d70b798459a3021761d5b">MoFEM::Tools::getTriNormal</a></div><div class="ttdeci">static MoFEMErrorCode getTriNormal(const double *coords, double *normal, double *d_normal=nullptr)</div><div class="ttdoc">Get the Tri Normal objectGet triangle normal.</div><div class="ttdef"><b>Definition</b> <a href="Tools_8cpp_source.html#l00353">Tools.cpp:353</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a3980182510ce819db5b281b6df595130"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a3980182510ce819db5b281b6df595130">MoFEM::TsCtx::getLoopsMonitor</a></div><div class="ttdeci">FEMethodsSequence &amp; getLoopsMonitor()</div><div class="ttdoc">Get the loops to do Monitor object.</div><div class="ttdef"><b>Definition</b> <a href="TsCtx_8hpp_source.html#l00102">TsCtx.hpp:102</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html">MoFEM::UnknownInterface</a></div><div class="ttdoc">base class for all interface classes</div><div class="ttdef"><b>Definition</b> <a href="UnknownInterface_8hpp_source.html#l00034">UnknownInterface.hpp:34</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_aeb77113fbaac3d256b13433f2294fa09"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">IFACE getInterface() const</div><div class="ttdoc">Get interface pointer to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="UnknownInterface_8hpp_source.html#l00162">UnknownInterface.hpp:162</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCoreOnSide_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCoreOnSide_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCoreOnSide::UserDataOperator</a></div><div class="ttdoc">default operator for TET element</div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCoreOnSide_8hpp_source.html#l00107">VolumeElementForcesAndSourcesCoreOnSide.hpp:108</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00109">VolumeElementForcesAndSourcesCore.hpp:110</a></div></div>
<div class="ttc" id="astructOpAnalyticalDispBc_html"><div class="ttname"><a href="structOpAnalyticalDispBc.html">OpAnalyticalDispBc</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00563">EshelbianOperators.hpp:563</a></div></div>
<div class="ttc" id="astructOpBrokenAnalyticalTractionBc_html"><div class="ttname"><a href="structOpBrokenAnalyticalTractionBc.html">OpBrokenAnalyticalTractionBc</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00425">EshelbianOperators.hpp:426</a></div></div>
<div class="ttc" id="astructOpBrokenPressureBc_html"><div class="ttname"><a href="structOpBrokenPressureBc.html">OpBrokenPressureBc</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00407">EshelbianOperators.hpp:408</a></div></div>
<div class="ttc" id="astructOpBrokenTractionBc_html"><div class="ttname"><a href="structOpBrokenTractionBc.html">OpBrokenTractionBc</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00389">EshelbianOperators.hpp:390</a></div></div>
<div class="ttc" id="astructOpCalculateEshelbyStress_html"><div class="ttname"><a href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00161">EshelbianOperators.hpp:162</a></div></div>
<div class="ttc" id="astructOpCalculateRotationAndSpatialGradient_html"><div class="ttname"><a href="structOpCalculateRotationAndSpatialGradient.html">OpCalculateRotationAndSpatialGradient</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00173">EshelbianOperators.hpp:173</a></div></div>
<div class="ttc" id="astructOpDispBc_html"><div class="ttname"><a href="structOpDispBc.html">OpDispBc</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00340">EshelbianOperators.hpp:340</a></div></div>
<div class="ttc" id="astructOpFaceMaterialForce_html"><div class="ttname"><a href="structOpFaceMaterialForce.html">OpFaceMaterialForce</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00810">EshelbianOperators.hpp:811</a></div></div>
<div class="ttc" id="astructOpFaceSideMaterialForce_html"><div class="ttname"><a href="structOpFaceSideMaterialForce.html">OpFaceSideMaterialForce</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00794">EshelbianOperators.hpp:795</a></div></div>
<div class="ttc" id="astructOpGetInternalStress_html"><div class="ttname"><a href="structOpGetInternalStress.html">OpGetInternalStress</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00273">EshelbianOperators.hpp:273</a></div></div>
<div class="ttc" id="astructOpJacobian_html_ae8b1e124a71d3c85bff23022318278d7"><div class="ttname"><a href="structOpJacobian.html#ae8b1e124a71d3c85bff23022318278d7">OpJacobian::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int side, EntityType type, EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="EshelbianPlasticity_8cpp_source.html#l00901">EshelbianPlasticity.cpp:901</a></div></div>
<div class="ttc" id="astructOpNormalDispLhsBc__dP_html"><div class="ttname"><a href="structOpNormalDispLhsBc__dP.html">OpNormalDispLhsBc_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00532">EshelbianOperators.hpp:532</a></div></div>
<div class="ttc" id="astructOpNormalDispLhsBc__dU_html"><div class="ttname"><a href="structOpNormalDispLhsBc__dU.html">OpNormalDispLhsBc_dU</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00524">EshelbianOperators.hpp:524</a></div></div>
<div class="ttc" id="astructOpNormalDispRhsBc_html"><div class="ttname"><a href="structOpNormalDispRhsBc.html">OpNormalDispRhsBc</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00516">EshelbianOperators.hpp:516</a></div></div>
<div class="ttc" id="astructOpPostProcDataStructure_html"><div class="ttname"><a href="structOpPostProcDataStructure.html">OpPostProcDataStructure</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00746">EshelbianOperators.hpp:747</a></div></div>
<div class="ttc" id="astructOpRotationBc_html"><div class="ttname"><a href="structOpRotationBc.html">OpRotationBc</a></div><div class="ttdoc">Apply rotation boundary condition.</div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00381">EshelbianOperators.hpp:381</a></div></div>
<div class="ttc" id="astructOpSpatialConsistencyBubble_html"><div class="ttname"><a href="structOpSpatialConsistencyBubble.html">OpSpatialConsistencyBubble</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00256">EshelbianOperators.hpp:256</a></div></div>
<div class="ttc" id="astructOpSpatialConsistencyDivTerm_html"><div class="ttname"><a href="structOpSpatialConsistencyDivTerm.html">OpSpatialConsistencyDivTerm</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00265">EshelbianOperators.hpp:265</a></div></div>
<div class="ttc" id="astructOpSpatialConsistencyP_html"><div class="ttname"><a href="structOpSpatialConsistencyP.html">OpSpatialConsistencyP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00247">EshelbianOperators.hpp:247</a></div></div>
<div class="ttc" id="astructOpSpatialConsistency__dBubble__dBubble_html"><div class="ttname"><a href="structOpSpatialConsistency__dBubble__dBubble.html">OpSpatialConsistency_dBubble_dBubble</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00692">EshelbianOperators.hpp:692</a></div></div>
<div class="ttc" id="astructOpSpatialConsistency__dBubble__dP_html"><div class="ttname"><a href="structOpSpatialConsistency__dBubble__dP.html">OpSpatialConsistency_dBubble_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00706">EshelbianOperators.hpp:706</a></div></div>
<div class="ttc" id="astructOpSpatialConsistency__dBubble__domega_html"><div class="ttname"><a href="structOpSpatialConsistency__dBubble__domega.html">OpSpatialConsistency_dBubble_domega</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00733">EshelbianOperators.hpp:733</a></div></div>
<div class="ttc" id="astructOpSpatialConsistency__dP__dP_html"><div class="ttname"><a href="structOpSpatialConsistency__dP__dP.html">OpSpatialConsistency_dP_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00679">EshelbianOperators.hpp:679</a></div></div>
<div class="ttc" id="astructOpSpatialConsistency__dP__domega_html"><div class="ttname"><a href="structOpSpatialConsistency__dP__domega.html">OpSpatialConsistency_dP_domega</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00720">EshelbianOperators.hpp:720</a></div></div>
<div class="ttc" id="astructOpSpatialEquilibrium__dw__dP_html"><div class="ttname"><a href="structOpSpatialEquilibrium__dw__dP.html">OpSpatialEquilibrium_dw_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00571">EshelbianOperators.hpp:571</a></div></div>
<div class="ttc" id="astructOpSpatialEquilibrium__dw__dw_html"><div class="ttname"><a href="structOpSpatialEquilibrium__dw__dw.html">OpSpatialEquilibrium_dw_dw</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00582">EshelbianOperators.hpp:582</a></div></div>
<div class="ttc" id="astructOpSpatialEquilibrium_html"><div class="ttname"><a href="structOpSpatialEquilibrium.html">OpSpatialEquilibrium</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00221">EshelbianOperators.hpp:221</a></div></div>
<div class="ttc" id="astructOpSpatialPhysicalExternalStrain_html"><div class="ttname"><a href="structOpSpatialPhysicalExternalStrain.html">OpSpatialPhysicalExternalStrain</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00297">EshelbianOperators.hpp:297</a></div></div>
<div class="ttc" id="astructOpSpatialPhysicalInternalStress_html"><div class="ttname"><a href="structOpSpatialPhysicalInternalStress.html">OpSpatialPhysicalInternalStress</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00288">EshelbianOperators.hpp:288</a></div></div>
<div class="ttc" id="astructOpSpatialPhysical__du__dBubble_html"><div class="ttname"><a href="structOpSpatialPhysical__du__dBubble.html">OpSpatialPhysical_du_dBubble</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00607">EshelbianOperators.hpp:607</a></div></div>
<div class="ttc" id="astructOpSpatialPhysical__du__dP_html"><div class="ttname"><a href="structOpSpatialPhysical__du__dP.html">OpSpatialPhysical_du_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00595">EshelbianOperators.hpp:595</a></div></div>
<div class="ttc" id="astructOpSpatialPhysical__du__domega_html"><div class="ttname"><a href="structOpSpatialPhysical__du__domega.html">OpSpatialPhysical_du_domega</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00619">EshelbianOperators.hpp:619</a></div></div>
<div class="ttc" id="astructOpSpatialRotation__domega__dBubble_html"><div class="ttname"><a href="structOpSpatialRotation__domega__dBubble.html">OpSpatialRotation_domega_dBubble</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00653">EshelbianOperators.hpp:653</a></div></div>
<div class="ttc" id="astructOpSpatialRotation__domega__dP_html"><div class="ttname"><a href="structOpSpatialRotation__domega__dP.html">OpSpatialRotation_domega_dP</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00642">EshelbianOperators.hpp:642</a></div></div>
<div class="ttc" id="astructOpSpatialRotation__domega__domega_html"><div class="ttname"><a href="structOpSpatialRotation__domega__domega.html">OpSpatialRotation_domega_domega</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00665">EshelbianOperators.hpp:665</a></div></div>
<div class="ttc" id="astructOpSpatialRotation__domega__du_html"><div class="ttname"><a href="structOpSpatialRotation__domega__du.html">OpSpatialRotation_domega_du</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00631">EshelbianOperators.hpp:631</a></div></div>
<div class="ttc" id="astructOpSpatialRotation_html"><div class="ttname"><a href="structOpSpatialRotation.html">OpSpatialRotation</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00235">EshelbianOperators.hpp:235</a></div></div>
<div class="ttc" id="astructQUAD___html_a4ceb3af6a1dd055a067f6c3c1f6d4c86"><div class="ttname"><a href="structQUAD__.html#a4ceb3af6a1dd055a067f6c3c1f6d4c86">QUAD_::order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00028">quad.h:28</a></div></div>
<div class="ttc" id="astructQUAD___html_ad40798bbebc1ea30e30dfcde923eccaa"><div class="ttname"><a href="structQUAD__.html#ad40798bbebc1ea30e30dfcde923eccaa">QUAD_::npoints</a></div><div class="ttdeci">int npoints</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00029">quad.h:29</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_a11e5b883541555c29988f8eb9e8dec7a"><div class="ttname"><a href="structTSElasticPostStep.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a></div><div class="ttdeci">static MoFEMErrorCode postStepInitialise(EshelbianCore *ep_ptr)</div><div class="ttdef"><b>Definition</b> <a href="TSElasticPostStep_8cpp_source.html#l00011">TSElasticPostStep.cpp:11</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_a4c808fe810288d58f8699aff7f947852"><div class="ttname"><a href="structTSElasticPostStep.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a></div><div class="ttdeci">static MoFEMErrorCode postStepDestroy()</div><div class="ttdef"><b>Definition</b> <a href="TSElasticPostStep_8cpp_source.html#l00085">TSElasticPostStep.cpp:85</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_a970435b55ed522325c979afce73ff046"><div class="ttname"><a href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a></div><div class="ttdeci">static MoFEMErrorCode preStepFun(TS ts)</div><div class="ttdef"><b>Definition</b> <a href="TSElasticPostStep_8cpp_source.html#l00095">TSElasticPostStep.cpp:95</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_ac1f95bc05eb3ef54d799134f8202a753"><div class="ttname"><a href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a></div><div class="ttdeci">static MoFEMErrorCode postStepFun(TS ts)</div><div class="ttdef"><b>Definition</b> <a href="TSElasticPostStep_8cpp_source.html#l00223">TSElasticPostStep.cpp:223</a></div></div>
<div class="ttc" id="astructVolRule_html"><div class="ttname"><a href="structVolRule.html">VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00088">simple_interface.cpp:88</a></div></div>
<div class="ttc" id="astructVolRule_html_a6d7b2f53d4d1a0251ea349cfc7f1f637"><div class="ttname"><a href="structVolRule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">VolRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00089">simple_interface.cpp:89</a></div></div>
<div class="ttc" id="atest__broken__space_8cpp_html_a7d51850bc3e191e80e4a1b055db5dd49"><div class="ttname"><a href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a></div><div class="ttdeci">BoundaryEle::UserDataOperator BdyEleOp</div><div class="ttdef"><b>Definition</b> <a href="test__broken__space_8cpp_source.html#l00041">test_broken_space.cpp:41</a></div></div>
<div class="ttc" id="athermo__elastic_8cpp_html_a11853fc6dfa8d79a1adb95c8c02626c9"><div class="ttname"><a href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a></div><div class="ttdeci">auto save_range</div><div class="ttdef"><b>Definition</b> <a href="thermo__elastic_8cpp_source.html#l00121">thermo_elastic.cpp:121</a></div></div>
<div class="ttc" id="athermo__elastic_8cpp_html_ae7c94e41d241c2484ddfe347db0156d6"><div class="ttname"><a href="thermo__elastic_8cpp.html#ae7c94e41d241c2484ddfe347db0156d6">OpBodyForce</a></div><div class="ttdeci">DomainNaturalBCRhs::OpFlux&lt; NaturalMeshsetType&lt; BLOCKSET &gt;, 1, SPACE_DIM &gt; OpBodyForce</div><div class="ttdef"><b>Definition</b> <a href="thermo__elastic_8cpp_source.html#l00065">thermo_elastic.cpp:66</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>