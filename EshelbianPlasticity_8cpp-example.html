<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: EshelbianPlasticity.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">EshelbianPlasticity.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Eshelbian plasticity implementation</p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file EshelbianPlasticity.cpp</span></div>
<div class="line"><span class="comment"> * \example EshelbianPlasticity.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brief Eshelbian plasticity implementation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SINGULARITY</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="CGGTonsorialBubbleBase_8hpp.html">CGGTonsorialBubbleBase.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianPlasticity_8hpp.html">EshelbianPlasticity.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/math/constants/constants.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cholesky_8hpp.html">cholesky.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python/def.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python/numpy.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>bp = boost::python;</div>
<div class="line"><span class="keyword">namespace </span>np = boost::python::numpy;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">  #pragma message &quot;With PYTHON_SDF&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">  #pragma message &quot;Without PYTHON_SDF&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianContact_8hpp.html">EshelbianContact.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quad_8h.html">phg-quadrule/quad.h</a>&gt;</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEshelbianPlasticity.html">EshelbianPlasticity</a> {</div>
<div class="line"><span class="keyword">struct </span>VolUserDataOperatorStabAssembly</div>
<div class="line">    : <span class="keyword">public</span> <a name="_a0"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolumeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <span class="keyword">using</span> <a name="a1"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a3fcd2f1369f2c65426d4400089f9e1c7">VolumeElementForcesAndSourcesCore::UserDataOperator::UserDataOperator</a>;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>FaceUserDataOperatorStabAssembly</div>
<div class="line">    : <span class="keyword">public</span> <a name="_a2"></a><a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a3fcd2f1369f2c65426d4400089f9e1c7">FaceElementForcesAndSourcesCore::UserDataOperator::UserDataOperator</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace EshelbianPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a name="a3"></a><a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a name="_a4"></a><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                 <span class="keyword">const</span> std::string block_name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">  <a name="_a5"></a><a class="code" href="classRange.html">Range</a> <a name="a6"></a><a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mesh_mng = m_field.<a name="a7"></a><a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a8"></a><a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bcs = mesh_mng-&gt;<a name="a9"></a><a class="code" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line"> </div>
<div class="line">      std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % block_name).str())</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bcs) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a name="a10"></a><a class="code" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(bc-&gt;getMeshsetIdEntitiesByDimension(m_field.<a name="a11"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>(), dim,</div>
<div class="line">                                                       faces, <span class="keyword">true</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;get meshset ents&quot;</span>);</div>
<div class="line">    <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.merge(faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a name="a12"></a><a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(<a name="a13"></a><a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab, <span class="keyword">const</span> std::string name,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">  <a name="a14"></a><a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> out_meshset = <a name="a15"></a><a class="code" href="namespaceMoFEM.html#ad17eefd5d88d2b51c71ec46cae8569ac">get_temp_meshset_ptr</a>(moab);</div>
<div class="line">  <a name="a16"></a><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(*out_meshset, <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size()) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, out_meshset-&gt;get_ptr(), 1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a name="a17"></a><a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::warning) &lt;&lt; <span class="stringliteral">&quot;Empty range for &quot;</span> &lt;&lt; name;</div>
<div class="line">  }</div>
<div class="line">  <a name="a18"></a><a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">typename</span> <a name="_a19"></a><a class="code" href="structMoFEM_1_1OpBaseImpl.html">MoFEM::OpBaseImpl</a>&lt;</div>
<div class="line">    <a name="a20"></a><a class="code" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e">SCHUR</a>,</div>
<div class="line">    <a name="_a21"></a><a class="code" href="structEshelbianPlasticity_1_1VolUserDataOperatorStabAssembly.html">EshelbianPlasticity::VolUserDataOperatorStabAssembly</a>&gt;::MatSetValuesHook</div>
<div class="line">    <a class="code" href="structMoFEM_1_1OpBaseImpl.html">MoFEM::OpBaseImpl</a>&lt;<a class="code" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e">SCHUR</a>,</div>
<div class="line">                      <a class="code" href="structEshelbianPlasticity_1_1VolUserDataOperatorStabAssembly.html">EshelbianPlasticity::VolUserDataOperatorStabAssembly</a>&gt;::</div>
<div class="line">        matSetValuesHook = [](<a name="_a22"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">ForcesAndSourcesCore::UserDataOperator</a> *op_ptr,</div>
<div class="line">                              <span class="keyword">const</span> <a name="_a23"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                              <span class="keyword">const</span> <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data,</div>
<div class="line">                              <a name="a24"></a><a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a name="a25"></a><a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>) {</div>
<div class="line">          <span class="keywordflow">return</span> MatSetValues&lt;AssemblyTypeSelector&lt;SCHUR&gt;&gt;(</div>
<div class="line">              op_ptr-&gt;<a name="a26"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#abef09b6c07215b3605b342c408884602">getKSPB</a>(), row_data, col_data, <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, ADD_VALUES);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceEshelbianPlasticity.html">EshelbianPlasticity</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SetIntegrationAtFrontVolume {</div>
<div class="line"> </div>
<div class="line">  SetIntegrationAtFrontVolume() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">  <a name="a27"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> operator()(<a name="_a28"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                            <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = fe_raw_ptr-&gt;<a name="a29"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html#ac1d7ee38dde697833773a3b8cb197a76">mField</a>;</div>
<div class="line">    <span class="keyword">auto</span> vol_fe_ptr = <span class="keyword">dynamic_cast&lt;</span>VolFe *<span class="keyword">&gt;</span>(fe_raw_ptr);</div>
<div class="line">    <span class="keyword">auto</span> fe_handle = vol_fe_ptr-&gt;getFEEntityHandle();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_base_quadrature = [&amp;]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordtype">int</span> rule = 2 * order_data + 1;</div>
<div class="line">      <span class="keywordflow">if</span> (rule &lt; <a name="a30"></a><a class="code" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a name="a31"></a><a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;dim != 3) {</div>
<div class="line">          SETERRQ(m_field.<a name="a32"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <a name="a33"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                  <span class="stringliteral">&quot;wrong dimension&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a name="a34"></a><a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &lt; rule) {</div>
<div class="line">          SETERRQ2(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;wrong order %d != %d&quot;</span>, <a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a name="a35"></a><a class="code" href="structQUAD__.html#a4ceb3af6a1dd055a067f6c3c1f6d4c86">order</a>, rule);</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = <a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a name="a36"></a><a class="code" href="structQUAD__.html#ad40798bbebc1ea30e30dfcde923eccaa">npoints</a>;</div>
<div class="line">        <span class="keyword">auto</span> &amp;gauss_pts = vol_fe_ptr-&gt;gaussPts;</div>
<div class="line">        gauss_pts.resize(4, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[1], 4,</div>
<div class="line">                    &amp;gauss_pts(0, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[2], 4,</div>
<div class="line">                    &amp;gauss_pts(1, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[3], 4,</div>
<div class="line">                    &amp;gauss_pts(2, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, <a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;weights, 1,</div>
<div class="line">                    &amp;gauss_pts(3, 0), 1);</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = vol_fe_ptr-&gt;dataOnElement[<a name="a37"></a><a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a name="a38"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4,</div>
<div class="line">                                                              <span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        cblas_dcopy(4 * nb_gauss_pts, <a class="code" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points, 1,</div>
<div class="line">                    shape_ptr, 1);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        SETERRQ2(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;rule &gt; quadrature order %d &lt; %d&quot;</span>, rule,</div>
<div class="line">                 <a class="code" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_base_quadrature();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (frontNodes-&gt;size() &amp;&amp; EshelbianCore::setSingularity) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_nodes = [&amp;]() {</div>
<div class="line">        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">        <span class="keyword">const</span> <a name="_a39"></a><a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(fe_handle, conn, num_nodes,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        std::bitset&lt;numNodes&gt; singular_nodes;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn = 0; nn != numNodes; ++nn) {</div>
<div class="line">          <span class="keywordflow">if</span> (frontNodes-&gt;find(conn[nn]) != frontNodes-&gt;end()) {</div>
<div class="line">            singular_nodes.set(nn);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_nodes.reset(nn);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_nodes;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_edges = [&amp;]() {</div>
<div class="line">        std::bitset&lt;numEdges&gt; singular_edges;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">          <a class="code" href="classEntityHandle.html">EntityHandle</a> edge;</div>
<div class="line">          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().side_element(fe_handle, 1, ee, edge);</div>
<div class="line">          <span class="keywordflow">if</span> (frontEdges-&gt;find(edge) != frontEdges-&gt;end()) {</div>
<div class="line">            singular_edges.set(ee);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_edges.reset(ee);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_edges;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_gauss_pts = [&amp;](<span class="keyword">auto</span> &amp;ref_gauss_pts) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        vol_fe_ptr-&gt;gaussPts.swap(ref_gauss_pts);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = vol_fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">        <span class="comment">// auto &amp;dataH1 = vol_fe_ptr-&gt;dataOnElement[H1];</span></div>
<div class="line">        <span class="comment">// data-&gt;dataOnEntities[MBVERTEX][0].getN(NOBASE).resize(nb_gauss_pts, 4);</span></div>
<div class="line">        <span class="comment">// double *shape_ptr =</span></div>
<div class="line">        <span class="comment">//     &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(NOBASE).data().begin();</span></div>
<div class="line">        <span class="comment">// CHKERR ShapeMBTET(shape_ptr, &amp;vol_fe_ptr-&gt;gaussPts(0, 0),</span></div>
<div class="line">        <span class="comment">//                   &amp;vol_fe_ptr-&gt;gaussPts(1, 0), &amp;gaussPts(2, 0),</span></div>
<div class="line">        <span class="comment">//                   nb_gauss_pts);</span></div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> singular_nodes = get_singular_nodes();</div>
<div class="line">      <span class="keywordflow">if</span> (singular_nodes.count()) {</div>
<div class="line">        <span class="keyword">auto</span> it_map_ref_coords = <a name="a40"></a><a class="code" href="namespaceFractureMechanics.html#abec8f3bf3291e58b0cd5d7fe3943dc43">mapRefCoords</a>.find(singular_nodes.to_ulong());</div>
<div class="line">        <span class="keywordflow">if</span> (it_map_ref_coords != <a class="code" href="namespaceFractureMechanics.html#abec8f3bf3291e58b0cd5d7fe3943dc43">mapRefCoords</a>.end()) {</div>
<div class="line">          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(it_map_ref_coords-&gt;second);</div>
<div class="line">          <a name="a41"></a><a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> refine_quadrature = [&amp;]() {</div>
<div class="line">            <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> max_level = refinementLevels;</div>
<div class="line">            <a class="code" href="classEntityHandle.html">EntityHandle</a> tet;</div>
<div class="line"> </div>
<div class="line">            <a name="a42"></a><a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> moab_ref;</div>
<div class="line">            <span class="keywordtype">double</span> base_coords[] = {0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1};</div>
<div class="line">            <a class="code" href="classEntityHandle.html">EntityHandle</a> nodes[4];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 4; nn++)</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_vertex(&amp;base_coords[3 * nn], nodes[nn]);</div>
<div class="line">            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_element(MBTET, nodes, 4, tet);</div>
<div class="line">            <a name="_a43"></a><a class="code" href="structMoFEM_1_1CoreTmp.html">MoFEM::CoreTmp</a>&lt;-1&gt; mofem_ref_core(moab_ref, PETSC_COMM_SELF, -2);</div>
<div class="line">            <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field_ref = mofem_ref_core;</div>
<div class="line">            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a44"></a><a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                -&gt;setBitRefLevelByDim(0, 3, <a name="a45"></a><a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(0));</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classRange.html">Range</a> nodes_at_front;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_nodes[nn]) {</div>
<div class="line">                <a class="code" href="classEntityHandle.html">EntityHandle</a> ent;</div>
<div class="line">                <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tet, 0, nn, ent);</div>
<div class="line">                nodes_at_front.insert(ent);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> singular_edges = get_singular_edges();</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line">            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_meshset(MESHSET_SET, meshset);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != 6; ee++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_edges[ee]) {</div>
<div class="line">                <a class="code" href="classEntityHandle.html">EntityHandle</a> ent;</div>
<div class="line">                <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tet, 1, ee, ent);</div>
<div class="line">                <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.add_entities(meshset, &amp;ent, 1);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// refine mesh</span></div>
<div class="line">            <span class="keyword">auto</span> *m_ref = m_field_ref.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a46"></a><a class="code" href="structMoFEM_1_1MeshRefinement.html">MeshRefinement</a>&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != max_level; ll++) {</div>
<div class="line">              <a class="code" href="classRange.html">Range</a> edges;</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll),</div>
<div class="line">                                                 <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE,</div>
<div class="line">                                                 edges);</div>
<div class="line">              <a class="code" href="classRange.html">Range</a> ref_edges;</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_adjacencies(</div>
<div class="line">                  nodes_at_front, 1, <span class="keyword">true</span>, ref_edges, moab::Interface::UNION);</div>
<div class="line">              ref_edges = intersect(ref_edges, edges);</div>
<div class="line">              <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_entities_by_type(meshset, MBEDGE, ents, <span class="keyword">true</span>);</div>
<div class="line">              ref_edges = intersect(ref_edges, ents);</div>
<div class="line">              <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">                      <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets);</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;addVerticesInTheMiddleOfEdges(</div>
<div class="line">                  ref_edges, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1));</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;refineTets(tets, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1));</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;updateMeshsetByEntitiesChildren(meshset,</div>
<div class="line">                                                    <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1),</div>
<div class="line">                                                    meshset, MBEDGE, <span class="keyword">true</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// get ref coords</span></div>
<div class="line">            <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line">            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()</div>
<div class="line">                -&gt;getEntitiesByTypeAndRefLevel(<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(max_level),</div>
<div class="line">                                               <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line">                                               tets);</div>
<div class="line">            <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> ref_coords(tets.size(), 12, <span class="keyword">false</span>);</div>
<div class="line">            <span class="keywordtype">int</span> tt = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (Range::iterator tit = tets.begin(); tit != tets.end();</div>
<div class="line">                 tit++, tt++) {</div>
<div class="line">              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">              <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_connectivity(*tit, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_coords(conn, num_nodes, &amp;ref_coords(tt, 0));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> &amp;data = vol_fe_ptr-&gt;dataOnElement[<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = vol_fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">            <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> ref_gauss_pts(4, nb_gauss_pts * ref_coords.size1());</div>
<div class="line">            <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;shape_n =</div>
<div class="line">                data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>);</div>
<div class="line">            <span class="keywordtype">int</span> gg = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tt = 0; tt != ref_coords.size1(); tt++) {</div>
<div class="line">              <span class="keywordtype">double</span> *tet_coords = &amp;ref_coords(tt, 0);</div>
<div class="line">              <span class="keywordtype">double</span> det = <a name="a47"></a><a class="code" href="structMoFEM_1_1Tools.html#aacd3c99382effbce7aedfc5ae9862770">Tools::tetVolume</a>(tet_coords);</div>
<div class="line">              det *= 6;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ggg = 0; ggg != nb_gauss_pts; ++ggg, ++gg) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a name="a48"></a><a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>++) {</div>
<div class="line">                  ref_gauss_pts(<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>, gg) =</div>
<div class="line">                      shape_n(ggg, 0) * tet_coords[3 * 0 + <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 1) * tet_coords[3 * 1 + <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 2) * tet_coords[3 * 2 + <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 3) * tet_coords[3 * 3 + <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>];</div>
<div class="line">                }</div>
<div class="line">                ref_gauss_pts(3, gg) = vol_fe_ptr-&gt;gaussPts(3, ggg) * det;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="namespaceFractureMechanics.html#abec8f3bf3291e58b0cd5d7fe3943dc43">mapRefCoords</a>[singular_nodes.to_ulong()].swap(ref_gauss_pts);</div>
<div class="line">            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(<a class="code" href="namespaceFractureMechanics.html#abec8f3bf3291e58b0cd5d7fe3943dc43">mapRefCoords</a>[singular_nodes.to_ulong()]);</div>
<div class="line"> </div>
<div class="line">            <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span>VolFe : <span class="keyword">public</span> <a name="_a49"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a> {</div>
<div class="line">    <span class="keyword">using</span> <a name="a50"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html#a7ac449018ddab38aab05756b44d298aa">VolumeElementForcesAndSourcesCore::dataOnElement</a>;</div>
<div class="line">    <span class="keyword">using</span> <a name="a51"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html#adb15bcb9c22237b0b508ca37bb48d721">VolumeElementForcesAndSourcesCore::VolumeElementForcesAndSourcesCore</a>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> constexpr <span class="keywordtype">int</span> numNodes = 4;</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> constexpr <span class="keywordtype">int</span> numEdges = 6;</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> constexpr <span class="keywordtype">int</span> refinementLevels = 3;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> boost::shared_ptr&lt;Range&gt; frontNodes;</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> boost::shared_ptr&lt;Range&gt; frontEdges;</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> std::map&lt;long int, MatrixDouble&gt; <a class="code" href="namespaceFractureMechanics.html#abec8f3bf3291e58b0cd5d7fe3943dc43">mapRefCoords</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> EshelbianCore::exponentBase = exp(1);</div>
<div class="line">boost::function&lt;<a name="_a52"></a><a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a name="a53"></a><a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">EshelbianCore::f</a> = EshelbianCore::f_log_e;</div>
<div class="line">boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a name="a54"></a><a class="code" href="namespaceHenckyOps.html#ac901935d74fe21ad8415e34fd9ea2150">EshelbianCore::d_f</a> =</div>
<div class="line">    EshelbianCore::d_f_log_e;</div>
<div class="line">boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a name="a55"></a><a class="code" href="namespaceHenckyOps.html#aafb2135de373a6659912b2fdcb2a07b5">EshelbianCore::dd_f</a> =</div>
<div class="line">    EshelbianCore::dd_f_log_e;</div>
<div class="line">boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; EshelbianCore::inv_f =</div>
<div class="line">    EshelbianCore::inv_f_log;</div>
<div class="line">boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; EshelbianCore::inv_d_f =</div>
<div class="line">    EshelbianCore::inv_d_f_log;</div>
<div class="line">boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; EshelbianCore::inv_dd_f =</div>
<div class="line">    EshelbianCore::inv_dd_f_log;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">EshelbianCore::query_interface(boost::typeindex::type_index type_index,</div>
<div class="line">                               <a name="_a56"></a><a class="code" href="structMoFEM_1_1UnknownInterface.html">UnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line">  *iface = <span class="keyword">const_cast&lt;</span>EshelbianCore *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpJacobian::doWork(<span class="keywordtype">int</span> side, EntityType <a name="a57"></a><a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (evalRhs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evaluateRhs(data);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (evalLhs)</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evaluateLhs(data);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">EshelbianCore::EshelbianCore(<a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : mField(m_field) {</div>
<div class="line">  <a name="a58"></a><a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(getOptions(), <span class="stringliteral">&quot;getOptions failed&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">EshelbianCore::~EshelbianCore() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::getOptions() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_rots[] = {<span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;moderate&quot;</span>, <span class="stringliteral">&quot;large&quot;</span>, <span class="stringliteral">&quot;no_h1&quot;</span>};</div>
<div class="line">  PetscInt choice_rot = EshelbianCore::rotSelector;</div>
<div class="line">  PetscInt choice_grad = EshelbianCore::gradApproximator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_stretches[] = {<span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;log&quot;</span>};</div>
<div class="line">  PetscInt choice_stretch = <a name="a59"></a><a class="code" href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6ad09302bad0104c5849bb764b8d6c23b7">StretchSelector::LOG</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Eshelbian plasticity&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-space_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for space&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         spaceOrder, &amp;spaceOrder, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-space_h1_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for space&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         spaceH1Order, &amp;spaceH1Order, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-material_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for material&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, materialOrder, &amp;materialOrder, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_u&quot;</span>, <span class="stringliteral">&quot;viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, alphaU,</div>
<div class="line">                            &amp;alphaU, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_w&quot;</span>, <span class="stringliteral">&quot;viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, alphaW,</div>
<div class="line">                            &amp;alphaW, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-density_alpha_rho&quot;</span>, <span class="stringliteral">&quot;density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, alphaRho,</div>
<div class="line">                            &amp;alphaRho, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-rotations&quot;</span>, <span class="stringliteral">&quot;rotations&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_rots,</div>
<div class="line">                           <a name="a60"></a><a class="code" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17adda9bc262a10a477bb1630e6a802bda0">LARGE_ROT</a> + 1, list_rots[choice_rot], &amp;choice_rot,</div>
<div class="line">                           PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-grad&quot;</span>, <span class="stringliteral">&quot;gradient of defamation approximate&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                           list_rots, <a name="a61"></a><a class="code" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17a00aa5b7eae56319e7066b5eaf4ec2701">NO_H1_CONFIGURATION</a> + 1,</div>
<div class="line">                           list_rots[choice_grad], &amp;choice_grad, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-exponent_base&quot;</span>, <span class="stringliteral">&quot;exponent_base&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, exponentBase,</div>
<div class="line">                            &amp;EshelbianCore::exponentBase, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(</div>
<div class="line">      <span class="stringliteral">&quot;-stretches&quot;</span>, <span class="stringliteral">&quot;stretches&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_stretches, <a class="code" href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6ad09302bad0104c5849bb764b8d6c23b7">StretchSelector::LOG</a> + 1,</div>
<div class="line">      list_stretches[choice_stretch], &amp;choice_stretch, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-no_stretch&quot;</span>, <span class="stringliteral">&quot;do not solve for stretch&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          noStretch, &amp;noStretch, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-set_singularity&quot;</span>, <span class="stringliteral">&quot;set singularity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          setSingularity, &amp;setSingularity, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// contact parameters</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-contact_max_post_proc_ref_level&quot;</span>, <span class="stringliteral">&quot;refinement level&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, contactRefinementLevels, &amp;contactRefinementLevels,</div>
<div class="line">                         PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a name="a62"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line">  <a name="a63"></a><a class="code" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"> </div>
<div class="line">  EshelbianCore::rotSelector = <span class="keyword">static_cast&lt;</span><a name="a64"></a><a class="code" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17">RotSelector</a><span class="keyword">&gt;</span>(choice_rot);</div>
<div class="line">  EshelbianCore::gradApproximator = <span class="keyword">static_cast&lt;</span><a class="code" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17">RotSelector</a><span class="keyword">&gt;</span>(choice_grad);</div>
<div class="line">  EshelbianCore::stretchSelector = <span class="keyword">static_cast&lt;</span><a name="a65"></a><a class="code" href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6">StretchSelector</a><span class="keyword">&gt;</span>(choice_stretch);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (EshelbianCore::stretchSelector) {</div>
<div class="line">  <span class="keywordflow">case</span> <a name="a66"></a><a class="code" href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6a484ae87b0f6b7d2bb1f21e8ea6e1020e">StretchSelector::LINEAR</a>:</div>
<div class="line">    <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">EshelbianCore::f</a> = f_linear;</div>
<div class="line">    <a class="code" href="namespaceHenckyOps.html#ac901935d74fe21ad8415e34fd9ea2150">EshelbianCore::d_f</a> = d_f_linear;</div>
<div class="line">    <a class="code" href="namespaceHenckyOps.html#aafb2135de373a6659912b2fdcb2a07b5">EshelbianCore::dd_f</a> = dd_f_linear;</div>
<div class="line">    EshelbianCore::inv_f = inv_f_linear;</div>
<div class="line">    EshelbianCore::inv_d_f = inv_d_f_linear;</div>
<div class="line">    EshelbianCore::inv_dd_f = inv_dd_f_linear;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code" href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6ad09302bad0104c5849bb764b8d6c23b7">StretchSelector::LOG</a>:</div>
<div class="line">    <span class="keywordflow">if</span> (EshelbianCore::exponentBase != exp(1)) {</div>
<div class="line">      <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">EshelbianCore::f</a> = f_log;</div>
<div class="line">      <a class="code" href="namespaceHenckyOps.html#ac901935d74fe21ad8415e34fd9ea2150">EshelbianCore::d_f</a> = d_f_log;</div>
<div class="line">      <a class="code" href="namespaceHenckyOps.html#aafb2135de373a6659912b2fdcb2a07b5">EshelbianCore::dd_f</a> = dd_f_log;</div>
<div class="line">      EshelbianCore::inv_f = inv_f_log;</div>
<div class="line">      EshelbianCore::inv_d_f = inv_d_f_log;</div>
<div class="line">      EshelbianCore::inv_dd_f = inv_dd_f_log;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">EshelbianCore::f</a> = f_log_e;</div>
<div class="line">      <a class="code" href="namespaceHenckyOps.html#ac901935d74fe21ad8415e34fd9ea2150">EshelbianCore::d_f</a> = d_f_log_e;</div>
<div class="line">      <a class="code" href="namespaceHenckyOps.html#aafb2135de373a6659912b2fdcb2a07b5">EshelbianCore::dd_f</a> = dd_f_log_e;</div>
<div class="line">      EshelbianCore::inv_f = inv_f_log;</div>
<div class="line">      EshelbianCore::inv_d_f = inv_d_f_log;</div>
<div class="line">      EshelbianCore::inv_dd_f = inv_dd_f_log;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(mField.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Unknown stretch&quot;</span>);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;spaceOrder &quot;</span> &lt;&lt; spaceOrder;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;spaceH1Order &quot;</span> &lt;&lt; spaceH1Order;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;materialOrder &quot;</span> &lt;&lt; materialOrder;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaU &quot;</span> &lt;&lt; alphaU;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaW &quot;</span> &lt;&lt; alphaW;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaRho &quot;</span> &lt;&lt; alphaRho;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Rotations &quot;</span> &lt;&lt; list_rots[EshelbianCore::rotSelector];</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Gradient of deformation &quot;</span></div>
<div class="line">                               &lt;&lt; list_rots[EshelbianCore::gradApproximator];</div>
<div class="line">  <span class="keywordflow">if</span> (exponentBase != exp(1))</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Base exponent &quot;</span> &lt;&lt; EshelbianCore::exponentBase;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Base exponent e&quot;</span>;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Stretch &quot;</span> &lt;&lt; list_stretches[choice_stretch];</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (spaceH1Order == -1)</div>
<div class="line">    spaceH1Order = spaceOrder;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::addFields(<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tets = [&amp;]() {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_type(meshset, MBTET, tets);</div>
<div class="line">    <span class="keywordflow">return</span> tets;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tets_skin = [&amp;]() {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> tets_skin_part;</div>
<div class="line">    Skinner skin(&amp;mField.get_moab());</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, get_tets(), <span class="keyword">false</span>, tets_skin_part);</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;mField.get_moab(), <a name="a67"></a><a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> tets_skin;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(tets_skin_part,</div>
<div class="line">                                 PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;tets_skin);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> subtract_boundary_conditions = [&amp;](<span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="comment">// That mean, that hybrid field on all faces on which traction is applied,</span></div>
<div class="line">    <span class="comment">// on other faces, or enforcing displacements as</span></div>
<div class="line">    <span class="comment">// natural boundary condition.</span></div>
<div class="line">    <span class="keywordflow">if</span> (bcSpatialTraction)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a name="a68"></a><a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialTraction) {</div>
<div class="line">        tets_skin = subtract(tets_skin, <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_blockset = [&amp;](<span class="keyword">auto</span> block_name, <span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="keyword">auto</span> crack_faces =</div>
<div class="line">        <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;block_name&quot;</span>, <a name="a69"></a><a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    tets_skin.merge(crack_faces);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> subtract_blockset = [&amp;](<span class="keyword">auto</span> block_name, <span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="keyword">auto</span> contact_range =</div>
<div class="line">        <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, block_name, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    tets_skin = subtract(tets_skin, contact_range);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_stress_trace_faces = [&amp;](<span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(get_tets(), <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                             faces, moab::Interface::UNION);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> trace_faces = subtract(faces, tets_skin);</div>
<div class="line">    <span class="keywordflow">return</span> trace_faces;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> tets = get_tets();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// remove also contact faces, i.e. that is also kind of hybrid field but</span></div>
<div class="line">  <span class="comment">// named but used to enforce contact conditions</span></div>
<div class="line">  <span class="keyword">auto</span> trace_faces = get_stress_trace_faces(</div>
<div class="line"> </div>
<div class="line">      subtract_blockset(<span class="stringliteral">&quot;CONTACT&quot;</span>,</div>
<div class="line">                        subtract_boundary_conditions(get_tets_skin()))</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  contactFaces = boost::make_shared&lt;Range&gt;(intersect(</div>
<div class="line">      trace_faces, <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1)));</div>
<div class="line">  skeletonFaces =</div>
<div class="line">      boost::make_shared&lt;Range&gt;(subtract(trace_faces, *contactFaces));</div>
<div class="line">  materialSkeletonFaces =</div>
<div class="line">      boost::make_shared&lt;Range&gt;(get_stress_trace_faces(<a class="code" href="classRange.html">Range</a>()));</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">  <span class="keywordflow">if</span> (contactFaces-&gt;size())</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(mField.get_moab(), <span class="stringliteral">&quot;contact_faces.vtk&quot;</span>, *contactFaces);</div>
<div class="line">  <span class="keywordflow">if</span> (skeletonFaces-&gt;size())</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(mField.get_moab(), <span class="stringliteral">&quot;skeleton_faces.vtk&quot;</span>, *skeletonFaces);</div>
<div class="line">  <span class="keywordflow">if</span> (skeletonFaces-&gt;size())</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(mField.get_moab(), <span class="stringliteral">&quot;material_skeleton_faces.vtk&quot;</span>,</div>
<div class="line">                      *materialSkeletonFaces);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_broken_hdiv_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a name="a70"></a><a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                               <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    constexpr <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a> base = <a name="a71"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_side_map_hdiv = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> std::vector&lt;</div>
<div class="line"> </div>
<div class="line">          std::pair&lt;EntityType,</div>
<div class="line">                    std::function&lt;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(<a class="code" href="structMoFEM_1_1BaseFunction.html#a401db54065b0887d68f81f7f806a08d4">BaseFunction::DofsSideMap</a> &amp;)&gt;</div>
<div class="line"> </div>
<div class="line">                    &gt;&gt;{</div>
<div class="line"> </div>
<div class="line">          {MBTET,</div>
<div class="line">           [&amp;](<a class="code" href="structMoFEM_1_1BaseFunction.html#a401db54065b0887d68f81f7f806a08d4">BaseFunction::DofsSideMap</a> &amp;dofs_side_map) -&gt; <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> {</div>
<div class="line">             <span class="keywordflow">return</span> TetPolynomialBase::setDofsSideMap(<a name="a72"></a><a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, <a name="a73"></a><a class="code" href="definitions_8h.html#a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4">DISCONTINUOUS</a>, base,</div>
<div class="line">                                                      dofs_side_map);</div>
<div class="line">           }}</div>
<div class="line"> </div>
<div class="line">      };</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_broken_field(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, base, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                   get_side_map_hdiv(), MB_TAG_DENSE, <a name="a74"></a><a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_l2_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a name="a75"></a><a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a name="a76"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_h1_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBVERTEX, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, 1);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBEDGE, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTRI, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_l2_field_by_range = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> field_dim, <a class="code" href="classRange.html">Range</a> &amp;&amp;<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, field_dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a name="_a77"></a><a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_dim(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, dim, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_bubble_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, <a name="a78"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>, dim, MB_TAG_DENSE,</div>
<div class="line">                            <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// Modify field</span></div>
<div class="line">    <span class="keyword">auto</span> field_ptr = mField.get_field_structure(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <span class="keyword">auto</span> field_order_table =</div>
<div class="line">        <span class="keyword">const_cast&lt;</span><a name="_a79"></a><a class="code" href="structMoFEM_1_1Field.html">Field</a> *<span class="keyword">&gt;</span>(field_ptr)-&gt;getFieldOrderTable();</div>
<div class="line">    <span class="keyword">auto</span> get_cgg_bubble_order_zero = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 0; };</div>
<div class="line">    <span class="keyword">auto</span> get_cgg_bubble_order_tet = [](<span class="keywordtype">int</span> p) {</div>
<div class="line">      <span class="keywordflow">return</span> <a name="a80"></a><a class="code" href="CGGTonsorialBubbleBase_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a>(p);</div>
<div class="line">    };</div>
<div class="line">    field_order_table[MBVERTEX] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBEDGE] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBTRI] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBTET] = get_cgg_bubble_order_tet;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTRI, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_user_l2_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                           <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_field(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>, dim, MB_TAG_DENSE,</div>
<div class="line">                            <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// Modify field</span></div>
<div class="line">    <span class="keyword">auto</span> field_ptr = mField.get_field_structure(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <span class="keyword">auto</span> field_order_table =</div>
<div class="line">        <span class="keyword">const_cast&lt;</span><a class="code" href="structMoFEM_1_1Field.html">Field</a> *<span class="keyword">&gt;</span>(field_ptr)-&gt;getFieldOrderTable();</div>
<div class="line">    <span class="keyword">auto</span> zero_dofs = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 0; };</div>
<div class="line">    <span class="keyword">auto</span> dof_l2_tet = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> <a name="a81"></a><a class="code" href="h1__hdiv__hcurl__l2_8h.html#afff51d616c826e4714c19b69816fa74f">NBVOLUMETET_L2</a>(p); };</div>
<div class="line">    field_order_table[MBVERTEX] = zero_dofs;</div>
<div class="line">    field_order_table[MBEDGE] = zero_dofs;</div>
<div class="line">    field_order_table[MBTRI] = zero_dofs;</div>
<div class="line">    field_order_table[MBTET] = dof_l2_tet;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_field_by_type(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.set_field_order(meshset, MBTET, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// spatial fields</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_broken_hdiv_field(piolaStress, spaceOrder);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_bubble_field(bubbleField, spaceOrder, 1);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(spatialL2Disp, spaceOrder - 1, 3);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_user_l2_field(rotAxis, spaceOrder - 1, 3);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_user_l2_field(stretchTensor, noStretch ? -1 : spaceOrder, 6);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!skeletonFaces)</div>
<div class="line">    SETERRQ(mField.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No skeleton faces&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!contactFaces)</div>
<div class="line">    SETERRQ(mField.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No contact faces&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(hybridSpatialDisp, spaceOrder - 1, 2, 3,</div>
<div class="line">                               <a class="code" href="classRange.html">Range</a>(*skeletonFaces));</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(contactDisp, spaceOrder - 1, 2, 3,</div>
<div class="line">                               <a class="code" href="classRange.html">Range</a>(*contactFaces));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// spatial displacement</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_h1_field(spatialH1Disp, spaceH1Order, 3);</div>
<div class="line">  <span class="comment">// material positions</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_h1_field(materialH1Positions, 2, 3);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Eshelby stress</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_broken_hdiv_field(eshelbyStress, spaceOrder);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(materialL2Disp, spaceOrder - 1, 3);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(hybridMaterialDisp, spaceOrder - 1, 2, 3,</div>
<div class="line">                               <a class="code" href="classRange.html">Range</a>(*materialSkeletonFaces));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_fields();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::projectGeometry(<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> project_ho_geometry = [&amp;]() {</div>
<div class="line">    <a name="_a82"></a><a class="code" href="structMoFEM_1_1Projection10NodeCoordsOnField.html">Projection10NodeCoordsOnField</a> ent_method(mField, materialH1Positions);</div>
<div class="line">    <span class="keywordflow">return</span> mField.loop_dofs(materialH1Positions, ent_method);</div>
<div class="line">  };</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> project_ho_geometry();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_skin = [&amp;](<span class="keyword">auto</span> &amp;body_ents) {</div>
<div class="line">    Skinner skin(&amp;mField.get_moab());</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> skin_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents);</div>
<div class="line">    <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> filter_true_skin = [&amp;](<span class="keyword">auto</span> &amp;&amp;skin) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> boundary_ents;</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;mField.get_moab(), <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;boundary_ents);</div>
<div class="line">    <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_crack_front_edges = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = mField.get_moab();</div>
<div class="line">    <span class="keyword">auto</span> crack_skin = get_skin(*crackFaces);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> body_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_dimension(0, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    <span class="keyword">auto</span> body_skin = filter_true_skin(get_skin(body_ents));</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> body_skin_edges;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(body_skin, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>, body_skin_edges,</div>
<div class="line">                                moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">    crack_skin = subtract(crack_skin, body_skin_edges);</div>
<div class="line">    std::map&lt;int, Range&gt; received_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_skin, &amp;received_ents);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> to_remove;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : received_ents) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first != mField.get_comm_rank()) {</div>
<div class="line">        <span class="comment">// if the same edges appear on two or more processors, they are not at</span></div>
<div class="line">        <span class="comment">// the front</span></div>
<div class="line">        to_remove.merge(intersect(crack_skin, <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(to_remove);</div>
<div class="line">    crack_skin = subtract(crack_skin, to_remove);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_skin);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> boost::make_shared&lt;Range&gt;(crack_skin);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front_edges = [&amp;](<span class="keyword">auto</span> &amp;front_edges) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = mField.get_moab();</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> front_crack_nodes;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(front_edges, front_crack_nodes, <span class="keyword">true</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        front_crack_nodes);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> crack_front_edges;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(front_crack_nodes, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">false</span>,</div>
<div class="line">                                crack_front_edges, moab::Interface::UNION);</div>
<div class="line">    crack_front_edges = subtract(crack_front_edges, front_edges);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_front_edges);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> crack_front_edges_nodes;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(crack_front_edges, crack_front_edges_nodes,</div>
<div class="line">                                 <span class="keyword">true</span>);</div>
<div class="line">    crack_front_edges_nodes =</div>
<div class="line">        subtract(crack_front_edges_nodes, front_crack_nodes);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> crack_front_edges_with_both_nodes_not_at_front;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(crack_front_edges_nodes, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">false</span>,</div>
<div class="line">                                crack_front_edges_with_both_nodes_not_at_front,</div>
<div class="line">                                moab::Interface::UNION);</div>
<div class="line">    crack_front_edges_with_both_nodes_not_at_front = intersect(</div>
<div class="line">        crack_front_edges_with_both_nodes_not_at_front, crack_front_edges);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(boost::make_shared&lt;Range&gt;(front_crack_nodes),</div>
<div class="line">                          boost::make_shared&lt;Range&gt;(</div>
<div class="line">                              crack_front_edges_with_both_nodes_not_at_front));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  crackFaces = boost::make_shared&lt;Range&gt;(</div>
<div class="line">      <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;CRACK&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line">  frontEdges = get_crack_front_edges();</div>
<div class="line">  <span class="keyword">auto</span> [front_vertices, front_adj_edges] = get_adj_front_edges(*frontEdges);</div>
<div class="line">  frontVertices = front_vertices;</div>
<div class="line">  frontAdjEdges = front_adj_edges;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_singular_dofs = [&amp;](<span class="keyword">auto</span> &amp;front_adj_edges, <span class="keyword">auto</span> &amp;front_vertices) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = mField.get_moab();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a name="a83"></a><a class="code" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> = 1;</div>
<div class="line">    <span class="keywordtype">double</span> beta = 0;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a84"></a><a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-singularity_eps&quot;</span>, &amp;beta,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Singularity eps &quot;</span> &lt;&lt; beta;</div>
<div class="line">    <a class="code" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> -= beta;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> edge : front_adj_edges) {</div>
<div class="line">      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">      <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edge, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordtype">double</span> coords[6];</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, coords);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> dir[3] = {coords[3] - coords[0], coords[4] - coords[1],</div>
<div class="line">                             coords[5] - coords[2]};</div>
<div class="line">      <span class="keywordtype">double</span> dof[3] = {0, 0, 0};</div>
<div class="line">      <span class="keywordflow">if</span> (front_vertices.find(conn[0]) != front_vertices.end()) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>++) {</div>
<div class="line">          dof[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] = -dir[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] * <a class="code" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (front_vertices.find(conn[1]) != front_vertices.end()) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>++) {</div>
<div class="line">          dof[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] = +dir[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] * <a class="code" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<a name="a85"></a><a class="code" href="group__mofem__access.html#gaead3887ddc924ad6d2a0993bfb4a9b27">_IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_</a>(</div>
<div class="line">               mField, materialH1Positions, edge, dit)) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = dit-&gt;get()-&gt;getEntDofIdx();</div>
<div class="line">        <span class="keywordflow">if</span> (idx &gt; 2) {</div>
<div class="line">          dit-&gt;get()-&gt;getFieldData() = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          dit-&gt;get()-&gt;getFieldData() = dof[idx];</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (setSingularity)</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_singular_dofs(*frontAdjEdges, *frontVertices);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">EshelbianCore::addVolumeFiniteElement(<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set finite element fields</span></div>
<div class="line">  <span class="keyword">auto</span> add_field_to_fe = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string fe,</div>
<div class="line">                                <span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(fe, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(fe, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(fe, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(elementVolumeName)) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(elementVolumeName, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(meshset, MBTET,</div>
<div class="line">                                                     elementVolumeName);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, piolaStress);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, bubbleField);</div>
<div class="line">    <span class="keywordflow">if</span> (!noStretch)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, stretchTensor);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, rotAxis);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, spatialL2Disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, spatialH1Disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(elementVolumeName, contactDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(elementVolumeName,</div>
<div class="line">                                                       materialH1Positions);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build finite elements data structures</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(elementVolumeName);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(materialVolumeElement)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> front_edges = <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;FRONT&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> front_elements;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a name="a86"></a><a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0; <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> != frontLayers; ++<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) {</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> front_elements_layer;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(front_edges, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>,</div>
<div class="line">                                               front_elements_layer,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      front_elements.merge(front_elements_layer);</div>
<div class="line">      front_edges.clear();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(front_elements_layer,</div>
<div class="line">                                               <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>, front_edges,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(materialVolumeElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(front_elements, MBTET,</div>
<div class="line">                                                     materialVolumeElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(materialVolumeElement, eshelbyStress);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(materialVolumeElement, materialL2Disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(materialVolumeElement);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">EshelbianCore::addBoundaryFiniteElement(<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_fe_adjacency = [&amp;](<span class="keyword">auto</span> fe_name) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    parentAdjSkeletonFunctionDim2 =</div>
<div class="line">        boost::make_shared&lt;ParentFiniteElementAdjacencyFunctionSkeleton&lt;2&gt;&gt;(</div>
<div class="line">            bitAdjParent, bitAdjParentMask, bitAdjEnt, bitAdjEntMask);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_adjacency_table(</div>
<div class="line">        fe_name, MBTRI, *parentAdjSkeletonFunctionDim2);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set finite element fields</span></div>
<div class="line">  <span class="keyword">auto</span> add_field_to_fe = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string fe,</div>
<div class="line">                                <span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_row(fe, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_col(fe, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(fe, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(fe, materialH1Positions);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(naturalBcElement)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> natural_bc_elements;</div>
<div class="line">    <span class="keywordflow">if</span> (bcSpatialDispVecPtr) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialDispVecPtr) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (bcSpatialRotationVecPtr) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialRotationVecPtr) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (bcSpatialTraction) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialTraction) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(naturalBcElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(natural_bc_elements, MBTRI,</div>
<div class="line">                                                     naturalBcElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(naturalBcElement, hybridSpatialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(naturalBcElement);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_skin = [&amp;](<span class="keyword">auto</span> &amp;body_ents) {</div>
<div class="line">    Skinner skin(&amp;mField.get_moab());</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> skin_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents);</div>
<div class="line">    <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> filter_true_skin = [&amp;](<span class="keyword">auto</span> &amp;&amp;skin) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> boundary_ents;</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;mField.get_moab(), <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;boundary_ents);</div>
<div class="line">    <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(skinElement)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> body_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_dimension(0, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    <span class="keyword">auto</span> skin = filter_true_skin(get_skin(body_ents));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(skinElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(skin, MBTRI, skinElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(skinElement,</div>
<div class="line">                                                       spatialH1Disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(skinElement,</div>
<div class="line">                                                       materialH1Positions);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(skinElement,</div>
<div class="line">                                                       hybridSpatialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(skinElement,</div>
<div class="line">                                                       hybridMaterialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(skinElement,</div>
<div class="line">                                                       contactDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(skinElement);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(contactElement)) {</div>
<div class="line">    <span class="keywordflow">if</span> (contactFaces) {</div>
<div class="line">      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Contact elements &quot;</span> &lt;&lt; contactFaces-&gt;size();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(contactElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(*contactFaces, MBTRI,</div>
<div class="line">                                                       contactElement);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(contactElement, piolaStress);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(contactElement, spatialH1Disp);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(contactElement, hybridSpatialDisp);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(contactElement, contactDisp);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(contactElement);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(contactElement);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(skeletonElement)) {</div>
<div class="line">    <span class="keywordflow">if</span> (!skeletonFaces)</div>
<div class="line">      SETERRQ(mField.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No skeleton faces&quot;</span>);</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Skeleton elements &quot;</span> &lt;&lt; skeletonFaces-&gt;size();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(skeletonElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(*skeletonFaces, MBTRI,</div>
<div class="line">                                                     skeletonElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(skeletonElement, piolaStress);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(skeletonElement, hybridSpatialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(contactElement, contactDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(skeletonElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(skeletonElement);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(materialSkeletonElement)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> front_edges = <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;FRONT&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> front_elements;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0; <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> != frontLayers; ++<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) {</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> front_elements_layer;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(front_edges, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>,</div>
<div class="line">                                               front_elements_layer,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      front_elements.merge(front_elements_layer);</div>
<div class="line">      front_edges.clear();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(front_elements_layer,</div>
<div class="line">                                               <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>, front_edges,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> body_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_dimension(0, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> front_elements_faces;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_adjacencies(front_elements, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1,</div>
<div class="line">                                             <span class="keyword">true</span>, front_elements_faces,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line">    <span class="keyword">auto</span> body_skin = filter_true_skin(get_skin(body_ents));</div>
<div class="line">    <span class="keyword">auto</span> front_elements_skin = filter_true_skin(get_skin(front_elements));</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> material_skeleton_faces =</div>
<div class="line">        subtract(front_elements_faces, front_elements_skin);</div>
<div class="line">    material_skeleton_faces.merge(intersect(front_elements_skin, body_skin));</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(mField.get_moab(), <span class="stringliteral">&quot;front_elements.vtk&quot;</span>, front_elements);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(mField.get_moab(), <span class="stringliteral">&quot;front_elements_skin.vtk&quot;</span>,</div>
<div class="line">                      front_elements_skin);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a>(mField.get_moab(), <span class="stringliteral">&quot;material_skeleton_faces.vtk&quot;</span>,</div>
<div class="line">                      material_skeleton_faces);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(materialSkeletonElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(</div>
<div class="line">        material_skeleton_faces, MBTRI, materialSkeletonElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(materialSkeletonElement, eshelbyStress);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(materialSkeletonElement, hybridMaterialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(materialSkeletonElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(materialSkeletonElement);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!mField.check_finite_element(crackElement)) {</div>
<div class="line">    <span class="keyword">auto</span> crack_faces = <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;CRACK&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_finite_element(crackElement, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.add_ents_to_finite_element_by_type(crack_faces, MBTRI,</div>
<div class="line">                                                     crackElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(crackElement, eshelbyStress);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(crackElement, hybridMaterialDisp);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(crackElement,</div>
<div class="line">                                                       spatialH1Disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(crackElement,</div>
<div class="line">                                                       materialH1Positions);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(crackElement,</div>
<div class="line">                                                       hybridSpatialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(crackElement,</div>
<div class="line">                                                       hybridMaterialDisp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.modify_finite_element_add_field_data(crackElement,</div>
<div class="line">                                                       contactDisp);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(crackElement);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_finite_elements(crackElement);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::addDMs(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a name="a87"></a><a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line">                                     <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// find adjacencies between finite elements and dofs</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.build_adjacencies(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a name="a88"></a><a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create coupled problem</span></div>
<div class="line">  dM = <a name="a89"></a><a class="code" href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(mField.get_comm(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a90"></a><a class="code" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(dM, &amp;mField, <span class="stringliteral">&quot;ESHELBY_PLASTICITY&quot;</span>, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line">                            <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a91"></a><a class="code" href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(dM, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a92"></a><a class="code" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(dM, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a93"></a><a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dM, elementVolumeName);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dM, naturalBcElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dM, skeletonElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dM, contactElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dM, crackElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dM, skinElement);</div>
<div class="line"> </div>
<div class="line">  mField.getInterface&lt;<a name="_a94"></a><a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_TRUE;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dM);</div>
<div class="line">  mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> remove_dofs_on_broken_skin = [&amp;](<span class="keyword">const</span> std::string prb_name) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a name="a95"></a><a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> : {0, 1, 2}) {</div>
<div class="line">      std::vector&lt;boost::weak_ptr&lt;NumeredDofEntity&gt;&gt; dofs_to_remove;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()</div>
<div class="line">          -&gt;getSideDofsOnBrokenSpaceEntities(</div>
<div class="line">              dofs_to_remove, prb_name, <a name="a96"></a><a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, piolaStress,</div>
<div class="line">              (*bcSpatialFreeTraction)[<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>], <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>, <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>);</div>
<div class="line">      <span class="comment">// remove piola dofs, i.e. traction free boundary</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;removeDofs(prb_name, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">                                                                dofs_to_remove);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;removeDofs(prb_name, <a name="a97"></a><a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>,</div>
<div class="line">                                                                dofs_to_remove);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_dofs_on_broken_skin(<span class="stringliteral">&quot;ESHELBY_PLASTICITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create elastic sub-problem</span></div>
<div class="line">  dmElastic = <a class="code" href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(mField.get_comm(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a98"></a><a class="code" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dmElastic, dM, <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(dmElastic, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a99"></a><a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, piolaStress);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, bubbleField);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, spatialL2Disp);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, rotAxis);</div>
<div class="line">  <span class="keywordflow">if</span> (!noStretch) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, stretchTensor);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, hybridSpatialDisp);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmElastic, contactDisp);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dmElastic, elementVolumeName);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dmElastic, naturalBcElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dmElastic, skeletonElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dmElastic, contactElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dmElastic, skinElement);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a100"></a><a class="code" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dmElastic, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(dmElastic, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dmElastic);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// dmMaterial = createDM(mField.get_comm(), &quot;DMMOFEM&quot;);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMCreateSubDM(dmMaterial, dM, &quot;MATERIAL_PROBLEM&quot;);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetDestroyProblem(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddSubFieldRow(dmMaterial, eshelbyStress);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddSubFieldRow(dmMaterial, materialL2Disp);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterh elementVolumeName);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterial, naturalBcElement);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterial, skinElement);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetSquareProblem(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetIsPartitioned(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMSetUp(dmMaterial);</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_zero_block = [&amp;]() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (!noStretch) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, spatialL2Disp, stretchTensor);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, stretchTensor, spatialL2Disp);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, spatialL2Disp, rotAxis);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, rotAxis, spatialL2Disp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, spatialL2Disp, bubbleField);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, bubbleField, spatialL2Disp);</div>
<div class="line">    <span class="keywordflow">if</span> (!noStretch) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, bubbleField, bubbleField);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, piolaStress, piolaStress);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, bubbleField, piolaStress);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, piolaStress, bubbleField);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_section = [&amp;]() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    PetscSection section;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a name="_a101"></a><a class="code" href="structMoFEM_1_1ISManager.html">ISManager</a>&gt;()-&gt;sectionCreate(<span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>,</div>
<div class="line">                                                           &amp;section);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetSection(dmElastic, section);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetGlobalSection(dmElastic, section);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionDestroy(&amp;section);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_zero_block();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section();</div>
<div class="line"> </div>
<div class="line">  dmPrjSpatial = <a class="code" href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(mField.get_comm(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(dmPrjSpatial, dM, <span class="stringliteral">&quot;PROJECT_SPATIAL&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(dmPrjSpatial, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(dmPrjSpatial, spatialH1Disp);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dmPrjSpatial, elementVolumeName);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(dmPrjSpatial, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(dmPrjSpatial, PETSC_TRUE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dmPrjSpatial);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;<a name="_a102"></a><a class="code" href="structMoFEM_1_1BcManager.html">BcManager</a>&gt;()</div>
<div class="line">      -&gt;pushMarkDOFsOnEntities&lt;DisplacementCubitBcData&gt;(</div>
<div class="line">          <span class="stringliteral">&quot;PROJECT_SPATIAL&quot;</span>, spatialH1Disp, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BcDisp::BcDisp(std::string name, std::vector&lt;double&gt; &amp;attr, <a class="code" href="classRange.html">Range</a> &amp;faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">    flags[ii] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(attr[ii + 3]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCDisp &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCDisp vals &quot;</span> &lt;&lt; vals[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[2];</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCDisp flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCDisp nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BcRot::BcRot(std::string name, std::vector&lt;double&gt; &amp;attr, <a class="code" href="classRange.html">Range</a> &amp;faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">  }</div>
<div class="line">  theta = attr[3];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">TractionBc::TractionBc(std::string name, std::vector&lt;double&gt; &amp;attr,</div>
<div class="line">                       <a class="code" href="classRange.html">Range</a> &amp;faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">    flags[ii] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(attr[ii + 3]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCForce &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCForce vals &quot;</span> &lt;&lt; vals[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[2];</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCForce flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCForce nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">EshelbianCore::getTractionFreeBc(<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset,</div>
<div class="line">                                 boost::shared_ptr&lt;TractionFreeBc&gt; &amp;bc_ptr,</div>
<div class="line">                                 <span class="keyword">const</span> std::string contact_set_name) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get skin from all tets</span></div>
<div class="line">  <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.get_moab().get_entities_by_type(meshset, MBTET, tets);</div>
<div class="line">  <a class="code" href="classRange.html">Range</a> tets_skin_part;</div>
<div class="line">  Skinner skin(&amp;mField.get_moab());</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, tets_skin_part);</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;mField.get_moab(), <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code" href="classRange.html">Range</a> tets_skin;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(tets_skin_part,</div>
<div class="line">                               PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                               PSTATUS_NOT, -1, &amp;tets_skin);</div>
<div class="line"> </div>
<div class="line">  bc_ptr-&gt;resize(3);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; ++<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>)</div>
<div class="line">    (*bc_ptr)[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>] = tets_skin;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do not remove dofs on which traction is applied</span></div>
<div class="line">  <span class="keywordflow">if</span> (bcSpatialDispVecPtr)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialDispVecPtr) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[0])</div>
<div class="line">        (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[1])</div>
<div class="line">        (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[2])</div>
<div class="line">        (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do not remove dofs on which rotation is applied</span></div>
<div class="line">  <span class="keywordflow">if</span> (bcSpatialRotationVecPtr)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialRotationVecPtr) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (bcSpatialTraction)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *bcSpatialTraction) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// remove contact</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : mField.getInterface&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line">           std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % contact_set_name).str()))) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> faces;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;getMeshsetIdEntitiesByDimension(mField.get_moab(), 2, faces,</div>
<div class="line">                                              <span class="keyword">true</span>);</div>
<div class="line">    (*bc_ptr)[0] = subtract((*bc_ptr)[0], faces);</div>
<div class="line">    (*bc_ptr)[1] = subtract((*bc_ptr)[1], faces);</div>
<div class="line">    (*bc_ptr)[2] = subtract((*bc_ptr)[2], faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Set integration rule on element</span></div>
<div class="line"><span class="comment"> * \param order on row</span></div>
<div class="line"><span class="comment"> * \param order on column</span></div>
<div class="line"><span class="comment"> * \param order on data</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Use maximal oder on data in order to determine integration rule</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a name="_a103"></a><a class="code" href="structVolRule.html">VolRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a name="a104"></a><a class="code" href="structVolRule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="comment">// if (EshelbianCore::gradApproximator &gt; MODERATE_ROT)</span></div>
<div class="line">    <span class="comment">//   return p_data + p_data + (p_data - 1);</span></div>
<div class="line">    <span class="comment">// else</span></div>
<div class="line">    <span class="keywordflow">return</span> 2 * p_data + 1;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a name="_a105"></a><a class="code" href="structFaceRule.html">FaceRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a name="a106"></a><a class="code" href="structFaceRule.html#aa4dbe8a983fafee94833d9f28e4eb5bf">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * (p_data + 1);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">CGGUserPolynomialBase::CGGUserPolynomialBase(</div>
<div class="line">    boost::shared_ptr&lt;CachePhi&gt; cache_phi_otr)</div>
<div class="line">    : <a name="_a107"></a><a class="code" href="structMoFEM_1_1TetPolynomialBase.html">TetPolynomialBase</a>(), cachePhiPtr(cache_phi_otr) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> CGGUserPolynomialBase::query_interface(</div>
<div class="line">    boost::typeindex::type_index type_index,</div>
<div class="line">    <a name="_a108"></a><a class="code" href="structMoFEM_1_1BaseFunctionUnknownInterface.html">BaseFunctionUnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line">  *iface = <span class="keyword">const_cast&lt;</span>CGGUserPolynomialBase *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">CGGUserPolynomialBase::getValue(<a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;pts,</div>
<div class="line">                                boost::shared_ptr&lt;BaseFunctionCtx&gt; ctx_ptr) {</div>
<div class="line">  <a name="a109"></a><a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"> </div>
<div class="line">  this-&gt;cTx = ctx_ptr-&gt;getInterface&lt;<a name="_a110"></a><a class="code" href="structMoFEM_1_1EntPolynomialBaseCtx.html">EntPolynomialBaseCtx</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nb_gauss_pts = pts.size2();</div>
<div class="line">  <span class="keywordflow">if</span> (!nb_gauss_pts) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (pts.size1() &lt; 3) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Wrong dimension of pts, should be at least 3 rows with &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;coordinates&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> base = this-&gt;cTx-&gt;bAse;</div>
<div class="line">  <a name="_a111"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData.html">EntitiesFieldData</a> &amp;data = this-&gt;cTx-&gt;dAta;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (this-&gt;cTx-&gt;sPace) {</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>:</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getValueHdivForCGGBubble(pts);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>:</div>
<div class="line">    data.<a name="a112"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getN(base).resize(nb_gauss_pts, 4, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Tools::shapeFunMBTET(</div>
<div class="line">        &amp;*data.<a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getN(base).data().begin(),</div>
<div class="line">        &amp;pts(0, 0), &amp;pts(1, 0), &amp;pts(2, 0), nb_gauss_pts);</div>
<div class="line">    data.<a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getDiffN(base).resize(4, 3, <span class="keyword">false</span>);</div>
<div class="line">    std::copy(Tools::diffShapeFunMBTET.begin(), Tools::diffShapeFunMBTET.end(),</div>
<div class="line">              data.<a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getDiffN(base).data().begin());</div>
<div class="line">    this-&gt;cTx-&gt;basePolynomialsType0 = <a name="a113"></a><a class="code" href="group__mofem__base__functions.html#ga176a495a81c85ce580624a284726521e">Legendre_polynomials</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getValueL2AinsworthBase(pts);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a name="a114"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not yet implemented&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">CGGUserPolynomialBase::getValueHdivForCGGBubble(<a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;pts) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// This should be used only in case USER_BASE is selected</span></div>
<div class="line">  <span class="keywordflow">if</span> (this-&gt;cTx-&gt;bAse != <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Wrong base, should be USER_BASE&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// get access to data structures on element</span></div>
<div class="line">  <a class="code" href="structMoFEM_1_1EntitiesFieldData.html">EntitiesFieldData</a> &amp;data = this-&gt;cTx-&gt;dAta;</div>
<div class="line">  <span class="comment">// Get approximation order on element. Note that bubble functions are only</span></div>
<div class="line">  <span class="comment">// on tetrahedron.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getOrder();<span class="comment"></span></div>
<div class="line"><span class="comment">  /// number of integration points</span></div>
<div class="line"><span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = pts.size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> check_cache = [<span class="keyword">this</span>](<span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keywordtype">int</span> nb_gauss_pts) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line">    <span class="keywordflow">if</span> (cachePhiPtr) {</div>
<div class="line">      <span class="keywordflow">return</span> cachePhiPtr-&gt;get&lt;0&gt;() == <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &amp;&amp;</div>
<div class="line">             cachePhiPtr-&gt;get&lt;1&gt;() == nb_gauss_pts;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (check_cache(<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, nb_gauss_pts)) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;mat = cachePhiPtr-&gt;get&lt;2&gt;();</div>
<div class="line">    <span class="keyword">auto</span> &amp;<a name="a115"></a><a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getN(<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>);</div>
<div class="line">    <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(mat.size1(), mat.size2(), <span class="keyword">false</span>);</div>
<div class="line">    noalias(<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>) = mat;</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// calculate shape functions, i.e. barycentric coordinates</span></div>
<div class="line">    shapeFun.resize(nb_gauss_pts, 4, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a116"></a><a class="code" href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a>(&amp;*shapeFun.data().begin(), &amp;pts(0, 0), &amp;pts(1, 0),</div>
<div class="line">                      &amp;pts(2, 0), nb_gauss_pts);</div>
<div class="line">    <span class="comment">// derivatives of shape functions</span></div>
<div class="line">    <span class="keywordtype">double</span> diff_shape_fun[12];</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a117"></a><a class="code" href="fem__tools_8h.html#a19deff62572d607bc77ed2f82fa639cc">ShapeDiffMBTET</a>(diff_shape_fun);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = <a class="code" href="CGGTonsorialBubbleBase_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a>(<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <span class="comment">// get base functions and set size</span></div>
<div class="line">    <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getN(<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>);</div>
<div class="line">    <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(nb_gauss_pts, 9 * nb_base_functions, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// finally calculate base functions</span></div>
<div class="line">    <a name="_a118"></a><a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 9&gt;</a>, 3, 3&gt; t_phi(</div>
<div class="line">        &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 0), &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 1), &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 2),</div>
<div class="line"> </div>
<div class="line">        &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 3), &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 4), &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 5),</div>
<div class="line"> </div>
<div class="line">        &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 6), &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 7), &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 8));</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a119"></a><a class="code" href="namespaceEshelbianPlasticity.html#a68543d06189d85f76d53dfc14a39ecf5">CGG_BubbleBase_MBTET</a>(<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, &amp;shapeFun(0, 0), diff_shape_fun, t_phi,</div>
<div class="line">                                nb_gauss_pts);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cachePhiPtr) {</div>
<div class="line">      cachePhiPtr-&gt;get&lt;0&gt;() = <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>;</div>
<div class="line">      cachePhiPtr-&gt;get&lt;1&gt;() = nb_gauss_pts;</div>
<div class="line">      cachePhiPtr-&gt;get&lt;2&gt;().resize(<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size1(), <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size2(), <span class="keyword">false</span>);</div>
<div class="line">      noalias(cachePhiPtr-&gt;get&lt;2&gt;()) = <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::setBaseVolumeElementOps(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_rhs, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_lhs,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  fe = boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(mField);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bubble_cache =</div>
<div class="line">      boost::make_shared&lt;CGGUserPolynomialBase::CachePhi&gt;(0, 0, <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>());</div>
<div class="line">  fe-&gt;getUserPolynomialBase() =</div>
<div class="line">      boost::make_shared&lt;CGGUserPolynomialBase&gt;(bubble_cache);</div>
<div class="line">  <a name="_a120"></a><a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      fe-&gt;getOpPtrVector(), {HDIV, H1, L2}, materialH1Positions, frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set integration rule</span></div>
<div class="line">  fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!dataAtPts) {</div>
<div class="line">    dataAtPts =</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt;(<span class="keyword">new</span> DataAtIntegrationPts());</div>
<div class="line">    dataAtPts-&gt;physicsPtr = physicalEquations;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate fields values</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a121"></a><a class="code" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">      piolaStress, dataAtPts-&gt;getApproxPAtPts()));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a122"></a><a class="code" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">      bubbleField, dataAtPts-&gt;getApproxPAtPts(), MBMAXTYPE));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a123"></a><a class="code" href="structMoFEM_1_1OpCalculateHVecTensorDivergence.html">OpCalculateHVecTensorDivergence&lt;3, 3&gt;</a>(</div>
<div class="line">      piolaStress, dataAtPts-&gt;getDivPAtPts()));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (noStretch) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        physicalEquations-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">            dataAtPts, physicalEquations));</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a124"></a><a class="code" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">            stretchTensor, dataAtPts-&gt;getLogStretchTensorAtPts(), MBTET));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a125"></a><a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      rotAxis, dataAtPts-&gt;getRotAxisAtPts(), MBTET));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      spatialL2Disp, dataAtPts-&gt;getSmallWL2AtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// velocities</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a126"></a><a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">OpCalculateVectorFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">      spatialL2Disp, dataAtPts-&gt;getSmallWL2DotAtPts(), MBTET));</div>
<div class="line">  <span class="keywordflow">if</span> (noStretch) {</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a127"></a><a class="code" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValuesDot.html">OpCalculateTensor2SymmetricFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">            stretchTensor, dataAtPts-&gt;getLogStretchDotTensorAtPts(), MBTET));</div>
<div class="line">  }</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">OpCalculateVectorFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">      rotAxis, dataAtPts-&gt;getRotAxisDotAtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// acceleration</span></div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(alphaRho) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">OpCalculateVectorFieldValuesDotDot&lt;3&gt;</a>(</div>
<div class="line">        spatialL2Disp, dataAtPts-&gt;getSmallWL2DotDotAtPts(), MBTET));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// H1 displacements</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      spatialH1Disp, dataAtPts-&gt;getSmallWH1AtPts()));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a128"></a><a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">      spatialH1Disp, dataAtPts-&gt;getSmallWGradH1AtPts()));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate other derived quantities</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateRotationAndSpatialGradient(dataAtPts));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// evaluate integration points</span></div>
<div class="line">  <span class="keywordflow">if</span> (noStretch) {</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(physicalEquations-&gt;returnOpJacobian(</div>
<div class="line">        tag, do_rhs, do_lhs, dataAtPts, physicalEquations));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::setVolumeElementOps(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_elastic, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_material,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe_rhs,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe_lhs) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** Contact requires that body is marked */</span></div>
<div class="line">  <span class="keyword">auto</span> get_body_range = [<span class="keyword">this</span>](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr :</div>
<div class="line">         mField.getInterface&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(std::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line">      <a class="code" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_ptr-&gt;getMeshsetIdEntitiesByDimension(mField.get_moab(),</div>
<div class="line">                                                            dim, ents, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;by dim&quot;</span>);</div>
<div class="line">      map[m_ptr-&gt;getMeshsetId()] = ents;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> rule_contact = [](<a name="a129"></a><a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> o) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  <span class="keyword">auto</span> refine = Tools::refineTriangle(contactRefinementLevels);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_rule_contact = [refine](</div>
<div class="line"> </div>
<div class="line">                              <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                              <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data</div>
<div class="line"> </div>
<div class="line">                          ) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> rule = 2 * order_data;</div>
<div class="line">    fe_raw_ptr-&gt;<a name="a130"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html#a91c6f5f96b8f4ec76ed7c87ea96bbd9c">gaussPts</a> = Tools::refineTriangleIntegrationPts(rule, refine);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> time_scale = boost::make_shared&lt;TimeScale&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Right hand side</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setBaseVolumeElementOps(tag, <span class="keyword">true</span>, <span class="keyword">false</span>, fe_rhs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSpatialEquilibrium(spatialL2Disp, dataAtPts, alphaW, alphaRho));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSpatialRotation(rotAxis, dataAtPts));</div>
<div class="line">    <span class="keywordflow">if</span> (noStretch) {</div>
<div class="line">      <span class="comment">// do nothing - no stretch approximation</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          physicalEquations-&gt;returnOpSpatialPhysical(stretchTensor, dataAtPts,</div>
<div class="line">                                                     alphaU));</div>
<div class="line">    }</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSpatialConsistencyP(piolaStress, dataAtPts));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSpatialConsistencyBubble(bubbleField, dataAtPts));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSpatialConsistencyDivTerm(piolaStress, dataAtPts));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_hybridisation = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a name="_a131"></a><a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a name="_a132"></a><a class="code" href="classSideEleOp.html">SideEleOp</a> = <a name="a133"></a><a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a name="_a134"></a><a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          mField, skeletonElement, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              materialH1Positions, frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly one</span></div>
<div class="line">      <span class="comment">// domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a name="_a135"></a><a class="code" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          materialH1Positions, frontAdjEdges);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a136"></a><a class="code" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(piolaStress, broken_data_ptr));</div>
<div class="line">      <span class="keyword">auto</span> flux_mat_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;SPACE_DIM, SPACE_DIM&gt;</a>(piolaStress,</div>
<div class="line">                                                               flux_mat_ptr));</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a137"></a><a class="code" href="structMoFEM_1_1OpSetFlux.html">OpSetFlux&lt;SideEleOp&gt;</a>(broken_data_ptr, flux_mat_ptr));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Assemble on skeleton</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keyword">using</span> OpC_dHybrid = <a name="_a138"></a><a class="code" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a name="a139"></a><a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;::LinearForm&lt;</div>
<div class="line">          <a name="a140"></a><a class="code" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDHybrid&lt;SPACE_DIM&gt;;</div>
<div class="line">      <span class="keyword">using</span> OpC_dBroken = <a class="code" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;::LinearForm&lt;</div>
<div class="line">          <a class="code" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDFlux&lt;SPACE_DIM&gt;;</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpC_dHybrid(hybridSpatialDisp, broken_data_ptr, 1.));</div>
<div class="line">      <span class="keyword">auto</span> hybrid_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(hybridSpatialDisp,</div>
<div class="line">                                                      hybrid_ptr));</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpC_dBroken(broken_data_ptr, hybrid_ptr, 1.));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_contact = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="classSideEleOp.html">SideEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          mField, contactElement, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule_contact;</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook = set_rule_contact;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              materialH1Positions, frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly</span></div>
<div class="line">      <span class="comment">// one domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Data storing contact fields</span></div>
<div class="line">      <span class="keyword">auto</span> contact_common_data_ptr =</div>
<div class="line">          boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_domain_side = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">        <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">            mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">        op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">            boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">        <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">            op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">            materialH1Positions, frontAdjEdges);</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(piolaStress,</div>
<div class="line">                                                   broken_data_ptr));</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a141"></a><a class="code" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">                piolaStress, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">        pip.push_back(op_loop_domain_side);</div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_contact_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// get body id and SDF range</span></div>
<div class="line">        <span class="keyword">auto</span> contact_sfd_map_range_ptr =</div>
<div class="line">            boost::make_shared&lt;std::map&lt;int, Range&gt;&gt;(</div>
<div class="line">                get_body_range(<span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            contactDisp, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">        <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(spatialH1Disp, u_h1_ptr));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">            contactTreeRhs, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">            <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), <span class="keyword">nullptr</span>,</div>
<div class="line">            <span class="keyword">nullptr</span>));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a name="_a142"></a><a class="code" href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Rhs.html">EshelbianPlasticity::OpConstrainBoundaryL2Rhs</a>(</div>
<div class="line">            contactDisp, contact_common_data_ptr, contactTreeRhs,</div>
<div class="line">            contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a143"></a><a class="code" href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivRhs.html">EshelbianPlasticity::OpConstrainBoundaryHDivRhs&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                broken_data_ptr, contact_common_data_ptr, contactTreeRhs));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push ops to face/side pipeline</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_domain_side(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_contact_rhs(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_hybridisation(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_contact(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Body forces</span></div>
<div class="line">    <span class="keyword">using</span> BodyNaturalBC =</div>
<div class="line">        <a name="_a144"></a><a class="code" href="structMoFEM_1_1NaturalBC.html">NaturalBC&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;</a>::</div>
<div class="line">            Assembly&lt;PETSC&gt;::LinearForm&lt;<a class="code" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;;</div>
<div class="line">    <span class="keyword">using</span> <a name="_a145"></a><a class="code" href="structMoFEM_1_1OpFluxRhsImpl.html">OpBodyForce</a> =</div>
<div class="line">        BodyNaturalBC::OpFlux&lt;NaturalMeshsetType&lt;BLOCKSET&gt;, 1, 3&gt;;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> BodyNaturalBC::AddFluxToPipeline&lt;OpBodyForce&gt;::add(</div>
<div class="line">        fe_rhs-&gt;getOpPtrVector(), mField, spatialL2Disp, {time_scale},</div>
<div class="line">        <span class="stringliteral">&quot;BODY_FORCE&quot;</span>, Sev::inform);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Left hand side</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setBaseVolumeElementOps(tag, <span class="keyword">true</span>, <span class="keyword">true</span>, fe_lhs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> symmetric_system =</div>
<div class="line">        (gradApproximator &lt;= <a name="a146"></a><a class="code" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17ac5de4be4804727d358178fdb2865c6dc">MODERATE_ROT</a> &amp;&amp; rotSelector == <a name="a147"></a><a class="code" href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17abda7fcbd4e5150d5a9cce58e690ea085">SMALL_ROT</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (noStretch) {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpSpatialConsistency_dP_dP(piolaStress, piolaStress, dataAtPts));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialConsistency_dBubble_dP(</div>
<div class="line">          bubbleField, piolaStress, dataAtPts));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpSpatialConsistency_dBubble_dBubble(bubbleField, bubbleField,</div>
<div class="line">                                                   dataAtPts));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          physicalEquations-&gt;returnOpSpatialPhysical_du_du(</div>
<div class="line">              stretchTensor, stretchTensor, dataAtPts, alphaU));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialPhysical_du_dP(</div>
<div class="line">          stretchTensor, piolaStress, dataAtPts, <span class="keyword">true</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialPhysical_du_dBubble(</div>
<div class="line">          stretchTensor, bubbleField, dataAtPts, <span class="keyword">true</span>));</div>
<div class="line">      <span class="keywordflow">if</span> (!symmetric_system) {</div>
<div class="line">        fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialPhysical_du_domega(</div>
<div class="line">            stretchTensor, rotAxis, dataAtPts, <span class="keyword">false</span>));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialEquilibrium_dw_dP(</div>
<div class="line">        spatialL2Disp, piolaStress, dataAtPts, <span class="keyword">true</span>));</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialEquilibrium_dw_dw(</div>
<div class="line">        spatialL2Disp, spatialL2Disp, dataAtPts, alphaW, alphaRho));</div>
<div class="line"> </div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialConsistency_dP_domega(</div>
<div class="line">        piolaStress, rotAxis, dataAtPts, symmetric_system));</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialConsistency_dBubble_domega(</div>
<div class="line">        bubbleField, rotAxis, dataAtPts, symmetric_system));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!symmetric_system) {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialRotation_domega_dP(</div>
<div class="line">          rotAxis, piolaStress, dataAtPts, <span class="keyword">false</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpSpatialRotation_domega_dBubble(</div>
<div class="line">          rotAxis, bubbleField, dataAtPts, <span class="keyword">false</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpSpatialRotation_domega_domega(rotAxis, rotAxis, dataAtPts));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_hybridisation = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="classSideEleOp.html">SideEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          mField, skeletonElement, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              materialH1Positions, frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly one</span></div>
<div class="line">      <span class="comment">// domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          materialH1Positions, frontAdjEdges);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(piolaStress, broken_data_ptr));</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keyword">using</span> OpC = <a class="code" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;<a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;<a name="_a148"></a><a class="code" href="classBiLinearForm.html">::BiLinearForm</a>&lt;</div>
<div class="line">          <a class="code" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrain&lt;SPACE_DIM&gt;;</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpC(hybridSpatialDisp, broken_data_ptr, 1., <span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line"> </div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_contact = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="classSideEleOp.html">SideEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          mField, contactElement, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule_contact;</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook = set_rule_contact;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              materialH1Positions, frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly</span></div>
<div class="line">      <span class="comment">// one domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Data storing contact fields</span></div>
<div class="line">      <span class="keyword">auto</span> contact_common_data_ptr =</div>
<div class="line">          boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_domain_side = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">        <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpBrokenLoopSide.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">            mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">        op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">            boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">        <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">            op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">            materialH1Positions, frontAdjEdges);</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(piolaStress,</div>
<div class="line">                                                   broken_data_ptr));</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">                piolaStress, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">        pip.push_back(op_loop_domain_side);</div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_contact_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            contactDisp, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">        <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(spatialH1Disp, u_h1_ptr));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">            contactTreeRhs, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">            <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), <span class="keyword">nullptr</span>,</div>
<div class="line">            <span class="keyword">nullptr</span>));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// get body id and SDF range</span></div>
<div class="line">        <span class="keyword">auto</span> contact_sfd_map_range_ptr =</div>
<div class="line">            boost::make_shared&lt;std::map&lt;int, Range&gt;&gt;(</div>
<div class="line">                get_body_range(<span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a name="_a149"></a><a class="code" href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dU</a>(</div>
<div class="line">            contactDisp, contactDisp, contact_common_data_ptr, contactTreeRhs,</div>
<div class="line">            contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a150"></a><a class="code" href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dP.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dP&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                contactDisp, broken_data_ptr, contact_common_data_ptr,</div>
<div class="line">                contactTreeRhs, contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a151"></a><a class="code" href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivLhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryHDivLhs_dU&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                broken_data_ptr, contactDisp, contact_common_data_ptr,</div>
<div class="line">                contactTreeRhs));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push ops to face/side pipeline</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_domain_side(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_contact_lhs(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_hybridisation(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_contact(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (add_material) {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::setFaceElementOps(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> add_elastic, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_material,</div>
<div class="line">    boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; &amp;fe_rhs,</div>
<div class="line">    boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; &amp;fe_lhs) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  fe_rhs = boost::make_shared&lt;FaceElementForcesAndSourcesCore&gt;(mField);</div>
<div class="line">  fe_lhs = boost::make_shared&lt;FaceElementForcesAndSourcesCore&gt;(mField);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set integration rule</span></div>
<div class="line">  fe_rhs-&gt;getRuleHook = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2 * (p + 1); };</div>
<div class="line">  fe_lhs-&gt;getRuleHook = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2 * (p + 1); };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector(), {L2}, materialH1Positions, frontAdjEdges);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector(), {L2}, materialH1Positions, frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_broken_op_side = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="classSideEleOp.html">SideEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">      <span class="comment">// Iterate over domain FEs adjacent to boundary.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          materialH1Positions, frontAdjEdges);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpGetBrokenBaseSideData.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(piolaStress, broken_data_ptr));</div>
<div class="line">      pip.push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keywordflow">return</span> broken_data_ptr;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> broken_data_ptr = get_broken_op_side(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpDispBc(broken_data_ptr, bcSpatialDispVecPtr,</div>
<div class="line">                     {</div>
<div class="line"> </div>
<div class="line">                         boost::make_shared&lt;TimeScale&gt;(<span class="stringliteral">&quot;disp_history.txt&quot;</span>)</div>
<div class="line"> </div>
<div class="line">                     }));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpRotationBc(</div>
<div class="line">        broken_data_ptr, bcSpatialRotationVecPtr,</div>
<div class="line"> </div>
<div class="line">        {</div>
<div class="line"> </div>
<div class="line">            boost::make_shared&lt;TimeScale&gt;(<span class="stringliteral">&quot;rotation_history.txt&quot;</span>)</div>
<div class="line"> </div>
<div class="line">        }));</div>
<div class="line"> </div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpBrokenTractionBc(hybridSpatialDisp, bcSpatialTraction));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::setContactElementRhsOps(</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ContactTree&gt; &amp;fe_contact_tree</div>
<div class="line"> </div>
<div class="line">) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** Contact requires that body is marked */</span></div>
<div class="line">  <span class="keyword">auto</span> get_body_range = [<span class="keyword">this</span>](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr :</div>
<div class="line">         mField.getInterface&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(std::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line">      <a class="code" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_ptr-&gt;getMeshsetIdEntitiesByDimension(mField.get_moab(),</div>
<div class="line">                                                            dim, ents, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;by dim&quot;</span>);</div>
<div class="line">      map[m_ptr-&gt;getMeshsetId()] = ents;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_map_skin = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;mField.get_moab(), <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">    Skinner skin(&amp;mField.get_moab());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map) {</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> skin_faces;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, <span class="keyword">false</span>, skin_faces);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin_faces,</div>
<div class="line">                                           PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                           PSTATUS_NOT, -1, <span class="keyword">nullptr</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;filter&quot;</span>);</div>
<div class="line">      <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.swap(skin_faces);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* The above code is written in C++ and it appears to be defining and using</span></div>
<div class="line"><span class="comment">  various operations on boundary elements and side elements. */</span></div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> = <a name="_a152"></a><a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">  <span class="keyword">using</span> <a name="_a153"></a><a class="code" href="classBoundaryEleOp.html">BoundaryEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> contact_common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calcs_side_traction = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">        <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="classSideEleOp.html">SideEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">        mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">    op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">        boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">    <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">        materialH1Positions, frontAdjEdges);</div>
<div class="line">    op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">            piolaStress, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">    pip.push_back(op_loop_domain_side);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_contact_three = [&amp;]() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> tree_moab_ptr = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">    fe_contact_tree = boost::make_shared&lt;ContactTree&gt;(</div>
<div class="line">        mField, tree_moab_ptr, spaceOrder,</div>
<div class="line">        get_map_skin(get_body_range(<span class="stringliteral">&quot;BODY&quot;</span>, 3)));</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            contactDisp, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calcs_side_traction(fe_contact_tree-&gt;getOpPtrVector());</div>
<div class="line">    <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(spatialH1Disp, u_h1_ptr));</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpMoveNode(fe_contact_tree, contact_common_data_ptr, u_h1_ptr));</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_contact_three();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::setElasticElementOps(<span class="keyword">const</span> <span class="keywordtype">int</span> tag) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add contact operators. Note that only for rhs. THe lhs is assembled with</span></div>
<div class="line">  <span class="comment">// volume element, to enable schur complement evaluation.</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setContactElementRhsOps(contactTreeRhs);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setVolumeElementOps(tag, <span class="keyword">true</span>, <span class="keyword">false</span>, elasticFeRhs, elasticFeLhs);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setFaceElementOps(<span class="keyword">true</span>, <span class="keyword">false</span>, elasticBcRhs, elasticBcLhs);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> adj_cache =</div>
<div class="line">      boost::make_shared&lt;ForcesAndSourcesCore::UserDataOperator::AdjCache&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_op_contact_bc = [&amp;]() {</div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;SideEle&gt;</a>(</div>
<div class="line">        mField, contactElement, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy, adj_cache);</div>
<div class="line">    <span class="keywordflow">return</span> op_loop_side;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::setElasticElementToTs(DM dm) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(alphaRho) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a154"></a><a class="code" href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">DMMoFEMTSSetI2Function</a>(dm, elementVolumeName, elasticFeRhs, <span class="keyword">null</span>,</div>
<div class="line">                                  <span class="keyword">null</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">DMMoFEMTSSetI2Function</a>(dm, naturalBcElement, elasticBcRhs, <span class="keyword">null</span>,</div>
<div class="line">                                  <span class="keyword">null</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a155"></a><a class="code" href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">DMMoFEMTSSetI2Jacobian</a>(dm, elementVolumeName, elasticFeLhs, <span class="keyword">null</span>,</div>
<div class="line">                                  <span class="keyword">null</span>);</div>
<div class="line">    <span class="comment">// CHKERR DMMoFEMTSSetI2Jacobian(dm, naturalBcElement, elasticBcLhs, null,</span></div>
<div class="line">    <span class="comment">//                               null);</span></div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a156"></a><a class="code" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, elementVolumeName, elasticFeRhs, <span class="keyword">null</span>,</div>
<div class="line">                                 <span class="keyword">null</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, naturalBcElement, elasticBcRhs, <span class="keyword">null</span>,</div>
<div class="line">                                 <span class="keyword">null</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a157"></a><a class="code" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm, elementVolumeName, elasticFeLhs, <span class="keyword">null</span>,</div>
<div class="line">                                 <span class="keyword">null</span>);</div>
<div class="line">    <span class="comment">// CHKERR DMMoFEMTSSetIJacobian(dm, naturalBcElement, elasticBcLhs, null,</span></div>
<div class="line">    <span class="comment">//                              null);</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="EshelbianMonitor_8cpp.html">impl/EshelbianMonitor.cpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="SetUpSchurImpl_8cpp.html">impl/SetUpSchurImpl.cpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="TSElasticPostStep_8cpp.html">impl/TSElasticPostStep.cpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::solveElastic(TS ts, <a name="a158"></a><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> x) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;ContactOps::SDFPython&gt; sdf_python_ptr;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> file_exists = [](std::string myfile) {</div>
<div class="line">    std::ifstream file(myfile.c_str());</div>
<div class="line">    <span class="keywordflow">if</span> (file) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">char</span> sdf_file_name[255] = <span class="stringliteral">&quot;sdf.py&quot;</span>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a159"></a><a class="code" href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">PetscOptionsGetString</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-sdf_file&quot;</span>,</div>
<div class="line">                               sdf_file_name, 255, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (file_exists(sdf_file_name)) {</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; sdf_file_name &lt;&lt; <span class="stringliteral">&quot; file found&quot;</span>;</div>
<div class="line">    sdf_python_ptr = boost::make_shared&lt;ContactOps::SDFPython&gt;();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sdf_python_ptr-&gt;sdfInit(sdf_file_name);</div>
<div class="line">    ContactOps::sdfPythonWeakPtr = sdf_python_ptr;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::warning) &lt;&lt; sdf_file_name &lt;&lt; <span class="stringliteral">&quot; file NOT found&quot;</span>;</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;TsCtx&gt; <a name="a160"></a><a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a161"></a><a class="code" href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">DMMoFEMGetTsCtx</a>(dmElastic, <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, <a name="a162"></a><a class="code" href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">TsMonitorSet</a>, <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.get(), PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; monitor_ptr(<span class="keyword">new</span> <a name="_a163"></a><a class="code" href="structEshelbianMonitor.html">EshelbianMonitor</a>(*<span class="keyword">this</span>));</div>
<div class="line">  <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>-&gt;<a name="a164"></a><a class="code" href="structMoFEM_1_1TsCtx.html#a4128e8771499a7dcaf4b224a2d3d2a14">getLoopsMonitor</a>().push_back(</div>
<div class="line">      <a name="_a165"></a><a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">TsCtx::PairNameFEMethodPtr</a>(elementVolumeName, monitor_ptr));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSAppendOptionsPrefix(ts, <span class="stringliteral">&quot;elastic_&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, dmElastic);</div>
<div class="line"> </div>
<div class="line">  SNES snes;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line"> </div>
<div class="line">  PetscViewerAndFormat *vf;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscViewerAndFormatCreate(PETSC_VIEWER_STDOUT_WORLD,</div>
<div class="line">                                    PETSC_VIEWER_DEFAULT, &amp;vf);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(</div>
<div class="line">      snes,</div>
<div class="line">      (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal, <span class="keywordtype">void</span> *))SNESMonitorFields,</div>
<div class="line">      vf, (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(<span class="keywordtype">void</span> **))PetscViewerAndFormatDestroy);</div>
<div class="line"> </div>
<div class="line">  PetscSection section;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMGetSection(dmElastic, &amp;section);</div>
<div class="line">  <span class="keywordtype">int</span> num_fields;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetNumFields(section, &amp;num_fields);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ff = 0; ff != num_fields; ff++) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetFieldName(section, ff, &amp;<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a name="a166"></a><a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform, <span class="stringliteral">&quot;Field %d name %s&quot;</span>, ff, <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a167"></a><a class="code" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dmElastic, x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Adding field split solver</span></div>
<div class="line">  boost::shared_ptr&lt;SetUpSchur&gt; schur_ptr;</div>
<div class="line">  <span class="keywordflow">if</span> constexpr (<a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a> == <a name="a168"></a><a class="code" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf9cac1fd5336e189c8f107a7a33e7a5e">AssemblyType::BLOCK_SCHUR</a>) {</div>
<div class="line">    schur_ptr = <a name="a169"></a><a class="code" href="structSetUpSchur.html#a9c9d1d7c1d1056006209d2b2c6aeddfc">SetUpSchur::createSetUpSchur</a>(mField, &amp;*<span class="keyword">this</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> schur_ptr-&gt;setUp(ts);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(alphaRho) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">    <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> xx;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(x, &amp;xx);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(xx);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TS2SetSolution(ts, x, xx);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;xx);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, x);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;(</div>
<div class="line">      {elasticFeLhs.get(), elasticFeRhs.get()});</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPreStep(ts, <a name="a170"></a><a class="code" href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, <a name="a171"></a><a class="code" href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a172"></a><a class="code" href="structTSElasticPostStep.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a>(<span class="keyword">this</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a173"></a><a class="code" href="structTSElasticPostStep.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a>();</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;(</div>
<div class="line">      {elasticFeLhs.get(), elasticFeRhs.get()});</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// CHKERR TSGetSNES(ts, &amp;snes);</span></div>
<div class="line">  <span class="keywordtype">int</span> lin_solver_iterations;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetLinearSolveIterations(snes, &amp;lin_solver_iterations);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Number of linear solver iterations &quot;</span> &lt;&lt; lin_solver_iterations;</div>
<div class="line"> </div>
<div class="line">  PetscBool test_cook_flg = PETSC_FALSE;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a174"></a><a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-test_cook&quot;</span>, &amp;test_cook_flg,</div>
<div class="line">                             PETSC_NULL);</div>
<div class="line">  <span class="keywordflow">if</span> (test_cook_flg) {</div>
<div class="line">    constexpr <span class="keywordtype">int</span> expected_lin_solver_iterations = 11;</div>
<div class="line">    <span class="keywordflow">if</span> (lin_solver_iterations &gt; expected_lin_solver_iterations)</div>
<div class="line">      SETERRQ2(</div>
<div class="line">          PETSC_COMM_SELF, <a name="a175"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Expected number of iterations is different than expected %d &gt; %d&quot;</span>,</div>
<div class="line">          lin_solver_iterations, expected_lin_solver_iterations);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> gettingNorms();</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::postProcessResults(<span class="keyword">const</span> <span class="keywordtype">int</span> tag,</div>
<div class="line">                                                 <span class="keyword">const</span> std::string file) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!dataAtPts) {</div>
<div class="line">    dataAtPts =</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt;(<span class="keyword">new</span> DataAtIntegrationPts());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_mesh = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">  <span class="keyword">auto</span> post_proc_begin =</div>
<div class="line">      <a name="a176"></a><a class="code" href="namespaceMoFEM.html#ab385a9ad5a2b6c9f11dbb50876a2977d">PostProcBrokenMeshInMoabBaseBegin</a>(mField, post_proc_mesh);</div>
<div class="line">  <span class="keyword">auto</span> post_proc_end = <a name="a177"></a><a class="code" href="namespaceMoFEM.html#a7e0a8d783e98359c54efd414dd50a739">PostProcBrokenMeshInMoabBaseEnd</a>(mField, post_proc_mesh);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> contact_common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_post_proc = [&amp;](<span class="keyword">auto</span> sense) {</div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceEle</a> = <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> post_proc_ptr =</div>
<div class="line">        boost::make_shared&lt;PostProcBrokenMeshInMoabBaseCont&lt;FaceEle&gt;&gt;(</div>
<div class="line">            mField, post_proc_mesh);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        post_proc_ptr-&gt;getOpPtrVector(), {L2}, materialH1Positions,</div>
<div class="line">        frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> domain_ops = [&amp;](<span class="keyword">auto</span> &amp;fe, <span class="keywordtype">int</span> sense) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      fe.getUserPolynomialBase() =</div>
<div class="line">          boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line">      <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          fe.getOpPtrVector(), {HDIV, H1, L2}, materialH1Positions,</div>
<div class="line">          frontAdjEdges);</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">          piolaStress, dataAtPts-&gt;getApproxPAtPts()));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHTensorTensorField.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">          bubbleField, dataAtPts-&gt;getApproxPAtPts(), MBMAXTYPE));</div>
<div class="line">      <span class="keywordflow">if</span> (noStretch) {</div>
<div class="line">        fe.getOpPtrVector().push_back(</div>
<div class="line">            physicalEquations-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">                dataAtPts, physicalEquations));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                stretchTensor, dataAtPts-&gt;getLogStretchTensorAtPts(), MBTET));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          rotAxis, dataAtPts-&gt;getRotAxisAtPts(), MBTET));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          spatialL2Disp, dataAtPts-&gt;getSmallWL2AtPts(), MBTET));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          spatialH1Disp, dataAtPts-&gt;getSmallWH1AtPts()));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">          spatialH1Disp, dataAtPts-&gt;getSmallWGradH1AtPts()));</div>
<div class="line">      <span class="comment">// evaluate derived quantities</span></div>
<div class="line">      fe.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpCalculateRotationAndSpatialGradient(dataAtPts));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// evaluate integration points</span></div>
<div class="line">      fe.getOpPtrVector().push_back(physicalEquations-&gt;returnOpJacobian(</div>
<div class="line">          tag, <span class="keyword">true</span>, <span class="keyword">false</span>, dataAtPts, physicalEquations));</div>
<div class="line">      <span class="keywordflow">if</span> (<span class="keyword">auto</span> op =</div>
<div class="line">              physicalEquations-&gt;returnOpCalculateEnergy(dataAtPts, <span class="keyword">nullptr</span>)) {</div>
<div class="line">        fe.getOpPtrVector().push_back(op);</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a name="_a178"></a><a class="code" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a>(dataAtPts));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// contact</span></div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(</div>
<div class="line">          spatialL2Disp, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// post-proc</span></div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> OpPostProcDataStructure(</div>
<div class="line">          post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line">          dataAtPts, sense));</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(contactDisp,</div>
<div class="line">                                            dataAtPts-&gt;getContactL2AtPts()));</div>
<div class="line">    <span class="keyword">auto</span> X_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// H1 material positions</span></div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(materialH1Positions,</div>
<div class="line">                                            dataAtPts-&gt;getLargeXH1AtPts()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// domain</span></div>
<div class="line">    <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;VolumeElementForcesAndSourcesCoreOnSide&gt;</a>(</div>
<div class="line">        mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">    domain_ops(*(op_loop_side-&gt;getSideFEPtr()), sense);</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(op_loop_side);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> post_proc_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_ptr = get_post_proc(1);</div>
<div class="line">  <span class="keyword">auto</span> post_proc_negative_sense_ptr = get_post_proc(-1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// contact</span></div>
<div class="line">  <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> lambda_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(spatialH1Disp, u_h1_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> = <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="classBoundaryEleOp.html">BoundaryEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calcs_side_traction = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">        <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="classSideEleOp.html">SideEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">EleOnSide::UserDataOperator</a>;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">        mField, elementVolumeName, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">    op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">        boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line">    <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">        materialH1Positions, frontAdjEdges);</div>
<div class="line">    op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">            piolaStress, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">    pip.push_back(op_loop_domain_side);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calcs_side_traction(post_proc_ptr-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">      contactTreeRhs, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">      <a class="code" href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(mField, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1),</div>
<div class="line">      &amp;post_proc_ptr-&gt;getPostProcMesh(), &amp;post_proc_ptr-&gt;getMapGaussPts()));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a179"></a><a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, contactElement, contactTreeRhs);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a180"></a><a class="code" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dM, post_proc_begin.getFEMethod());</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, skinElement, post_proc_ptr);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a181"></a><a class="code" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(dM, crackElement, post_proc_ptr,</div>
<div class="line">                                              0, mField.get_comm_size());</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(dM, crackElement,</div>
<div class="line">                                              post_proc_negative_sense_ptr, 0,</div>
<div class="line">                                              mField.get_comm_size());</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a182"></a><a class="code" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(dM, post_proc_end.getFEMethod());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_end.writeFile(file.c_str());</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::gettingNorms() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_fe =</div>
<div class="line">      boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(mField);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_rule_hook = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) -&gt; <span class="keywordtype">int</span> {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * (p);</div>
<div class="line">  };</div>
<div class="line">  post_proc_norm_fe-&gt;getRuleHook = post_proc_norm_rule_hook;</div>
<div class="line"> </div>
<div class="line">  post_proc_norm_fe-&gt;getUserPolynomialBase() =</div>
<div class="line">      boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      post_proc_norm_fe-&gt;getOpPtrVector(), {L2, H1, HDIV}, materialH1Positions,</div>
<div class="line">      frontAdjEdges);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> NORMS { U_NORM_L2 = 0, U_NORM_H1, PIOLA_NORM, U_ERROR_L2, LAST_NORM };</div>
<div class="line">  <span class="keyword">auto</span> norms_vec =</div>
<div class="line">      <a name="a183"></a><a class="code" href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">createVectorMPI</a>(mField.get_comm(), LAST_NORM, PETSC_DETERMINE);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(norms_vec);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> u_l2_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(spatialL2Disp, u_l2_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(spatialH1Disp, u_h1_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a name="_a184"></a><a class="code" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_l2_ptr, norms_vec, U_NORM_L2));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_h1_ptr, norms_vec, U_NORM_H1));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_l2_ptr, norms_vec, U_ERROR_L2,</div>
<div class="line">                                         u_h1_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> piola_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(piolaStress, piola_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a name="_a185"></a><a class="code" href="structMoFEM_1_1OpCalcNormL2Tensor2.html">OpCalcNormL2Tensor2&lt;3, 3&gt;</a>(piola_ptr, norms_vec, PIOLA_NORM));</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;({post_proc_norm_fe.get()});</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.loop_finite_elements(<span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, elementVolumeName,</div>
<div class="line">                                     *post_proc_norm_fe);</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;({post_proc_norm_fe.get()});</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(norms_vec);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(norms_vec);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> *norms;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(norms_vec, &amp;norms);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;norm_u: &quot;</span> &lt;&lt; std::sqrt(norms[U_NORM_L2]);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;norm_u_h1: &quot;</span> &lt;&lt; std::sqrt(norms[U_NORM_H1]);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;norm_error_u_l2: &quot;</span> &lt;&lt; std::sqrt(norms[U_ERROR_L2]);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;norm_piola: &quot;</span> &lt;&lt; std::sqrt(norms[PIOLA_NORM]);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(norms_vec, &amp;norms);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::getSpatialDispBc() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = mField.getInterface&lt;<a class="code" href="structMoFEM_1_1BcManager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;pushMarkDOFsOnEntities&lt;<a name="_a186"></a><a class="code" href="structMoFEM_1_1DisplacementCubitBcData.html">DisplacementCubitBcData</a>&gt;(</div>
<div class="line">      <span class="stringliteral">&quot;&quot;</span>, piolaStress, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  bcSpatialDispVecPtr = boost::make_shared&lt;BcDispVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> disp_bc = bc.second-&gt;dispBcPtr) {</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy) &lt;&lt; *disp_bc;</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;double&gt; block_attributes(6, 0.);</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag1 == 1) {</div>
<div class="line">        block_attributes[0] = disp_bc-&gt;data.value1;</div>
<div class="line">        block_attributes[3] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag2 == 1) {</div>
<div class="line">        block_attributes[1] = disp_bc-&gt;data.value2;</div>
<div class="line">        block_attributes[4] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag3 == 1) {</div>
<div class="line">        block_attributes[2] = disp_bc-&gt;data.value3;</div>
<div class="line">        block_attributes[5] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> faces = bc.second-&gt;bcEnts.subset_by_dimension(2);</div>
<div class="line">      bcSpatialDispVecPtr-&gt;emplace_back(bc.first, block_attributes, faces);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// old way of naming blocksets for displacement BCs</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getBc(bcSpatialDispVecPtr, <span class="stringliteral">&quot;SPATIAL_DISP_BC&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> EshelbianCore::getSpatialTractionBc() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = mField.getInterface&lt;<a class="code" href="structMoFEM_1_1BcManager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;pushMarkDOFsOnEntities&lt;<a name="_a187"></a><a class="code" href="structMoFEM_1_1ForceCubitBcData.html">ForceCubitBcData</a>&gt;(<span class="stringliteral">&quot;&quot;</span>, piolaStress,</div>
<div class="line">                                                          <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  bcSpatialTraction = boost::make_shared&lt;TractionBcVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> force_bc = bc.second-&gt;forceBcPtr) {</div>
<div class="line">      std::vector&lt;double&gt; block_attributes(6, 0.);</div>
<div class="line">      block_attributes[0] = -force_bc-&gt;data.value3 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[3] = 1;</div>
<div class="line">      block_attributes[1] = -force_bc-&gt;data.value4 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[4] = 1;</div>
<div class="line">      block_attributes[2] = -force_bc-&gt;data.value5 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[5] = 1;</div>
<div class="line">      <span class="keyword">auto</span> faces = bc.second-&gt;bcEnts.subset_by_dimension(2);</div>
<div class="line">      bcSpatialTraction-&gt;emplace_back(bc.first, block_attributes, faces);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getBc(bcSpatialTraction, <span class="stringliteral">&quot;SPATIAL_TRACTION_BC&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace EshelbianPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="EshelbianContact_8cpp.html">impl/EshelbianContact.cpp</a>&gt;</span></div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a793899f524a281eb88e3ff2b01ce6acb"><div class="ttname"><a href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a></div><div class="ttdeci">#define CHK_MOAB_THROW(err, msg)</div><div class="ttdoc">Check error code of MoAB function and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00589">definitions.h:589</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html_adb15bcb9c22237b0b508ca37bb48d721"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html#adb15bcb9c22237b0b508ca37bb48d721">MoFEM::VolumeElementForcesAndSourcesCore::VolumeElementForcesAndSourcesCore</a></div><div class="ttdeci">VolumeElementForcesAndSourcesCore(Interface &amp;m_field, const EntityType type=MBTET)</div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8cpp_source.html#l00009">VolumeElementForcesAndSourcesCore.cpp:9</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_abd1f0351e167546d82adc28b4dd0e681"><div class="ttname"><a href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryEle BoundaryEle</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00039">child_and_parent.cpp:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_a9a8b1d5aaedc0a0225c4c83bed2d60f6a484ae87b0f6b7d2bb1f21e8ea6e1020e"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6a484ae87b0f6b7d2bb1f21e8ea6e1020e">EshelbianPlasticity::LINEAR</a></div><div class="ttdeci">@ LINEAR</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00044">EshelbianPlasticity.hpp:44</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="aTSElasticPostStep_8cpp_html"><div class="ttname"><a href="TSElasticPostStep_8cpp.html">TSElasticPostStep.cpp</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntPolynomialBaseCtx_html"><div class="ttname"><a href="structMoFEM_1_1EntPolynomialBaseCtx.html">MoFEM::EntPolynomialBaseCtx</a></div><div class="ttdoc">Class used to pass element data to calculate base functions on tet,triangle,edge.</div><div class="ttdef"><b>Definition:</b> <a href="EntPolynomialBaseCtx_8hpp_source.html#l00022">EntPolynomialBaseCtx.hpp:22</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpFluxRhsImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpFluxRhsImpl.html">MoFEM::OpFluxRhsImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00039">Natural.hpp:39</a></div></div>
<div class="ttc" id="ascalar__check__approximation_8cpp_html_a9e6f88bbff7880d45f1d2c50fbf8ee76"><div class="ttname"><a href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a></div><div class="ttdeci">PipelineManager::ElementsAndOpsByDim&lt; SPACE_DIM &gt;::FaceSideEle EleOnSide</div><div class="ttdef"><b>Definition:</b> <a href="scalar__check__approximation_8cpp_source.html#l00027">scalar_check_approximation.cpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BaseFunction_html_a401db54065b0887d68f81f7f806a08d4"><div class="ttname"><a href="structMoFEM_1_1BaseFunction.html#a401db54065b0887d68f81f7f806a08d4">MoFEM::BaseFunction::DofsSideMap</a></div><div class="ttdeci">multi_index_container&lt; DofsSideMapData, indexed_by&lt; ordered_non_unique&lt; tag&lt; TypeSide_mi_tag &gt;, composite_key&lt; DofsSideMapData, member&lt; DofsSideMapData, EntityType, &amp;DofsSideMapData::type &gt;, member&lt; DofsSideMapData, int, &amp;DofsSideMapData::side &gt; &gt;&gt;, ordered_unique&lt; tag&lt; EntDofIdx_mi_tag &gt;, member&lt; DofsSideMapData, int, &amp;DofsSideMapData::dof &gt; &gt; &gt; &gt; DofsSideMap</div><div class="ttdoc">Map entity stype and side to element/entity dof index.</div><div class="ttdef"><b>Definition:</b> <a href="BaseFunction_8hpp_source.html#l00073">BaseFunction.hpp:73</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim_html"><div class="ttname"><a href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">MoFEM::PipelineManager::ElementsAndOpsByDim</a></div><div class="ttdef"><b>Definition:</b> <a href="PipelineManager_8hpp_source.html#l00038">PipelineManager.hpp:38</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateTensor2SymmetricFieldValuesDot_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValuesDot.html">MoFEM::OpCalculateTensor2SymmetricFieldValuesDot</a></div><div class="ttdoc">Calculate symmetric tensor field rates ant integratio pts.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01071">UserDataOperators.hpp:1071</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adecbcd03d7be8763b60a827f434fe726"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a></div><div class="ttdeci">@ NOBASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00059">definitions.h:59</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00609">definitions.h:609</a></div></div>
<div class="ttc" id="agroup__dm_html_ga27babc6dfb0df28667682a98b5822739"><div class="ttname"><a href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">MoFEM::DMMoFEMSetSquareProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetSquareProblem(DM dm, PetscBool square_problem)</div><div class="ttdoc">set squared problem</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00456">DMMoFEM.cpp:456</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a4128e8771499a7dcaf4b224a2d3d2a14"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a4128e8771499a7dcaf4b224a2d3d2a14">MoFEM::TsCtx::getLoopsMonitor</a></div><div class="ttdeci">FEMethodsSequence &amp; getLoopsMonitor()</div><div class="ttdoc">Get the loops to do Monitor object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00098">TsCtx.hpp:98</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_ac1f95bc05eb3ef54d799134f8202a753"><div class="ttname"><a href="structTSElasticPostStep.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a></div><div class="ttdeci">static MoFEMErrorCode postStepFun(TS ts)</div><div class="ttdef"><b>Definition:</b> <a href="TSElasticPostStep_8cpp_source.html#l00145">TSElasticPostStep.cpp:145</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHTensorTensorField_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHTensorTensorField.html">MoFEM::OpCalculateHTensorTensorField</a></div><div class="ttdoc">Calculate tenor field using tensor base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l02631">UserDataOperators.hpp:2631</a></div></div>
<div class="ttc" id="astructMoFEM_1_1NaturalBC_html"><div class="ttname"><a href="structMoFEM_1_1NaturalBC.html">MoFEM::NaturalBC</a></div><div class="ttdoc">Natural boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00057">Natural.hpp:57</a></div></div>
<div class="ttc" id="apoisson__2d__dis__galerkin_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">static double phi</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__dis__galerkin_8cpp_source.html#l00030">poisson_2d_dis_galerkin.cpp:30</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldValues.html">MoFEM::OpCalculateVectorFieldValues</a></div><div class="ttdoc">Get values at integration pts for tensor filed rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00466">UserDataOperators.hpp:466</a></div></div>
<div class="ttc" id="astructFaceRule_html_aa4dbe8a983fafee94833d9f28e4eb5bf"><div class="ttname"><a href="structFaceRule.html#aa4dbe8a983fafee94833d9f28e4eb5bf">FaceRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00092">simple_interface.cpp:92</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_gaead3887ddc924ad6d2a0993bfb4a9b27"><div class="ttname"><a href="group__mofem__access.html#gaead3887ddc924ad6d2a0993bfb4a9b27">_IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_(MFIELD, NAME, ENT, IT)</div><div class="ttdoc">loop over all dofs from a moFEM field and particular field</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l01917">Interface.hpp:1917</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1AddHOOps_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1AddHOOps.html">EshelbianPlasticity::AddHOOps</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l01150">EshelbianPlasticity.hpp:1150</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_ac901935d74fe21ad8415e34fd9ea2150"><div class="ttname"><a href="namespaceHenckyOps.html#ac901935d74fe21ad8415e34fd9ea2150">HenckyOps::d_f</a></div><div class="ttdeci">auto d_f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00016">HenckyOps.hpp:16</a></div></div>
<div class="ttc" id="aEshelbianMonitor_8cpp_html"><div class="ttname"><a href="EshelbianMonitor_8cpp.html">EshelbianMonitor.cpp</a></div><div class="ttdoc">Contains definition of EshelbianMonitor class.</div></div>
<div class="ttc" id="astructQUAD___html_a4ceb3af6a1dd055a067f6c3c1f6d4c86"><div class="ttname"><a href="structQUAD__.html#a4ceb3af6a1dd055a067f6c3c1f6d4c86">QUAD_::order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00028">quad.h:28</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html"><div class="ttname"><a href="namespaceEshelbianPlasticity.html">EshelbianPlasticity</a></div><div class="ttdef"><b>Definition:</b> <a href="CGGTonsorialBubbleBase_8hpp_source.html#l00011">CGGTonsorialBubbleBase.hpp:11</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="astructVolRule_html"><div class="ttname"><a href="structVolRule.html">VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00088">simple_interface.cpp:88</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForceCubitBcData_html"><div class="ttname"><a href="structMoFEM_1_1ForceCubitBcData.html">MoFEM::ForceCubitBcData</a></div><div class="ttdoc">Definition of the force bc data structure.</div><div class="ttdef"><b>Definition:</b> <a href="BCData_8hpp_source.html#l00139">BCData.hpp:139</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DisplacementCubitBcData_html"><div class="ttname"><a href="structMoFEM_1_1DisplacementCubitBcData.html">MoFEM::DisplacementCubitBcData</a></div><div class="ttdoc">Definition of the displacement bc data structure.</div><div class="ttdef"><b>Definition:</b> <a href="BCData_8hpp_source.html#l00076">BCData.hpp:76</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Projection10NodeCoordsOnField_html"><div class="ttname"><a href="structMoFEM_1_1Projection10NodeCoordsOnField.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetFlux_html"><div class="ttname"><a href="structMoFEM_1_1OpSetFlux.html">MoFEM::OpSetFlux</a></div><div class="ttdef"><b>Definition:</b> <a href="FormsBrokenSpaceConstraintImpl_8hpp_source.html#l00139">FormsBrokenSpaceConstraintImpl.hpp:139</a></div></div>
<div class="ttc" id="ah1__hdiv__hcurl__l2_8h_html_afff51d616c826e4714c19b69816fa74f"><div class="ttname"><a href="h1__hdiv__hcurl__l2_8h.html#afff51d616c826e4714c19b69816fa74f">NBVOLUMETET_L2</a></div><div class="ttdeci">#define NBVOLUMETET_L2(P)</div><div class="ttdoc">Number of base functions on tetrahedron for L2 space.</div><div class="ttdef"><b>Definition:</b> <a href="h1__hdiv__hcurl__l2_8h_source.html#l00027">h1_hdiv_hcurl_l2.h:27</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_aad51dbcb3d4d470a0d589df584a43e17a00aa5b7eae56319e7066b5eaf4ec2701"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17a00aa5b7eae56319e7066b5eaf4ec2701">EshelbianPlasticity::NO_H1_CONFIGURATION</a></div><div class="ttdeci">@ NO_H1_CONFIGURATION</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00043">EshelbianPlasticity.hpp:43</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition:</b> <a href="level__set_8cpp_source.html#l01932">level_set.cpp:1932</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Field_html"><div class="ttname"><a href="structMoFEM_1_1Field.html">MoFEM::Field</a></div><div class="ttdoc">Provide data structure for (tensor) field approximation.</div><div class="ttdef"><b>Definition:</b> <a href="FieldMultiIndices_8hpp_source.html#l00051">FieldMultiIndices.hpp:51</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a></div><div class="ttdeci">@ USER_BASE</div><div class="ttdoc">user implemented approximation base</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00068">definitions.h:68</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1654dd29ff9af437332ec55af104ff48"><div class="ttname"><a href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">MoFEM::TsMonitorSet</a></div><div class="ttdeci">PetscErrorCode TsMonitorSet(TS ts, PetscInt step, PetscReal t, Vec u, void *ctx)</div><div class="ttdoc">Set monitor for TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8cpp_source.html#l00259">TsCtx.cpp:259</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldValuesFromPetscVecImpl.html">MoFEM::OpCalculateVectorFieldValuesFromPetscVecImpl</a></div><div class="ttdoc">Approximate field values for given petsc vector.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00595">UserDataOperators.hpp:595</a></div></div>
<div class="ttc" id="aclassSideEleOp_html"><div class="ttname"><a href="classSideEleOp.html">SideEleOp</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2ae9847dc65a4ed504f68633851f8ddf"><div class="ttname"><a href="namespaceMoFEM.html#a2ae9847dc65a4ed504f68633851f8ddf">MoFEM::DMMoFEMSetDestroyProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetDestroyProblem(DM dm, PetscBool destroy_problem)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00438">DMMoFEM.cpp:438</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalcNormL2Tensor2_html"><div class="ttname"><a href="structMoFEM_1_1OpCalcNormL2Tensor2.html">MoFEM::OpCalcNormL2Tensor2</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor2.</div><div class="ttdef"><b>Definition:</b> <a href="NormsOperators_8hpp_source.html#l00072">NormsOperators.hpp:72</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpBaseImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpBaseImpl.html">MoFEM::OpBaseImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00178">FormsIntegrators.hpp:178</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpGetBrokenBaseSideData_html"><div class="ttname"><a href="structMoFEM_1_1OpGetBrokenBaseSideData.html">MoFEM::OpGetBrokenBaseSideData</a></div><div class="ttdef"><b>Definition:</b> <a href="FormsBrokenSpaceConstraintImpl_8hpp_source.html#l00068">FormsBrokenSpaceConstraintImpl.hpp:68</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpBrokenLoopSide_html"><div class="ttname"><a href="structMoFEM_1_1OpBrokenLoopSide.html">MoFEM::OpBrokenLoopSide</a></div><div class="ttdef"><b>Definition:</b> <a href="FormsBrokenSpaceConstraintImpl_8hpp_source.html#l00015">FormsBrokenSpaceConstraintImpl.hpp:15</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="agroup__dm_html_gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3"><div class="ttname"><a href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">MoFEM::DMMoFEMTSSetIJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIJacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00853">DMMoFEM.cpp:853</a></div></div>
<div class="ttc" id="agroup__dm_html_gaef66c04ab918f0e5e965838b12726405"><div class="ttname"><a href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">MoFEM::DMoFEMLoopFiniteElementsUpAndLowRank</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElementsUpAndLowRank(DM dm, const char fe_name[], MoFEM::FEMethod *method, int low_rank, int up_rank, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00567">DMMoFEM.cpp:567</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_a970435b55ed522325c979afce73ff046"><div class="ttname"><a href="structTSElasticPostStep.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a></div><div class="ttdeci">static MoFEMErrorCode preStepFun(TS ts)</div><div class="ttdef"><b>Definition:</b> <a href="TSElasticPostStep_8cpp_source.html#l00095">TSElasticPostStep.cpp:95</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ISManager_html"><div class="ttname"><a href="structMoFEM_1_1ISManager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition:</b> <a href="ISManager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae6b64312d73966f4cc41953bc77a4ba3"><div class="ttname"><a href="namespaceMoFEM.html#ae6b64312d73966f4cc41953bc77a4ba3">MoFEM::createDM</a></div><div class="ttdeci">auto createDM(MPI_Comm comm, const std::string dm_type_name)</div><div class="ttdoc">Creates smart DM object.</div><div class="ttdef"><b>Definition:</b> <a href="PetscSmartObj_8hpp_source.html#l00141">PetscSmartObj.hpp:141</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_abb0c39cc24166b24cfdd194b6b48e794"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#abb0c39cc24166b24cfdd194b6b48e794">save_range</a></div><div class="ttdeci">static auto save_range(moab::Interface &amp;moab, const std::string name, const Range r)</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8cpp_source.html#l00074">EshelbianPlasticity.cpp:74</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BcManager_html"><div class="ttname"><a href="structMoFEM_1_1BcManager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="BcManager_8hpp_source.html#l00025">BcManager.hpp:25</a></div></div>
<div class="ttc" id="aclassBoundaryEleOp_html"><div class="ttname"><a href="classBoundaryEleOp.html">BoundaryEleOp</a></div></div>
<div class="ttc" id="agroup__dm_html_gacb6892c50af6ca032cc69aeead61cd1e"><div class="ttname"><a href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">MoFEM::DMMoFEMTSSetI2Jacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetI2Jacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01017">DMMoFEM.cpp:1017</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00549">ForcesAndSourcesCore.hpp:549</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00094">FaceElementForcesAndSourcesCore.hpp:94</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html">MoFEM::MeshRefinement</a></div><div class="ttdoc">Mesh refinement interface.</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8hpp_source.html#l00026">MeshRefinement.hpp:26</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="agroup__dm_html_gacdda38385eb99fd6fa1257f4cd143053"><div class="ttname"><a href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">MoFEM::DMMoFEMTSSetI2Function</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetI2Function(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00975">DMMoFEM.cpp:975</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp.html">MoFEM::CoreTmp</a></div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00036">Core.hpp:36</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad17eefd5d88d2b51c71ec46cae8569ac"><div class="ttname"><a href="namespaceMoFEM.html#ad17eefd5d88d2b51c71ec46cae8569ac">MoFEM::get_temp_meshset_ptr</a></div><div class="ttdeci">auto get_temp_meshset_ptr(moab::Interface &amp;moab)</div><div class="ttdoc">Create smart pointer to temporary meshset.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01886">Templates.hpp:1886</a></div></div>
<div class="ttc" id="agroup__dm_html_ga175a29f4cdd0e7b7ae6cc2a0d7ed1704"><div class="ttname"><a href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">MoFEM::DMMoFEMCreateSubDM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateSubDM(DM subdm, DM dm, const char problem_name[])</div><div class="ttdoc">Must be called by user to set Sub DM MoFEM data structures.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00215">DMMoFEM.cpp:215</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition:</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FormsIntegrators_1_1Assembly_html"><div class="ttname"><a href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">MoFEM::FormsIntegrators::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00317">FormsIntegrators.hpp:317</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_a7ac449018ddab38aab05756b44d298aa"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#a7ac449018ddab38aab05756b44d298aa">MoFEM::ForcesAndSourcesCore::dataOnElement</a></div><div class="ttdeci">const std::array&lt; boost::shared_ptr&lt; EntitiesFieldData &gt;, LASTSPACE &gt; dataOnElement</div><div class="ttdoc">Entity data on element entity rows fields.</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00461">ForcesAndSourcesCore.hpp:461</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PairNameFEMethodPtr_html"><div class="ttname"><a href="structMoFEM_1_1PairNameFEMethodPtr.html">MoFEM::PairNameFEMethodPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxPETSc_8hpp_source.html#l00012">AuxPETSc.hpp:12</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryHDivLhs__dU_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivLhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryHDivLhs_dU</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianContact_8hpp_source.html#l00198">EshelbianContact.hpp:198</a></div></div>
<div class="ttc" id="astructOpCalculateEshelbyStress_html"><div class="ttname"><a href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00177">HookeElement.hpp:177</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a></div><div class="ttdeci">@ COL</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryHDivRhs_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryHDivRhs.html">EshelbianPlasticity::OpConstrainBoundaryHDivRhs</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianContact_8hpp_source.html#l00134">EshelbianContact.hpp:134</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1VolUserDataOperatorStabAssembly_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1VolUserDataOperatorStabAssembly.html">EshelbianPlasticity::VolUserDataOperatorStabAssembly</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8cpp_source.html#l00041">EshelbianPlasticity.cpp:41</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ae9faec98b784e677f51cf7ede5a592b4"><div class="ttname"><a href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::SideEle SideEle</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00061">plastic.cpp:61</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorField_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorField.html">MoFEM::OpCalculateHVecTensorField</a></div><div class="ttdoc">Calculate tenor field using vectorial base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l02572">UserDataOperators.hpp:2572</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_a9a8b1d5aaedc0a0225c4c83bed2d60f6"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6">EshelbianPlasticity::StretchSelector</a></div><div class="ttdeci">StretchSelector</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00044">EshelbianPlasticity.hpp:44</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced"><div class="ttname"><a href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">MoFEM::GAUSS</a></div><div class="ttdeci">@ GAUSS</div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00136">FormsIntegrators.hpp:136</a></div></div>
<div class="ttc" id="astructQUAD___html_ad40798bbebc1ea30e30dfcde923eccaa"><div class="ttname"><a href="structQUAD__.html#ad40798bbebc1ea30e30dfcde923eccaa">QUAD_::npoints</a></div><div class="ttdeci">int npoints</div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00029">quad.h:29</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dU_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dU.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dU</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianContact_8hpp_source.html#l00155">EshelbianContact.hpp:155</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8hpp_html"><div class="ttname"><a href="EshelbianPlasticity_8hpp.html">EshelbianPlasticity.hpp</a></div><div class="ttdoc">Eshelbian plasticity interface.</div></div>
<div class="ttc" id="anamespaceMoFEM_html_a7e0a8d783e98359c54efd414dd50a739"><div class="ttname"><a href="namespaceMoFEM.html#a7e0a8d783e98359c54efd414dd50a739">MoFEM::PostProcBrokenMeshInMoabBaseEnd</a></div><div class="ttdeci">PostProcBrokenMeshInMoabBaseEndImpl&lt; PostProcBrokenMeshInMoabBase&lt; ForcesAndSourcesCore &gt; &gt; PostProcBrokenMeshInMoabBaseEnd</div><div class="ttdoc">Enable to run stack of post-processing elements. Use this to end stack.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00952">PostProcBrokenMeshInMoabBase.hpp:952</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00546">DMMoFEM.cpp:546</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalcNormL2Tensor1_html"><div class="ttname"><a href="structMoFEM_1_1OpCalcNormL2Tensor1.html">MoFEM::OpCalcNormL2Tensor1</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor1.</div><div class="ttdef"><b>Definition:</b> <a href="NormsOperators_8hpp_source.html#l00044">NormsOperators.hpp:44</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_aafb2135de373a6659912b2fdcb2a07b5"><div class="ttname"><a href="namespaceHenckyOps.html#aafb2135de373a6659912b2fdcb2a07b5">HenckyOps::dd_f</a></div><div class="ttdeci">auto dd_f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00017">HenckyOps.hpp:17</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_a68543d06189d85f76d53dfc14a39ecf5"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#a68543d06189d85f76d53dfc14a39ecf5">EshelbianPlasticity::CGG_BubbleBase_MBTET</a></div><div class="ttdeci">MoFEMErrorCode CGG_BubbleBase_MBTET(const int p, const double *N, const double *diffN, FTensor::Tensor2&lt; FTensor::PackPtr&lt; double *, 9 &gt;, 3, 3 &gt; &amp;phi, const int gdim)</div><div class="ttdoc">Calculate CGGT tonsorial bubble base.</div><div class="ttdef"><b>Definition:</b> <a href="CGGTonsorialBubbleBase_8cpp_source.html#l00020">CGGTonsorialBubbleBase.cpp:20</a></div></div>
<div class="ttc" id="astructFaceRule_html"><div class="ttname"><a href="structFaceRule.html">FaceRule</a></div><div class="ttdoc">Set integration rule to boundary elements.</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00091">simple_interface.cpp:91</a></div></div>
<div class="ttc" id="agroup__mofem__base__functions_html_ga176a495a81c85ce580624a284726521e"><div class="ttname"><a href="group__mofem__base__functions.html#ga176a495a81c85ce580624a284726521e">Legendre_polynomials</a></div><div class="ttdeci">PetscErrorCode Legendre_polynomials(int p, double s, double *diff_s, double *L, double *diffL, const int dim)</div><div class="ttdoc">Calculate Legendre approximation basis.</div><div class="ttdef"><b>Definition:</b> <a href="base__functions_8c_source.html#l00015">base_functions.c:15</a></div></div>
<div class="ttc" id="astructVolRule_html_a6d7b2f53d4d1a0251ea349cfc7f1f637"><div class="ttname"><a href="structVolRule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">VolRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00089">simple_interface.cpp:89</a></div></div>
<div class="ttc" id="agroup__dm_html_ga3fcdbd5c74eba11ee82492e57d730756"><div class="ttname"><a href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">MoFEM::DMoFEMPostProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPostProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00556">DMMoFEM.cpp:556</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BaseFunctionUnknownInterface_html"><div class="ttname"><a href="structMoFEM_1_1BaseFunctionUnknownInterface.html">MoFEM::BaseFunctionUnknownInterface</a></div><div class="ttdef"><b>Definition:</b> <a href="BaseFunction_8hpp_source.html#l00013">BaseFunction.hpp:13</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">MoFEM::VolumeElementForcesAndSourcesCore</a></div><div class="ttdoc">Volume finite element base.</div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00026">VolumeElementForcesAndSourcesCore.hpp:26</a></div></div>
<div class="ttc" id="aclassBiLinearForm_html"><div class="ttname"><a href="classBiLinearForm.html">BiLinearForm</a></div></div>
<div class="ttc" id="aquad_8h_html_aeda07179568bdfe515fdb7368b7adec4"><div class="ttname"><a href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a></div><div class="ttdeci">static QUAD *const QUAD_3D_TABLE[]</div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00187">quad.h:187</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00108">VolumeElementForcesAndSourcesCore.hpp:108</a></div></div>
<div class="ttc" id="anamespaceFractureMechanics_html_abec8f3bf3291e58b0cd5d7fe3943dc43"><div class="ttname"><a href="namespaceFractureMechanics.html#abec8f3bf3291e58b0cd5d7fe3943dc43">FractureMechanics::mapRefCoords</a></div><div class="ttdeci">static std::map&lt; long int, MatrixDouble &gt; mapRefCoords</div><div class="ttdef"><b>Definition:</b> <a href="CrackFrontElement_8cpp_source.html#l00053">CrackFrontElement.cpp:53</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorTrace_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorTrace.html">MoFEM::OpCalculateHVecTensorTrace</a></div><div class="ttdoc">Calculate trace of vector (Hdiv/Hcurl) space.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l02760">UserDataOperators.hpp:2760</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_a4c808fe810288d58f8699aff7f947852"><div class="ttname"><a href="structTSElasticPostStep.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a></div><div class="ttdeci">static MoFEMErrorCode postStepDestroy()</div><div class="ttdef"><b>Definition:</b> <a href="TSElasticPostStep_8cpp_source.html#l00085">TSElasticPostStep.cpp:85</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">MoFEM::OpCalculateVectorFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01535">UserDataOperators.hpp:1535</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html">MoFEM::UnknownInterface</a></div><div class="ttdoc">base class for all interface classes</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00034">UnknownInterface.hpp:34</a></div></div>
<div class="ttc" id="acholesky_8hpp_html"><div class="ttname"><a href="cholesky_8hpp.html">cholesky.hpp</a></div><div class="ttdoc">cholesky decomposition</div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html">MoFEM::ForcesAndSourcesCore</a></div><div class="ttdoc">structure to get information form mofem into EntitiesFieldData</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00022">ForcesAndSourcesCore.hpp:22</a></div></div>
<div class="ttc" id="aquad_8h_html_a1595ef6e1d0b6c71455660b4d9219cb6"><div class="ttname"><a href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a></div><div class="ttdeci">#define QUAD_3D_TABLE_SIZE</div><div class="ttdef"><b>Definition:</b> <a href="quad_8h_source.html#l00186">quad.h:186</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorDivergence_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorDivergence.html">MoFEM::OpCalculateHVecTensorDivergence</a></div><div class="ttdoc">Calculate divergence of tonsorial field using vectorial base.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l02692">UserDataOperators.hpp:2692</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Tools_html_aacd3c99382effbce7aedfc5ae9862770"><div class="ttname"><a href="structMoFEM_1_1Tools.html#aacd3c99382effbce7aedfc5ae9862770">MoFEM::Tools::tetVolume</a></div><div class="ttdeci">static double tetVolume(const double *coords)</div><div class="ttdoc">Calculate volume of tetrahedron.</div><div class="ttdef"><b>Definition:</b> <a href="Tools_8cpp_source.html#l00030">Tools.cpp:30</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_aad51dbcb3d4d470a0d589df584a43e17abda7fcbd4e5150d5a9cce58e690ea085"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17abda7fcbd4e5150d5a9cce58e690ea085">EshelbianPlasticity::SMALL_ROT</a></div><div class="ttdeci">@ SMALL_ROT</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00043">EshelbianPlasticity.hpp:43</a></div></div>
<div class="ttc" id="anamespaceFTensor_html_a47f888f031614523ed436d61044e757c"><div class="ttname"><a href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">FTensor::dd</a></div><div class="ttdeci">const Tensor2_symmetric_Expr&lt; const ddTensor0&lt; T, Dim, i, j &gt;, typename promote&lt; T, double &gt;::V, Dim, i, j &gt; dd(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index1, const Index&lt; j, Dim &gt; index2, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition:</b> <a href="ddTensor0_8hpp_source.html#l00033">ddTensor0.hpp:33</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="aCGGTonsorialBubbleBase_8hpp_html"><div class="ttname"><a href="CGGTonsorialBubbleBase_8hpp.html">CGGTonsorialBubbleBase.hpp</a></div><div class="ttdoc">Implementation of tonsorial bubble base div(v) = 0.</div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a></div><div class="ttdeci">@ DEMKOWICZ_JACOBI_BASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00066">definitions.h:66</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CommInterface_html"><div class="ttname"><a href="structMoFEM_1_1CommInterface.html">MoFEM::CommInterface</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="CommInterface_8hpp_source.html#l00021">CommInterface.hpp:21</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryL2Rhs_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Rhs.html">EshelbianPlasticity::OpConstrainBoundaryL2Rhs</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianContact_8hpp_source.html#l00118">EshelbianContact.hpp:118</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_aad51dbcb3d4d470a0d589df584a43e17adda9bc262a10a477bb1630e6a802bda0"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17adda9bc262a10a477bb1630e6a802bda0">EshelbianPlasticity::LARGE_ROT</a></div><div class="ttdeci">@ LARGE_ROT</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00043">EshelbianPlasticity.hpp:43</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_a9a8b1d5aaedc0a0225c4c83bed2d60f6ad09302bad0104c5849bb764b8d6c23b7"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6ad09302bad0104c5849bb764b8d6c23b7">EshelbianPlasticity::LOG</a></div><div class="ttdeci">@ LOG</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00044">EshelbianPlasticity.hpp:44</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="aCGGTonsorialBubbleBase_8hpp_html_af88c539f45e4ad3e7407169d8539d25e"><div class="ttname"><a href="CGGTonsorialBubbleBase_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a></div><div class="ttdeci">#define NBVOLUMETET_CCG_BUBBLE(P)</div><div class="ttdoc">Bubble function for CGG H div space.</div><div class="ttdef"><b>Definition:</b> <a href="CGGTonsorialBubbleBase_8hpp_source.html#l00019">CGGTonsorialBubbleBase.hpp:19</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="acheck__base__functions__derivatives__on__tet_8cpp_html_a3d8c24629d725b9ef8c238cf27c9b158"><div class="ttname"><a href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a></div><div class="ttdeci">static const double eps</div><div class="ttdef"><b>Definition:</b> <a href="check__base__functions__derivatives__on__tet_8cpp_source.html#l00011">check_base_functions_derivatives_on_tet.cpp:11</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_aad51dbcb3d4d470a0d589df584a43e17"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17">EshelbianPlasticity::RotSelector</a></div><div class="ttdeci">RotSelector</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00043">EshelbianPlasticity.hpp:43</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4"><div class="ttname"><a href="definitions_8h.html#a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4">DISCONTINUOUS</a></div><div class="ttdeci">@ DISCONTINUOUS</div><div class="ttdoc">Broken continuity (No effect on L2 space)</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00101">definitions.h:101</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a19deff62572d607bc77ed2f82fa639cc"><div class="ttname"><a href="fem__tools_8h.html#a19deff62572d607bc77ed2f82fa639cc">ShapeDiffMBTET</a></div><div class="ttdeci">PetscErrorCode ShapeDiffMBTET(double *diffN)</div><div class="ttdoc">calculate derivatives of shape functions</div><div class="ttdef"><b>Definition:</b> <a href="fem__tools_8c_source.html#l00319">fem_tools.c:319</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="aEshelbianContact_8cpp_html"><div class="ttname"><a href="EshelbianContact_8cpp.html">EshelbianContact.cpp</a></div></div>
<div class="ttc" id="agroup__dm_html_ga286b3dbf0959ea028035e1d808a9403a"><div class="ttname"><a href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">MoFEM::DMMoFEMTSSetIFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00800">DMMoFEM.cpp:800</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateTensor2SymmetricFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateTensor2SymmetricFieldValues.html">MoFEM::OpCalculateTensor2SymmetricFieldValues</a></div><div class="ttdoc">Calculate symmetric tensor field values at integration pts.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00977">UserDataOperators.hpp:977</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="aEshelbianContact_8hpp_html"><div class="ttname"><a href="EshelbianContact_8hpp.html">EshelbianContact.hpp</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_a91c6f5f96b8f4ec76ed7c87ea96bbd9c"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#a91c6f5f96b8f4ec76ed7c87ea96bbd9c">MoFEM::ForcesAndSourcesCore::gaussPts</a></div><div class="ttdeci">MatrixDouble gaussPts</div><div class="ttdoc">Matrix of integration points.</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00109">ForcesAndSourcesCore.hpp:109</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_acd15202cb7502a684f8276aae2b4ed70"><div class="ttname"><a href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">MoFEM::PetscOptionsGetString</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetString(PetscOptions *, const char pre[], const char name[], char str[], size_t size, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00172">DeprecatedPetsc.hpp:172</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astructEshelbianMonitor_html"><div class="ttname"><a href="structEshelbianMonitor.html">EshelbianMonitor</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianMonitor_8cpp_source.html#l00006">EshelbianMonitor.cpp:6</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a77d94d2111c0c988bc3100b3910cc25c"><div class="ttname"><a href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">MoFEM::createVectorMPI</a></div><div class="ttdeci">auto createVectorMPI(MPI_Comm comm, PetscInt n, PetscInt N)</div><div class="ttdoc">Create MPI Vector.</div><div class="ttdef"><b>Definition:</b> <a href="PetscSmartObj_8hpp_source.html#l00202">PetscSmartObj.hpp:202</a></div></div>
<div class="ttc" id="anamespacesdf__hertz__2d__axisymm__plane_html_a8204f26163e5d184298bc6fa855b88ea"><div class="ttname"><a href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">sdf_hertz_2d_axisymm_plane.d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition:</b> <a href="sdf__hertz__2d__axisymm__plane_8py_source.html#l00004">sdf_hertz_2d_axisymm_plane.py:4</a></div></div>
<div class="ttc" id="agroup__dm_html_ga81d1702e6a5cbe505aa79e94c4aa9d74"><div class="ttname"><a href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">MoFEM::DMMoFEMGetTsCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetTsCtx(DM dm, MoFEM::TsCtx **ts_ctx)</div><div class="ttdoc">get MoFEM::TsCtx data structure</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01142">DMMoFEM.cpp:1142</a></div></div>
<div class="ttc" id="astructTSElasticPostStep_html_a11e5b883541555c29988f8eb9e8dec7a"><div class="ttname"><a href="structTSElasticPostStep.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a></div><div class="ttdeci">static MoFEMErrorCode postStepInitialise(EshelbianCore *ep_ptr)</div><div class="ttdef"><b>Definition:</b> <a href="TSElasticPostStep_8cpp_source.html#l00011">TSElasticPostStep.cpp:11</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a></div><div class="ttdeci">FieldApproximationBase</div><div class="ttdoc">approximation base</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00058">definitions.h:58</a></div></div>
<div class="ttc" id="atest__broken__space_8cpp_html_a7d51850bc3e191e80e4a1b055db5dd49"><div class="ttname"><a href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a></div><div class="ttdeci">BoundaryEle::UserDataOperator BdyEleOp</div><div class="ttdef"><b>Definition:</b> <a href="test__broken__space_8cpp_source.html#l00037">test_broken_space.cpp:37</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_html_a7cb7671c28a28a884b3b7590c821244f"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData.html#a7cb7671c28a28a884b3b7590c821244f">MoFEM::EntitiesFieldData::dataOnEntities</a></div><div class="ttdeci">std::array&lt; boost::ptr_vector&lt; EntData &gt;, MBMAXTYPE &gt; dataOnEntities</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00057">EntitiesFieldData.hpp:57</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_ggabb82cd10e89a1d4d25fa7756360b181baf9cac1fd5336e189c8f107a7a33e7a5e"><div class="ttname"><a href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf9cac1fd5336e189c8f107a7a33e7a5e">MoFEM::BLOCK_SCHUR</a></div><div class="ttdeci">@ BLOCK_SCHUR</div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00108">FormsIntegrators.hpp:108</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="agroup__dm_html_ga62400e040ecf09a00b7ec3767fc7f124"><div class="ttname"><a href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">MoFEM::DMMoFEMAddSubFieldRow</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldRow(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00238">DMMoFEM.cpp:238</a></div></div>
<div class="ttc" id="aSetUpSchurImpl_8cpp_html"><div class="ttname"><a href="SetUpSchurImpl_8cpp.html">SetUpSchurImpl.cpp</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa54e3cb5e57c57a8d03d9c4c7a21a80a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">MoFEM::MeshsetsManager::getCubitMeshsetPtr</a></div><div class="ttdeci">MoFEMErrorCode getCubitMeshsetPtr(const int ms_id, const CubitBCType cubit_bc_type, const CubitMeshSets **cubit_meshset_ptr) const</div><div class="ttdoc">get cubit meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00578">MeshsetsManager.cpp:578</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData.html">MoFEM::EntitiesFieldData</a></div><div class="ttdoc">data structure for finite element entity</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00040">EntitiesFieldData.hpp:40</a></div></div>
<div class="ttc" id="astructSetUpSchur_html_a9c9d1d7c1d1056006209d2b2c6aeddfc"><div class="ttname"><a href="structSetUpSchur.html#a9c9d1d7c1d1056006209d2b2c6aeddfc">SetUpSchur::createSetUpSchur</a></div><div class="ttdeci">static boost::shared_ptr&lt; SetUpSchur &gt; createSetUpSchur(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition:</b> <a href="test__broken__space_8cpp_source.html#l00768">test_broken_space.cpp:768</a></div></div>
<div class="ttc" id="astructEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dP_html"><div class="ttname"><a href="structEshelbianPlasticity_1_1OpConstrainBoundaryL2Lhs__dP.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dP</a></div><div class="ttdef"><b>Definition:</b> <a href="EshelbianContact_8hpp_source.html#l00172">EshelbianContact.hpp:172</a></div></div>
<div class="ttc" id="aEshelbianPlasticity_8cpp_html_a682702e0fce3d077405cdabd7af01877"><div class="ttname"><a href="EshelbianPlasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a></div><div class="ttdeci">static auto get_range_from_block(MoFEM::Interface &amp;m_field, const std::string block_name, int dim)</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8cpp_source.html#l00052">EshelbianPlasticity.cpp:52</a></div></div>
<div class="ttc" id="anamespaceEshelbianPlasticity_html_aad51dbcb3d4d470a0d589df584a43e17ac5de4be4804727d358178fdb2865c6dc"><div class="ttname"><a href="namespaceEshelbianPlasticity.html#aad51dbcb3d4d470a0d589df584a43e17ac5de4be4804727d358178fdb2865c6dc">EshelbianPlasticity::MODERATE_ROT</a></div><div class="ttdeci">@ MODERATE_ROT</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianPlasticity_8hpp_source.html#l00043">EshelbianPlasticity.hpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a></div><div class="ttdeci">@ HDIV</div><div class="ttdoc">field with continuous normal traction</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00087">definitions.h:87</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a></div><div class="ttdeci">@ MOFEM_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00032">definitions.h:32</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_abef09b6c07215b3605b342c408884602"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#abef09b6c07215b3605b342c408884602">MoFEM::ForcesAndSourcesCore::UserDataOperator::getKSPB</a></div><div class="ttdeci">Mat getKSPB() const</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l01104">ForcesAndSourcesCore.hpp:1104</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00496">definitions.h:496</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e"><div class="ttname"><a href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e">MoFEM::SCHUR</a></div><div class="ttdeci">@ SCHUR</div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00106">FormsIntegrators.hpp:106</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpLoopSide_html"><div class="ttname"><a href="structMoFEM_1_1OpLoopSide.html">MoFEM::OpLoopSide</a></div><div class="ttdoc">Element used to execute operators on side of the element.</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l01290">ForcesAndSourcesCore.hpp:1290</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ab385a9ad5a2b6c9f11dbb50876a2977d"><div class="ttname"><a href="namespaceMoFEM.html#ab385a9ad5a2b6c9f11dbb50876a2977d">MoFEM::PostProcBrokenMeshInMoabBaseBegin</a></div><div class="ttdeci">PostProcBrokenMeshInMoabBaseBeginImpl&lt; PostProcBrokenMeshInMoabBase&lt; ForcesAndSourcesCore &gt; &gt; PostProcBrokenMeshInMoabBaseBegin</div><div class="ttdoc">Enable to run stack of post-processing elements. Use this to begin stack.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00934">PostProcBrokenMeshInMoabBase.hpp:934</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_ac1d7ee38dde697833773a3b8cb197a76"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#ac1d7ee38dde697833773a3b8cb197a76">MoFEM::ForcesAndSourcesCore::mField</a></div><div class="ttdeci">Interface &amp; mField</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00024">ForcesAndSourcesCore.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TetPolynomialBase_html"><div class="ttname"><a href="structMoFEM_1_1TetPolynomialBase.html">MoFEM::TetPolynomialBase</a></div><div class="ttdoc">Calculate base functions on tetrahedral.</div><div class="ttdef"><b>Definition:</b> <a href="TetPolynomialBase_8hpp_source.html#l00017">TetPolynomialBase.hpp:17</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_a3fcd2f1369f2c65426d4400089f9e1c7"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a3fcd2f1369f2c65426d4400089f9e1c7">MoFEM::ForcesAndSourcesCore::UserDataOperator::UserDataOperator</a></div><div class="ttdeci">UserDataOperator(const FieldSpace space, const char type=OPSPACE, const bool symm=true)</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8cpp_source.html#l01977">ForcesAndSourcesCore.cpp:1977</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01123">DMMoFEM.cpp:1123</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a7878f2dbe482129374d1d05c05f3c670"><div class="ttname"><a href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a></div><div class="ttdeci">PetscErrorCode ShapeMBTET(double *N, const double *G_X, const double *G_Y, const double *G_Z, int DIM)</div><div class="ttdoc">calculate shape functions</div><div class="ttdef"><b>Definition:</b> <a href="fem__tools_8c_source.html#l00306">fem_tools.c:306</a></div></div>
<div class="ttc" id="aquad_8h_html"><div class="ttname"><a href="quad_8h.html">quad.h</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>