<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: COR-10: Navier-Stokes equation</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.15.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">COR-10: Navier-Stokes equation</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#navier_stokes_introduction">Introduction</a></li>
<li class="level1"><a href="#navier_stokes_scaling">Non-dimensionalization and scaling</a></li>
<li class="level1"><a href="#navier_stokes_fe_formulation">Finite-element formulation</a><ul><li class="level2"><a href="#navier_stokes_fe_formulation_weak_form">Weak form</a></li>
<li class="level2"><a href="#navier_stokes_fe_formulation_mixed_problem">Note on the choice of spaces for the mixed problem</a></li>
</ul>
</li>
<li class="level1"><a href="#navier_stokes_implementation">Implementation</a><ul><li class="level2"><a href="#navier_stokes_running_input_parameters">Reading mesh and input parameters</a></li>
<li class="level2"><a href="#navier_stokes_running_setup">Setting up fields, finite elements and the problem itself</a></li>
<li class="level2"><a href="#navier_stokes_running_solving_problem">Solving the problem and post-processing the results</a></li>
</ul>
</li>
<li class="level1"><a href="#navier_stokes_running">Running the example</a><ul><li class="level2"><a href="#navier_stokes_running_stokes">Stokes equation</a></li>
<li class="level2"><a href="#navier_stokes_running_navier_stokes">Navier-Stokes equations</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="navier_stokes_introduction"></a>
Introduction</h1>
<p>Navier-Stokes equations (NSE), governing the motion of a viscous fluid, are used in various applications: from simulations of the flow in blood vessels to studies of the air flow around aeroplane wings and rotor blades, scaling up to models of ocean and atmospheric currents. Even in the case of an incompressible steady flow, NSE are non-linear due to the effect of the inertia, which is more pronounced in case of a higher Reynolds number. In this tutorial we discuss the implementation of a viscous fluid model in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> using hierarchical basis functions. This approach permits us to locally increase the order of approximation, enforcing conformity across finite element boundaries, without the need to change the implementation of an element. Moreover, the requirement of different approximation orders for primal (velocity) and dual (pressure) variables, necessary for a simulation of the flow using the mixed formulation, can be easily satisfied.</p>
<h1><a class="anchor" id="navier_stokes_problem_statement"></a>
Problem statement</h1>
<p>An incompressible isoviscous steady-state flow in a domain \(\Omega\) is governed by the following equations:  </p><p class="formulaDsp">
\[
\begin{align}
\label{eq:balance_momentum} \rho \left(\mathbf{u}\cdot\nabla\right)\mathbf{u} - \mu\nabla^2\mathbf{u} + \nabla p &amp;= \mathbf{f},\\
\label{eq:cont} \nabla\cdot\mathbf{u} &amp;= 0,
\end{align}
\]
</p>
<p> where \eqref{eq:balance_momentum} is the set of Navier-Stokes equations, representing the balance of the momentum, and \eqref{eq:cont} is the continuity equation; \(\mathbf{u}=[u_x, u_y, u_z]^\intercal\) is the velocity field, \(p\) is the hydrostatic pressure field, \(\rho\) is the fluid mass density, \(\mu\) is fluid viscosity and $\mathbf{f}$ is the density of external forces. The boundary value problem complements the above equations by the Dirichlet and Neumann conditions on the boundary \(\partial\Omega\):  </p><p class="formulaDsp">
\[
\begin{align}
\label{eq:bc_d}\mathbf{u} = \mathbf{u}_D &amp; \;\text{on}\; \Gamma_D,\\
\label{eq:bc_n}\mathbf{n}\cdot \left[-p\mathbf{I}+\mu\left(\nabla\mathbf{u} + \nabla\mathbf{u}^\intercal\right)\right] = \mathbf{g}_N &amp; \;\text{on} \;\Gamma_N,
\end{align}
\]
</p>
<p> where \(\mathbf{u}_D\) is the prescribed velocity on the part of the boundary \(\Gamma_D\subset\partial\Omega\), and \(\mathbf{g}_N\) is the prescribed traction vector on the part of the boundary \(\Gamma_N\subset\partial\Omega\), \(\mathbf{n}\) is an outward normal.</p>
<p>In this tutorial we will solve the problem of the fluid flow around a rigid sphere (see <a class="el" href="tutorial_navier_stokes.html#navier_stokes_problem_statement">Figure 1</a>) of a radius \(r\) positioned in the centre of a cubic domain, the side length \(2l\) of which is considered sufficiently large compared to \(r\), so that a uniform far-field velocity on the exterior boundaries is valid (note that the body forces are neglected). Exploiting the symmetry of the problem, we will use a quarter of the domain in our simulations.</p>
<p><a class="anchor" id="navier_stokes_problem_statement"></a></p><div class="image">
<img src="mesh_navier_stokes.png" alt="" width="900px"/>
<div class="caption">
Figure 1: (a) Finite-element mesh used for simulation of fluid flow around a rigid sphere. (b) Sketch of the problem set-up on a section $z=0$ of the mesh.</div></div>
<p>Note that due to the structure of differential operators in the Navier-Stokes equations \eqref{eq:balance_momentum}, the fluid pressure has to be specified on a part of boundary in order to obtain a unique solution. To achieve that, we will combine Dirichlet and Neumann condition on the outlet boundary of the domain, see see <a class="el" href="tutorial_navier_stokes.html#navier_stokes_problem_statement">Figure 1</a>. In the case when the flow is perpendicular to the boundary ( \(u_y = u_z = 0\)), which is enforced by the Dirichlet boundary condition, the hydrostatic fluid pressure equals to the normal traction on such boundary, see Theorem 1 in <b>[barth2007boundary]</b>.</p>
<h1><a class="anchor" id="navier_stokes_scaling"></a>
Non-dimensionalization and scaling</h1>
<p>Reynolds number is introduced for the problems governed by the Navier-Stokes equations as a measure of the ratio of inertial forces to viscous forces:  </p><p class="formulaDsp">
\[
\begin{equation}
\mathcal{R} = \frac{\rho U L }{\mu},
\end{equation}
\]
</p>
<p> where \(U\) is the scale for the velocity and \(L\) is a relevant length scale. For the problem of the fluid flow around a sphere, considered in this tutorial, the far-field velocity plays the role of the velocity scale, while \(L=2r\), where \(r\) is the radius of the sphere.</p>
<p>When viscous forces dominate over the inertia forces, \(\mathcal{R} \ll 1\), the non-linear term in \eqref{eq:balance_momentum} can be neglected, simplifying NSE down to Stokes equations. However, often this is not the case, i.e. the nonlinear term may become dominant over the viscous forces. In these cases non-dimensionalization (scaling) of Navier-Stokes equations is very useful, which permits to decrease the number of coefficients to only one &ndash; Reynolds number \(\mathcal{R}\). The following scales can be used for the case of flow with relatively low Reynolds number (e.g. less than 100). </p><a class="anchor" id="multi_row"></a>
<table class="doxtable">
<caption>Non-dimensionalization of Navier-Stokes equations </caption>
<tr>
<th>Physical quantity </th><th>Scale </th><th>Dimensionless variable </th></tr>
<tr>
<td style="text-align:center">Length </td><td style="text-align:center">\(L\) </td><td style="text-align:center">\(\mathbf{x}^{*}=\mathbf{x}\:/\:L, \quad \nabla^{*}(\cdot) = L\nabla(\cdot)\) </td></tr>
<tr>
<td style="text-align:center">Velocity </td><td style="text-align:center">\(U\) </td><td style="text-align:center">\(\mathbf{u}^{*}=\mathbf{u}\:/\:U\) </td></tr>
<tr>
<td style="text-align:center">Pressure </td><td style="text-align:center">\(P=\frac{\mu U}{L}\) </td><td style="text-align:center">\(p^{*}=p\:/\:P\) </td></tr>
</table>
<p>Mote that the scale for pressure depends on the scales for the length and the velocity. Using these scales, Navier-stokes equations (1) - (2) can be written in the following dimensionless form (considering zero external forces):  </p><p class="formulaDsp">
\[
\begin{align}
\label{eq:balance_momentum_dim_less} \mathcal{R} \left(\mathbf{u}^{*}\cdot\nabla^{*}\right)\mathbf{u}^{*} - (\nabla^{*})^2\mathbf{u}^{*} + \nabla^{*} p^{*} &amp;= 0,\\
\label{eq:cont_dim_less} \nabla^{*}\cdot\mathbf{u}^{*} &amp;= 0,
\end{align}
\]
</p>
<p>Note that now the influence of the non-linearity (inertia terms) on the problem is fully controlled by the value of the Reynolds number. On the one hand, if \(\mathcal{R} \ll 1\), or if one simply wants to consider the Stokes equation, the nonlinear term can be dropped. On the other hand, if the Reynolds number is sufficiently high, then the non-linearity can become strong and may pose problems for convergence (see below discussion of the linearisation of the problem for the Newton-Raphson method). In this case a certain iterative procedure can be used to obtain a solution. Indeed, to find the solution for a given Reynolds number, a number of intermediate problems can be solved for range of smaller \(\mathcal{R}\), eventually reaching the original value. Such technique will also be used in this tutorial. Note also that below we will drop the * symbol, implying that during computation all considered quantities are dimensionless, and a transformation to the dimensional variables is performed before post-processing of the results takes place.</p>
<h1><a class="anchor" id="navier_stokes_fe_formulation"></a>
Finite-element formulation</h1>
<h2><a class="anchor" id="navier_stokes_fe_formulation_weak_form"></a>
Weak form</h2>
<p>The weak statement of the problem \eqref{eq:balance_momentum}-\eqref{eq:bc_n} reads: Find a vector field \(\mathbf{u}  \in \mathbf{H}^1(\Omega)\) and a scalar field \(p \in L^2(\Omega)\), such that for any test functions \(\mathbf{v} \in \mathbf{H}^1_0(\Omega)\) and \(q \in L^2(\Omega)\):  </p><p class="formulaDsp">
\[
\begin{align}
\label{eq:weak}
\mathcal{R}\int\limits_\Omega \left(\mathbf{u}\cdot\nabla\right)\mathbf{u} \cdot\mathbf{v} \,d\Omega + \int\limits_{\Omega}\nabla\mathbf{u}\mathbin{:}\nabla\mathbf{v}\, d\Omega - \int\limits_{\Omega}p\, \nabla\cdot\mathbf{v} \, d\Omega &amp;= \int\limits_{\Omega}\mathbf{f}\cdot\mathbf{v}\,d\Omega + \int\limits_{\Gamma_N}\mathbf{g}_N\cdot\mathbf{v}\,d\Gamma_N,\\
- \int\limits_{\Omega}q\, \nabla\cdot\mathbf{u} \, d\Omega  &amp;= 0
\end{align}
\]
</p>
<p> Upon finite-element discretization of the domain \(\Omega\), we consider interpolation of both unknown fields introducing shape functions on each element: \begin{equation} \label{eq:shape} u_i = \sum\limits_{\alpha=1}^{n_{\mathbf{u}}} N_{\alpha}\, u_i^\alpha, \quad p = \sum\limits_{\beta=1}^{n_p} \Phi_{\beta}\, p^\beta; \quad v_i = \sum\limits_{\alpha=1}^{n_{\mathbf{u}}} N_{\alpha}\, v_i^\alpha, \quad q = \sum\limits_{\beta=1}^{n_p} \Phi_{\beta}\, q^\beta, \end{equation} where \(n_{\mathbf{u}}\) is the number of shape functions associated with the velocity field, and $n_p$ is the similar number for the pressure field. Using the hierarchical basis approximation, the vector of the shape functions can be decomposed into four sub-vectors, consisting of shape functions associated with element's entities: vertices, edges, faces and the volume of the element, e.g. for the velocity field:  </p><p class="formulaDsp">
\[
 \begin{equation}
\label{eq:shape_hier}
\mathbf{N}^\textit{el} = \left[N_1, \ldots N_\alpha, \ldots N_{n_{\mathbf{u}}}\right]^\intercal = \left[\mathbf{N}^\textit{ver},  \mathbf{N}^\textit{edge}, \mathbf{N}^\textit{face}, \mathbf{N}^\textit{vol}\right]^\intercal.
\end{equation}
\]
</p>
<h2><a class="anchor" id="navier_stokes_fe_formulation_mixed_problem"></a>
Note on the choice of spaces for the mixed problem</h2>
<p>Note that in the weak statement velocity and pressure fields belong to different spaces: \(H^1\) and \(L^2\), respectively. Two different approaches can be used for implementing such mixed formulation in the finite-element framework. One can use generalised Taylor-Hood elements, which feature continuous ( \(H^1\) ) approximation of both velocity and pressure fields, however, in order to enforce stability, the approximations functions for the pressure field should be one order lower than those for the velocity field. Furthermore, Taylor-Hood elements impose certain constraints on the mesh, see <b>[wieners2003taylor]</b>. Alternatively, a discontinuous approximation for pressure can be used, however, in this case the difference between the orders of approximation functions for velocity and for pressure should be 2.</p>
<h1><a class="anchor" id="navier_stokes_implementation"></a>
Implementation</h1>
<p>The example class has necessary fields to store input parameters and internal data structures, as well as a set of functions for setting up and solving the problem:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structNavierStokesExample.html">NavierStokesExample</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="structNavierStokesExample.html">NavierStokesExample</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>(m_field) {</div>
<div class="line">    <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a> = boost::make_shared&lt;NavierStokesElement::CommonData&gt;(m_field);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_function" href="structNavierStokesExample.html#a1677a328755666e896cabbbb64ee86e7">~NavierStokesExample</a>() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESDestroy(&amp;<a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a51c8013c5a3af9ea0e67bab39c0daa16">runProblem</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>;</div>
<div class="line"> </div>
<div class="line">  PetscBool <a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a> = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a> = 2; <span class="comment">// default approximation orderVelocity</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a> = 1; <span class="comment">// default approximation orderPressure</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a> = 0;</div>
<div class="line">  PetscBool <a class="code hl_variable" href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">isDiscontPressure</a> = PETSC_FALSE;</div>
<div class="line">  PetscBool <a class="code hl_variable" href="structNavierStokesExample.html#a9aee6544f3c35f68b0419e7d6b44a175">isHoGeometry</a> = PETSC_TRUE;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">pressureScale</a> = 1.0;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a> = 1.0;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a> = 1.0;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#ae49034df9fb49b2b24d5f4c1e9dd7039">reNumber</a> = 1.0;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#aa314bfd43bbfee365eabcac44c0f73a7">density</a>;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">viscosity</a>;</div>
<div class="line">  PetscBool <a class="code hl_variable" href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">isStokesFlow</a> = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structNavierStokesExample.html#a7ecaa982eced739534344de5015d1acf">numSteps</a> = 1;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#a752dd04499c920647b688e18e12eca3b">lambdaStep</a> = 1.0;</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="structNavierStokesExample.html#ab1851070923971f66267bd1d21b1d95e">lambda</a> = 0.0;</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">step</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classRange.html">Range</a> <a class="code hl_variable" href="structNavierStokesExample.html#a0947679f1db023e88f299bf9aef0c788">solidFaces</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="structNavierStokesExample.html#a8ab4b23c32716e16ad1775381d411163">bitLevel</a>;</div>
<div class="line"> </div>
<div class="line">  DM <a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>;</div>
<div class="line">  SNES <a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;NavierStokesElement::CommonData&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>;</div>
<div class="line"> </div>
<div class="line">  SmartPetscObj&lt;Vec&gt; <a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>;</div>
<div class="line">  SmartPetscObj&lt;Vec&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a>;</div>
<div class="line">  SmartPetscObj&lt;Mat&gt; <a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a>;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a>;</div>
<div class="line">  boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; <a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a>;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a06cf93399978e44184ff99192a2a12bc">feDragPtr</a>;</div>
<div class="line">  boost::shared_ptr&lt;VolumeElementForcesAndSourcesCoreOnSide&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a922b7b49a8ff7c932abf2970dcea6353">feDragSidePtr</a>;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;DirichletDisplacementBc&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>;</div>
<div class="line">  boost::ptr_map&lt;std::string, NeumannForcesSurface&gt; <a class="code hl_variable" href="structNavierStokesExample.html#abadabff990b673227892d6133f24cab2">neumannForces</a>;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;PostProcVol&gt; <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>;</div>
<div class="line">  boost::shared_ptr&lt;PostProcFace&gt; <a class="code hl_variable" href="structNavierStokesExample.html#a0e2e033173b9426ebd3922b3e4d79545">fePostProcDragPtr</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#af2a124e38ab337041172a72e3970dd1e">readInput</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a9dd68c0ae7866e9e040659f49c65f8af">findBlocks</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a3d202fff44befd80728d53b61c8d7dad">setupFields</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a0700944c75e2c4c1fbda5a37c34d2b0a">defineFiniteElements</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a02a47f622ca0f8e9618eb365514be269">setupDiscreteManager</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a7e6e8aa883f1a157f519c73a987ffba1">setupAlgebraicStructures</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a01d2467a1d2600fe714c082b2cc838a5">setupElementInstances</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#a46f8457e7b5e5ab929db8475c1a87249">setupSNES</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#adafe18cf9f87b240c7e5d522415651a9">solveProblem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structNavierStokesExample.html#ae74f1de1197604f9981ec446b4f7b06d">postProcess</a>();</div>
<div class="line">};</div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html"><div class="ttname"><a href="structNavierStokesExample.html">NavierStokesExample</a></div><div class="ttdoc">[Example Navier Stokes]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00022">navier_stokes.cpp:22</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a01d2467a1d2600fe714c082b2cc838a5"><div class="ttname"><a href="structNavierStokesExample.html#a01d2467a1d2600fe714c082b2cc838a5">NavierStokesExample::setupElementInstances</a></div><div class="ttdeci">MoFEMErrorCode setupElementInstances()</div><div class="ttdoc">[Setup algebraic structures]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00404">navier_stokes.cpp:404</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a027c1da77f604ef046d2767fbff1e3d5"><div class="ttname"><a href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">NavierStokesExample::snes</a></div><div class="ttdeci">SNES snes</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00062">navier_stokes.cpp:62</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a02a47f622ca0f8e9618eb365514be269"><div class="ttname"><a href="structNavierStokesExample.html#a02a47f622ca0f8e9618eb365514be269">NavierStokesExample::setupDiscreteManager</a></div><div class="ttdeci">MoFEMErrorCode setupDiscreteManager()</div><div class="ttdoc">[Define finite elements]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00357">navier_stokes.cpp:357</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a06cf93399978e44184ff99192a2a12bc"><div class="ttname"><a href="structNavierStokesExample.html#a06cf93399978e44184ff99192a2a12bc">NavierStokesExample::feDragPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; feDragPtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00073">navier_stokes.cpp:73</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a0700944c75e2c4c1fbda5a37c34d2b0a"><div class="ttname"><a href="structNavierStokesExample.html#a0700944c75e2c4c1fbda5a37c34d2b0a">NavierStokesExample::defineFiniteElements</a></div><div class="ttdeci">MoFEMErrorCode defineFiniteElements()</div><div class="ttdoc">[Setup fields]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00334">navier_stokes.cpp:334</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a0947679f1db023e88f299bf9aef0c788"><div class="ttname"><a href="structNavierStokesExample.html#a0947679f1db023e88f299bf9aef0c788">NavierStokesExample::solidFaces</a></div><div class="ttdeci">Range solidFaces</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00058">navier_stokes.cpp:58</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a0e2e033173b9426ebd3922b3e4d79545"><div class="ttname"><a href="structNavierStokesExample.html#a0e2e033173b9426ebd3922b3e4d79545">NavierStokesExample::fePostProcDragPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; PostProcFace &gt; fePostProcDragPtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00080">navier_stokes.cpp:80</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a1677a328755666e896cabbbb64ee86e7"><div class="ttname"><a href="structNavierStokesExample.html#a1677a328755666e896cabbbb64ee86e7">NavierStokesExample::~NavierStokesExample</a></div><div class="ttdeci">~NavierStokesExample()</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00027">navier_stokes.cpp:27</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a1d2cf68679f1cc86cb32099e7545396d"><div class="ttname"><a href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">NavierStokesExample::isStokesFlow</a></div><div class="ttdeci">PetscBool isStokesFlow</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00051">navier_stokes.cpp:51</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a23c276da8b4da10d9234d840262913fe"><div class="ttname"><a href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">NavierStokesExample::numHoLevels</a></div><div class="ttdeci">int numHoLevels</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00041">navier_stokes.cpp:41</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a28267d1c5f2db8dbf38a48b9bbe05fd9"><div class="ttname"><a href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">NavierStokesExample::feLhsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; feLhsPtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00070">navier_stokes.cpp:70</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a30e9c2e7f9e97884a31a10dfde241f31"><div class="ttname"><a href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">NavierStokesExample::viscosity</a></div><div class="ttdeci">double viscosity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00050">navier_stokes.cpp:50</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a3511590e2f638cb93f1dd616db506c5e"><div class="ttname"><a href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">NavierStokesExample::orderPressure</a></div><div class="ttdeci">int orderPressure</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00040">navier_stokes.cpp:40</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a3d202fff44befd80728d53b61c8d7dad"><div class="ttname"><a href="structNavierStokesExample.html#a3d202fff44befd80728d53b61c8d7dad">NavierStokesExample::setupFields</a></div><div class="ttdeci">MoFEMErrorCode setupFields()</div><div class="ttdoc">[Find blocks]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00239">navier_stokes.cpp:239</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a46f8457e7b5e5ab929db8475c1a87249"><div class="ttname"><a href="structNavierStokesExample.html#a46f8457e7b5e5ab929db8475c1a87249">NavierStokesExample::setupSNES</a></div><div class="ttdeci">MoFEMErrorCode setupSNES()</div><div class="ttdoc">[Setup element instances]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00520">navier_stokes.cpp:520</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a4e446687c7d05a813b636b510a7d3b43"><div class="ttname"><a href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">NavierStokesExample::isPartitioned</a></div><div class="ttdeci">PetscBool isPartitioned</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00037">navier_stokes.cpp:37</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a51c8013c5a3af9ea0e67bab39c0daa16"><div class="ttname"><a href="structNavierStokesExample.html#a51c8013c5a3af9ea0e67bab39c0daa16">NavierStokesExample::runProblem</a></div><div class="ttdeci">MoFEMErrorCode runProblem()</div><div class="ttdoc">[Example Navier Stokes]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00096">navier_stokes.cpp:96</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a52c6563adf7ea6b26d76bf93637325e5"><div class="ttname"><a href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">NavierStokesExample::F</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; F</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00067">navier_stokes.cpp:67</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a55fca530e7dcfbaaa1e45255e14d4d50"><div class="ttname"><a href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">NavierStokesExample::commonData</a></div><div class="ttdeci">boost::shared_ptr&lt; NavierStokesElement::CommonData &gt; commonData</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00064">navier_stokes.cpp:64</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a633de4aa1f49685c441c69c9c0571151"><div class="ttname"><a href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">NavierStokesExample::dirichletBcPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; DirichletDisplacementBc &gt; dirichletBcPtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00076">navier_stokes.cpp:76</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a634fc6673ceb0002d80e8a7aa4388093"><div class="ttname"><a href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">NavierStokesExample::isDiscontPressure</a></div><div class="ttdeci">PetscBool isDiscontPressure</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00042">navier_stokes.cpp:42</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a6ca6a8b2facaa6eab5f40deefb58d74b"><div class="ttname"><a href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">NavierStokesExample::velocityScale</a></div><div class="ttdeci">double velocityScale</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00047">navier_stokes.cpp:47</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a70ea0f7930b870ce5a90df7b9495f853"><div class="ttname"><a href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">NavierStokesExample::pressureScale</a></div><div class="ttdeci">double pressureScale</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00045">navier_stokes.cpp:45</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a752dd04499c920647b688e18e12eca3b"><div class="ttname"><a href="structNavierStokesExample.html#a752dd04499c920647b688e18e12eca3b">NavierStokesExample::lambdaStep</a></div><div class="ttdeci">double lambdaStep</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00054">navier_stokes.cpp:54</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a7e6e8aa883f1a157f519c73a987ffba1"><div class="ttname"><a href="structNavierStokesExample.html#a7e6e8aa883f1a157f519c73a987ffba1">NavierStokesExample::setupAlgebraicStructures</a></div><div class="ttdeci">MoFEMErrorCode setupAlgebraicStructures()</div><div class="ttdoc">[Setup discrete manager]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00381">navier_stokes.cpp:381</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a7ecaa982eced739534344de5015d1acf"><div class="ttname"><a href="structNavierStokesExample.html#a7ecaa982eced739534344de5015d1acf">NavierStokesExample::numSteps</a></div><div class="ttdeci">int numSteps</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00053">navier_stokes.cpp:53</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a8ab4b23c32716e16ad1775381d411163"><div class="ttname"><a href="structNavierStokesExample.html#a8ab4b23c32716e16ad1775381d411163">NavierStokesExample::bitLevel</a></div><div class="ttdeci">BitRefLevel bitLevel</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00059">navier_stokes.cpp:59</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a922b7b49a8ff7c932abf2970dcea6353"><div class="ttname"><a href="structNavierStokesExample.html#a922b7b49a8ff7c932abf2970dcea6353">NavierStokesExample::feDragSidePtr</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCoreOnSide &gt; feDragSidePtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00074">navier_stokes.cpp:74</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a9aee6544f3c35f68b0419e7d6b44a175"><div class="ttname"><a href="structNavierStokesExample.html#a9aee6544f3c35f68b0419e7d6b44a175">NavierStokesExample::isHoGeometry</a></div><div class="ttdeci">PetscBool isHoGeometry</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00043">navier_stokes.cpp:43</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_a9dd68c0ae7866e9e040659f49c65f8af"><div class="ttname"><a href="structNavierStokesExample.html#a9dd68c0ae7866e9e040659f49c65f8af">NavierStokesExample::findBlocks</a></div><div class="ttdeci">MoFEMErrorCode findBlocks()</div><div class="ttdoc">[Read input]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00182">navier_stokes.cpp:182</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_aa314bfd43bbfee365eabcac44c0f73a7"><div class="ttname"><a href="structNavierStokesExample.html#aa314bfd43bbfee365eabcac44c0f73a7">NavierStokesExample::density</a></div><div class="ttdeci">double density</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00049">navier_stokes.cpp:49</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_aaa4f62b3022fcea58ea314659da2e013"><div class="ttname"><a href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">NavierStokesExample::feRhsPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; feRhsPtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00071">navier_stokes.cpp:71</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_ab1851070923971f66267bd1d21b1d95e"><div class="ttname"><a href="structNavierStokesExample.html#ab1851070923971f66267bd1d21b1d95e">NavierStokesExample::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00055">navier_stokes.cpp:55</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_abadabff990b673227892d6133f24cab2"><div class="ttname"><a href="structNavierStokesExample.html#abadabff990b673227892d6133f24cab2">NavierStokesExample::neumannForces</a></div><div class="ttdeci">boost::ptr_map&lt; std::string, NeumannForcesSurface &gt; neumannForces</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00077">navier_stokes.cpp:77</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_abd281524b993c4d7442ad3143e94f864"><div class="ttname"><a href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">NavierStokesExample::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00035">navier_stokes.cpp:35</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_ac85ca333183c5c93feca0e0ac18cc664"><div class="ttname"><a href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">NavierStokesExample::orderVelocity</a></div><div class="ttdeci">int orderVelocity</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00039">navier_stokes.cpp:39</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_ad6c7e5a9e752de18c424d0ef8792d190"><div class="ttname"><a href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">NavierStokesExample::lengthScale</a></div><div class="ttdeci">double lengthScale</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00046">navier_stokes.cpp:46</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_ad7dc94efdcf07be4b1839854af0bd836"><div class="ttname"><a href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">NavierStokesExample::fePostProcPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; PostProcVol &gt; fePostProcPtr</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00079">navier_stokes.cpp:79</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_adafe18cf9f87b240c7e5d522415651a9"><div class="ttname"><a href="structNavierStokesExample.html#adafe18cf9f87b240c7e5d522415651a9">NavierStokesExample::solveProblem</a></div><div class="ttdeci">MoFEMErrorCode solveProblem()</div><div class="ttdoc">[Setup SNES]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00556">navier_stokes.cpp:556</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_ae49034df9fb49b2b24d5f4c1e9dd7039"><div class="ttname"><a href="structNavierStokesExample.html#ae49034df9fb49b2b24d5f4c1e9dd7039">NavierStokesExample::reNumber</a></div><div class="ttdeci">double reNumber</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00048">navier_stokes.cpp:48</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_ae74f1de1197604f9981ec446b4f7b06d"><div class="ttname"><a href="structNavierStokesExample.html#ae74f1de1197604f9981ec446b4f7b06d">NavierStokesExample::postProcess</a></div><div class="ttdeci">MoFEMErrorCode postProcess()</div><div class="ttdoc">[Solve problem]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00649">navier_stokes.cpp:649</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_aeba64ce62699b12d8eb99aca742c8600"><div class="ttname"><a href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">NavierStokesExample::step</a></div><div class="ttdeci">int step</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00056">navier_stokes.cpp:56</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_af2a124e38ab337041172a72e3970dd1e"><div class="ttname"><a href="structNavierStokesExample.html#af2a124e38ab337041172a72e3970dd1e">NavierStokesExample::readInput</a></div><div class="ttdeci">MoFEMErrorCode readInput()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00112">navier_stokes.cpp:112</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_af53bd240bc022396d9b39009e4f8791c"><div class="ttname"><a href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">NavierStokesExample::dM</a></div><div class="ttdeci">DM dM</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00061">navier_stokes.cpp:61</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_aff53d71e1b2de272dbe543c185eb4aa9"><div class="ttname"><a href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">NavierStokesExample::D</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; D</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00066">navier_stokes.cpp:66</a></div></div>
<div class="ttc" id="astructNavierStokesExample_html_afffb02721eadd37bc9afd40383195e53"><div class="ttname"><a href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">NavierStokesExample::Aij</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; Aij</div><div class="ttdef"><b>Definition</b> <a href="navier__stokes_8cpp_source.html#l00068">navier_stokes.cpp:68</a></div></div>
</div><!-- fragment --><p>The set of functions used in this tutorials in the following:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a51c8013c5a3af9ea0e67bab39c0daa16">NavierStokesExample::runProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#af2a124e38ab337041172a72e3970dd1e">readInput</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a9dd68c0ae7866e9e040659f49c65f8af">findBlocks</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a3d202fff44befd80728d53b61c8d7dad">setupFields</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a0700944c75e2c4c1fbda5a37c34d2b0a">defineFiniteElements</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a02a47f622ca0f8e9618eb365514be269">setupDiscreteManager</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a7e6e8aa883f1a157f519c73a987ffba1">setupAlgebraicStructures</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a01d2467a1d2600fe714c082b2cc838a5">setupElementInstances</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#a46f8457e7b5e5ab929db8475c1a87249">setupSNES</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#adafe18cf9f87b240c7e5d522415651a9">solveProblem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
</div><!-- fragment --><p>The function ExampleNavierStokes::runProblem is executed from the <code>main</code> function:</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> param_file[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <span class="comment">// Initialise MoFEM</span></div>
<div class="line">  <a class="code hl_function" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create mesh database</span></div>
<div class="line">    moab::Core mb_instance;              <span class="comment">// create database</span></div>
<div class="line">    moab::Interface &amp;moab = mb_instance; <span class="comment">// create interface to database</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create MoFEM database and link it to MoAB</span></div>
<div class="line">    <a class="code hl_struct" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line">    <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="structNavierStokesExample.html">NavierStokesExample</a> ex(m_field);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ex.runProblem();</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// finish work cleaning memory, getting statistics, etc</span></div>
<div class="line">  <a class="code hl_function" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition</b> <a href="Core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="navier_stokes_running_input_parameters"></a>
Reading mesh and input parameters</h2>
<p>The workflow of solving a problem using the finite-element method starts from reading the mesh and other input parameters:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#af2a124e38ab337041172a72e3970dd1e">NavierStokesExample::readInput</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordtype">char</span> <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>[255];</div>
<div class="line">  PetscBool flg_mesh_file;</div>
<div class="line"> </div>
<div class="line">  PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;NAVIER_STOKES problem&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_file&quot;</span>, <span class="stringliteral">&quot;mesh file name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;mesh.h5m&quot;</span>,</div>
<div class="line">                            <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 255, &amp;flg_mesh_file);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_is_partitioned&quot;</span>, <span class="stringliteral">&quot;is partitioned?&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a>, PETSC_NULLPTR);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_order_u&quot;</span>, <span class="stringliteral">&quot;approximation orderVelocity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_order_p&quot;</span>, <span class="stringliteral">&quot;approximation orderPressure&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_num_ho_levels&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;number of higher order boundary levels&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_discont_pressure&quot;</span>, <span class="stringliteral">&quot;discontinuous pressure&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a class="code hl_variable" href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">isDiscontPressure</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">isDiscontPressure</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_ho_geometry&quot;</span>, <span class="stringliteral">&quot;use second order geometry&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a class="code hl_variable" href="structNavierStokesExample.html#a9aee6544f3c35f68b0419e7d6b44a175">isHoGeometry</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a9aee6544f3c35f68b0419e7d6b44a175">isHoGeometry</a>, PETSC_NULLPTR);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-my_length_scale&quot;</span>, <span class="stringliteral">&quot;length scale&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-my_velocity_scale&quot;</span>, <span class="stringliteral">&quot;velocity scale&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_stokes_flow&quot;</span>, <span class="stringliteral">&quot;stokes flow&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">isStokesFlow</a>,</div>
<div class="line">                          &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">isStokesFlow</a>, PETSC_NULLPTR);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_step_num&quot;</span>, <span class="stringliteral">&quot;number of steps&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a7ecaa982eced739534344de5015d1acf">numSteps</a>,</div>
<div class="line">                         &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a7ecaa982eced739534344de5015d1acf">numSteps</a>, PETSC_NULLPTR);</div>
<div class="line"> </div>
<div class="line">  PetscOptionsEnd();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (flg_mesh_file != PETSC_TRUE) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;*** ERROR -my_file (MESH FILE NEEDED)&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Read whole mesh or part of it if partitioned</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a> == PETSC_TRUE) {</div>
<div class="line">    <span class="comment">// This is a case of distributed mesh and algebra. In that case each</span></div>
<div class="line">    <span class="comment">// processor keeps only part of the problem.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">    option = <span class="stringliteral">&quot;PARALLEL=READ_PART;&quot;</span></div>
<div class="line">             <span class="stringliteral">&quot;PARALLEL_RESOLVE_SHARED_ENTS;&quot;</span></div>
<div class="line">             <span class="stringliteral">&quot;PARTITION=PARALLEL_PARTITION;&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// In this case, we have distributed algebra, i.e. assembly of vectors and</span></div>
<div class="line">    <span class="comment">// matrices is in parallel, but whole mesh is stored on all processors.</span></div>
<div class="line">    <span class="comment">// snes and matrix scales well, however problem set-up of problem is</span></div>
<div class="line">    <span class="comment">// not fully parallel.</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">    option = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af5bf443e0fec3bbba18aae8042162fcd">rebuild_database</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a8ab4b23c32716e16ad1775381d411163">bitLevel</a>.set(0);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;setBitRefLevelByDim(0, 3,</div>
<div class="line">                                                                   <a class="code hl_variable" href="structNavierStokesExample.html#a8ab4b23c32716e16ad1775381d411163">bitLevel</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="amesh__smoothing_8cpp_html_ae20b66af13b03d8e8a4593186c23cd07"><div class="ttname"><a href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a></div><div class="ttdeci">char mesh_file_name[255]</div><div class="ttdef"><b>Definition</b> <a href="mesh__smoothing_8cpp_source.html#l00022">mesh_smoothing.cpp:22</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_af5bf443e0fec3bbba18aae8042162fcd"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#af5bf443e0fec3bbba18aae8042162fcd">MoFEM::CoreInterface::rebuild_database</a></div><div class="ttdeci">virtual MoFEMErrorCode rebuild_database(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Clear database and initialize it once again.</div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
</div><!-- fragment --><p>Once the mesh is read, we find the set of tetrahedra corresponding to the computational domain. Furthermore, we identify the fluid-structure interface, i.e. the set of triangles corresponding to the surface of the sphere:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a9dd68c0ae7866e9e040659f49c65f8af">NavierStokesExample::findBlocks</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getName().compare(0, 9, <span class="stringliteral">&quot;MAT_FLUID&quot;</span>) == 0) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshsetId();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(</div>
<div class="line">          <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshset(), 3, <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData[<span class="keywordtype">id</span>].eNts, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;double&gt; attributes;</div>
<div class="line">      <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getAttributes(attributes);</div>
<div class="line">      <span class="keywordflow">if</span> (attributes.size() &lt; 2) {</div>
<div class="line">        SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;should be at least 2 attributes but is %d&quot;</span>,</div>
<div class="line">                 attributes.size());</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData[id].iD = id;</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData[id].fluidViscosity = attributes[0];</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData[id].fluidDensity = attributes[1];</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">viscosity</a> = <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData[id].fluidViscosity;</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#aa314bfd43bbfee365eabcac44c0f73a7">density</a> = <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData[id].fluidDensity;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getName().compare(0, 9, <span class="stringliteral">&quot;INT_SOLID&quot;</span>) == 0) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> tets, tet;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshsetId();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(</div>
<div class="line">          <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshset(), MBTRI, <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[<span class="keywordtype">id</span>].eNts, <span class="keyword">true</span>);</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#a0947679f1db023e88f299bf9aef0c788">solidFaces</a>.merge(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[<span class="keywordtype">id</span>].eNts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">          <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[<span class="keywordtype">id</span>].eNts, 3, <span class="keyword">true</span>, tets,</div>
<div class="line">          moab::Interface::UNION);</div>
<div class="line">      tet = <a class="code hl_class" href="classRange.html">Range</a>(tets.front(), tets.front());</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> : <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.eNts.contains(tet)) {</div>
<div class="line">          <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[id].fluidViscosity =</div>
<div class="line">              <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.fluidViscosity;</div>
<div class="line">          <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[id].fluidDensity = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.fluidDensity;</div>
<div class="line">          <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[id].iD = id;</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfFacesData[<span class="keywordtype">id</span>].fluidViscosity &lt; 0) {</div>
<div class="line">        SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                <span class="stringliteral">&quot;Cannot find a fluid block adjacent to a given solid face&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="navier_stokes_running_setup"></a>
Setting up fields, finite elements and the problem itself</h2>
<p>Once the domain and the fluid-structure interface are identified, we can setup the problem. First, we define the velocity and pressure fields. Note that for velocity we use space H1, while for pressure the user can choose between using also H1 space (continuous approximation, Taylor-Hood element), or a discontinuous approximation using L2 space. Note that in the former case, the approximation functions for pressure has to be one order lower than that of the velocity (e.g. order 2 for velocity and order 1 for pressure), while the the latter case the difference between the two has to be 2 orders (e.g. order 3 for velocity and order 1 for pressure).</p>
<p>Furthermore, the properties of hierarchical basis functions can be used to locally increase the approximation order for the elements on the fluid-structure interface, where the gradients of the velocity can be expected to be the highest due to the no-slip boundary condition on the surface of the sphere.</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a3d202fff44befd80728d53b61c8d7dad">NavierStokesExample::setupFields</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">isDiscontPressure</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,</div>
<div class="line">                          3);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">add_ents_to_field_by_dim</a>(0, 3, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">add_ents_to_field_by_dim</a>(0, 3, <span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">add_ents_to_field_by_dim</a>(0, 3, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;VELOCITY&quot;</span>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">isDiscontPressure</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;PRESSURE&quot;</span>, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a> &gt; 0) {</div>
<div class="line">    std::vector&lt;Range&gt; levels(<a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a>);</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> ents;</div>
<div class="line">    ents.merge(<a class="code hl_variable" href="structNavierStokesExample.html#a0947679f1db023e88f299bf9aef0c788">solidFaces</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != <a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a>; ll++) {</div>
<div class="line">      <a class="code hl_class" href="classRange.html">Range</a> verts;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(ents, verts, <span class="keyword">true</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : {1, 2, 3}) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(verts, d, <span class="keyword">false</span>, ents,</div>
<div class="line">                                                 moab::Interface::UNION);</div>
<div class="line">      }</div>
<div class="line">      levels[ll] = subtract(ents, ents.subset_by_type(MBVERTEX));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = <a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a> - 1; ll &gt;= 1; ll--) {</div>
<div class="line">      levels[ll] = subtract(levels[ll], levels[ll - 1]);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> add_order = 1;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = <a class="code hl_variable" href="structNavierStokesExample.html#a23c276da8b4da10d9234d840262913fe">numHoLevels</a> - 1; ll &gt;= 0; ll--) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a>)</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;CommInterface&gt;()-&gt;synchroniseEntities(</div>
<div class="line">            levels[ll]);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(levels[ll], <span class="stringliteral">&quot;VELOCITY&quot;</span>,</div>
<div class="line">                                    <a class="code hl_variable" href="structNavierStokesExample.html#ac85ca333183c5c93feca0e0ac18cc664">orderVelocity</a> + add_order);</div>
<div class="line">      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structNavierStokesExample.html#a634fc6673ceb0002d80e8a7aa4388093">isDiscontPressure</a>)</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(levels[ll], <span class="stringliteral">&quot;PRESSURE&quot;</span>,</div>
<div class="line">                                      <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a> + add_order);</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(levels[ll].subset_by_type(MBTET),</div>
<div class="line">                                      <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a3511590e2f638cb93f1dd616db506c5e">orderPressure</a> + add_order);</div>
<div class="line">      ++add_order;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 1);</div>
<div class="line">  <span class="comment">// Set 2nd order of approximation of geometry</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a9aee6544f3c35f68b0419e7d6b44a175">isHoGeometry</a>) {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> ents, edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, 3, ents);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(ents, 1, <span class="keyword">false</span>, edges,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;CommInterface&gt;()-&gt;synchroniseEntities(edges);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(edges, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;CommInterface&gt;()-&gt;synchroniseFieldEntities(</div>
<div class="line">        <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;CommInterface&gt;()-&gt;synchroniseFieldEntities(</div>
<div class="line">        <span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;CommInterface&gt;()-&gt;synchroniseFieldEntities(</div>
<div class="line">        <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line"> </div>
<div class="line">  Projection10NodeCoordsOnField ent_method_material(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>,</div>
<div class="line">                                                    <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_material);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga3f2352d1e29c591592c37cc89d0e4eb4"><div class="ttname"><a href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">MoFEM::CoreInterface::add_ents_to_field_by_dim</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_dim(const Range &amp;ents, const int dim, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a8008ad16315eb609dcb0fd88746b991a"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
</div><!-- fragment --><p>After that the finite elements operating on the set above fields can be defined. In particular, we define elements for solving Navier-Stokes equations, computation of the drag traction and force on the surface of the surface, and, finally, for computing the contribution of Neumann (natural) boundary conditions.</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a0700944c75e2c4c1fbda5a37c34d2b0a">NavierStokesExample::defineFiniteElements</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add finite element (this defines element, declaration comes later)</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesElement.html#a87b96630a0a8d42083e1383aeaa6c90d">NavierStokesElement::addElement</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>,</div>
<div class="line">                                         <span class="stringliteral">&quot;PRESSURE&quot;</span>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesElement.html#a87b96630a0a8d42083e1383aeaa6c90d">NavierStokesElement::addElement</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <span class="stringliteral">&quot;DRAG&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <span class="stringliteral">&quot;PRESSURE&quot;</span>,</div>
<div class="line">                                         <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a0947679f1db023e88f299bf9aef0c788">solidFaces</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// setup elements for loading</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMetaNeumannForces.html#ace9c5266987cd42a1d2350e4962e6f1b">MetaNeumannForces::addNeumannBCElements</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// build finite elements</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>();</div>
<div class="line">  <span class="comment">// build adjacencies between elements and degrees of freedom</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(<a class="code hl_variable" href="structNavierStokesExample.html#a8ab4b23c32716e16ad1775381d411163">bitLevel</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="astructMetaNeumannForces_html_ace9c5266987cd42a1d2350e4962e6f1b"><div class="ttname"><a href="structMetaNeumannForces.html#ace9c5266987cd42a1d2350e4962e6f1b">MetaNeumannForces::addNeumannBCElements</a></div><div class="ttdeci">static MoFEMErrorCode addNeumannBCElements(MoFEM::Interface &amp;m_field, const std::string field_name, const std::string mesh_nodals_positions=&quot;MESH_NODE_POSITIONS&quot;, Range *intersect_ptr=NULL)</div><div class="ttdoc">Declare finite element.</div><div class="ttdef"><b>Definition</b> <a href="SurfacePressure_8cpp_source.html#l01974">SurfacePressure.cpp:1974</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astructNavierStokesElement_html_a87b96630a0a8d42083e1383aeaa6c90d"><div class="ttname"><a href="structNavierStokesElement.html#a87b96630a0a8d42083e1383aeaa6c90d">NavierStokesElement::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const string element_name, const string velocity_field_name, const string pressure_field_name, const string mesh_field_name, const int dim=3, Range *ents=nullptr)</div><div class="ttdoc">Setting up elements.</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8hpp_source.html#l00127">NavierStokesElement.hpp:127</a></div></div>
</div><!-- fragment --><p>Once the finite elements are defined, we will need to create element instances and push necessary operators to their pipelines. First, we setup an element for solving Navier-Stokes (or if one prefers, Stokes) equations. Note that right-hand side and left-hand side elements are considered separately. In case of Navier-Stokes equations, operators are pushed to elements pipelines using function <a class="el" href="structNavierStokesElement.html#a9c21126c87d7a7005ef7d36ba830d6d8" title="Setting up operators for solving Navier-Stokes equations.">NavierStokesElement::setNavierStokesOperators</a>. In particular, the following operators are pushed to right-hand side:</p><ul>
<li><a class="el" href="structNavierStokesElement_1_1OpAssembleRhsVelocityLin.html" title="Assemble linear part of the velocity component of the RHS vector.">NavierStokesElement::OpAssembleRhsVelocityLin</a>,</li>
<li><a class="el" href="structNavierStokesElement_1_1OpAssembleRhsVelocityNonLin.html" title="Assemble non-linear part of the velocity component of the RHS vector.">NavierStokesElement::OpAssembleRhsVelocityNonLin</a>,</li>
<li><a class="el" href="structNavierStokesElement_1_1OpAssembleRhsPressure.html" title="Assemble the pressure component of the RHS vector.">NavierStokesElement::OpAssembleRhsPressure</a>,</li>
</ul>
<p>while for the left-hand side we push these operators:</p><ul>
<li><a class="el" href="structNavierStokesElement_1_1OpAssembleLhsDiagLin.html" title="Assemble linear (symmetric) part of the diagonal block of the LHS Operator for assembling linear (sym...">NavierStokesElement::OpAssembleLhsDiagLin</a>,</li>
<li><a class="el" href="structNavierStokesElement_1_1OpAssembleLhsDiagNonLin.html" title="Assemble non-linear (non-symmetric) part of the diagonal block of the LHS Operator for assembling non...">NavierStokesElement::OpAssembleLhsDiagNonLin</a>,</li>
<li><a class="el" href="structNavierStokesElement_1_1OpAssembleLhsOffDiag.html" title="Assemble off-diagonal block of the LHS Operator for assembling off-diagonal block of the LHS.">NavierStokesElement::OpAssembleLhsOffDiag</a>.</li>
</ul>
<p>Upon that, we setup in the same way elements for computing the drag traction and the drag force acting on the sphere using operators <a class="el" href="structNavierStokesElement_1_1OpCalcDragTraction.html" title="Calculate drag traction on the fluid-solid interface.">NavierStokesElement::OpCalcDragTraction</a> and <a class="el" href="structNavierStokesElement_1_1OpCalcDragForce.html" title="Calculate drag force on the fluid-solid interface.">NavierStokesElement::OpCalcDragForce</a>, respectively. Additionally, operators for the Neumann boundary conditions are set using the function <a class="el" href="structMetaNeumannForces.html#ad0f272e64b6937cc53769ecaa409d8b1" title="Set operators to finite elements calculating right hand side vector.">MetaNeumannForces::setMomentumFluxOperators</a> and the element for the Dirichlet boundary conditions is created as well. Finally, operators for post-processing output are created: in the volume and on the fluid-solid interface.</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a01d2467a1d2600fe714c082b2cc838a5">NavierStokesExample::setupElementInstances</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a> = boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt;(</div>
<div class="line">      <span class="keyword">new</span> VolumeElementForcesAndSourcesCore(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>));</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a> = boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt;(</div>
<div class="line">      <span class="keyword">new</span> VolumeElementForcesAndSourcesCore(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a>-&gt;getRuleHook = <a class="code hl_struct" href="structNavierStokesElement_1_1VolRule.html">NavierStokesElement::VolRule</a>();</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a>-&gt;getRuleHook = <a class="code hl_struct" href="structNavierStokesElement_1_1VolRule.html">NavierStokesElement::VolRule</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *<a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                     <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *<a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                     <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a06cf93399978e44184ff99192a2a12bc">feDragPtr</a> = boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt;(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_class" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>));</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a922b7b49a8ff7c932abf2970dcea6353">feDragSidePtr</a> = boost::shared_ptr&lt;VolumeElementForcesAndSourcesCoreOnSide&gt;(</div>
<div class="line">      <span class="keyword">new</span> VolumeElementForcesAndSourcesCoreOnSide(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a06cf93399978e44184ff99192a2a12bc">feDragPtr</a>-&gt;getRuleHook = <a class="code hl_struct" href="structNavierStokesElement_1_1FaceRule.html">NavierStokesElement::FaceRule</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *<a class="code hl_variable" href="structNavierStokesExample.html#a922b7b49a8ff7c932abf2970dcea6353">feDragSidePtr</a>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                     <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">isStokesFlow</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesElement.html#aaa3297a47cdc6f40faf7d17a1e95ba47">NavierStokesElement::setStokesOperators</a>(</div>
<div class="line">        <a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a>, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesElement.html#a9c21126c87d7a7005ef7d36ba830d6d8">NavierStokesElement::setNavierStokesOperators</a>(</div>
<div class="line">        <a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a>, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="structNavierStokesElement.html#a15c9c384e42aa7fdcb8754ccba2f5ad1">NavierStokesElement::setCalcDragOperators</a>(<a class="code hl_variable" href="structNavierStokesExample.html#a06cf93399978e44184ff99192a2a12bc">feDragPtr</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a922b7b49a8ff7c932abf2970dcea6353">feDragSidePtr</a>,</div>
<div class="line">                                            <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>,</div>
<div class="line">                                            <span class="stringliteral">&quot;PRESSURE&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a> = boost::shared_ptr&lt;DirichletDisplacementBc&gt;(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structDirichletDisplacementBc.html">DirichletDisplacementBc</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a>, <a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a>));</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>-&gt;methodsOp.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structNavierStokesElement_1_1LoadScale.html">NavierStokesElement::LoadScale</a>());</div>
<div class="line">  <span class="comment">// dirichletBcPtr-&gt;snes_ctx = FEMethod::CTX_SNESNONE;</span></div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>-&gt;snes_x = <a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Assemble pressure and traction forces</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMetaNeumannForces.html#ad0f272e64b6937cc53769ecaa409d8b1">MetaNeumannForces::setMomentumFluxOperators</a>(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <a class="code hl_variable" href="structNavierStokesExample.html#abadabff990b673227892d6133f24cab2">neumannForces</a>,</div>
<div class="line">                                                     NULL, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// for postprocessing:</span></div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a> = boost::make_shared&lt;PostProcVol&gt;(<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *<a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                     <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> v_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> pos_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateVectorFieldValues&lt;3&gt;(<span class="stringliteral">&quot;VELOCITY&quot;</span>, v_ptr));</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateVectorFieldGradient&lt;3, 3&gt;(<span class="stringliteral">&quot;VELOCITY&quot;</span>, grad_ptr));</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateScalarFieldValues(<span class="stringliteral">&quot;PRESSURE&quot;</span>, p_ptr));</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateVectorFieldValues&lt;3&gt;(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, pos_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPPMap</a> = OpPostProcMapInMoab&lt;3, 3&gt;;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getPostProcMesh(), <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;PRESSURE&quot;</span>, p_ptr}},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;VELOCITY&quot;</span>, v_ptr}, {<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, pos_ptr}},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;VELOCITY_GRAD&quot;</span>, grad_ptr}},</div>
<div class="line"> </div>
<div class="line">          {}</div>
<div class="line"> </div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  fePostProcDragPtr = boost::make_shared&lt;PostProcFace&gt;(mField);</div>
<div class="line">  fePostProcDragPtr-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateVectorFieldValues&lt;3&gt;(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, pos_ptr));</div>
<div class="line">  fePostProcDragPtr-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">          fePostProcDragPtr-&gt;getPostProcMesh(),</div>
<div class="line">          fePostProcDragPtr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, pos_ptr}},</div>
<div class="line"> </div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {}</div>
<div class="line"> </div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesElement.html#a8b82236b78a04fb80cdb84b59d566aa7">NavierStokesElement::setPostProcDragOperators</a>(</div>
<div class="line">      fePostProcDragPtr, feDragSidePtr, <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <span class="stringliteral">&quot;PRESSURE&quot;</span>,</div>
<div class="line">      commonData);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="aclassFaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition</b> <a href="HODataOperators_8hpp_source.html#l00678">HODataOperators.hpp:678</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="astructDirichletDisplacementBc_html"><div class="ttname"><a href="structDirichletDisplacementBc.html">DirichletDisplacementBc</a></div><div class="ttdoc">Set Dirichlet boundary conditions on displacements.</div><div class="ttdef"><b>Definition</b> <a href="DirichletBC_8hpp_source.html#l00057">DirichletBC.hpp:57</a></div></div>
<div class="ttc" id="astructMetaNeumannForces_html_ad0f272e64b6937cc53769ecaa409d8b1"><div class="ttname"><a href="structMetaNeumannForces.html#ad0f272e64b6937cc53769ecaa409d8b1">MetaNeumannForces::setMomentumFluxOperators</a></div><div class="ttdeci">static MoFEMErrorCode setMomentumFluxOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, NeumannForcesSurface &gt; &amp;neumann_forces, Vec F, const std::string field_name, const std::string mesh_nodals_positions=&quot;MESH_NODE_POSITIONS&quot;)</div><div class="ttdoc">Set operators to finite elements calculating right hand side vector.</div><div class="ttdef"><b>Definition</b> <a href="SurfacePressure_8cpp_source.html#l02069">SurfacePressure.cpp:2069</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00709">PostProcBrokenMeshInMoabBase.hpp:709</a></div></div>
<div class="ttc" id="astructNavierStokesElement_1_1FaceRule_html"><div class="ttname"><a href="structNavierStokesElement_1_1FaceRule.html">NavierStokesElement::FaceRule</a></div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8hpp_source.html#l00267">NavierStokesElement.hpp:267</a></div></div>
<div class="ttc" id="astructNavierStokesElement_1_1LoadScale_html"><div class="ttname"><a href="structNavierStokesElement_1_1LoadScale.html">NavierStokesElement::LoadScale</a></div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8hpp_source.html#l00100">NavierStokesElement.hpp:100</a></div></div>
<div class="ttc" id="astructNavierStokesElement_1_1VolRule_html"><div class="ttname"><a href="structNavierStokesElement_1_1VolRule.html">NavierStokesElement::VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8hpp_source.html#l00261">NavierStokesElement.hpp:261</a></div></div>
<div class="ttc" id="astructNavierStokesElement_html_a15c9c384e42aa7fdcb8754ccba2f5ad1"><div class="ttname"><a href="structNavierStokesElement.html#a15c9c384e42aa7fdcb8754ccba2f5ad1">NavierStokesElement::setCalcDragOperators</a></div><div class="ttdeci">static MoFEMErrorCode setCalcDragOperators(boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; dragFe, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCoreOnSide &gt; sideDragFe, std::string side_fe_name, const std::string velocity_field, const std::string pressure_field, boost::shared_ptr&lt; CommonData &gt; common_data)</div><div class="ttdoc">Setting up operators for calculating drag force on the solid surface.</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8cpp_source.html#l00150">NavierStokesElement.cpp:150</a></div></div>
<div class="ttc" id="astructNavierStokesElement_html_a8b82236b78a04fb80cdb84b59d566aa7"><div class="ttname"><a href="structNavierStokesElement.html#a8b82236b78a04fb80cdb84b59d566aa7">NavierStokesElement::setPostProcDragOperators</a></div><div class="ttdeci">static MoFEMErrorCode setPostProcDragOperators(boost::shared_ptr&lt; PostProcFace &gt; postProcDragPtr, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCoreOnSide &gt; sideDragFe, std::string side_fe_name, const std::string velocity_field, const std::string pressure_field, boost::shared_ptr&lt; CommonData &gt; common_data)</div><div class="ttdoc">Setting up operators for post processing output of drag traction.</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8cpp_source.html#l00184">NavierStokesElement.cpp:184</a></div></div>
<div class="ttc" id="astructNavierStokesElement_html_a9c21126c87d7a7005ef7d36ba830d6d8"><div class="ttname"><a href="structNavierStokesElement.html#a9c21126c87d7a7005ef7d36ba830d6d8">NavierStokesElement::setNavierStokesOperators</a></div><div class="ttdeci">static MoFEMErrorCode setNavierStokesOperators(boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; feRhs, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; feLhs, const std::string velocity_field, const std::string pressure_field, boost::shared_ptr&lt; CommonData &gt; common_data, const EntityType type=MBTET)</div><div class="ttdoc">Setting up operators for solving Navier-Stokes equations.</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8cpp_source.html#l00022">NavierStokesElement.cpp:22</a></div></div>
<div class="ttc" id="astructNavierStokesElement_html_aaa3297a47cdc6f40faf7d17a1e95ba47"><div class="ttname"><a href="structNavierStokesElement.html#aaa3297a47cdc6f40faf7d17a1e95ba47">NavierStokesElement::setStokesOperators</a></div><div class="ttdeci">static MoFEMErrorCode setStokesOperators(boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; feRhs, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; feLhs, const std::string velocity_field, const std::string pressure_field, boost::shared_ptr&lt; CommonData &gt; common_data, const EntityType type=MBTET)</div><div class="ttdoc">Setting up operators for solving Stokes equations.</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8cpp_source.html#l00079">NavierStokesElement.cpp:79</a></div></div>
</div><!-- fragment --><p>Note that the class for enforcing Dirichlet boundary conditions <a class="el" href="structDirichletDisplacementBc.html" title="Set Dirichlet boundary conditions on displacements.">DirichletDisplacementBc</a> used in the snippet above requires the algebraic data structures for storing components of the right-hand side vector, left-hand side matrix and the solution vector. Therefore, these data structures need to be created beforehand using PETSc:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a7e6e8aa883f1a157f519c73a987ffba1">NavierStokesExample::setupAlgebraicStructures</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>);</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a> = <a class="code hl_function" href="namespaceMoFEM.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>);</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a> = <a class="code hl_function" href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">createDMMatrix</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetOption(<a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a>, MAT_SPD, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(<a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8hpp_source.html#l01102">DMMoFEM.hpp:1102</a></div></div>
<div class="ttc" id="agroup__dm_html_gad0c8678dac27b8ef08e604406ba783c7"><div class="ttname"><a href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">MoFEM::createDMMatrix</a></div><div class="ttdeci">auto createDMMatrix(DM dm)</div><div class="ttdoc">Get smart matrix from DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8hpp_source.html#l01059">DMMoFEM.hpp:1059</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a681e912e2d0043503d2da810dc186d73"><div class="ttname"><a href="namespaceMoFEM.html#a681e912e2d0043503d2da810dc186d73">MoFEM::vectorDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; vectorDuplicate(Vec vec)</div><div class="ttdoc">Create duplicate vector of smart vector.</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00221">PetscSmartObj.hpp:221</a></div></div>
</div><!-- fragment --><p>However, one may note that creation of PETSCc vectors and matrices requires the instance of the <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> Discrete Manager (DM), which needs a certain setup as well:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a02a47f622ca0f8e9618eb365514be269">NavierStokesExample::setupDiscreteManager</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  DMType dm_name = <span class="stringliteral">&quot;DM_NAVIER_STOKES&quot;</span>;</div>
<div class="line">  <span class="comment">// Register DM problem</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, dm_name);</div>
<div class="line">  <span class="comment">// Create DM instance</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, dm_name, <a class="code hl_variable" href="structNavierStokesExample.html#a8ab4b23c32716e16ad1775381d411163">bitLevel</a>);</div>
<div class="line">  <span class="comment">// Configure DM form line command options s</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>);</div>
<div class="line">  <span class="comment">// Add elements to dM (only one here)</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;DRAG&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<span class="stringliteral">&quot;PRESSURE_FE&quot;</span>))</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;PRESSURE_FE&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a4e446687c7d05a813b636b510a7d3b43">isPartitioned</a>);</div>
<div class="line">  <span class="comment">// setup the DM</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01113">DMMoFEM.cpp:1113</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00488">DMMoFEM.cpp:488</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a63fc22416f2a0fbdea7406d3aa21fd17"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a63fc22416f2a0fbdea7406d3aa21fd17">MoFEM::CoreInterface::check_finite_element</a></div><div class="ttdeci">virtual bool check_finite_element(const std::string &amp;name) const =0</div><div class="ttdoc">Check if finite element is in database.</div></div>
</div><!-- fragment --><p>Finally, the last preparatory step required is the setup of the SNES functionality:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#a46f8457e7b5e5ab929db8475c1a87249">NavierStokesExample::setupSNES</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  boost::ptr_map&lt;std::string, NeumannForcesSurface&gt;::iterator mit =</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#abadabff990b673227892d6133f24cab2">neumannForces</a>.begin();</div>
<div class="line">  <span class="keywordflow">for</span> (; mit != <a class="code hl_variable" href="structNavierStokesExample.html#abadabff990b673227892d6133f24cab2">neumannForces</a>.end(); mit++) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">DMMoFEMSNESSetFunction</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, mit-&gt;first.c_str(),</div>
<div class="line">                                  &amp;mit-&gt;second-&gt;getLoopFe(), NULL, NULL);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; null_fe;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">DMMoFEMSNESSetFunction</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#aaa4f62b3022fcea58ea314659da2e013">feRhsPtr</a>, null_fe,</div>
<div class="line">                                null_fe);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">DMMoFEMSNESSetFunction</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <a class="code hl_define" href="DMMoFEM_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, null_fe, null_fe,</div>
<div class="line">                                <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">DMMoFEMSNESSetJacobian</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <a class="code hl_define" href="DMMoFEM_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, null_fe, <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>,</div>
<div class="line">                                null_fe);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">DMMoFEMSNESSetJacobian</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a28267d1c5f2db8dbf38a48b9bbe05fd9">feLhsPtr</a>, null_fe,</div>
<div class="line">                                null_fe);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">DMMoFEMSNESSetJacobian</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <a class="code hl_define" href="DMMoFEM_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, null_fe, null_fe,</div>
<div class="line">                                <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>);</div>
<div class="line"> </div>
<div class="line">  SnesCtx *snes_ctx;</div>
<div class="line">  <span class="comment">// create snes nonlinear solver</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESCreate(PETSC_COMM_WORLD, &amp;<a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gad3fd04d49e1c12dd37f8052245b8e653">DMMoFEMGetSnesCtx</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, &amp;snes_ctx);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFunction(<a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a52c6563adf7ea6b26d76bf93637325e5">F</a>, <a class="code hl_function" href="namespaceMoFEM.html#a50531f1fc6bfb68b4756a88126df316e">SnesRhs</a>, snes_ctx);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetJacobian(<a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>, <a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a>, <a class="code hl_variable" href="structNavierStokesExample.html#afffb02721eadd37bc9afd40383195e53">Aij</a>, <a class="code hl_function" href="namespaceMoFEM.html#a2427b40a8745afeb2073f72d9d51584e">SnesMat</a>, snes_ctx);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFromOptions(<a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="aDMMoFEM_8hpp_html_a8643d43312bdd9afb90733cfdcc77cf9"><div class="ttname"><a href="DMMoFEM_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a></div><div class="ttdeci">#define DM_NO_ELEMENT</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8hpp_source.html#l00010">DMMoFEM.hpp:10</a></div></div>
<div class="ttc" id="agroup__dm_html_ga2289e53ec5efa90a46dc702b9c7bc9f4"><div class="ttname"><a href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">MoFEM::DMMoFEMSNESSetFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSNESSetFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set SNES residual evaluation function</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00708">DMMoFEM.cpp:708</a></div></div>
<div class="ttc" id="agroup__dm_html_ga7bb674a8c2feaf3c80814b0d980fec1c"><div class="ttname"><a href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">MoFEM::DMMoFEMSNESSetJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSNESSetJacobian(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set SNES Jacobian evaluation function</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00749">DMMoFEM.cpp:749</a></div></div>
<div class="ttc" id="agroup__dm_html_gad3fd04d49e1c12dd37f8052245b8e653"><div class="ttname"><a href="group__dm.html#gad3fd04d49e1c12dd37f8052245b8e653">MoFEM::DMMoFEMGetSnesCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetSnesCtx(DM dm, MoFEM::SnesCtx **snes_ctx)</div><div class="ttdoc">get MoFEM::SnesCtx data structure</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l01084">DMMoFEM.cpp:1084</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2427b40a8745afeb2073f72d9d51584e"><div class="ttname"><a href="namespaceMoFEM.html#a2427b40a8745afeb2073f72d9d51584e">MoFEM::SnesMat</a></div><div class="ttdeci">PetscErrorCode SnesMat(SNES snes, Vec x, Mat A, Mat B, void *ctx)</div><div class="ttdoc">This is MoFEM implementation for the left hand side (tangent matrix) evaluation in SNES solver.</div><div class="ttdef"><b>Definition</b> <a href="SnesCtx_8cpp_source.html#l00142">SnesCtx.cpp:142</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a50531f1fc6bfb68b4756a88126df316e"><div class="ttname"><a href="namespaceMoFEM.html#a50531f1fc6bfb68b4756a88126df316e">MoFEM::SnesRhs</a></div><div class="ttdeci">PetscErrorCode SnesRhs(SNES snes, Vec x, Vec f, void *ctx)</div><div class="ttdoc">This is MoFEM implementation for the right hand side (residual vector) evaluation in SNES solver.</div><div class="ttdef"><b>Definition</b> <a href="SnesCtx_8cpp_source.html#l00027">SnesCtx.cpp:27</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="navier_stokes_running_solving_problem"></a>
Solving the problem and post-processing the results</h2>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#adafe18cf9f87b240c7e5d522415651a9">NavierStokesExample::solveProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> scale_problem = [&amp;](<span class="keywordtype">double</span> U, <span class="keywordtype">double</span> <a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>, <span class="keywordtype">double</span> P) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;FieldBlas&gt;()-&gt;fieldScale(<a class="code hl_variable" href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">L</a>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    ProjectionFieldOn10NodeTet ent_method_on_10nodeTet(</div>
<div class="line">        <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <span class="keyword">true</span>, <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_on_10nodeTet);</div>
<div class="line">    ent_method_on_10nodeTet.setNodes = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_on_10nodeTet);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;FieldBlas&gt;()-&gt;fieldScale(U, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;FieldBlas&gt;()-&gt;fieldScale(P, <span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">pressureScale</a> = <a class="code hl_variable" href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">viscosity</a> * <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a> / <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>;</div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesElement_1_1LoadScale.html#ac8ed24a49e1ce35f3a68728a15bdc57d">NavierStokesElement::LoadScale::lambda</a> = 1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> scale_problem(1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>, 1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>,</div>
<div class="line">                       1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">pressureScale</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">step</a> = 0;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Viscosity: %6.4e\n&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">viscosity</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Density: %6.4e\n&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#aa314bfd43bbfee365eabcac44c0f73a7">density</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Length scale: %6.4e\n&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Velocity scale: %6.4e\n&quot;</span>,</div>
<div class="line">                     <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Pressure scale: %6.4e\n&quot;</span>,</div>
<div class="line">                     <a class="code hl_variable" href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">pressureScale</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">isStokesFlow</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Re number: 0 (Stokes flow)\n&quot;</span>);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Re number: %6.4e\n&quot;</span>,</div>
<div class="line">                       <a class="code hl_variable" href="structNavierStokesExample.html#aa314bfd43bbfee365eabcac44c0f73a7">density</a> / <a class="code hl_variable" href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">viscosity</a> * <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a> * <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="structNavierStokesExample.html#a752dd04499c920647b688e18e12eca3b">lambdaStep</a> = 1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#a7ecaa982eced739534344de5015d1acf">numSteps</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (<a class="code hl_variable" href="structNavierStokesExample.html#ab1851070923971f66267bd1d21b1d95e">lambda</a> &lt; 1.0 - 1e-12) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="structNavierStokesExample.html#ab1851070923971f66267bd1d21b1d95e">lambda</a> += <a class="code hl_variable" href="structNavierStokesExample.html#a752dd04499c920647b688e18e12eca3b">lambdaStep</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#a1d2cf68679f1cc86cb32099e7545396d">isStokesFlow</a>) {</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#ae49034df9fb49b2b24d5f4c1e9dd7039">reNumber</a> = 0.0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> : <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData) {</div>
<div class="line">        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.inertiaCoef = 0.0;</div>
<div class="line">        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.viscousCoef = 1.0;</div>
<div class="line">      }</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_variable" href="structNavierStokesExample.html#ae49034df9fb49b2b24d5f4c1e9dd7039">reNumber</a> = <a class="code hl_variable" href="structNavierStokesExample.html#aa314bfd43bbfee365eabcac44c0f73a7">density</a> / <a class="code hl_variable" href="structNavierStokesExample.html#a30e9c2e7f9e97884a31a10dfde241f31">viscosity</a> * <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a> * <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a> * <a class="code hl_variable" href="structNavierStokesExample.html#ab1851070923971f66267bd1d21b1d95e">lambda</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> : <a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;setOfBlocksData) {</div>
<div class="line">        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.inertiaCoef = <a class="code hl_variable" href="structNavierStokesExample.html#ae49034df9fb49b2b24d5f4c1e9dd7039">reNumber</a>;</div>
<div class="line">        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.second.viscousCoef = 1.0;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(</div>
<div class="line">        PETSC_COMM_WORLD,</div>
<div class="line">        <span class="stringliteral">&quot;Step: %d | Lambda: %6.4e | Inc: %6.4e | Re number: %6.4e \n&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">step</a>,</div>
<div class="line">        <a class="code hl_variable" href="structNavierStokesExample.html#ab1851070923971f66267bd1d21b1d95e">lambda</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a752dd04499c920647b688e18e12eca3b">lambdaStep</a>, <a class="code hl_variable" href="structNavierStokesExample.html#ae49034df9fb49b2b24d5f4c1e9dd7039">reNumber</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a633de4aa1f49685c441c69c9c0571151">dirichletBcPtr</a>.get());</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSolve(<a class="code hl_variable" href="structNavierStokesExample.html#a027c1da77f604ef046d2767fbff1e3d5">snes</a>, PETSC_NULLPTR, <a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gad94692d0472b346672a25c63e91fb930">DMoFEMMeshToGlobalVector</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <a class="code hl_variable" href="structNavierStokesExample.html#aff53d71e1b2de272dbe543c185eb4aa9">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> scale_problem(<a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>, <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>, <a class="code hl_variable" href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">pressureScale</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structNavierStokesExample.html#ae74f1de1197604f9981ec446b4f7b06d">postProcess</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> scale_problem(1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#a6ca6a8b2facaa6eab5f40deefb58d74b">velocityScale</a>, 1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#ad6c7e5a9e752de18c424d0ef8792d190">lengthScale</a>,</div>
<div class="line">                         1.0 / <a class="code hl_variable" href="structNavierStokesExample.html#a70ea0f7930b870ce5a90df7b9495f853">pressureScale</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">step</a>++;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="agroup__dm_html_gad94692d0472b346672a25c63e91fb930"><div class="ttname"><a href="group__dm.html#gad94692d0472b346672a25c63e91fb930">MoFEM::DMoFEMMeshToGlobalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToGlobalVector(DM dm, Vec g, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set ghosted vector values on all existing mesh entities</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00525">DMMoFEM.cpp:525</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00536">DMMoFEM.cpp:536</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a123875fb03925a9640697591e972412c"><div class="ttname"><a href="namespaceMoFEM.html#a123875fb03925a9640697591e972412c">MoFEM::L</a></div><div class="ttdeci">VectorDouble L</div><div class="ttdef"><b>Definition</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00124">Projection10NodeCoordsOnField.cpp:124</a></div></div>
<div class="ttc" id="astructNavierStokesElement_1_1LoadScale_html_ac8ed24a49e1ce35f3a68728a15bdc57d"><div class="ttname"><a href="structNavierStokesElement_1_1LoadScale.html#ac8ed24a49e1ce35f3a68728a15bdc57d">NavierStokesElement::LoadScale::lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition</b> <a href="NavierStokesElement_8hpp_source.html#l00102">NavierStokesElement.hpp:102</a></div></div>
</div><!-- fragment --><div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structNavierStokesExample.html#ae74f1de1197604f9981ec446b4f7b06d">NavierStokesExample::postProcess</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">string</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;NAVIER_STOKES&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>);</div>
<div class="line">  {</div>
<div class="line">    std::ostringstream stm;</div>
<div class="line">    stm &lt;&lt; <span class="stringliteral">&quot;out_&quot;</span> &lt;&lt; <a class="code hl_variable" href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">step</a> &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">    <a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a> = stm.str();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Write file %s\n&quot;</span>,</div>
<div class="line">                       <a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a>.c_str());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#ad7dc94efdcf07be4b1839854af0bd836">fePostProcPtr</a>-&gt;writeFile(<a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a>.c_str());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;pressureDragForceVec);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;shearDragForceVec);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;totalDragForceVec);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;DRAG&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a06cf93399978e44184ff99192a2a12bc">feDragPtr</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_vec_data = [&amp;](<span class="keyword">auto</span> vec, std::array&lt;double, 3&gt; &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(vec);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(vec);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> *array;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(vec, &amp;array);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> : {0, 1, 2})</div>
<div class="line">        data[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] = array[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>];</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(vec, &amp;array);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  std::array&lt;double, 3&gt; pressure_drag;</div>
<div class="line">  std::array&lt;double, 3&gt; shear_drag;</div>
<div class="line">  std::array&lt;double, 3&gt; total_drag;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_vec_data(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;pressureDragForceVec, pressure_drag);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_vec_data(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;shearDragForceVec, shear_drag);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_vec_data(<a class="code hl_variable" href="structNavierStokesExample.html#a55fca530e7dcfbaaa1e45255e14d4d50">commonData</a>-&gt;totalDragForceVec, total_drag);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="structNavierStokesExample.html#abd281524b993c4d7442ad3143e94f864">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">    <a class="code hl_define" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::inform,</div>
<div class="line">                <span class="stringliteral">&quot;Pressure drag force: [ %6.4e, %6.4e, %6.4e ]&quot;</span>,</div>
<div class="line">                pressure_drag[0], pressure_drag[1], pressure_drag[2]);</div>
<div class="line">    <a class="code hl_define" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::inform,</div>
<div class="line">                <span class="stringliteral">&quot;Shear drag force: [ %6.4e, %6.4e, %6.4e ]&quot;</span>, shear_drag[0],</div>
<div class="line">                shear_drag[1], shear_drag[2]);</div>
<div class="line">    <a class="code hl_define" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::inform,</div>
<div class="line">                <span class="stringliteral">&quot;Total drag force: [ %6.4e, %6.4e, %6.4e ]&quot;</span>, total_drag[0],</div>
<div class="line">                total_drag[1], total_drag[2]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="structNavierStokesExample.html#af53bd240bc022396d9b39009e4f8791c">dM</a>, <span class="stringliteral">&quot;DRAG&quot;</span>, <a class="code hl_variable" href="structNavierStokesExample.html#a0e2e033173b9426ebd3922b3e4d79545">fePostProcDragPtr</a>);</div>
<div class="line">  {</div>
<div class="line">    std::ostringstream stm;</div>
<div class="line">    stm &lt;&lt; <span class="stringliteral">&quot;out_drag_&quot;</span> &lt;&lt; <a class="code hl_variable" href="structNavierStokesExample.html#aeba64ce62699b12d8eb99aca742c8600">step</a> &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">    <a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a> = stm.str();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;out file %s\n&quot;</span>,</div>
<div class="line">                       <a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a>.c_str());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structNavierStokesExample.html#a0e2e033173b9426ebd3922b3e4d79545">fePostProcDragPtr</a>-&gt;writeFile(<a class="code hl_variable" href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="aLogManager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00319">LogManager.hpp:319</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00576">DMMoFEM.cpp:576</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a33ed7b84e277f2f5ed3d14dd0792d980"><div class="ttname"><a href="initial__diffusion_8cpp.html#a33ed7b84e277f2f5ed3d14dd0792d980">out_file_name</a></div><div class="ttdeci">char out_file_name[255]</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00053">initial_diffusion.cpp:53</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
</div><!-- fragment --><h1><a class="anchor" id="navier_stokes_running"></a>
Running the example</h1>
<p>We will consider two cases: first, flow governed by Stokes equation, i.e. neglecting the nonlinear terms, and then we will solve full set Navier-Stokes equations. For both cases we will use the same mesh. We will start by partitioning this mesh: </p><div class="fragment"><div class="line">mofem_part -my_file sphere_test.cub -my_nparts 4 -output_file sphere_test_4.h5m</div>
</div><!-- fragment --><p> while <code>mofem_part</code> can be found in <code>$HOME/mofem_install/um/build_release/tools/</code>. Here we partitioned the mesh in 4 parts in order to be executed on 4 cores in a distributed-memory parallel environment. Note that any number of parts less or equal to number of physically available cores can be used.</p>
<h2><a class="anchor" id="navier_stokes_running_stokes"></a>
Stokes equation</h2>
<div class="fragment"><div class="line">mpirun -np 4 ./navier_stokes -my_file sphere_test_4.h5m \</div>
<div class="line">-my_order_u 2 \</div>
<div class="line">-my_order_p 1 \</div>
<div class="line">-my_discont_pressure 0 \</div>
<div class="line">-my_num_ho_levels 1 \</div>
<div class="line">-my_ho_geometry 1 \</div>
<div class="line">-my_step_num 1 \</div>
<div class="line">-my_velocity_scale 0.1 \</div>
<div class="line">-my_length_scale 2 \</div>
<div class="line">-my_stokes_flow 1 \</div>
<div class="line">-my_is_partitioned 1 </div>
</div><!-- fragment --><h2><a class="anchor" id="navier_stokes_running_navier_stokes"></a>
Navier-Stokes equations</h2>
<div class="fragment"><div class="line">mpirun -np 4 ./navier_stokes -my_file sphere_test_4.h5m \</div>
<div class="line">-my_order_u 2 \</div>
<div class="line">-my_order_p 1 \</div>
<div class="line">-my_discont_pressure 0 \</div>
<div class="line">-my_num_ho_levels 1 \</div>
<div class="line">-my_ho_geometry 1 \</div>
<div class="line">-my_step_num 2 \</div>
<div class="line">-my_velocity_scale 0.1 \</div>
<div class="line">-my_length_scale 2 \</div>
<div class="line">-my_stokes_flow 0 \</div>
<div class="line">-my_is_partitioned 1 </div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>