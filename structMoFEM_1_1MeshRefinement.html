<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: MoFEM::MeshRefinement Struct Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespaceMoFEM.html">MoFEM</a></li><li class="navelem"><a class="el" href="structMoFEM_1_1MeshRefinement.html">MeshRefinement</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-methods">Private Member Functions</a> &#124;
<a href="structMoFEM_1_1MeshRefinement-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">MoFEM::MeshRefinement Struct Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Mesh refinement interface.  
 <a href="structMoFEM_1_1MeshRefinement.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="MeshRefinement_8hpp_source.html">src/interfaces/MeshRefinement.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MoFEM::MeshRefinement:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="structMoFEM_1_1MeshRefinement__inherit__graph.svg" width="208" height="112"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for MoFEM::MeshRefinement:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="structMoFEM_1_1MeshRefinement__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div></div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement_1_1SetParent.html">SetParent</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a87963d4ac1fb6a4c2581601eb468df41"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a87963d4ac1fb6a4c2581601eb468df41">query_interface</a> (boost::typeindex::type_index type_index, <a class="el" href="structMoFEM_1_1UnknownInterface.html">UnknownInterface</a> **iface) const</td></tr>
<tr class="separator:a87963d4ac1fb6a4c2581601eb468df41"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc1c0624a680f8b3a092b67ce1cbaf9a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#adc1c0624a680f8b3a092b67ce1cbaf9a">MeshRefinement</a> (const <a class="el" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a> &amp;core)</td></tr>
<tr class="separator:adc1c0624a680f8b3a092b67ce1cbaf9a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a48aa52d6af0dc3acfdc6449175fd0b92"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a48aa52d6af0dc3acfdc6449175fd0b92">~MeshRefinement</a> ()=default</td></tr>
<tr class="separator:a48aa52d6af0dc3acfdc6449175fd0b92"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed88f73c43b3030907ce108217c39e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#aaed88f73c43b3030907ce108217c39e7">addVerticesInTheMiddleOfEdges</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, const <a class="el" href="classbool.html">bool</a> recursive=false, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="el" href="classEntityHandle.html">EntityHandle</a> start_v=0)</td></tr>
<tr class="memdesc:aaed88f73c43b3030907ce108217c39e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">make vertices in the middle of edges in meshset and add them to refinement levels defined by bit  <a href="structMoFEM_1_1MeshRefinement.html#aaed88f73c43b3030907ce108217c39e7">More...</a><br /></td></tr>
<tr class="separator:aaed88f73c43b3030907ce108217c39e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abecb0c64720ede297b9fe79d74db4bdb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#abecb0c64720ede297b9fe79d74db4bdb">addVerticesInTheMiddleOfEdges</a> (const <a class="el" href="classRange.html">Range</a> &amp;edges, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="el" href="classEntityHandle.html">EntityHandle</a> start_v=0)</td></tr>
<tr class="memdesc:abecb0c64720ede297b9fe79d74db4bdb"><td class="mdescLeft">&#160;</td><td class="mdescRight">make vertices in the middle of edges in meshset and add them to Refinement levels defined by bit  <a href="structMoFEM_1_1MeshRefinement.html#abecb0c64720ede297b9fe79d74db4bdb">More...</a><br /></td></tr>
<tr class="separator:abecb0c64720ede297b9fe79d74db4bdb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f731867b68b721d54096ceced3b9947"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">refineTets</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:a7f731867b68b721d54096ceced3b9947"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TET in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">More...</a><br /></td></tr>
<tr class="separator:a7f731867b68b721d54096ceced3b9947"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac6b18f2d69cf2f25215fafc1544fc23f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ac6b18f2d69cf2f25215fafc1544fc23f">refineTets</a> (const <a class="el" href="classRange.html">Range</a> &amp;tets, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:ac6b18f2d69cf2f25215fafc1544fc23f"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TET in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#ac6b18f2d69cf2f25215fafc1544fc23f">More...</a><br /></td></tr>
<tr class="separator:ac6b18f2d69cf2f25215fafc1544fc23f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09a7265b095507adb3cd048fef065c49"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a09a7265b095507adb3cd048fef065c49">refineTetsHangingNodes</a> (const <a class="el" href="classRange.html">Range</a> &amp;tets, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:a09a7265b095507adb3cd048fef065c49"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TET in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#a09a7265b095507adb3cd048fef065c49">More...</a><br /></td></tr>
<tr class="separator:a09a7265b095507adb3cd048fef065c49"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17d56bbf9ab356aba0a581fccb3eca8a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a17d56bbf9ab356aba0a581fccb3eca8a">refineTetsHangingNodes</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:a17d56bbf9ab356aba0a581fccb3eca8a"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TET in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#a17d56bbf9ab356aba0a581fccb3eca8a">More...</a><br /></td></tr>
<tr class="separator:a17d56bbf9ab356aba0a581fccb3eca8a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad078e42b9e22612bbb32c1ba8e848155"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ad078e42b9e22612bbb32c1ba8e848155">refinePrisms</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>)</td></tr>
<tr class="memdesc:ad078e42b9e22612bbb32c1ba8e848155"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine PRISM in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#ad078e42b9e22612bbb32c1ba8e848155">More...</a><br /></td></tr>
<tr class="separator:ad078e42b9e22612bbb32c1ba8e848155"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec94c437e26a154407da37750ffcc57e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#aec94c437e26a154407da37750ffcc57e">refineMeshset</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, const <a class="el" href="classbool.html">bool</a> recursive=false, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>)</td></tr>
<tr class="memdesc:aec94c437e26a154407da37750ffcc57e"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine meshset, i.e. add child of refined entities to meshset  <a href="structMoFEM_1_1MeshRefinement.html#aec94c437e26a154407da37750ffcc57e">More...</a><br /></td></tr>
<tr class="separator:aec94c437e26a154407da37750ffcc57e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5238748a7c161ef7a01d6368a2d4606"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ae5238748a7c161ef7a01d6368a2d4606">refineTris</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:ae5238748a7c161ef7a01d6368a2d4606"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine triangles in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#ae5238748a7c161ef7a01d6368a2d4606">More...</a><br /></td></tr>
<tr class="separator:ae5238748a7c161ef7a01d6368a2d4606"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe81ea15693a52b6a86618cdcfae24a6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#abe81ea15693a52b6a86618cdcfae24a6">refineTris</a> (const <a class="el" href="classRange.html">Range</a> &amp;tris, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:abe81ea15693a52b6a86618cdcfae24a6"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TRI in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#abe81ea15693a52b6a86618cdcfae24a6">More...</a><br /></td></tr>
<tr class="separator:abe81ea15693a52b6a86618cdcfae24a6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad40ca4d3b2040548c6c400f0fbb773fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ad40ca4d3b2040548c6c400f0fbb773fb">refineTrisHangingNodes</a> (const <a class="el" href="classEntityHandle.html">EntityHandle</a> meshset, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:ad40ca4d3b2040548c6c400f0fbb773fb"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TRI in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#ad40ca4d3b2040548c6c400f0fbb773fb">More...</a><br /></td></tr>
<tr class="separator:ad40ca4d3b2040548c6c400f0fbb773fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3b710bad56f16ccf520af07cc643b5e8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a3b710bad56f16ccf520af07cc643b5e8">refineTrisHangingNodes</a> (const <a class="el" href="classRange.html">Range</a> &amp;tris, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>=false)</td></tr>
<tr class="memdesc:a3b710bad56f16ccf520af07cc643b5e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TRI in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#a3b710bad56f16ccf520af07cc643b5e8">More...</a><br /></td></tr>
<tr class="separator:a3b710bad56f16ccf520af07cc643b5e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_structMoFEM_1_1UnknownInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_structMoFEM_1_1UnknownInterface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="structMoFEM_1_1UnknownInterface.html">MoFEM::UnknownInterface</a></td></tr>
<tr class="memitem:a5da6216311219ca884defbc048260a20 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a5da6216311219ca884defbc048260a20 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#a5da6216311219ca884defbc048260a20">registerInterface</a> (<a class="el" href="classbool.html">bool</a> error_if_registration_failed=true)</td></tr>
<tr class="memdesc:a5da6216311219ca884defbc048260a20 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register interface.  <a href="structMoFEM_1_1UnknownInterface.html#a5da6216311219ca884defbc048260a20">More...</a><br /></td></tr>
<tr class="separator:a5da6216311219ca884defbc048260a20 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a> (IFACE *&amp;iface) const</td></tr>
<tr class="memdesc:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get interface reference to pointer of interface.  <a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">More...</a><br /></td></tr>
<tr class="separator:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#a66d5ce701795486330f2c1e93c98ece4">getInterface</a> (IFACE **const iface) const</td></tr>
<tr class="memdesc:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get interface pointer to pointer of interface.  <a href="structMoFEM_1_1UnknownInterface.html#a66d5ce701795486330f2c1e93c98ece4">More...</a><br /></td></tr>
<tr class="separator:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplParams" colspan="2">template&lt;class IFACE , typename boost::enable_if&lt; boost::is_pointer&lt; IFACE &gt;, int &gt;::type  = 0&gt; </td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplItemLeft" align="right" valign="top">IFACE&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a> () const</td></tr>
<tr class="memdesc:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get interface pointer to pointer of interface.  <a href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">More...</a><br /></td></tr>
<tr class="separator:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplParams" colspan="2">template&lt;class IFACE , typename boost::enable_if&lt; boost::is_reference&lt; IFACE &gt;, int &gt;::type  = 0&gt; </td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplItemLeft" align="right" valign="top">IFACE&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a> () const</td></tr>
<tr class="memdesc:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference to interface.  <a href="structMoFEM_1_1UnknownInterface.html#aeb77113fbaac3d256b13433f2294fa09">More...</a><br /></td></tr>
<tr class="separator:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:addff026a6287de1a2b38c0bfd4765690 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:addff026a6287de1a2b38c0bfd4765690 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memTemplItemLeft" align="right" valign="top">IFACE *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#addff026a6287de1a2b38c0bfd4765690">getInterface</a> () const</td></tr>
<tr class="memdesc:addff026a6287de1a2b38c0bfd4765690 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function returning pointer to interface.  <a href="structMoFEM_1_1UnknownInterface.html#addff026a6287de1a2b38c0bfd4765690">More...</a><br /></td></tr>
<tr class="separator:addff026a6287de1a2b38c0bfd4765690 inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5728f8956c62075d9ad8aa6555cb06a inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#af5728f8956c62075d9ad8aa6555cb06a">~UnknownInterface</a> ()=default</td></tr>
<tr class="separator:af5728f8956c62075d9ad8aa6555cb06a inherit pub_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a4daa2920bdc3908da269639bbd596bad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a></td></tr>
<tr class="separator:a4daa2920bdc3908da269639bbd596bad"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:ae12c9a6d1ea7e86e09166e5707560786"><td class="memItemLeft" align="right" valign="top">using&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">SetEdgeBitsFun</a> = boost::function&lt; <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(moab::Interface &amp;moab, <a class="el" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a> &amp;ref_parent_ents_view, <a class="el" href="classEntityHandle.html">EntityHandle</a> tet, <a class="el" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit, <a class="el" href="classEntityHandle.html">EntityHandle</a> *edge_new_nodes, int *split_edges)&gt;</td></tr>
<tr class="memdesc:ae12c9a6d1ea7e86e09166e5707560786"><td class="mdescLeft">&#160;</td><td class="mdescRight">Functions setting edges for refinemnt on enetity level.  <a href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">More...</a><br /></td></tr>
<tr class="separator:ae12c9a6d1ea7e86e09166e5707560786"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pri-methods"></a>
Private Member Functions</h2></td></tr>
<tr class="memitem:a536cfd7b3509e0a1175b888babe854dc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a536cfd7b3509e0a1175b888babe854dc">refineTets</a> (const <a class="el" href="classRange.html">Range</a> &amp;tets, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="el" href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">SetEdgeBitsFun</a> set_edge_bits, int verb, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</td></tr>
<tr class="memdesc:a536cfd7b3509e0a1175b888babe854dc"><td class="mdescLeft">&#160;</td><td class="mdescRight">refine TET in the meshset  <a href="structMoFEM_1_1MeshRefinement.html#a536cfd7b3509e0a1175b888babe854dc">More...</a><br /></td></tr>
<tr class="separator:a536cfd7b3509e0a1175b888babe854dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23595b69d84b993f2f878f1af48102a8"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1MeshRefinement.html#a23595b69d84b993f2f878f1af48102a8">refineTris</a> (const <a class="el" href="classRange.html">Range</a> &amp;tris, const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="el" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="el" href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">SetEdgeBitsFun</a> set_edge_bits, int verb, const <a class="el" href="classbool.html">bool</a> <a class="el" href="wavy__surface_8cpp.html#ac3e1795766a80ec63b157951b4b9a7d4">debug</a>)</td></tr>
<tr class="separator:a23595b69d84b993f2f878f1af48102a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_structMoFEM_1_1UnknownInterface"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_structMoFEM_1_1UnknownInterface')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="structMoFEM_1_1UnknownInterface.html">MoFEM::UnknownInterface</a></td></tr>
<tr class="memitem:a52e77a14ba06bf15c0de1281b61b211f inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#a52e77a14ba06bf15c0de1281b61b211f">getLibVersion</a> (<a class="el" href="structMoFEM_1_1Version.html">Version</a> &amp;version)</td></tr>
<tr class="memdesc:a52e77a14ba06bf15c0de1281b61b211f inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get library version.  <a href="structMoFEM_1_1UnknownInterface.html#a52e77a14ba06bf15c0de1281b61b211f">More...</a><br /></td></tr>
<tr class="separator:a52e77a14ba06bf15c0de1281b61b211f inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3766a882d10e8f8fe3f63e56c990f12 inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#af3766a882d10e8f8fe3f63e56c990f12">getFileVersion</a> (moab::Interface &amp;moab, <a class="el" href="structMoFEM_1_1Version.html">Version</a> &amp;version)</td></tr>
<tr class="memdesc:af3766a882d10e8f8fe3f63e56c990f12 inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get database major version.  <a href="structMoFEM_1_1UnknownInterface.html#af3766a882d10e8f8fe3f63e56c990f12">More...</a><br /></td></tr>
<tr class="separator:af3766a882d10e8f8fe3f63e56c990f12 inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9d9a60ce5c323f4ca7c2f2a993be72 inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#a9e9d9a60ce5c323f4ca7c2f2a993be72">setFileVersion</a> (moab::Interface &amp;moab, <a class="el" href="structMoFEM_1_1Version.html">Version</a> version=<a class="el" href="structMoFEM_1_1Version.html">Version</a>(MoFEM_VERSION_MAJOR, MoFEM_VERSION_MINOR, MoFEM_VERSION_BUILD))</td></tr>
<tr class="memdesc:a9e9d9a60ce5c323f4ca7c2f2a993be72 inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get database major version.  <a href="structMoFEM_1_1UnknownInterface.html#a9e9d9a60ce5c323f4ca7c2f2a993be72">More...</a><br /></td></tr>
<tr class="separator:a9e9d9a60ce5c323f4ca7c2f2a993be72 inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8da5f391105ea953e4b3f2fcd7600d inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structMoFEM_1_1UnknownInterface.html#aee8da5f391105ea953e4b3f2fcd7600d">getInterfaceVersion</a> (<a class="el" href="structMoFEM_1_1Version.html">Version</a> &amp;version)</td></tr>
<tr class="memdesc:aee8da5f391105ea953e4b3f2fcd7600d inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get database major version.  <a href="structMoFEM_1_1UnknownInterface.html#aee8da5f391105ea953e4b3f2fcd7600d">More...</a><br /></td></tr>
<tr class="separator:aee8da5f391105ea953e4b3f2fcd7600d inherit pub_static_methods_structMoFEM_1_1UnknownInterface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Mesh refinement interface. </p>
<p>Currently this class is abstraction to Core interface. In future should be outsourced as independent interface.</p>
<dl class="bug"><dt><b><a class="el" href="bug.html#_bug000006">Bug:</a></b></dt><dd><p class="startdd">Not working on partitioned meshes </p>
<p class="interdd">Need to be implemented as a stand alone interface not as a part of core structure which should be only basic database </p>
<p class="interdd">If outsourced, class member functions should follow name convention </p>
<p class="enddd">Spelling mistakes will be corrected with names fix to follow name convetion</p>
</dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="bernstein_bezier_generate_base_8cpp-example.html#_a59">bernstein_bezier_generate_base.cpp</a>, <a class="el" href="child_and_parent_8cpp-example.html#_a60">child_and_parent.cpp</a>, <a class="el" href="EshelbianPlasticity_8cpp-example.html#_a46">EshelbianPlasticity.cpp</a>, <a class="el" href="hanging_node_approx_8cpp-example.html#_a60">hanging_node_approx.cpp</a>, and <a class="el" href="split_sideset_8cpp-example.html#_a22">split_sideset.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8hpp_source.html#l00026">26</a> of file <a class="el" href="MeshRefinement_8hpp_source.html">MeshRefinement.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="ae12c9a6d1ea7e86e09166e5707560786"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae12c9a6d1ea7e86e09166e5707560786">&#9670;&nbsp;</a></span>SetEdgeBitsFun</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">using <a class="el" href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">MoFEM::MeshRefinement::SetEdgeBitsFun</a> =  boost::function&lt; <a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(moab::Interface &amp;moab, <a class="el" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a> &amp;ref_parent_ents_view, <a class="el" href="classEntityHandle.html">EntityHandle</a> tet, <a class="el" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit, <a class="el" href="classEntityHandle.html">EntityHandle</a> *edge_new_nodes, int *split_edges )&gt;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Functions setting edges for refinemnt on enetity level. </p>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8hpp_source.html#l00203">203</a> of file <a class="el" href="MeshRefinement_8hpp_source.html">MeshRefinement.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="adc1c0624a680f8b3a092b67ce1cbaf9a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc1c0624a680f8b3a092b67ce1cbaf9a">&#9670;&nbsp;</a></span>MeshRefinement()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MoFEM::MeshRefinement::MeshRefinement </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a> &amp;&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00039">39</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    : <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>(<span class="keyword">const_cast&lt;</span><a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">Core</a> &amp;<span class="keyword">&gt;</span>(core)) {}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a48aa52d6af0dc3acfdc6449175fd0b92"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a48aa52d6af0dc3acfdc6449175fd0b92">&#9670;&nbsp;</a></span>~MeshRefinement()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual MoFEM::MeshRefinement::~MeshRefinement </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">default</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="aaed88f73c43b3030907ce108217c39e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaed88f73c43b3030907ce108217c39e7">&#9670;&nbsp;</a></span>addVerticesInTheMiddleOfEdges() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::addVerticesInTheMiddleOfEdges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>recursive</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>start_v</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>make vertices in the middle of edges in meshset and add them to refinement levels defined by bit </p>
<p>Takes entities fromm meshsets and queried recursively (get entities from meshsets in meshsets, usually have to be used for CUBIT meshset). If meshset does not contain any edges, get entities in dimension 3 and get edge adjacencies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EntityHandle</td><td>meshset </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">recursive</td><td>If true, meshsets containing meshsets are queried recursively. Returns the contents of meshsets, but not the meshsets themselves if true. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00042">42</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;                                    {</div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <a class="code" href="classRange.html">Range</a> edges;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBEDGE, edges, recursive);</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  <span class="keywordflow">if</span> (edges.empty()) {</div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;    <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBTET, tets, recursive);</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(tets, 1, <span class="keyword">true</span>, edges, moab::Interface::UNION);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;    <span class="keywordflow">if</span> (tets.empty()) {</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;      <a class="code" href="classRange.html">Range</a> prisms;</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBPRISM, prisms, recursive);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;      <span class="keywordflow">for</span> (Range::iterator pit = prisms.begin(); pit != prisms.end(); pit++) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;        <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(*pit, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;        assert(num_nodes == 6);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        <a class="code" href="classRange.html">Range</a> edge;</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;conn[0], 2, 1, <span class="keyword">true</span>, edge);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;        assert(edge.size() == 1);</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        edges.insert(edge[0]);</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        edge.clear();</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;conn[1], 2, 1, <span class="keyword">true</span>, edge);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        assert(edge.size() == 1);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;        edges.insert(edge[0]);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        <a class="code" href="classEntityHandle.html">EntityHandle</a> conn_edge2[] = {conn[2], conn[0]};</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        edge.clear();</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(conn_edge2, 2, 1, <span class="keyword">true</span>, edge);</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;        assert(edge.size() == 1);</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        edges.insert(edge[0]);</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="comment">//</span></div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;        edge.clear();</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;conn[3], 2, 1, <span class="keyword">true</span>, edge);</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;        assert(edge.size() == 1);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;        edges.insert(edge[0]);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;        edge.clear();</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;conn[4], 2, 1, <span class="keyword">true</span>, edge);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;        assert(edge.size() == 1);</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;        edges.insert(edge[0]);</div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        <a class="code" href="classEntityHandle.html">EntityHandle</a> conn_edge8[] = {conn[5], conn[3]};</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;        edge.clear();</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(conn_edge8, 2, 1, <span class="keyword">true</span>, edge);</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;        assert(edge.size() == 1);</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;        edges.insert(edge[0]);</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;      }</div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;  }</div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#aaed88f73c43b3030907ce108217c39e7">addVerticesInTheMiddleOfEdges</a>(edges, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb, start_v);</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abecb0c64720ede297b9fe79d74db4bdb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abecb0c64720ede297b9fe79d74db4bdb">&#9670;&nbsp;</a></span>addVerticesInTheMiddleOfEdges() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::addVerticesInTheMiddleOfEdges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>start_v</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>make vertices in the middle of edges in meshset and add them to Refinement levels defined by bit </p>
<p>Takes entities from meshsets and queried recursively (get entities from meshsets in meshsets, usually have to be used for CUBIT meshset). If meshset does not contain any edges, get entities in dimension 3 and get edge adjacencies.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>consisting edges for refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">recursive</td><td>If true, meshsets containing meshsets are queried recursively. Returns the contents of meshsets, but not the meshsets themselves if true. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00096">96</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;                                                                               {</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <span class="keyword">auto</span> refined_ents_ptr = m_field.get_ref_ents();</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;  <span class="keyword">auto</span> miit =</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;      refined_ents_ptr-&gt;get&lt;Composite_EntType_and_ParentEntType_mi_tag&gt;()</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;          .lower_bound(boost::make_tuple(MBVERTEX, MBEDGE));</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  <span class="keyword">auto</span> hi_miit =</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;      refined_ents_ptr-&gt;get&lt;Composite_EntType_and_ParentEntType_mi_tag&gt;()</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;          .upper_bound(boost::make_tuple(MBVERTEX, MBEDGE));</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;  <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a> ref_parent_ents_view;</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  ref_parent_ents_view.insert(miit, hi_miit);</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;  <a class="code" href="classRange.html">Range</a> edges = ents.subset_by_type(MBEDGE);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>) {</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    <a class="code" href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::verbose, <span class="stringliteral">&quot;MeshRefinemnt&quot;</span>)</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;ref level &quot;</span> &lt;&lt; <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> &lt;&lt; <span class="stringliteral">&quot; nb. edges to refine &quot;</span> &lt;&lt; edges.size();</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;  }</div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160; </div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  std::array&lt;std::vector&lt;double&gt;, 3&gt; vert_coords;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;vc : vert_coords)</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    vc.reserve(edges.size());</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160; </div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  std::vector&lt;EntityHandle&gt; parent_edge;</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  parent_edge.reserve(edges.size());</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160; </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;  std::array&lt;double, 9&gt; coords;</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, 3&gt; t_0 = {</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;      &amp;coords[0], &amp;coords[1], &amp;coords[2]};</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, 3&gt; t_1 = {</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;      &amp;coords[3], &amp;coords[4], &amp;coords[5]};</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, 3&gt; t_2 = {</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;      &amp;coords[6], &amp;coords[7], &amp;coords[8]};</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; </div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160; </div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;  <a class="code" href="classRange.html">Range</a> add_bit;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p_eit = edges.pair_begin(); p_eit != edges.pair_end(); ++p_eit) {</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keyword">auto</span> miit_view = ref_parent_ents_view.lower_bound(p_eit-&gt;first);</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <a class="code" href="classRange.html">Range</a> edge_having_parent_vertex;</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keywordflow">if</span> (miit_view != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> hi_miit_view = ref_parent_ents_view.upper_bound(p_eit-&gt;second);</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;           miit_view != hi_miit_view; ++miit_view) {</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        edge_having_parent_vertex.insert(edge_having_parent_vertex.end(),</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                                         miit_view-&gt;get()-&gt;getParentEnt());</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        add_bit.insert(add_bit.end(), miit_view-&gt;get()-&gt;getEnt());</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;      }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    }</div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <a class="code" href="classRange.html">Range</a> add_vertex_edges =</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        subtract(<a class="code" href="classRange.html">Range</a>(p_eit-&gt;first, p_eit-&gt;second), edge_having_parent_vertex);</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160; </div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : add_vertex_edges)</div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;      parent_edge.emplace_back(e);</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : add_vertex_edges) {</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;      <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(e, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;      <span class="keywordflow">if</span>(num_nodes == 2) {</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, coords.data());</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;        t_0(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += t_1(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;        t_0(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= 0.5;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> : {0, 1, 2})</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;          vert_coords[<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>].emplace_back(t_0(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160; </div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (num_nodes == 3) {</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;       <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a> : {0, 1, 2})</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;         vert_coords[<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>].emplace_back(t_2(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        SETERRQ1(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                <span class="stringliteral">&quot;edge should have 2 or 3 nodes but have %d&quot;</span>, num_nodes);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      }</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    }</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;  }</div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;addBitRefLevel(add_bit, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  <span class="keywordflow">if</span> (!vert_coords[0].empty()) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    ReadUtilIface *read_util;</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.query_interface(read_util);</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    <span class="keywordtype">int</span> num_nodes = vert_coords[0].size();</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;    vector&lt;double *&gt; arrays_coord;</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> read_util-&gt;get_node_coords(3, num_nodes, 0, start_v, arrays_coord);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    <a class="code" href="classRange.html">Range</a> verts(start_v, start_v + num_nodes - 1);</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> : {0, 1, 2}) {</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;      std::copy(vert_coords[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>].begin(), vert_coords[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>].end(),</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;                arrays_coord[<a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>]);</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    }</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aadccd33cfe35eabc29b09ca61ee3bb8d">get_th_RefParentHandle</a>(), verts,</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;                             &amp;*parent_edge.begin());</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;setEntitiesBitRefLevel(</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        verts, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;  }</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a87963d4ac1fb6a4c2581601eb468df41"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87963d4ac1fb6a4c2581601eb468df41">&#9670;&nbsp;</a></span>query_interface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::query_interface </td>
          <td>(</td>
          <td class="paramtype">boost::typeindex::type_index&#160;</td>
          <td class="paramname"><em>type_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMoFEM_1_1UnknownInterface.html">UnknownInterface</a> **&#160;</td>
          <td class="paramname"><em>iface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="structMoFEM_1_1UnknownInterface.html#a525e4d5a451a5bb8c5437d0dd2588de6">MoFEM::UnknownInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00033">33</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                                                                {</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;  *iface = <span class="keyword">const_cast&lt;</span><a class="code" href="structMoFEM_1_1MeshRefinement.html#adc1c0624a680f8b3a092b67ce1cbaf9a">MeshRefinement</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aec94c437e26a154407da37750ffcc57e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec94c437e26a154407da37750ffcc57e">&#9670;&nbsp;</a></span>refineMeshset()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineMeshset </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>recursive</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine meshset, i.e. add child of refined entities to meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EntityHandle</td><td>meshset where to save the child refined entities </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">recursive</td><td>If true, meshsets containing meshsets are queried recursively. Returns the contents of meshsets, but not the meshsets themselves if true. </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00904">904</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;                                                                             {</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;  <span class="keyword">auto</span> refined_ents_ptr = m_field.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a35d6c5d5dafd27e4d50977a7f06fd721">get_ref_ents</a>();</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;  <span class="keyword">auto</span> miit = refined_ents_ptr-&gt;find(meshset);</div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;  <span class="keywordflow">if</span> (miit == refined_ents_ptr-&gt;end()) {</div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;    SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;            <span class="stringliteral">&quot;this meshset is not in ref database&quot;</span>);</div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;  }</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;updateMeshsetByEntitiesChildren(</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;      meshset, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, meshset, MBMAXTYPE, recursive, verb);</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;  *(<span class="keyword">const_cast&lt;</span><a class="code" href="namespaceMoFEM.html#a523973b7327b193907630d512416e465">RefEntity</a> *<span class="keyword">&gt;</span>(miit-&gt;get())-&gt;getBitRefLevelPtr()) |= <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad078e42b9e22612bbb32c1ba8e848155"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad078e42b9e22612bbb32c1ba8e848155">&#9670;&nbsp;</a></span>refinePrisms()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refinePrisms </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine PRISM in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EntityHandle</td><td>meshset </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00722">722</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;                                                                              {</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160; </div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;  <span class="keyword">auto</span> refined_ents_ptr = m_field.get_ref_ents();</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;  <span class="keyword">auto</span> refined_finite_elements_ptr = m_field.get_ref_finite_elements();</div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160; </div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;  <span class="comment">// FIXME: refinement is based on entity handlers, should work on global ids of</span></div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <span class="comment">// nodes, this will allow parallelise algorithm in the future</span></div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160; </div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160; </div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <a class="code" href="namespaceMoFEM.html#ab15ad170c468b14e1a1ff743b4e38029">RefElement_multiIndex_parents_view</a> ref_ele_parent_view;</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  ref_ele_parent_view.insert(</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      refined_finite_elements_ptr-&gt;get&lt;Ent_mi_tag&gt;().lower_bound(</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;          get_id_for_min_type&lt;MBPRISM&gt;()),</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      refined_finite_elements_ptr-&gt;get&lt;Ent_mi_tag&gt;().upper_bound(</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;          get_id_for_max_type&lt;MBPRISM&gt;()));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  <span class="keyword">auto</span> &amp;ref_ele_by_parent_and_ref_edges =</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      ref_ele_parent_view</div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;          .get&lt;Composite_ParentEnt_And_BitsOfRefinedEdges_mi_tag&gt;();</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;  <span class="comment">// find all vertices which parent is edge</span></div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <span class="keyword">auto</span> &amp;ref_ents_by_comp =</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      refined_ents_ptr-&gt;get&lt;Composite_EntType_and_ParentEntType_mi_tag&gt;();</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;  <a class="code" href="group__ent__multi__indices.html#ga1a17dceefed036770efecfe8c9b6c28b">RefEntity_multiIndex_view_by_hashed_parent_entity</a> ref_parent_ents_view;</div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  ref_parent_ents_view.insert(</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      ref_ents_by_comp.lower_bound(boost::make_tuple(MBVERTEX, MBEDGE)),</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      ref_ents_by_comp.upper_bound(boost::make_tuple(MBVERTEX, MBEDGE)));</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;  <a class="code" href="classRange.html">Range</a> prisms;</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBPRISM, prisms, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;  Range::iterator pit = prisms.begin();</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">for</span> (; pit != prisms.end(); pit++) {</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <span class="keyword">auto</span> miit_prism = refined_ents_ptr-&gt;get&lt;Ent_mi_tag&gt;().find(*pit);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (miit_prism == refined_ents_ptr-&gt;end()) {</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;              <span class="stringliteral">&quot;this prism is not in ref database&quot;</span>);</div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    }</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a>) {</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;      <a class="code" href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::noisy, <span class="stringliteral">&quot;MeshRefinment&quot;</span>)</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          &lt;&lt; <span class="stringliteral">&quot;ref prism &quot;</span> &lt;&lt; **miit_prism;</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;    }</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="comment">// prism connectivity</span></div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(*pit, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    assert(num_nodes == 6);</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;    <span class="comment">// edges connectivity</span></div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> edges[6];</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee &lt; 3; ee++) {</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(*pit, 1, ee, edges[ee]);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    }</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 6; ee &lt; 9; ee++) {</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(*pit, 1, ee, edges[ee - 3]);</div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    }</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;    <span class="comment">// detect split edges</span></div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> split_edges(0);</div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> edge_nodes[6];</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    std::fill(&amp;edge_nodes[0], &amp;edge_nodes[6], <a class="code" href="namespaceMoFEM.html#ac4e6ecdc1c4668e5613f6e1ec821ddb3">no_handle</a>);</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee &lt; 6; ee++) {</div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      RefEntity_multiIndex_view_by_hashed_parent_entity::iterator miit_view =</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;          ref_parent_ents_view.find(edges[ee]);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">if</span> (miit_view != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;        <span class="keywordflow">if</span> (((*miit_view)-&gt;getBitRefLevel() &amp; <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>).any()) {</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;          edge_nodes[ee] = (*miit_view)-&gt;getEnt();</div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;          split_edges.set(ee);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;        }</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      }</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    <span class="keywordflow">if</span> (split_edges.count() == 0) {</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;      *(<span class="keyword">const_cast&lt;</span><a class="code" href="namespaceMoFEM.html#a523973b7327b193907630d512416e465">RefEntity</a> *<span class="keyword">&gt;</span>(miit_prism-&gt;get())-&gt;getBitRefLevelPtr()) |= <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>;</div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caec6eb52aa79824668fa314f4d08cf2fa">VERY_NOISY</a>)</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::noisy, <span class="stringliteral">&quot;MeshRefinment&quot;</span>)</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;            &lt;&lt; <span class="stringliteral">&quot;no refinement&quot;</span>;</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    }</div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;    <span class="comment">// check consistency</span></div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a>) {</div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      std::ostringstream ss;</div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      ss &lt;&lt; <span class="stringliteral">&quot;prism split edges &quot;</span> &lt;&lt; split_edges &lt;&lt; <span class="stringliteral">&quot; count &quot;</span></div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;         &lt;&lt; split_edges.count() &lt;&lt; std::endl;</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;      PetscPrintf(m_field.get_comm(), ss.str().c_str());</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;    }</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;    <span class="comment">// prism ref</span></div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> new_prism_conn[4 * 6];</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;    std::fill(&amp;new_prism_conn[0], &amp;new_prism_conn[4 * 6], <a class="code" href="namespaceMoFEM.html#ac4e6ecdc1c4668e5613f6e1ec821ddb3">no_handle</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;    <span class="keywordtype">int</span> nb_new_prisms = 0;</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;    <span class="keywordflow">switch</span> (split_edges.count()) {</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    <span class="keywordflow">case</span> 0:</div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;    <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a789889a6f2cb8b9c8c913af51e9eb01e">prism_type_1</a>(conn, split_edges, edge_nodes, new_prism_conn);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;      nb_new_prisms = 2;</div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a39dac1cd7f89f16e2aa8c69ba54e5539">prism_type_2</a>(conn, split_edges, edge_nodes, new_prism_conn);</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;      nb_new_prisms = 3;</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5319bbceb3b4a69ca34345ea709c1219">prism_type_3</a>(conn, split_edges, edge_nodes, new_prism_conn);</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      nb_new_prisms = 4;</div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      std::ostringstream ss;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      ss &lt;&lt; split_edges &lt;&lt; <span class="stringliteral">&quot; : [ &quot;</span> &lt;&lt; conn[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; conn[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;         &lt;&lt; conn[2] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; conn[3] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; conn[4] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; conn[5]</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;         &lt;&lt; <span class="stringliteral">&quot; ]&quot;</span>;</div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, ss.str().c_str());</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;    }</div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="comment">// find that prism</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    std::bitset&lt;4&gt; ref_prism_bit(0);</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keyword">auto</span> it_by_ref_edges = ref_ele_by_parent_and_ref_edges.lower_bound(</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;        boost::make_tuple(*pit, split_edges.to_ulong()));</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keyword">auto</span> hi_it_by_ref_edges = ref_ele_by_parent_and_ref_edges.upper_bound(</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;        boost::make_tuple(*pit, split_edges.to_ulong()));</div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keyword">auto</span> it_by_ref_edges2 = it_by_ref_edges;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pp = 0; it_by_ref_edges2 != hi_it_by_ref_edges;</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;         it_by_ref_edges2++, pp++) {</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;      <span class="comment">// Add this tet to this ref</span></div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;      *(<span class="keyword">const_cast&lt;</span>RefElement *<span class="keyword">&gt;</span>(it_by_ref_edges2-&gt;get())</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;            -&gt;getBitRefLevelPtr()) |= <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;      ref_prism_bit.set(pp, 1);</div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;      <span class="keywordflow">if</span> (verb &gt; 2) {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;        std::ostringstream ss;</div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;        ss &lt;&lt; <span class="stringliteral">&quot;is refined &quot;</span> &lt;&lt; *it_by_ref_edges2 &lt;&lt; std::endl;</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;        PetscPrintf(m_field.get_comm(), ss.str().c_str());</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;      }</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    }</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    <span class="keywordflow">if</span> (it_by_ref_edges != hi_it_by_ref_edges) {</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;      <span class="keywordflow">if</span> (ref_prism_bit.count() != (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span>)nb_new_prisms)</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;                <span class="stringliteral">&quot;data inconsistency&quot;</span>);</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> ref_prisms[4];</div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      <span class="comment">// create prism</span></div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pp = 0; pp &lt; nb_new_prisms; pp++) {</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;        <span class="keywordflow">if</span> (verb &gt; 3) {</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;          std::ostringstream ss;</div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;          ss &lt;&lt; <span class="stringliteral">&quot;ref prism &quot;</span> &lt;&lt; ref_prism_bit &lt;&lt; std::endl;</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;          PetscPrintf(m_field.get_comm(), ss.str().c_str());</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;        }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        <span class="keywordflow">if</span> (!ref_prism_bit.test(pp)) {</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_element(MBPRISM, &amp;new_prism_conn[6 * pp], 6,</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;                                     ref_prisms[pp]);</div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aadccd33cfe35eabc29b09ca61ee3bb8d">get_th_RefParentHandle</a>(),</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;                                   &amp;ref_prisms[pp], 1, &amp;*pit);</div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a98496cceb4ec90958e3feda396153995">get_th_RefBitLevel</a>(), &amp;ref_prisms[pp],</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;                                   1, &amp;<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#af605d4886120656680ac43a9d3fb0cd1">get_th_RefBitEdge</a>(), &amp;ref_prisms[pp], 1,</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;                                   &amp;split_edges);</div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <span class="keyword">auto</span> p_ent =</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;              <span class="keyword">const_cast&lt;</span><a class="code" href="group__ent__multi__indices.html#ga405fd80b03c5eda19a361d380dda09a8">RefEntity_multiIndex</a> *<span class="keyword">&gt;</span>(refined_ents_ptr)</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;                  -&gt;insert(boost::shared_ptr&lt;RefEntity&gt;(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM.html#a523973b7327b193907630d512416e465">RefEntity</a>(</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;                      m_field.get_basic_entity_data_ptr(), ref_prisms[pp])));</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          std::pair&lt;RefElement_multiIndex::iterator, bool&gt; p_fe;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;            p_fe =</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;                <span class="keyword">const_cast&lt;</span><a class="code" href="group__fe__multi__indices.html#ga12ff75dfcc19a2bf1474ab91c8ed4b13">RefElement_multiIndex</a> *<span class="keyword">&gt;</span>(refined_finite_elements_ptr)</div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;                    -&gt;insert(boost::shared_ptr&lt;RefElement&gt;(</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;                        <span class="keyword">new</span> RefElement_PRISM(*p_ent.first)));</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;          } <span class="keywordflow">catch</span> (MoFEMException <span class="keyword">const</span> &amp;e) {</div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;            SETERRQ(PETSC_COMM_SELF, e.errorCode, e.errorMessage);</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          }</div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;          ref_prism_bit.set(pp);</div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a767509c84bf6ae4b9ab524183adca634">addPrismToDatabase</a>(ref_prisms[pp]);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <span class="keywordflow">if</span> (verb &gt; 2) {</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            std::ostringstream ss;</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            ss &lt;&lt; <span class="stringliteral">&quot;add prism: &quot;</span> &lt;&lt; **p_fe.first &lt;&lt; std::endl;</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <span class="keywordflow">if</span> (verb &gt; 7) {</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn &lt; 6; nn++) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                ss &lt;&lt; new_prism_conn[nn] &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;              }</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;              ss &lt;&lt; std::endl;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;            }</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;            PetscPrintf(m_field.get_comm(), ss.str().c_str());</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;          }</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        }</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;      }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;    }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;  }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f731867b68b721d54096ceced3b9947"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f731867b68b721d54096ceced3b9947">&#9670;&nbsp;</a></span>refineTets() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TET in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EntityHandle</td><td>meshset </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00197">197</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                                                            {</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBTET, tets, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">refineTets</a>(tets, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac6b18f2d69cf2f25215fafc1544fc23f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac6b18f2d69cf2f25215fafc1544fc23f">&#9670;&nbsp;</a></span>refineTets() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TET in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>of tets to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00244">244</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                                            {</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160; </div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160; </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <span class="keyword">auto</span> set_edge_bits = [](<a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab,</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                          <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                              &amp;ref_parent_ents_view,</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> tet, <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit,</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> *edge_new_nodes, <span class="keywordtype">int</span> *split_edges) {</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != 6; ++ee) {</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> edge;</div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(tet, 1, ee, edge);</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;      <span class="keyword">auto</span> eit = ref_parent_ents_view.find(edge);</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;      <span class="keywordflow">if</span> (eit != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;        edge_new_nodes[ee] = (*eit)-&gt;getEnt();</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;        split_edges[parent_edges_bit.count()] = ee;</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        parent_edges_bit.set(ee, 1);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      }</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;    }</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;  };</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">refineTets</a>(_tets, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, set_edge_bits, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160; </div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a536cfd7b3509e0a1175b888babe854dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a536cfd7b3509e0a1175b888babe854dc">&#9670;&nbsp;</a></span>refineTets() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTets </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">SetEdgeBitsFun</a>&#160;</td>
          <td class="paramname"><em>set_edge_bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>refine TET in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>of tets to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00325">325</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                                                                      {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160; </div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  <span class="keyword">auto</span> refined_ents_ptr = m_field.get_ref_ents();</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  <span class="keyword">auto</span> refined_finite_elements_ptr = m_field.get_ref_finite_elements();</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  ReadUtilIface *read_util;</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().query_interface(read_util);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160; </div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="classRange.html">Range</a> ents_to_set_bit;</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="comment">// FIXME: refinement is based on entity handlers, should work on global ids of</span></div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;  <span class="comment">// nodes, this will allow parallelise algorithm in the future</span></div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="keyword">auto</span> get_parent_ents_view = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> type_child,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                  <span class="keyword">const</span> <span class="keyword">auto</span> type_parent) {</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="keyword">auto</span> &amp;ref_ents =</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;        refined_ents_ptr-&gt;get&lt;Composite_EntType_and_ParentEntType_mi_tag&gt;();</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keyword">auto</span> range =</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;        ref_ents.equal_range(boost::make_tuple(type_child, type_parent));</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160; </div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a> ref_parent_ents_view;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keyword">using</span> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> = decltype(range.first);</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;    boost::function&lt;<a class="code" href="classbool.html">bool</a>(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> it)&gt; tester = [&amp;](<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> it) {</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;      <span class="keywordflow">return</span> ((*it)-&gt;getBitRefLevel() &amp; <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>).any();</div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;    };</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    boost::function&lt;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> s)&gt; inserter = [&amp;](<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> s) {</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;      ref_parent_ents_view.insert(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, s);</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;    };</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160; </div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <a class="code" href="namespaceMoFEM.html#af0da1f0f3794ba7c1c4f22d39452d7e8">rangeInserter</a>(range.first, range.second, tester, inserter);</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;    <span class="keywordflow">return</span> ref_parent_ents_view;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  };</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160; </div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <span class="keyword">auto</span> ref_parent_ents_view = get_parent_ents_view(MBVERTEX, MBEDGE);</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160; </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  <span class="keyword">auto</span> tets = _tets.subset_by_type(MBTET);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160; </div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  <span class="keyword">auto</span> get_ele_parent_view = [&amp;]() {</div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;    <span class="keyword">auto</span> &amp;ref_ents = refined_finite_elements_ptr-&gt;get&lt;Ent_mi_tag&gt;();</div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;    <a class="code" href="namespaceMoFEM.html#ab15ad170c468b14e1a1ff743b4e38029">RefElement_multiIndex_parents_view</a> ref_ele_parent_view;</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = tets.pair_begin(); p != tets.pair_end(); ++p) {</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      <span class="keyword">auto</span> tmi = ref_ents.lower_bound(p-&gt;first);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      <span class="keyword">auto</span> tme = ref_ents.upper_bound(p-&gt;second);</div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      ref_ele_parent_view.insert(tmi, tme);</div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;    }</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span> ref_ele_parent_view;</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;  };</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160; </div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;  <span class="keyword">auto</span> ref_ele_parent_view = get_ele_parent_view();</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; </div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;  std::vector&lt;EntityHandle&gt; parent_tets_refinded;</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;  std::vector&lt;EntityHandle&gt; vertices_of_created_tets;</div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  std::vector&lt;BitRefEdges&gt; parent_edges_bit_vec;</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  std::vector&lt;int&gt; nb_new_tets_vec;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  std::vector&lt;int&gt; sub_type_vec;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160; </div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  parent_tets_refinded.reserve(tets.size());</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  vertices_of_created_tets.reserve(4 * tets.size());</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  parent_edges_bit_vec.reserve(tets.size());</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;  nb_new_tets_vec.reserve(tets.size());</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  sub_type_vec.reserve(tets.size());</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;  <span class="comment">// make loop over all tets which going to be refined</span></div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> tit : tets) {</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    <span class="comment">// get tet connectivity</span></div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tit, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    <span class="comment">// get edges</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> parent_edges_bit(0);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> edge_new_nodes[] = {0, 0, 0, 0, 0, 0};</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keywordtype">int</span> split_edges[] = {-1, -1, -1, -1, -1, -1};</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_edge_bits(moab, ref_parent_ents_view, tit, parent_edges_bit,</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;                         edge_new_nodes, split_edges);</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="keywordflow">if</span> (parent_edges_bit.count()) {</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160; </div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <span class="comment">// swap nodes forward</span></div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> _conn_[4];</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;      std::copy(&amp;conn[0], &amp;conn[4], &amp;_conn_[0]);</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160; </div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <span class="comment">// build connectivity for ref tets</span></div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> new_tets_conns[8 * 4];</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;      std::fill(&amp;new_tets_conns[0], &amp;new_tets_conns[8 * 4], <a class="code" href="namespaceMoFEM.html#ac4e6ecdc1c4668e5613f6e1ec821ddb3">no_handle</a>);</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;      <span class="keywordtype">int</span> sub_type = -1, nb_new_tets = 0;</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <span class="keywordflow">switch</span> (parent_edges_bit.count()) {</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;        sub_type = 0;</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;        <a class="code" href="namespaceMoFEM.html#ae167f5d30580719040fba4e48730ddff">tet_type_1</a>(_conn_, split_edges[0], edge_new_nodes[split_edges[0]],</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                   new_tets_conns);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;        nb_new_tets = 2;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        sub_type =</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;            <a class="code" href="namespaceMoFEM.html#aaff39bae46926a7938069e620fdd0ee3">tet_type_2</a>(_conn_, split_edges, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;        <span class="keywordflow">if</span> (sub_type &amp; (4 | 8 | 16)) {</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          nb_new_tets = 3;</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sub_type == 1) {</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;          nb_new_tets = 4;</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;        };</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;        SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>, <span class="stringliteral">&quot;Impossible case&quot;</span>);</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;        sub_type =</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;            <a class="code" href="namespaceMoFEM.html#a09ec223a6cb950da0f6a573875b6f74e">tet_type_3</a>(_conn_, split_edges, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">if</span> (sub_type &lt;= 4) {</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;          nb_new_tets = 4;</div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sub_type &lt;= 7) {</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;          nb_new_tets = 5;</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;        }</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>, <span class="stringliteral">&quot;Impossible case&quot;</span>);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <span class="keywordflow">case</span> 4:</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        sub_type =</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;            <a class="code" href="namespaceMoFEM.html#ad097466ea27189b837bac98197156a8c">tet_type_4</a>(_conn_, split_edges, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="keywordflow">if</span> (sub_type == 0) {</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;          nb_new_tets = 5;</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sub_type &lt;= 7) {</div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;          nb_new_tets = 6;</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;          <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;        }</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>, <span class="stringliteral">&quot;Impossible case&quot;</span>);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;      <span class="keywordflow">case</span> 5:</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;        sub_type = <a class="code" href="namespaceMoFEM.html#ac43c755594ad65187b20409d2f9e557c">tet_type_5</a>(moab, _conn_, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;        nb_new_tets = 7;</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;      <span class="keywordflow">case</span> 6:</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;        sub_type = 0;</div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;        <a class="code" href="namespaceMoFEM.html#a1b977ce5c042a58ccd7c74b2c2788940">tet_type_6</a>(moab, _conn_, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        nb_new_tets = 8;</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>, <span class="stringliteral">&quot;Impossible case&quot;</span>);</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      }</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160; </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="comment">// find that tets</span></div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      <span class="keyword">auto</span> &amp;ref_ele_by_parent_and_ref_edges =</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;          ref_ele_parent_view</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;              .get&lt;Composite_ParentEnt_And_BitsOfRefinedEdges_mi_tag&gt;();</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;      <span class="keyword">auto</span> it_by_ref_edges = ref_ele_by_parent_and_ref_edges.equal_range(</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;          boost::make_tuple(tit, parent_edges_bit.to_ulong()));</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;      <span class="comment">// check if tet with this refinement scheme already exits</span></div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;      std::vector&lt;EntityHandle&gt; ents_to_set_bit_vec;</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="keywordflow">if</span> (std::distance(it_by_ref_edges.first, it_by_ref_edges.second) ==</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;          <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(nb_new_tets)) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        ents_to_set_bit_vec.reserve(nb_new_tets);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tt = 0; it_by_ref_edges.first != it_by_ref_edges.second;</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;             it_by_ref_edges.first++, tt++) {</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;          <span class="keyword">auto</span> tet = (*it_by_ref_edges.first)-&gt;getEnt();</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;          ents_to_set_bit_vec.emplace_back(tet);</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;          <span class="comment">// set ref tets entities</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;            <span class="comment">// add this tet if exist to this ref level</span></div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;            <span class="keyword">auto</span> ref_tet_it = refined_ents_ptr-&gt;find(tet);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;            <span class="keywordflow">if</span> (ref_tet_it == refined_ents_ptr-&gt;end()) {</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;              SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;                      <span class="stringliteral">&quot;Tetrahedron should be in database&quot;</span>);</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;            }</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          }</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;        }</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        ents_to_set_bit.insert_list(ents_to_set_bit_vec.begin(),</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                    ents_to_set_bit_vec.end());</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        <span class="comment">// if this element was not refined or was refined with different</span></div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <span class="comment">// patterns of split edges create new elements</span></div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160; </div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        parent_tets_refinded.emplace_back(tit);</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tt = 0; tt != nb_new_tets; ++tt) {</div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn : {0, 1, 2, 3})</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            vertices_of_created_tets.emplace_back(new_tets_conns[4 * tt + nn]);</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        parent_edges_bit_vec.emplace_back(parent_edges_bit);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        nb_new_tets_vec.emplace_back(nb_new_tets);</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        sub_type_vec.emplace_back(sub_type);</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      }</div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160; </div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        RefEntity_multiIndex::iterator tit_miit;</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        tit_miit = refined_ents_ptr-&gt;find(tit);</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <span class="keywordflow">if</span> (tit_miit == refined_ents_ptr-&gt;end())</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;          SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;                  <span class="stringliteral">&quot;can not find this tet&quot;</span>);</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;      }</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;      ents_to_set_bit.insert(tit);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;    }</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;  }</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// Create tets</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> start_e = 0;</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn_moab;</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_new_tets = vertices_of_created_tets.size() / 4;</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  read_util-&gt;get_element_connect(nb_new_tets, 4, MBTET, 0, start_e, conn_moab);</div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  std::copy(vertices_of_created_tets.begin(), vertices_of_created_tets.end(),</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            conn_moab);</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> read_util-&gt;update_adjacencies(start_e, nb_new_tets, 4, conn_moab);</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  ents_to_set_bit.insert(start_e, start_e + nb_new_tets - 1);</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160; </div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;  <span class="comment">// Create adj entities</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;  <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> : {1, 2}) {</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents_to_set_bit, <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>, <span class="keyword">true</span>, ents,</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;                                moab::Interface::UNION);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  SetParent set_parent;</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;  <span class="comment">// Set parents and adjacencies</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx != parent_tets_refinded.size(); ++idx) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160; </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> tit = parent_tets_refinded[idx];</div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;    <span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit = parent_edges_bit_vec[idx];</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_new_tets = nb_new_tets_vec[idx];</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160; </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    std::array&lt;EntityHandle, 8&gt; ref_tets;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tt = 0; tt != nb_new_tets; ++tt, ++start_e)</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;      ref_tets[tt] = start_e;</div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">if</span> (nb_new_tets) {</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_clear_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#af605d4886120656680ac43a9d3fb0cd1">get_th_RefBitEdge</a>(), &amp;ref_tets[0],</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;                                 nb_new_tets, &amp;parent_edges_bit);</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_clear_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aadccd33cfe35eabc29b09ca61ee3bb8d">get_th_RefParentHandle</a>(), &amp;ref_tets[0],</div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;                                 nb_new_tets, &amp;tit);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;      <span class="comment">// hash map of nodes (RefEntity) by edges (EntityHandle)</span></div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;      std::map&lt;<a class="code" href="classEntityHandle.html">EntityHandle</a> <span class="comment">/*edge*/</span>, <a class="code" href="classEntityHandle.html">EntityHandle</a> <span class="comment">/*node*/</span>&gt;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;          map_ref_nodes_by_edges;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160; </div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <a class="code" href="classRange.html">Range</a> tit_edges;</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;tit, 1, 1, <span class="keyword">false</span>, tit_edges);</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> edge : tit_edges) {</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        <span class="keyword">auto</span> eit = ref_parent_ents_view.find(edge);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <span class="keywordflow">if</span> (eit != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;          map_ref_nodes_by_edges[(*eit)-&gt;getParentEnt()] = eit-&gt;get()-&gt;getEnt();</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        }</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160; </div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;      <span class="comment">// find parents for new edges and faces</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;      <span class="comment">// get tet edges and faces</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="classRange.html">Range</a> tit_faces;</div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;tit, 1, 2, <span class="keyword">false</span>, tit_faces);</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <a class="code" href="classRange.html">Range</a> edges_nodes[6], faces_nodes[4];</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <span class="comment">// for edges - add ref nodes</span></div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;      <span class="comment">// edges_nodes[ee] - contains all nodes on edge ee including mid nodes if</span></div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;      <span class="comment">// exist</span></div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;      Range::iterator eit = tit_edges.begin();</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; eit != tit_edges.end(); eit++, ee++) {</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;*eit, 1, edges_nodes[ee], <span class="keyword">true</span>);</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;        <span class="keyword">auto</span> map_miit = map_ref_nodes_by_edges.find(*eit);</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="keywordflow">if</span> (map_miit != map_ref_nodes_by_edges.end()) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;          edges_nodes[ee].insert(map_miit-&gt;second);</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        }</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      }</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      <span class="comment">// for faces - add ref nodes</span></div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      <span class="comment">// faces_nodes[ff] - contains all nodes on face ff including mid nodes if</span></div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;      <span class="comment">// exist</span></div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;      Range::iterator fit = tit_faces.begin();</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ff = 0; fit != tit_faces.end(); fit++, ff++) {</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;*fit, 1, faces_nodes[ff], <span class="keyword">true</span>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">// Get edges on face and loop over those edges to add mid-nodes to range</span></div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <a class="code" href="classRange.html">Range</a> fit_edges;</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;*fit, 1, 1, <span class="keyword">false</span>, fit_edges);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="keywordflow">for</span> (Range::iterator eit2 = fit_edges.begin(); eit2 != fit_edges.end();</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;             eit2++) {</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;          <span class="keyword">auto</span> map_miit = map_ref_nodes_by_edges.find(*eit2);</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;          <span class="keywordflow">if</span> (map_miit != map_ref_nodes_by_edges.end()) {</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            faces_nodes[ff].insert(map_miit-&gt;second);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;          }</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;      }</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;      <span class="comment">// add ref nodes to tet</span></div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;      <span class="comment">// tet_nodes contains all nodes on tet including mid edge nodes</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;      <a class="code" href="classRange.html">Range</a> tet_nodes;</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;tit, 1, tet_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;      <span class="keywordflow">for</span> (std::map&lt;EntityHandle, EntityHandle&gt;::iterator map_miit =</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;               map_ref_nodes_by_edges.begin();</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;           map_miit != map_ref_nodes_by_edges.end(); map_miit++) {</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        tet_nodes.insert(map_miit-&gt;second);</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      }</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <a class="code" href="classRange.html">Range</a> ref_edges;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="comment">// Get all all edges of refined tets</span></div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ref_tets.data(), nb_new_tets, 1, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                                  ref_edges, moab::Interface::UNION);</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;      <span class="comment">// Check for all ref edge and set parents</span></div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;      <span class="keywordflow">for</span> (Range::iterator reit = ref_edges.begin(); reit != ref_edges.end();</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;           reit++) {</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;        <a class="code" href="classRange.html">Range</a> ref_edges_nodes;</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;*reit, 1, ref_edges_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160; </div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;        <span class="comment">// Check if ref edge is an coarse edge (loop over coarse tet edges)</span></div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;        <span class="keywordtype">int</span> ee = 0;</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;        <span class="keywordflow">for</span> (; ee &lt; 6; ee++) {</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;          <span class="comment">// Two nodes are common (node[0],node[1],ref_node (if exist))</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;          <span class="comment">// this tests if given edge is contained by edge of refined</span></div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;          <span class="comment">// tetrahedral</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;          <span class="keywordflow">if</span> (intersect(edges_nodes[ee], ref_edges_nodes).size() == 2) {</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;            <a class="code" href="classEntityHandle.html">EntityHandle</a> edge = tit_edges[ee];</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(*reit, edge, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;          }</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;        }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;        <span class="keywordflow">if</span> (ee &lt; 6)</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;          <span class="keywordflow">continue</span>; <span class="comment">// this refined edge is contained by edge of tetrahedral</span></div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;        <span class="comment">// check if ref edge is in coarse face</span></div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;        <span class="keywordtype">int</span> ff = 0;</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;        <span class="keywordflow">for</span> (; ff &lt; 4; ff++) {</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;          <span class="comment">// two nodes are common (node[0],node[1],ref_node (if exist))</span></div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;          <span class="comment">// this tests if given face is contained by face of  tetrahedral</span></div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;          <span class="keywordflow">if</span> (intersect(faces_nodes[ff], ref_edges_nodes).size() == 2) {</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;            <a class="code" href="classEntityHandle.html">EntityHandle</a> face = tit_faces[ff];</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(*reit, face, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;          }</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;        }</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;        <span class="keywordflow">if</span> (ff &lt; 4)</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;          <span class="keywordflow">continue</span>; <span class="comment">// this refined edge is contained by face of tetrahedral</span></div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160; </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;        <span class="comment">// check if ref edge is in coarse tetrahedral (i.e. that is internal</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;        <span class="comment">// edge of refined tetrahedral)</span></div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        <span class="keywordflow">if</span> (intersect(tet_nodes, ref_edges_nodes).size() == 2) {</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(*reit, tit, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;        }</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;        <span class="comment">// Refined edge is not child of any edge, face or tetrahedral, this is</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;        <span class="comment">// Impossible edge</span></div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;        SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;                <span class="stringliteral">&quot;impossible refined edge&quot;</span>);</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;      }</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160; </div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      <a class="code" href="classRange.html">Range</a> ref_faces;</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ref_tets.data(), nb_new_tets, 2, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                  ref_faces, moab::Interface::UNION);</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;      Tag th_interface_side;</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">int</span> def_side[] = {0};</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>, 1, MB_TYPE_INTEGER,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                 th_interface_side,</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                                 MB_TAG_CREAT | MB_TAG_SPARSE, def_side);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="comment">// Check for all ref faces</span></div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> rfit : ref_faces) {</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;        <a class="code" href="classRange.html">Range</a> ref_faces_nodes;</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;rfit, 1, ref_faces_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;        <span class="comment">// Check if ref face is in coarse face</span></div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;        <span class="keywordtype">int</span> ff = 0;</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        <span class="keywordflow">for</span> (; ff &lt; 4; ff++) {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;          <span class="comment">// Check if refined triangle is contained by face of tetrahedral</span></div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;          <span class="keywordflow">if</span> (intersect(faces_nodes[ff], ref_faces_nodes).size() == 3) {</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;            <a class="code" href="classEntityHandle.html">EntityHandle</a> face = tit_faces[ff];</div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(rfit, face, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            <span class="keywordtype">int</span> side = 0;</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;            <span class="comment">// Set face side if it is on interface</span></div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(th_interface_side, &amp;face, 1, &amp;side);</div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(th_interface_side, &amp;rfit, 1, &amp;side);</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;          }</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;        }</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;        <span class="keywordflow">if</span> (ff &lt; 4)</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;          <span class="keywordflow">continue</span>; <span class="comment">// this face is contained by one of tetrahedrons</span></div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;        <span class="comment">// check if ref face is in coarse tetrahedral</span></div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;        <span class="comment">// this is ref face which is contained by tetrahedral volume</span></div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;        <span class="keywordflow">if</span> (intersect(tet_nodes, ref_faces_nodes).size() == 3) {</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(rfit, tit, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;        }</div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;        SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                <span class="stringliteral">&quot;impossible refined face&quot;</span>);</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      }</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    }</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;  }</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160; </div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(refined_ents_ptr);</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;setBitRefLevel(</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      ents_to_set_bit, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">true</span>, verb, &amp;ents);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a17d56bbf9ab356aba0a581fccb3eca8a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17d56bbf9ab356aba0a581fccb3eca8a">&#9670;&nbsp;</a></span>refineTetsHangingNodes() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTetsHangingNodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TET in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>of tets to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00313">313</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                                         {</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="classRange.html">Range</a> tets;</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBTET, tets, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#a09a7265b095507adb3cd048fef065c49">refineTetsHangingNodes</a>(tets, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09a7265b095507adb3cd048fef065c49"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09a7265b095507adb3cd048fef065c49">&#9670;&nbsp;</a></span>refineTetsHangingNodes() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTetsHangingNodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TET in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>of tets to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00276">276</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;                                                                        {</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160; </div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;  <span class="keyword">auto</span> set_edge_bits = [](<a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab,</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                          <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a></div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                              &amp;ref_parent_ents_view,</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> tet, <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit,</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> *edge_new_nodes, <span class="keywordtype">int</span> *split_edges) {</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != 6; ++ee) {</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> edge;</div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(tet, 1, ee, edge);</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;      <span class="keyword">auto</span> eit = ref_parent_ents_view.find(edge);</div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;      <span class="keywordflow">if</span> (eit != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        edge_new_nodes[ee] = (*eit)-&gt;getEnt();</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        split_edges[parent_edges_bit.count()] = ee;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;        parent_edges_bit.set(ee, 1);</div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;      }</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;    }</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;    <span class="keywordflow">if</span>(parent_edges_bit.count() &lt; 6)</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;      parent_edges_bit.reset();</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160; </div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;  };</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160; </div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">refineTets</a>(_tets, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, set_edge_bits, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160; </div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae5238748a7c161ef7a01d6368a2d4606"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5238748a7c161ef7a01d6368a2d4606">&#9670;&nbsp;</a></span>refineTris() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTris </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine triangles in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">EntityHandle</td><td>meshset </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bitLevel </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00921">921</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;                                                            {</div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;  <a class="code" href="classRange.html">Range</a> tris;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBTRI, tris, <span class="keyword">false</span>);</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#ae5238748a7c161ef7a01d6368a2d4606">refineTris</a>(tris, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="abe81ea15693a52b6a86618cdcfae24a6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe81ea15693a52b6a86618cdcfae24a6">&#9670;&nbsp;</a></span>refineTris() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTris </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TRI in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">meshset</td><td>of entities to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bit level of created entities </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00933">933</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;                                                            {</div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;  <span class="keyword">auto</span> set_edge_bits = [](<a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab,</div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;                          <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a></div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;                              &amp;ref_parent_ents_view,</div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> tet, <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit,</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> *edge_new_nodes, <span class="keywordtype">int</span> *split_edges) {</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != 3; ++ee) {</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> edge;</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(tet, 1, ee, edge);</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      <span class="keyword">auto</span> eit = ref_parent_ents_view.find(edge);</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      <span class="keywordflow">if</span> (eit != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;        edge_new_nodes[ee] = (*eit)-&gt;getEnt();</div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;        split_edges[parent_edges_bit.count()] = ee;</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;        parent_edges_bit.set(ee, 1);</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;      }</div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    }</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160; </div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;  };</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#ae5238748a7c161ef7a01d6368a2d4606">refineTris</a>(_tris, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, set_edge_bits, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a23595b69d84b993f2f878f1af48102a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23595b69d84b993f2f878f1af48102a8">&#9670;&nbsp;</a></span>refineTris() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTris </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structMoFEM_1_1MeshRefinement.html#ae12c9a6d1ea7e86e09166e5707560786">SetEdgeBitsFun</a>&#160;</td>
          <td class="paramname"><em>set_edge_bits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l01014">1014</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;                                                                      {</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;  <span class="keyword">auto</span> refined_ents_ptr = m_field.get_ref_ents();</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;  <span class="keyword">auto</span> refined_finite_elements_ptr = m_field.get_ref_finite_elements();</div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;  ReadUtilIface *read_util;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160; </div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;  <span class="keyword">auto</span> get_parent_ents_view = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> type_child,</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;                                  <span class="keyword">const</span> <span class="keyword">auto</span> type_parent) {</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keyword">auto</span> &amp;ref_ents =</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;        refined_ents_ptr-&gt;get&lt;Composite_EntType_and_ParentEntType_mi_tag&gt;();</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keyword">auto</span> range =</div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;        ref_ents.equal_range(boost::make_tuple(type_child, type_parent));</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160; </div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;    <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a> ref_parent_ents_view;</div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160; </div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keyword">using</span> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> = decltype(range.first);</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160; </div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    boost::function&lt;<a class="code" href="classbool.html">bool</a>(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> it)&gt; tester = [&amp;](<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> it) {</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      <span class="keywordflow">return</span> ((*it)-&gt;getBitRefLevel() &amp; <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>).any();</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;    };</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160; </div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;    boost::function&lt;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> s)&gt; inserter = [&amp;](<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> s) {</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;      ref_parent_ents_view.insert(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, s);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;    };</div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160; </div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="namespaceMoFEM.html#af0da1f0f3794ba7c1c4f22d39452d7e8">rangeInserter</a>(range.first, range.second, tester, inserter);</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160; </div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">return</span> ref_parent_ents_view;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;  };</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160; </div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;  <span class="keyword">auto</span> ref_parent_ents_view = get_parent_ents_view(MBVERTEX, MBEDGE);</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160; </div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;  <span class="keyword">auto</span> tris = _tris.subset_by_type(MBTRI);</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;  <span class="keyword">auto</span> get_ele_parent_view = [&amp;]() {</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keyword">auto</span> &amp;ref_ents = refined_finite_elements_ptr-&gt;get&lt;Ent_mi_tag&gt;();</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;    <a class="code" href="namespaceMoFEM.html#ab15ad170c468b14e1a1ff743b4e38029">RefElement_multiIndex_parents_view</a> ref_ele_parent_view;</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = tris.pair_begin(); p != tris.pair_end(); ++p) {</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keyword">auto</span> tmi = ref_ents.lower_bound(p-&gt;first);</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <span class="keyword">auto</span> tme = ref_ents.upper_bound(p-&gt;second);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      ref_ele_parent_view.insert(tmi, tme);</div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;    }</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    <span class="keywordflow">return</span> ref_ele_parent_view;</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;  };</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160; </div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;  <span class="keyword">auto</span> ref_ele_parent_view = get_ele_parent_view();</div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160; </div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;  <a class="code" href="classRange.html">Range</a> ents_to_set_bit;</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160; </div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;  std::vector&lt;EntityHandle&gt; parent_tris_refined; <span class="comment">// entities refined</span></div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;  std::vector&lt;EntityHandle&gt; vertices_of_created_tris;</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;  std::vector&lt;BitRefEdges&gt; parent_edges_bit_vec;</div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;  std::vector&lt;int&gt; nb_new_tris_vec;</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160; </div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;  parent_tris_refined.reserve(tris.size());</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;  vertices_of_created_tris.reserve(3 * tris.size());</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;  parent_edges_bit_vec.reserve(tris.size());</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;  nb_new_tris_vec.reserve(tris.size());</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160; </div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;  <span class="comment">// make loop over all tets which going to be refined</span></div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> tit : tris) {</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160; </div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="comment">// get tet connectivity</span></div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tit, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160; </div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;    <span class="comment">// get edges</span></div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> parent_edges_bit(0);</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> edge_new_nodes[] = {0, 0, 0};</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="keywordtype">int</span> split_edges[] = {-1, -1, -1};</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160; </div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_edge_bits(moab, ref_parent_ents_view, tit, parent_edges_bit,</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;                         edge_new_nodes, split_edges);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160; </div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <span class="keywordflow">if</span> (parent_edges_bit.count()) {</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160; </div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      <span class="comment">// swap nodes forward</span></div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> _conn_[3];</div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      std::copy(&amp;conn[0], &amp;conn[3], &amp;_conn_[0]);</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160; </div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;      <span class="comment">// build connectivity for ref tets</span></div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> new_tets_conns[4 * 3];</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;      std::fill(&amp;new_tets_conns[0], &amp;new_tets_conns[4 * 3], <a class="code" href="namespaceMoFEM.html#ac4e6ecdc1c4668e5613f6e1ec821ddb3">no_handle</a>);</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160; </div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      <span class="keywordtype">int</span> nb_new_tris = 0;</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordflow">switch</span> (parent_edges_bit.count()) {</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="keywordflow">case</span> 1:</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a4bf647b144c7379bf90471ec18e36820">tri_type_1</a>(conn, split_edges[0], edge_new_nodes[split_edges[0]],</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;                          new_tets_conns);</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;        nb_new_tris += 2;</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;      <span class="keywordflow">case</span> 2:</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a25376784490a06a00b8e4093bb0eb655">tri_type_2</a>(conn, split_edges, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        nb_new_tris += 3;</div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;      <span class="keywordflow">case</span> 3:</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a74b9cf06b42abb1192d2b896f357ab65">tri_type_3</a>(conn, edge_new_nodes, new_tets_conns);</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;        nb_new_tris += 4;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;        <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;      <span class="keywordflow">default</span>:</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;        SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>, <span class="stringliteral">&quot;Impossible case&quot;</span>);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      }</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160; </div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      <span class="comment">// find that tets</span></div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;      <span class="keyword">auto</span> &amp;ref_ele_by_parent_and_ref_edges =</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;          ref_ele_parent_view</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;              .get&lt;Composite_ParentEnt_And_BitsOfRefinedEdges_mi_tag&gt;();</div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;      <span class="keyword">auto</span> it_by_ref_edges = ref_ele_by_parent_and_ref_edges.equal_range(</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;          boost::make_tuple(tit, parent_edges_bit.to_ulong()));</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;      <span class="comment">// check if tet with this refinement scheme already exits</span></div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      std::vector&lt;EntityHandle&gt; ents_to_set_bit_vec;</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;      <span class="keywordflow">if</span> (std::distance(it_by_ref_edges.first, it_by_ref_edges.second) ==</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;          <span class="keyword">static_cast&lt;</span><span class="keywordtype">size_t</span><span class="keyword">&gt;</span>(nb_new_tris)) {</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        ents_to_set_bit_vec.reserve(nb_new_tris);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tt = 0; it_by_ref_edges.first != it_by_ref_edges.second;</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;             it_by_ref_edges.first++, tt++) {</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160;          <span class="keyword">auto</span> tet = (*it_by_ref_edges.first)-&gt;getEnt();</div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;          ents_to_set_bit_vec.emplace_back(tet);</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;          <span class="comment">// set ref tets entities</span></div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;          <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;            <span class="comment">// add this tet if exist to this ref level</span></div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;            <span class="keyword">auto</span> ref_tet_it = refined_ents_ptr-&gt;find(tet);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;            <span class="keywordflow">if</span> (ref_tet_it == refined_ents_ptr-&gt;end()) {</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;              SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;                      <span class="stringliteral">&quot;Tetrahedron should be in database&quot;</span>);</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;            }</div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;          }</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;        }</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;        ents_to_set_bit.insert_list(ents_to_set_bit_vec.begin(),</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;                                    ents_to_set_bit_vec.end());</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160; </div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;        <span class="comment">// if this element was not refined or was refined with different</span></div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;        <span class="comment">// patterns of split edges create new elements</span></div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160; </div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;        parent_tris_refined.emplace_back(tit);</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tt = 0; tt != nb_new_tris; ++tt) {</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;          <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn : {0, 1, 2})</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;            vertices_of_created_tris.emplace_back(new_tets_conns[3 * tt + nn]);</div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;        }</div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;        parent_edges_bit_vec.emplace_back(parent_edges_bit);</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;        nb_new_tris_vec.emplace_back(nb_new_tris);</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      }</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        RefEntity_multiIndex::iterator tit_miit;</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        tit_miit = refined_ents_ptr-&gt;find(tit);</div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;        <span class="keywordflow">if</span> (tit_miit == refined_ents_ptr-&gt;end())</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;          SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;                  <span class="stringliteral">&quot;can not find this tet&quot;</span>);</div>
<div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;      }</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160; </div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      ents_to_set_bit.insert(tit);</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    }</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;  }</div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160; </div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_new_tris = vertices_of_created_tris.size() / 3;</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> start_e = 0;</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (nb_new_tris) {</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160; </div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    <span class="comment">// Create tets</span></div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn_moab;</div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().query_interface(read_util);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> read_util-&gt;get_element_connect(nb_new_tris, 3, MBTRI, 0, start_e,</div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;                                          conn_moab);</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    std::copy(vertices_of_created_tris.begin(), vertices_of_created_tris.end(),</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;              conn_moab);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> read_util-&gt;update_adjacencies(start_e, nb_new_tris, 3, conn_moab);</div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;    ents_to_set_bit.insert(start_e, start_e + nb_new_tris - 1);</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160; </div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160;      <span class="keyword">auto</span> meshset_ptr = <a class="code" href="namespaceMoFEM.html#ad17eefd5d88d2b51c71ec46cae8569ac">get_temp_meshset_ptr</a>(moab);</div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(*meshset_ptr, ents_to_set_bit);</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_refinded_debug.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;                             meshset_ptr-&gt;get_ptr(), 1);</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;    }</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;  }</div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160; </div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;  <span class="comment">// Create adj entities</span></div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;  <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> : {1}) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents_to_set_bit, <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>, <span class="keyword">true</span>, ents,</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;                                moab::Interface::UNION);</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;  }</div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160; </div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;  SetParent set_parent;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160; </div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;  <span class="comment">// Set parrents and adjacencies. Iterate over all parent triangles.</span></div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idx = 0; idx != parent_tris_refined.size(); ++idx) {</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160; </div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> tit = parent_tris_refined[idx]; <span class="comment">// parent triangle</span></div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> &amp;parent_edges_bit =</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;        parent_edges_bit_vec[idx]; <span class="comment">// marks what edges are refined</span></div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    <span class="keyword">const</span> <span class="keyword">auto</span> nb_new_tris =</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;        nb_new_tris_vec[idx]; <span class="comment">// number of triangles created by refinement</span></div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160; </div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <span class="comment">// Iterate over refined triangles</span></div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    std::array&lt;EntityHandle, 4&gt; ref_tris;</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> tt = 0; tt != nb_new_tris; ++tt, ++start_e)</div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;      ref_tris[tt] = start_e;</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160; </div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <span class="keywordflow">if</span> (nb_new_tris) {</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160; </div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_clear_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#af605d4886120656680ac43a9d3fb0cd1">get_th_RefBitEdge</a>(), &amp;ref_tris[0],</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;                                 nb_new_tris, &amp;parent_edges_bit);</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_clear_data(<a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>.<a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aadccd33cfe35eabc29b09ca61ee3bb8d">get_th_RefParentHandle</a>(), &amp;ref_tris[0],</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;                                 nb_new_tris, &amp;tit);</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160; </div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      <span class="comment">// Hash map of nodes (RefEntity) by edges (EntityHandle)</span></div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      std::map&lt;<a class="code" href="classEntityHandle.html">EntityHandle</a> <span class="comment">/*edge*/</span>, <a class="code" href="classEntityHandle.html">EntityHandle</a> <span class="comment">/*node*/</span>&gt;</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;          map_ref_nodes_by_edges;</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160; </div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;      <span class="comment">// find parents for new edges and faces</span></div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;      <span class="comment">// get tet edges and faces</span></div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;      <a class="code" href="classRange.html">Range</a> tit_edges; <span class="comment">// parent edges</span></div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;tit, 1, 1, <span class="keyword">false</span>, tit_edges);</div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> edge : tit_edges) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;        <span class="keyword">auto</span> eit = ref_parent_ents_view.find(edge);</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;        <span class="keywordflow">if</span> (eit != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;          map_ref_nodes_by_edges[(*eit)-&gt;getParentEnt()] = eit-&gt;get()-&gt;getEnt();</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;        }</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      }</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160; </div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;      <a class="code" href="classRange.html">Range</a> edges_nodes[3];</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;      <span class="comment">// for edges - add ref nodes</span></div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;      <span class="comment">// edges_nodes[ee] - contains all nodes on edge ee including mid nodes if</span></div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      <span class="comment">// exist</span></div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;      Range::iterator eit = tit_edges.begin();</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; eit != tit_edges.end(); eit++, ee++) {</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;*eit, 1, edges_nodes[ee], <span class="keyword">true</span>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;        <span class="keyword">auto</span> map_miit = map_ref_nodes_by_edges.find(*eit);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;        <span class="keywordflow">if</span> (map_miit != map_ref_nodes_by_edges.end()) {</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;          edges_nodes[ee].insert(map_miit-&gt;second);</div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;        }</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;      }</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160; </div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;      <span class="comment">// add ref nodes to tri</span></div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160;      <span class="comment">// tet_nodes contains all nodes on tet including mid edge nodes</span></div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;      <a class="code" href="classRange.html">Range</a> tri_nodes;</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;tit, 1, tri_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> map_miit = map_ref_nodes_by_edges.begin();</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;           map_miit != map_ref_nodes_by_edges.end(); map_miit++) {</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;        tri_nodes.insert(map_miit-&gt;second);</div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;      }</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160; </div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;      <a class="code" href="classRange.html">Range</a> ref_edges; <span class="comment">// edges on all new tets</span></div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;      <span class="comment">// Get all all edges of refined tets</span></div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ref_tris.data(), nb_new_tris, 1, <span class="keyword">false</span>,</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;                                  ref_edges, moab::Interface::UNION);</div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160; </div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;      <span class="comment">// Check for all ref edge and set parents</span></div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> reit = ref_edges.begin(); reit != ref_edges.end(); ++reit) {</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160;        <a class="code" href="classRange.html">Range</a> ref_edges_nodes;</div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(&amp;*reit, 1, ref_edges_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;        <span class="comment">// Check if ref edge is an coarse edge (loop over coarse tet edges)</span></div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <span class="keywordtype">int</span> ee = 0;</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="keywordflow">for</span> (; ee &lt; 3; ee++) {</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;          <span class="comment">// Two nodes are common (node[0],node[1],ref_node (if exist))</span></div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          <span class="comment">// this tests if given edge is contained by edge of refined</span></div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;          <span class="comment">// triangle</span></div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;          <span class="keywordflow">if</span> (intersect(edges_nodes[ee], ref_edges_nodes).size() == 2) {</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;            <a class="code" href="classEntityHandle.html">EntityHandle</a> edge = tit_edges[ee];</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(*reit, edge, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;            <span class="keywordflow">break</span>;</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;          }</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        }</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;        <span class="keywordflow">if</span> (ee &lt; 3)</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;          <span class="keywordflow">continue</span>; <span class="comment">// this refined edge is contained by edge of triangle</span></div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160; </div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;        <span class="comment">// check if ref edge is in coarse tetrahedral (i.e. that is internal</span></div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="comment">// edge of refined tetrahedral)</span></div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;        <span class="keywordflow">if</span> (intersect(tri_nodes, ref_edges_nodes).size() == 2) {</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(*reit, tit, refined_ents_ptr, <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>);</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;          <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;        }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="comment">// Refined edge is not child of any edge, face or tetrahedral, this is</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;        <span class="comment">// Impossible edge</span></div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        SETERRQ(m_field.get_comm(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;                <span class="stringliteral">&quot;impossible refined edge&quot;</span>);</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;      }</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;    }</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;  }</div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160; </div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_parent(refined_ents_ptr);</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;setBitRefLevel(</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;      ents_to_set_bit, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">true</span>, verb, &amp;ents);</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad40ca4d3b2040548c6c400f0fbb773fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad40ca4d3b2040548c6c400f0fbb773fb">&#9670;&nbsp;</a></span>refineTrisHangingNodes() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTrisHangingNodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classEntityHandle.html">EntityHandle</a>&#160;</td>
          <td class="paramname"><em>meshset</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TRI in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>of entities to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bit level of created entities </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l01002">1002</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                                                         {</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">Interface</a> &amp;m_field = <a class="code" href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">cOre</a>;</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;  <a class="code" href="classRange.html">Range</a> tris;</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(meshset, MBTRI, tris, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#ad40ca4d3b2040548c6c400f0fbb773fb">refineTrisHangingNodes</a>(tris, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3b710bad56f16ccf520af07cc643b5e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3b710bad56f16ccf520af07cc643b5e8">&#9670;&nbsp;</a></span>refineTrisHangingNodes() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::MeshRefinement::refineTrisHangingNodes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classRange.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tris</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>refine TRI in the meshset </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">Range</td><td>of entities to refine </td></tr>
    <tr><td class="paramname">BitRefLevel</td><td>bit level of created entities </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8cpp_source.html#l00964">964</a> of file <a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a>.</p>
<div class="fragment"><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;                                                                        {</div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160; </div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160; </div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;  <span class="keyword">auto</span> set_edge_bits = [](<a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab,</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;                          <a class="code" href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">RefEntity_multiIndex_view_by_ordered_parent_entity</a></div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;                              &amp;ref_parent_ents_view,</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> tet, <a class="code" href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">BitRefEdges</a> &amp;parent_edges_bit,</div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;                          <a class="code" href="classEntityHandle.html">EntityHandle</a> *edge_new_nodes, <span class="keywordtype">int</span> *split_edges) {</div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160; </div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != 3; ++ee) {</div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> edge;</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(tet, 1, ee, edge);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;      <span class="keyword">auto</span> eit = ref_parent_ents_view.find(edge);</div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <span class="keywordflow">if</span> (eit != ref_parent_ents_view.end()) {</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;        edge_new_nodes[ee] = (*eit)-&gt;getEnt();</div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;        split_edges[parent_edges_bit.count()] = ee;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;        parent_edges_bit.set(ee, 1);</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      }</div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    }</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160; </div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;    <span class="keywordflow">if</span> (parent_edges_bit.count() &lt; 3) {</div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      parent_edges_bit.reset();</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    }</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160; </div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;  };</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160; </div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1MeshRefinement.html#ae5238748a7c161ef7a01d6368a2d4606">refineTris</a>(_tris, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, set_edge_bits, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160; </div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a4daa2920bdc3908da269639bbd596bad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4daa2920bdc3908da269639bbd596bad">&#9670;&nbsp;</a></span>cOre</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a>&amp; MoFEM::MeshRefinement::cOre</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="MeshRefinement_8hpp_source.html#l00031">31</a> of file <a class="el" href="MeshRefinement_8hpp_source.html">MeshRefinement.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>src/interfaces/<a class="el" href="MeshRefinement_8hpp_source.html">MeshRefinement.hpp</a></li>
<li>src/interfaces/impl/<a class="el" href="MeshRefinement_8cpp_source.html">MeshRefinement.cpp</a></li>
</ul>
</div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a767509c84bf6ae4b9ab524183adca634"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a767509c84bf6ae4b9ab524183adca634">MoFEM::CoreTmp&lt; 0 &gt;::addPrismToDatabase</a></div><div class="ttdeci">MoFEMErrorCode addPrismToDatabase(const EntityHandle prism, int verb=DEFAULT_VERBOSITY)</div><div class="ttdoc">add prim element</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00522">Core.cpp:522</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_ae5238748a7c161ef7a01d6368a2d4606"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#ae5238748a7c161ef7a01d6368a2d4606">MoFEM::MeshRefinement::refineTris</a></div><div class="ttdeci">MoFEMErrorCode refineTris(const EntityHandle meshset, const BitRefLevel &amp;bit, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">refine triangles in the meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00921">MeshRefinement.cpp:921</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:8</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_aaed88f73c43b3030907ce108217c39e7"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#aaed88f73c43b3030907ce108217c39e7">MoFEM::MeshRefinement::addVerticesInTheMiddleOfEdges</a></div><div class="ttdeci">MoFEMErrorCode addVerticesInTheMiddleOfEdges(const EntityHandle meshset, const BitRefLevel &amp;bit, const bool recursive=false, int verb=QUIET, EntityHandle start_v=0)</div><div class="ttdoc">make vertices in the middle of edges in meshset and add them to refinement levels defined by bit</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00042">MeshRefinement.cpp:42</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a></div><div class="ttdeci">@ NOISY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00224">definitions.h:224</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_af605d4886120656680ac43a9d3fb0cd1"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#af605d4886120656680ac43a9d3fb0cd1">MoFEM::CoreTmp&lt; 0 &gt;::get_th_RefBitEdge</a></div><div class="ttdeci">Tag get_th_RefBitEdge() const</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00199">Core.hpp:199</a></div></div>
<div class="ttc" id="agroup__fe__multi__indices_html_ga12ff75dfcc19a2bf1474ab91c8ed4b13"><div class="ttname"><a href="group__fe__multi__indices.html#ga12ff75dfcc19a2bf1474ab91c8ed4b13">MoFEM::RefElement_multiIndex</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; RefElement &gt;, indexed_by&lt; ordered_unique&lt; tag&lt; Ent_mi_tag &gt;, const_mem_fun&lt; RefElement::interface_type_RefEntity, EntityHandle, &amp;RefElement::getEnt &gt; &gt; &gt; &gt; RefElement_multiIndex</div><div class="ttdef"><b>Definition:</b> <a href="RefElementMultiIndices_8hpp_source.html#l00180">RefElementMultiIndices.hpp:180</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2caec6eb52aa79824668fa314f4d08cf2fa"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caec6eb52aa79824668fa314f4d08cf2fa">VERY_NOISY</a></div><div class="ttdeci">@ VERY_NOISY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00225">definitions.h:225</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aaff39bae46926a7938069e620fdd0ee3"><div class="ttname"><a href="namespaceMoFEM.html#aaff39bae46926a7938069e620fdd0ee3">MoFEM::tet_type_2</a></div><div class="ttdeci">int tet_type_2(const EntityHandle *conn, const int *split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_tets_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l00988">EntityRefine.cpp:988</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a39dac1cd7f89f16e2aa8c69ba54e5539"><div class="ttname"><a href="namespaceMoFEM.html#a39dac1cd7f89f16e2aa8c69ba54e5539">MoFEM::prism_type_2</a></div><div class="ttdeci">MoFEMErrorCode prism_type_2(const EntityHandle *conn, const BitRefEdges split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_prism_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01266">EntityRefine.cpp:1266</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ac4e6ecdc1c4668e5613f6e1ec821ddb3"><div class="ttname"><a href="namespaceMoFEM.html#ac4e6ecdc1c4668e5613f6e1ec821ddb3">MoFEM::no_handle</a></div><div class="ttdeci">const EntityHandle no_handle</div><div class="ttdoc">No entity handle is indicated by zero handle, i.e. root meshset.</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00012">Common.hpp:12</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af7c4ed1edfc77e58946e30d30a13d47f"><div class="ttname"><a href="namespaceMoFEM.html#af7c4ed1edfc77e58946e30d30a13d47f">MoFEM::RefEntity_multiIndex_view_by_ordered_parent_entity</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; RefEntity &gt;, indexed_by&lt; ordered_non_unique&lt; const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getParentEnt &gt; &gt;, hashed_unique&lt; tag&lt; Composite_EntType_and_ParentEntType_mi_tag &gt;, composite_key&lt; boost::shared_ptr&lt; RefEntity &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getEnt &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getParentEnt &gt; &gt;&gt; &gt; &gt; RefEntity_multiIndex_view_by_ordered_parent_entity</div><div class="ttdef"><b>Definition:</b> <a href="RefEntsMultiIndices_8hpp_source.html#l00792">RefEntsMultiIndices.hpp:792</a></div></div>
<div class="ttc" id="agroup__ent__multi__indices_html_ga405fd80b03c5eda19a361d380dda09a8"><div class="ttname"><a href="group__ent__multi__indices.html#ga405fd80b03c5eda19a361d380dda09a8">MoFEM::RefEntity_multiIndex</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; RefEntity &gt;, indexed_by&lt; ordered_unique&lt; tag&lt; Ent_mi_tag &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getEnt &gt; &gt;, ordered_non_unique&lt; tag&lt; Ent_Ent_mi_tag &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getParentEnt &gt; &gt;, ordered_non_unique&lt; tag&lt; Composite_EntType_and_ParentEntType_mi_tag &gt;, composite_key&lt; RefEntity, const_mem_fun&lt; RefEntity, EntityType, &amp;RefEntity::getEntType &gt;, const_mem_fun&lt; RefEntity, EntityType, &amp;RefEntity::getParentEntType &gt; &gt; &gt;, ordered_non_unique&lt; tag&lt; Composite_ParentEnt_And_EntType_mi_tag &gt;, composite_key&lt; RefEntity, const_mem_fun&lt; RefEntity, EntityType, &amp;RefEntity::getEntType &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getParentEnt &gt; &gt; &gt; &gt; &gt; RefEntity_multiIndex</div><div class="ttdef"><b>Definition:</b> <a href="RefEntsMultiIndices_8hpp_source.html#l00760">RefEntsMultiIndices.hpp:760</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_a4daa2920bdc3908da269639bbd596bad"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#a4daa2920bdc3908da269639bbd596bad">MoFEM::MeshRefinement::cOre</a></div><div class="ttdeci">MoFEM::Core &amp; cOre</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8hpp_source.html#l00031">MeshRefinement.hpp:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a></div><div class="ttdeci">@ MOFEM_IMPOSSIBLE_CASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00035">definitions.h:35</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a789889a6f2cb8b9c8c913af51e9eb01e"><div class="ttname"><a href="namespaceMoFEM.html#a789889a6f2cb8b9c8c913af51e9eb01e">MoFEM::prism_type_1</a></div><div class="ttdeci">MoFEMErrorCode prism_type_1(const EntityHandle *conn, const BitRefEdges split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_prism_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01230">EntityRefine.cpp:1230</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a74b9cf06b42abb1192d2b896f357ab65"><div class="ttname"><a href="namespaceMoFEM.html#a74b9cf06b42abb1192d2b896f357ab65">MoFEM::tri_type_3</a></div><div class="ttdeci">MoFEMErrorCode tri_type_3(const EntityHandle *conn, const EntityHandle *edge_new_nodes, EntityHandle *new_tris_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01111">EntityRefine.cpp:1111</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a99b759dd71581f497626034776727d3d"><div class="ttname"><a href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a></div><div class="ttdeci">constexpr IntegrationType I</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00031">operators_tests.cpp:31</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_a7f731867b68b721d54096ceced3b9947"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">MoFEM::MeshRefinement::refineTets</a></div><div class="ttdeci">MoFEMErrorCode refineTets(const EntityHandle meshset, const BitRefLevel &amp;bit, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">refine TET in the meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00197">MeshRefinement.cpp:197</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a09ec223a6cb950da0f6a573875b6f74e"><div class="ttname"><a href="namespaceMoFEM.html#a09ec223a6cb950da0f6a573875b6f74e">MoFEM::tet_type_3</a></div><div class="ttdeci">int tet_type_3(const EntityHandle *conn, const int *split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_tets_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l00565">EntityRefine.cpp:565</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a></div><div class="ttdeci">@ VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00222">definitions.h:222</a></div></div>
<div class="ttc" id="aclassbool_html"><div class="ttname"><a href="classbool.html">bool</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="anamespaceMoFEM_html_ab15ad170c468b14e1a1ff743b4e38029"><div class="ttname"><a href="namespaceMoFEM.html#ab15ad170c468b14e1a1ff743b4e38029">MoFEM::RefElement_multiIndex_parents_view</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; RefElement &gt;, indexed_by&lt; ordered_unique&lt; tag&lt; Ent_mi_tag &gt;, const_mem_fun&lt; RefElement::interface_type_RefEntity, EntityHandle, &amp;RefElement::getEnt &gt; &gt;, ordered_non_unique&lt; tag&lt; Ent_Ent_mi_tag &gt;, const_mem_fun&lt; RefElement::interface_type_RefEntity, EntityHandle, &amp;RefElement::getParentEnt &gt; &gt;, ordered_non_unique&lt; tag&lt; Composite_ParentEnt_And_BitsOfRefinedEdges_mi_tag &gt;, composite_key&lt; RefElement, const_mem_fun&lt; RefElement::interface_type_RefEntity, EntityHandle, &amp;RefElement::getParentEnt &gt;, const_mem_fun&lt; RefElement, int, &amp;RefElement::getBitRefEdgesUlong &gt; &gt; &gt; &gt; &gt; RefElement_multiIndex_parents_view</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00030">MeshRefinement.cpp:30</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ac43c755594ad65187b20409d2f9e557c"><div class="ttname"><a href="namespaceMoFEM.html#ac43c755594ad65187b20409d2f9e557c">MoFEM::tet_type_5</a></div><div class="ttdeci">int tet_type_5(moab::Interface &amp;moab, const EntityHandle *conn, const EntityHandle *edge_new_nodes, EntityHandle *new_tets_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l00133">EntityRefine.cpp:133</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_adc1c0624a680f8b3a092b67ce1cbaf9a"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#adc1c0624a680f8b3a092b67ce1cbaf9a">MoFEM::MeshRefinement::MeshRefinement</a></div><div class="ttdeci">MeshRefinement(const MoFEM::Core &amp;core)</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00039">MeshRefinement.cpp:39</a></div></div>
<div class="ttc" id="agroup__ent__multi__indices_html_ga1a17dceefed036770efecfe8c9b6c28b"><div class="ttname"><a href="group__ent__multi__indices.html#ga1a17dceefed036770efecfe8c9b6c28b">MoFEM::RefEntity_multiIndex_view_by_hashed_parent_entity</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; RefEntity &gt;, indexed_by&lt; hashed_non_unique&lt; const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getParentEnt &gt; &gt;, hashed_unique&lt; tag&lt; Composite_EntType_and_ParentEntType_mi_tag &gt;, composite_key&lt; boost::shared_ptr&lt; RefEntity &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getEnt &gt;, const_mem_fun&lt; RefEntity, EntityHandle, &amp;RefEntity::getParentEnt &gt; &gt;&gt; &gt; &gt; RefEntity_multiIndex_view_by_hashed_parent_entity</div><div class="ttdoc">multi-index view of RefEntity by parent entity</div><div class="ttdef"><b>Definition:</b> <a href="RefEntsMultiIndices_8hpp_source.html#l00777">RefEntsMultiIndices.hpp:777</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_ad40ca4d3b2040548c6c400f0fbb773fb"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#ad40ca4d3b2040548c6c400f0fbb773fb">MoFEM::MeshRefinement::refineTrisHangingNodes</a></div><div class="ttdeci">MoFEMErrorCode refineTrisHangingNodes(const EntityHandle meshset, const BitRefLevel &amp;bit, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">refine TRI in the meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l01002">MeshRefinement.cpp:1002</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad17eefd5d88d2b51c71ec46cae8569ac"><div class="ttname"><a href="namespaceMoFEM.html#ad17eefd5d88d2b51c71ec46cae8569ac">MoFEM::get_temp_meshset_ptr</a></div><div class="ttdeci">auto get_temp_meshset_ptr(moab::Interface &amp;moab)</div><div class="ttdoc">Create smart pointer to temporary meshset.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01886">Templates.hpp:1886</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition:</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_aadccd33cfe35eabc29b09ca61ee3bb8d"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aadccd33cfe35eabc29b09ca61ee3bb8d">MoFEM::CoreTmp&lt; 0 &gt;::get_th_RefParentHandle</a></div><div class="ttdeci">Tag get_th_RefParentHandle() const</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00197">Core.hpp:197</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a98496cceb4ec90958e3feda396153995"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a98496cceb4ec90958e3feda396153995">MoFEM::CoreTmp&lt; 0 &gt;::get_th_RefBitLevel</a></div><div class="ttdeci">Tag get_th_RefBitLevel() const</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00198">Core.hpp:198</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a35d6c5d5dafd27e4d50977a7f06fd721"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a35d6c5d5dafd27e4d50977a7f06fd721">MoFEM::CoreTmp&lt; 0 &gt;::get_ref_ents</a></div><div class="ttdeci">MoFEMErrorCode get_ref_ents(const RefEntity_multiIndex **refined_entities_ptr) const</div><div class="ttdoc">Get ref entities multi-index from database.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00789">Core.cpp:789</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a523973b7327b193907630d512416e465"><div class="ttname"><a href="namespaceMoFEM.html#a523973b7327b193907630d512416e465">MoFEM::RefEntity</a></div><div class="ttdeci">RefEntityTmp&lt; 0 &gt; RefEntity</div><div class="ttdef"><b>Definition:</b> <a href="RefEntsMultiIndices_8hpp_source.html#l00566">RefEntsMultiIndices.hpp:566</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition:</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', 3 &gt;</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a25376784490a06a00b8e4093bb0eb655"><div class="ttname"><a href="namespaceMoFEM.html#a25376784490a06a00b8e4093bb0eb655">MoFEM::tri_type_2</a></div><div class="ttdeci">MoFEMErrorCode tri_type_2(const EntityHandle *conn, const int *split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_tris_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01177">EntityRefine.cpp:1177</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="anamespaceFTensor_html_a47f888f031614523ed436d61044e757c"><div class="ttname"><a href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">FTensor::dd</a></div><div class="ttdeci">const Tensor2_symmetric_Expr&lt; const ddTensor0&lt; T, Dim, i, j &gt;, typename promote&lt; T, double &gt;::V, Dim, i, j &gt; dd(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index1, const Index&lt; j, Dim &gt; index2, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition:</b> <a href="ddTensor0_8hpp_source.html#l00033">ddTensor0.hpp:33</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_afebc04c745581aa8f72c6ace26073f6c"><div class="ttname"><a href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a></div><div class="ttdeci">#define MOFEM_TAG_AND_LOG(channel, severity, tag)</div><div class="ttdoc">Tag and log in channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00362">LogManager.hpp:362</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af0da1f0f3794ba7c1c4f22d39452d7e8"><div class="ttname"><a href="namespaceMoFEM.html#af0da1f0f3794ba7c1c4f22d39452d7e8">MoFEM::rangeInserter</a></div><div class="ttdeci">auto rangeInserter(const I f, const I s, boost::function&lt; bool(I it)&gt; tester, boost::function&lt; MoFEMErrorCode(I f, I s)&gt; inserter)</div><div class="ttdoc">Insert ranges.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01945">Templates.hpp:1945</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a9fef11e1cc5bbc397bff767f4e6b8f63"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a9fef11e1cc5bbc397bff767f4e6b8f63">MoFEM::Types::BitRefEdges</a></div><div class="ttdeci">std::bitset&lt; BITREFEDGES_SIZE &gt; BitRefEdges</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00034">Types.hpp:34</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad097466ea27189b837bac98197156a8c"><div class="ttname"><a href="namespaceMoFEM.html#ad097466ea27189b837bac98197156a8c">MoFEM::tet_type_4</a></div><div class="ttdeci">int tet_type_4(const EntityHandle *conn, const int *split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_tets_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l00239">EntityRefine.cpp:239</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="anamespacesdf__hertz__2d__axisymm__plane_html_a8204f26163e5d184298bc6fa855b88ea"><div class="ttname"><a href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">sdf_hertz_2d_axisymm_plane.d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition:</b> <a href="sdf__hertz__2d__axisymm__plane_8py_source.html#l00004">sdf_hertz_2d_axisymm_plane.py:4</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a5319bbceb3b4a69ca34345ea709c1219"><div class="ttname"><a href="namespaceMoFEM.html#a5319bbceb3b4a69ca34345ea709c1219">MoFEM::prism_type_3</a></div><div class="ttdeci">MoFEMErrorCode prism_type_3(const EntityHandle *conn, const BitRefEdges split_edges, const EntityHandle *edge_new_nodes, EntityHandle *new_prism_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01339">EntityRefine.cpp:1339</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae167f5d30580719040fba4e48730ddff"><div class="ttname"><a href="namespaceMoFEM.html#ae167f5d30580719040fba4e48730ddff">MoFEM::tet_type_1</a></div><div class="ttdeci">void tet_type_1(const EntityHandle *conn, const int split_edge, const EntityHandle edge_new_node, EntityHandle *new_tets_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01096">EntityRefine.cpp:1096</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1b977ce5c042a58ccd7c74b2c2788940"><div class="ttname"><a href="namespaceMoFEM.html#a1b977ce5c042a58ccd7c74b2c2788940">MoFEM::tet_type_6</a></div><div class="ttdeci">void tet_type_6(moab::Interface &amp;moab, const EntityHandle *conn, const EntityHandle *edge_new_nodes, EntityHandle *new_tets_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l00031">EntityRefine.cpp:31</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_a09a7265b095507adb3cd048fef065c49"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#a09a7265b095507adb3cd048fef065c49">MoFEM::MeshRefinement::refineTetsHangingNodes</a></div><div class="ttdeci">MoFEMErrorCode refineTetsHangingNodes(const Range &amp;tets, const BitRefLevel &amp;bit, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">refine TET in the meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00276">MeshRefinement.cpp:276</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a4bf647b144c7379bf90471ec18e36820"><div class="ttname"><a href="namespaceMoFEM.html#a4bf647b144c7379bf90471ec18e36820">MoFEM::tri_type_1</a></div><div class="ttdeci">MoFEMErrorCode tri_type_1(const EntityHandle *conn, const int split_edge, const EntityHandle edge_new_node, EntityHandle *new_tris_conn)</div><div class="ttdef"><b>Definition:</b> <a href="EntityRefine_8cpp_source.html#l01137">EntityRefine.cpp:1137</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>