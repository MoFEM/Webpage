<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: CLX-0: Helmholtz problem</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.15.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">CLX-0: Helmholtz problem</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#tutorial_hemholtz_strong_form">The problem in strong form</a></li>
<li class="level1"><a href="#tutorial_hemholtz_weak_form">The weak form and its discretisation</a></li>
<li class="level1"><a href="#tutorial_hemholtz_code_dissection">Implementation</a><ul><li class="level2"><a href="#tutorial_hemholtz_strong_fields_and_shape_fun">Declaration of fields for solution</a></li>
<li class="level2"><a href="#tutorial_hemholtz_treatment_of_boundaries">Boundary treatment</a></li>
<li class="level2"><a href="#tutorial_hemholtz_assembly">Pushing UDOs to domain and boundary pipelines</a></li>
<li class="level2"><a href="#tutorial_hemholtz_domain_pipeline">Pushing operators to LHS domain pipeline</a></li>
<li class="level2"><a href="#tutorial_hemholtz_boundary_pipeline">Pushing operators to LHS and RHS boundary pipeline</a></li>
<li class="level2"><a href="#tutorial_hemholtz_solving">Solving and outputting results</a></li>
</ul>
</li>
<li class="level1"><a href="#tutorial_hemholtz_running_the_code">Running the code and post processing</a></li>
</ul>
</div>
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>This problem formulation follows tutorial from deal.II <a href="https://www.dealii.org/current/doxygen/deal.II/step_29.html">https://www.dealii.org/current/doxygen/deal.II/step_29.html</a>. <br  />
<br  />
 Prerequisites of this tutorial include <a class="el" href="basic_tutorials_mesh_generation_2d.html">MSH-1: Create a 2D mesh from Gmsh</a>. <br  />
 <br  />
 Intended learning outcome:<ul>
<li>general structure of a program developed using <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a></li>
<li>idea of <a href="https://mofem.eng.gla.ac.uk/structMoFEM_1_1Simple.html">Simple Interface</a> in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and how to use it</li>
<li>working with complex variable fields</li>
<li>idea of Domain element in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and how to use it</li>
<li>Use default differential Forms Integrals</li>
<li>how to <b>push</b> the developed UDOs to the <em>Pipeline</em></li>
<li>utilisation of tools to convert outputs (MOAB) and visualise them (Paraview)</li>
</ul>
</dd></dl>
<h1><a class="anchor" id="tutorial_hemholtz_strong_form"></a>
The problem in strong form</h1>
<p>The solution of the wave propagation problem in the frequency domain by means of the Finite Element Method is presented in this tutorial. The wave equation is:</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:one}
  \dfrac{{\partial}^2 P({\mathbf{x}}, t)}{\partial t^2} - c^2 {\nabla}^2 P({\mathbf{x}}, t) = 0 \quad \text{in } \Omega 
\end{align}
\]
</p>
<p>that is true in the whole domain of the problem under consideration that is the grey area in <a class="el" href="tutorial_hemholtz_problem.html#Figure_1_acoustics">Figure 1</a>. Variable \(c\) is the wave speed assumed to be constant and \( P({\mathbf{x}}, t) \) is the spatially and temporally varying pressure, with spatial position vector \({\mathbf{x}} \in \mathbb{R}^2\) and time \(t \in \mathbb{R}^{+}\).</p>
<p><a class="anchor" id="Figure_1_acoustics"></a></p><div class="image">
<img src="problem_desctiption.png" alt="" width="300px"/>
<div class="caption">
Figure 1: Schematic presentation of the acoustic transducer.</div></div>
<p>Quasi-absorbing boundary conditions are assumed for part of the boundary of the domain \(\Gamma_1\), as presented with red line in <a class="el" href="tutorial_hemholtz_problem.html#Figure_1_acoustics">Figure 1</a>, defined as</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:two}
  \dfrac{\partial P({\mathbf{x}}, t)}{\partial t} + c\left({\mathbf{N}} \cdot \nabla P ({\mathbf{x}}, t) \right) = 0  \quad \text{on } \Gamma_1
\end{align}
\]
</p>
<p>where \(\mathbf{N}\) is the unit normal vector on the quasi absorbing boundary, \(\Gamma_1\).</p>
<p>A source of constant frequency, \(\omega\), and amplitude is assumed to be located on a different part of the boundary of the domain \(\Gamma_2\):</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:three}
  P({\mathbf{x}}, t) = {\rm {cos}}(\omega t)  \quad \text{on } \Gamma_2
\end{align}
\]
</p>
<p>where \(\Gamma_1\) is presented with black line in <a class="el" href="tutorial_hemholtz_problem.html#Figure_1_acoustics">Figure 1</a>,</p>
<p>Since we focus attention on a single frequency, we solve the problem in the frequency domain, reducing problem complexity. Assuming that the solution can admit variable separation:  </p><p class="formulaDsp">
\[
\begin{align}
  \label{eq:four}
  P({\mathbf{x}}, t) = {\rm Re}({p(\mathbf{x}) e^{-i \omega t} }) 
\end{align}
\]
</p>
<p>where now the spatially varying pressure amplitude, \(p(\mathbf{x})\), a complex value:</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:five}
  p({\mathbf{x}}) = p^{\rm{Re}} + i  p^{\rm{Im}} 
\end{align}
\]
</p>
<p>By introducing the wave number \(k = \omega / c \) and substituting \eqref{eq:four} and \eqref{eq:five} in \eqref{eq:one} to \eqref{eq:three} we arrive to the Helmholtz problem:</p>
<p class="formulaDsp">
\[
    \begin{equation}
    \begin{aligned}
    \newenvironment{rcases}
    {\left.\begin{aligned}}
    {\end{aligned}\right\rbrace}
    \begin{rcases}
    k^2   p^{\rm {Re}} + {\nabla}^2 p^{\rm {Re}} = 0 \\
    k^2   p^{\rm {Im}} + {\nabla}^2 p^{\rm {Im}} = 0 \\ \end{rcases} {\text {in }} \Omega,\quad
    \newenvironment{rcases}
   {\left.\begin{aligned}}
   {\end{aligned}\right\rbrace}
   \begin{rcases}
   \mathbf{N} \cdot \nabla p^{\rm {Re}} + k p^{\rm {Im}} = 0 \\
   \mathbf{N} \cdot \nabla p^{\rm {Im}} - k p^{\rm {Re}} = 0 \\ \end{rcases} {\text {on }} \Gamma_1,\quad
   \newenvironment{rcases}
   {\left.\begin{aligned}}
   {\end{aligned}\right\rbrace}
   \begin{rcases}
   p^{\rm {Re}} = 1 \\
   p^{\rm {Im}} = 0 \\ \end{rcases} {\text {on }} \Gamma_2
    \label{eq:six}
    \end{aligned}
    \end{equation}
\]
</p>
<p>It can be observed that the imaginary number \(i\) has disappeared since one can operate on the real and imaginary parts of the equation separately to fullfil an equation that is equal to zero. Therefore, the original problem of a single field, \( P({\mathbf{x}}, t) \), into a two field problem where one field is \(p^{\rm {Re}}\) and the second one \(p^{\rm {Re}}\).</p>
<h1><a class="anchor" id="tutorial_hemholtz_weak_form"></a>
The weak form and its discretisation</h1>
<p>In this section the weak formulation is going to be presented and then extended to the equivalent discrete formulation. The weak formulation reads as this:</p>
<p>Find \( p^{\rm {Re}}\) and \(p^{\rm {Re}} \in H^1(\Omega) \) such that:</p>
<p class="formulaDsp">
\[
\begin{equation}
\begin{aligned}
  \label{eq:seven}
  \newenvironment{rcases}
  {\left.\begin{aligned}}
  {\end{aligned}\right\rbrace}
  \begin{rcases}
  k^2  {\int_{\Omega}}  p^{\rm {Re}}\delta p^{\rm {Re}} {\rm d} {\Omega}+ {\int_{\Omega}}{\nabla}^2 p^{\rm {Re}} \delta p^{\rm {Re}}{\rm d} {\Omega} = 0 \\
  k^2  {\int_{\Omega}} p^{\rm {Im}} \delta p^{\rm {Im}} {\rm d} {\Omega}+ {\int_{\Omega}}{\nabla}^2 p^{\rm {Im}}\delta p^{\rm {Im}}{\rm d} {\Omega} = 0 \\ \end{rcases} {\text {in }} \Omega,\quad  \forall \delta p^{\rm {Re}}, \delta p^{\rm {Im}} \in H^1_0(\Omega)\\
  \newenvironment{rcases}
  {\left.\begin{aligned}}
  {\end{aligned}\right\rbrace}
  \begin{rcases}
  {\int_{\Gamma_1}}\mathbf{N} \cdot \nabla p^{\rm {Re}} \delta p^{\rm {Re}} {\rm d} {\Gamma_1}+ {\int_{\Gamma_1}}k p^{\rm {Im}} \delta p^{\rm {Re}} {\rm d} {\Gamma_1}= 0 \\
  {\int_{\Gamma_1}}\mathbf{N} \cdot \nabla p^{\rm {Im}} \delta p^{\rm {Im}} {\rm d} {\Gamma_1} - {\int_{\Gamma_1}}k p^{\rm {Re}} \delta p^{\rm {Im}} {\rm d} {\Gamma_1}= 0 \\ \end{rcases} {\text {on }} \Gamma_1,\quad  \forall \delta p^{\rm {Re}}, \delta p^{\rm {Im}} \in H^1_0(\Omega)\\
  \newenvironment{rcases}
  {\left.\begin{aligned}}
  {\end{aligned}\right\rbrace}
  \begin{rcases}
  {\int_{\Gamma_2}}p^{\rm {Re}} \delta p^{\rm {Re}} {\rm d} {\Gamma_2}=  {\int_{\Gamma_2}}\delta p^{\rm {Re}} {\rm d} {\Gamma_2} \\
  p^{\rm {Im}} = 0 \\ \end{rcases} {\text {on }} \Gamma_2,\quad \forall \delta p^{\rm {Re}}, \delta p^{\rm {Im}} \in H^1_0(\Omega)
\end{aligned}
\end{equation}
\]
</p>
<p>where \(\delta p^{\rm {Re}}\) and \(\delta p^{\rm {Im}}\) are the trial functions for the real and imaginary fields, respectively, and fulfil the identity, \( \delta p({\mathbf{x}}) = \delta p^{\rm {Re}} + i \delta p^{\rm {Im}}\).</p>
<p>By applying integration by parts for the laplacian term for the domain integral and substituting the</p>
<p class="formulaDsp">
\[
    \begin{equation}
    \begin{aligned}
    {p}^{\rm {Re}} \approx {p}^{h{\rm {Re}}} =  \sum^{N-1}_{j = 0 } \phi_j {\bar {p}}^{\rm {Re}}_j, \quad {p}^{\rm {Im}} \approx {p}^{h{\rm {Im}}} =  \sum^{N-1}_{j = 0 } \psi_j {\bar {p}}^{\rm {Im}}_j
    \label{eq:eight}
    \end{aligned}
    \end{equation}
\]
</p>
<p>the system of equations presented below are derived</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:nine}
  \newenvironment{rcases}
  {\left.\begin{aligned}}
  {\end{aligned}\right\rbrace}
  \begin{rcases}
  \sum^{N-1}_{j = 0 } (k^2 {\displaystyle{\int_{\Omega}}} \phi_i \phi_j {\rm{d}}\Omega - {\int_{\Omega}} \nabla \phi_i \nabla\phi_j {\rm{d}}\Omega) {\bar p}^{\rm{Re}}_j - k ({\displaystyle{\int_{\Gamma_1}}} \phi_i\psi_j {\rm{d}}\Gamma_1) {\bar p}^{\rm{Im}}_j = 0  \\
  \sum^{N-1}_{j = 0 } (k^2 {\displaystyle{\int_{\Omega}}} \psi_i \psi_j {\rm{d}}\Omega - {\int_{\Omega}} \nabla \psi_i \nabla\psi_j {\rm{d}}\Omega) {\bar p}^{\rm{Im}}_j + k ({\displaystyle{\int_{\Gamma_1}}} \psi_i\phi_j {\rm{d}}\Gamma_1) {\bar p}^{\rm{Re}}_j = 0  \\ \end{rcases} \quad  \forall i = 0, .... (N-1)
\end{align}
\]
</p>
<p>after grouping the unknowns and their coefficients the matrix notation is obtained:</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:ten}
  \left[ 
  \begin{array}{c c}
  k^2 {\displaystyle{\int_{\Omega}}} \phi_i \phi_j {\rm{d}}\Omega - {\int_{\Omega}} \nabla \phi_i \nabla\phi_j {\rm{d}}\Omega  &amp;  -k {\displaystyle{\int_{\Gamma_1}}} \phi_i\psi_j {\rm{d}}\Gamma_1 \\ \\
  k{\displaystyle{\int_{\Gamma_1}}} \psi_i\phi_j {\rm{d}}\Gamma_1 &amp; + k^2 \displaystyle{{\int_{\Omega}}} \psi_i \psi_j {\rm{d}}\Omega - \displaystyle{{\int_{\Omega}}} \nabla \psi_i \nabla\psi_j {\rm{d}}\Omega 
  \end{array}
  \right]
  \left[ 
  \begin{array}{c}
  {\bar {p}}^{\rm {Re}}_j \\[0.2cm]
  {\bar {p}}^{\rm {Im}}_j
  \end{array}
  \right]
  =
  \left[ 
  \begin{array}{c}
  \mathbf 0 \\
  \mathbf 0
  \end{array}
  \right]
  \end{align}
\]
</p>
<p>And essential boundary conditions applied on \(\Gamma_2\) are after applying discretisation are</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:eleven}
  \sum^{N-1}_{j = 0 } -\left({\displaystyle{\int_{\Gamma_2}}} \phi_i \phi_j {\rm{d}}\Gamma_2\right){\bar{p^{\rm{Re}}_j}} = -{\displaystyle{\int_{\Gamma_2}}} \phi_i {\rm{d}}\Gamma_2 \quad \forall i = 0,...(N-1)
\end{align}
\]
</p>
<h1><a class="anchor" id="tutorial_hemholtz_code_dissection"></a>
Implementation</h1>
<p>The focus of this section is on describing the procedure for solving two field problems in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> using interface <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a>, determining boundary conditions, using boundary and domain elements accessed through the interface and pushing form integrators to pipelines for solving the problem.</p>
<h2><a class="anchor" id="tutorial_hemholtz_strong_fields_and_shape_fun"></a>
Declaration of fields for solution</h2>
<p>The focus of this section is on the points highlighted in the Notes in the beginning of the tutorial. The problem is run by execution of a series of functions when invoking the function <a class="el" href="structExample.html#a9bc8db5cd1e1c4dc349ea7f0c1ec6bae" title="[Run problem]">Example::runProblem()</a>:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structExample.html#a9bc8db5cd1e1c4dc349ea7f0c1ec6bae">Example::runProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a02c31f36ea2bb1fa2e4968b4ebab5793">readMesh</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1">setupProblem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a0105b294dd531bfee565bd59951ee5ef">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a715f389c012e659483ec314add372458">solveSystem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#ad1586d950420195d03d20479b2cedd06">outputResults</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a6eda930af795f95e64047fbc35d80826">checkResults</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="astructExample_html_a0105b294dd531bfee565bd59951ee5ef"><div class="ttname"><a href="structExample.html#a0105b294dd531bfee565bd59951ee5ef">Example::boundaryCondition</a></div><div class="ttdeci">MoFEMErrorCode boundaryCondition()</div><div class="ttdoc">[Set up problem]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00535">dynamic_first_order_con_law.cpp:535</a></div></div>
<div class="ttc" id="astructExample_html_a014d5935b6bedac1b08a891b88c9386a"><div class="ttname"><a href="structExample.html#a014d5935b6bedac1b08a891b88c9386a">Example::assembleSystem</a></div><div class="ttdeci">MoFEMErrorCode assembleSystem()</div><div class="ttdoc">[Push operators to pipeline]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00640">dynamic_first_order_con_law.cpp:640</a></div></div>
<div class="ttc" id="astructExample_html_a02c31f36ea2bb1fa2e4968b4ebab5793"><div class="ttname"><a href="structExample.html#a02c31f36ea2bb1fa2e4968b4ebab5793">Example::readMesh</a></div><div class="ttdeci">MoFEMErrorCode readMesh()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00462">dynamic_first_order_con_law.cpp:462</a></div></div>
<div class="ttc" id="astructExample_html_a6eda930af795f95e64047fbc35d80826"><div class="ttname"><a href="structExample.html#a6eda930af795f95e64047fbc35d80826">Example::checkResults</a></div><div class="ttdeci">MoFEMErrorCode checkResults()</div><div class="ttdoc">[Postprocess results]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l01182">dynamic_first_order_con_law.cpp:1182</a></div></div>
<div class="ttc" id="astructExample_html_a715f389c012e659483ec314add372458"><div class="ttname"><a href="structExample.html#a715f389c012e659483ec314add372458">Example::solveSystem</a></div><div class="ttdeci">MoFEMErrorCode solveSystem()</div><div class="ttdoc">[Solve]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00877">dynamic_first_order_con_law.cpp:877</a></div></div>
<div class="ttc" id="astructExample_html_a9bc8db5cd1e1c4dc349ea7f0c1ec6bae"><div class="ttname"><a href="structExample.html#a9bc8db5cd1e1c4dc349ea7f0c1ec6bae">Example::runProblem</a></div><div class="ttdeci">MoFEMErrorCode runProblem()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00256">plastic.cpp:256</a></div></div>
<div class="ttc" id="astructExample_html_ad089fd70d7ad8751df5a798e0914d0b1"><div class="ttname"><a href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1">Example::setupProblem</a></div><div class="ttdeci">MoFEMErrorCode setupProblem()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00275">plastic.cpp:275</a></div></div>
<div class="ttc" id="astructExample_html_ad1586d950420195d03d20479b2cedd06"><div class="ttname"><a href="structExample.html#ad1586d950420195d03d20479b2cedd06">Example::outputResults</a></div><div class="ttdeci">MoFEMErrorCode outputResults()</div><div class="ttdoc">[Solve]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l01160">dynamic_first_order_con_law.cpp:1160</a></div></div>
</div><!-- fragment --><p>where <a class="el" href="structExample.html#a02c31f36ea2bb1fa2e4968b4ebab5793" title="[Run problem]">Example::readMesh()</a> executes the mesh reading procedure, then <a class="el" href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1" title="[Run problem]">Example::setupProblem()</a> involves adding the two unknown fields on the entities of the mesh and determine the base function space, base, field rank and base order</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1">Example::setupProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// Add field</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a0e57a0b25756ae72ee7864646d564c0e">addDomainField</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                         <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a0e57a0b25756ae72ee7864646d564c0e">addDomainField</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                         <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a629f3f53162620530b250118935d75ee">addBoundaryField</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                           <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a629f3f53162620530b250118935d75ee">addBoundaryField</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                           <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 6;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULLPTR, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">setFieldOrder</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">setFieldOrder</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#acf413f83e47d1e092a8d5fdb27996cbf">setUp</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a></div><div class="ttdeci">@ AINSWORTH_BERNSTEIN_BEZIER_BASE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00065">definitions.h:64</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedPetsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="astructExample_html_a8d8b293d6079ab522beaca2aff35ffdd"><div class="ttname"><a href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">Example::simpleInterface</a></div><div class="ttdeci">Simple * simpleInterface</div><div class="ttdef"><b>Definition</b> <a href="helmholtz_8cpp_source.html#l00041">helmholtz.cpp:41</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a0e57a0b25756ae72ee7864646d564c0e"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a0e57a0b25756ae72ee7864646d564c0e">MoFEM::Simple::addDomainField</a></div><div class="ttdeci">MoFEMErrorCode addDomainField(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_ZERO, int verb=-1)</div><div class="ttdoc">Add field on domain.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00261">Simple.cpp:261</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a629f3f53162620530b250118935d75ee"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a629f3f53162620530b250118935d75ee">MoFEM::Simple::addBoundaryField</a></div><div class="ttdeci">MoFEMErrorCode addBoundaryField(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_ZERO, int verb=-1)</div><div class="ttdoc">Add field on boundary.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00355">Simple.cpp:355</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_ab233701869a6020eb4a2cb348bd7978d"><div class="ttname"><a href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">MoFEM::Simple::setFieldOrder</a></div><div class="ttdeci">MoFEMErrorCode setFieldOrder(const std::string field_name, const int order, const Range *ents=NULL)</div><div class="ttdoc">Set field order.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00601">Simple.cpp:601</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_acf413f83e47d1e092a8d5fdb27996cbf"><div class="ttname"><a href="structMoFEM_1_1Simple.html#acf413f83e47d1e092a8d5fdb27996cbf">MoFEM::Simple::setUp</a></div><div class="ttdeci">MoFEMErrorCode setUp(const PetscBool is_partitioned=PETSC_TRUE)</div><div class="ttdoc">Setup problem.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00767">Simple.cpp:767</a></div></div>
</div><!-- fragment --><p>where the fields \(p^{\rm{Re}}\) and \(p^{\rm{Im}}\) are marked as P_REAL and P_IMAG, respectively. Furthermore, the space chosen is H1, the base is AINSWORTH_BERNSTEIN_BEZIER_BASE and dimension is 1 that corresponds to a scalar field. The field data is added both to Domain Element and Boundary Element from Simple Interface via invoking <code>addDomainField</code> and <code>addBoundaryField</code>, respectively. As it will be shown later, for a problem solved in \(\mathbb{R}^d\) where \( d \) is the problem dimension, Domain Elements perform operations on the mesh entities of the highest dimension ( \(\mathbb{R}^d\)) and Boundary Elements that perform operations on mesh entities of dimension \( d - 1\) that lie only on the boundary of the mesh, in this case \( \Gamma_1\) and \( \Gamma_2\).</p>
<p>Moreover, the base functions corresponding to \(p^{\rm{Re}}\) and to \(p^{\rm{Im}}\) </p><div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simpleInterface-&gt;setFieldOrder(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simpleInterface-&gt;setFieldOrder(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
</div><!-- fragment --><p>where the default value is set to be 6</p>
<div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 6;</div>
</div><!-- fragment --><p>and can be changed by determining the order of choice via the command line parameter -order. Finally, the fields are set up via <code>simpleInterface-&gt;setUp()</code>.</p>
<h2><a class="anchor" id="tutorial_hemholtz_treatment_of_boundaries"></a>
Boundary treatment</h2>
<p>Thereafter, the boundary entities are marked based on the input in <a class="el" href="structExample.html#a0105b294dd531bfee565bd59951ee5ef" title="[Set up problem]">Example::boundaryCondition()</a> as shown in the snippet below</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structExample.html#a0105b294dd531bfee565bd59951ee5ef">Example::boundaryCondition</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_ents_on_mesh_skin = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> boundary_entities;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line">      std::string entity_name = it-&gt;getName();</div>
<div class="line">      <span class="keywordflow">if</span> (entity_name.compare(0, 2, <span class="stringliteral">&quot;BC&quot;</span>) == 0) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> it-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 1,</div>
<div class="line">                                                   boundary_entities, <span class="keyword">true</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Add vertices to boundary entities</span></div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> boundary_vertices;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(boundary_entities,</div>
<div class="line">                                              boundary_vertices, <span class="keyword">true</span>);</div>
<div class="line">    boundary_entities.merge(boundary_vertices);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> boundary_entities;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mark_boundary_dofs = [&amp;](<a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;skin_edges) {</div>
<div class="line">    <span class="keyword">auto</span> problem_manager = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;ProblemsManager&gt;();</div>
<div class="line">    <span class="keyword">auto</span> marker_ptr = boost::make_shared&lt;std::vector&lt;unsigned char&gt;&gt;();</div>
<div class="line">    problem_manager-&gt;markDofs(<a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">getProblemName</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">                              skin_edges, *marker_ptr);</div>
<div class="line">    <span class="keywordflow">return</span> marker_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> remove_dofs_from_problem = [&amp;](<a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;skin_edges) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> problem_manager = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;ProblemsManager&gt;();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> problem_manager-&gt;removeDofsOnEntities(</div>
<div class="line">        <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">getProblemName</a>(), <span class="stringliteral">&quot;P_IMAG&quot;</span>, skin_edges, 0, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Get global local vector of marked DOFs. Is global, since is set for all</span></div>
<div class="line">  <span class="comment">// DOFs on processor. Is local since only DOFs on processor are in the</span></div>
<div class="line">  <span class="comment">// vector. To access DOFs use local indices.</span></div>
<div class="line">  <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a> = mark_boundary_dofs(get_ents_on_mesh_skin());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_dofs_from_problem(get_ents_on_mesh_skin());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition</b> <a href="MeshsetsManager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="astructExample_html_ab79afebe5c16553d0c38e3ec022f868f"><div class="ttname"><a href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">Example::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00226">plastic.cpp:226</a></div></div>
<div class="ttc" id="astructExample_html_acbb661a7e049fb111673b2a7bfad03aa"><div class="ttname"><a href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">Example::boundaryMarker</a></div><div class="ttdeci">boost::shared_ptr&lt; std::vector&lt; unsigned char &gt; &gt; boundaryMarker</div><div class="ttdef"><b>Definition</b> <a href="helmholtz_8cpp_source.html#l00042">helmholtz.cpp:42</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_ad7603558a61c32e29d2bc1d0210ddf88"><div class="ttname"><a href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">MoFEM::Simple::getProblemName</a></div><div class="ttdeci">const std::string getProblemName() const</div><div class="ttdoc">Get the Problem Name.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8hpp_source.html#l00408">Simple.hpp:408</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
</div><!-- fragment --><p>The present code is designated for 2D problems. Hence, all vertices and edges located on the \(\Gamma_2\) boundary, marked with BLOCK_SET with name "BC" in the input file, are added to the global variable <a class="el" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">Example::boundaryMarker</a> that will be used in the assembly procedure. Furthermore, due to uniform essential boundary conditions on \(\Gamma_2\) for the Imaginary field, the dofs located on that boundary are deleted from the problem via the lambda function <code>remove_dofs_from_problem</code>.</p>
<h2><a class="anchor" id="tutorial_hemholtz_assembly"></a>
Pushing UDOs to domain and boundary pipelines</h2>
<p>Function <a class="el" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a" title="[Push operators to pipeline]">Example::assembleSystem()</a> is responsible for evaluating linear and bilinear forms for the problem and assembling the system to be solved</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a">Example::assembleSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  PipelineManager *pipeline_mng = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;PipelineManager&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a> = 90;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULLPTR, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-k&quot;</span>, &amp;<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, PETSC_NULLPTR);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> beta = [](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  <span class="keyword">auto</span> k2 = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> pow(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, 2); };</div>
<div class="line">  <span class="keyword">auto</span> kp = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>; };</div>
<div class="line">  <span class="keyword">auto</span> km = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> -<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>; };</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a> = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p_data) { <span class="keywordflow">return</span> 2 * p_data; };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_domain = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="structAddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        pipeline_mng-&gt;getOpDomainLhsPipeline(), {H1});</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">true</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, beta));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, k2));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, k2));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_boundary = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="structAddHOOps.html">AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        pipeline_mng-&gt;getOpBoundaryLhsPipeline(), {});</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">true</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, kp));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, km));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#aee29f1079d6eea94c28f988acd45dfa0">OpBoundarySource</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_boundary();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="achild__and__parent_8cpp_html_a942145c22ee15223ec9bd74ef82cae43"><div class="ttname"><a href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; PETSC &gt;::BiLinearForm&lt; GAUSS &gt;::OpMass&lt; 1, FIELD_DIM &gt; OpDomainMass</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00052">child_and_parent.cpp:53</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a28f0c075108bbb02a47f54fccb48ea1a"><div class="ttname"><a href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a></div><div class="ttdeci">auto integration_rule</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00187">free_surface.cpp:187</a></div></div>
<div class="ttc" id="ahelmholtz_8cpp_html_ab00a435c2cfb8b6e8e71eabe83ddeb07"><div class="ttname"><a href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; PETSC &gt;::BiLinearForm&lt; GAUSS &gt;::OpGradGrad&lt; 1, 1, SPACE_DIM &gt; OpDomainGradGrad</div><div class="ttdef"><b>Definition</b> <a href="helmholtz_8cpp_source.html#l00024">helmholtz.cpp:25</a></div></div>
<div class="ttc" id="ahelmholtz_8cpp_html_aee29f1079d6eea94c28f988acd45dfa0"><div class="ttname"><a href="helmholtz_8cpp.html#aee29f1079d6eea94c28f988acd45dfa0">OpBoundarySource</a></div><div class="ttdeci">FormsIntegrators&lt; EdgeEleOp &gt;::Assembly&lt; PETSC &gt;::LinearForm&lt; GAUSS &gt;::OpSource&lt; 1, 1 &gt; OpBoundarySource</div><div class="ttdef"><b>Definition</b> <a href="helmholtz_8cpp_source.html#l00030">helmholtz.cpp:31</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedPetsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="aseepage_8cpp_html_ad9923f794ca78444b902c41c4160e062"><div class="ttname"><a href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; PETSC &gt;::BiLinearForm&lt; GAUSS &gt;::OpMass&lt; 1, SPACE_DIM &gt; OpBoundaryMass</div><div class="ttdoc">[Only used with Hencky/nonlinear material]</div><div class="ttdef"><b>Definition</b> <a href="seepage_8cpp_source.html#l00069">seepage.cpp:70</a></div></div>
<div class="ttc" id="astructAddHOOps_html"><div class="ttname"><a href="structAddHOOps.html">AddHOOps</a></div><div class="ttdef"><b>Definition</b> <a href="EshelbianOperators_8hpp_source.html#l00826">EshelbianOperators.hpp:826</a></div></div>
</div><!-- fragment --><p>where the wave-number \(k\) has a default value of 90 and can be determined by the user via command line option -k as dictated by the lines below </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a> = 90;</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsGetScalar(PETSC_NULLPTR, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-k&quot;</span>, &amp;<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, PETSC_NULLPTR);</div>
</div><!-- fragment --><p>Thereafter, five lambda functions are determined </p><div class="fragment"><div class="line"><span class="keyword">auto</span> beta = [](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> -1; };</div>
<div class="line"><span class="keyword">auto</span> k2 = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> pow(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, 2); };</div>
<div class="line"><span class="keyword">auto</span> kp = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>; };</div>
<div class="line"><span class="keyword">auto</span> km = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> -<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>; };</div>
</div><!-- fragment --><p>that are going to be used as pointer functions in the rest of the function and explained in more detail later.</p>
<p>Moreover, in <a class="el" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a" title="[Push operators to pipeline]">Example::assembleSystem()</a> operators are pushed to different pipelines managed by the common Pipe Line object <code>pipeline_mng</code> </p><div class="fragment"><div class="line">getOpDomainLhsPipeline() </div>
<div class="line">getOpBoundaryLhsPipeline()</div>
<div class="line">getOpBoundaryRhsPipeline()</div>
</div><!-- fragment --><p> when operators are pushed by invoking <code>getOpDomainLhsPipeline()</code>, they will be set to be operating on Domain elements and assembling on the LHS of the system of equations. When operators are pushed by invoking <code>getOpBoundaryLhsPipeline()</code> and <code>getOpBoundaryRhsPipeline()</code>, they will be set to be operating on Boundary elements and assembling on the LHS and RHS, respectively.</p>
<p>Two lambda functions set_domain and set_boundary are dedicated to push operators to Domain and Boundary pipelines respectively.</p>
<h2><a class="anchor" id="tutorial_hemholtz_domain_pipeline"></a>
Pushing operators to LHS domain pipeline</h2>
<p>In <code>set_domain</code> lambda function, operators are pushed only in Domain LHS Pipeline. For 2D elements, such as those used in the present tutorial, a pre-processing operation has to be applied to evaluate the gradient of the shape functions. For this, the operators below have to be pushed.</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> det_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"><span class="keyword">auto</span> jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"><span class="keyword">auto</span> inv_jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(<span class="keyword">new</span> OpCalculateHOJacForFace(jac_ptr));</div>
<div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(<span class="keyword">new</span> OpInvertMatrix&lt;2&gt;(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetHOInvJacToScalarBases&lt;2&gt;(<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, inv_jac_ptr));</div>
<div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(<span class="keyword">new</span> OpSetHOWeightsOnFace());</div>
</div><!-- fragment --><p>where the first operator evaluates the inverse of the Jacobian at each gauss point. Then, this variable is passed to the second operator and for each gauss point the gradient of the shape function is multiplied with the inverse of the Jacobian so that these gradient correspond to the spatial configuration of the element rather than the parent according to the relationship below</p>
<p class="formulaDsp">
\[
    \begin{equation}
    \begin{aligned}
    (\nabla \phi)_j = \dfrac{\partial \phi}{\partial \xi_i} \dfrac{\partial \xi_{i}}{\partial X_j}
    \label{eq:twelve}
    \end{aligned}
    \end{equation}
\]
</p>
<p>where \(\xi_i\) are the parent coordinates \(X_j\) are the global coordinates at the gauss point of interest.</p>
<p>Next, the operator pushed is related to treatment of degrees of freedom located at the boundary \(\Gamma_2\) where Essential boundary conditions are applied since the global variable <a class="el" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">Example::boundaryMarker</a> is passed where all entities located on \(\Gamma_2\) are stored.</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">true</span>, boundaryMarker));</div>
</div><!-- fragment --><p>This operator acts on dofs of \(p^{\rm{Re}}\) since string "P_REAL" is passed. By pushing this operator with flag true, all indices that correspond to the dofs corresponding to entities in <a class="el" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">Example::boundaryMarker</a> that lie on the boundary are set to -1. This will prevent the next operators to assemble the stiffness matrix to rows-columns combination corresponding to those dofs. If flag false was chosen, all the indices corresponding to dofs corresponding to entities located to all the boundary except those in <a class="el" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">Example::boundaryMarker</a> would be set to -1.</p>
<p>Thereafter, bilinear forms for gradients for \(p^{\rm{Re}}\) and \(p^{\rm{Im}}\) as shown at the two diagonal sub-matrices in \eqref{eq:ten}</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:thirteen}
  -{\int_{\Omega}} \nabla \phi_i \nabla\phi_j {\rm{d}}\Omega,\quad -{\int_{\Omega}} \nabla \psi_i \nabla\psi_j {\rm{d}}\Omega
\end{align}
\]
</p>
<p>are evaluated by pushing the next two Operators</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, beta));</div>
</div><!-- fragment --><p>where for the first and second push correspond to the first and second integral presented in \eqref{eq:thirteen}. Moreover, <code>OpDomainGradGrad</code> stands for an alias for the <code>OpGradGrad</code> template specialisation <br  />
</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a> = FormsIntegrators&lt;DomainEleOp&gt;::Assembly&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;::OpGradGrad</a>&lt;1, 1, 2&gt;;</div>
<div class="ttc" id="aclassBiLinearForm_html"><div class="ttname"><a href="classBiLinearForm.html">BiLinearForm</a></div></div>
</div><!-- fragment --><p>determined in the beginning of the file, where <a class="el" href="classDomainEleOp.html">DomainEleOp</a> is also an alias for User Data Operator from Face Elements also determined in the beginning of the file as</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a> = FaceElementForcesAndSourcesCore;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_class" href="classDomainEleOp.html">DomainEleOp</a> = DomainEle::UserDataOperator;</div>
<div class="ttc" id="achild__and__parent_8cpp_html_a80b637c04b8c449d54efa75ab73b67df"><div class="ttname"><a href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::DomainEle DomainEle</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00034">child_and_parent.cpp:34</a></div></div>
<div class="ttc" id="aclassDomainEleOp_html"><div class="ttname"><a href="classDomainEleOp.html">DomainEleOp</a></div></div>
</div><!-- fragment --><p>Furthermore, the lambda function beta that returns -1 is passed as pointer function so that it will multiply the integral such that it will be assembled with the negative sign as shown in \eqref{eq:thirteen}.</p>
<p>Thereafter, the operator <code>OpDomainMass</code> is pushed twice to the domain LHS pipeline</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, k2));</div>
<div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, k2));</div>
</div><!-- fragment --><p>where the first push operates on \(p^{\rm{Re}}\) rows and cols and the second push operates on \(p^{\rm{Re}}\) rows and cols. These operators will be used from the domain element when the solver will invoke the pipeline to evaluate the mass matrices located on the diagonal sub-matrices in \eqref{eq:ten}</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:fourteen}
  k^2{\int_{\Omega}}  \phi_i \phi_j {\rm{d}}\Omega,\quad k^2{\int_{\Omega}}  \psi_i \psi_j {\rm{d}}\Omega
\end{align}
\]
</p>
<p>Also, the <code>OpDomainMass</code> is an alias of the specialisation of the form integrator template <code>OpMass</code> declared in the beginning of the file</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a> = FormsIntegrators&lt;DomainEleOp&gt;::Assembly&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;::OpMass</a>&lt;1, 1&gt;;</div>
</div><!-- fragment --><p>that is of element operator type <code><a class="el" href="classDomainEleOp.html">DomainEleOp</a></code> similar to the <code>OpDomainGradGrad</code> form integrator shown before. Moreover, in both pushes of <code>OpDomainMass</code>, the lambda function <code>k2</code>, that returns the input of square of wave-number \(k\), is passed as pointer function in order to multiply the mass matrix by \(k^2\) as shown in \eqref{eq:fourteen}.</p>
<p>After all form integrators have been pushed to the Domain LHS pipeline, the dofs that were marked in order not to be used located on \(\Gamma_2\) so that the next pipeline will receive the dofs conditioning in its virgin configuration. This is achieved by pushing operator <code>OpUnSetBc</code> as</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
</div><!-- fragment --><p>At the end of lambda function <code>set_domain</code>, the integration rule for the Domain element for LHS is determined as</p>
<div class="fragment"><div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">\code</div>
<div class="line"> </div>
<div class="line">where <a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> function `<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>` is passed as pointer function that has access to the <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> of the field under consideration and sets the rule to twice the <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> as shown below</div>
<div class="line"> </div>
<div class="line">\code</div>
<div class="line"><span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a> = [](int, int, <span class="keywordtype">int</span> p_data) { <span class="keywordflow">return</span> 2 * p_data; };</div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition</b> <a href="incompressible__elasticity_8cpp_source.html#l00181">incompressible_elasticity.cpp:181</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="tutorial_hemholtz_boundary_pipeline"></a>
Pushing operators to LHS and RHS boundary pipeline</h2>
<p>In <code>set_boundary</code> lambda function, operators are pushed to the Boundary LHS and RHS pipelines. Initially, for LHS Boundary pipeline the dofs corresponding to entities contained in <a class="el" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">Example::boundaryMarker</a> <code>Range</code> variable for \(p^{\rm{Re}}\) (located on the \(\Gamma_2\) boundary) are marked not to allow any assembly of the bilinear forms pushed in the pipeline.</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">true</span>, boundaryMarker));</div>
</div><!-- fragment --><p>Thereafter, the mass matrix type bilinear form integrated on \(\Gamma_1\) boundary</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, kp));</div>
</div><!-- fragment --><p>that corresponds to imaginary rows and real columns (<code>"P_IMAG", "P_REAL"</code>) presented in \eqref{eq:ten} and given by the formula</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:fifteen}
  k{\int_{\Gamma_1}}  \psi_i \phi_j {\rm{d}}\Gamma_1
\end{align}
\]
</p>
<p>where lambda function <code>kp</code> is passed as pointer function to multiply the bilinear form by \(k\) as shown in \eqref{eq:fifteen}. Operator <code>OpBoundaryMass</code> is an alias of bilinear form template specialisation, <code>OpMass</code>, determined in the top of the file as</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a> = FormsIntegrators&lt;EdgeEleOp&gt;::Assembly&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;::OpMass</a>&lt;1, 1&gt;;</div>
</div><!-- fragment --><p>where the difference with the alias operator previously presented, <code>OpDomainMass</code>, is that the present template specialisation acts on the boundary element operator , <code>EdgeEleOp</code>, determined also at the top of the file as</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore.html">EdgeEle</a> = EdgeElementForcesAndSourcesCore;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore_1_1UserDataOperator.html">EdgeEleOp</a> = <a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore_1_1UserDataOperator.html">EdgeEle::UserDataOperator</a>;</div>
<div class="ttc" id="astructMoFEM_1_1EdgeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1EdgeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for EDGE element</div><div class="ttdef"><b>Definition</b> <a href="EdgeElementForcesAndSourcesCore_8hpp_source.html#l00068">EdgeElementForcesAndSourcesCore.hpp:69</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EdgeElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1EdgeElementForcesAndSourcesCore.html">MoFEM::EdgeElementForcesAndSourcesCore</a></div><div class="ttdoc">Edge finite element.</div><div class="ttdef"><b>Definition</b> <a href="EdgeElementForcesAndSourcesCore_8hpp_source.html#l00030">EdgeElementForcesAndSourcesCore.hpp:30</a></div></div>
</div><!-- fragment --><p>The next operator push is the same, <code>OpBoundaryMass</code>, that now acts on the real rows and imaginary columns</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, km));</div>
</div><!-- fragment --><p>that evaluates and assembles the bilinear form</p>
<p class="formulaDsp">
\[
\begin{align}
  \label{eq:sixteen}
  -k{\int_{\Gamma_1}}  \phi_i \psi_j {\rm{d}}\Gamma_1
\end{align}
\]
</p>
<p>as shown in \eqref{eq:ten} and lambda function <code>km</code> is passed in order to multiply \(-k\) as presented in \eqref{eq:sixteen}. Once all the operators for the Boundary LHS pipeline operating on \(\Gamma_1\) are pushed, the marked dofs have to be release so that the dofs conditioning will be passed intact to the next pipeline and achieved by pushing <code>OpUnSetBc</code></p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
</div><!-- fragment --><p>Essential boundary conditions are also applied following \eqref{eq:eleven} but assumed to have both side multiplied by -1. Initially, operator <code>OpSetBc</code> is now used by setting <code>false</code> flag so that now the rest of the boundary except for \(\Gamma_2\) is now marked not to allow for assembly as</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">false</span>, boundaryMarker));</div>
</div><!-- fragment --><p>Then the mass bilinear form integrator is pushed using <code>beta</code> lambda function to multiply the integral by -1.</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
</div><!-- fragment --><p>and then the marked boundary is released again by</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
</div><!-- fragment --><p>For setting the RHS linear form the boundary is appropriately marked as in the case for the bilinear form corresponding to the essential boundary conditions but now for the Boundary RHS pipeline as</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> OpSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">false</span>, boundaryMarker));</div>
</div><!-- fragment --><p>then the linear form is pushed with lambda function beta so that the integral presented in the RHS in \eqref{eq:eleven} is multiplied by -1</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">    <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#aee29f1079d6eea94c28f988acd45dfa0">OpBoundarySource</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
</div><!-- fragment --><p>where operator <code>OpBoundarySource</code> is an alias of the template specialisation <code>OpSource</code> assigned in the beginning of the file</p>
<div class="fragment"><div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="helmholtz_8cpp.html#aee29f1079d6eea94c28f988acd45dfa0">OpBoundarySource</a> = FormsIntegrators&lt;EdgeEleOp&gt;::Assembly&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classLinearForm.html">::LinearForm&lt;GAUSS&gt;::OpSource</a>&lt;1, 1&gt;;</div>
<div class="ttc" id="aclassLinearForm_html"><div class="ttname"><a href="classLinearForm.html">LinearForm</a></div></div>
</div><!-- fragment --><p>and then marked boundary dofs are released again</p>
<div class="fragment"><div class="line">pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(<span class="keyword">new</span> OpUnSetBc(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
</div><!-- fragment --><p>Finally, integration rules are set for RHS and LHS for Boundary element.</p>
<div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
</div><!-- fragment --><h2><a class="anchor" id="tutorial_hemholtz_solving"></a>
Solving and outputting results</h2>
<p>The last three functions invoked in <a class="el" href="structExample.html#a9bc8db5cd1e1c4dc349ea7f0c1ec6bae" title="[Run problem]">Example::runProblem()</a> are</p>
<div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> solveSystem();</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> outputResults();</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> checkResults();</div>
</div><!-- fragment --><p>that each involve solving the system of linear equations using <code>KSPSolver</code>, printing the results for the two fields <code>P_REAL</code> and <code>P_IMAG</code> and checking convergence of the system respectively.</p>
<p>The implementation of these three functions is not discussed in the present tutorial as it is not the focus as discussed in the notes in the beginning of the tutorial. Description of such functions will be discussed in other tutorials.</p>
<h1><a class="anchor" id="tutorial_hemholtz_running_the_code"></a>
Running the code and post processing</h1>
<p>In order to run the program that we have been discussing in this tutorial, you will have to follow the steps below</p><ul>
<li>First, move to the directory where the binary file <code>helmholtz</code> is located. Depending on how you install <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> shown in this page <a class="el" href="installation.html">Installation with Spack (Scripts)</a>, going to the directory would be something similar to this<ul>
<li>For user version installation <div class="fragment"><div class="line">cd mofem_install/um_view/tutorials/clx-0/</div>
</div><!-- fragment --></li>
<li>For developer version installation <div class="fragment"><div class="line">cd mofem_install/um/build_release/tutorials/clx-0/</div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Second, check the parameters in the param_file.petsc. These are PETSc parameters and you should only use parameters that are needed for a particular solver, in this case KSP solver. Only the following parameters should be uncommented <div class="fragment"><div class="line"><span class="preprocessor">## Linear solver</span></div>
<div class="line">-pc_type lu </div>
<div class="line">-pc_factor_mat_solver_type mumps</div>
<div class="line">-ksp_monitor</div>
</div><!-- fragment --></li>
<li>Third, in the terminal, run commands to partition the input mesh and start the analysis <div class="fragment"><div class="line">mofem_part -my_file geometry.cub -output_file part.h5m -my_nparts 2 -dim 2 -adj_dim 1</div>
<div class="line">mpirun -np 2 ./helmholtz -file_name part.h5m -<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> 8 -<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a> 180</div>
</div><!-- fragment --> where in the first line the mesh <code>geometry.cub</code> presented in <a class="el" href="tutorial_hemholtz_problem.html#Figure_2_acoustics">Figure 2</a> generated in the open source code CUBIT is partitioned in to parts and generated the partitioned mesh <code>part.h5m</code> with boundaries and domain corresponding to \(Gamma_1\) and \(Gamma_2\) presented in <a class="el" href="tutorial_hemholtz_problem.html#Figure_1_acoustics">Figure 1</a>. In the second line, program is run using two processors (the same number of partitions) with fourth order polynomial of approximation and \(k = 90\).</li>
</ul>
<p><a class="anchor" id="Figure_2_acoustics"></a></p><div class="image">
<img src="transducer_mesh.png" alt="" width="600px"/>
<div class="caption">
Figure 2: Mesh under the name `geometry.cub` used for partitioning.</div></div>
<ul>
<li>After the analysis has run successfully, an output file, <code>out_helmholtz.h5m</code>, is generated. To convert the results from <code>.h5m</code> format into <code>.vtk</code> <div class="fragment"><div class="line">mbconvert out_helmholtz.h5m out_helmholtz.vtk</div>
</div><!-- fragment --></li>
<li>To evaluate the wave amplitude from the results, once the <code>out_helmholtz.vtk</code> file is openned in freely available postprocessing software the calculator solver must be used to evaluate from the solution of the fields <code>P_REAL</code> and <code>P_IMAG</code> by setting the name <code>Intensity</code> in the <code>Result Array Name</code> field and calculating the wave amplitude as \(\sqrt{\left(p^{\rm{Re}}\right)^2 + \left(p^{\rm{Im}}\right)^2}\) by substituting <div class="fragment"><div class="line">sqrt(P_REAL* P_REAL+P_IMAG*P_IMAG)</div>
</div><!-- fragment --> into the field below <code>Result Array Name</code>. The associated results are presented in <a class="el" href="tutorial_hemholtz_problem.html#Figure_3_acoustics">Figure 3</a>.</li>
</ul>
<p><a class="anchor" id="Figure_3_acoustics"></a></p><div class="image">
<img src="k_180_order_8_coarse.png" alt="" width="500px"/>
<div class="caption">
Figure 3: Post processed results for intensity (magnitude) of the result for wave-number 180 and order for approximation shape functions.</div></div>
<ul>
<li>Finally to obtain a series of files to resemble the evolution in time of the stationary wave evaluated one has to paste the code below to the python shell of paraview</li>
</ul>
<div class="fragment"><div class="line">my_out = FindSource(<span class="stringliteral">&quot;out_helmholtz.vtk&quot;</span>)</div>
<div class="line">for <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> in range(100):</div>
<div class="line"> tt = 10*<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> / <span class="keywordtype">float</span>(100)</div>
<div class="line"> calculator1 = Calculator(Input=my_out)</div>
<div class="line"> calculator1.Function = &quot;P_REAL*cos(2*3.141* &quot; + str(tt) + &quot;) + P_IMAG*sin(2*3.141*&quot; + str(tt) + &quot;)&quot;</div>
<div class="line"> calculator1.ResultArrayName = &#39;new_array&#39;</div>
<div class="line"> passArrays1 = PassArrays(Input=calculator1)</div>
<div class="line"> passArrays1.PointDataArrays = [&#39;new_array&#39;]</div>
<div class="line"> SaveData(&quot;./out_&quot; + str(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>) + &quot;.vtk&quot;, proxy=passArrays1, FileType=&#39;Ascii&#39;)</div>
<div class="line"> Delete(calculator1)</div>
<div class="line"> Delete(passArrays1)</div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition</b> <a href="plate_8cpp_source.html#l00058">plate.cpp:58</a></div></div>
</div><!-- fragment --><p>compiling the series of 100 files generated the video presented in <a class="el" href="tutorial_hemholtz_problem.html#Figure_4_acustics">Figure 4</a> will be generated</p>
<p><a class="anchor" id="Figure_4_acustics"></a></p><div class="image">
<img src="wave_presentation.gif" alt="" width="700px"/>
<div class="caption">
Figure 4: Post processed results for visual presentation of the periodic movement of the stationary wave corresponding to the solution of the Helmholtz problem in frequency domain.</div></div>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file helmholtz.cpp</span></div>
<div class="line"><span class="comment"> * \example helmholtz.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Using PipelineManager interface calculate Helmholtz problem. Example show how</span></div>
<div class="line"><span class="comment"> * to manage complex variable fields.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a> = <a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_class" href="classDomainEleOp.html">DomainEleOp</a> = DomainEle::UserDataOperator;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore.html">EdgeEle</a> = <a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore.html">EdgeElementForcesAndSourcesCore</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore_1_1UserDataOperator.html">EdgeEleOp</a> = <a class="code hl_struct" href="structMoFEM_1_1EdgeElementForcesAndSourcesCore_1_1UserDataOperator.html">EdgeEle::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> = 2;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a> = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;::OpGradGrad</a>&lt;1, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt;;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a> = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;::OpMass</a>&lt;1, 1&gt;;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a> = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;EdgeEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;::OpMass</a>&lt;1, 1&gt;;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="helmholtz_8cpp.html#aee29f1079d6eea94c28f988acd45dfa0">OpBoundarySource</a> = <a class="code hl_struct" href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">FormsIntegrators&lt;EdgeEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    PETSC&gt;<a class="code hl_class" href="classLinearForm.html">::LinearForm&lt;GAUSS&gt;::OpSource</a>&lt;1, 1&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="structExample.html">Example</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="structExample.html">Example</a>(<a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>(m_field) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a9bc8db5cd1e1c4dc349ea7f0c1ec6bae">runProblem</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>;</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1Simple.html">Simple</a> *<a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>;</div>
<div class="line">  boost::shared_ptr&lt;std::vector&lt;unsigned char&gt;&gt; <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a02c31f36ea2bb1fa2e4968b4ebab5793">readMesh</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1">setupProblem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a0105b294dd531bfee565bd59951ee5ef">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a715f389c012e659483ec314add372458">solveSystem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#ad1586d950420195d03d20479b2cedd06">outputResults</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a6eda930af795f95e64047fbc35d80826">checkResults</a>();</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [run problem]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a9bc8db5cd1e1c4dc349ea7f0c1ec6bae">Example::runProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a02c31f36ea2bb1fa2e4968b4ebab5793">readMesh</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1">setupProblem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a0105b294dd531bfee565bd59951ee5ef">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a715f389c012e659483ec314add372458">solveSystem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#ad1586d950420195d03d20479b2cedd06">outputResults</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structExample.html#a6eda930af795f95e64047fbc35d80826">checkResults</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [run problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a02c31f36ea2bb1fa2e4968b4ebab5793">Example::readMesh</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a8325447a1773550852f04c1b600af703">getOptions</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a3d65745e902af842b5c490eedbcd30d1">loadFile</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#ad089fd70d7ad8751df5a798e0914d0b1">Example::setupProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// Add field</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a0e57a0b25756ae72ee7864646d564c0e">addDomainField</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                         <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a0e57a0b25756ae72ee7864646d564c0e">addDomainField</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                         <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a629f3f53162620530b250118935d75ee">addBoundaryField</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                           <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a629f3f53162620530b250118935d75ee">addBoundaryField</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                           <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 6;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULLPTR, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, PETSC_NULLPTR);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">setFieldOrder</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">setFieldOrder</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#acf413f83e47d1e092a8d5fdb27996cbf">setUp</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Applying essential BC]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a0105b294dd531bfee565bd59951ee5ef">Example::boundaryCondition</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_ents_on_mesh_skin = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> boundary_entities;</div>
<div class="line">    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, it)) {</div>
<div class="line">      std::string entity_name = it-&gt;getName();</div>
<div class="line">      <span class="keywordflow">if</span> (entity_name.compare(0, 2, <span class="stringliteral">&quot;BC&quot;</span>) == 0) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> it-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 1,</div>
<div class="line">                                                   boundary_entities, <span class="keyword">true</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// Add vertices to boundary entities</span></div>
<div class="line">    <a class="code hl_class" href="classRange.html">Range</a> boundary_vertices;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1CoreInterface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(boundary_entities,</div>
<div class="line">                                              boundary_vertices, <span class="keyword">true</span>);</div>
<div class="line">    boundary_entities.merge(boundary_vertices);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> boundary_entities;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mark_boundary_dofs = [&amp;](<a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;skin_edges) {</div>
<div class="line">    <span class="keyword">auto</span> problem_manager = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;();</div>
<div class="line">    <span class="keyword">auto</span> marker_ptr = boost::make_shared&lt;std::vector&lt;unsigned char&gt;&gt;();</div>
<div class="line">    problem_manager-&gt;<a class="code hl_function" href="structMoFEM_1_1ProblemsManager.html#a1520c7c26036ada71ab50417fb2e8b85">markDofs</a>(<a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">getProblemName</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">                              skin_edges, *marker_ptr);</div>
<div class="line">    <span class="keywordflow">return</span> marker_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> remove_dofs_from_problem = [&amp;](<a class="code hl_class" href="classRange.html">Range</a> &amp;&amp;skin_edges) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> problem_manager = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> problem_manager-&gt;<a class="code hl_function" href="group__mofem__problems__manager.html#gaf0db6004cade0e29bef97f933834b61e">removeDofsOnEntities</a>(</div>
<div class="line">        <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">getProblemName</a>(), <span class="stringliteral">&quot;P_IMAG&quot;</span>, skin_edges, 0, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Get global local vector of marked DOFs. Is global, since is set for all</span></div>
<div class="line">  <span class="comment">// DOFs on processor. Is local since only DOFs on processor are in the</span></div>
<div class="line">  <span class="comment">// vector. To access DOFs use local indices.</span></div>
<div class="line">  <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a> = mark_boundary_dofs(get_ents_on_mesh_skin());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_dofs_from_problem(get_ents_on_mesh_skin());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Applying essential BC]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Push operators to pipeline]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a014d5935b6bedac1b08a891b88c9386a">Example::assembleSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a> *pipeline_mng = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a> = 90;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULLPTR, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-k&quot;</span>, &amp;<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, PETSC_NULLPTR);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> beta = [](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  <span class="keyword">auto</span> k2 = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> pow(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, 2); };</div>
<div class="line">  <span class="keyword">auto</span> kp = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>; };</div>
<div class="line">  <span class="keyword">auto</span> km = [<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>](<span class="keyword">const</span> double, <span class="keyword">const</span> double, <span class="keyword">const</span> double) { <span class="keywordflow">return</span> -<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>; };</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a> = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p_data) { <span class="keywordflow">return</span> 2 * p_data; };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_domain = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="structAddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>(), {H1});</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpSetBc.html">OpSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">true</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#ab00a435c2cfb8b6e8e71eabe83ddeb07">OpDomainGradGrad</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, beta));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, k2));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a942145c22ee15223ec9bd74ef82cae43">OpDomainMass</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, k2));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">getOpDomainLhsPipeline</a>().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpUnSetBc.html">OpUnSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#ac81815a59f303199fc9f63e598040f00">setDomainLhsIntegrationRule</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_boundary = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="structAddHOOps.html">AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>(), {});</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpSetBc.html">OpSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">true</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, kp));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_IMAG&quot;</span>, km));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpUnSetBc.html">OpUnSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpSetBc.html">OpSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="seepage_8cpp.html#ad9923f794ca78444b902c41c4160e062">OpBoundaryMass</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">getOpBoundaryLhsPipeline</a>().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpUnSetBc.html">OpUnSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#gaa9aaa7b66b970cf6f2ca2ab3998996d5">getOpBoundaryRhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpSetBc.html">OpSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="structExample.html#acbb661a7e049fb111673b2a7bfad03aa">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#gaa9aaa7b66b970cf6f2ca2ab3998996d5">getOpBoundaryRhsPipeline</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="helmholtz_8cpp.html#aee29f1079d6eea94c28f988acd45dfa0">OpBoundarySource</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, beta));</div>
<div class="line">    pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#gaa9aaa7b66b970cf6f2ca2ab3998996d5">getOpBoundaryRhsPipeline</a>().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpUnSetBc.html">OpUnSetBc</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#a866330d80871ff595ebe39592e89c44d">setBoundaryRhsIntegrationRule</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#a78c94a45cd9093d2aa5ada8c940eb698">setBoundaryLhsIntegrationRule</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_boundary();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Push operators to pipeline]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a715f389c012e659483ec314add372458">Example::solveSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a> *pipeline_mng = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> solver = pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#gaa983d7ca3e82c5a0711991a730bfbcbb">createKSP</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(solver);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(solver);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a9261d3ef9b39a00cb7d0acc612702275">getDM</a>();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = <a class="code hl_function" href="namespaceMoFEM.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(solver, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Postprocess results]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#ad1586d950420195d03d20479b2cedd06">Example::outputResults</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a> *pipeline_mng = <a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a>&gt;();</div>
<div class="line">  pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#a4daac802fcdd9c31639d1c1d4a2a608f">getDomainLhsFE</a>().reset();</div>
<div class="line">  pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#a0d2c10375809102ca76959b5cc21ef9e">getDomainRhsFE</a>().reset();</div>
<div class="line">  pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#a6fb83a7b5308bd48969aff214221d992">getBoundaryLhsFE</a>().reset();</div>
<div class="line">  pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#ab8492b86e615e99db109a5478e0d7154">getBoundaryRhsFE</a>().reset();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">PostProcEle</a> = <a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">PostProcBrokenMeshInMoab&lt;DomainEle&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_fe = boost::make_shared&lt;PostProcEle&gt;(<a class="code hl_variable" href="structExample.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> p_real_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> p_imag_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P_REAL&quot;</span>, p_real_ptr));</div>
<div class="line">  post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P_IMAG&quot;</span>, p_imag_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPPMap</a> = <a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">          post_proc_fe-&gt;getPostProcMesh(), post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;P_REAL&quot;</span>, p_real_ptr}, {<span class="stringliteral">&quot;P_IMAG&quot;</span>, p_imag_ptr}},</div>
<div class="line"> </div>
<div class="line">          {}, {}, {}</div>
<div class="line"> </div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  pipeline_mng-&gt;<a class="code hl_function" href="structMoFEM_1_1PipelineManager.html#a0d2c10375809102ca76959b5cc21ef9e">getDomainRhsFE</a>() = post_proc_fe;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#ga41f2fac8fb98a931dc7fc9e2239b2909">loopFiniteElements</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_fe-&gt;writeFile(<span class="stringliteral">&quot;out_helmholtz.h5m&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Postprocess results]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Check results]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structExample.html#a6eda930af795f95e64047fbc35d80826">Example::checkResults</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_variable" href="structExample.html#a8d8b293d6079ab522beaca2aff35ffdd">simpleInterface</a>-&gt;<a class="code hl_function" href="structMoFEM_1_1Simple.html#a9261d3ef9b39a00cb7d0acc612702275">getDM</a>();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <span class="keywordtype">double</span> nrm2;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, NORM_2, &amp;nrm2);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; std::setprecision(9) &lt;&lt; <span class="stringliteral">&quot;Solution norm &quot;</span> &lt;&lt; nrm2;</div>
<div class="line"> </div>
<div class="line">  PetscBool test_flg = PETSC_FALSE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULLPTR, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-test&quot;</span>, &amp;test_flg, PETSC_NULLPTR);</div>
<div class="line">  <span class="keywordflow">if</span> (test_flg) {</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> regression_test = 97.261672;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> = 1e-6;</div>
<div class="line">    <span class="keywordflow">if</span> (std::abs(nrm2 - regression_test) / regression_test &gt; <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>)</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Not converged solution&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Check results]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialisation of MoFEM/PETSc and MOAB data structures</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> param_file[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a class="code hl_function" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc]</span></div>
<div class="line"><span class="comment"></span>    DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span>    moab::Core mb_instance;              <span class="comment">///&lt; mesh database</span></div>
<div class="line">    moab::Interface &amp;moab = mb_instance; <span class="comment">///&lt; mesh database interface</span><span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span>    <a class="code hl_struct" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab);           <span class="comment">///&lt; finite element database</span></div>
<div class="line">    <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core; <span class="comment">///&lt; finite element database insterface</span><span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Example]</span></div>
<div class="line"><span class="comment"></span>    <a class="code hl_struct" href="structExample.html">Example</a> ex(m_field);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ex.runProblem();<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Example]</span></div>
<div class="line"><span class="comment"></span>  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line">}</div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="acheck__base__functions__derivatives__on__tet_8cpp_html_a3d8c24629d725b9ef8c238cf27c9b158"><div class="ttname"><a href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a></div><div class="ttdeci">static const double eps</div><div class="ttdef"><b>Definition</b> <a href="check__base__functions__derivatives__on__tet_8cpp_source.html#l00011">check_base_functions_derivatives_on_tet.cpp:11</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00514">DMMoFEM.cpp:514</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition</b> <a href="DMMoFEM_8hpp_source.html#l01102">DMMoFEM.hpp:1102</a></div></div>
<div class="ttc" id="agroup__mofem__basic__interface_html_ga41f2fac8fb98a931dc7fc9e2239b2909"><div class="ttname"><a href="group__mofem__basic__interface.html#ga41f2fac8fb98a931dc7fc9e2239b2909">MoFEM::PipelineManager::loopFiniteElements</a></div><div class="ttdeci">MoFEMErrorCode loopFiniteElements(SmartPetscObj&lt; DM &gt; dm=nullptr)</div><div class="ttdoc">Iterate finite elements.</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8cpp_source.html#l00063">PipelineManager.cpp:63</a></div></div>
<div class="ttc" id="agroup__mofem__basic__interface_html_ga4b4225b4e1f114d604552ad8ec176486"><div class="ttname"><a href="group__mofem__basic__interface.html#ga4b4225b4e1f114d604552ad8ec176486">MoFEM::PipelineManager::getOpDomainLhsPipeline</a></div><div class="ttdeci">boost::ptr_deque&lt; UserDataOperator &gt; &amp; getOpDomainLhsPipeline()</div><div class="ttdoc">Get the Op Domain Lhs Pipeline object.</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00824">PipelineManager.hpp:824</a></div></div>
<div class="ttc" id="agroup__mofem__basic__interface_html_ga9937ffec4c6a1091f6950b4d4f2a075b"><div class="ttname"><a href="group__mofem__basic__interface.html#ga9937ffec4c6a1091f6950b4d4f2a075b">MoFEM::PipelineManager::getOpBoundaryLhsPipeline</a></div><div class="ttdeci">boost::ptr_deque&lt; UserDataOperator &gt; &amp; getOpBoundaryLhsPipeline()</div><div class="ttdoc">Get the Op Boundary Lhs Pipeline object.</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00872">PipelineManager.hpp:872</a></div></div>
<div class="ttc" id="agroup__mofem__basic__interface_html_gaa983d7ca3e82c5a0711991a730bfbcbb"><div class="ttname"><a href="group__mofem__basic__interface.html#gaa983d7ca3e82c5a0711991a730bfbcbb">MoFEM::PipelineManager::createKSP</a></div><div class="ttdeci">SmartPetscObj&lt; KSP &gt; createKSP(SmartPetscObj&lt; DM &gt; dm=nullptr)</div><div class="ttdoc">Create KSP (linear) solver.</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8cpp_source.html#l00099">PipelineManager.cpp:99</a></div></div>
<div class="ttc" id="agroup__mofem__basic__interface_html_gaa9aaa7b66b970cf6f2ca2ab3998996d5"><div class="ttname"><a href="group__mofem__basic__interface.html#gaa9aaa7b66b970cf6f2ca2ab3998996d5">MoFEM::PipelineManager::getOpBoundaryRhsPipeline</a></div><div class="ttdeci">boost::ptr_deque&lt; UserDataOperator &gt; &amp; getOpBoundaryRhsPipeline()</div><div class="ttdoc">Get the Op Boundary Rhs Pipeline object.</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00896">PipelineManager.hpp:896</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition</b> <a href="LogManager_8hpp_source.html#l00316">LogManager.hpp:316</a></div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_gaf0db6004cade0e29bef97f933834b61e"><div class="ttname"><a href="group__mofem__problems__manager.html#gaf0db6004cade0e29bef97f933834b61e">MoFEM::ProblemsManager::removeDofsOnEntities</a></div><div class="ttdeci">MoFEMErrorCode removeDofsOnEntities(const std::string problem_name, const std::string field_name, const Range ents, const int lo_coeff=0, const int hi_coeff=MAX_DOFS_ON_ENTITY, const int lo_order=0, const int hi_order=100, int verb=VERBOSE, const bool debug=false)</div><div class="ttdoc">Remove DOFs from problem.</div><div class="ttdef"><b>Definition</b> <a href="ProblemsManager_8cpp_source.html#l02959">ProblemsManager.cpp:2959</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedPetsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a681e912e2d0043503d2da810dc186d73"><div class="ttname"><a href="namespaceMoFEM.html#a681e912e2d0043503d2da810dc186d73">MoFEM::vectorDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; vectorDuplicate(Vec vec)</div><div class="ttdoc">Create duplicate vector of smart vector.</div><div class="ttdef"><b>Definition</b> <a href="PetscSmartObj_8hpp_source.html#l00221">PetscSmartObj.hpp:221</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="astructExample_html"><div class="ttname"><a href="structExample.html">Example</a></div><div class="ttdoc">[Example]</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00216">plastic.cpp:216</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition</b> <a href="Core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FormsIntegrators_1_1Assembly_html"><div class="ttname"><a href="structMoFEM_1_1FormsIntegrators_1_1Assembly.html">MoFEM::FormsIntegrators::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition</b> <a href="FormsIntegrators_8hpp_source.html#l00317">FormsIntegrators.hpp:317</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValues.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l00082">UserDataOperators.hpp:83</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00709">PostProcBrokenMeshInMoabBase.hpp:709</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetBc_html"><div class="ttname"><a href="structMoFEM_1_1OpSetBc.html">MoFEM::OpSetBc</a></div><div class="ttdoc">Set indices on entities on finite element.</div><div class="ttdef"><b>Definition</b> <a href="FormsIntegrators_8hpp_source.html#l00038">FormsIntegrators.hpp:38</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpUnSetBc_html"><div class="ttname"><a href="structMoFEM_1_1OpUnSetBc.html">MoFEM::OpUnSetBc</a></div><div class="ttdef"><b>Definition</b> <a href="FormsIntegrators_8hpp_source.html#l00049">FormsIntegrators.hpp:49</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html">MoFEM::PipelineManager</a></div><div class="ttdoc">PipelineManager interface.</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00024">PipelineManager.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_a0d2c10375809102ca76959b5cc21ef9e"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#a0d2c10375809102ca76959b5cc21ef9e">MoFEM::PipelineManager::getDomainRhsFE</a></div><div class="ttdeci">boost::shared_ptr&lt; FEMethod &gt; &amp; getDomainRhsFE()</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00455">PipelineManager.hpp:455</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_a4daac802fcdd9c31639d1c1d4a2a608f"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#a4daac802fcdd9c31639d1c1d4a2a608f">MoFEM::PipelineManager::getDomainLhsFE</a></div><div class="ttdeci">boost::shared_ptr&lt; FEMethod &gt; &amp; getDomainLhsFE()</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00451">PipelineManager.hpp:451</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_a6fb83a7b5308bd48969aff214221d992"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#a6fb83a7b5308bd48969aff214221d992">MoFEM::PipelineManager::getBoundaryLhsFE</a></div><div class="ttdeci">boost::shared_ptr&lt; FEMethod &gt; &amp; getBoundaryLhsFE()</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00459">PipelineManager.hpp:459</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_a78c94a45cd9093d2aa5ada8c940eb698"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#a78c94a45cd9093d2aa5ada8c940eb698">MoFEM::PipelineManager::setBoundaryLhsIntegrationRule</a></div><div class="ttdeci">MoFEMErrorCode setBoundaryLhsIntegrationRule(RuleHookFun rule)</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00632">PipelineManager.hpp:632</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_a866330d80871ff595ebe39592e89c44d"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#a866330d80871ff595ebe39592e89c44d">MoFEM::PipelineManager::setBoundaryRhsIntegrationRule</a></div><div class="ttdeci">MoFEMErrorCode setBoundaryRhsIntegrationRule(RuleHookFun rule)</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00659">PipelineManager.hpp:659</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_ab8492b86e615e99db109a5478e0d7154"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#ab8492b86e615e99db109a5478e0d7154">MoFEM::PipelineManager::getBoundaryRhsFE</a></div><div class="ttdeci">boost::shared_ptr&lt; FEMethod &gt; &amp; getBoundaryRhsFE()</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00463">PipelineManager.hpp:463</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html_ac81815a59f303199fc9f63e598040f00"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html#ac81815a59f303199fc9f63e598040f00">MoFEM::PipelineManager::setDomainLhsIntegrationRule</a></div><div class="ttdeci">MoFEMErrorCode setDomainLhsIntegrationRule(RuleHookFun rule)</div><div class="ttdef"><b>Definition</b> <a href="PipelineManager_8hpp_source.html#l00578">PipelineManager.hpp:578</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoab_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">MoFEM::PostProcBrokenMeshInMoab</a></div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00677">PostProcBrokenMeshInMoabBase.hpp:677</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html_a1520c7c26036ada71ab50417fb2e8b85"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html#a1520c7c26036ada71ab50417fb2e8b85">MoFEM::ProblemsManager::markDofs</a></div><div class="ttdeci">MoFEMErrorCode markDofs(const std::string problem_name, RowColData rc, const enum MarkOP op, const Range ents, std::vector&lt; unsigned char &gt; &amp;marker) const</div><div class="ttdoc">Create vector with marked indices.</div><div class="ttdef"><b>Definition</b> <a href="ProblemsManager_8cpp_source.html#l03553">ProblemsManager.cpp:3553</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html"><div class="ttname"><a href="structMoFEM_1_1Simple.html">MoFEM::Simple</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8hpp_source.html#l00027">Simple.hpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a3d65745e902af842b5c490eedbcd30d1"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a3d65745e902af842b5c490eedbcd30d1">MoFEM::Simple::loadFile</a></div><div class="ttdeci">MoFEMErrorCode loadFile(const std::string options, const std::string mesh_file_name, LoadFileFunc loadFunc=defaultLoadFileFunc)</div><div class="ttdoc">Load mesh file.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00191">Simple.cpp:191</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a8325447a1773550852f04c1b600af703"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a8325447a1773550852f04c1b600af703">MoFEM::Simple::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div><div class="ttdoc">get options</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00180">Simple.cpp:180</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a9261d3ef9b39a00cb7d0acc612702275"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a9261d3ef9b39a00cb7d0acc612702275">MoFEM::Simple::getDM</a></div><div class="ttdeci">MoFEMErrorCode getDM(DM *dm)</div><div class="ttdoc">Get DM.</div><div class="ttdef"><b>Definition</b> <a href="Simple_8cpp_source.html#l00831">Simple.cpp:831</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>