<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Density mapping from CT scans</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="runningprograms.html">Programs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Density mapping from CT scans </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#density_maping">Density mapping</a><ul><li class="level2"><a href="#ct_scan_data">Metafile</a></li>
<li class="level2"><a href="#density_map_input_files">Input files</a></li>
<li class="level2"><a href="#results">Results</a></li>
<li class="level2"><a href="#cube_size">Sampling cube</a></li>
<li class="level2"><a href="#approx">Density approximation</a></li>
<li class="level2"><a href="#merger">Merging two Metafiles into one.</a></li>
<li class="level2"><a href="#real_example">Real CT-data example</a></li>
</ul>
</li>
<li class="level1"><a href="#future_work_density_maps">Future work and contribution</a></li>
<li class="level1"><a href="#acknowledgements">Acknowledgements</a></li>
</ul>
</div>
<div class="textblock"><p>Description of density approximation from CT scan data (Usage example)</p>
<p><img src="vet_school_logo.png" alt="" align="right" class="inline"/> This is simple example how to map density field on the finite element tetrahedral mesh from CT scan data which subsequently can be used for the bone remodelling or fracture analysis. <br  />
Unlike most available material properties mapping scripts, this code not only integrates the CT scan data within finite elements but also provides approximation capabilities with many adjustable parameters. This allows to produce smooth field, neglecting the noise and inaccuracies from CT scanning. <br  />
 <br  />
Implementation of the following example can be found in the <a class="el" href="group__bone__remodelling.html">Bone remodeling</a> module.</p>
<div class="image">
<img src="graph_mapping.png" alt="" width="700px"/>
<div class="caption">
Workflow diagram. Input files are: <em></em>.mhd + <em></em>.raw (3D image) and corresponding finite elements mesh (<em></em>.vtk).</div></div>
<h1><a class="anchor" id="density_maping"></a>
Density mapping</h1>
<p>In order to conduct mapping the user has to provide CT scan data in <em></em>.mhd + <em></em>.raw format. It can be usually exported from the program that was used for segmentation e.g. <a href="https://www.slicer.org">3D Slicer </a> or by the conversion of standard DICOM format to Metafile by means of many available converters, like <a href="http://lcni.uoregon.edu/downloads/mriconvert">MRIConvert </a>. Subsequently two parameters (a,b) for linear image data - density field relation has to by defined, otherwise direct CT values from the image will be mapped.</p>
<p>Following description and line commands are in presumption that users parent working directory is <em>users_modules/bone_remodelling/</em> in build directory. All input files used in this example can be found in the example directory.</p>
<h2><a class="anchor" id="ct_scan_data"></a>
Metafile</h2>
<p>MetaImage is the text-based tagged file format for medical images included in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library. For full documentation see <a href="https://itk.org/Wiki/ITK/MetaIO/Documentation">link </a>. MetaIO file format (<em></em>.mhd) can support a variety of objects. For density mapping simple MetaImage is used, its consists raw file that stores value of each voxel and MetaHeader file (<em></em>.mhd). For example:</p>
<div class="fragment"><div class="line">ObjectType = Image</div>
<div class="line">NDims = 3</div>
<div class="line">BinaryData = True</div>
<div class="line">BinaryDataByteOrderMSB = False</div>
<div class="line">CompressedData = False</div>
<div class="line">ElementSpacing = 1 1 1</div>
<div class="line">DimSize = 50 50 50</div>
<div class="line">ElementType = MET_FLOAT</div>
<div class="line">ElementDataFile = image.raw</div>
</div><!-- fragment --><p>Above header means that we deal with 3 dimensional image that has resolution of 50 x 50 x 50 voxels (<em>DimSize</em>), spacing between the voxels is equal to 1 in all directions (<em>ElementSpacing</em>), data for each voxel is loaded from binary image.raw file (<em>ElementDataFile</em>) and they are <em>float</em> type (<em>ElementType</em>). Data from that file can be read easily by looping over Z, Y and X coordinates as presented in example below: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0;</div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> Z = 0; Z != dim_size_Z; Z++) {</div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> Y = 0; Y != dim_size_Y; Y++) {</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> X = 0; X != dim_size_X; X++) {</div>
<div class="line">      data[<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] = meta_file1.ElementData(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>++);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><h2><a class="anchor" id="density_map_input_files"></a>
Input files</h2>
<p>Mesh file can be created with Cubit journal file (sphere.jou), </p><div class="fragment"><div class="line">reset</div>
<div class="line">create sphere radius 40 inner radius 20</div>
<div class="line">volume all size auto factor 6</div>
<div class="line">volume all scheme tetmesh</div>
<div class="line">mesh volume all</div>
<div class="line">move volume 1 location 49.5 49.5 49.5  #move cube to the center of ct image</div>
<div class="line"> </div>
<div class="line">save as &quot;users_modules/bone_remodelling/examples/sphere_test.cub&quot; overwrite</div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --><p> Any other software that allows to export <em></em>.vtk or <em></em>.h5m mesh file can be used. User is also obligated to ensure that mesh of the mapped object is in the right position of the CT scan image. Fortunately, most of the discretisation codes do not change coordinates of segmented volumes. In this example artificial CT-data is used. All voxels inside the mesh have value equal to 1, outside 0. </p><div class="image">
<img src="merged_data.png" alt="" width="700px"/>
<div class="caption">
Data set for above example. Metafile with geometry inside (left) and generated mesh (right).</div></div>
<h2><a class="anchor" id="execution"></a>
Executing code</h2>
<p>Line command executing mapping should be run from users_modules/bone_remodelling/ in build directory </p><div class="fragment"><div class="line">mbconvert examples/sphere_test.cub examples/sphere_test.vtk &amp;&amp; \</div>
<div class="line">mpirun -np 4 ./mass_calculation \</div>
<div class="line">-meta_image examples/sphere_test.mhd -my_file examples/sphere_test.vtk \</div>
<div class="line">-param_density 1,0 \</div>
<div class="line">-cube_size 3 \</div>
<div class="line">-dist_tol 1 \</div>
<div class="line">-my_order 1 \</div>
<div class="line">-filter 0 \</div>
<div class="line">-<a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> 1 \</div>
<div class="line">-ksp_type cg -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor \</div>
<div class="line">&amp;&amp; mbconvert out.h5m out.vtk  &amp;&amp; open out.vtk</div>
</div><!-- fragment --><p>Notes:</p><ul>
<li>Conversion from cub to vtk file format</li>
<li>Option -np gives the number of processors to run on</li>
<li>MetaImage and mesh are loaded with <em>-meta_image</em> and <em>-my_file</em> commands, respectively</li>
<li>Parameters for grayscale-density relation can be set by <em>-param_density</em> where numbers between coma denote a and b parameters, respectively. <p class="formulaDsp">
\[ a\cdot CT+b=\rho \]
</p>
</li>
<li>Size of the sampling cube is controlled by <em>-cube_size</em> (default: 0)</li>
<li>Magnitude of the translation of sampling cube from mesh border is controlled by <em>-dist_tol</em> (default: 0)</li>
<li>Approximation order can be set by using <em>-my_order</em> </li>
<li>Option <em>-filter</em> sets number of filter (default: Gaussian smoothing)</li>
<li>Option <em>-lambda</em> sets coefficient for laplacian smoothing (default: 1)</li>
<li>Solver settings, see <a href="https://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/KSP">https://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/KSP</a></li>
</ul>
<h2><a class="anchor" id="results"></a>
Results</h2>
<p>Execution of above command results in following outcomes: </p><div class="fragment"><div class="line">Volume 231685.77206578955519944429397583</div>
<div class="line">Mass 222572.05119590519461780786514282</div>
<div class="line">Mass after approximation 231685.77098474738886579871177673</div>
</div><!-- fragment --><p> Since all voxels within mesh have value equal to 1 and default ( \(a = 1, b = 0\)) relationship was set, mapped density is 1 at any point and mass of the model should be equal to its volume.</p>
<div class="image">
<img src="simple_result.png" alt=""/>
<div class="caption">
Results of the mapping on a simple sphere (cross sections presented) for 3 different sampling cube sizes</div></div>
<p> Note that for the coarse meshes (like in the example above) some of the integration points can be assigned with values of the voxels outside the volume of the CT-scanned object which can cause unwanted artifacts like presented in the figure above. To reduce that problem and achieve the exact solution, cube size parameter was adjusted. </p><div class="image">
<img src="converg_exampl.png" alt=""/>
<div class="caption">
Calculated mass for a different cube sizes. Convergence can be observed. </div></div>
<h2><a class="anchor" id="cube_size"></a>
Sampling cube</h2>
<p>Since high noise in CT scan data is expected, sampling volume at each integration point was implemented. Within this volume data from surounding point is collected and estimated into one value by means of 3 optional functions:</p>
<ul>
<li>1D Gaussian smoothing (<em>-filter</em> 0, default)</li>
<li>Average (<em>-filter</em> 1)</li>
<li>Median (<em>-filter</em> 2)</li>
</ul>
<p>Definition of all above functions can be found in <a class="el" href="structBoneRemodeling_1_1DataFromMetaIO.html">BoneRemodeling::DataFromMetaIO</a>. </p><div class="image">
<img src="cube_sizes.png" alt="" width="700px"/>
<div class="caption">
Sampling cube around Gauss point for three example sizes. <em>r</em> is a distance from Gauss point to voxel. </div></div>
<p>Cube dimensions are correlated with voxel size. (<em>ElementSpacing</em> in <em></em>.mhd file) Cube size 1 means that sampling box contains 2x2x2 voxels, size 2 means 4x4x4 etc. For cube size 0, Gauss point assigns value from nearest voxel in CT image lattice, by simple rounding coordinates.</p>
<p>It is well know fact that raw CT scan data can be affected by so called <em>Partial<em>Volume<em>Effects</em>.</em> Each</em> voxel in a CT image represents the attenuation properties of a specific material volume, if that volume is comprised of different materials (e.g bone and air) then the resulting CT value is an average of their properties. Furthermore, all object boundaries are blurred to some extent, and thus the material in any one voxel can affect CT values of surrounding voxel. To handle this problem <em>-dist_tol</em> parameter is introduced. Figure below presents how it works.</p>
<div class="image">
<img src="shifting_cubes.png" alt=""/>
<div class="caption">
Effect of the <em>dist_tol</em> parameter. Sampling cubes on the surface of mesh are shifted towards inside of the object. </div></div>
<p>When <em>-dist_tol</em> parameter is used, sampling cube at every integration close to the mesh surface will be shifted by value equal to <em>-cube_size</em> defined. Thanks to this, voxels involved into <em>Partial</em> <em>Volume</em> <em>Effects</em> will not be taken into consideration during collection data for integration points. Distance of the integration points is calculated in <a class="el" href="structBoneRemodeling_1_1SurfaceKDTree.html">BoneRemodeling::SurfaceKDTree</a> class, subsequently it is used for density calculation at Gauss points in <a class="el" href="structBoneRemodeling_1_1OpCalulatefRhoAtGaussPts.html">BoneRemodeling::OpCalulatefRhoAtGaussPts</a> .</p>
<h2><a class="anchor" id="approx"></a>
Density approximation</h2>
<p>In order to produce smooth, continuous (H1 space) density field least squares approximation is proposed. The approach involves minimizing the following expression: </p><p class="formulaDsp">
\[ f=\int_{V}\left(R(q,q^{\ast})\right)^{2}\,dV \]
</p>
<p> The goal is to find values of \(q\) for the approximation which best fit the data. Least squares method finds its optimum when the sum \(f\) of squared residuals \(R\) is minimum. Herein a residual is defined as the difference between actual value of density acquired from CT scan - \(q^{\ast}\) and the approximated value \(q\), where \(\phi\) is a value of basic function at considered Gauss point: </p><p class="formulaDsp">
\[ R=\phi q-q^{\ast} \]
</p>
<p> Substituting \( R \) to the equation above results in: </p><p class="formulaDsp">
\[ f=\int_{V}(\phi^{T}q^{T}-q^{\ast})(\phi q-q^{\ast})\,dV \]
</p>
<p> In order to find minimum: </p><p class="formulaDsp">
\[ \frac{\partial f}{\partial q}=\int_{V}2\phi^{T}\phi q-2\phi^{T}q^{\ast}\,dV=0 \]
</p>
<p> This is linear system of equations: </p><p class="formulaDsp">
\[ K q=\mathbf{f} \]
</p>
<p> where: </p><p class="formulaDsp">
\[ K_{e}=\int_{V_{e}}\phi\phi^{T}\,dV_{e} \qquad \mathbf{f}_{e}=\int_{V_{e}}\phi q^{\ast}\,dV_{e} \]
</p>
<p> Above matrix \( K \) and vector \( \mathbf{f} \) are assembled in <a class="el" href="structBoneRemodeling_1_1OpCalculateLhs.html">BoneRemodeling::OpCalculateLhs</a> and <a class="el" href="structBoneRemodeling_1_1OpAssmbleRhs.html">BoneRemodeling::OpAssmbleRhs</a>, respectively. Additionally, to the matrix \( K \) we introduce optional laplacian smoothing term with adjustable coefficient \( \lambda \) (-lambda parameter, can be set as 0): </p><p class="formulaDsp">
\[ K_{e}=\int_{V_{e}}\phi\phi^{T}+\lambda \nabla\phi\nabla\phi^{T}\,dV_{e} \]
</p>
<p>For full code see <a class="el" href="DensityMaps_8hpp.html" title="Operator can be used with any volume element to calculate sum of volumes of all volumes in the set.">DensityMaps.hpp</a>.</p>
<h2><a class="anchor" id="merger"></a>
Merging two Metafiles into one.</h2>
<p>Sometimes it is impossible to scan long object in a CT-scanner with high resolution at once. Instead, multiple indvidual scans can be performed in order to collect all required data. Subsequently, all this data has to be merged to obtain one consistent image for the FE model or density mapping. For such purposes simple script <a class="el" href="mhd__merger_8cpp.html">mhd_merger.cpp</a> was implemented. It is extremly easy to use and extendable. With a little effort CT-scan data can be resampled, cropped or even created e.g. for testing purposes. Usage example: </p><div class="fragment"><div class="line">./mhd_merger \</div>
<div class="line">-meta_image1 mhd_cube1.mhd \</div>
<div class="line">-meta_image2 mhd_cube1.mhd \</div>
<div class="line">-my_vector 5,0,-2</div>
</div><!-- fragment --><p> Execution of above command results in \en newImage.mhd file, where two images are merged into one. Voxels of the second file are shifted by vector (5,0,-2) which stands for X,Y,Z coordinates. In can be useful in case when two scans with the same resolution are not perfectly aligned.</p>
<h2><a class="anchor" id="real_example"></a>
Real CT-data example</h2>
<p>Files for the following example are: entire equine 3rd metacarpal bone CT-scan and corresponding coarse mesh. Files are also located in <em>users_modules/bone_remodelling/examples/</em> directory. </p><div class="image">
<img src="mesh_dicom_bone.png" alt=""/>
<div class="caption">
CT scan from equine 3rd metacarpal bone (right) and corresponding FE mesh (left) </div></div>
<p> Executing command: </p><div class="fragment"><div class="line">mpirun -np 4 ./mass_calculation -meta_image examples/CT_attempt_quadr_full.mhd -my_file examples/linear_mesh_full_coarse.vtk \</div>
<div class="line">-param_density 0.63,1040 \</div>
<div class="line">-cube_size 3 \</div>
<div class="line">-dist_tol 1.5 \</div>
<div class="line">-my_order 1 \</div>
<div class="line">-<a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> 1 -ksp_type cg -pc_type lu -pc_factor_mat_solver_package mumps \</div>
<div class="line">&amp;&amp; mbconvert out.h5m out.vtk  &amp;&amp; open out.vtk</div>
</div><!-- fragment --><p> Note that above density parameters a,b were taken from calibration phantoms which is highly recommended, since every CT scan can have a slightly different scale. Results: </p><div class="fragment"><div class="line">Volume 284272.32756731595145538449287415</div>
<div class="line">Mass 486005295.26822173595428466796875</div>
<div class="line">Mass after approximation 494908572.81251567602157592773438</div>
</div><!-- fragment --> <div class="image">
<img src="bone_gif.gif" alt=""/>
<div class="caption">
Density mapped on a metacarpal bone</div></div>
<p> Accuracy of the mapped density can be easily improved by simple increasing order of approximation: </p><div class="fragment"><div class="line">-my_order 3</div>
</div><!-- fragment --><p> Results of the mapping with changed order are presented below. Additionally, gradient of density field is introduced. Such plot can indicate regions with rapid changes in density which might be crucial e.g. to distinguish possible fracture locations. </p><div class="image">
<img src="map_bone.png" alt=""/>
<div class="caption">
Results with increased order of approximation (left) and density gradient on cross section of a mapped bone (right)</div></div>
<p> Subsequently, parameter study procedure presented for the small sphere example can be followed, in order to achieve similar mass of the model as the actual object (if can be measured).</p>
<h1><a class="anchor" id="future_work_density_maps"></a>
Future work and contribution</h1>
<p>If you like contribute to this module (or <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library) you are welcome. Feel free to add changes, including improving this documentation. If you like to work and modify this user module, you can fork this repository, do pull requests, see <a href="https://bitbucket.org/likask/mofem_um_bone_remodelling">https://bitbucket.org/likask/mofem_um_bone_remodelling</a>. <a class="el" href="structContact.html">Contact</a> us <a href="#" onclick="location.href='mai'+'lto:'+'cma'+'tg'+'u@g'+'oo'+'gle'+'gr'+'oup'+'s.'+'com'; return false;">cmatg<span style="display: none;">.nosp@m.</span>u@go<span style="display: none;">.nosp@m.</span>ogleg<span style="display: none;">.nosp@m.</span>roup<span style="display: none;">.nosp@m.</span>s.com</a> if you need any help or comments. </p>
<h1><a class="anchor" id="acknowledgements"></a>
Acknowledgements</h1>
<p>This user module has been co-developed by the School of Engineering and the Weipers Centre Equine Hospital, School of Veterinary Medicine at the University of Glasgow. The authors are particularly grateful to the staff of the Small Animal Hospital, where the CT scans of the equine metacarpal bone were performed. Kelvin Smith PhD Scholarship is acknowledged for providing financial support for this research.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000070">Todo:</a></b></dt><dd><p class="startdd">Make a video tutorial of the presented example </p>
<p class="interdd">Add scale parameter, in case when ct-image data and FE mesh are defined in different units (e.g. <em>mm</em> and <em>m</em>) </p>
<p class="interdd">Input directly DICOM files (itk library) </p>
<p class="interdd">Solving boundary and partial volume effects artifacts in a more elegant way </p>
<p class="interdd">Add more capabilities to <a class="el" href="mhd__merger_8cpp.html">mhd_merger.cpp</a> </p>
<p class="enddd">Integrate into code (or descibe in documentation) tetrahedral meshing from .stl files by using available open source codes.</p>
</dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition:</b> <a href="incompressible__elasticity_8cpp_source.html#l00199">incompressible_elasticity.cpp:199</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>