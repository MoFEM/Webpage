<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Gel Model Sorption (response to an environmental change)</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="runningprograms.html">Programs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Gel Model Sorption (response to an environmental change) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#gel_sorption_mesh">Mesh</a><ul><li class="level2"><a href="#gel_sorption_journal_file">Journal File (sorption_cube.jou)</a></li>
</ul>
</li>
<li class="level1"><a href="#gel_sorption_material_properties">Material Properties</a></li>
<li class="level1"><a href="#gel_sorption_chemical">Chemical Load History</a></li>
<li class="level1"><a href="#run">Executing Problem</a></li>
<li class="level1"><a href="#gel_sorption_results">Results</a></li>
</ul>
</div>
<div class="textblock"><p>This is an example on how to run a simulation of a gel responding to a change in environmental conditions</p>
<p>To examine the free-swelling response of a gel sample, a bar section is modelled in an environment of increased/decreased relative humidity (RH). A Dirichlet BC ( \(\mu\)) is imposed on surface 4 and a Neumann symmetry condition is imposed on surface 6. For more details how to calculate chemical load form relative humidity see <a class="el" href="gel_creep.html#gel_creep_boundary">Dirichelt boundary condition for chemical potential</a>. Details about consider mechanical model can be found in <a class="el" href="gel_creep.html#gel_creep_mechanical_model">Mechanical model</a>.</p>
<h1><a class="anchor" id="gel_sorption_mesh"></a>
Mesh</h1>
<p>Mesh is a 1/8th section of a rectangular cube, with 3 Dirichlet boundary conditions on the external faces and 3 Neumann conditions on the inner faces to impose symmetry. All dimensions are given in metres (m) and the chemical load is Gibb's free energy per solvent molecule entering the system with the units in Joules (J).</p>
<div class="image">
<img src="automesh7_sorption.png" alt="" width="500px"/>
<div class="caption">
Sorption Mesh</div></div>
<h2><a class="anchor" id="gel_sorption_journal_file"></a>
Journal File (sorption_cube.jou)</h2>
<div class="fragment"><div class="line">reset</div>
<div class="line">set duplicate block elements on</div>
<div class="line"> </div>
<div class="line">brick x 0.0025 y 0.00041 z 0.00041</div>
<div class="line"> </div>
<div class="line"># Set block with volume with gel material</div>
<div class="line">block 1 volume all</div>
<div class="line">block 1 name &#39;GEL&#39;</div>
<div class="line"> </div>
<div class="line"># Set Dirichelt boundary condition for solvent concentration</div>
<div class="line">block 2 surface 2 3 4</div>
<div class="line">block 2 name &#39;CHEMICAL_LOAD_1&#39;</div>
<div class="line">block 2 attribute count 1</div>
<div class="line">block 2 attribute index 1 6.624729054813950e-18</div>
<div class="line"> </div>
<div class="line"># Set solvent flux, i.e. </div>
<div class="line">block 4 surface 1 5 6</div>
<div class="line">block 4 name &#39;FLUX_CHEMICAL_LOAD_2&#39;</div>
<div class="line">block 4 attribute count 1</div>
<div class="line">block 4 attribute index 1 0</div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field</div>
<div class="line">create displacement on surface 6 dof 1 fix 0</div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field</div>
<div class="line">create displacement on surface 5 dof 2 fix 0</div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field</div>
<div class="line">create displacement on surface 1 dof 3 fix 0</div>
<div class="line"> </div>
<div class="line"># Make a mesh</div>
<div class="line">volume all scheme Tetmesh</div>
<div class="line">volume all size auto factor 7</div>
<div class="line">mesh volume all</div>
<div class="line"> </div>
<div class="line"># Set block 3 and set 10 node tetrahedrons in that block</div>
<div class="line">block 3 tet all</div>
<div class="line">block 3 element type TETRA10</div>
</div><!-- fragment --><p> Above file can be found in <em>$GEL_MODULE_DIRECTORT/meshes/sorption_cube</em>.jou</p>
<h1><a class="anchor" id="gel_sorption_material_properties"></a>
Material Properties</h1>
<p>A simple section of amorphous cellulosic material is described. This material exhibits a viscoelastic response and is highly interactive with atmospheric water vapour content and makes a good case for analysis. The volume per solvent molecule (water) in it's liquid form, after binding to the gel, is given by oMega in \(\text{m}^3\).</p>
<div class="fragment"><div class="line"># Material parameters for Gel material model</div>
<div class="line"> </div>
<div class="line"># Spring Alpha</div>
<div class="line">gAlpha = 6e3</div>
<div class="line">vAlpha = 0.232</div>
<div class="line"> </div>
<div class="line"># Spring Beta</div>
<div class="line">gBeta = 6e3</div>
<div class="line">vBeta = 0.232</div>
<div class="line"> </div>
<div class="line"># Daspot</div>
<div class="line">gBetaHat = 9e6</div>
<div class="line">vBetaHat = 0.232</div>
<div class="line"> </div>
<div class="line"># Volume per solvent molecule</div>
<div class="line">oMega = 2.988970058e-20</div>
<div class="line"> </div>
<div class="line"># Initial chemical potential</div>
<div class="line">mU0 = 0</div>
<div class="line"> </div>
<div class="line"># Solvent transport material parameters</div>
<div class="line">vIscosity = 9e6</div>
<div class="line">pErmeability = 3.4e-8</div>
<div class="line"> </div>
<div class="line"># User can set approximation order for each blocks independently</div>
<div class="line"># Set approximation order of block 1 as quadratic function.</div>
<div class="line"> </div>
<div class="line">[block_1]</div>
<div class="line"> </div>
<div class="line">oRder = 2</div>
</div><!-- fragment --><p>Above file can be found <em>$GEL_MODULE_DIRECTORT/gel_config_creep_sorption_example</em>.in</p>
<h1><a class="anchor" id="gel_sorption_chemical"></a>
Chemical Load History</h1>
<p>Changes in external environmental conditions can be implemented within the simulation using the chemical load history file. A scale factor is applied to the external BC at a given time. The input file contains the time in the left hand column and the scale factor in the right hand column. The scale factor relates the current applied chemical load to the initial applied chemical load at time zero (i.e. when the scale factor is 1.0).</p>
<p>To pre-determine the time of viscoelastic relaxation \((T_v)\) for each time step, the diffusivity can be calculate, entirely from the already determined material properties (section Material Properties). Taking the smallest length will be sufficient for determination in the case where adsorption is allowed on every exposed face (in this case L = 0.00041m)</p>
<p class="formulaDsp">
\[ D = {2 \kappa \over \eta} \left( {{1-\nu^\alpha}\over{1-2\nu^\alpha}}G^\alpha + {{1-\nu^\beta}\over{1-2\nu^\beta}}G^\beta \right) \]
</p>
<p>The time for viscoelastic relaxation, \(T_v\), can then be determined </p><p class="formulaDsp">
\[ T_v = {L^2 \over D} \]
</p>
<p>The following is a chemical load history for an entire sorption cycle from 0 to 50% relative humidity and then back down to zero.</p>
<div class="fragment"><div class="line">0   1.000000</div>
<div class="line">3486    1.000000000000000E+00</div>
<div class="line">3487    1.430676558073390E+00</div>
<div class="line">6978    1.430676558073390E+00</div>
<div class="line">6979    1.682606194485980E+00</div>
<div class="line">10473   1.682606194485980E+00</div>
<div class="line">10474   1.861353116146790E+00</div>
<div class="line">13970   1.861353116146790E+00</div>
<div class="line">13971   2.000000000000000E+00</div>
<div class="line">17465   2.000000000000000E+00</div>
<div class="line">17466   2.113282752559380E+00</div>
<div class="line">20955   2.113282752559380E+00</div>
<div class="line">20956   2.209061955122170E+00</div>
<div class="line">24439   2.209061955122170E+00</div>
<div class="line">24440   2.292029674220180E+00</div>
<div class="line">27913   2.292029674220180E+00</div>
<div class="line">27914   2.365212388971970E+00</div>
<div class="line">31379   2.365212388971970E+00</div>
<div class="line">31380   2.430676558073390E+00</div>
<div class="line">34836   2.430676558073390E+00</div>
<div class="line">34837   2.365212388971970E+00</div>
<div class="line">38302   2.365212388971970E+00</div>
<div class="line">38303   2.292029674220180E+00</div>
<div class="line">41776   2.292029674220180E+00</div>
<div class="line">41777   2.209061955122170E+00</div>
<div class="line">45260   2.209061955122170E+00</div>
<div class="line">45261   2.113282752559380E+00</div>
<div class="line">48750   2.113282752559380E+00</div>
<div class="line">48751   2.000000000000000E+00</div>
<div class="line">52245   2.000000000000000E+00</div>
<div class="line">52246   1.861353116146790E+00</div>
<div class="line">55742   1.861353116146790E+00</div>
<div class="line">55743   1.682606194485980E+00</div>
<div class="line">59237   1.682606194485980E+00</div>
<div class="line">59238   1.430676558073390E+00</div>
<div class="line">62729   1.430676558073390E+00</div>
<div class="line">62730   1.000000000000000E+00</div>
<div class="line">66215   1.000000000000000E+00</div>
<div class="line">66216   0.000000000000000E+00</div>
<div class="line">69695   0.000000000000000E+00</div>
</div><!-- fragment --><p>Above file can be found in <em>$GEL_MODULE_DIRECTORY/my_chemical_load_history</em>.in</p>
<h1><a class="anchor" id="run"></a>
Executing Problem</h1>
<div class="fragment"><div class="line">mpirun -np 4 ./gel_analysis -my_file sorption_cube.cub -my_gel_config \</div>
<div class="line">gel_config_creep_sorption_example.in -my_chemical_load_history my_chemical_load_history.in \</div>
<div class="line">-ksp_type fgmres -ksp_final_residual -ksp_monitor -ksp_converged_reason \</div>
<div class="line">-pc_type lu -pc_factor_mat_solver_package mumps -my_order 3 -snes_monitor \</div>
<div class="line">-ts_type beuler -ts_dt 20 -ts_final_time 70000 -my_output_prt 10 \</div>
<div class="line">-snes_linesearch_type basic  -ts_monitor</div>
</div><!-- fragment --><p>Notes:</p>
<ul>
<li>Option <em>-my_file</em> gives name of the mesh file</li>
<li>Option <em>-my_gel_config</em> gives the name of the material configuration file</li>
<li>Option <em>-my_chemical_load_history</em> gives the name of the chemical load history file</li>
<li>Option <em>-ts_dt</em> gives the size of each time step in seconds (s)</li>
<li>Option <em>-ts_final_time</em> gives the final time in seconds (s)</li>
<li>Option <em>-my_output_prt</em> gives the number of vtk files output (i.e. -my_output_prt 1, means each time step is processed)</li>
<li>Option <em>-np</em> gives the number of processors to run on</li>
</ul>
<h1><a class="anchor" id="gel_sorption_results"></a>
Results</h1>
<p>The graph below shows the overall displacement due to the chemical load entering the system. Each curve within the cycle is representative of an step change in the chemical activity on the boundary, from initial elastic response to the end of the time dependent response when all load is taken by spring \alpha.</p>
<div class="image">
<img src="sorption_cycle.jpg" alt="" width="700px"/>
<div class="caption">
Sorption Cycle</div></div>
<p>Deformation as result of changing environment is shown of animation below </p><div class="image">
<img src="sorption.gif" alt="" width="400px"/>
<div class="caption">
Sorption Cycle</div></div>
 </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>