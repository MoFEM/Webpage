<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Unsaturated flow in 2D</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="runningprograms.html">Programs</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Unsaturated flow in 2D </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#math_model">Unsaturated flow model</a></li>
<li class="level1"><a href="#geometry">Creating the geometry</a></li>
<li class="level1"><a href="#initial_boundary">Physical groups</a></li>
<li class="level1"><a href="#mesh_gen">Meshing</a></li>
<li class="level1"><a href="#execute">Executing the code</a></li>
<li class="level1"><a href="#output_vis">Visualizing the output</a></li>
<li class="level1"><a href="#Exercise">Exercise</a></li>
</ul>
</div>
<div class="textblock"><p >This tutorial deals with the usage of the <b>unsaturated_2Dflow</b> module to simulate/analyse the flow of water or chemical (or fluid in general) in a variably saturated matrix. The emphasis is not on the finite element implementation; rather it is on the preprocessor and description of how the code is run. </p><div class="image">
<img src="flow_rec.gif" alt="" width="600px"/>
</div>
<p> The presentation includes:</p><ul>
<li>An overview of the mathematical equation</li>
<li>The creation of the geometry and physical groups in Gmsh</li>
<li>Meshing the geometry in Gmsh</li>
<li>Executing the code and parameter input arguments</li>
<li>Converting output into vtk</li>
<li>Visualizing the output in paraView</li>
</ul>
<h1><a class="anchor" id="math_model"></a>
Unsaturated flow model</h1>
<p >The mathematical equation describing the movement of water or chemicals in a variably saturated matrix is usually given by Richards' model  </p><p class="formulaDsp">
\[
\frac{\partial \theta(h)}{\partial t} - \mathrm{div}\,[K(h)\,\mathrm{grad}\,(h - z)] = 0
\]
</p>
<p >where \(h\) is the pressure head, \(\theta\) the water (chemical) content is a function of \(h\). The hydraulic conductivity \(K\) is positive definite. The variable \(z\) refers to the vertical distance in the case of vertical flow against the action of gravitational force. However, when the flow is assumed to be restricted in the horizontal plane (i.e., \(z\) is constant), the contribution of \(z\) is ignored. <br  />
</p>
<p >A full description of the above model requires constitutive laws for the fluid content \(\theta(h)\) and hydraulic conductivity \(K(h)\), and boundary and initial conditions. These constitutive laws depend on the particular material (such as the matrix and the fluid) properties under consideration.</p>
<p >In this example, we consider the modified van Genuchten (MVG) constitutive laws. The volumetric fluid content constitutive equation is given as  </p><p class="formulaDsp">
\[ 
\theta(h) = \begin{cases} 
      \theta_r + \frac{\theta_m - \theta_r}{[1+(-\alpha h)^n]m}, &amp; h &lt; h_s\\
      \theta_s, &amp; h\leq h_s
   \end{cases}
\]
</p>
<p> where \(\theta_r\) and \(\theta_s\),are positive material parameters referred to as residual and saturated fluid contents. The parameter \(h_s\) is the minimal capillary pressure, and \(\theta_m\) is a fictitious modelling parameter. \(\alpha\) and \(n\) are empirical shape parameters. In addition, the constitutive equation for the hydraulic conductivity is given by</p>
<p class="formulaDsp">
\[ 
\theta(h) = \begin{cases} 
      K_s\,K_r(h), &amp; h &lt; h_s\\
      K_s, &amp; h\leq h_s
   \end{cases}
\]
</p>
<p> where \(K_s\) is the saturated hydraulic conductivity and \(K_r\) is the unsaturated hydraulic conductivity, which is related to \(h\) through the effective saturation \(S_e\) (volume fraction representing the composition of fluid in the matrix-fluid mixture) by  </p><p class="formulaDsp">
\[
K_r = S_e^\ell \bigg[ \frac{1-F(S_e)}{1-F(1)}\bigg]^2
\]
</p>
<p >where \(\ell\) is the pore connectivity parameter usually assumed to be \(0.5\), and the function \(F\) is given by</p>
<p class="formulaDsp">
\[
F = \bigg[1-\bigg(\frac{\theta_s - \theta_r}{\theta_m - \theta_r}S_e\bigg)^{1/m}\bigg]^m
\]
</p>
<p> and the effective saturation is given by  </p><p class="formulaDsp">
\[
S_e = \frac{\theta - \theta_r}{\theta_s - \theta_r}
\]
</p>
<p> Here \(m = 1 - 1/n\), \(n&gt;1\).</p>
<p >The values of the parameters used in this problem represents \(K_s = 1.0, \ell = 0.5, \theta_r = 0.045, 
\theta_s = 0.43, \theta_m = 0.43, n = 5.38, \alpha = 1.8125\) and \(h_s = 0.00\).</p>
<p >The boundary conditions are divided into two (see <a class="el" href="unsaturated_flow.html#fig_1_domain">Fig 1</a>); one that prescribes the pressure head \(h\) on a given part of the boundary \(\Gamma_1\), the other one prescribes the flux on the rest of the boundary \(\Gamma_2 = \partial\Omega - \Gamma_1\). Usually the second type of boundary condition is zero flux which corresponds to an insulation of the boundary, i.e., no material is coming in and out of the boundary.</p>
<p >The initial condition prescribes the pressure head \(h\) at the beginning of the simulation, in this example we consider a homogeneous initial condition, i.e., \(h = h_s\)</p>
<h1><a class="anchor" id="geometry"></a>
Creating the geometry</h1>
<p >The problem considered in this tutorial is the lateral flow of a dissolvable fluid in a simple rectangular paper slide as shown in <a class="el" href="unsaturated_flow.html#fig_1_domain">Fig 1</a>. Part of the boundary labeled \(\Gamma_1\) is in contact with a source of the fluid associated with pressure head \(h = C\). The rest of the boundary, i.e., \(\Gamma_2\), is insulated.</p>
<p ><a class="anchor" id="fig_1_domain"></a></p><div class="image">
<img src="domain.png" alt="" width="600px"/>
<div class="caption">
Figure 1: Domain and boundary decomposition</div></div>
<p >The geometry of the paper slide \(\Omega\) has been created in Gmsh, a open-source mesh generating software. Later, the geometry has been saved in to a .geo file that can be opened in any text editor, which in turn provides an alternative way of modifying it.</p>
<p >A simple two step procedure to create this rectangular geometry is as follows: first open the Gmsh software, then go to </p><div class="fragment"><div class="line">File -&gt; New -&gt; Choose directory -&gt; give name (e.g., paper_network.geo) -&gt; save -&gt; choose OpenCASCADE from the dialogue box</div>
</div><!-- fragment --><div class="image">
<img src="opencascade.png" alt="" width="800px"/>
</div>
<p >Next, on the left click on the <b>Module</b>; this opens three branches namely <b>Geometry</b>, <b>Mesh</b> and <b>Solver</b>, then follow </p><div class="fragment"><div class="line">Geometry -&gt; Elementary entities -&gt; Add -&gt; Rectangle  </div>
</div><!-- fragment --><p> A dialogue page appears as shown below, press "shift" key to hold position and enter X = 0, Y = 0, Z = 0 as the coordinates of the left corner of the rectangle and enter DX = 0.02 and DY = 0.005 as the dimensions, make sure that <b>radius</b> <b>rounded</b> is set to 0. Then click <b>Add</b> on the dialogue box. </p><div class="image">
<img src="creat_rect1.png" alt="" width="800px"/>
</div>
<p >To finish creating the rectangle press "q" key to abort. Now the rectangle is created.</p>
<div class="image">
<img src="creat_rect2.png" alt="" width="800px"/>
</div>
<h1><a class="anchor" id="initial_boundary"></a>
Physical groups</h1>
<p >Physical groups refers to regions in the domain where various values are prescribed, for example, boundary conditions, initial conditions, material parameters etc. For the problem under consideration, we only need two types of physical groups, initial and boundary conditions. Now go back to our rectangle in Gmesh. Note that every <b>Point</b>, <b>Line</b> or <b>Plane</b> is allocated a unique ID by Gmsh as it is created, automatically. To view such ID's, under the <b>Tools</b> Menu choose <b>Options</b>, and in the dialogue box that appears press on the <b>Geometry</b> menu on the left then under <b>Visibility</b> check <b>Curve</b> <b>labels</b> and <b>Surface</b> <b>labels</b> then close the dialogue box.</p>
<div class="image">
<img src="option_vis.png" alt="" width="800px"/>
</div>
<p >To create the boundary entity where pressure head \(h\) is prescribed i.e., \(\Gamma_1\) (Note that it is Line 4), follow </p><div class="fragment"><div class="line">Module -&gt; Geometry -&gt; Physical groups -&gt; Add -&gt; Curve</div>
</div><!-- fragment --><p> Give it a name on the dialogue box appearing, e.g., <b>ESSENTIAL</b>, uncheck <b>Automatic</b> <b>numbering</b> and enter 1 in the <b>Numer</b> field. Hover the the cursor over the rectangle and Click on <b>Line</b> <b>4</b> to select it (then its color is changed to red), and Press "e" to end selection and "q" to abort.</p>
<div class="image">
<img src="essential.png" alt="" width="800px"/>
</div>
<p >Next to choose the Physical Group where the initial condition is prescribed (in this case, only one initial condition which is prescribed over the entire rectangle, i.e. Plane 1, is considered), follow <br  />
 </p><div class="fragment"><div class="line">Module -&gt; Geometry -&gt; Physical groups -&gt; Add -&gt; Surface</div>
</div><!-- fragment --><p> on the dialogue box give it a name, e.g., <b>INITIAL</b>. Select uncheck <b>Automatic</b> <b>numbering</b> and enter 2 on the <b>number</b> field, and the hover over the rectangle and select <b>Plane</b> <b>1</b>, afterwards press "e" to end selection and "q" to abort.</p>
<div class="image">
<img src="initial.png" alt="" width="800px"/>
</div>
<p >This results in the file <b><a class="el" href="paper__network_8geo.html">paper_network.geo</a></b> </p><div class="fragment"><div class="line">// Gmsh project created on Mon Jan 27 21:51:41 2020</div>
<div class="line">SetFactory(&quot;OpenCASCADE&quot;);</div>
<div class="line">Rectangle(1) = {0, 0, 0, 0.02, 0.005, 0};</div>
<div class="line">Physical Curve(&quot;ESSENTIAL&quot;, 1) = {4};</div>
<div class="line">Physical Surface(&quot;INITIAL&quot;, 2) = {1};</div>
</div><!-- fragment --><p> which you can open with any text editor from which you can modify the geometry, for example, for later use we can create variables lx and ly for dimensions of the rectangle as follows</p>
<div class="fragment"><div class="line">// Gmsh project created on Mon Jan 27 21:51:41 2020</div>
<div class="line">SetFactory(&quot;OpenCASCADE&quot;);</div>
<div class="line">lx = 0.02;</div>
<div class="line">ly = 0.005;</div>
<div class="line">Rectangle(1) = {0, 0, 0, 0.02, 0.005, 0};</div>
<div class="line">Physical Curve(&quot;ESSENTIAL&quot;, 1) = {4};</div>
<div class="line">Physical Surface(&quot;INITIAL&quot;, 2) = {1};</div>
</div><!-- fragment --><h1><a class="anchor" id="mesh_gen"></a>
Meshing</h1>
<p >Creating the mesh is simple, once we have the .geo file setup correctly, you load the modified <b><a class="el" href="paper__network_8geo.html">paper_network.geo</a></b> file as follows</p>
<div class="fragment"><div class="line">File -&gt; Open... -&gt; select the file you want to load (in this case is paper_network.geo)</div>
</div><!-- fragment --><p >Then to create the mesh,</p>
<div class="fragment"><div class="line">Module -&gt; Mesh -&gt; 2D </div>
</div><!-- fragment --><p >The rectangle is the meshed into relatively coarser triangles. If you want to refine it, just press <b>Refine</b> <b>by</b> <b>splitting</b> under <b>Mesh</b>. (you can repeat pressing it as many times as required, to get to an acceptable level of refinement.) To save the resulting mesh you need to go to</p>
<div class="image">
<img src="mesh.png" alt="" width="800px"/>
</div>
<div class="fragment"><div class="line">File -&gt; Export -&gt; select a folder you want to save in -&gt; give it a name , e.g., paper_network.msh -&gt; save</div>
</div><!-- fragment --><p> Choose <b>Version</b> <b>2</b> <b>ASCII</b> <b>on</b> the Format field, and press <b>OK</b>.</p>
<p >At this point, we have everything we need to run the programme. But there is one important ingredient that needs to be considered before we use the mesh in the <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> context. First, note that <b></b>.msh file is not directly used by <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. To convert it to a mesh file readable by <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>, i.e., <b></b>.h5m format, we need something referred to as a configuration file of <b></b>.cfg format, which basically contains rules to convert the <b>Physical</b> <b>groups</b> from Gmsh into the corresponding NODESET, SIDESET and BLOCKSET that are understandable by <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. For example, for the mesh generated above the configuration file <b>bc.cfg</b> looks like </p><div class="fragment"><div class="line">[block_1] </div>
<div class="line"> </div>
<div class="line">id=1001</div>
<div class="line">add=BLOCKSET</div>
<div class="line">name=ESSENTIAL</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">[block_2]</div>
<div class="line"> </div>
<div class="line">id=1002</div>
<div class="line">add=BLOCKSET</div>
<div class="line">name=INITIAL</div>
</div><!-- fragment --><p ><b>Note:</b> it is very important that you need to make sure that each Physical Group with its ID matches the block in <b>bc.cfg</b>. This means that, for example, the physical group "ESSENTIAL" has been assigned ID 1 which should be corresponded by [block_1], id=1001, name=ESSENTIAL. Whereas, the Physical Group "INITIAL" with ID 2 should be matched by [block_2], id=1002, name=INITIAL. If there is any mismatch it leads to an entirely wrong result.</p>
<h1><a class="anchor" id="execute"></a>
Executing the code</h1>
<p >All the necessary steps to run the code are encapsulated in following bash script file <b>run.sh</b> </p>
<div class="fragment"><div class="line">#!/bin/bash</div>
<div class="line">  </div>
<div class="line">if  [[ $1 = &quot;-my_file&quot; ]]; then</div>
<div class="line">    echo &quot;Running with input file $2 ...&quot;</div>
<div class="line">    add_meshsets -my_file $2 -meshsets_config bc.cfg -output_file paper_network_pre.h5m</div>
<div class="line">else</div>
<div class="line">  echo &quot;Give the input mesh file name ...&quot;  </div>
<div class="line">  exit</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line">rm -rf out*</div>
<div class="line"> </div>
<div class="line">mofem_part -my_file paper_network_pre.h5m -output_file paper_network_final.h5m -my_nparts 1 -dim 2 -adj_dim 1</div>
<div class="line">if [[ -z &quot;$3&quot; ]]; then</div>
<div class="line">    time mpirun -np 1 ./unsatu2dFlow_prob -file_name paper_network_final.h5m 2&gt;&amp;1 | tee log</div>
<div class="line">elif [[ $3 = &quot;-saturated_conductivity&quot; ]]; then</div>
<div class="line">    time mpirun -np 1 ./unsatu2dFlow_prob -file_name paper_network_final.h5m -saturated_conductivity $4 2&gt;&amp;1 | tee log</div>
<div class="line">fi</div>
<div class="line"> </div>
<div class="line">../../basic_finite_elements/nonlinear_elasticity/do_vtk.sh out*</div>
</div><!-- fragment --><p >Among other things, the above script utilises a file named <b>param_file.ptsc</b> which contains input for the code such as the mesh, order of approximation and parameters for <b>petsc's</b> time solver, linear/non linear solvers, preconditioner, etc. It looks like as follows</p>
<div class="fragment"><div class="line"> -order 1                      # order of approximation</div>
<div class="line"> -saturated_conductivity 0.1   # set default value for K_s </div>
<div class="line"> -save_every_nth_step  4       # time-steps to save output at </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># petsc time solver (ts) arguments</div>
<div class="line"> -ts_monitor                    # to print messages about the time step computations                  </div>
<div class="line"> -ts_exact_final_time stepover  # rule when to stop at the final time</div>
<div class="line"> -ts_dt 0.0000005               # time step size</div>
<div class="line"> -ts_max_time 0.0005          # final time</div>
<div class="line"> -ts_adapt_type none            # no time-adaptivity, i.e., fixed step size</div>
<div class="line"> </div>
<div class="line"> # petsc linear solver arguments, fixed</div>
<div class="line"> -ksp_type gmres </div>
<div class="line"> -pc_type lu </div>
<div class="line"> -pc_factor_mat_solver_type mumps </div>
<div class="line"> </div>
<div class="line"> # petsc nonlinear solver arguments, no need to change them</div>
<div class="line"> -snes_atol 1e-7</div>
<div class="line"> -snes_rtol 1e-12 </div>
<div class="line"> -snes_monitor </div>
<div class="line"> -snes_lag_jacobian 1</div>
</div><!-- fragment --><p >Finally, the code is simply executed using the script file as</p>
<div class="fragment"><div class="line">./run.sh -my_file paper_network.msh -saturated_conductivity 1.0</div>
</div><!-- fragment --><p >Here, the arguments for <b>run.sh</b> script are</p>
<ul>
<li>following <b>\(\texttt{-my_file}\)</b> is the input mesh file, e.g., \(\texttt{paper_network.msh}\), and</li>
<li>following \(\texttt{-saturated_conductivity}\) is the input value for saturated conductivity \(K_s\), e.g., 1.0, (a default value 0.1, as listed in \(\texttt{param_file.petsc}\), is used if this argument is not specified).</li>
</ul>
<h1><a class="anchor" id="output_vis"></a>
Visualizing the output</h1>
<p >Assuming paraView is installed on your machine, open paraView and load the file <b>out_level*</b> </p>
<div class="fragment"><div class="line">File -&gt; Open... -&gt; go to the output file directory, then select the out_level* -&gt; OK -&gt; Apply (under Properties)</div>
</div><!-- fragment --><p >the pressure head \(h\) is output as <b>h1</b>, then change <b>GLOBAL_ID</b> to <b>h1</b> in the dropdown option</p>
<div class="image">
<img src="output12.png" alt="" width="800px"/>
</div>
<p >press the play button to start playing through the time snapshots, for example, the snapshot at the step 106 looks</p>
<div class="image">
<img src="output13.png" alt="" width="800px"/>
</div>
<p >To plot the time profile of the horizontal line through the mid-section of the rectangle</p>
<div class="fragment"><div class="line">Plot Over Line icon -&gt; In Properties select X Axis button -&gt; in Series Parameters field select only h1 </div>
</div><!-- fragment --><p >Then you get</p>
<div class="image">
<img src="overline.png" alt="" width="800px"/>
</div>
<p >To Plot the time profile of a given point, first close the <b>LineChartView1</b> window and delete the <b>PlotOverLine1</b> in the <b>Pipeline</b> <b>Browser</b> <b>window</b>. Then press on the <b>Select</b> <b>Points</b> <b>On</b> <b></b>(d) icon at the top the <b>RenderView1</b> window to trigger the selection</p>
<div class="fragment"><div class="line">hover over the domain and select a point somewhere in the middle -&gt; press the Plot Selection Over Time button -&gt; select Apply -&gt; unselect all variables except h1 in the</div>
<div class="line">Propertties window</div>
</div><!-- fragment --><div class="image">
<img src="overtime.png" alt="" width="800px"/>
</div>
<p >paraView is a powerful visualisation and analysis tool. It has reach functionalities, you may play around to get a some understanding of it.</p>
<h1><a class="anchor" id="Exercise"></a>
Exercise</h1>
<ul>
<li><b>Estimating</b> <b>speed</b> <b>of</b> <b>the</b> <b>front</b> <b>of</b> <b>pressure</b> <b>head</b>. To do this, you need a grid over in the <b>RenderView</b> of <b>VTK</b>, in which the output is lying inside it. and then put the <b>Time</b> at a certain point say 56. You can get the grid in the following way, on the paraView page with the output loaded, in the <b>Properties</b> view under <b>Annotations</b> check <b>Axis</b> <b>Grid</b> and press <b>Edit</b> button next to it. A dialogue box appears, in it press the gear as shown, <div class="image">
<img src="dialogue2.png" alt="" width="400px"/>
</div>
 and on the appearing dialogue box check <b>Show</b> <b>Grid</b> button and press the gear as shown, <br  />
 <div class="image">
<img src="dialogue3.png" alt="" width="400px"/>
</div>
 now on the final dialogue box appearing check <b>Show</b> <b>Grid</b>, <b>Show</b> <b>Edges</b> and <b>Show</b> <b>Ticks</b>, <div class="image">
<img src="dialogue4.png" alt="" width="400px"/>
</div>
 finally press <b>Apply</b> -&gt; <b>OK</b> then close the dialogue box. <br  />
 <div class="image">
<img src="grid.png" alt="" width="800px"/>
</div>
 (since the <b>save_every_nth_step</b> is set at 4, it implies that output 56 means t = 56X4Xdt where dt is the time step size) then for example h1 = -0.5 is roughly at 0.008. Hence we effectively say that at t = 242Xdt the speed is 0.008/(242Xdt). Do this at various time steps and record the speeds. Now do the speed test for different values of saturated_conductivity \(K_s\). And observe that how the size of \(K_s\) influences the speed.</li>
<li><b>Add</b> <b>more</b> <b>feature</b> <b>to</b> <b>the</b> <b>geometry</b>. For example, a geometry consisting of two rectangles separated by an angle \(\pi/3\), as shown <div class="image">
<img src="two_rec.png" alt="" width="800px"/>
</div>
 and the geo file <b>two_rec.geo</b> is <div class="fragment"><div class="line">// Gmsh project created on Mon Jan 27 21:51:41 2020</div>
<div class="line">lx = 0.02;    </div>
<div class="line">ly = 0.005;</div>
<div class="line">SetFactory(&quot;OpenCASCADE&quot;);</div>
<div class="line"> </div>
<div class="line">Rectangle(1) = {0, 0, 0, lx, ly, 0};</div>
<div class="line">Rotate {{0, 0, 1}, {lx, ly/2, 0}, Pi/3} { Duplicata { Surface{1}; }} </div>
<div class="line">BooleanUnion { Surface{1}; } { Surface{2}; }</div>
<div class="line">Recursive Delete { Surface{1}; Surface{2}; }</div>
<div class="line"> </div>
<div class="line">Physical Curve(&quot;ESSENTIAL&quot;, 1) = {8};</div>
<div class="line">Physical Surface(&quot;INITIAL&quot;, 2) = {3};</div>
</div><!-- fragment --> Understand what each line is about. Create the corresponding mesh and execute the code with it. Now create a geometry such as this <div class="image">
<img src="star_geo.png" alt="" width="800px"/>
</div>
 Create a mesh with it and run the code using the mesh. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>