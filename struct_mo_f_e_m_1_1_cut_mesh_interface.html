<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: MoFEM::CutMeshInterface Struct Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="namespace_mo_f_e_m.html">MoFEM</a></li><li class="navelem"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html">CutMeshInterface</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#pub-types">Public Types</a> &#124;
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="struct_mo_f_e_m_1_1_cut_mesh_interface-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">MoFEM::CutMeshInterface Struct Reference<div class="ingroups"><a class="el" href="group__mofem.html">MoFEM</a> &raquo; <a class="el" href="group__mesh__cut.html">CutMeshInterface</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Interface to cut meshes.  
 <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#details">More...</a></p>

<p><code>#include &lt;<a class="el" href="_cut_mesh_interface_8hpp_source.html">src/interfaces/CutMeshInterface.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for MoFEM::CutMeshInterface:</div>
<div class="dyncontent">
<div class="center"><iframe scrolling="no" frameborder="0" src="struct_mo_f_e_m_1_1_cut_mesh_interface__inherit__graph.svg" width="192" height="111"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<div class="dynheader">
Collaboration diagram for MoFEM::CutMeshInterface:</div>
<div class="dyncontent">
<div class="center"><div class="zoom"><iframe scrolling="no" frameborder="0" src="struct_mo_f_e_m_1_1_cut_mesh_interface__coll__graph.svg" width="100%" height="600"><p><b>This browser is not able to show SVG: try Firefox, Chrome, Safari, or Opera instead.</b></p></iframe></div>
</div>
<center><span class="legend">[<a href="graph_legend.html">legend</a>]</span></center></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_save_data.html">SaveData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-types" name="pub-types"></a>
Public Types</h2></td></tr>
<tr class="memitem:a97177b5e49ae7783439f2237db188563"><td class="memItemLeft" align="right" valign="top">typedef multi_index_container&lt; <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, indexed_by&lt; ordered_non_unique&lt; member&lt; <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, <a class="el" href="classdouble.html">double</a>, &amp;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html#a592766ec477b22ee22a3729ebf491a89">LengthMapData::lEngth</a> &gt; &gt;, hashed_unique&lt; member&lt; <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, <a class="el" href="class_entity_handle.html">EntityHandle</a>, &amp;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html#abc0a0c5dae3672dbda4c52763b8ae89e">LengthMapData::eDge</a> &gt; &gt;, ordered_non_unique&lt; member&lt; <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, <a class="el" href="classdouble.html">double</a>, &amp;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html#a32facc57221fe528a2e00774f37f0ba9">LengthMapData::qUality</a> &gt; &gt; &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a97177b5e49ae7783439f2237db188563">LengthMapData_multi_index</a></td></tr>
<tr class="separator:a97177b5e49ae7783439f2237db188563"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a555f150b1952dcf28dcde410e4138c9d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a555f150b1952dcf28dcde410e4138c9d">query_interface</a> (boost::typeindex::type_index type_index, <a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html">UnknownInterface</a> **iface) const</td></tr>
<tr class="separator:a555f150b1952dcf28dcde410e4138c9d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1679da765e869dc8fd23fe08daaab8e"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1679da765e869dc8fd23fe08daaab8e">CutMeshInterface</a> (const <a class="el" href="namespace_mo_f_e_m.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a> &amp;core)</td></tr>
<tr class="separator:ad1679da765e869dc8fd23fe08daaab8e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ace826597c4dd6be6bfc29b21bfad3dbe"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ace826597c4dd6be6bfc29b21bfad3dbe">~CutMeshInterface</a> ()</td></tr>
<tr class="separator:ace826597c4dd6be6bfc29b21bfad3dbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a861eb86f596bb825d82d8ac61915f4c1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a861eb86f596bb825d82d8ac61915f4c1">getSubInterfaceOptions</a> ()</td></tr>
<tr class="separator:a861eb86f596bb825d82d8ac61915f4c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a231a535aa3167765ae2ec32b336ecec0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a231a535aa3167765ae2ec32b336ecec0">getOptions</a> ()</td></tr>
<tr class="memdesc:a231a535aa3167765ae2ec32b336ecec0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get options from command line.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a231a535aa3167765ae2ec32b336ecec0">More...</a><br /></td></tr>
<tr class="separator:a231a535aa3167765ae2ec32b336ecec0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0c7c582d842a5540d10cc8d84c0c3486"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0c7c582d842a5540d10cc8d84c0c3486">setFront</a> (const <a class="el" href="class_range.html">Range</a> surface)</td></tr>
<tr class="separator:a0c7c582d842a5540d10cc8d84c0c3486"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5691afdb9be3879de243aeea26c934c9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5691afdb9be3879de243aeea26c934c9">setSurface</a> (const <a class="el" href="class_range.html">Range</a> surface)</td></tr>
<tr class="memdesc:a5691afdb9be3879de243aeea26c934c9"><td class="mdescLeft">&#160;</td><td class="mdescRight">set surface entities  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5691afdb9be3879de243aeea26c934c9">More...</a><br /></td></tr>
<tr class="separator:a5691afdb9be3879de243aeea26c934c9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08b8bbab5b73482ebe67655c8211e77b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08b8bbab5b73482ebe67655c8211e77b">copySurface</a> (const <a class="el" href="class_range.html">Range</a> surface, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL, <a class="el" href="classdouble.html">double</a> *shift=NULL, <a class="el" href="classdouble.html">double</a> *origin=NULL, <a class="el" href="classdouble.html">double</a> *transform=NULL, const std::string save_mesh=&quot;&quot;)</td></tr>
<tr class="memdesc:a08b8bbab5b73482ebe67655c8211e77b"><td class="mdescLeft">&#160;</td><td class="mdescRight">copy surface entities  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08b8bbab5b73482ebe67655c8211e77b">More...</a><br /></td></tr>
<tr class="separator:a08b8bbab5b73482ebe67655c8211e77b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac49c841036ab310c3ade79eff45ddc1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac49c841036ab310c3ade79eff45ddc1f">setVolume</a> (const <a class="el" href="class_range.html">Range</a> volume)</td></tr>
<tr class="memdesc:ac49c841036ab310c3ade79eff45ddc1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">set volume entities  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac49c841036ab310c3ade79eff45ddc1f">More...</a><br /></td></tr>
<tr class="separator:ac49c841036ab310c3ade79eff45ddc1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad2bf7c3c4320b94832923df44d30e45"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aad2bf7c3c4320b94832923df44d30e45">setConstrainSurface</a> (const <a class="el" href="class_range.html">Range</a> surf)</td></tr>
<tr class="memdesc:aad2bf7c3c4320b94832923df44d30e45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set the constrain surface object.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aad2bf7c3c4320b94832923df44d30e45">More...</a><br /></td></tr>
<tr class="separator:aad2bf7c3c4320b94832923df44d30e45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae575455a4cad61089229a473bbb14d66"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae575455a4cad61089229a473bbb14d66">mergeSurface</a> (const <a class="el" href="class_range.html">Range</a> surface)</td></tr>
<tr class="memdesc:ae575455a4cad61089229a473bbb14d66"><td class="mdescLeft">&#160;</td><td class="mdescRight">merge surface entities  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae575455a4cad61089229a473bbb14d66">More...</a><br /></td></tr>
<tr class="separator:ae575455a4cad61089229a473bbb14d66"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8446bcb36213697a1c86009044b44cef"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8446bcb36213697a1c86009044b44cef">mergeVolumes</a> (const <a class="el" href="class_range.html">Range</a> volume)</td></tr>
<tr class="memdesc:a8446bcb36213697a1c86009044b44cef"><td class="mdescLeft">&#160;</td><td class="mdescRight">merge volume entities  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8446bcb36213697a1c86009044b44cef">More...</a><br /></td></tr>
<tr class="separator:a8446bcb36213697a1c86009044b44cef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9ccec2b7a1b94d021aedeccc2047c536"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9ccec2b7a1b94d021aedeccc2047c536">snapSurfaceSkinToEdges</a> (const <a class="el" href="class_range.html">Range</a> fixed_edges, const <a class="el" href="classdouble.html">double</a> rel_tol, const <a class="el" href="classdouble.html">double</a> abs_tol, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=nullptr, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="separator:a9ccec2b7a1b94d021aedeccc2047c536"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aedb15b073b44bdf2cd4d20fbc19a8060"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aedb15b073b44bdf2cd4d20fbc19a8060">snapSurfaceToEdges</a> (const <a class="el" href="class_range.html">Range</a> surface_edges, const <a class="el" href="class_range.html">Range</a> fixed_edges, const <a class="el" href="classdouble.html">double</a> rel_tol, const <a class="el" href="classdouble.html">double</a> abs_tol, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=nullptr, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="separator:aedb15b073b44bdf2cd4d20fbc19a8060"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67d0cdac80f09af5b4d821c671600ae9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a67d0cdac80f09af5b4d821c671600ae9">buildTree</a> ()</td></tr>
<tr class="memdesc:a67d0cdac80f09af5b4d821c671600ae9"><td class="mdescLeft">&#160;</td><td class="mdescRight">build tree  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a67d0cdac80f09af5b4d821c671600ae9">More...</a><br /></td></tr>
<tr class="separator:a67d0cdac80f09af5b4d821c671600ae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac3214a803b9083172d4bcbebf13b4c8b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac3214a803b9083172d4bcbebf13b4c8b">cutOnly</a> (<a class="el" href="class_range.html">Range</a> vol, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> cut_bit, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="classdouble.html">double</a> tol_geometry, const <a class="el" href="classdouble.html">double</a> tol_cut_close, <a class="el" href="class_range.html">Range</a> *fixed_edges=NULL, <a class="el" href="class_range.html">Range</a> *corner_nodes=NULL, const <a class="el" href="classbool.html">bool</a> update_meshsets=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:ac3214a803b9083172d4bcbebf13b4c8b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut mesh only.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac3214a803b9083172d4bcbebf13b4c8b">More...</a><br /></td></tr>
<tr class="separator:ac3214a803b9083172d4bcbebf13b4c8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14f173d3cba5074db4437f5d578427d9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14f173d3cba5074db4437f5d578427d9">trimOnly</a> (const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> trim_bit, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="classdouble.html">double</a> tol_trim_close, <a class="el" href="class_range.html">Range</a> *fixed_edges=NULL, <a class="el" href="class_range.html">Range</a> *corner_nodes=NULL, const <a class="el" href="classbool.html">bool</a> update_meshsets=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a14f173d3cba5074db4437f5d578427d9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trim mesh only.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14f173d3cba5074db4437f5d578427d9">More...</a><br /></td></tr>
<tr class="separator:a14f173d3cba5074db4437f5d578427d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab717cee861e22f9d988b3871e9e228f5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ab717cee861e22f9d988b3871e9e228f5">cutAndTrim</a> (int &amp;first_bit, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="classdouble.html">double</a> tol_geometry, const <a class="el" href="classdouble.html">double</a> tol_cut_close, const <a class="el" href="classdouble.html">double</a> tol_trim_close, <a class="el" href="class_range.html">Range</a> *fixed_edges=NULL, <a class="el" href="class_range.html">Range</a> *corner_nodes=NULL, const <a class="el" href="classbool.html">bool</a> update_meshsets=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:ab717cee861e22f9d988b3871e9e228f5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut and trim.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ab717cee861e22f9d988b3871e9e228f5">More...</a><br /></td></tr>
<tr class="separator:ab717cee861e22f9d988b3871e9e228f5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad1ef5dac44a93d2934fabd08e35c72a9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1ef5dac44a93d2934fabd08e35c72a9">cutTrimAndMerge</a> (int &amp;first_bit, const int fraction_level, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="classdouble.html">double</a> tol_geometry, const <a class="el" href="classdouble.html">double</a> tol_cut_close, const <a class="el" href="classdouble.html">double</a> tol_trim_close, <a class="el" href="class_range.html">Range</a> &amp;fixed_edges, <a class="el" href="class_range.html">Range</a> &amp;corner_nodes, const <a class="el" href="classbool.html">bool</a> update_meshsets=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:ad1ef5dac44a93d2934fabd08e35c72a9"><td class="mdescLeft">&#160;</td><td class="mdescRight">Cut, trim and merge.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1ef5dac44a93d2934fabd08e35c72a9">More...</a><br /></td></tr>
<tr class="separator:ad1ef5dac44a93d2934fabd08e35c72a9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad76d17c62d4f9337953222d2092697ab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad76d17c62d4f9337953222d2092697ab">makeFront</a> (const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:ad76d17c62d4f9337953222d2092697ab"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create front from the surface.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad76d17c62d4f9337953222d2092697ab">More...</a><br /></td></tr>
<tr class="separator:ad76d17c62d4f9337953222d2092697ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aff39b406f6369d6ec8eba29bfbd22e1f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aff39b406f6369d6ec8eba29bfbd22e1f">createSurfaceLevelSets</a> (int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:aff39b406f6369d6ec8eba29bfbd22e1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate distance from mesh nodes to cut surface.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aff39b406f6369d6ec8eba29bfbd22e1f">More...</a><br /></td></tr>
<tr class="separator:aff39b406f6369d6ec8eba29bfbd22e1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac56d3eb52d6a3acb55eb0eb3866101a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac56d3eb52d6a3acb55eb0eb3866101a4">createFrontLevelSets</a> (<a class="el" href="class_range.html">Range</a> vol, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=nullptr, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:ac56d3eb52d6a3acb55eb0eb3866101a4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Calculate distance from mesh nodes to surface front.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac56d3eb52d6a3acb55eb0eb3866101a4">More...</a><br /></td></tr>
<tr class="separator:ac56d3eb52d6a3acb55eb0eb3866101a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0dec0dd3ed43e1b5eacc618d4fa72a63"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">findLevelSetVolumes</a> (Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <a class="el" href="class_range.html">Range</a> &amp;vol_edges, const <a class="el" href="classbool.html">bool</a> remove_adj_prims_edges, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false, const std::string edges_file_name=string())</td></tr>
<tr class="memdesc:a0dec0dd3ed43e1b5eacc618d4fa72a63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find level set volumes.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">More...</a><br /></td></tr>
<tr class="separator:a0dec0dd3ed43e1b5eacc618d4fa72a63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a862518bf849fb6ef5b0a954598b61daa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a862518bf849fb6ef5b0a954598b61daa">findLevelSetVolumes</a> (int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a862518bf849fb6ef5b0a954598b61daa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find level set volumes.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a862518bf849fb6ef5b0a954598b61daa">More...</a><br /></td></tr>
<tr class="separator:a862518bf849fb6ef5b0a954598b61daa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6cdd41a72a83c1e08ff57742b85da95"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae6cdd41a72a83c1e08ff57742b85da95">refineMesh</a> (const int init_bit_level, const int surf_levels, const int front_levels, <a class="el" href="class_range.html">Range</a> *fixed_edges=nullptr, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:ae6cdd41a72a83c1e08ff57742b85da95"><td class="mdescLeft">&#160;</td><td class="mdescRight">Refine and set level sets.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae6cdd41a72a83c1e08ff57742b85da95">More...</a><br /></td></tr>
<tr class="separator:ae6cdd41a72a83c1e08ff57742b85da95"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a70284c3b782b5153ca63de37a4d3f1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3a70284c3b782b5153ca63de37a4d3f1">findEdgesToCut</a> (<a class="el" href="class_range.html">Range</a> vol, int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a3a70284c3b782b5153ca63de37a4d3f1"><td class="mdescLeft">&#160;</td><td class="mdescRight">find edges to cut  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3a70284c3b782b5153ca63de37a4d3f1">More...</a><br /></td></tr>
<tr class="separator:a3a70284c3b782b5153ca63de37a4d3f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10dfa5939be386611e2719d98ea1d01e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a10dfa5939be386611e2719d98ea1d01e">projectZeroDistanceEnts</a> (<a class="el" href="class_range.html">Range</a> *fixed_edges, <a class="el" href="class_range.html">Range</a> *corner_nodes, const <a class="el" href="classdouble.html">double</a> geometry_tol=0, const <a class="el" href="classdouble.html">double</a> close_tol=0, const int verb=<a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a10dfa5939be386611e2719d98ea1d01e"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find entities on cut surface which can be projected.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a10dfa5939be386611e2719d98ea1d01e">More...</a><br /></td></tr>
<tr class="separator:a10dfa5939be386611e2719d98ea1d01e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5623680896e3fa6675304bd913f3be7b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5623680896e3fa6675304bd913f3be7b">cutEdgesInMiddle</a> (const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="el" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="el" href="class_range.html">Range</a> &amp;cut_vols, <a class="el" href="class_range.html">Range</a> &amp;cut_surf, <a class="el" href="class_range.html">Range</a> &amp;cut_verts, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a5623680896e3fa6675304bd913f3be7b"><td class="mdescLeft">&#160;</td><td class="mdescRight">cut edges  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5623680896e3fa6675304bd913f3be7b">More...</a><br /></td></tr>
<tr class="separator:a5623680896e3fa6675304bd913f3be7b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8e8a8509c57589e4de9b347821a9dd99"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8e8a8509c57589e4de9b347821a9dd99">moveMidNodesOnCutEdges</a> (Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL)</td></tr>
<tr class="memdesc:a8e8a8509c57589e4de9b347821a9dd99"><td class="mdescLeft">&#160;</td><td class="mdescRight">projecting of mid edge nodes on new mesh on surface  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8e8a8509c57589e4de9b347821a9dd99">More...</a><br /></td></tr>
<tr class="separator:a8e8a8509c57589e4de9b347821a9dd99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08769c58f2f2ad52cf371aadb1f62331"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08769c58f2f2ad52cf371aadb1f62331">findEdgesToTrim</a> (<a class="el" href="class_range.html">Range</a> *fixed_edges, <a class="el" href="class_range.html">Range</a> *corner_nodes, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL, const <a class="el" href="classdouble.html">double</a> <a class="el" href="mesh__smoothing_8cpp.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>=1e-4, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a08769c58f2f2ad52cf371aadb1f62331"><td class="mdescLeft">&#160;</td><td class="mdescRight">Find edges to trimEdges.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08769c58f2f2ad52cf371aadb1f62331">More...</a><br /></td></tr>
<tr class="separator:a08769c58f2f2ad52cf371aadb1f62331"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2a17e2e37581b566c13d274d10e58b34"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2a17e2e37581b566c13d274d10e58b34">trimEdgesInTheMiddle</a> (const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="el" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a2a17e2e37581b566c13d274d10e58b34"><td class="mdescLeft">&#160;</td><td class="mdescRight">trim edges  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2a17e2e37581b566c13d274d10e58b34">More...</a><br /></td></tr>
<tr class="separator:a2a17e2e37581b566c13d274d10e58b34"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fcd2cc277293c8530dd28b24ddbe6e7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0fcd2cc277293c8530dd28b24ddbe6e7">moveMidNodesOnTrimmedEdges</a> (Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL)</td></tr>
<tr class="memdesc:a0fcd2cc277293c8530dd28b24ddbe6e7"><td class="mdescLeft">&#160;</td><td class="mdescRight">move trimmed edges mid nodes  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0fcd2cc277293c8530dd28b24ddbe6e7">More...</a><br /></td></tr>
<tr class="separator:a0fcd2cc277293c8530dd28b24ddbe6e7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2520f629b1708b8d9dafb141c9b90ae5"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2520f629b1708b8d9dafb141c9b90ae5">trimSurface</a> (<a class="el" href="class_range.html">Range</a> *fixed_edge, <a class="el" href="class_range.html">Range</a> *corner_nodes, const <a class="el" href="classdouble.html">double</a> <a class="el" href="mesh__smoothing_8cpp.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a>=1e-4, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a2520f629b1708b8d9dafb141c9b90ae5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Trim surface from faces beyond front.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2520f629b1708b8d9dafb141c9b90ae5">More...</a><br /></td></tr>
<tr class="separator:a2520f629b1708b8d9dafb141c9b90ae5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aacc6ac8832948e067b7b7dadf50c53d1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aacc6ac8832948e067b7b7dadf50c53d1">removePathologicalFrontTris</a> (const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> split_bit, <a class="el" href="class_range.html">Range</a> &amp;ents)</td></tr>
<tr class="memdesc:aacc6ac8832948e067b7b7dadf50c53d1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Remove pathological elements on surface internal front.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aacc6ac8832948e067b7b7dadf50c53d1">More...</a><br /></td></tr>
<tr class="separator:aacc6ac8832948e067b7b7dadf50c53d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a72dd731f79c384927ec506eb5ae759f7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a72dd731f79c384927ec506eb5ae759f7">splitSides</a> (const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> split_bit, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="el" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, const <a class="el" href="class_range.html">Range</a> &amp;ents, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL)</td></tr>
<tr class="memdesc:a72dd731f79c384927ec506eb5ae759f7"><td class="mdescLeft">&#160;</td><td class="mdescRight">split sides  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a72dd731f79c384927ec506eb5ae759f7">More...</a><br /></td></tr>
<tr class="separator:a72dd731f79c384927ec506eb5ae759f7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77c2ce9c07b85d08e79672d0b025e33c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a77c2ce9c07b85d08e79672d0b025e33c">mergeBadEdges</a> (const int fraction_level, const <a class="el" href="class_range.html">Range</a> &amp;tets, const <a class="el" href="class_range.html">Range</a> &amp;surface, const <a class="el" href="class_range.html">Range</a> &amp;fixed_edges, const <a class="el" href="class_range.html">Range</a> &amp;corner_nodes, <a class="el" href="class_range.html">Range</a> &amp;merged_nodes, <a class="el" href="class_range.html">Range</a> &amp;out_tets, <a class="el" href="class_range.html">Range</a> &amp;new_surf, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="classbool.html">bool</a> update_meshsets=false, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> *bit_ptr=NULL, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a77c2ce9c07b85d08e79672d0b025e33c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merge edges.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a77c2ce9c07b85d08e79672d0b025e33c">More...</a><br /></td></tr>
<tr class="separator:a77c2ce9c07b85d08e79672d0b025e33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1502b74546b99e2f0b968333a7748400"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1502b74546b99e2f0b968333a7748400">mergeBadEdges</a> (const int fraction_level, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> cut_bit, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> trim_bit, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="el" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, const <a class="el" href="class_range.html">Range</a> &amp;surface, const <a class="el" href="class_range.html">Range</a> &amp;fixed_edges, const <a class="el" href="class_range.html">Range</a> &amp;corner_nodes, Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>=NULL, const <a class="el" href="classbool.html">bool</a> update_meshsets=false, const <a class="el" href="classbool.html">bool</a> <a class="el" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>=false)</td></tr>
<tr class="memdesc:a1502b74546b99e2f0b968333a7748400"><td class="mdescLeft">&#160;</td><td class="mdescRight">Merge edges.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1502b74546b99e2f0b968333a7748400">More...</a><br /></td></tr>
<tr class="separator:a1502b74546b99e2f0b968333a7748400"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8c2be86d34af5f6c71e5d7d2696b954"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac8c2be86d34af5f6c71e5d7d2696b954">setTagData</a> (Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="el" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>=<a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>())</td></tr>
<tr class="memdesc:ac8c2be86d34af5f6c71e5d7d2696b954"><td class="mdescLeft">&#160;</td><td class="mdescRight">set coords to tag  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac8c2be86d34af5f6c71e5d7d2696b954">More...</a><br /></td></tr>
<tr class="separator:ac8c2be86d34af5f6c71e5d7d2696b954"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d2b84113a4d8dceb7476b648d01bdab"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2d2b84113a4d8dceb7476b648d01bdab">setCoords</a> (Tag <a class="el" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="el" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>=<a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>(), const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask=<a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set())</td></tr>
<tr class="memdesc:a2d2b84113a4d8dceb7476b648d01bdab"><td class="mdescLeft">&#160;</td><td class="mdescRight">set coords from tag  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2d2b84113a4d8dceb7476b648d01bdab">More...</a><br /></td></tr>
<tr class="separator:a2d2b84113a4d8dceb7476b648d01bdab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27883f29003acbc5b5f3c6d155887e12"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27883f29003acbc5b5f3c6d155887e12">getVolume</a> () const</td></tr>
<tr class="separator:a27883f29003acbc5b5f3c6d155887e12"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa1bbbb1d723e99d6503ffbb8f4caccfc"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a> () const</td></tr>
<tr class="separator:aa1bbbb1d723e99d6503ffbb8f4caccfc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14b57638017e2cde6ccc6f6e51118847"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14b57638017e2cde6ccc6f6e51118847">getFront</a> () const</td></tr>
<tr class="separator:a14b57638017e2cde6ccc6f6e51118847"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16fc82b8953ea94723738e8435256773"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a16fc82b8953ea94723738e8435256773">getCutEdges</a> () const</td></tr>
<tr class="separator:a16fc82b8953ea94723738e8435256773"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2ccebabdfabe035f6e9bd2bd970764de"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2ccebabdfabe035f6e9bd2bd970764de">getNewCutVolumes</a> () const</td></tr>
<tr class="separator:a2ccebabdfabe035f6e9bd2bd970764de"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a6a15cfde565436c98499720706581b"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0a6a15cfde565436c98499720706581b">getNewCutSurfaces</a> () const</td></tr>
<tr class="separator:a0a6a15cfde565436c98499720706581b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae871fdb1e0d11cc7a4430c3f47b8a984"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae871fdb1e0d11cc7a4430c3f47b8a984">getNewCutVertices</a> () const</td></tr>
<tr class="separator:ae871fdb1e0d11cc7a4430c3f47b8a984"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3028c39783a3c872e50a146b488929f9"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3028c39783a3c872e50a146b488929f9">projectZeroDistanceEnts</a> () const</td></tr>
<tr class="separator:a3028c39783a3c872e50a146b488929f9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a291388e19eabafaf973858c7fe4b3a77"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a291388e19eabafaf973858c7fe4b3a77">getTrimEdges</a> () const</td></tr>
<tr class="separator:a291388e19eabafaf973858c7fe4b3a77"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a512bddef655fd7788f6f6b94ca727a2f"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a512bddef655fd7788f6f6b94ca727a2f">getNewTrimVolumes</a> () const</td></tr>
<tr class="separator:a512bddef655fd7788f6f6b94ca727a2f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2227475101c2c0200d0894e766501dc"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac2227475101c2c0200d0894e766501dc">getNewTrimSurfaces</a> () const</td></tr>
<tr class="separator:ac2227475101c2c0200d0894e766501dc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d2a60dae20404dce9fab06a13da8800"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d2a60dae20404dce9fab06a13da8800">getNewTrimVertices</a> () const</td></tr>
<tr class="separator:a9d2a60dae20404dce9fab06a13da8800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac5428afbb9ed89dae0b388cabb7b60bf"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac5428afbb9ed89dae0b388cabb7b60bf">getMergedVolumes</a> () const</td></tr>
<tr class="separator:ac5428afbb9ed89dae0b388cabb7b60bf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a452afd78f72fd0d9bde8985f5417d47d"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a452afd78f72fd0d9bde8985f5417d47d">getMergedSurfaces</a> () const</td></tr>
<tr class="separator:a452afd78f72fd0d9bde8985f5417d47d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afadc1f7c3c7fedf55fbdca253c5a0059"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afadc1f7c3c7fedf55fbdca253c5a0059">getCutSurfaceVolumes</a> () const</td></tr>
<tr class="separator:afadc1f7c3c7fedf55fbdca253c5a0059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39ab0984dafe0104140987a4b5d9646e"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a39ab0984dafe0104140987a4b5d9646e">getCutFrontVolumes</a> () const</td></tr>
<tr class="separator:a39ab0984dafe0104140987a4b5d9646e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a99386261dc7636e7ccfd8348a311ef7c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a99386261dc7636e7ccfd8348a311ef7c">saveCutEdges</a> (const std::string prefix=&quot;&quot;)</td></tr>
<tr class="separator:a99386261dc7636e7ccfd8348a311ef7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9a8a8242b3e6eeb4de3ab284dd9933b9"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9a8a8242b3e6eeb4de3ab284dd9933b9">saveTrimEdges</a> ()</td></tr>
<tr class="separator:a9a8a8242b3e6eeb4de3ab284dd9933b9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8db4a9870d5e4966f06a5afe3cae2f6b"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; OrientedBoxTreeTool &gt; &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8db4a9870d5e4966f06a5afe3cae2f6b">getTreeSurfPtr</a> ()</td></tr>
<tr class="separator:a8db4a9870d5e4966f06a5afe3cae2f6b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa31ee0ab802df14469284121486524f2"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa31ee0ab802df14469284121486524f2">clearMap</a> ()</td></tr>
<tr class="separator:aa31ee0ab802df14469284121486524f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_struct_mo_f_e_m_1_1_unknown_interface')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html">MoFEM::UnknownInterface</a></td></tr>
<tr class="memitem:a525e4d5a451a5bb8c5437d0dd2588de6 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memItemLeft" align="right" valign="top">virtual <a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a525e4d5a451a5bb8c5437d0dd2588de6">query_interface</a> (boost::typeindex::type_index type_index, <a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html">UnknownInterface</a> **iface) const =0</td></tr>
<tr class="separator:a525e4d5a451a5bb8c5437d0dd2588de6 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5da6216311219ca884defbc048260a20 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a5da6216311219ca884defbc048260a20 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a5da6216311219ca884defbc048260a20">registerInterface</a> (<a class="el" href="classbool.html">bool</a> error_if_registration_failed=true)</td></tr>
<tr class="memdesc:a5da6216311219ca884defbc048260a20 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Register interface.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#a5da6216311219ca884defbc048260a20">More...</a><br /></td></tr>
<tr class="separator:a5da6216311219ca884defbc048260a20 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a> (IFACE *&amp;iface) const</td></tr>
<tr class="memdesc:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get interface refernce to pointer of interface.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">More...</a><br /></td></tr>
<tr class="separator:a7ab248ec45fca778800dcd92e5171beb inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a66d5ce701795486330f2c1e93c98ece4">getInterface</a> (IFACE **const iface) const</td></tr>
<tr class="memdesc:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get interface pointer to pointer of interface.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#a66d5ce701795486330f2c1e93c98ece4">More...</a><br /></td></tr>
<tr class="separator:a66d5ce701795486330f2c1e93c98ece4 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplParams" colspan="2">template&lt;class IFACE , typename boost::enable_if&lt; boost::is_pointer&lt; IFACE &gt;, int &gt;::type  = 0&gt; </td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplItemLeft" align="right" valign="top">IFACE&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a> () const</td></tr>
<tr class="memdesc:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get interface pointer to pointer of interface.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#aeb77113fbaac3d256b13433f2294fa09">More...</a><br /></td></tr>
<tr class="separator:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplParams" colspan="2">template&lt;class IFACE , typename boost::enable_if&lt; boost::is_reference&lt; IFACE &gt;, int &gt;::type  = 0&gt; </td></tr>
<tr class="memitem:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplItemLeft" align="right" valign="top">IFACE&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#aeb77113fbaac3d256b13433f2294fa09">getInterface</a> () const</td></tr>
<tr class="memdesc:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get reference to interface.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#aeb77113fbaac3d256b13433f2294fa09">More...</a><br /></td></tr>
<tr class="separator:aeb77113fbaac3d256b13433f2294fa09 inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1edce9688bcc856bdb632fd76df3b40b inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplParams" colspan="2">template&lt;class IFACE &gt; </td></tr>
<tr class="memitem:a1edce9688bcc856bdb632fd76df3b40b inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memTemplItemLeft" align="right" valign="top">IFACE *&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a1edce9688bcc856bdb632fd76df3b40b">getInterface</a> () const</td></tr>
<tr class="memdesc:a1edce9688bcc856bdb632fd76df3b40b inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Function returning pointer to interface.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#a1edce9688bcc856bdb632fd76df3b40b">More...</a><br /></td></tr>
<tr class="separator:a1edce9688bcc856bdb632fd76df3b40b inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5728f8956c62075d9ad8aa6555cb06a inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memItemLeft" align="right" valign="top">virtual&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#af5728f8956c62075d9ad8aa6555cb06a">~UnknownInterface</a> ()=default</td></tr>
<tr class="separator:af5728f8956c62075d9ad8aa6555cb06a inherit pub_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:a49d7537c2912c9ce8d20638088f0e0a4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="namespace_mo_f_e_m.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a></td></tr>
<tr class="separator:a49d7537c2912c9ce8d20638088f0e0a4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f4d5194089ca2d3fbbc483eeb75c817"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4f4d5194089ca2d3fbbc483eeb75c817">lineSearchSteps</a></td></tr>
<tr class="separator:a4f4d5194089ca2d3fbbc483eeb75c817"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa4a886cef884b12a6fc193fb98cace45"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa4a886cef884b12a6fc193fb98cace45">nbMaxMergingCycles</a></td></tr>
<tr class="separator:aa4a886cef884b12a6fc193fb98cace45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b9776c73fa2731c98ee28deab409ed7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">projectEntitiesQualityTrashold</a></td></tr>
<tr class="separator:a6b9776c73fa2731c98ee28deab409ed7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ad31de547dbb35fc59c2d858e698179d6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a></td></tr>
<tr class="separator:ad31de547dbb35fc59c2d858e698179d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096f5f19f72b2a300d274d55162b6f19"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a></td></tr>
<tr class="separator:a096f5f19f72b2a300d274d55162b6f19"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1995cac02879c652163074223c5fb296"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a></td></tr>
<tr class="separator:a1995cac02879c652163074223c5fb296"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc59d5f363970862abcd6d284d947c74"><td class="memItemLeft" align="right" valign="top">boost::shared_ptr&lt; OrientedBoxTreeTool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a></td></tr>
<tr class="separator:adc59d5f363970862abcd6d284d947c74"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a74b5639fd1bdc3d0bb759f9b53076483"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_entity_handle.html">EntityHandle</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a></td></tr>
<tr class="separator:a74b5639fd1bdc3d0bb759f9b53076483"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd47f33b2d5fb21c26ddf80444360bba"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a></td></tr>
<tr class="separator:afd47f33b2d5fb21c26ddf80444360bba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e149175ff1d5e5086a6b36dc1477ca1"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a></td></tr>
<tr class="separator:a4e149175ff1d5e5086a6b36dc1477ca1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9d20a18617586fd01c1da8bc486d2061"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a></td></tr>
<tr class="separator:a9d20a18617586fd01c1da8bc486d2061"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86c2b9230209eebcf507ba5ca4e43c2c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">zeroDistanceEnts</a></td></tr>
<tr class="separator:a86c2b9230209eebcf507ba5ca4e43c2c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af8f5e939ef8a867d87ac6bc3b32e18ec"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a></td></tr>
<tr class="separator:af8f5e939ef8a867d87ac6bc3b32e18ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a75bdd40b1e7208d4c435acee21562669"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a75bdd40b1e7208d4c435acee21562669">cutNewVertices</a></td></tr>
<tr class="separator:a75bdd40b1e7208d4c435acee21562669"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d5acd0e2fc2974e7c44aed8794cc5f3"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">trimNewVolumes</a></td></tr>
<tr class="separator:a8d5acd0e2fc2974e7c44aed8794cc5f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a00e7da4bd6411bfc49661d00cc331d2b"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a></td></tr>
<tr class="separator:a00e7da4bd6411bfc49661d00cc331d2b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b99aef4cb232c84d46a919494477220"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a></td></tr>
<tr class="separator:a0b99aef4cb232c84d46a919494477220"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7010ac51af96c46b6038ba966a77012a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a></td></tr>
<tr class="separator:a7010ac51af96c46b6038ba966a77012a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0662298092c0532e60151baa5040aadb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0662298092c0532e60151baa5040aadb">mergedVolumes</a></td></tr>
<tr class="separator:a0662298092c0532e60151baa5040aadb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54c4ce1e4f1249778ebb15e7e4d12ae"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa54c4ce1e4f1249778ebb15e7e4d12ae">mergedSurfaces</a></td></tr>
<tr class="separator:aa54c4ce1e4f1249778ebb15e7e4d12ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad277d5b4f2c7eb02619acca528e60f1c"><td class="memItemLeft" align="right" valign="top">map&lt; <a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a></td></tr>
<tr class="separator:ad277d5b4f2c7eb02619acca528e60f1c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95629e9a8eaeb96f050d7c3d3e334a99"><td class="memItemLeft" align="right" valign="top">map&lt; <a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a></td></tr>
<tr class="separator:a95629e9a8eaeb96f050d7c3d3e334a99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5953d82956ff923572fe91b1d967c0d9"><td class="memItemLeft" align="right" valign="top">map&lt; <a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a></td></tr>
<tr class="separator:a5953d82956ff923572fe91b1d967c0d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c83ac6cfca374e4658a8c89691c18a2"><td class="memItemLeft" align="right" valign="top">map&lt; <a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a></td></tr>
<tr class="separator:a5c83ac6cfca374e4658a8c89691c18a2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a27ab998c8029b8adcbcc89c4f967d43a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">aveLength</a></td></tr>
<tr class="memdesc:a27ab998c8029b8adcbcc89c4f967d43a"><td class="mdescLeft">&#160;</td><td class="mdescRight">Average edge length.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">More...</a><br /></td></tr>
<tr class="separator:a27ab998c8029b8adcbcc89c4f967d43a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a729419c6fa252624215c8ec8b317a8e4"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classdouble.html">double</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a729419c6fa252624215c8ec8b317a8e4">maxLength</a></td></tr>
<tr class="memdesc:a729419c6fa252624215c8ec8b317a8e4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Maximal edge length.  <a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a729419c6fa252624215c8ec8b317a8e4">More...</a><br /></td></tr>
<tr class="separator:a729419c6fa252624215c8ec8b317a8e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac9552b1279ac23cc91e58d42dafe7ce6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a></td></tr>
<tr class="separator:ac9552b1279ac23cc91e58d42dafe7ce6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a208b503c4a559549484c8cae4af2b1aa"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a></td></tr>
<tr class="separator:a208b503c4a559549484c8cae4af2b1aa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2775e2dc0fca083966780c4fd30eba07"><td class="memItemLeft" align="right" valign="top"><a class="el" href="class_range.html">Range</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a></td></tr>
<tr class="separator:a2775e2dc0fca083966780c4fd30eba07"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td colspan="2" onclick="javascript:toggleInherit('pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface')"><img src="closed.png" alt="-"/>&#160;Static Public Member Functions inherited from <a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html">MoFEM::UnknownInterface</a></td></tr>
<tr class="memitem:a52e77a14ba06bf15c0de1281b61b211f inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a52e77a14ba06bf15c0de1281b61b211f">getLibVersion</a> (<a class="el" href="struct_mo_f_e_m_1_1_version.html">Version</a> &amp;version)</td></tr>
<tr class="memdesc:a52e77a14ba06bf15c0de1281b61b211f inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get library version.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#a52e77a14ba06bf15c0de1281b61b211f">More...</a><br /></td></tr>
<tr class="separator:a52e77a14ba06bf15c0de1281b61b211f inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af3766a882d10e8f8fe3f63e56c990f12 inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#af3766a882d10e8f8fe3f63e56c990f12">getFileVersion</a> (moab::Interface &amp;moab, <a class="el" href="struct_mo_f_e_m_1_1_version.html">Version</a> &amp;version)</td></tr>
<tr class="memdesc:af3766a882d10e8f8fe3f63e56c990f12 inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get database major version.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#af3766a882d10e8f8fe3f63e56c990f12">More...</a><br /></td></tr>
<tr class="separator:af3766a882d10e8f8fe3f63e56c990f12 inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e9d9a60ce5c323f4ca7c2f2a993be72 inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a9e9d9a60ce5c323f4ca7c2f2a993be72">setFileVersion</a> (moab::Interface &amp;moab, <a class="el" href="struct_mo_f_e_m_1_1_version.html">Version</a> version=<a class="el" href="struct_mo_f_e_m_1_1_version.html">Version</a>(MoFEM_VERSION_MAJOR, MoFEM_VERSION_MINOR, MoFEM_VERSION_BUILD))</td></tr>
<tr class="memdesc:a9e9d9a60ce5c323f4ca7c2f2a993be72 inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get database major version.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#a9e9d9a60ce5c323f4ca7c2f2a993be72">More...</a><br /></td></tr>
<tr class="separator:a9e9d9a60ce5c323f4ca7c2f2a993be72 inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aee8da5f391105ea953e4b3f2fcd7600d inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memItemLeft" align="right" valign="top">static <a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#aee8da5f391105ea953e4b3f2fcd7600d">getInterfaceVersion</a> (<a class="el" href="struct_mo_f_e_m_1_1_version.html">Version</a> &amp;version)</td></tr>
<tr class="memdesc:aee8da5f391105ea953e4b3f2fcd7600d inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get database major version.  <a href="struct_mo_f_e_m_1_1_unknown_interface.html#aee8da5f391105ea953e4b3f2fcd7600d">More...</a><br /></td></tr>
<tr class="separator:aee8da5f391105ea953e4b3f2fcd7600d inherit pub_static_methods_struct_mo_f_e_m_1_1_unknown_interface"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Interface to cut meshes. </p>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#_a18">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00019">19</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a97177b5e49ae7783439f2237db188563" name="a97177b5e49ae7783439f2237db188563"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97177b5e49ae7783439f2237db188563">&#9670;&#160;</a></span>LengthMapData_multi_index</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef multi_index_container&lt; <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, indexed_by&lt; ordered_non_unique&lt; member&lt;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, <a class="el" href="classdouble.html">double</a>, &amp;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html#a592766ec477b22ee22a3729ebf491a89">LengthMapData::lEngth</a>&gt; &gt;, hashed_unique&lt; member&lt;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, <a class="el" href="class_entity_handle.html">EntityHandle</a>, &amp;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html#abc0a0c5dae3672dbda4c52763b8ae89e">LengthMapData::eDge</a>&gt; &gt;, ordered_non_unique&lt; member&lt;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html">LengthMapData</a>, <a class="el" href="classdouble.html">double</a>, &amp;<a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_length_map_data.html#a32facc57221fe528a2e00774f37f0ba9">LengthMapData::qUality</a>&gt; &gt; &gt; &gt; <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a97177b5e49ae7783439f2237db188563">MoFEM::CutMeshInterface::LengthMapData_multi_index</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00535">535</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="ad1679da765e869dc8fd23fe08daaab8e" name="ad1679da765e869dc8fd23fe08daaab8e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1679da765e869dc8fd23fe08daaab8e">&#9670;&#160;</a></span>CutMeshInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">MoFEM::CutMeshInterface::CutMeshInterface </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a> &amp;&#160;</td>
          <td class="paramname"><em>core</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00023">23</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   24</span>    : <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>(<span class="keyword">const_cast&lt;</span><a class="code hl_typedef" href="namespace_mo_f_e_m.html#a8bdfc7559ccb2b6d0021580b5c8a340b">Core</a> &amp;<span class="keyword">&gt;</span>(core)) {</div>
<div class="line"><span class="lineno">   25</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4f4d5194089ca2d3fbbc483eeb75c817">lineSearchSteps</a> = 10;</div>
<div class="line"><span class="lineno">   26</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa4a886cef884b12a6fc193fb98cace45">nbMaxMergingCycles</a> = 200;</div>
<div class="line"><span class="lineno">   27</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">projectEntitiesQualityTrashold</a> = 0.5;</div>
<div class="line"><span class="lineno">   28</span>}</div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespace_mo_f_e_m.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="_core_8hpp_source.html#l01094">Core.hpp:1094</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a49d7537c2912c9ce8d20638088f0e0a4"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">MoFEM::CutMeshInterface::cOre</a></div><div class="ttdeci">MoFEM::Core &amp; cOre</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00023">CutMeshInterface.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a4f4d5194089ca2d3fbbc483eeb75c817"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4f4d5194089ca2d3fbbc483eeb75c817">MoFEM::CutMeshInterface::lineSearchSteps</a></div><div class="ttdeci">int lineSearchSteps</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00027">CutMeshInterface.hpp:27</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a6b9776c73fa2731c98ee28deab409ed7"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">MoFEM::CutMeshInterface::projectEntitiesQualityTrashold</a></div><div class="ttdeci">double projectEntitiesQualityTrashold</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00029">CutMeshInterface.hpp:29</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aa4a886cef884b12a6fc193fb98cace45"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa4a886cef884b12a6fc193fb98cace45">MoFEM::CutMeshInterface::nbMaxMergingCycles</a></div><div class="ttdeci">int nbMaxMergingCycles</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00028">CutMeshInterface.hpp:28</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ace826597c4dd6be6bfc29b21bfad3dbe" name="ace826597c4dd6be6bfc29b21bfad3dbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ace826597c4dd6be6bfc29b21bfad3dbe">&#9670;&#160;</a></span>~CutMeshInterface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">MoFEM::CutMeshInterface::~CutMeshInterface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00025">25</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>{}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a67d0cdac80f09af5b4d821c671600ae9" name="a67d0cdac80f09af5b4d821c671600ae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67d0cdac80f09af5b4d821c671600ae9">&#9670;&#160;</a></span>buildTree()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::buildTree </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>build tree </p>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a33">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00215">215</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  215</span>                                           {</div>
<div class="line"><span class="lineno">  216</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  217</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  218</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  219</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a> = boost::shared_ptr&lt;OrientedBoxTreeTool&gt;(</div>
<div class="line"><span class="lineno">  220</span>      <span class="keyword">new</span> OrientedBoxTreeTool(&amp;moab, <span class="stringliteral">&quot;ROOTSETSURF&quot;</span>, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno">  221</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>-&gt;build(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a>);</div>
<div class="line"><span class="lineno">  222</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  223</span>}</div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00346">definitions.h:346</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00416">definitions.h:416</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00535">definitions.h:535</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a9ca0a8b7e9788553bacbc2661fb22af4"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">MoFEM::CoreTmp&lt; 0 &gt;::get_moab</a></div><div class="ttdeci">moab::Interface &amp; get_moab()</div><div class="ttdef"><b>Definition:</b> <a href="_core_8hpp_source.html#l00322">Core.hpp:322</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a096f5f19f72b2a300d274d55162b6f19"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">MoFEM::CutMeshInterface::sUrface</a></div><div class="ttdeci">Range sUrface</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00539">CutMeshInterface.hpp:539</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a74b5639fd1bdc3d0bb759f9b53076483"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">MoFEM::CutMeshInterface::rootSetSurf</a></div><div class="ttdeci">EntityHandle rootSetSurf</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00543">CutMeshInterface.hpp:543</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_adc59d5f363970862abcd6d284d947c74"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">MoFEM::CutMeshInterface::treeSurfPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; OrientedBoxTreeTool &gt; treeSurfPtr</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00542">CutMeshInterface.hpp:542</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa31ee0ab802df14469284121486524f2" name="aa31ee0ab802df14469284121486524f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa31ee0ab802df14469284121486524f2">&#9670;&#160;</a></span>clearMap()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::clearMap </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00030">30</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   30</span>                                          {</div>
<div class="line"><span class="lineno">   31</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">   32</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>.reset();</div>
<div class="line"><span class="lineno">   33</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">   34</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a08b8bbab5b73482ebe67655c8211e77b" name="a08b8bbab5b73482ebe67655c8211e77b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08b8bbab5b73482ebe67655c8211e77b">&#9670;&#160;</a></span>copySurface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::copySurface </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>surface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>shift</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>origin</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classdouble.html">double</a> *&#160;</td>
          <td class="paramname"><em>transform</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>save_mesh</em> = <code>&quot;&quot;</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>copy surface entities </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">surface</td><td>entities which going to be added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a28">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00048">48</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>                                                                        {</div>
<div class="line"><span class="lineno">   52</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">   53</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">   54</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>.clear();</div>
<div class="line"><span class="lineno">   56</span>  std::map&lt;EntityHandle, EntityHandle&gt; verts_map;</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordflow">for</span> (Range::const_iterator tit = <a class="code hl_namespace" href="namespacesurface.html">surface</a>.begin(); tit != <a class="code hl_namespace" href="namespacesurface.html">surface</a>.end();</div>
<div class="line"><span class="lineno">   58</span>       tit++) {</div>
<div class="line"><span class="lineno">   59</span>    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno">   61</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(*tit, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> coords(num_nodes, 3);</div>
<div class="line"><span class="lineno">   63</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line"><span class="lineno">   64</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn, num_nodes, &amp;coords(0, 0));</div>
<div class="line"><span class="lineno">   65</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   66</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, &amp;coords(0, 0));</div>
<div class="line"><span class="lineno">   67</span>    }</div>
<div class="line"><span class="lineno">   68</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> new_verts[num_nodes];</div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != num_nodes; nn++) {</div>
<div class="line"><span class="lineno">   70</span>      <span class="keywordflow">if</span> (verts_map.find(conn[nn]) != verts_map.end()) {</div>
<div class="line"><span class="lineno">   71</span>        new_verts[nn] = verts_map[conn[nn]];</div>
<div class="line"><span class="lineno">   72</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">   73</span>        <span class="keywordflow">if</span> (transform) {</div>
<div class="line"><span class="lineno">   74</span>          ublas::matrix_row&lt;MatrixDouble&gt; mr(coords, nn);</div>
<div class="line"><span class="lineno">   75</span>          <span class="keywordflow">if</span> (origin) {</div>
<div class="line"><span class="lineno">   76</span>            <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> vec_origin(</div>
<div class="line"><span class="lineno">   77</span>                3, ublas::shallow_array_adaptor&lt;double&gt;(3, origin));</div>
<div class="line"><span class="lineno">   78</span>            mr = mr - vec_origin;</div>
<div class="line"><span class="lineno">   79</span>          }</div>
<div class="line"><span class="lineno">   80</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MatrixAdaptor</a> mat_transform = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MatrixAdaptor</a>(</div>
<div class="line"><span class="lineno">   81</span>              3, 3, ublas::shallow_array_adaptor&lt;double&gt;(9, transform));</div>
<div class="line"><span class="lineno">   82</span>          mr = prod(mat_transform, mr);</div>
<div class="line"><span class="lineno">   83</span>          <span class="keywordflow">if</span> (origin) {</div>
<div class="line"><span class="lineno">   84</span>            <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> vec_origin(</div>
<div class="line"><span class="lineno">   85</span>                3, ublas::shallow_array_adaptor&lt;double&gt;(3, origin));</div>
<div class="line"><span class="lineno">   86</span>            mr = mr + vec_origin;</div>
<div class="line"><span class="lineno">   87</span>          }</div>
<div class="line"><span class="lineno">   88</span>        }</div>
<div class="line"><span class="lineno">   89</span>        <span class="keywordflow">if</span> (shift) {</div>
<div class="line"><span class="lineno">   90</span>          ublas::matrix_row&lt;MatrixDouble&gt; mr(coords, nn);</div>
<div class="line"><span class="lineno">   91</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> vec_shift(</div>
<div class="line"><span class="lineno">   92</span>              3, ublas::shallow_array_adaptor&lt;double&gt;(3, shift));</div>
<div class="line"><span class="lineno">   93</span>          mr = mr + vec_shift;</div>
<div class="line"><span class="lineno">   94</span>        }</div>
<div class="line"><span class="lineno">   95</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_vertex(&amp;coords(nn, 0), new_verts[nn]);</div>
<div class="line"><span class="lineno">   96</span>        verts_map[conn[nn]] = new_verts[nn];</div>
<div class="line"><span class="lineno">   97</span>      }</div>
<div class="line"><span class="lineno">   98</span>    }</div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ele;</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_element(MBTRI, new_verts, num_nodes, ele);</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>.insert(ele);</div>
<div class="line"><span class="lineno">  102</span>  }</div>
<div class="line"><span class="lineno">  103</span>  <span class="keywordflow">if</span> (!save_mesh.empty())</div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(save_mesh, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>);</div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  106</span>}</div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a5dfc306af1addb8e8a14a1428e966654"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">MoFEM::Types::VectorAdaptor</a></div><div class="ttdeci">VectorShallowArrayAdaptor&lt; double &gt; VectorAdaptor</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00115">Types.hpp:115</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_ab467fcf0a32d31e9e038d1188ed8958f"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MoFEM::Types::MatrixAdaptor</a></div><div class="ttdeci">MatrixShallowArrayAdaptor&lt; double &gt; MatrixAdaptor</div><div class="ttdoc">Matrix adaptor.</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00132">Types.hpp:132</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition:</b> <a href="_projection10_node_coords_on_field_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="anamespacesurface_html"><div class="ttname"><a href="namespacesurface.html">surface</a></div><div class="ttdef"><b>Definition:</b> <a href="surface_8py_source.html#l00001">surface.py:1</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac56d3eb52d6a3acb55eb0eb3866101a4" name="ac56d3eb52d6a3acb55eb0eb3866101a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac56d3eb52d6a3acb55eb0eb3866101a4">&#9670;&#160;</a></span>createFrontLevelSets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::createFrontLevelSets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate distance from mesh nodes to surface front. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td></td></tr>
    <tr><td class="paramname">th</td><td>if not null take coordinates from tag </td></tr>
    <tr><td class="paramname">verb</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00609">609</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  611</span>                                                                        {</div>
<div class="line"><span class="lineno">  612</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  613</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  614</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>  <span class="keyword">auto</span> create_tag = [&amp;](<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>) {</div>
<div class="line"><span class="lineno">  617</span>    Tag <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno">  618</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.tag_get_handle(name.c_str(), <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  619</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><span class="lineno">  620</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno">  621</span>    std::vector&lt;double&gt; def_val(<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, 0);</div>
<div class="line"><span class="lineno">  622</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(name.c_str(), <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, MB_TYPE_DOUBLE, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>,</div>
<div class="line"><span class="lineno">  623</span>                               MB_TAG_CREAT | MB_TAG_SPARSE, &amp;*def_val.begin());</div>
<div class="line"><span class="lineno">  624</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno">  625</span>  };</div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>  <a class="code hl_class" href="class_range.html">Range</a> vol_vertices;</div>
<div class="line"><span class="lineno">  628</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(vol, vol_vertices, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>  std::vector&lt;double&gt; min_distances_from_front(vol_vertices.size(), -1);</div>
<div class="line"><span class="lineno">  631</span>  std::vector&lt;double&gt; points_on_edges(3 * vol_vertices.size(), 0);</div>
<div class="line"><span class="lineno">  632</span>  std::vector&lt;EntityHandle&gt; closest_edges(vol_vertices.size(), 0);</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>  std::vector&lt;double&gt; coords(3 * vol_vertices.size());</div>
<div class="line"><span class="lineno">  635</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno">  636</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, vol_vertices, &amp;*coords.begin());</div>
<div class="line"><span class="lineno">  637</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  638</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(vol_vertices, &amp;*coords.begin());</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;Tools&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><span class="lineno">  641</span>      &amp;*coords.begin(), vol_vertices.size(), <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>,</div>
<div class="line"><span class="lineno">  642</span>      &amp;*min_distances_from_front.begin(), &amp;*points_on_edges.begin(),</div>
<div class="line"><span class="lineno">  643</span>      &amp;*closest_edges.begin());</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>  <span class="keywordflow">if</span> (!points_on_edges.empty()) {</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != min_distances_from_front.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line"><span class="lineno">  647</span>      <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line"><span class="lineno">  648</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;closest_edges[0], 1, 2, <span class="keyword">false</span>, faces);</div>
<div class="line"><span class="lineno">  649</span>      <span class="keyword">auto</span> point_in = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[3 * <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>], 3);</div>
<div class="line"><span class="lineno">  650</span>      <span class="keyword">auto</span> point_out = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;points_on_edges[3 * <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>], 3);</div>
<div class="line"><span class="lineno">  651</span>      point_out -= point_in;</div>
<div class="line"><span class="lineno">  652</span>    }</div>
<div class="line"><span class="lineno">  653</span>  }</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>  <span class="keyword">auto</span> th_dist_front_vec = create_tag(<span class="stringliteral">&quot;DIST_FRONT_VECTOR&quot;</span>, 3);</div>
<div class="line"><span class="lineno">  656</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(th_dist_front_vec, vol_vertices,</div>
<div class="line"><span class="lineno">  657</span>                           &amp;*points_on_edges.begin());</div>
<div class="line"><span class="lineno">  658</span> </div>
<div class="line"><span class="lineno">  659</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  660</span>}</div>
<div class="ttc" id="a_cut_mesh_interface_8cpp_html_ac0f53b69ec9c555d10ce1b1ca620f165"><div class="ttname"><a href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a></div><div class="ttdeci">#define CutMeshFunctionBegin</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00007">CutMeshInterface.cpp:7</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="aelec__phys__2_d_8cpp_html_afe4f94e033c0d1c57d407b4338a64b33"><div class="ttname"><a href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a></div><div class="ttdeci">const int dim</div><div class="ttdef"><b>Definition:</b> <a href="elec__phys__2_d_8cpp_source.html#l00012">elec_phys_2D.cpp:12</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a6ffd47b9e0afb9f78ad9e88ca71e65a7"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">MoFEM::Exceptions::rval</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; moab::ErrorCode &gt; rval</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00074">Exceptions.hpp:74</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a00ca24984a29be87bd99504af7f6ebee"><div class="ttname"><a href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">MoFEM::getVectorAdaptor</a></div><div class="ttdeci">auto getVectorAdaptor(T1 ptr, const size_t n)</div><div class="ttdoc">Get Vector adaptor.</div><div class="ttdef"><b>Definition:</b> <a href="_templates_8hpp_source.html#l00031">Templates.hpp:31</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ad31de547dbb35fc59c2d858e698179d6"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">MoFEM::CutMeshInterface::fRont</a></div><div class="ttdeci">Range fRont</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00538">CutMeshInterface.hpp:538</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface refernce to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aff39b406f6369d6ec8eba29bfbd22e1f" name="aff39b406f6369d6ec8eba29bfbd22e1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aff39b406f6369d6ec8eba29bfbd22e1f">&#9670;&#160;</a></span>createSurfaceLevelSets()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::createSurfaceLevelSets </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Calculate distance from mesh nodes to cut surface. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">intersect_vol</td><td></td></tr>
    <tr><td class="paramname">verb</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00477">477</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  478</span>                                                                          {</div>
<div class="line"><span class="lineno">  479</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  480</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  481</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  482</span>  <span class="keyword">auto</span> tools_interface = m_field.getInterface&lt;Tools&gt;();</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>  <span class="keyword">auto</span> create_tag = [&amp;](<span class="keyword">const</span> std::string name, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>) {</div>
<div class="line"><span class="lineno">  485</span>    Tag <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.tag_get_handle(name.c_str(), <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  487</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><span class="lineno">  488</span>      <span class="keywordflow">return</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno">  489</span>    std::vector&lt;double&gt; def_val(<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, 0);</div>
<div class="line"><span class="lineno">  490</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(name.c_str(), <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, MB_TYPE_DOUBLE, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>,</div>
<div class="line"><span class="lineno">  491</span>                               MB_TAG_CREAT | MB_TAG_SPARSE, &amp;*def_val.begin());</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno">  494</span>  };</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>  <span class="keyword">auto</span> set_vol = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;vol_verts, std::vector&lt;double&gt; &amp;coords,</div>
<div class="line"><span class="lineno">  497</span>                     std::vector&lt;double&gt; &amp;dist_surface_vec,</div>
<div class="line"><span class="lineno">  498</span>                     std::vector&lt;double&gt; &amp;dist_surface_normal_vec,</div>
<div class="line"><span class="lineno">  499</span>                     std::vector&lt;double&gt; &amp;dist_surface_signed_dist_vec) {</div>
<div class="line"><span class="lineno">  500</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    coords.resize(3 * vol_verts.size());</div>
<div class="line"><span class="lineno">  503</span>    dist_surface_vec.resize(3 * vol_verts.size());</div>
<div class="line"><span class="lineno">  504</span>    dist_surface_normal_vec.resize(3 * vol_verts.size());</div>
<div class="line"><span class="lineno">  505</span>    dist_surface_signed_dist_vec.resize(vol_verts.size());</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(vol_verts, &amp;*coords.begin());</div>
<div class="line"><span class="lineno">  508</span>    std::srand(0);</div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : vol_verts) {</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespaceprint__rollers.html#a97b2acd15e42088063f92b429d049650">index</a> = vol_verts.index(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno">  513</span>      <span class="keyword">auto</span> point_in = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[3 * index], 3);</div>
<div class="line"><span class="lineno">  514</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> point_out(3);</div>
<div class="line"><span class="lineno">  515</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> facets_out;</div>
<div class="line"><span class="lineno">  516</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>-&gt;closest_to_location(&amp;point_in[0], <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a>,</div>
<div class="line"><span class="lineno">  517</span>                                              &amp;point_out[0], facets_out);</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> = point_out - point_in;</div>
<div class="line"><span class="lineno">  520</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> n_first(3);</div>
<div class="line"><span class="lineno">  521</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tools_interface-&gt;getTriNormal(facets_out, &amp;*n_first.begin());</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>      <span class="comment">// Check of only triangle in proximity of point out is one triangle, if is</span></div>
<div class="line"><span class="lineno">  524</span>      <span class="comment">// more than one, use normal of lager triangle to set orientation.</span></div>
<div class="line"><span class="lineno">  525</span>      <span class="keyword">auto</span> check_triangle_orientation = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>) {</div>
<div class="line"><span class="lineno">  526</span>        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno">  527</span>        <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno">  528</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(facets_out, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  529</span>        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MatrixDouble3by3</a> coords(3, 3);</div>
<div class="line"><span class="lineno">  530</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, 3, &amp;coords(0, 0));</div>
<div class="line"><span class="lineno">  531</span>        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> center(3);</div>
<div class="line"><span class="lineno">  532</span>        center.clear();</div>
<div class="line"><span class="lineno">  533</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {0, 1, 2})</div>
<div class="line"><span class="lineno">  534</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> jj : {0, 1, 2})</div>
<div class="line"><span class="lineno">  535</span>            center(jj) += coords(ii, jj) / 3;</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>        std::vector&lt;EntityHandle&gt; triangles_out;</div>
<div class="line"><span class="lineno">  538</span>        std::vector&lt;double&gt; distance_out;</div>
<div class="line"><span class="lineno">  539</span>        <span class="keyword">auto</span> a_max = norm_2(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>);</div>
<div class="line"><span class="lineno">  540</span>        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray = -<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> / a_max;</div>
<div class="line"><span class="lineno">  541</span>        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> pt = center - ray * sqrt(a_max);</div>
<div class="line"><span class="lineno">  542</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> ray_length = 2 * sqrt(a_max);</div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>-&gt;ray_intersect_triangles(</div>
<div class="line"><span class="lineno">  545</span>            distance_out, triangles_out, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a>,</div>
<div class="line"><span class="lineno">  546</span>            std::numeric_limits&lt;float&gt;::epsilon(), &amp;pt[0], &amp;ray[0],</div>
<div class="line"><span class="lineno">  547</span>            &amp;ray_length);</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>        <span class="keywordflow">if</span> (triangles_out.size() &gt; 1) {</div>
<div class="line"><span class="lineno">  550</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> nt(3);</div>
<div class="line"><span class="lineno">  551</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : triangles_out) {</div>
<div class="line"><span class="lineno">  552</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tools_interface-&gt;getTriNormal(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, &amp;*nt.begin());</div>
<div class="line"><span class="lineno">  553</span>            <span class="keywordtype">double</span> at = norm_2(nt);</div>
<div class="line"><span class="lineno">  554</span>            <span class="keywordflow">if</span> (at &gt; a_max) {</div>
<div class="line"><span class="lineno">  555</span>              <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> = nt;</div>
<div class="line"><span class="lineno">  556</span>              a_max = at;</div>
<div class="line"><span class="lineno">  557</span>            }</div>
<div class="line"><span class="lineno">  558</span>          }</div>
<div class="line"><span class="lineno">  559</span>        }</div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>;</div>
<div class="line"><span class="lineno">  562</span>      };</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>      <span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> = check_triangle_orientation(n_first);</div>
<div class="line"><span class="lineno">  565</span>      <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> /= norm_2(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>);</div>
<div class="line"><span class="lineno">  566</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dot = inner_prod(<a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>      <span class="keywordflow">if</span> (std::abs(dot) &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><span class="lineno">  570</span>        <span class="keywordflow">if</span> (std::rand() % 2 == 0)</div>
<div class="line"><span class="lineno">  571</span>          <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> += <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> * std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><span class="lineno">  572</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  573</span>          <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> -= <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> * std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><span class="lineno">  574</span>      }</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span>      <span class="keyword">auto</span> dist_vec = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;dist_surface_vec[3 * index], 3);</div>
<div class="line"><span class="lineno">  577</span>      noalias(dist_vec) = <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>;</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>      <span class="keyword">auto</span> dist_normal_vec =</div>
<div class="line"><span class="lineno">  580</span>          <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;dist_surface_normal_vec[3 * index], 3);</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>      dist_surface_signed_dist_vec[<a class="code hl_variable" href="namespaceprint__rollers.html#a97b2acd15e42088063f92b429d049650">index</a>] = dot;</div>
<div class="line"><span class="lineno">  583</span>      noalias(dist_normal_vec) = dot * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>;</div>
<div class="line"><span class="lineno">  584</span>    }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  587</span>  };</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>  std::vector&lt;double&gt; coords;</div>
<div class="line"><span class="lineno">  590</span>  std::vector&lt;double&gt; dist_surface_vec;</div>
<div class="line"><span class="lineno">  591</span>  std::vector&lt;double&gt; dist_surface_normal_vec;</div>
<div class="line"><span class="lineno">  592</span>  std::vector&lt;double&gt; dist_surface_signed_dist_vec;</div>
<div class="line"><span class="lineno">  593</span>  <a class="code hl_class" href="class_range.html">Range</a> vol_verts;</div>
<div class="line"><span class="lineno">  594</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, vol_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_vol(vol_verts, coords, dist_surface_vec, dist_surface_normal_vec,</div>
<div class="line"><span class="lineno">  597</span>                 dist_surface_signed_dist_vec);</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(create_tag(<span class="stringliteral">&quot;DIST_SURFACE_VECTOR&quot;</span>, 3), vol_verts,</div>
<div class="line"><span class="lineno">  600</span>                           &amp;*dist_surface_vec.begin());</div>
<div class="line"><span class="lineno">  601</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(create_tag(<span class="stringliteral">&quot;DIST_SURFACE_NORMAL_VECTOR&quot;</span>, 3),</div>
<div class="line"><span class="lineno">  602</span>                           vol_verts, &amp;*dist_surface_normal_vec.begin());</div>
<div class="line"><span class="lineno">  603</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(create_tag(<span class="stringliteral">&quot;DIST_SURFACE_NORMAL_SIGNED&quot;</span>, 1),</div>
<div class="line"><span class="lineno">  604</span>                           vol_verts, &amp;*dist_surface_signed_dist_vec.begin());</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  607</span>}</div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_a85adab6ee98bfcb82caccea618fde959"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a></div><div class="ttdeci">FTensor::Index&lt; 'n', SPACE_DIM &gt; n</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00066">fluid_structure_eigenproblem.cpp:66</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a2a1a0695ea7feb3a1e73a8707ef9f083"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">MoFEM::Types::VectorDouble3</a></div><div class="ttdeci">VectorBoundedArray&lt; double, 3 &gt; VectorDouble3</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00092">Types.hpp:92</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_ac1d820a203fd9a7f34f3a3257b2d38b7"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MoFEM::Types::MatrixDouble3by3</a></div><div class="ttdeci">MatrixBoundedArray&lt; double, 9 &gt; MatrixDouble3by3</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00105">Types.hpp:105</a></div></div>
<div class="ttc" id="anamespaceprint__rollers_html_a97b2acd15e42088063f92b429d049650"><div class="ttname"><a href="namespaceprint__rollers.html#a97b2acd15e42088063f92b429d049650">print_rollers.index</a></div><div class="ttdeci">int index</div><div class="ttdef"><b>Definition:</b> <a href="print__rollers_8py_source.html#l00270">print_rollers.py:270</a></div></div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition:</b> <a href="plate_8cpp_source.html#l00059">plate.cpp:59</a></div></div>
<div class="ttc" id="aprism__elements__from__surface_8cpp_html_a9eb248cd425bb908c67fa311945029cc"><div class="ttname"><a href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a></div><div class="ttdeci">static constexpr double delta</div><div class="ttdef"><b>Definition:</b> <a href="prism__elements__from__surface_8cpp_source.html#l00018">prism_elements_from_surface.cpp:18</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a1995cac02879c652163074223c5fb296"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">MoFEM::CutMeshInterface::vOlume</a></div><div class="ttdeci">Range vOlume</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00540">CutMeshInterface.hpp:540</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab717cee861e22f9d988b3871e9e228f5" name="ab717cee861e22f9d988b3871e9e228f5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab717cee861e22f9d988b3871e9e228f5">&#9670;&#160;</a></span>cutAndTrim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::cutAndTrim </td>
          <td>(</td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>first_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_geometry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_cut_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_trim_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edges</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>corner_nodes</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>update_meshsets</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cut and trim. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_bit</td><td></td></tr>
    <tr><td class="paramname">th</td><td></td></tr>
    <tr><td class="paramname">tol_geometry</td><td></td></tr>
    <tr><td class="paramname">tol_cut_close</td><td></td></tr>
    <tr><td class="paramname">tol_trim_close</td><td></td></tr>
    <tr><td class="paramname">fixed_edges</td><td></td></tr>
    <tr><td class="paramname">corner_nodes</td><td></td></tr>
    <tr><td class="paramname">update_meshsets</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00309">309</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  312</span>                                                                       {</div>
<div class="line"><span class="lineno">  313</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  314</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  std::vector&lt;BitRefLevel&gt; bit_levels;</div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span>  <span class="keyword">auto</span> get_back_bit_levels = [&amp;]() {</div>
<div class="line"><span class="lineno">  319</span>    bit_levels.push_back(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>());</div>
<div class="line"><span class="lineno">  320</span>    bit_levels.back().set(first_bit + bit_levels.size() - 1);</div>
<div class="line"><span class="lineno">  321</span>    <span class="keywordflow">return</span> bit_levels.back();</div>
<div class="line"><span class="lineno">  322</span>  };</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> cut_bit = get_back_bit_levels();</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac3214a803b9083172d4bcbebf13b4c8b">cutOnly</a>(unite(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a>), cut_bit, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>,</div>
<div class="line"><span class="lineno">  327</span>                 tol_geometry, tol_cut_close, fixed_edges, corner_nodes,</div>
<div class="line"><span class="lineno">  328</span>                 update_meshsets, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>  <span class="keyword">auto</span> get_min_quality = [&amp;m_field](<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, Tag <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line"><span class="lineno">  331</span>    <a class="code hl_class" href="class_range.html">Range</a> tets_level; <span class="comment">// test at level</span></div>
<div class="line"><span class="lineno">  332</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno">  333</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets_level);</div>
<div class="line"><span class="lineno">  334</span>    <span class="keywordtype">double</span> min_q = 1;</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;Tools&gt;()-&gt;minTetsQuality(tets_level, min_q, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordflow">return</span> min_q;</div>
<div class="line"><span class="lineno">  337</span>  };</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::inform, <span class="stringliteral">&quot;Min quality cut %6.4g&quot;</span>,</div>
<div class="line"><span class="lineno">  340</span>              get_min_quality(cut_bit, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>));</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <a class="code hl_class" href="class_range.html">Range</a> starting_volume = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>;</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_class" href="class_range.html">Range</a> starting_volume_nodes;</div>
<div class="line"><span class="lineno">  344</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_connectivity(starting_volume,</div>
<div class="line"><span class="lineno">  345</span>                                             starting_volume_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  346</span>  std::vector&lt;double&gt; staring_volume_coords(3 * starting_volume_nodes.size());</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_coords(starting_volume_nodes,</div>
<div class="line"><span class="lineno">  348</span>                                       &amp;*staring_volume_coords.begin());</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line"><span class="lineno">  351</span>    std::vector&lt;double&gt; staring_volume_th_coords(3 *</div>
<div class="line"><span class="lineno">  352</span>                                                 starting_volume_nodes.size());</div>
<div class="line"><span class="lineno">  353</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, starting_volume_nodes,</div>
<div class="line"><span class="lineno">  354</span>                                           &amp;*staring_volume_th_coords.begin());</div>
<div class="line"><span class="lineno">  355</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().set_coords(starting_volume_nodes,</div>
<div class="line"><span class="lineno">  356</span>                                         &amp;*staring_volume_th_coords.begin());</div>
<div class="line"><span class="lineno">  357</span>  }</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno">  360</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac8c2be86d34af5f6c71e5d7d2696b954">setTagData</a>(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> trim_bit = get_back_bit_levels();</div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14f173d3cba5074db4437f5d578427d9">trimOnly</a>(trim_bit, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, tol_trim_close, fixed_edges, corner_nodes,</div>
<div class="line"><span class="lineno">  365</span>                  update_meshsets, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::inform, <span class="stringliteral">&quot;Min quality trim %3.2g&quot;</span>,</div>
<div class="line"><span class="lineno">  368</span>              get_min_quality(trim_bit, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>));</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>  first_bit += bit_levels.size() - 1;</div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno">  373</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().set_coords(starting_volume_nodes,</div>
<div class="line"><span class="lineno">  374</span>                                         &amp;*staring_volume_coords.begin());</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  377</span>}</div>
<div class="ttc" id="a_log_manager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="_log_manager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition:</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition:</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a14f173d3cba5074db4437f5d578427d9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14f173d3cba5074db4437f5d578427d9">MoFEM::CutMeshInterface::trimOnly</a></div><div class="ttdeci">MoFEMErrorCode trimOnly(const BitRefLevel trim_bit, Tag th, const double tol_trim_close, Range *fixed_edges=NULL, Range *corner_nodes=NULL, const bool update_meshsets=false, const bool debug=false)</div><div class="ttdoc">Trim mesh only.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00263">CutMeshInterface.cpp:263</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a208b503c4a559549484c8cae4af2b1aa"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">MoFEM::CutMeshInterface::cutFrontVolumes</a></div><div class="ttdeci">Range cutFrontVolumes</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00576">CutMeshInterface.hpp:576</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a4e149175ff1d5e5086a6b36dc1477ca1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">MoFEM::CutMeshInterface::cutNewVolumes</a></div><div class="ttdeci">Range cutNewVolumes</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00546">CutMeshInterface.hpp:546</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ac3214a803b9083172d4bcbebf13b4c8b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac3214a803b9083172d4bcbebf13b4c8b">MoFEM::CutMeshInterface::cutOnly</a></div><div class="ttdeci">MoFEMErrorCode cutOnly(Range vol, const BitRefLevel cut_bit, Tag th, const double tol_geometry, const double tol_cut_close, Range *fixed_edges=NULL, Range *corner_nodes=NULL, const bool update_meshsets=false, const bool debug=false)</div><div class="ttdoc">Cut mesh only.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00226">CutMeshInterface.cpp:226</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ac8c2be86d34af5f6c71e5d7d2696b954"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac8c2be86d34af5f6c71e5d7d2696b954">MoFEM::CutMeshInterface::setTagData</a></div><div class="ttdeci">MoFEMErrorCode setTagData(Tag th, const BitRefLevel bit=BitRefLevel())</div><div class="ttdoc">set coords to tag</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l03114">CutMeshInterface.cpp:3114</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ac9552b1279ac23cc91e58d42dafe7ce6"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">MoFEM::CutMeshInterface::cutSurfaceVolumes</a></div><div class="ttdeci">Range cutSurfaceVolumes</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00575">CutMeshInterface.hpp:575</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5623680896e3fa6675304bd913f3be7b" name="a5623680896e3fa6675304bd913f3be7b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5623680896e3fa6675304bd913f3be7b">&#9670;&#160;</a></span>cutEdgesInMiddle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::cutEdgesInMiddle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>cut_vols</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>cut_surf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>cut_verts</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>cut edges </p>
<p >For edges to cut (calculated by findEdgesToCut), edges are split in the middle and then using <a class="el" href="struct_mo_f_e_m_1_1_mesh_refinement.html" title="Mesh refinement interface.">MoFEM::MeshRefinement</a> interface, tetrahedra mesh are cut.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bit</td><td>BitRefLevel of new mesh created by cutting edges </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l01298">1298</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1302</span>                                                                    {</div>
<div class="line"><span class="lineno"> 1303</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 1304</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 1305</span>  MeshRefinement *refiner;</div>
<div class="line"><span class="lineno"> 1306</span>  <span class="keyword">auto</span> ref_ents_ptr = m_field.get_ref_ents();</div>
<div class="line"><span class="lineno"> 1307</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>.size() != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.size())</div>
<div class="line"><span class="lineno"> 1310</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Data inconsistency&quot;</span>);</div>
<div class="line"><span class="lineno"> 1311</span> </div>
<div class="line"><span class="lineno"> 1312</span>  <span class="keyword">auto</span> refine_mesh = [&amp;]() {</div>
<div class="line"><span class="lineno"> 1313</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1314</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface(refiner);</div>
<div class="line"><span class="lineno"> 1315</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refiner-&gt;addVerticesInTheMiddleOfEdges(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><span class="lineno"> 1316</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refiner-&gt;refineTets(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno"> 1317</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1318</span>  };</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine_mesh();</div>
<div class="line"><span class="lineno"> 1321</span> </div>
<div class="line"><span class="lineno"> 1322</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1323</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>.size() != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.size())</div>
<div class="line"><span class="lineno"> 1324</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Data inconsistency&quot;</span>);</div>
<div class="line"><span class="lineno"> 1325</span> </div>
<div class="line"><span class="lineno"> 1326</span>  cut_vols.clear();</div>
<div class="line"><span class="lineno"> 1327</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 1328</span>      <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, cut_vols);</div>
<div class="line"><span class="lineno"> 1329</span>  cut_surf.clear();</div>
<div class="line"><span class="lineno"> 1330</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 1331</span>      <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, MBTRI, cut_surf);</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1334</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;cut_surf_from_bit.vtk&quot;</span>, cut_surf);</div>
<div class="line"><span class="lineno"> 1335</span> </div>
<div class="line"><span class="lineno"> 1336</span>  <span class="comment">// Find new vertices on cut edges</span></div>
<div class="line"><span class="lineno"> 1337</span>  cut_verts.clear();</div>
<div class="line"><span class="lineno"> 1338</span>  cut_verts.merge(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a>);</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>) {</div>
<div class="line"><span class="lineno"> 1341</span>    <span class="keyword">auto</span> vit = ref_ents_ptr-&gt;get&lt;Composite_ParentEnt_And_EntType_mi_tag&gt;().find(</div>
<div class="line"><span class="lineno"> 1342</span>        boost::make_tuple(MBVERTEX, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first));</div>
<div class="line"><span class="lineno"> 1343</span>    <span class="keywordflow">if</span> (vit ==</div>
<div class="line"><span class="lineno"> 1344</span>        ref_ents_ptr-&gt;get&lt;Composite_ParentEnt_And_EntType_mi_tag&gt;().end()) {</div>
<div class="line"><span class="lineno"> 1345</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno"> 1346</span>              <span class="stringliteral">&quot;No vertex on cut edges, that make no sense&quot;</span>);</div>
<div class="line"><span class="lineno"> 1347</span>    }</div>
<div class="line"><span class="lineno"> 1348</span>    <span class="keyword">const</span> boost::shared_ptr&lt;RefEntity&gt; &amp;ref_ent = *vit;</div>
<div class="line"><span class="lineno"> 1349</span>    <span class="keywordflow">if</span> ((ref_ent-&gt;getBitRefLevel() &amp; <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>).any()) {</div>
<div class="line"><span class="lineno"> 1350</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> vert = ref_ent-&gt;getEnt();</div>
<div class="line"><span class="lineno"> 1351</span>      cut_verts.insert(vert);</div>
<div class="line"><span class="lineno"> 1352</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a>[vert] = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second;</div>
<div class="line"><span class="lineno"> 1353</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1354</span>      SETERRQ1(</div>
<div class="line"><span class="lineno"> 1355</span>          PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno"> 1356</span>          <span class="stringliteral">&quot;Vertex has wrong bit ref level %s&quot;</span>,</div>
<div class="line"><span class="lineno"> 1357</span>          boost::lexical_cast&lt;std::string&gt;(ref_ent-&gt;getBitRefLevel()).c_str());</div>
<div class="line"><span class="lineno"> 1358</span>    }</div>
<div class="line"><span class="lineno"> 1359</span>  }</div>
<div class="line"><span class="lineno"> 1360</span> </div>
<div class="line"><span class="lineno"> 1361</span>  <span class="comment">// Add zero distance entities faces</span></div>
<div class="line"><span class="lineno"> 1362</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line"><span class="lineno"> 1363</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno"> 1364</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, cut_vols, <span class="keyword">false</span>, tets_skin);</div>
<div class="line"><span class="lineno"> 1365</span>  tets_skin.merge(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>);</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>  <span class="comment">// At that point cut_surf has all newly created faces, now take all</span></div>
<div class="line"><span class="lineno"> 1368</span>  <span class="comment">// nodes on those faces and subtract nodes on cut edges. Faces adjacent to</span></div>
<div class="line"><span class="lineno"> 1369</span>  <span class="comment">// nodes which left are not part of surface.</span></div>
<div class="line"><span class="lineno"> 1370</span>  cut_surf.merge(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">zeroDistanceEnts</a>.subset_by_type(MBTRI));</div>
<div class="line"><span class="lineno"> 1371</span>  <a class="code hl_class" href="class_range.html">Range</a> diff_verts;</div>
<div class="line"><span class="lineno"> 1372</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(cut_surf, diff_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1373</span>  diff_verts = subtract(diff_verts, cut_verts);</div>
<div class="line"><span class="lineno"> 1374</span> </div>
<div class="line"><span class="lineno"> 1375</span>  <a class="code hl_class" href="class_range.html">Range</a> subtract_faces;</div>
<div class="line"><span class="lineno"> 1376</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(diff_verts, 2, <span class="keyword">false</span>, subtract_faces,</div>
<div class="line"><span class="lineno"> 1377</span>                              moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1378</span>  cut_surf = subtract(cut_surf, unite(subtract_faces, tets_skin));</div>
<div class="line"><span class="lineno"> 1379</span> </div>
<div class="line"><span class="lineno"> 1380</span>  cut_verts.clear();</div>
<div class="line"><span class="lineno"> 1381</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(cut_surf, cut_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1382</span> </div>
<div class="line"><span class="lineno"> 1383</span>  <span class="comment">// Check non-mainfolds</span></div>
<div class="line"><span class="lineno"> 1384</span>  <span class="keyword">auto</span> check_for_non_minfold = [&amp;]() {</div>
<div class="line"><span class="lineno"> 1385</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1386</span>    <a class="code hl_class" href="class_range.html">Range</a> surf_edges;</div>
<div class="line"><span class="lineno"> 1387</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(cut_surf, 1, <span class="keyword">false</span>, surf_edges,</div>
<div class="line"><span class="lineno"> 1388</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1389</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : surf_edges) {</div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>      <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line"><span class="lineno"> 1392</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;e, 1, 2, <span class="keyword">false</span>, faces);</div>
<div class="line"><span class="lineno"> 1393</span>      faces = intersect(faces, cut_surf);</div>
<div class="line"><span class="lineno"> 1394</span>      <span class="keywordflow">if</span> (faces.size() &gt; 2) {</div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span>        <span class="keywordtype">bool</span> resolved = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>        <span class="comment">// Check for haning node</span></div>
<div class="line"><span class="lineno"> 1399</span>        <a class="code hl_class" href="class_range.html">Range</a> nodes;</div>
<div class="line"><span class="lineno"> 1400</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(faces, nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1401</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> : nodes) {</div>
<div class="line"><span class="lineno"> 1402</span>          <a class="code hl_class" href="class_range.html">Range</a> adj_faces;</div>
<div class="line"><span class="lineno"> 1403</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>, 1, 2, <span class="keyword">false</span>, adj_faces);</div>
<div class="line"><span class="lineno"> 1404</span>          adj_faces = intersect(adj_faces, cut_surf);</div>
<div class="line"><span class="lineno"> 1405</span>          <span class="keywordflow">if</span> (adj_faces.size() == 1) {</div>
<div class="line"><span class="lineno"> 1406</span>            cut_surf.erase(adj_faces[0]);</div>
<div class="line"><span class="lineno"> 1407</span>            resolved = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1408</span>          }</div>
<div class="line"><span class="lineno"> 1409</span>        }</div>
<div class="line"><span class="lineno"> 1410</span> </div>
<div class="line"><span class="lineno"> 1411</span>        <span class="comment">// Check for two edges minfold</span></div>
<div class="line"><span class="lineno"> 1412</span>        <a class="code hl_class" href="class_range.html">Range</a> adj_edges;</div>
<div class="line"><span class="lineno"> 1413</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(faces, 1, <span class="keyword">false</span>, adj_edges,</div>
<div class="line"><span class="lineno"> 1414</span>                                    moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1415</span>        adj_edges = intersect(adj_edges, surf_edges);</div>
<div class="line"><span class="lineno"> 1416</span>        adj_edges.erase(e);</div>
<div class="line"><span class="lineno"> 1417</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> other_e : adj_edges) {</div>
<div class="line"><span class="lineno"> 1418</span>          <a class="code hl_class" href="class_range.html">Range</a> other_faces;</div>
<div class="line"><span class="lineno"> 1419</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;other_e, 1, 2, <span class="keyword">false</span>, other_faces);</div>
<div class="line"><span class="lineno"> 1420</span>          other_faces = intersect(other_faces, cut_surf);</div>
<div class="line"><span class="lineno"> 1421</span>          <span class="keywordflow">if</span> (other_faces.size() &gt; 2) {</div>
<div class="line"><span class="lineno"> 1422</span>            other_faces = intersect(other_faces, faces);</div>
<div class="line"><span class="lineno"> 1423</span>            cut_surf = subtract(cut_surf, other_faces);</div>
<div class="line"><span class="lineno"> 1424</span>            resolved = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1425</span>          }</div>
<div class="line"><span class="lineno"> 1426</span>        }</div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>        <span class="keywordflow">if</span> (!resolved &amp;&amp; !<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1429</span>          SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno"> 1430</span>                  <span class="stringliteral">&quot;Non-mainfold surface&quot;</span>);</div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>        cut_verts.clear();</div>
<div class="line"><span class="lineno"> 1433</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(cut_surf, cut_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1434</span>      }</div>
<div class="line"><span class="lineno"> 1435</span>    }</div>
<div class="line"><span class="lineno"> 1436</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1437</span>  };</div>
<div class="line"><span class="lineno"> 1438</span> </div>
<div class="line"><span class="lineno"> 1439</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_non_minfold();</div>
<div class="line"><span class="lineno"> 1440</span> </div>
<div class="line"><span class="lineno"> 1441</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1442</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;cut_surf.vtk&quot;</span>, cut_surf);</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1445</span>}</div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00208">definitions.h:208</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_aaeeb615e0d0b09b810b29ec6086e0112"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', SPACE_DIM &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00065">fluid_structure_eigenproblem.cpp:65</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a2775e2dc0fca083966780c4fd30eba07"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">MoFEM::CutMeshInterface::constrainSurface</a></div><div class="ttdeci">Range constrainSurface</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00577">CutMeshInterface.hpp:577</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a86c2b9230209eebcf507ba5ca4e43c2c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">MoFEM::CutMeshInterface::zeroDistanceEnts</a></div><div class="ttdeci">Range zeroDistanceEnts</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00548">CutMeshInterface.hpp:548</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a95629e9a8eaeb96f050d7c3d3e334a99"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">MoFEM::CutMeshInterface::verticesOnCutEdges</a></div><div class="ttdeci">map&lt; EntityHandle, TreeData &gt; verticesOnCutEdges</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00568">CutMeshInterface.hpp:568</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ad277d5b4f2c7eb02619acca528e60f1c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">MoFEM::CutMeshInterface::edgesToCut</a></div><div class="ttdeci">map&lt; EntityHandle, TreeData &gt; edgesToCut</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00567">CutMeshInterface.hpp:567</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_af8f5e939ef8a867d87ac6bc3b32e18ec"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">MoFEM::CutMeshInterface::zeroDistanceVerts</a></div><div class="ttdeci">Range zeroDistanceVerts</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00549">CutMeshInterface.hpp:549</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_afd47f33b2d5fb21c26ddf80444360bba"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">MoFEM::CutMeshInterface::cutEdges</a></div><div class="ttdeci">Range cutEdges</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00545">CutMeshInterface.hpp:545</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ac3214a803b9083172d4bcbebf13b4c8b" name="ac3214a803b9083172d4bcbebf13b4c8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac3214a803b9083172d4bcbebf13b4c8b">&#9670;&#160;</a></span>cutOnly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::cutOnly </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>cut_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_geometry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_cut_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edges</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>corner_nodes</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>update_meshsets</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cut mesh only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td></td></tr>
    <tr><td class="paramname">cut_bit</td><td></td></tr>
    <tr><td class="paramname">th</td><td></td></tr>
    <tr><td class="paramname">tol_geometry</td><td></td></tr>
    <tr><td class="paramname">tol_cut_close</td><td></td></tr>
    <tr><td class="paramname">fixed_edges</td><td></td></tr>
    <tr><td class="paramname">corner_nodes</td><td></td></tr>
    <tr><td class="paramname">update_meshsets</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00226">226</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  229</span>                                                                        {</div>
<div class="line"><span class="lineno">  230</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  231</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  232</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>  <span class="comment">// cut mesh</span></div>
<div class="line"><span class="lineno">  235</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3a70284c3b782b5153ca63de37a4d3f1">findEdgesToCut</a>(vol, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  236</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3028c39783a3c872e50a146b488929f9">projectZeroDistanceEnts</a>(fixed_edges, corner_nodes, tol_geometry,</div>
<div class="line"><span class="lineno">  237</span>                                 tol_cut_close, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  238</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5623680896e3fa6675304bd913f3be7b">cutEdgesInMiddle</a>(cut_bit, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>,</div>
<div class="line"><span class="lineno">  239</span>                          <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a75bdd40b1e7208d4c435acee21562669">cutNewVertices</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>,</div>
<div class="line"><span class="lineno">  242</span>                                                         <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>);</div>
<div class="line"><span class="lineno">  243</span>  <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(*fixed_edges,</div>
<div class="line"><span class="lineno">  245</span>                                                           *fixed_edges);</div>
<div class="line"><span class="lineno">  246</span>  <span class="keywordflow">if</span> (corner_nodes)</div>
<div class="line"><span class="lineno">  247</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(*corner_nodes,</div>
<div class="line"><span class="lineno">  248</span>                                                           *corner_nodes);</div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordflow">if</span> (update_meshsets)</div>
<div class="line"><span class="lineno">  250</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;MeshsetsManager&gt;()</div>
<div class="line"><span class="lineno">  251</span>        -&gt;updateAllMeshsetsByEntitiesChildren(cut_bit);</div>
<div class="line"><span class="lineno">  252</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8e8a8509c57589e4de9b347821a9dd99">moveMidNodesOnCutEdges</a>(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno">  255</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a99386261dc7636e7ccfd8348a311ef7c">saveCutEdges</a>();</div>
<div class="line"><span class="lineno">  256</span>    <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno">  257</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;out_cut_new_fixed_edges.vtk&quot;</span>, *fixed_edges);</div>
<div class="line"><span class="lineno">  258</span>  }</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  261</span>}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a3028c39783a3c872e50a146b488929f9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3028c39783a3c872e50a146b488929f9">MoFEM::CutMeshInterface::projectZeroDistanceEnts</a></div><div class="ttdeci">const Range &amp; projectZeroDistanceEnts() const</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00473">CutMeshInterface.hpp:473</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a3a70284c3b782b5153ca63de37a4d3f1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a3a70284c3b782b5153ca63de37a4d3f1">MoFEM::CutMeshInterface::findEdgesToCut</a></div><div class="ttdeci">MoFEMErrorCode findEdgesToCut(Range vol, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">find edges to cut</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00897">CutMeshInterface.cpp:897</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a5623680896e3fa6675304bd913f3be7b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5623680896e3fa6675304bd913f3be7b">MoFEM::CutMeshInterface::cutEdgesInMiddle</a></div><div class="ttdeci">MoFEMErrorCode cutEdgesInMiddle(const BitRefLevel bit, Range &amp;cut_vols, Range &amp;cut_surf, Range &amp;cut_verts, const bool debug=false)</div><div class="ttdoc">cut edges</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l01298">CutMeshInterface.cpp:1298</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a75bdd40b1e7208d4c435acee21562669"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a75bdd40b1e7208d4c435acee21562669">MoFEM::CutMeshInterface::cutNewVertices</a></div><div class="ttdeci">Range cutNewVertices</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00550">CutMeshInterface.hpp:550</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a8e8a8509c57589e4de9b347821a9dd99"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8e8a8509c57589e4de9b347821a9dd99">MoFEM::CutMeshInterface::moveMidNodesOnCutEdges</a></div><div class="ttdeci">MoFEMErrorCode moveMidNodesOnCutEdges(Tag th=NULL)</div><div class="ttdoc">projecting of mid edge nodes on new mesh on surface</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l01447">CutMeshInterface.cpp:1447</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a99386261dc7636e7ccfd8348a311ef7c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a99386261dc7636e7ccfd8348a311ef7c">MoFEM::CutMeshInterface::saveCutEdges</a></div><div class="ttdeci">MoFEMErrorCode saveCutEdges(const std::string prefix=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l03147">CutMeshInterface.cpp:3147</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a9d20a18617586fd01c1da8bc486d2061"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">MoFEM::CutMeshInterface::cutNewSurfaces</a></div><div class="ttdeci">Range cutNewSurfaces</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00547">CutMeshInterface.hpp:547</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad1ef5dac44a93d2934fabd08e35c72a9" name="ad1ef5dac44a93d2934fabd08e35c72a9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad1ef5dac44a93d2934fabd08e35c72a9">&#9670;&#160;</a></span>cutTrimAndMerge()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::cutTrimAndMerge </td>
          <td>(</td>
          <td class="paramtype">int &amp;&#160;</td>
          <td class="paramname"><em>first_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>fraction_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_geometry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_cut_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_trim_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>corner_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>update_meshsets</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Cut, trim and merge. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">first_bit</td><td>first bit of bit revel, subsequent set bits are for trim and merge </td></tr>
    <tr><td class="paramname">fraction_level</td><td>fraction of edges merged at each merge step </td></tr>
    <tr><td class="paramname">th</td><td>tag storring mesh node positions </td></tr>
    <tr><td class="paramname">tol_geometry</td><td>tolerance how mesh node should be close to cut surface (mesh node is moved), should be small </td></tr>
    <tr><td class="paramname">tol_cut_close</td><td>how crack node should be close to mesh (cut surface node is moved), can be big </td></tr>
    <tr><td class="paramname">tol_trim_close</td><td>how front node should be close to mesh, can be big </td></tr>
    <tr><td class="paramname">fixed_edges</td><td>edges on which nodes can not be moved </td></tr>
    <tr><td class="paramname">corner_nodes</td><td>nodes which can not be moved </td></tr>
    <tr><td class="paramname">update_meshsets</td><td>update meshsets by parents </td></tr>
    <tr><td class="paramname">debug</td><td>swich on debugging </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a39">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00379">379</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  382</span>                                                                       {</div>
<div class="line"><span class="lineno">  383</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  384</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>  std::vector&lt;BitRefLevel&gt; bit_levels;</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  <span class="keyword">auto</span> get_back_bit_levels = [&amp;]() {</div>
<div class="line"><span class="lineno">  389</span>    bit_levels.push_back(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>());</div>
<div class="line"><span class="lineno">  390</span>    bit_levels.back().set(first_bit + bit_levels.size() - 1);</div>
<div class="line"><span class="lineno">  391</span>    <span class="keywordflow">return</span> bit_levels.back();</div>
<div class="line"><span class="lineno">  392</span>  };</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno">  395</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;writeEntitiesNotInDatabase(</div>
<div class="line"><span class="lineno">  396</span>        <span class="stringliteral">&quot;ents_not_in_database.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  397</span>  }</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ab717cee861e22f9d988b3871e9e228f5">cutAndTrim</a>(first_bit, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, tol_geometry, tol_cut_close, tol_trim_close,</div>
<div class="line"><span class="lineno">  400</span>                    &amp;fixed_edges, &amp;corner_nodes, update_meshsets, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  401</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;writeEntitiesNotInDatabase(</div>
<div class="line"><span class="lineno">  403</span>        <span class="stringliteral">&quot;cut_trim_ents_not_in_database.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_level1 = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(first_bit - 1);</div>
<div class="line"><span class="lineno">  406</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_level2 = get_back_bit_levels();</div>
<div class="line"><span class="lineno">  407</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_level3 = get_back_bit_levels();</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a77c2ce9c07b85d08e79672d0b025e33c">mergeBadEdges</a>(fraction_level, bit_level1, bit_level2, bit_level3,</div>
<div class="line"><span class="lineno">  410</span>                       <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac2227475101c2c0200d0894e766501dc">getNewTrimSurfaces</a>(), fixed_edges, corner_nodes, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>,</div>
<div class="line"><span class="lineno">  411</span>                       update_meshsets, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>  <span class="keyword">auto</span> get_min_quality = [&amp;m_field, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>](<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, Tag <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line"><span class="lineno">  414</span>    <a class="code hl_class" href="class_range.html">Range</a> tets_level; <span class="comment">// test at level</span></div>
<div class="line"><span class="lineno">  415</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno">  416</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets_level);</div>
<div class="line"><span class="lineno">  417</span>    <span class="keywordtype">double</span> min_q = 1;</div>
<div class="line"><span class="lineno">  418</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;Tools&gt;()-&gt;minTetsQuality(tets_level, min_q, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  419</span>    <span class="keywordflow">if</span> (min_q &lt; 0 &amp;&amp; <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno">  420</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;Tools&gt;()-&gt;writeTetsWithQuality(</div>
<div class="line"><span class="lineno">  421</span>          <span class="stringliteral">&quot;negative_tets.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, tets_level, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  422</span>    }</div>
<div class="line"><span class="lineno">  423</span>    <span class="keywordflow">return</span> min_q;</div>
<div class="line"><span class="lineno">  424</span>  };</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::inform, <span class="stringliteral">&quot;Min quality node merge %6.4g&quot;</span>,</div>
<div class="line"><span class="lineno">  427</span>              get_min_quality(bit_level3, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>));</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>,</div>
<div class="line"><span class="lineno">  430</span>                                                         <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>);</div>
<div class="line"><span class="lineno">  431</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(fixed_edges,</div>
<div class="line"><span class="lineno">  432</span>                                                         fixed_edges);</div>
<div class="line"><span class="lineno">  433</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(corner_nodes,</div>
<div class="line"><span class="lineno">  434</span>                                                         corner_nodes);</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  first_bit += bit_levels.size() - 1;</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno">  439</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><span class="lineno">  440</span>        bit_level3, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, <span class="stringliteral">&quot;out_tets_merged.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>,</div>
<div class="line"><span class="lineno">  441</span>        <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  442</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;writeEntitiesNotInDatabase(</div>
<div class="line"><span class="lineno">  443</span>        <span class="stringliteral">&quot;cut_trim_merge_ents_not_in_database.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">  444</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;merged_surface.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa54c4ce1e4f1249778ebb15e7e4d12ae">mergedSurfaces</a>);</div>
<div class="line"><span class="lineno">  445</span>  }</div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  448</span>}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a77c2ce9c07b85d08e79672d0b025e33c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a77c2ce9c07b85d08e79672d0b025e33c">MoFEM::CutMeshInterface::mergeBadEdges</a></div><div class="ttdeci">MoFEMErrorCode mergeBadEdges(const int fraction_level, const Range &amp;tets, const Range &amp;surface, const Range &amp;fixed_edges, const Range &amp;corner_nodes, Range &amp;merged_nodes, Range &amp;out_tets, Range &amp;new_surf, Tag th, const bool update_meshsets=false, const BitRefLevel *bit_ptr=NULL, const bool debug=false)</div><div class="ttdoc">Merge edges.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l02302">CutMeshInterface.cpp:2302</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aa54c4ce1e4f1249778ebb15e7e4d12ae"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa54c4ce1e4f1249778ebb15e7e4d12ae">MoFEM::CutMeshInterface::mergedSurfaces</a></div><div class="ttdeci">Range mergedSurfaces</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00558">CutMeshInterface.hpp:558</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ab717cee861e22f9d988b3871e9e228f5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ab717cee861e22f9d988b3871e9e228f5">MoFEM::CutMeshInterface::cutAndTrim</a></div><div class="ttdeci">MoFEMErrorCode cutAndTrim(int &amp;first_bit, Tag th, const double tol_geometry, const double tol_cut_close, const double tol_trim_close, Range *fixed_edges=NULL, Range *corner_nodes=NULL, const bool update_meshsets=false, const bool debug=false)</div><div class="ttdoc">Cut and trim.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00309">CutMeshInterface.cpp:309</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ac2227475101c2c0200d0894e766501dc"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac2227475101c2c0200d0894e766501dc">MoFEM::CutMeshInterface::getNewTrimSurfaces</a></div><div class="ttdeci">const Range &amp; getNewTrimSurfaces() const</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00479">CutMeshInterface.hpp:479</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3a70284c3b782b5153ca63de37a4d3f1" name="a3a70284c3b782b5153ca63de37a4d3f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a70284c3b782b5153ca63de37a4d3f1">&#9670;&#160;</a></span>findEdgesToCut()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::findEdgesToCut </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>vol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>find edges to cut </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">vol</td><td>is tetrahedrons search to cut </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
    <tr><td class="paramname">debug</td><td>debugging </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00897">897</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  898</span>                                                                  {</div>
<div class="line"><span class="lineno">  899</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  900</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  901</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.clear();</div>
<div class="line"><span class="lineno">  904</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>.clear();</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>  Tag th_signed_dist;</div>
<div class="line"><span class="lineno">  907</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;DIST_SURFACE_NORMAL_SIGNED&quot;</span>, th_signed_dist);</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>  <span class="keyword">auto</span> get_tag_edge_dist = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">auto</span> conn) {</div>
<div class="line"><span class="lineno">  910</span>    std::array&lt;double, 2&gt; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"><span class="lineno">  911</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn, 2, <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.data());</div>
<div class="line"><span class="lineno">  912</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"><span class="lineno">  913</span>  };</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>  <span class="keyword">auto</span> get_conn = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> e) {</div>
<div class="line"><span class="lineno">  916</span>    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno">  917</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno">  918</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(e, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  919</span>    <span class="keywordflow">return</span> conn;</div>
<div class="line"><span class="lineno">  920</span>  };</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>  <span class="keyword">auto</span> get_adj = [&amp;moab](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>) {</div>
<div class="line"><span class="lineno">  923</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno">  924</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>)</div>
<div class="line"><span class="lineno">  925</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(r, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, <span class="keyword">false</span>, a, moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  926</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  927</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(r, a, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  928</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno">  929</span>  };</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span>  <span class="keyword">auto</span> vol_edges = get_adj(vol, 1);</div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">aveLength</a> = 0;</div>
<div class="line"><span class="lineno">  934</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a729419c6fa252624215c8ec8b317a8e4">maxLength</a> = 0;</div>
<div class="line"><span class="lineno">  935</span>  <span class="keywordtype">int</span> nb_ave_length = 0;</div>
<div class="line"><span class="lineno">  936</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : vol_edges) {</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>    <span class="keyword">auto</span> conn = get_conn(e);</div>
<div class="line"><span class="lineno">  939</span>    <span class="keyword">auto</span> dist = get_tag_edge_dist(th_signed_dist, conn);</div>
<div class="line"><span class="lineno">  940</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dist_max = std::max(dist[0], dist[1]);</div>
<div class="line"><span class="lineno">  941</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dist_min = std::min(dist[0], dist[1]);</div>
<div class="line"><span class="lineno">  942</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dot = dist[0] * dist[1];</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5086bdfa8de362615048f470022a9898">VectorDouble6</a> coords(6);</div>
<div class="line"><span class="lineno">  945</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, 2, &amp;coords[0]);</div>
<div class="line"><span class="lineno">  946</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> n0 = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[0], 3);</div>
<div class="line"><span class="lineno">  947</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> n1 = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[3], 3);</div>
<div class="line"><span class="lineno">  948</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray = n1 - n0;</div>
<div class="line"><span class="lineno">  949</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ray_length = norm_2(ray);</div>
<div class="line"><span class="lineno">  950</span>    ray /= ray_length;</div>
<div class="line"><span class="lineno">  951</span> </div>
<div class="line"><span class="lineno">  952</span>    <span class="keywordflow">if</span> (</div>
<div class="line"><span class="lineno">  953</span> </div>
<div class="line"><span class="lineno">  954</span>        (dot &lt; 0 &amp;&amp; dist_max &gt; std::numeric_limits&lt;double&gt;::epsilon()) ||</div>
<div class="line"><span class="lineno">  955</span>        (std::abs(dist_min) &lt; std::numeric_limits&lt;double&gt;::epsilon() &amp;&amp;</div>
<div class="line"><span class="lineno">  956</span>         dist_max &gt; std::numeric_limits&lt;double&gt;::epsilon())</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>    ) {</div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>      <span class="comment">// Edges is on two sides of the surface</span></div>
<div class="line"><span class="lineno">  961</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> s = dist[0] / (dist[0] - dist[1]);</div>
<div class="line"><span class="lineno">  962</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dist = s * ray_length;</div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span>      <span class="keyword">auto</span> add_edge = [&amp;](<span class="keyword">auto</span> dist) {</div>
<div class="line"><span class="lineno">  965</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>[e].dIst = dist;</div>
<div class="line"><span class="lineno">  966</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>[e].lEngth = ray_length;</div>
<div class="line"><span class="lineno">  967</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>[e].unitRayDir = ray;</div>
<div class="line"><span class="lineno">  968</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>[e].rayPoint = n0;</div>
<div class="line"><span class="lineno">  969</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>.insert(e);</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">aveLength</a> += norm_2(ray);</div>
<div class="line"><span class="lineno">  972</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a729419c6fa252624215c8ec8b317a8e4">maxLength</a> = fmax(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a729419c6fa252624215c8ec8b317a8e4">maxLength</a>, norm_2(ray));</div>
<div class="line"><span class="lineno">  973</span>        ++nb_ave_length;</div>
<div class="line"><span class="lineno">  974</span>      };</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>      add_edge(dist);</div>
<div class="line"><span class="lineno">  977</span>    }</div>
<div class="line"><span class="lineno">  978</span>  }</div>
<div class="line"><span class="lineno">  979</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">aveLength</a> /= nb_ave_length;</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  982</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;cut_edges.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>);</div>
<div class="line"><span class="lineno">  983</span> </div>
<div class="line"><span class="lineno">  984</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  985</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;cut_edges_vol.vtk&quot;</span>,</div>
<div class="line"><span class="lineno">  986</span>                                        get_adj(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>, 3));</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  989</span>}</div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a5086bdfa8de362615048f470022a9898"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a5086bdfa8de362615048f470022a9898">MoFEM::Types::VectorDouble6</a></div><div class="ttdeci">VectorBoundedArray&lt; double, 6 &gt; VectorDouble6</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00095">Types.hpp:95</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a27ab998c8029b8adcbcc89c4f967d43a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">MoFEM::CutMeshInterface::aveLength</a></div><div class="ttdeci">double aveLength</div><div class="ttdoc">Average edge length.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00572">CutMeshInterface.hpp:572</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a729419c6fa252624215c8ec8b317a8e4"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a729419c6fa252624215c8ec8b317a8e4">MoFEM::CutMeshInterface::maxLength</a></div><div class="ttdeci">double maxLength</div><div class="ttdoc">Maximal edge length.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00573">CutMeshInterface.hpp:573</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08769c58f2f2ad52cf371aadb1f62331" name="a08769c58f2f2ad52cf371aadb1f62331"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08769c58f2f2ad52cf371aadb1f62331">&#9670;&#160;</a></span>findEdgesToTrim()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::findEdgesToTrim </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>corner_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find edges to trimEdges. </p>
<p >To make this work, you need to find edges to cut (findEdgesToCut), then cut edges in the middle (cutEdgesInMiddle) and finally project edges on the surface (moveMidNodesOnCutEdges)</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>
<p >Project front entities on on the cut surface plane</p>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l01480">1480</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1483</span>                                                                   {</div>
<div class="line"><span class="lineno"> 1484</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 1485</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 1486</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>  <span class="comment">// takes body skin</span></div>
<div class="line"><span class="lineno"> 1489</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno"> 1490</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line"><span class="lineno"> 1491</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>, <span class="keyword">false</span>, tets_skin);</div>
<div class="line"><span class="lineno"> 1492</span>  tets_skin.merge(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>);</div>
<div class="line"><span class="lineno"> 1493</span> </div>
<div class="line"><span class="lineno"> 1494</span>  <span class="comment">// vertices on the skin</span></div>
<div class="line"><span class="lineno"> 1495</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin_verts;</div>
<div class="line"><span class="lineno"> 1496</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tets_skin, tets_skin_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1497</span>  <span class="comment">// edges on the skin</span></div>
<div class="line"><span class="lineno"> 1498</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin_edges;</div>
<div class="line"><span class="lineno"> 1499</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(tets_skin, 1, <span class="keyword">false</span>, tets_skin_edges,</div>
<div class="line"><span class="lineno"> 1500</span>                              moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1501</span> </div>
<div class="line"><span class="lineno"> 1502</span>  <span class="comment">// get edges on new surface</span></div>
<div class="line"><span class="lineno"> 1503</span>  <a class="code hl_class" href="class_range.html">Range</a> cut_surface_edges;</div>
<div class="line"><span class="lineno"> 1504</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>, 1, <span class="keyword">false</span>, cut_surface_edges,</div>
<div class="line"><span class="lineno"> 1505</span>                              moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1506</span>  <a class="code hl_class" href="class_range.html">Range</a> cut_surface_verts;</div>
<div class="line"><span class="lineno"> 1507</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>, cut_surface_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1508</span> </div>
<div class="line"><span class="lineno"> 1509</span>  <a class="code hl_class" href="class_range.html">Range</a> corners;</div>
<div class="line"><span class="lineno"> 1510</span>  <span class="keywordflow">if</span> (corner_nodes)</div>
<div class="line"><span class="lineno"> 1511</span>    corners = *corner_nodes;</div>
<div class="line"><span class="lineno"> 1512</span> </div>
<div class="line"><span class="lineno"> 1513</span>  <a class="code hl_class" href="class_range.html">Range</a> fix_edges;</div>
<div class="line"><span class="lineno"> 1514</span>  <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 1515</span>    fix_edges = *fixed_edges;</div>
<div class="line"><span class="lineno"> 1516</span> </div>
<div class="line"><span class="lineno"> 1517</span>  <a class="code hl_class" href="class_range.html">Range</a> fixed_edges_verts;</div>
<div class="line"><span class="lineno"> 1518</span>  <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 1519</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(*fixed_edges, fixed_edges_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span>  <a class="code hl_class" href="class_range.html">Range</a> surface_skin;</div>
<div class="line"><span class="lineno"> 1522</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>.empty())</div>
<div class="line"><span class="lineno"> 1523</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><span class="lineno"> 1524</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1525</span>    surface_skin = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>;</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span>  <span class="keyword">auto</span> get_point_coords = [&amp;](<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno"> 1528</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> point(3);</div>
<div class="line"><span class="lineno"> 1529</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 1530</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, &amp;point[0]);</div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1532</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, &amp;point[0]);</div>
<div class="line"><span class="lineno"> 1533</span>    <span class="keywordflow">return</span> point;</div>
<div class="line"><span class="lineno"> 1534</span>  };</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>  <span class="keyword">struct </span>VertMap {</div>
<div class="line"><span class="lineno"> 1537</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>;</div>
<div class="line"><span class="lineno"> 1538</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><span class="lineno"> 1539</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e;</div>
<div class="line"><span class="lineno"> 1540</span>    VertMap(<span class="keyword">const</span> <span class="keywordtype">double</span> d, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e)</div>
<div class="line"><span class="lineno"> 1541</span>        : <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>(<a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>), <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>), e(e) {}</div>
<div class="line"><span class="lineno"> 1542</span>  };</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span>  <span class="keyword">typedef</span> multi_index_container&lt;</div>
<div class="line"><span class="lineno"> 1545</span>      VertMap,</div>
<div class="line"><span class="lineno"> 1546</span>      indexed_by&lt;</div>
<div class="line"><span class="lineno"> 1547</span>          ordered_non_unique&lt;member&lt;VertMap, const double, &amp;VertMap::d&gt;&gt;,</div>
<div class="line"><span class="lineno"> 1548</span>          ordered_non_unique&lt;member&lt;VertMap, const EntityHandle, &amp;VertMap::v&gt;&gt;,</div>
<div class="line"><span class="lineno"> 1549</span>          ordered_non_unique&lt;member&lt;VertMap, const EntityHandle, &amp;VertMap::e&gt;&gt;</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>          &gt;&gt;</div>
<div class="line"><span class="lineno"> 1552</span>      VertMapMultiIndex;</div>
<div class="line"><span class="lineno"> 1553</span> </div>
<div class="line"><span class="lineno"> 1554</span>  VertMapMultiIndex verts_map;</div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span>  <span class="keyword">auto</span> add_vert = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e,</div>
<div class="line"><span class="lineno"> 1557</span>                      <span class="keyword">const</span> <span class="keywordtype">double</span> dist) {</div>
<div class="line"><span class="lineno"> 1558</span>    verts_map.insert(VertMap(dist, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, e));</div>
<div class="line"><span class="lineno"> 1559</span>  };</div>
<div class="line"><span class="lineno"> 1560</span> </div>
<div class="line"><span class="lineno"> 1561</span>  <span class="comment">// clear data ranges</span></div>
<div class="line"><span class="lineno"> 1562</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>.clear();</div>
<div class="line"><span class="lineno"> 1563</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>.clear();</div>
<div class="line"><span class="lineno"> 1564</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>.clear();</div>
<div class="line"><span class="lineno"> 1565</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.clear();</div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span>  <span class="keyword">auto</span> cut_this_edge = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e, <span class="keyword">const</span> <span class="keywordtype">double</span> length, <span class="keyword">auto</span> &amp;ray,</div>
<div class="line"><span class="lineno"> 1568</span>                           <span class="keyword">auto</span> &amp;ray_point) {</div>
<div class="line"><span class="lineno"> 1569</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>.insert(e);</div>
<div class="line"><span class="lineno"> 1570</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>[e].dIst = 1;</div>
<div class="line"><span class="lineno"> 1571</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>[e].lEngth = length;</div>
<div class="line"><span class="lineno"> 1572</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>[e].unitRayDir.resize(3, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1573</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>[e].rayPoint.resize(3, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1574</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1575</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>[e].unitRayDir[ii] = ray(ii);</div>
<div class="line"><span class="lineno"> 1576</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line"><span class="lineno"> 1577</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>[e].rayPoint[ii] = ray_point(ii);</div>
<div class="line"><span class="lineno"> 1578</span>  };</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span>  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno"> 1581</span>  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><span class="lineno"> 1582</span>  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><span class="lineno"> 1583</span> </div>
<div class="line"><span class="lineno"> 1584</span>  <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 1585</span> </div>
<div class="line"><span class="lineno"> 1586</span>  <span class="keyword">auto</span> get_tag_data = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">auto</span> conn) {</div>
<div class="line"><span class="lineno"> 1587</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>;</div>
<div class="line"><span class="lineno"> 1588</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;conn, 1, &amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>(0));</div>
<div class="line"><span class="lineno"> 1589</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>;</div>
<div class="line"><span class="lineno"> 1590</span>  };</div>
<div class="line"><span class="lineno"> 1591</span> </div>
<div class="line"><span class="lineno"> 1592</span>  <span class="keywordtype">double</span> max_edge_length = 0;</div>
<div class="line"><span class="lineno"> 1593</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1594</span><span class="comment">  /// Project front entities on on the cut surface plane</span></div>
<div class="line"><span class="lineno"> 1595</span><span class="comment"></span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1596</span>    <span class="comment">// Calculate distances</span></div>
<div class="line"><span class="lineno"> 1597</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a> = boost::shared_ptr&lt;OrientedBoxTreeTool&gt;(</div>
<div class="line"><span class="lineno"> 1598</span>        <span class="keyword">new</span> OrientedBoxTreeTool(&amp;moab, <span class="stringliteral">&quot;ROOTSETSURF&quot;</span>, <span class="keyword">true</span>));</div>
<div class="line"><span class="lineno"> 1599</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>-&gt;build(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a>);</div>
<div class="line"><span class="lineno"> 1600</span> </div>
<div class="line"><span class="lineno"> 1601</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : surface_skin) {</div>
<div class="line"><span class="lineno"> 1602</span> </div>
<div class="line"><span class="lineno"> 1603</span>      <span class="keyword">auto</span> project_on_surface = [&amp;](<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>) {</div>
<div class="line"><span class="lineno"> 1604</span>        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_p;</div>
<div class="line"><span class="lineno"> 1605</span> </div>
<div class="line"><span class="lineno"> 1606</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> facets_out;</div>
<div class="line"><span class="lineno"> 1607</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>-&gt;closest_to_location(&amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>(0), <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a>, &amp;t_p(0),</div>
<div class="line"><span class="lineno"> 1608</span>                                                facets_out);</div>
<div class="line"><span class="lineno"> 1609</span> </div>
<div class="line"><span class="lineno"> 1610</span>        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_normal;</div>
<div class="line"><span class="lineno"> 1611</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;Tools&gt;()-&gt;getTriNormal(facets_out,</div>
<div class="line"><span class="lineno"> 1612</span>                                                           &amp;t_normal(0));</div>
<div class="line"><span class="lineno"> 1613</span>        t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) /= sqrt(t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"><span class="lineno"> 1614</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> dot = t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (t_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"><span class="lineno"> 1615</span>        t_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + dot * t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1616</span> </div>
<div class="line"><span class="lineno"> 1617</span>        <span class="keywordflow">return</span> t_p;</div>
<div class="line"><span class="lineno"> 1618</span>      };</div>
<div class="line"><span class="lineno"> 1619</span> </div>
<div class="line"><span class="lineno"> 1620</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 1621</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(s, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1622</span> </div>
<div class="line"><span class="lineno"> 1623</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5086bdfa8de362615048f470022a9898">VectorDouble6</a> coords_front(6);</div>
<div class="line"><span class="lineno"> 1624</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, &amp;coords_front[0]);</div>
<div class="line"><span class="lineno"> 1625</span> </div>
<div class="line"><span class="lineno"> 1626</span>      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> t_f0(&amp;coords_front[0], &amp;coords_front[1],</div>
<div class="line"><span class="lineno"> 1627</span>                                         &amp;coords_front[2]);</div>
<div class="line"><span class="lineno"> 1628</span>      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double *, 3&gt;</a> t_f1(&amp;coords_front[3], &amp;coords_front[4],</div>
<div class="line"><span class="lineno"> 1629</span>                                         &amp;coords_front[5]);</div>
<div class="line"><span class="lineno"> 1630</span> </div>
<div class="line"><span class="lineno"> 1631</span>      <span class="keyword">auto</span> t_p_f0 = project_on_surface(t_f0);</div>
<div class="line"><span class="lineno"> 1632</span>      <span class="keyword">auto</span> t_p_f1 = project_on_surface(t_f1);</div>
<div class="line"><span class="lineno"> 1633</span> </div>
<div class="line"><span class="lineno"> 1634</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.set_coords(&amp;conn[0], 1, &amp;t_p_f0(0));</div>
<div class="line"><span class="lineno"> 1635</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.set_coords(&amp;conn[1], 1, &amp;t_p_f1(0));</div>
<div class="line"><span class="lineno"> 1636</span>    }</div>
<div class="line"><span class="lineno"> 1637</span>  }</div>
<div class="line"><span class="lineno"> 1638</span> </div>
<div class="line"><span class="lineno"> 1639</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1640</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;surface_skin_to_trim.vtk&quot;</span>, surface_skin);</div>
<div class="line"><span class="lineno"> 1641</span> </div>
<div class="line"><span class="lineno"> 1642</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac56d3eb52d6a3acb55eb0eb3866101a4">createFrontLevelSets</a>(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno"> 1643</span>  Tag th_dist_front_vec;</div>
<div class="line"><span class="lineno"> 1644</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;DIST_FRONT_VECTOR&quot;</span>, th_dist_front_vec);</div>
<div class="line"><span class="lineno"> 1645</span> </div>
<div class="line"><span class="lineno"> 1646</span>  <span class="comment">// iterate over edges on cut surface</span></div>
<div class="line"><span class="lineno"> 1647</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : cut_surface_edges) {</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>    <span class="keyword">auto</span> get_conn_edge = [&amp;moab](<span class="keyword">auto</span> e) {</div>
<div class="line"><span class="lineno"> 1650</span>      <span class="comment">// Get edge connectivity and coords</span></div>
<div class="line"><span class="lineno"> 1651</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn_edge;</div>
<div class="line"><span class="lineno"> 1652</span>      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 1653</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(e, conn_edge, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1654</span>      <span class="keywordflow">return</span> conn_edge;</div>
<div class="line"><span class="lineno"> 1655</span>    };</div>
<div class="line"><span class="lineno"> 1656</span> </div>
<div class="line"><span class="lineno"> 1657</span>    <span class="keyword">auto</span> get_coords_edge = [&amp;moab](<span class="keyword">auto</span> conn_edge) {</div>
<div class="line"><span class="lineno"> 1658</span>      std::array&lt;double, 6&gt; coords_edge;</div>
<div class="line"><span class="lineno"> 1659</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn_edge, 2, coords_edge.data());</div>
<div class="line"><span class="lineno"> 1660</span>      <span class="keywordflow">return</span> coords_edge;</div>
<div class="line"><span class="lineno"> 1661</span>    };</div>
<div class="line"><span class="lineno"> 1662</span> </div>
<div class="line"><span class="lineno"> 1663</span>    <span class="keyword">auto</span> get_ftensor_coords = [](<span class="keyword">const</span> <span class="keywordtype">double</span> *ptr) {</div>
<div class="line"><span class="lineno"> 1664</span>      <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>{ptr[0], ptr[1], ptr[2]};</div>
<div class="line"><span class="lineno"> 1665</span>    };</div>
<div class="line"><span class="lineno"> 1666</span> </div>
<div class="line"><span class="lineno"> 1667</span>    <span class="keyword">auto</span> conn_edge = get_conn_edge(e);</div>
<div class="line"><span class="lineno"> 1668</span>    <span class="keyword">auto</span> coords_edge = get_coords_edge(conn_edge);</div>
<div class="line"><span class="lineno"> 1669</span> </div>
<div class="line"><span class="lineno"> 1670</span>    <span class="keyword">auto</span> t_dist0 = get_tag_data(th_dist_front_vec, conn_edge[0]);</div>
<div class="line"><span class="lineno"> 1671</span>    <span class="keyword">auto</span> t_dist1 = get_tag_data(th_dist_front_vec, conn_edge[1]);</div>
<div class="line"><span class="lineno"> 1672</span>    <span class="keyword">auto</span> t_e0 = get_ftensor_coords(&amp;coords_edge[0]);</div>
<div class="line"><span class="lineno"> 1673</span>    <span class="keyword">auto</span> t_e1 = get_ftensor_coords(&amp;coords_edge[3]);</div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_edge_delta;</div>
<div class="line"><span class="lineno"> 1676</span>    t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_e1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_e0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1677</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> edge_length2 = t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1678</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> edge_length = sqrt(edge_length2);</div>
<div class="line"><span class="lineno"> 1679</span>    <span class="keywordflow">if</span> (edge_length == 0)</div>
<div class="line"><span class="lineno"> 1680</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Zero edge length&quot;</span>);</div>
<div class="line"><span class="lineno"> 1681</span> </div>
<div class="line"><span class="lineno"> 1682</span>    <span class="keyword">auto</span> add_edge = [&amp;](<span class="keyword">auto</span> t_cut) {</div>
<div class="line"><span class="lineno"> 1683</span>      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_ray;</div>
<div class="line"><span class="lineno"> 1684</span>      <span class="keywordflow">if</span> (t_cut &lt; 0.5) {</div>
<div class="line"><span class="lineno"> 1685</span>        t_ray(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_cut * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1686</span>        add_vert(conn_edge[0], e, fabs(t_cut));</div>
<div class="line"><span class="lineno"> 1687</span>        add_vert(conn_edge[1], e, fabs(t_cut - 1));</div>
<div class="line"><span class="lineno"> 1688</span>        cut_this_edge(e, edge_length, t_ray, t_e0);</div>
<div class="line"><span class="lineno"> 1689</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1690</span>        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_edge_point;</div>
<div class="line"><span class="lineno"> 1691</span>        t_edge_point(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_e0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_cut * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1692</span>        t_ray(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_edge_point(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_e1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1693</span>        add_vert(conn_edge[0], e, fabs(t_cut));</div>
<div class="line"><span class="lineno"> 1694</span>        add_vert(conn_edge[1], e, fabs(t_cut - 1));</div>
<div class="line"><span class="lineno"> 1695</span>        cut_this_edge(e, edge_length, t_ray, t_e1);</div>
<div class="line"><span class="lineno"> 1696</span>      }</div>
<div class="line"><span class="lineno"> 1697</span>      max_edge_length = std::max(max_edge_length, edge_length);</div>
<div class="line"><span class="lineno"> 1698</span>    };</div>
<div class="line"><span class="lineno"> 1699</span> </div>
<div class="line"><span class="lineno"> 1700</span>    <span class="keyword">auto</span> trim_cross_edges = [&amp;]() {</div>
<div class="line"><span class="lineno"> 1701</span>      <span class="keywordflow">if</span> (std::min(t_dist0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_dist0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>), t_dist1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_dist1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) &lt;</div>
<div class="line"><span class="lineno"> 1702</span>          edge_length2) {</div>
<div class="line"><span class="lineno"> 1703</span> </div>
<div class="line"><span class="lineno"> 1704</span>        <span class="keyword">auto</span> make_pair = [&amp;](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> te) {</div>
<div class="line"><span class="lineno"> 1705</span>          <span class="keywordflow">return</span> std::make_pair(d, te);</div>
<div class="line"><span class="lineno"> 1706</span>        };</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span>        <span class="keyword">auto</span> min_pair = make_pair(-1, -1);</div>
<div class="line"><span class="lineno"> 1709</span> </div>
<div class="line"><span class="lineno"> 1710</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : surface_skin) {</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>          <span class="keyword">auto</span> conn_front = get_conn_edge(f);</div>
<div class="line"><span class="lineno"> 1713</span>          <span class="keyword">auto</span> coords_front = get_coords_edge(conn_front);</div>
<div class="line"><span class="lineno"> 1714</span>          <span class="keyword">auto</span> t_f0 = get_ftensor_coords(&amp;coords_front[0]);</div>
<div class="line"><span class="lineno"> 1715</span>          <span class="keyword">auto</span> t_f1 = get_ftensor_coords(&amp;coords_front[3]);</div>
<div class="line"><span class="lineno"> 1716</span> </div>
<div class="line"><span class="lineno"> 1717</span>          <span class="keywordtype">double</span> te;</div>
<div class="line"><span class="lineno"> 1718</span>          <span class="keywordtype">double</span> tf;</div>
<div class="line"><span class="lineno"> 1719</span> </div>
<div class="line"><span class="lineno"> 1720</span>          <span class="keyword">auto</span> res = <a class="code hl_function" href="struct_mo_f_e_m_1_1_tools.html#a024ac6842bdf8498e9b02f1273e3f1e6">Tools::minDistanceFromSegments</a>(</div>
<div class="line"><span class="lineno"> 1721</span>              &amp;t_e0(0), &amp;t_e1(0), &amp;t_f0(0), &amp;t_f1(0), &amp;te, &amp;tf);</div>
<div class="line"><span class="lineno"> 1722</span> </div>
<div class="line"><span class="lineno"> 1723</span>          <span class="keywordflow">if</span> (res != <a class="code hl_enumvalue" href="struct_mo_f_e_m_1_1_tools.html#a3f412f42505cc802569c3f0176ac7a00a4b3c787326958839f44154bc244d3793">Tools::NO_SOLUTION</a>) {</div>
<div class="line"><span class="lineno"> 1724</span> </div>
<div class="line"><span class="lineno"> 1725</span>            <span class="keyword">auto</span> check = [](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno"> 1726</span>              <span class="keywordflow">return</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> &gt; -std::numeric_limits&lt;double&gt;::epsilon() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1727</span>                      (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> - 1) &lt; std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><span class="lineno"> 1728</span>            };</div>
<div class="line"><span class="lineno"> 1729</span> </div>
<div class="line"><span class="lineno"> 1730</span>            <span class="keywordflow">if</span> (check(te) &amp;&amp; check(tf)) {</div>
<div class="line"><span class="lineno"> 1731</span> </div>
<div class="line"><span class="lineno"> 1732</span>              <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_delta, t_cross;</div>
<div class="line"><span class="lineno"> 1733</span>              t_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = (t_e0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + te * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) -</div>
<div class="line"><span class="lineno"> 1734</span>                           (t_f0(0) + tf * (t_f1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_f0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)));</div>
<div class="line"><span class="lineno"> 1735</span> </div>
<div class="line"><span class="lineno"> 1736</span>              t_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) /= edge_length;</div>
<div class="line"><span class="lineno"> 1737</span> </div>
<div class="line"><span class="lineno"> 1738</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> dot = t_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1739</span> </div>
<div class="line"><span class="lineno"> 1740</span>              <span class="keywordflow">if</span> (min_pair.first &lt; 0 || min_pair.first &gt; dot) {</div>
<div class="line"><span class="lineno"> 1741</span> </div>
<div class="line"><span class="lineno"> 1742</span>                <span class="keywordflow">if</span> (dot &lt; tol_trim_close * tol_trim_close)</div>
<div class="line"><span class="lineno"> 1743</span>                  min_pair = make_pair(dot, te);</div>
<div class="line"><span class="lineno"> 1744</span>              }</div>
<div class="line"><span class="lineno"> 1745</span>            }</div>
<div class="line"><span class="lineno"> 1746</span>          }</div>
<div class="line"><span class="lineno"> 1747</span>        }</div>
<div class="line"><span class="lineno"> 1748</span> </div>
<div class="line"><span class="lineno"> 1749</span>        <span class="keywordflow">if</span> (min_pair.first &gt; -std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><span class="lineno"> 1750</span>          add_edge(min_pair.second);</div>
<div class="line"><span class="lineno"> 1751</span>          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1752</span>        }</div>
<div class="line"><span class="lineno"> 1753</span>      }</div>
<div class="line"><span class="lineno"> 1754</span> </div>
<div class="line"><span class="lineno"> 1755</span>      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1756</span>    };</div>
<div class="line"><span class="lineno"> 1757</span> </div>
<div class="line"><span class="lineno"> 1758</span>    <span class="keywordflow">if</span> (!trim_cross_edges()) {</div>
<div class="line"><span class="lineno"> 1759</span> </div>
<div class="line"><span class="lineno"> 1760</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dot = t_dist0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_dist1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1761</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dot_direction0 = t_dist0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1762</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> dot_direction1 = t_dist1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno"> 1763</span> </div>
<div class="line"><span class="lineno"> 1764</span>      <span class="keywordflow">if</span> (dot &lt; std::numeric_limits&lt;double&gt;::epsilon() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1765</span>          dot_direction0 &gt; -std::numeric_limits&lt;double&gt;::epsilon() &amp;&amp;</div>
<div class="line"><span class="lineno"> 1766</span>          dot_direction1 &lt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><span class="lineno"> 1767</span> </div>
<div class="line"><span class="lineno"> 1768</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> s0 = t_dist0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / edge_length;</div>
<div class="line"><span class="lineno"> 1769</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> s1 = t_dist1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_edge_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / edge_length;</div>
<div class="line"><span class="lineno"> 1770</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> t_cut = s0 / (s0 - s1);</div>
<div class="line"><span class="lineno"> 1771</span> </div>
<div class="line"><span class="lineno"> 1772</span>        add_edge(t_cut);</div>
<div class="line"><span class="lineno"> 1773</span>      }</div>
<div class="line"><span class="lineno"> 1774</span>    }</div>
<div class="line"><span class="lineno"> 1775</span>  }</div>
<div class="line"><span class="lineno"> 1776</span> </div>
<div class="line"><span class="lineno"> 1777</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1778</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;edges_potentially_to_trim.vtk&quot;</span>, cut_surface_edges);</div>
<div class="line"><span class="lineno"> 1779</span> </div>
<div class="line"><span class="lineno"> 1780</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1781</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;edges_selected_to_trim.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>);</div>
<div class="line"><span class="lineno"> 1782</span> </div>
<div class="line"><span class="lineno"> 1783</span>  <span class="keyword">auto</span> get_quality_change = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;adj_tets, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>,</div>
<div class="line"><span class="lineno"> 1784</span>                                <span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> &amp;new_pos) {</div>
<div class="line"><span class="lineno"> 1785</span>    <span class="keywordtype">double</span> q0 = 1;</div>
<div class="line"><span class="lineno"> 1786</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;Tools&gt;()-&gt;minTetsQuality(adj_tets, q0, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno"> 1787</span> </div>
<div class="line"><span class="lineno"> 1788</span>    <span class="keywordtype">double</span> min_q = 1;</div>
<div class="line"><span class="lineno"> 1789</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : adj_tets) {</div>
<div class="line"><span class="lineno"> 1790</span>      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 1791</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 1792</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_connectivity(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1793</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a6d261dceb89bbe340a2c40bb7f08e47d">VectorDouble12</a> coords(12);</div>
<div class="line"><span class="lineno"> 1794</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 1795</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn, num_nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 1796</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1797</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 1798</span> </div>
<div class="line"><span class="lineno"> 1799</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> = 0; <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> != 4; ++<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>) {</div>
<div class="line"><span class="lineno"> 1800</span>        <span class="keyword">auto</span> n_coords = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[3 * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>], 3);</div>
<div class="line"><span class="lineno"> 1801</span>        <span class="keywordflow">if</span> (conn[<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>] == <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno"> 1802</span>          noalias(n_coords) = new_pos;</div>
<div class="line"><span class="lineno"> 1803</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1804</span>          <span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>.find(conn[<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>]);</div>
<div class="line"><span class="lineno"> 1805</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>.end())</div>
<div class="line"><span class="lineno"> 1806</span>            noalias(n_coords) =</div>
<div class="line"><span class="lineno"> 1807</span>                <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>-&gt;second.rayPoint + <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>-&gt;second.dIst * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>-&gt;second.unitRayDir;</div>
<div class="line"><span class="lineno"> 1808</span>        }</div>
<div class="line"><span class="lineno"> 1809</span>      }</div>
<div class="line"><span class="lineno"> 1810</span> </div>
<div class="line"><span class="lineno"> 1811</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> q = <a class="code hl_function" href="struct_mo_f_e_m_1_1_tools.html#aad9f4194435be50a6c0b32600e7789b4">Tools::volumeLengthQuality</a>(&amp;coords[0]);</div>
<div class="line"><span class="lineno"> 1812</span>      <span class="keywordflow">if</span> (!std::isnormal(q)) {</div>
<div class="line"><span class="lineno"> 1813</span>        min_q = -2;</div>
<div class="line"><span class="lineno"> 1814</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 1815</span>      }</div>
<div class="line"><span class="lineno"> 1816</span>      min_q = std::min(min_q, q);</div>
<div class="line"><span class="lineno"> 1817</span>    }</div>
<div class="line"><span class="lineno"> 1818</span>    <span class="keywordflow">return</span> min_q / q0;</div>
<div class="line"><span class="lineno"> 1819</span>  };</div>
<div class="line"><span class="lineno"> 1820</span> </div>
<div class="line"><span class="lineno"> 1821</span>  <a class="code hl_class" href="class_range.html">Range</a> checked_verts;</div>
<div class="line"><span class="lineno"> 1822</span>  <span class="keyword">auto</span> add_trim_vert = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e) {</div>
<div class="line"><span class="lineno"> 1823</span>    <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.find(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.end())) {</div>
<div class="line"><span class="lineno"> 1824</span>      <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>.at(e);</div>
<div class="line"><span class="lineno"> 1825</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray_point = get_point_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1826</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> new_pos = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.rayPoint + <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.dIst * <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.unitRayDir;</div>
<div class="line"><span class="lineno"> 1827</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> unit_ray_dir = ray_point - new_pos;</div>
<div class="line"><span class="lineno"> 1828</span>      <a class="code hl_class" href="class_range.html">Range</a> adj_tets;</div>
<div class="line"><span class="lineno"> 1829</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, 3, <span class="keyword">false</span>, adj_tets);</div>
<div class="line"><span class="lineno"> 1830</span>      adj_tets = intersect(adj_tets, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>);</div>
<div class="line"><span class="lineno"> 1831</span>      <span class="keywordtype">double</span> q = get_quality_change(adj_tets, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, new_pos);</div>
<div class="line"><span class="lineno"> 1832</span>      <span class="keywordflow">if</span> (q &gt; <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">projectEntitiesQualityTrashold</a>) {</div>
<div class="line"><span class="lineno"> 1833</span>        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray_dir = new_pos - ray_point;</div>
<div class="line"><span class="lineno"> 1834</span>        <span class="keywordtype">double</span> dist = norm_2(ray_dir);</div>
<div class="line"><span class="lineno"> 1835</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].dIst = 1;</div>
<div class="line"><span class="lineno"> 1836</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].lEngth = dist;</div>
<div class="line"><span class="lineno"> 1837</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].unitRayDir = ray_dir;</div>
<div class="line"><span class="lineno"> 1838</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].rayPoint = ray_point;</div>
<div class="line"><span class="lineno"> 1839</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.insert(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1840</span>      }</div>
<div class="line"><span class="lineno"> 1841</span>      checked_verts.insert(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1842</span>    }</div>
<div class="line"><span class="lineno"> 1843</span>  };</div>
<div class="line"><span class="lineno"> 1844</span> </div>
<div class="line"><span class="lineno"> 1845</span>  <span class="keyword">auto</span> add_no_move_trim = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e) {</div>
<div class="line"><span class="lineno"> 1846</span>    <span class="keywordflow">if</span> (!(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.find(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.end())) {</div>
<div class="line"><span class="lineno"> 1847</span>      <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>.at(e);</div>
<div class="line"><span class="lineno"> 1848</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>] = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>;</div>
<div class="line"><span class="lineno"> 1849</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].rayPoint = get_point_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1850</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].lEngth = 0;</div>
<div class="line"><span class="lineno"> 1851</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>].dIst = 0;</div>
<div class="line"><span class="lineno"> 1852</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.insert(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1853</span>      checked_verts.insert(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1854</span>    }</div>
<div class="line"><span class="lineno"> 1855</span>  };</div>
<div class="line"><span class="lineno"> 1856</span> </div>
<div class="line"><span class="lineno"> 1857</span>  <span class="comment">// Iterate over all vertives close to surface front and check if those can</span></div>
<div class="line"><span class="lineno"> 1858</span>  <span class="comment">// be moved</span></div>
<div class="line"><span class="lineno"> 1859</span> </div>
<div class="line"><span class="lineno"> 1860</span>  <span class="comment">// filer nodes which distance is in given tolerance</span></div>
<div class="line"><span class="lineno"> 1861</span>  <span class="keyword">auto</span> hi = verts_map.get&lt;0&gt;().upper_bound(tol_trim_close);</div>
<div class="line"><span class="lineno"> 1862</span>  verts_map.get&lt;0&gt;().erase(hi, verts_map.end());</div>
<div class="line"><span class="lineno"> 1863</span> </div>
<div class="line"><span class="lineno"> 1864</span>  <span class="keyword">auto</span> remove_verts = [&amp;](<a class="code hl_class" href="class_range.html">Range</a> nodes) {</div>
<div class="line"><span class="lineno"> 1865</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> : nodes) {</div>
<div class="line"><span class="lineno"> 1866</span>      <span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = verts_map.get&lt;1&gt;().equal_range(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>);</div>
<div class="line"><span class="lineno"> 1867</span>      verts_map.get&lt;1&gt;().erase(<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.first, <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.second);</div>
<div class="line"><span class="lineno"> 1868</span>    }</div>
<div class="line"><span class="lineno"> 1869</span>  };</div>
<div class="line"><span class="lineno"> 1870</span> </div>
<div class="line"><span class="lineno"> 1871</span>  <span class="keyword">auto</span> trim_verts = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> verts, <span class="keyword">const</span> <span class="keywordtype">bool</span> move) {</div>
<div class="line"><span class="lineno"> 1872</span>    VertMapMultiIndex verts_map_tmp;</div>
<div class="line"><span class="lineno"> 1873</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> = corners.pair_begin(); <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> != corners.pair_end(); ++<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) {</div>
<div class="line"><span class="lineno"> 1874</span>      <span class="keyword">auto</span> lo = verts_map.get&lt;1&gt;().lower_bound(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>-&gt;first);</div>
<div class="line"><span class="lineno"> 1875</span>      <span class="keyword">auto</span> hi = verts_map.get&lt;1&gt;().upper_bound(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>-&gt;second);</div>
<div class="line"><span class="lineno"> 1876</span>      verts_map_tmp.insert(lo, hi);</div>
<div class="line"><span class="lineno"> 1877</span>    }</div>
<div class="line"><span class="lineno"> 1878</span>    <span class="keywordflow">if</span> (move) {</div>
<div class="line"><span class="lineno"> 1879</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : verts_map_tmp.get&lt;0&gt;())</div>
<div class="line"><span class="lineno"> 1880</span>        add_trim_vert(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.v, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.e);</div>
<div class="line"><span class="lineno"> 1881</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1882</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : verts_map_tmp.get&lt;0&gt;())</div>
<div class="line"><span class="lineno"> 1883</span>        add_no_move_trim(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.v, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.e);</div>
<div class="line"><span class="lineno"> 1884</span>    }</div>
<div class="line"><span class="lineno"> 1885</span>  };</div>
<div class="line"><span class="lineno"> 1886</span> </div>
<div class="line"><span class="lineno"> 1887</span>  <span class="keyword">auto</span> trim_edges = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> ents, <span class="keyword">const</span> <span class="keywordtype">bool</span> move) {</div>
<div class="line"><span class="lineno"> 1888</span>    VertMapMultiIndex verts_map_tmp;</div>
<div class="line"><span class="lineno"> 1889</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> = ents.pair_begin(); <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> != ents.pair_end(); ++<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) {</div>
<div class="line"><span class="lineno"> 1890</span>      <span class="keyword">auto</span> lo = verts_map.get&lt;2&gt;().lower_bound(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>-&gt;first);</div>
<div class="line"><span class="lineno"> 1891</span>      <span class="keyword">auto</span> hi = verts_map.get&lt;2&gt;().upper_bound(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>-&gt;second);</div>
<div class="line"><span class="lineno"> 1892</span>      verts_map_tmp.insert(lo, hi);</div>
<div class="line"><span class="lineno"> 1893</span>      verts_map.get&lt;2&gt;().erase(lo, hi);</div>
<div class="line"><span class="lineno"> 1894</span>    }</div>
<div class="line"><span class="lineno"> 1895</span>    <span class="keywordflow">if</span> (move) {</div>
<div class="line"><span class="lineno"> 1896</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : verts_map_tmp.get&lt;0&gt;())</div>
<div class="line"><span class="lineno"> 1897</span>        add_trim_vert(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.v, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.e);</div>
<div class="line"><span class="lineno"> 1898</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1899</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : verts_map_tmp.get&lt;0&gt;())</div>
<div class="line"><span class="lineno"> 1900</span>        add_no_move_trim(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.v, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.e);</div>
<div class="line"><span class="lineno"> 1901</span>    }</div>
<div class="line"><span class="lineno"> 1902</span>  };</div>
<div class="line"><span class="lineno"> 1903</span> </div>
<div class="line"><span class="lineno"> 1904</span>  <span class="keyword">auto</span> intersect_self = [&amp;](<a class="code hl_class" href="class_range.html">Range</a> &amp;<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a>) { <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = intersect(a, b); };</div>
<div class="line"><span class="lineno"> 1905</span> </div>
<div class="line"><span class="lineno"> 1906</span>  map&lt;std::string, Range&gt; range_maps;</div>
<div class="line"><span class="lineno"> 1907</span> </div>
<div class="line"><span class="lineno"> 1908</span>  <span class="comment">// Edges on surface skin</span></div>
<div class="line"><span class="lineno"> 1909</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>, <span class="keyword">false</span>, range_maps[<span class="stringliteral">&quot;surface_skin&quot;</span>]);</div>
<div class="line"><span class="lineno"> 1910</span>  <span class="comment">// Edges as trimmed</span></div>
<div class="line"><span class="lineno"> 1911</span>  intersect_self(range_maps[<span class="stringliteral">&quot;surface_skin&quot;</span>], <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>);</div>
<div class="line"><span class="lineno"> 1912</span>  <span class="comment">// Edges are on fixed edges</span></div>
<div class="line"><span class="lineno"> 1913</span>  range_maps[<span class="stringliteral">&quot;fixed_edges_on_surface_skin&quot;</span>] =</div>
<div class="line"><span class="lineno"> 1914</span>      intersect(range_maps[<span class="stringliteral">&quot;surface_skin&quot;</span>], fix_edges);</div>
<div class="line"><span class="lineno"> 1915</span> </div>
<div class="line"><span class="lineno"> 1916</span>  <span class="comment">// Edges adjacent to fixed edges</span></div>
<div class="line"><span class="lineno"> 1917</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(fixed_edges_verts, 1, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 1918</span>                              range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges&quot;</span>],</div>
<div class="line"><span class="lineno"> 1919</span>                              moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1920</span>  intersect_self(range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges&quot;</span>], <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>);</div>
<div class="line"><span class="lineno"> 1921</span> </div>
<div class="line"><span class="lineno"> 1922</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(</div>
<div class="line"><span class="lineno"> 1923</span>      range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges&quot;</span>],</div>
<div class="line"><span class="lineno"> 1924</span>      range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges_verts_on_the_skin&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1925</span>  intersect_self(range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges_verts_on_the_skin&quot;</span>],</div>
<div class="line"><span class="lineno"> 1926</span>                 tets_skin_verts);</div>
<div class="line"><span class="lineno"> 1927</span> </div>
<div class="line"><span class="lineno"> 1928</span>  <span class="comment">// Do not move nodes at the corners</span></div>
<div class="line"><span class="lineno"> 1929</span>  trim_verts(corners, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1930</span>  remove_verts(corners);</div>
<div class="line"><span class="lineno"> 1931</span> </div>
<div class="line"><span class="lineno"> 1932</span>  <span class="comment">// Trim edges on the body skin move</span></div>
<div class="line"><span class="lineno"> 1933</span>  trim_edges(range_maps[<span class="stringliteral">&quot;fixed_edges_on_surface_skin&quot;</span>], <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1934</span>  remove_verts(range_maps[<span class="stringliteral">&quot;fixed_edges_on_surface_skin_verts&quot;</span>]);</div>
<div class="line"><span class="lineno"> 1935</span> </div>
<div class="line"><span class="lineno"> 1936</span>  <span class="comment">// Trim edges nodes on the skin but edge not on the skin do not</span></div>
<div class="line"><span class="lineno"> 1937</span>  trim_verts(range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges_verts_on_the_skin&quot;</span>], <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1938</span>  remove_verts(range_maps[<span class="stringliteral">&quot;fixed_edges_verts_edges_verts_on_the_skin&quot;</span>]);</div>
<div class="line"><span class="lineno"> 1939</span> </div>
<div class="line"><span class="lineno"> 1940</span>  <span class="comment">// Trim edges on the cut skin move</span></div>
<div class="line"><span class="lineno"> 1941</span>  trim_edges(range_maps[<span class="stringliteral">&quot;surface_skin&quot;</span>], <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1942</span>  trim_verts(tets_skin_verts, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 1943</span>  remove_verts(tets_skin_verts);</div>
<div class="line"><span class="lineno"> 1944</span> </div>
<div class="line"><span class="lineno"> 1945</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : verts_map.get&lt;0&gt;())</div>
<div class="line"><span class="lineno"> 1946</span>    add_trim_vert(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.v, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.e);</div>
<div class="line"><span class="lineno"> 1947</span> </div>
<div class="line"><span class="lineno"> 1948</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>) {</div>
<div class="line"><span class="lineno"> 1949</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first;</div>
<div class="line"><span class="lineno"> 1950</span>    <a class="code hl_class" href="class_range.html">Range</a> adj;</div>
<div class="line"><span class="lineno"> 1951</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, 1, <span class="keyword">false</span>, adj);</div>
<div class="line"><span class="lineno"> 1952</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : adj) {</div>
<div class="line"><span class="lineno"> 1953</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>.erase(e);</div>
<div class="line"><span class="lineno"> 1954</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>.erase(e);</div>
<div class="line"><span class="lineno"> 1955</span>    }</div>
<div class="line"><span class="lineno"> 1956</span>  }</div>
<div class="line"><span class="lineno"> 1957</span> </div>
<div class="line"><span class="lineno"> 1958</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1959</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.empty())</div>
<div class="line"><span class="lineno"> 1960</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;trim_close_vertices.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>);</div>
<div class="line"><span class="lineno"> 1961</span> </div>
<div class="line"><span class="lineno"> 1962</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1963</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>.empty())</div>
<div class="line"><span class="lineno"> 1964</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;trim_edges.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>);</div>
<div class="line"><span class="lineno"> 1965</span> </div>
<div class="line"><span class="lineno"> 1966</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1967</span>}</div>
<div class="ttc" id="a_basic_fe_tools_8hpp_html_a9af7d9ad959b4605c5f0bab2f104c2fb"><div class="ttname"><a href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a></div><div class="ttdeci">static Index&lt; 'p', 3 &gt; p</div><div class="ttdef"><b>Definition:</b> <a href="_basic_fe_tools_8hpp_source.html#l00090">BasicFeTools.hpp:90</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition:</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespace_electro_physiology_html_a1fe436402a5f686843b69639433d8ce9"><div class="ttname"><a href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">ElectroPhysiology::b</a></div><div class="ttdeci">const double b</div><div class="ttdef"><b>Definition:</b> <a href="_elec_phys_operators_8hpp_source.html#l00030">ElecPhysOperators.hpp:30</a></div></div>
<div class="ttc" id="anamespace_f_tensor_html_a1d0f17584c86640bd9683fe881c5dbe4"><div class="ttname"><a href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">FTensor::d</a></div><div class="ttdeci">const Tensor1_Expr&lt; const dTensor0&lt; T, Dim, i &gt;, typename promote&lt; T, double &gt;::V, Dim, i &gt; d(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition:</b> <a href="d_tensor0_8hpp_source.html#l00027">dTensor0.hpp:27</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a6d261dceb89bbe340a2c40bb7f08e47d"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a6d261dceb89bbe340a2c40bb7f08e47d">MoFEM::Types::VectorDouble12</a></div><div class="ttdeci">VectorBoundedArray&lt; double, 12 &gt; VectorDouble12</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00097">Types.hpp:97</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a00e7da4bd6411bfc49661d00cc331d2b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">MoFEM::CutMeshInterface::trimNewVertices</a></div><div class="ttdeci">Range trimNewVertices</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00553">CutMeshInterface.hpp:553</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a5953d82956ff923572fe91b1d967c0d9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">MoFEM::CutMeshInterface::edgesToTrim</a></div><div class="ttdeci">map&lt; EntityHandle, TreeData &gt; edgesToTrim</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00569">CutMeshInterface.hpp:569</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a5c83ac6cfca374e4658a8c89691c18a2"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">MoFEM::CutMeshInterface::verticesOnTrimEdges</a></div><div class="ttdeci">map&lt; EntityHandle, TreeData &gt; verticesOnTrimEdges</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00570">CutMeshInterface.hpp:570</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a7010ac51af96c46b6038ba966a77012a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">MoFEM::CutMeshInterface::trimEdges</a></div><div class="ttdeci">Range trimEdges</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00555">CutMeshInterface.hpp:555</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ac56d3eb52d6a3acb55eb0eb3866101a4"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac56d3eb52d6a3acb55eb0eb3866101a4">MoFEM::CutMeshInterface::createFrontLevelSets</a></div><div class="ttdeci">MoFEMErrorCode createFrontLevelSets(Range vol, Tag th=nullptr, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">Calculate distance from mesh nodes to surface front.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00609">CutMeshInterface.cpp:609</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_tools_html_a024ac6842bdf8498e9b02f1273e3f1e6"><div class="ttname"><a href="struct_mo_f_e_m_1_1_tools.html#a024ac6842bdf8498e9b02f1273e3f1e6">MoFEM::Tools::minDistanceFromSegments</a></div><div class="ttdeci">static SEGMENT_MIN_DISTANCE minDistanceFromSegments(const double *w_ptr, const double *v_ptr, const double *k_ptr, const double *l_ptr, double *const tvw_ptr=nullptr, double *const tlk_ptr=nullptr)</div><div class="ttdoc">Find points on two segments in closest distance.</div><div class="ttdef"><b>Definition:</b> <a href="_tools_8cpp_source.html#l00436">Tools.cpp:436</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_tools_html_a3f412f42505cc802569c3f0176ac7a00a4b3c787326958839f44154bc244d3793"><div class="ttname"><a href="struct_mo_f_e_m_1_1_tools.html#a3f412f42505cc802569c3f0176ac7a00a4b3c787326958839f44154bc244d3793">MoFEM::Tools::NO_SOLUTION</a></div><div class="ttdeci">@ NO_SOLUTION</div><div class="ttdef"><b>Definition:</b> <a href="_tools_8hpp_source.html#l00513">Tools.hpp:512</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_tools_html_aad9f4194435be50a6c0b32600e7789b4"><div class="ttname"><a href="struct_mo_f_e_m_1_1_tools.html#aad9f4194435be50a6c0b32600e7789b4">MoFEM::Tools::volumeLengthQuality</a></div><div class="ttdeci">static double volumeLengthQuality(const double *coords)</div><div class="ttdoc">Calculate tetrahedron volume length quality.</div><div class="ttdef"><b>Definition:</b> <a href="_tools_8cpp_source.html#l00017">Tools.cpp:17</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a862518bf849fb6ef5b0a954598b61daa" name="a862518bf849fb6ef5b0a954598b61daa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a862518bf849fb6ef5b0a954598b61daa">&#9670;&#160;</a></span>findLevelSetVolumes() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::findLevelSetVolumes </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find level set volumes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">update_front</td><td></td></tr>
    <tr><td class="paramname">verb</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00778">778</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  779</span>                                                                       {</div>
<div class="line"><span class="lineno">  780</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  781</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  782</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac56d3eb52d6a3acb55eb0eb3866101a4">createFrontLevelSets</a>(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, <span class="keyword">nullptr</span>, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  785</span>  Tag th_dist_front_vec;</div>
<div class="line"><span class="lineno">  786</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;DIST_FRONT_VECTOR&quot;</span>, th_dist_front_vec);</div>
<div class="line"><span class="lineno">  787</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">findLevelSetVolumes</a>(th_dist_front_vec, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a>, <span class="keyword">true</span>, verb,</div>
<div class="line"><span class="lineno">  788</span>                             <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;cutFrontEdges.vtk&quot;</span>);</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aff39b406f6369d6ec8eba29bfbd22e1f">createSurfaceLevelSets</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>  Tag th_dist_surface_vec;</div>
<div class="line"><span class="lineno">  793</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;DIST_SURFACE_VECTOR&quot;</span>, th_dist_surface_vec);</div>
<div class="line"><span class="lineno">  794</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a>.clear();</div>
<div class="line"><span class="lineno">  795</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">findLevelSetVolumes</a>(th_dist_surface_vec, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a>, <span class="keyword">true</span>, verb,</div>
<div class="line"><span class="lineno">  796</span>                             <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;cutSurfaceEdges.vtk&quot;</span>);</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  799</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;level_sets.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>);</div>
<div class="line"><span class="lineno">  800</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  801</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;cutSurfaceVolumes.vtk&quot;</span>,</div>
<div class="line"><span class="lineno">  802</span>                                        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a>);</div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  804</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;cutFrontVolumes.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a>);</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  807</span>}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a0dec0dd3ed43e1b5eacc618d4fa72a63"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">MoFEM::CutMeshInterface::findLevelSetVolumes</a></div><div class="ttdeci">MoFEMErrorCode findLevelSetVolumes(Tag th, Range &amp;vol_edges, const bool remove_adj_prims_edges, int verb=QUIET, const bool debug=false, const std::string edges_file_name=string())</div><div class="ttdoc">Find level set volumes.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00662">CutMeshInterface.cpp:662</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aff39b406f6369d6ec8eba29bfbd22e1f"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aff39b406f6369d6ec8eba29bfbd22e1f">MoFEM::CutMeshInterface::createSurfaceLevelSets</a></div><div class="ttdeci">MoFEMErrorCode createSurfaceLevelSets(int verb=QUIET, const bool debug=false)</div><div class="ttdoc">Calculate distance from mesh nodes to cut surface.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00477">CutMeshInterface.cpp:477</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0dec0dd3ed43e1b5eacc618d4fa72a63" name="a0dec0dd3ed43e1b5eacc618d4fa72a63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0dec0dd3ed43e1b5eacc618d4fa72a63">&#9670;&#160;</a></span>findLevelSetVolumes() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::findLevelSetVolumes </td>
          <td>(</td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>vol_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>remove_adj_prims_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>edges_file_name</em> = <code>string()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find level set volumes. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">th</td><td></td></tr>
    <tr><td class="paramname">vol_edges</td><td></td></tr>
    <tr><td class="paramname">remove_adj_prims_edges</td><td></td></tr>
    <tr><td class="paramname">verb</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
    <tr><td class="paramname">edges_file_name</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00662">662</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  664</span>                                                       {</div>
<div class="line"><span class="lineno">  665</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  666</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  667</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>  <span class="keyword">auto</span> get_tag_dim = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>;</div>
<div class="line"><span class="lineno">  671</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_length(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>);</div>
<div class="line"><span class="lineno">  672</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>;</div>
<div class="line"><span class="lineno">  673</span>  };</div>
<div class="line"><span class="lineno">  674</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a> = get_tag_dim(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>  <span class="keyword">auto</span> get_tag_data = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">auto</span> conn) {</div>
<div class="line"><span class="lineno">  677</span>    <span class="keyword">const</span> <span class="keywordtype">void</span> *ptr;</div>
<div class="line"><span class="lineno">  678</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_by_ptr(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;conn, 1, &amp;ptr);</div>
<div class="line"><span class="lineno">  679</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(</div>
<div class="line"><span class="lineno">  680</span>        <span class="keyword">const_cast&lt;</span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(<span class="keyword">static_cast&lt;</span><span class="keyword">const </span><span class="keywordtype">double</span> *<span class="keyword">&gt;</span>(ptr)), 3);</div>
<div class="line"><span class="lineno">  681</span>  };</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>  <span class="keyword">auto</span> get_edge_ray = [&amp;](<span class="keyword">auto</span> conn) {</div>
<div class="line"><span class="lineno">  684</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5086bdfa8de362615048f470022a9898">VectorDouble6</a> coords(6);</div>
<div class="line"><span class="lineno">  685</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, 2, &amp;coords[0]);</div>
<div class="line"><span class="lineno">  686</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> n0 = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[0], 3);</div>
<div class="line"><span class="lineno">  687</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> n1 = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[3], 3);</div>
<div class="line"><span class="lineno">  688</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray = n1 - n0;</div>
<div class="line"><span class="lineno">  689</span>    <span class="keywordflow">return</span> ray;</div>
<div class="line"><span class="lineno">  690</span>  };</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>  <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line"><span class="lineno">  693</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, 1, <span class="keyword">true</span>, edges, moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>  <span class="keyword">auto</span> remove_prisms_edges = [&amp;](<a class="code hl_class" href="class_range.html">Range</a> &amp;edges) {</div>
<div class="line"><span class="lineno">  696</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  697</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms;</div>
<div class="line"><span class="lineno">  698</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(edges, 3, <span class="keyword">false</span>, prisms,</div>
<div class="line"><span class="lineno">  699</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  700</span>    prisms = prisms.subset_by_type(MBPRISM);</div>
<div class="line"><span class="lineno">  701</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms_verts;</div>
<div class="line"><span class="lineno">  702</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(prisms, prisms_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_class" href="class_range.html">Range</a> prism_edges;</div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(prisms_verts, 1, <span class="keyword">false</span>, prism_edges,</div>
<div class="line"><span class="lineno">  705</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  706</span>    edges = subtract(edges, prism_edges);</div>
<div class="line"><span class="lineno">  707</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  708</span>  };</div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordflow">if</span> (remove_adj_prims_edges)</div>
<div class="line"><span class="lineno">  710</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_prisms_edges(edges);</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>  std::vector&lt;EntityHandle&gt; cut_edges;</div>
<div class="line"><span class="lineno">  713</span>  cut_edges.reserve(edges.size());</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>  <span class="keyword">auto</span> get_cut_edges_vec = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">auto</span> &amp;cut_edges, <span class="keyword">auto</span> e, <span class="keyword">auto</span> &amp;&amp;conn) {</div>
<div class="line"><span class="lineno">  716</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>    <span class="keyword">auto</span> ray = get_edge_ray(conn);</div>
<div class="line"><span class="lineno">  719</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> length = norm_2(ray);</div>
<div class="line"><span class="lineno">  720</span>    ray /= length;</div>
<div class="line"><span class="lineno">  721</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dist0 = get_tag_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn[0]);</div>
<div class="line"><span class="lineno">  722</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dist1 = get_tag_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn[1]);</div>
<div class="line"><span class="lineno">  723</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> max_dist = std::max(norm_2(dist0), norm_2(dist1));</div>
<div class="line"><span class="lineno">  724</span>    <span class="keywordflow">if</span> (max_dist &lt; length) {</div>
<div class="line"><span class="lineno">  725</span>      cut_edges.push_back(e);</div>
<div class="line"><span class="lineno">  726</span>    }</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  729</span>  };</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>  <span class="keyword">auto</span> get_cut_edges_signed_dist = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">auto</span> &amp;cut_edges, <span class="keyword">auto</span> e,</div>
<div class="line"><span class="lineno">  732</span>                                       <span class="keyword">auto</span> &amp;&amp;conn) {</div>
<div class="line"><span class="lineno">  733</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  734</span>    <span class="keyword">auto</span> get_tag_signed_dist = [&amp;](<span class="keyword">auto</span> conn) {</div>
<div class="line"><span class="lineno">  735</span>      <span class="keywordtype">double</span> dist;</div>
<div class="line"><span class="lineno">  736</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;conn, 1, &amp;dist);</div>
<div class="line"><span class="lineno">  737</span>      <span class="keywordflow">return</span> dist;</div>
<div class="line"><span class="lineno">  738</span>    };</div>
<div class="line"><span class="lineno">  739</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dist0 = get_tag_signed_dist(conn[0]);</div>
<div class="line"><span class="lineno">  740</span>    <span class="keyword">const</span> <span class="keyword">auto</span> dist1 = get_tag_signed_dist(conn[1]);</div>
<div class="line"><span class="lineno">  741</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> opposite = dist0 * dist1;</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">if</span> (opposite &lt;= 0)</div>
<div class="line"><span class="lineno">  743</span>      cut_edges.push_back(e);</div>
<div class="line"><span class="lineno">  744</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  745</span>  };</div>
<div class="line"><span class="lineno">  746</span> </div>
<div class="line"><span class="lineno">  747</span>  <span class="keyword">auto</span> get_conn = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line"><span class="lineno">  748</span>    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno">  749</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno">  750</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(e, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordflow">return</span> conn;</div>
<div class="line"><span class="lineno">  752</span>  };</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a> == 3)</div>
<div class="line"><span class="lineno">  755</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : edges)</div>
<div class="line"><span class="lineno">  756</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_cut_edges_vec(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, cut_edges, e, get_conn(e));</div>
<div class="line"><span class="lineno">  757</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  758</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : edges)</div>
<div class="line"><span class="lineno">  759</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_cut_edges_signed_dist(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, cut_edges, e, get_conn(e));</div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;*cut_edges.begin(), cut_edges.size(), 3, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  762</span>                              vol_edges, moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  763</span>  vol_edges = intersect(vol_edges, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>);</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>  <span class="keyword">auto</span> convert_to_ranger = [](<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno">  766</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"><span class="lineno">  767</span>    <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.insert_list(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.begin(), <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.end());</div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"><span class="lineno">  769</span>  };</div>
<div class="line"><span class="lineno">  770</span> </div>
<div class="line"><span class="lineno">  771</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> &amp;&amp; !edges_file_name.empty())</div>
<div class="line"><span class="lineno">  772</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(edges_file_name,</div>
<div class="line"><span class="lineno">  773</span>                                        convert_to_ranger(cut_edges));</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  776</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a16fc82b8953ea94723738e8435256773" name="a16fc82b8953ea94723738e8435256773"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16fc82b8953ea94723738e8435256773">&#9670;&#160;</a></span>getCutEdges()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getCutEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00469">469</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a39ab0984dafe0104140987a4b5d9646e" name="a39ab0984dafe0104140987a4b5d9646e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39ab0984dafe0104140987a4b5d9646e">&#9670;&#160;</a></span>getCutFrontVolumes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getCutFrontVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00486">486</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  486</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afadc1f7c3c7fedf55fbdca253c5a0059" name="afadc1f7c3c7fedf55fbdca253c5a0059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afadc1f7c3c7fedf55fbdca253c5a0059">&#9670;&#160;</a></span>getCutSurfaceVolumes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getCutSurfaceVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00485">485</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  485</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14b57638017e2cde6ccc6f6e51118847" name="a14b57638017e2cde6ccc6f6e51118847"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14b57638017e2cde6ccc6f6e51118847">&#9670;&#160;</a></span>getFront()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getFront </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00467">467</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  467</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a452afd78f72fd0d9bde8985f5417d47d" name="a452afd78f72fd0d9bde8985f5417d47d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a452afd78f72fd0d9bde8985f5417d47d">&#9670;&#160;</a></span>getMergedSurfaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getMergedSurfaces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a48">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00483">483</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  483</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa54c4ce1e4f1249778ebb15e7e4d12ae">mergedSurfaces</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac5428afbb9ed89dae0b388cabb7b60bf" name="ac5428afbb9ed89dae0b388cabb7b60bf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5428afbb9ed89dae0b388cabb7b60bf">&#9670;&#160;</a></span>getMergedVolumes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getMergedVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00482">482</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  482</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0662298092c0532e60151baa5040aadb">mergedVolumes</a>; }</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a0662298092c0532e60151baa5040aadb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0662298092c0532e60151baa5040aadb">MoFEM::CutMeshInterface::mergedVolumes</a></div><div class="ttdeci">Range mergedVolumes</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00557">CutMeshInterface.hpp:557</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0a6a15cfde565436c98499720706581b" name="a0a6a15cfde565436c98499720706581b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a6a15cfde565436c98499720706581b">&#9670;&#160;</a></span>getNewCutSurfaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getNewCutSurfaces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00471">471</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  471</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae871fdb1e0d11cc7a4430c3f47b8a984" name="ae871fdb1e0d11cc7a4430c3f47b8a984"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae871fdb1e0d11cc7a4430c3f47b8a984">&#9670;&#160;</a></span>getNewCutVertices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getNewCutVertices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00472">472</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  472</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a75bdd40b1e7208d4c435acee21562669">cutNewVertices</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2ccebabdfabe035f6e9bd2bd970764de" name="a2ccebabdfabe035f6e9bd2bd970764de"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2ccebabdfabe035f6e9bd2bd970764de">&#9670;&#160;</a></span>getNewCutVolumes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getNewCutVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00470">470</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  470</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac2227475101c2c0200d0894e766501dc" name="ac2227475101c2c0200d0894e766501dc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac2227475101c2c0200d0894e766501dc">&#9670;&#160;</a></span>getNewTrimSurfaces()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getNewTrimSurfaces </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00479">479</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  479</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>; }</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a0b99aef4cb232c84d46a919494477220"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">MoFEM::CutMeshInterface::trimNewSurfaces</a></div><div class="ttdeci">Range trimNewSurfaces</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00554">CutMeshInterface.hpp:554</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9d2a60dae20404dce9fab06a13da8800" name="a9d2a60dae20404dce9fab06a13da8800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d2a60dae20404dce9fab06a13da8800">&#9670;&#160;</a></span>getNewTrimVertices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getNewTrimVertices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00480">480</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  480</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a512bddef655fd7788f6f6b94ca727a2f" name="a512bddef655fd7788f6f6b94ca727a2f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a512bddef655fd7788f6f6b94ca727a2f">&#9670;&#160;</a></span>getNewTrimVolumes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getNewTrimVolumes </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00478">478</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  478</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">trimNewVolumes</a>; }</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a8d5acd0e2fc2974e7c44aed8794cc5f3"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">MoFEM::CutMeshInterface::trimNewVolumes</a></div><div class="ttdeci">Range trimNewVolumes</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00552">CutMeshInterface.hpp:552</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a231a535aa3167765ae2ec32b336ecec0" name="a231a535aa3167765ae2ec32b336ecec0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a231a535aa3167765ae2ec32b336ecec0">&#9670;&#160;</a></span>getOptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::getOptions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Get options from command line. </p>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00037">37</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>                              {</div>
<div class="line"><span class="lineno">   38</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">   39</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;cut_&quot;</span>, <span class="stringliteral">&quot;MOFEM Cut mesh options&quot;</span>,</div>
<div class="line"><span class="lineno">   40</span>                             <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-linesearch_steps&quot;</span>,</div>
<div class="line"><span class="lineno">   43</span>                           <span class="stringliteral">&quot;number of bisection steps which line search do to &quot;</span></div>
<div class="line"><span class="lineno">   44</span>                           <span class="stringliteral">&quot;find optimal merged nodes position&quot;</span>,</div>
<div class="line"><span class="lineno">   45</span>                           <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4f4d5194089ca2d3fbbc483eeb75c817">lineSearchSteps</a>, &amp;<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4f4d5194089ca2d3fbbc483eeb75c817">lineSearchSteps</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-max_merging_cycles&quot;</span>,</div>
<div class="line"><span class="lineno">   48</span>                           <span class="stringliteral">&quot;number of maximal merging cycles&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">   49</span>                           <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa4a886cef884b12a6fc193fb98cace45">nbMaxMergingCycles</a>, &amp;<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa4a886cef884b12a6fc193fb98cace45">nbMaxMergingCycles</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-project_entities_quality_trashold&quot;</span>,</div>
<div class="line"><span class="lineno">   52</span>                              <span class="stringliteral">&quot;project entities quality trashold&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">   53</span>                              <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">projectEntitiesQualityTrashold</a>,</div>
<div class="line"><span class="lineno">   54</span>                              &amp;<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">projectEntitiesQualityTrashold</a>, PETSC_NULL);</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line"><span class="lineno">   57</span>    <a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">   59</span>  }</div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00483">definitions.h:483</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a861eb86f596bb825d82d8ac61915f4c1" name="a861eb86f596bb825d82d8ac61915f4c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a861eb86f596bb825d82d8ac61915f4c1">&#9670;&#160;</a></span>getSubInterfaceOptions()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::getSubInterfaceOptions </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00031">31</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   31</span>{ <span class="keywordflow">return</span> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a231a535aa3167765ae2ec32b336ecec0">getOptions</a>(); }</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a231a535aa3167765ae2ec32b336ecec0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a231a535aa3167765ae2ec32b336ecec0">MoFEM::CutMeshInterface::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div><div class="ttdoc">Get options from command line.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00037">CutMeshInterface.hpp:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa1bbbb1d723e99d6503ffbb8f4caccfc" name="aa1bbbb1d723e99d6503ffbb8f4caccfc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa1bbbb1d723e99d6503ffbb8f4caccfc">&#9670;&#160;</a></span>getSurface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getSurface </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a44">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00466">466</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  466</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8db4a9870d5e4966f06a5afe3cae2f6b" name="a8db4a9870d5e4966f06a5afe3cae2f6b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8db4a9870d5e4966f06a5afe3cae2f6b">&#9670;&#160;</a></span>getTreeSurfPtr()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt; OrientedBoxTreeTool &gt; &amp; MoFEM::CutMeshInterface::getTreeSurfPtr </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00492">492</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  492</span>                                                                {</div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>;</div>
<div class="line"><span class="lineno">  494</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a291388e19eabafaf973858c7fe4b3a77" name="a291388e19eabafaf973858c7fe4b3a77"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a291388e19eabafaf973858c7fe4b3a77">&#9670;&#160;</a></span>getTrimEdges()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getTrimEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00477">477</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  477</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a27883f29003acbc5b5f3c6d155887e12" name="a27883f29003acbc5b5f3c6d155887e12"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27883f29003acbc5b5f3c6d155887e12">&#9670;&#160;</a></span>getVolume()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::getVolume </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00465">465</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  465</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>; }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad76d17c62d4f9337953222d2092697ab" name="ad76d17c62d4f9337953222d2092697ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad76d17c62d4f9337953222d2092697ab">&#9670;&#160;</a></span>makeFront()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::makeFront </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Create front from the surface. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a32">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00450">450</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  450</span>                                                           {</div>
<div class="line"><span class="lineno">  451</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  452</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  453</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  454</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno">  455</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line"><span class="lineno">  456</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, <span class="keyword">false</span>, tets_skin);</div>
<div class="line"><span class="lineno">  457</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin_edges;</div>
<div class="line"><span class="lineno">  458</span>  ErrorCode tmp_result;</div>
<div class="line"><span class="lineno">  459</span>  tmp_result = moab.get_adjacencies(tets_skin, 1, <span class="keyword">false</span>, tets_skin_edges,</div>
<div class="line"><span class="lineno">  460</span>                                    moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>  <span class="keywordflow">if</span> (MB_SUCCESS != tmp_result)</div>
<div class="line"><span class="lineno">  463</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno">  464</span>            <span class="stringliteral">&quot;Duplicated edges: most likely the source of error is comming from &quot;</span></div>
<div class="line"><span class="lineno">  465</span>            <span class="stringliteral">&quot;adding the vertices of the cracking &quot;</span></div>
<div class="line"><span class="lineno">  466</span>            <span class="stringliteral">&quot;volume to a BLOCKSET rather than NODESET (corresponding to the &quot;</span></div>
<div class="line"><span class="lineno">  467</span>            <span class="stringliteral">&quot;input parameter-vertex_block_set)&quot;</span>);</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>  <a class="code hl_class" href="class_range.html">Range</a> surface_skin;</div>
<div class="line"><span class="lineno">  470</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><span class="lineno">  471</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a> = subtract(surface_skin, tets_skin_edges);</div>
<div class="line"><span class="lineno">  472</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  473</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;front.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>);</div>
<div class="line"><span class="lineno">  474</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  475</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1502b74546b99e2f0b968333a7748400" name="a1502b74546b99e2f0b968333a7748400"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1502b74546b99e2f0b968333a7748400">&#9670;&#160;</a></span>mergeBadEdges() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::mergeBadEdges </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>fraction_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>cut_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>trim_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>surface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>corner_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>update_meshsets</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merge edges. </p>
<p >Sort all edges, where sorting is by quality calculated as edge length times quality of tets adjacent to the edge. Edge is merged if quality if the mesh is improved. </p>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l03062">3062</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3066</span>                                                  {</div>
<div class="line"><span class="lineno"> 3067</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 3068</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 3069</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_level;</div>
<div class="line"><span class="lineno"> 3070</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 3071</span>      trim_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets_level);</div>
<div class="line"><span class="lineno"> 3072</span> </div>
<div class="line"><span class="lineno"> 3073</span>  <a class="code hl_class" href="class_range.html">Range</a> edges_to_merge;</div>
<div class="line"><span class="lineno"> 3074</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByRefLevel(</div>
<div class="line"><span class="lineno"> 3075</span>      trim_bit, cut_bit | trim_bit, edges_to_merge);</div>
<div class="line"><span class="lineno"> 3076</span> </div>
<div class="line"><span class="lineno"> 3077</span>  <span class="comment">// get all entities not in database</span></div>
<div class="line"><span class="lineno"> 3078</span>  <a class="code hl_class" href="class_range.html">Range</a> all_ents_not_in_database_before;</div>
<div class="line"><span class="lineno"> 3079</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;getAllEntitiesNotInDatabase(</div>
<div class="line"><span class="lineno"> 3080</span>      all_ents_not_in_database_before);</div>
<div class="line"><span class="lineno"> 3081</span> </div>
<div class="line"><span class="lineno"> 3082</span>  edges_to_merge = edges_to_merge.subset_by_type(MBEDGE);</div>
<div class="line"><span class="lineno"> 3083</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 3084</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;edges_to_merge.vtk&quot;</span>, edges_to_merge);</div>
<div class="line"><span class="lineno"> 3085</span> </div>
<div class="line"><span class="lineno"> 3086</span>  <a class="code hl_class" href="class_range.html">Range</a> out_new_tets, out_new_surf;</div>
<div class="line"><span class="lineno"> 3087</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a77c2ce9c07b85d08e79672d0b025e33c">mergeBadEdges</a>(fraction_level, tets_level, <a class="code hl_namespace" href="namespacesurface.html">surface</a>, fixed_edges,</div>
<div class="line"><span class="lineno"> 3088</span>                       corner_nodes, edges_to_merge, out_new_tets, out_new_surf,</div>
<div class="line"><span class="lineno"> 3089</span>                       <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, update_meshsets, &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno"> 3090</span> </div>
<div class="line"><span class="lineno"> 3091</span>  <span class="comment">// get all entities not in database after merge</span></div>
<div class="line"><span class="lineno"> 3092</span>  <a class="code hl_class" href="class_range.html">Range</a> all_ents_not_in_database_after;</div>
<div class="line"><span class="lineno"> 3093</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;getAllEntitiesNotInDatabase(</div>
<div class="line"><span class="lineno"> 3094</span>      all_ents_not_in_database_after);</div>
<div class="line"><span class="lineno"> 3095</span> </div>
<div class="line"><span class="lineno"> 3096</span>  <span class="comment">// delete hanging entities</span></div>
<div class="line"><span class="lineno"> 3097</span>  all_ents_not_in_database_after =</div>
<div class="line"><span class="lineno"> 3098</span>      subtract(all_ents_not_in_database_after, all_ents_not_in_database_before);</div>
<div class="line"><span class="lineno"> 3099</span>  <a class="code hl_class" href="class_range.html">Range</a> meshsets;</div>
<div class="line"><span class="lineno"> 3100</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_entities_by_type(0, MBENTITYSET, meshsets,</div>
<div class="line"><span class="lineno"> 3101</span>                                                 <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 3102</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : meshsets)</div>
<div class="line"><span class="lineno"> 3103</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().remove_entities(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>,</div>
<div class="line"><span class="lineno"> 3104</span>                                              all_ents_not_in_database_after);</div>
<div class="line"><span class="lineno"> 3105</span> </div>
<div class="line"><span class="lineno"> 3106</span>  m_field.get_moab().delete_entities(all_ents_not_in_database_after);</div>
<div class="line"><span class="lineno"> 3107</span> </div>
<div class="line"><span class="lineno"> 3108</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0662298092c0532e60151baa5040aadb">mergedVolumes</a>.swap(out_new_tets);</div>
<div class="line"><span class="lineno"> 3109</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa54c4ce1e4f1249778ebb15e7e4d12ae">mergedSurfaces</a>.swap(out_new_surf);</div>
<div class="line"><span class="lineno"> 3110</span> </div>
<div class="line"><span class="lineno"> 3111</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3112</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a77c2ce9c07b85d08e79672d0b025e33c" name="a77c2ce9c07b85d08e79672d0b025e33c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77c2ce9c07b85d08e79672d0b025e33c">&#9670;&#160;</a></span>mergeBadEdges() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::mergeBadEdges </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>fraction_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>tets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>surface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>corner_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>merged_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>out_tets</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>new_surf</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>update_meshsets</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> *&#160;</td>
          <td class="paramname"><em>bit_ptr</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Merge edges. </p>
<p >Sort all edges, where sorting is by quality calculated as edge length times quality of tets adjacent to the edge. Edge is merged if quality if the mesh is improved.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fraction_level</td><td>Fraction of edges attemt to be merged at iteration </td></tr>
    <tr><td class="paramname">tets</td><td>Tets of the mesh which edges are merged </td></tr>
    <tr><td class="paramname">surface</td><td>Surface created by edge spliting </td></tr>
    <tr><td class="paramname">fixed_edges</td><td>edges which are geometrical corners of the body </td></tr>
    <tr><td class="paramname">corner_nodes</td><td>vertices on the corners </td></tr>
    <tr><td class="paramname">merged_nodes</td><td>merged nodes </td></tr>
    <tr><td class="paramname">out_tets</td><td>returned test after merge </td></tr>
    <tr><td class="paramname">new_surf</td><td>new surface without merged edges </td></tr>
    <tr><td class="paramname">th</td><td>tag with nodal positons </td></tr>
    <tr><td class="paramname">bit_ptr</td><td>set bit ref level to mesh without merged edges </td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>
<p >Merge nodes</p>
<p >Calculate edge length</p>
<p >&lt; Controls importance of length when ranking edges for merge</p>
<p >&lt; Controls importance of quality when ranking edges for merge</p>
<p >&lt; Do not merge quality if quality above accepted thrashold</p>
<p >Topological relations</p>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l02302">2302</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2306</span>                                                  {</div>
<div class="line"><span class="lineno"> 2307</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 2308</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 2309</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2310</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2311</span><span class="comment">  /**</span></div>
<div class="line"><span class="lineno"> 2312</span><span class="comment">   * \brief Merge nodes</span></div>
<div class="line"><span class="lineno"> 2313</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno"> 2314</span>  <span class="keyword">struct </span>MergeNodes {</div>
<div class="line"><span class="lineno"> 2315</span>    CoreInterface &amp;mField;</div>
<div class="line"><span class="lineno"> 2316</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> onlyIfImproveQuality;</div>
<div class="line"><span class="lineno"> 2317</span>    Tag tH;</div>
<div class="line"><span class="lineno"> 2318</span>    <span class="keywordtype">bool</span> updateMehsets;</div>
<div class="line"><span class="lineno"> 2319</span> </div>
<div class="line"><span class="lineno"> 2320</span>    MergeNodes(CoreInterface &amp;m_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> only_if_improve_quality,</div>
<div class="line"><span class="lineno"> 2321</span>               Tag th, <span class="keywordtype">bool</span> update_mehsets)</div>
<div class="line"><span class="lineno"> 2322</span>        : mField(m_field), onlyIfImproveQuality(only_if_improve_quality),</div>
<div class="line"><span class="lineno"> 2323</span>          tH(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>), updateMehsets(update_mehsets) {</div>
<div class="line"><span class="lineno"> 2324</span>      mField.getInterface(nodeMergerPtr);</div>
<div class="line"><span class="lineno"> 2325</span>    }</div>
<div class="line"><span class="lineno"> 2326</span>    NodeMergerInterface *nodeMergerPtr;</div>
<div class="line"><span class="lineno"> 2327</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> mergeNodes(<span class="keywordtype">int</span> line_search, <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> father,</div>
<div class="line"><span class="lineno"> 2328</span>                              <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> mother, <a class="code hl_class" href="class_range.html">Range</a> &amp;proc_tets,</div>
<div class="line"><span class="lineno"> 2329</span>                              <span class="keywordtype">bool</span> add_child = <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2330</span>      moab::Interface &amp;moab = mField.get_moab();</div>
<div class="line"><span class="lineno"> 2331</span>      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2332</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> conn[] = {father, mother};</div>
<div class="line"><span class="lineno"> 2333</span>      <a class="code hl_class" href="class_range.html">Range</a> vert_tets;</div>
<div class="line"><span class="lineno"> 2334</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(conn, 2, 3, <span class="keyword">false</span>, vert_tets,</div>
<div class="line"><span class="lineno"> 2335</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2336</span>      vert_tets = intersect(vert_tets, proc_tets);</div>
<div class="line"><span class="lineno"> 2337</span>      <a class="code hl_class" href="class_range.html">Range</a> out_tets;</div>
<div class="line"><span class="lineno"> 2338</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> nodeMergerPtr-&gt;mergeNodes(father, mother, out_tets, &amp;vert_tets,</div>
<div class="line"><span class="lineno"> 2339</span>                                       onlyIfImproveQuality, 0, line_search,</div>
<div class="line"><span class="lineno"> 2340</span>                                       tH);</div>
<div class="line"><span class="lineno"> 2341</span> </div>
<div class="line"><span class="lineno"> 2342</span>      <span class="keywordflow">if</span> (add_child &amp;&amp; nodeMergerPtr-&gt;getSuccessMerge()) {</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span>        Range::iterator lo, hi = proc_tets.begin();</div>
<div class="line"><span class="lineno"> 2345</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> pt = vert_tets.pair_begin(); pt != vert_tets.pair_end();</div>
<div class="line"><span class="lineno"> 2346</span>             ++pt) {</div>
<div class="line"><span class="lineno"> 2347</span>          lo = proc_tets.lower_bound(hi, proc_tets.end(), pt-&gt;first);</div>
<div class="line"><span class="lineno"> 2348</span>          <span class="keywordflow">if</span> (lo != proc_tets.end()) {</div>
<div class="line"><span class="lineno"> 2349</span>            hi = proc_tets.upper_bound(lo, proc_tets.end(), pt-&gt;second);</div>
<div class="line"><span class="lineno"> 2350</span>            proc_tets.erase(lo, hi);</div>
<div class="line"><span class="lineno"> 2351</span>          } <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2352</span>            <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 2353</span>        }</div>
<div class="line"><span class="lineno"> 2354</span>        proc_tets.merge(out_tets);</div>
<div class="line"><span class="lineno"> 2355</span> </div>
<div class="line"><span class="lineno"> 2356</span>        <span class="keyword">auto</span> &amp;parent_child_map = nodeMergerPtr-&gt;getParentChildMap();</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>        <span class="keyword">struct </span>ChangeChild {</div>
<div class="line"><span class="lineno"> 2359</span>          <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> child;</div>
<div class="line"><span class="lineno"> 2360</span>          ChangeChild(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> child) : child(child) {}</div>
<div class="line"><span class="lineno"> 2361</span>          <span class="keywordtype">void</span> operator()(NodeMergerInterface::ParentChild &amp;<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) {</div>
<div class="line"><span class="lineno"> 2362</span>            <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.cHild = child;</div>
<div class="line"><span class="lineno"> 2363</span>          }</div>
<div class="line"><span class="lineno"> 2364</span>        };</div>
<div class="line"><span class="lineno"> 2365</span> </div>
<div class="line"><span class="lineno"> 2366</span>        std::vector&lt;<span class="keyword">decltype</span>(parentsChildMap.get&lt;0&gt;().begin())&gt; it_vec;</div>
<div class="line"><span class="lineno"> 2367</span>        it_vec.reserve(parentsChildMap.size());</div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> : parent_child_map) {</div>
<div class="line"><span class="lineno"> 2370</span> </div>
<div class="line"><span class="lineno"> 2371</span>          it_vec.clear();</div>
<div class="line"><span class="lineno"> 2372</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = parentsChildMap.get&lt;0&gt;().equal_range(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.pArent);</div>
<div class="line"><span class="lineno"> 2373</span>               it.first != it.second; ++it.first)</div>
<div class="line"><span class="lineno"> 2374</span>            it_vec.emplace_back(it.first);</div>
<div class="line"><span class="lineno"> 2375</span> </div>
<div class="line"><span class="lineno"> 2376</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = parentsChildMap.get&lt;1&gt;().equal_range(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.pArent);</div>
<div class="line"><span class="lineno"> 2377</span>               it.first != it.second; ++it.first)</div>
<div class="line"><span class="lineno"> 2378</span>            it_vec.emplace_back(parentsChildMap.project&lt;0&gt;(it.first));</div>
<div class="line"><span class="lineno"> 2379</span> </div>
<div class="line"><span class="lineno"> 2380</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;it : it_vec)</div>
<div class="line"><span class="lineno"> 2381</span>            parentsChildMap.modify(it, ChangeChild(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.cHild));</div>
<div class="line"><span class="lineno"> 2382</span>        }</div>
<div class="line"><span class="lineno"> 2383</span> </div>
<div class="line"><span class="lineno"> 2384</span>        parentsChildMap.insert(parent_child_map.begin(),</div>
<div class="line"><span class="lineno"> 2385</span>                               parent_child_map.end());</div>
<div class="line"><span class="lineno"> 2386</span>      }</div>
<div class="line"><span class="lineno"> 2387</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2388</span>    }</div>
<div class="line"><span class="lineno"> 2389</span> </div>
<div class="line"><span class="lineno"> 2390</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> updateRangeByChilds(<a class="code hl_class" href="class_range.html">Range</a> &amp;new_surf, <a class="code hl_class" href="class_range.html">Range</a> &amp;edges_to_merge,</div>
<div class="line"><span class="lineno"> 2391</span>                                       <a class="code hl_class" href="class_range.html">Range</a> &amp;not_merged_edges,</div>
<div class="line"><span class="lineno"> 2392</span>                                       <span class="keywordtype">bool</span> add_child) {</div>
<div class="line"><span class="lineno"> 2393</span>      moab::Interface &amp;moab = mField.get_moab();</div>
<div class="line"><span class="lineno"> 2394</span>      <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2395</span>      <span class="keywordflow">if</span> (add_child) {</div>
<div class="line"><span class="lineno"> 2396</span> </div>
<div class="line"><span class="lineno"> 2397</span>        std::vector&lt;EntityHandle&gt; parents_ents_vec(parentsChildMap.size());</div>
<div class="line"><span class="lineno"> 2398</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;it : parentsChildMap)</div>
<div class="line"><span class="lineno"> 2399</span>          parents_ents_vec.emplace_back(it.pArent);</div>
<div class="line"><span class="lineno"> 2400</span>        <a class="code hl_class" href="class_range.html">Range</a> parent_ents;</div>
<div class="line"><span class="lineno"> 2401</span>        parent_ents.insert_list(parents_ents_vec.begin(),</div>
<div class="line"><span class="lineno"> 2402</span>                                parents_ents_vec.end());</div>
<div class="line"><span class="lineno"> 2403</span> </div>
<div class="line"><span class="lineno"> 2404</span>        <a class="code hl_class" href="class_range.html">Range</a> surf_parent_ents = intersect(new_surf, parent_ents);</div>
<div class="line"><span class="lineno"> 2405</span>        new_surf = subtract(new_surf, surf_parent_ents);</div>
<div class="line"><span class="lineno"> 2406</span>        <a class="code hl_class" href="class_range.html">Range</a> child_surf_ents;</div>
<div class="line"><span class="lineno"> 2407</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> updateRangeByChilds(parentsChildMap, surf_parent_ents,</div>
<div class="line"><span class="lineno"> 2408</span>                                   child_surf_ents);</div>
<div class="line"><span class="lineno"> 2409</span>        new_surf.merge(child_surf_ents);</div>
<div class="line"><span class="lineno"> 2410</span> </div>
<div class="line"><span class="lineno"> 2411</span>        <a class="code hl_class" href="class_range.html">Range</a> edges_to_merge_parent_ents =</div>
<div class="line"><span class="lineno"> 2412</span>            intersect(edges_to_merge, parent_ents);</div>
<div class="line"><span class="lineno"> 2413</span>        edges_to_merge = subtract(edges_to_merge, edges_to_merge_parent_ents);</div>
<div class="line"><span class="lineno"> 2414</span>        <a class="code hl_class" href="class_range.html">Range</a> merged_child_edge_ents;</div>
<div class="line"><span class="lineno"> 2415</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> updateRangeByChilds(parentsChildMap, edges_to_merge_parent_ents,</div>
<div class="line"><span class="lineno"> 2416</span>                                   merged_child_edge_ents);</div>
<div class="line"><span class="lineno"> 2417</span> </div>
<div class="line"><span class="lineno"> 2418</span>        <a class="code hl_class" href="class_range.html">Range</a> not_merged_edges_child_ents =</div>
<div class="line"><span class="lineno"> 2419</span>            intersect(not_merged_edges, parent_ents);</div>
<div class="line"><span class="lineno"> 2420</span>        not_merged_edges =</div>
<div class="line"><span class="lineno"> 2421</span>            subtract(not_merged_edges, not_merged_edges_child_ents);</div>
<div class="line"><span class="lineno"> 2422</span>        <a class="code hl_class" href="class_range.html">Range</a> not_merged_child_edge_ents;</div>
<div class="line"><span class="lineno"> 2423</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> updateRangeByChilds(parentsChildMap, not_merged_edges_child_ents,</div>
<div class="line"><span class="lineno"> 2424</span>                                   not_merged_child_edge_ents);</div>
<div class="line"><span class="lineno"> 2425</span> </div>
<div class="line"><span class="lineno"> 2426</span>        merged_child_edge_ents =</div>
<div class="line"><span class="lineno"> 2427</span>            subtract(merged_child_edge_ents, not_merged_child_edge_ents);</div>
<div class="line"><span class="lineno"> 2428</span>        edges_to_merge.merge(merged_child_edge_ents);</div>
<div class="line"><span class="lineno"> 2429</span>        not_merged_edges.merge(not_merged_child_edge_ents);</div>
<div class="line"><span class="lineno"> 2430</span> </div>
<div class="line"><span class="lineno"> 2431</span>        <span class="keywordflow">if</span> (updateMehsets) {</div>
<div class="line"><span class="lineno"> 2432</span>          <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(</div>
<div class="line"><span class="lineno"> 2433</span>                   (*mField.getInterface&lt;MeshsetsManager&gt;()), cubit_it)) {</div>
<div class="line"><span class="lineno"> 2434</span>            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> cubit_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><span class="lineno"> 2435</span>            <a class="code hl_class" href="class_range.html">Range</a> meshset_ents;</div>
<div class="line"><span class="lineno"> 2436</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_handle(cubit_meshset, meshset_ents,</div>
<div class="line"><span class="lineno"> 2437</span>                                               <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2438</span>            <a class="code hl_class" href="class_range.html">Range</a> child_ents;</div>
<div class="line"><span class="lineno"> 2439</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> updateRangeByChilds(parentsChildMap, meshset_ents,</div>
<div class="line"><span class="lineno"> 2440</span>                                       child_ents);</div>
<div class="line"><span class="lineno"> 2441</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(cubit_meshset, child_ents);</div>
<div class="line"><span class="lineno"> 2442</span>          }</div>
<div class="line"><span class="lineno"> 2443</span>        }</div>
<div class="line"><span class="lineno"> 2444</span>      }</div>
<div class="line"><span class="lineno"> 2445</span> </div>
<div class="line"><span class="lineno"> 2446</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2447</span>    };</div>
<div class="line"><span class="lineno"> 2448</span> </div>
<div class="line"><span class="lineno"> 2449</span>  <span class="keyword">private</span>:</div>
<div class="line"><span class="lineno"> 2450</span>    NodeMergerInterface::ParentChildMap parentsChildMap;</div>
<div class="line"><span class="lineno"> 2451</span>    std::vector&lt;EntityHandle&gt; childsVec;</div>
<div class="line"><span class="lineno"> 2452</span> </div>
<div class="line"><span class="lineno"> 2453</span>    <span class="keyword">inline</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> updateRangeByChilds(</div>
<div class="line"><span class="lineno"> 2454</span>        <span class="keyword">const</span> NodeMergerInterface::ParentChildMap &amp;parent_child_map,</div>
<div class="line"><span class="lineno"> 2455</span>        <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;parents, <a class="code hl_class" href="class_range.html">Range</a> &amp;childs) {</div>
<div class="line"><span class="lineno"> 2456</span>      <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno"> 2457</span>      childsVec.clear();</div>
<div class="line"><span class="lineno"> 2458</span>      childsVec.reserve(parents.size());</div>
<div class="line"><span class="lineno"> 2459</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> pit = parents.pair_begin(); pit != parents.pair_end(); pit++) {</div>
<div class="line"><span class="lineno"> 2460</span>        <span class="keyword">auto</span> it = parent_child_map.lower_bound(pit-&gt;first);</div>
<div class="line"><span class="lineno"> 2461</span>        <span class="keywordflow">if</span> (it != parent_child_map.end()) {</div>
<div class="line"><span class="lineno"> 2462</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> hi_it = parent_child_map.upper_bound(pit-&gt;second);</div>
<div class="line"><span class="lineno"> 2463</span>               it != hi_it; ++it)</div>
<div class="line"><span class="lineno"> 2464</span>            childsVec.emplace_back(it-&gt;cHild);</div>
<div class="line"><span class="lineno"> 2465</span>        }</div>
<div class="line"><span class="lineno"> 2466</span>      }</div>
<div class="line"><span class="lineno"> 2467</span>      childs.insert_list(childsVec.begin(), childsVec.end());</div>
<div class="line"><span class="lineno"> 2468</span>      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno"> 2469</span>    }</div>
<div class="line"><span class="lineno"> 2470</span>  };</div>
<div class="line"><span class="lineno"> 2471</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2472</span><span class="comment">  /**</span></div>
<div class="line"><span class="lineno"> 2473</span><span class="comment">   * \brief Calculate edge length</span></div>
<div class="line"><span class="lineno"> 2474</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno"> 2475</span>  <span class="keyword">struct </span>LengthMap {</div>
<div class="line"><span class="lineno"> 2476</span>    Tag tH;</div>
<div class="line"><span class="lineno"> 2477</span>    CoreInterface &amp;mField;</div>
<div class="line"><span class="lineno"> 2478</span>    moab::Interface &amp;moab;</div>
<div class="line"><span class="lineno"> 2479</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> maxLength;</div>
<div class="line"><span class="lineno"> 2480</span>    LengthMap(CoreInterface &amp;m_field, Tag th, <span class="keywordtype">double</span> max_length)</div>
<div class="line"><span class="lineno"> 2481</span>        : tH(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>), mField(m_field), moab(m_field.get_moab()),</div>
<div class="line"><span class="lineno"> 2482</span>          maxLength(max_length) {</div>
<div class="line"><span class="lineno"> 2483</span>      gammaL = 1.;</div>
<div class="line"><span class="lineno"> 2484</span>      gammaQ = 3.;</div>
<div class="line"><span class="lineno"> 2485</span>      acceptedThrasholdMergeQuality = 0.5;</div>
<div class="line"><span class="lineno"> 2486</span>    }</div>
<div class="line"><span class="lineno"> 2487</span> </div>
<div class="line"><span class="lineno"> 2488</span>    <span class="keywordtype">double</span></div>
<div class="line"><span class="lineno"> 2489</span>        gammaL; <span class="comment">///&lt; Controls importance of length when ranking edges for merge</span></div>
<div class="line"><span class="lineno"> 2490</span>    <span class="keywordtype">double</span></div>
<div class="line"><span class="lineno"> 2491</span>        gammaQ; <span class="comment">///&lt; Controls importance of quality when ranking edges for merge</span></div>
<div class="line"><span class="lineno"> 2492</span>    <span class="keywordtype">double</span> acceptedThrasholdMergeQuality; <span class="comment">///&lt; Do not merge quality if quality</span><span class="comment"></span></div>
<div class="line"><span class="lineno"> 2493</span><span class="comment">                                          ///&lt; above accepted thrashold</span></div>
<div class="line"><span class="lineno"> 2494</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2495</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> operator()(<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;tets, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;edges,</div>
<div class="line"><span class="lineno"> 2496</span>                              LengthMapData_multi_index &amp;length_map,</div>
<div class="line"><span class="lineno"> 2497</span>                              <span class="keywordtype">double</span> &amp;ave)<span class="keyword"> const </span>{</div>
<div class="line"><span class="lineno"> 2498</span>      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 2499</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 2500</span>      std::array&lt;double, 12&gt; coords;</div>
<div class="line"><span class="lineno"> 2501</span>      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2502</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> s0(3, ublas::shallow_array_adaptor&lt;double&gt;(3, &amp;coords[0]));</div>
<div class="line"><span class="lineno"> 2503</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> s1(3, ublas::shallow_array_adaptor&lt;double&gt;(3, &amp;coords[3]));</div>
<div class="line"><span class="lineno"> 2504</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>(3);</div>
<div class="line"><span class="lineno"> 2505</span> </div>
<div class="line"><span class="lineno"> 2506</span>      <span class="keyword">struct </span>NodeQuality {</div>
<div class="line"><span class="lineno"> 2507</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> node;</div>
<div class="line"><span class="lineno"> 2508</span>        <span class="keywordtype">double</span> quality;</div>
<div class="line"><span class="lineno"> 2509</span>        NodeQuality(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> node) : node(node), quality(1) {}</div>
<div class="line"><span class="lineno"> 2510</span>      };</div>
<div class="line"><span class="lineno"> 2511</span> </div>
<div class="line"><span class="lineno"> 2512</span>      <span class="keyword">typedef</span> multi_index_container&lt;</div>
<div class="line"><span class="lineno"> 2513</span>          NodeQuality, indexed_by&lt;</div>
<div class="line"><span class="lineno"> 2514</span> </div>
<div class="line"><span class="lineno"> 2515</span>                           sequenced&lt;&gt;,</div>
<div class="line"><span class="lineno"> 2516</span> </div>
<div class="line"><span class="lineno"> 2517</span>                           hashed_non_unique&lt;tag&lt;Ent_mi_tag&gt;,</div>
<div class="line"><span class="lineno"> 2518</span>                                             member&lt;NodeQuality, <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>,</div>
<div class="line"><span class="lineno"> 2519</span>                                                    &amp;NodeQuality::node&gt;&gt;</div>
<div class="line"><span class="lineno"> 2520</span> </div>
<div class="line"><span class="lineno"> 2521</span>                           &gt;&gt;</div>
<div class="line"><span class="lineno"> 2522</span>          NodeQuality_sequence;</div>
<div class="line"><span class="lineno"> 2523</span> </div>
<div class="line"><span class="lineno"> 2524</span>      NodeQuality_sequence node_quality_sequence;</div>
<div class="line"><span class="lineno"> 2525</span> </div>
<div class="line"><span class="lineno"> 2526</span>      <a class="code hl_class" href="class_range.html">Range</a> edges_nodes;</div>
<div class="line"><span class="lineno"> 2527</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tets, edges_nodes, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2528</span>      <a class="code hl_class" href="class_range.html">Range</a> edges_tets;</div>
<div class="line"><span class="lineno"> 2529</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(edges, 3, <span class="keyword">false</span>, edges_tets,</div>
<div class="line"><span class="lineno"> 2530</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2531</span>      edges_tets = intersect(edges_tets, tets);</div>
<div class="line"><span class="lineno"> 2532</span> </div>
<div class="line"><span class="lineno"> 2533</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : edges_nodes)</div>
<div class="line"><span class="lineno"> 2534</span>        node_quality_sequence.emplace_back(node);</div>
<div class="line"><span class="lineno"> 2535</span> </div>
<div class="line"><span class="lineno"> 2536</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> tet : edges_tets) {</div>
<div class="line"><span class="lineno"> 2537</span> </div>
<div class="line"><span class="lineno"> 2538</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tet, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2539</span>        <span class="keywordflow">if</span> (tH)</div>
<div class="line"><span class="lineno"> 2540</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(tH, conn, num_nodes, coords.data());</div>
<div class="line"><span class="lineno"> 2541</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2542</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, coords.data());</div>
<div class="line"><span class="lineno"> 2543</span> </div>
<div class="line"><span class="lineno"> 2544</span>        <span class="keyword">const</span> <span class="keywordtype">double</span> q = Tools::volumeLengthQuality(coords.data());</div>
<div class="line"><span class="lineno"> 2545</span> </div>
<div class="line"><span class="lineno"> 2546</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> : {0, 1, 2, 3}) {</div>
<div class="line"><span class="lineno"> 2547</span>          <span class="keyword">auto</span> it = node_quality_sequence.get&lt;1&gt;().find(conn[<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>]);</div>
<div class="line"><span class="lineno"> 2548</span>          <span class="keywordflow">if</span> (it != node_quality_sequence.get&lt;1&gt;().end())</div>
<div class="line"><span class="lineno"> 2549</span>            <span class="keyword">const_cast&lt;</span><span class="keywordtype">double</span> &amp;<span class="keyword">&gt;</span>(it-&gt;quality) = std::min(q, it-&gt;quality);</div>
<div class="line"><span class="lineno"> 2550</span>        }</div>
<div class="line"><span class="lineno"> 2551</span>      }</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> edge : edges) {</div>
<div class="line"><span class="lineno"> 2554</span> </div>
<div class="line"><span class="lineno"> 2555</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edge, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2556</span> </div>
<div class="line"><span class="lineno"> 2557</span>        <span class="keywordflow">if</span> (tH)</div>
<div class="line"><span class="lineno"> 2558</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(tH, conn, num_nodes, coords.data());</div>
<div class="line"><span class="lineno"> 2559</span>        <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2560</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, coords.data());</div>
<div class="line"><span class="lineno"> 2561</span> </div>
<div class="line"><span class="lineno"> 2562</span>        <span class="keywordtype">double</span> q = 1;</div>
<div class="line"><span class="lineno"> 2563</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> : {0, 1}) {</div>
<div class="line"><span class="lineno"> 2564</span>          <span class="keyword">auto</span> it = node_quality_sequence.get&lt;1&gt;().find(conn[<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>]);</div>
<div class="line"><span class="lineno"> 2565</span>          <span class="keywordflow">if</span> (it != node_quality_sequence.get&lt;1&gt;().end())</div>
<div class="line"><span class="lineno"> 2566</span>            q = std::min(q, it-&gt;quality);</div>
<div class="line"><span class="lineno"> 2567</span>        }</div>
<div class="line"><span class="lineno"> 2568</span> </div>
<div class="line"><span class="lineno"> 2569</span>        <span class="keywordflow">if</span> (q &lt; acceptedThrasholdMergeQuality) {</div>
<div class="line"><span class="lineno"> 2570</span>          noalias(<a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>) = (s0 - s1) / maxLength;</div>
<div class="line"><span class="lineno"> 2571</span>          <span class="keywordtype">double</span> dot = inner_prod(<a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>, <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>);</div>
<div class="line"><span class="lineno"> 2572</span>          <span class="keywordtype">double</span> val = pow(q, gammaQ) * pow(dot, 0.5 * gammaL);</div>
<div class="line"><span class="lineno"> 2573</span>          length_map.insert(LengthMapData(val, q, edge));</div>
<div class="line"><span class="lineno"> 2574</span>        }</div>
<div class="line"><span class="lineno"> 2575</span>      }</div>
<div class="line"><span class="lineno"> 2576</span> </div>
<div class="line"><span class="lineno"> 2577</span>      ave = 0;</div>
<div class="line"><span class="lineno"> 2578</span>      <span class="keywordflow">for</span> (LengthMapData_multi_index::nth_index&lt;0&gt;::type::iterator mit =</div>
<div class="line"><span class="lineno"> 2579</span>               length_map.get&lt;0&gt;().begin();</div>
<div class="line"><span class="lineno"> 2580</span>           mit != length_map.get&lt;0&gt;().end(); mit++) {</div>
<div class="line"><span class="lineno"> 2581</span>        ave += mit-&gt;qUality;</div>
<div class="line"><span class="lineno"> 2582</span>      }</div>
<div class="line"><span class="lineno"> 2583</span>      ave /= length_map.size();</div>
<div class="line"><span class="lineno"> 2584</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2585</span>    }</div>
<div class="line"><span class="lineno"> 2586</span>  };</div>
<div class="line"><span class="lineno"> 2587</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2588</span><span class="comment">  /**</span></div>
<div class="line"><span class="lineno"> 2589</span><span class="comment">   * \brief Topological relations</span></div>
<div class="line"><span class="lineno"> 2590</span><span class="comment">   */</span></div>
<div class="line"><span class="lineno"> 2591</span>  <span class="keyword">struct </span>Toplogy {</div>
<div class="line"><span class="lineno"> 2592</span> </div>
<div class="line"><span class="lineno"> 2593</span>    CoreInterface &amp;mField;</div>
<div class="line"><span class="lineno"> 2594</span>    Tag tH;</div>
<div class="line"><span class="lineno"> 2595</span>    Toplogy(CoreInterface &amp;m_field, Tag th) : mField(m_field), tH(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {}</div>
<div class="line"><span class="lineno"> 2596</span> </div>
<div class="line"><span class="lineno"> 2597</span>    <span class="keyword">enum</span> TYPE {</div>
<div class="line"><span class="lineno"> 2598</span>      FREE = 0,</div>
<div class="line"><span class="lineno"> 2599</span>      SKIN = 1 &lt;&lt; 0,</div>
<div class="line"><span class="lineno"> 2600</span>      SURFACE = 1 &lt;&lt; 1,</div>
<div class="line"><span class="lineno"> 2601</span>      SURFACE_SKIN = 1 &lt;&lt; 2,</div>
<div class="line"><span class="lineno"> 2602</span>      FRONT_ENDS = 1 &lt;&lt; 3,</div>
<div class="line"><span class="lineno"> 2603</span>      FIX_EDGES = 1 &lt;&lt; 4,</div>
<div class="line"><span class="lineno"> 2604</span>      FIX_CORNERS = 1 &lt;&lt; 5</div>
<div class="line"><span class="lineno"> 2605</span>    };</div>
<div class="line"><span class="lineno"> 2606</span> </div>
<div class="line"><span class="lineno"> 2607</span>    <span class="keyword">typedef</span> map&lt;int, Range&gt; SetsMap;</div>
<div class="line"><span class="lineno"> 2608</span> </div>
<div class="line"><span class="lineno"> 2609</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> classifyVerts(<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;<a class="code hl_namespace" href="namespacesurface.html">surface</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;tets,</div>
<div class="line"><span class="lineno"> 2610</span>                                 <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;fixed_edges,</div>
<div class="line"><span class="lineno"> 2611</span>                                 <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;corner_nodes,</div>
<div class="line"><span class="lineno"> 2612</span>                                 <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;constrain_surface,</div>
<div class="line"><span class="lineno"> 2613</span>                                 SetsMap &amp;sets_map)<span class="keyword"> const </span>{</div>
<div class="line"><span class="lineno"> 2614</span>      moab::Interface &amp;moab(mField.get_moab());</div>
<div class="line"><span class="lineno"> 2615</span>      Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno"> 2616</span>      <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2617</span> </div>
<div class="line"><span class="lineno"> 2618</span>      sets_map[FIX_CORNERS].merge(corner_nodes);</div>
<div class="line"><span class="lineno"> 2619</span>      <a class="code hl_class" href="class_range.html">Range</a> fixed_verts;</div>
<div class="line"><span class="lineno"> 2620</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(fixed_edges, fixed_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2621</span>      sets_map[FIX_EDGES].swap(fixed_verts);</div>
<div class="line"><span class="lineno"> 2622</span> </div>
<div class="line"><span class="lineno"> 2623</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line"><span class="lineno"> 2624</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, tets_skin);</div>
<div class="line"><span class="lineno"> 2625</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_skin_edges;</div>
<div class="line"><span class="lineno"> 2626</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(tets_skin, 1, <span class="keyword">false</span>, tets_skin_edges,</div>
<div class="line"><span class="lineno"> 2627</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2628</span> </div>
<div class="line"><span class="lineno"> 2629</span>      <span class="comment">// constrain surface</span></div>
<div class="line"><span class="lineno"> 2630</span>      <a class="code hl_class" href="class_range.html">Range</a> constrain_surface_verts;</div>
<div class="line"><span class="lineno"> 2631</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(constrain_surface, constrain_surface_verts,</div>
<div class="line"><span class="lineno"> 2632</span>                                   <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2633</span>      <a class="code hl_class" href="class_range.html">Range</a> constrain_surface_edges;</div>
<div class="line"><span class="lineno"> 2634</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(constrain_surface, 1, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 2635</span>                                  constrain_surface_edges,</div>
<div class="line"><span class="lineno"> 2636</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>      <span class="comment">// surface skin</span></div>
<div class="line"><span class="lineno"> 2639</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_skin;</div>
<div class="line"><span class="lineno"> 2640</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_namespace" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><span class="lineno"> 2641</span>      <a class="code hl_class" href="class_range.html">Range</a> front_in_the_body;</div>
<div class="line"><span class="lineno"> 2642</span>      front_in_the_body = subtract(surface_skin, tets_skin_edges);</div>
<div class="line"><span class="lineno"> 2643</span>      <a class="code hl_class" href="class_range.html">Range</a> front_in_the_body_verts;</div>
<div class="line"><span class="lineno"> 2644</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(front_in_the_body, front_in_the_body_verts,</div>
<div class="line"><span class="lineno"> 2645</span>                                   <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2646</span>      <a class="code hl_class" href="class_range.html">Range</a> front_ends;</div>
<div class="line"><span class="lineno"> 2647</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, front_in_the_body, <span class="keyword">false</span>, front_ends);</div>
<div class="line"><span class="lineno"> 2648</span>      front_ends.merge(</div>
<div class="line"><span class="lineno"> 2649</span>          intersect(front_in_the_body_verts, constrain_surface_verts));</div>
<div class="line"><span class="lineno"> 2650</span>      sets_map[FRONT_ENDS].swap(front_ends);</div>
<div class="line"><span class="lineno"> 2651</span> </div>
<div class="line"><span class="lineno"> 2652</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_skin_verts;</div>
<div class="line"><span class="lineno"> 2653</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(surface_skin, surface_skin_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2654</span>      sets_map[SURFACE_SKIN].swap(surface_skin_verts);</div>
<div class="line"><span class="lineno"> 2655</span> </div>
<div class="line"><span class="lineno"> 2656</span>      <span class="comment">// surface</span></div>
<div class="line"><span class="lineno"> 2657</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_verts;</div>
<div class="line"><span class="lineno"> 2658</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_namespace" href="namespacesurface.html">surface</a>, surface_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2659</span>      sets_map[SURFACE_SKIN].merge(</div>
<div class="line"><span class="lineno"> 2660</span>          intersect(constrain_surface_verts, surface_verts));</div>
<div class="line"><span class="lineno"> 2661</span>      sets_map[SURFACE].swap(surface_verts);</div>
<div class="line"><span class="lineno"> 2662</span> </div>
<div class="line"><span class="lineno"> 2663</span>      <span class="comment">// skin</span></div>
<div class="line"><span class="lineno"> 2664</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_skin_verts;</div>
<div class="line"><span class="lineno"> 2665</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tets_skin, tets_skin_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2666</span>      sets_map[SKIN].swap(tets_skin_verts);</div>
<div class="line"><span class="lineno"> 2667</span>      sets_map[SKIN].merge(constrain_surface_verts);</div>
<div class="line"><span class="lineno"> 2668</span> </div>
<div class="line"><span class="lineno"> 2669</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_verts;</div>
<div class="line"><span class="lineno"> 2670</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tets, tets_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2671</span>      sets_map[FREE].swap(tets_verts);</div>
<div class="line"><span class="lineno"> 2672</span> </div>
<div class="line"><span class="lineno"> 2673</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2674</span>    }</div>
<div class="line"><span class="lineno"> 2675</span> </div>
<div class="line"><span class="lineno"> 2676</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> getProcTets(<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;tets, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;edges_to_merge,</div>
<div class="line"><span class="lineno"> 2677</span>                               <a class="code hl_class" href="class_range.html">Range</a> &amp;proc_tets)<span class="keyword"> const </span>{</div>
<div class="line"><span class="lineno"> 2678</span>      moab::Interface &amp;moab(mField.get_moab());</div>
<div class="line"><span class="lineno"> 2679</span>      <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2680</span>      <a class="code hl_class" href="class_range.html">Range</a> edges_to_merge_verts;</div>
<div class="line"><span class="lineno"> 2681</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edges_to_merge, edges_to_merge_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2682</span>      <a class="code hl_class" href="class_range.html">Range</a> edges_to_merge_verts_tets;</div>
<div class="line"><span class="lineno"> 2683</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(edges_to_merge_verts, 3, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 2684</span>                                  edges_to_merge_verts_tets,</div>
<div class="line"><span class="lineno"> 2685</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2686</span>      edges_to_merge_verts_tets = intersect(edges_to_merge_verts_tets, tets);</div>
<div class="line"><span class="lineno"> 2687</span>      proc_tets.swap(edges_to_merge_verts_tets);</div>
<div class="line"><span class="lineno"> 2688</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2689</span>    }</div>
<div class="line"><span class="lineno"> 2690</span> </div>
<div class="line"><span class="lineno"> 2691</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> removeBadEdges(<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;<a class="code hl_namespace" href="namespacesurface.html">surface</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;tets,</div>
<div class="line"><span class="lineno"> 2692</span>                                  <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;fixed_edges,</div>
<div class="line"><span class="lineno"> 2693</span>                                  <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;corner_nodes,</div>
<div class="line"><span class="lineno"> 2694</span>                                  <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;constrain_surface,</div>
<div class="line"><span class="lineno"> 2695</span>                                  <a class="code hl_class" href="class_range.html">Range</a> &amp;edges_to_merge,</div>
<div class="line"><span class="lineno"> 2696</span>                                  <a class="code hl_class" href="class_range.html">Range</a> &amp;not_merged_edges) {</div>
<div class="line"><span class="lineno"> 2697</span>      moab::Interface &amp;moab(mField.get_moab());</div>
<div class="line"><span class="lineno"> 2698</span>      <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2699</span> </div>
<div class="line"><span class="lineno"> 2700</span>      <span class="comment">// find skin</span></div>
<div class="line"><span class="lineno"> 2701</span>      Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno"> 2702</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line"><span class="lineno"> 2703</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, tets_skin);</div>
<div class="line"><span class="lineno"> 2704</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_skin;</div>
<div class="line"><span class="lineno"> 2705</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_namespace" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><span class="lineno"> 2706</span> </div>
<div class="line"><span class="lineno"> 2707</span>      <span class="comment">// constrain surface</span></div>
<div class="line"><span class="lineno"> 2708</span>      <a class="code hl_class" href="class_range.html">Range</a> constrain_surface_verts;</div>
<div class="line"><span class="lineno"> 2709</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(constrain_surface, constrain_surface_verts,</div>
<div class="line"><span class="lineno"> 2710</span>                                   <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2711</span>      <a class="code hl_class" href="class_range.html">Range</a> constrain_surface_edges;</div>
<div class="line"><span class="lineno"> 2712</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(constrain_surface, 1, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 2713</span>                                  constrain_surface_edges,</div>
<div class="line"><span class="lineno"> 2714</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2715</span> </div>
<div class="line"><span class="lineno"> 2716</span>      <span class="comment">// end nodes</span></div>
<div class="line"><span class="lineno"> 2717</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_skin_edges;</div>
<div class="line"><span class="lineno"> 2718</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(tets_skin, 1, <span class="keyword">false</span>, tets_skin_edges,</div>
<div class="line"><span class="lineno"> 2719</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2720</span> </div>
<div class="line"><span class="lineno"> 2721</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_front;</div>
<div class="line"><span class="lineno"> 2722</span>      surface_front = subtract(surface_skin, tets_skin_edges);</div>
<div class="line"><span class="lineno"> 2723</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_front_nodes;</div>
<div class="line"><span class="lineno"> 2724</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(surface_front, surface_front_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2725</span> </div>
<div class="line"><span class="lineno"> 2726</span>      <a class="code hl_class" href="class_range.html">Range</a> ends_nodes;</div>
<div class="line"><span class="lineno"> 2727</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, surface_front, <span class="keyword">false</span>, ends_nodes);</div>
<div class="line"><span class="lineno"> 2728</span>      ends_nodes.merge(intersect(surface_front_nodes, constrain_surface_verts));</div>
<div class="line"><span class="lineno"> 2729</span> </div>
<div class="line"><span class="lineno"> 2730</span>      <span class="comment">// remove bad merges</span></div>
<div class="line"><span class="lineno"> 2731</span>      surface_skin.merge(constrain_surface);</div>
<div class="line"><span class="lineno"> 2732</span>      tets_skin_edges.merge(constrain_surface_edges);</div>
<div class="line"><span class="lineno"> 2733</span> </div>
<div class="line"><span class="lineno"> 2734</span>      <span class="comment">// get surface and body skin verts</span></div>
<div class="line"><span class="lineno"> 2735</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_edges;</div>
<div class="line"><span class="lineno"> 2736</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_namespace" href="namespacesurface.html">surface</a>, 1, <span class="keyword">false</span>, surface_edges,</div>
<div class="line"><span class="lineno"> 2737</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2738</span>      <span class="comment">// get nodes on the surface</span></div>
<div class="line"><span class="lineno"> 2739</span>      <a class="code hl_class" href="class_range.html">Range</a> surface_edges_verts;</div>
<div class="line"><span class="lineno"> 2740</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(surface_edges, surface_edges_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2741</span>      <span class="comment">// get vertices on the body skin</span></div>
<div class="line"><span class="lineno"> 2742</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_skin_edges_verts;</div>
<div class="line"><span class="lineno"> 2743</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tets_skin_edges, tets_skin_edges_verts,</div>
<div class="line"><span class="lineno"> 2744</span>                                   <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2745</span> </div>
<div class="line"><span class="lineno"> 2746</span>      <a class="code hl_class" href="class_range.html">Range</a> edges_to_remove;</div>
<div class="line"><span class="lineno"> 2747</span> </div>
<div class="line"><span class="lineno"> 2748</span>      <span class="comment">// remove edges self connected to body skin</span></div>
<div class="line"><span class="lineno"> 2749</span>      {</div>
<div class="line"><span class="lineno"> 2750</span>        <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_and_edges;</div>
<div class="line"><span class="lineno"> 2751</span>        ents_nodes_and_edges.merge(tets_skin_edges_verts);</div>
<div class="line"><span class="lineno"> 2752</span>        ents_nodes_and_edges.merge(tets_skin_edges);</div>
<div class="line"><span class="lineno"> 2753</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(ents_nodes_and_edges, edges_to_remove,</div>
<div class="line"><span class="lineno"> 2754</span>                                        <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2755</span>      }</div>
<div class="line"><span class="lineno"> 2756</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2757</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2758</span> </div>
<div class="line"><span class="lineno"> 2759</span>      <span class="comment">// remove edges self connected to surface</span></div>
<div class="line"><span class="lineno"> 2760</span>      {</div>
<div class="line"><span class="lineno"> 2761</span>        <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_and_edges;</div>
<div class="line"><span class="lineno"> 2762</span>        ents_nodes_and_edges.merge(surface_edges_verts);</div>
<div class="line"><span class="lineno"> 2763</span>        ents_nodes_and_edges.merge(surface_edges);</div>
<div class="line"><span class="lineno"> 2764</span>        ents_nodes_and_edges.merge(tets_skin_edges_verts);</div>
<div class="line"><span class="lineno"> 2765</span>        ents_nodes_and_edges.merge(tets_skin_edges);</div>
<div class="line"><span class="lineno"> 2766</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(ents_nodes_and_edges, edges_to_remove,</div>
<div class="line"><span class="lineno"> 2767</span>                                        <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2768</span>      }</div>
<div class="line"><span class="lineno"> 2769</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2770</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2771</span> </div>
<div class="line"><span class="lineno"> 2772</span>      <span class="comment">// remove edges adjacent corner_nodes execpt those on fixed edges</span></div>
<div class="line"><span class="lineno"> 2773</span>      <a class="code hl_class" href="class_range.html">Range</a> fixed_edges_nodes;</div>
<div class="line"><span class="lineno"> 2774</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(fixed_edges, fixed_edges_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2775</span>      {</div>
<div class="line"><span class="lineno"> 2776</span>        <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_and_edges;</div>
<div class="line"><span class="lineno"> 2777</span>        ents_nodes_and_edges.merge(fixed_edges_nodes);</div>
<div class="line"><span class="lineno"> 2778</span>        ents_nodes_and_edges.merge(ends_nodes);</div>
<div class="line"><span class="lineno"> 2779</span>        ents_nodes_and_edges.merge(corner_nodes);</div>
<div class="line"><span class="lineno"> 2780</span>        ents_nodes_and_edges.merge(fixed_edges);</div>
<div class="line"><span class="lineno"> 2781</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(ents_nodes_and_edges, edges_to_remove,</div>
<div class="line"><span class="lineno"> 2782</span>                                        <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2783</span>      }</div>
<div class="line"><span class="lineno"> 2784</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2785</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2786</span> </div>
<div class="line"><span class="lineno"> 2787</span>      <span class="comment">// remove edges self connected to surface</span></div>
<div class="line"><span class="lineno"> 2788</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(surface_edges, edges_to_remove, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2789</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2790</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2791</span> </div>
<div class="line"><span class="lineno"> 2792</span>      <span class="comment">// remove edges self contented on surface skin</span></div>
<div class="line"><span class="lineno"> 2793</span>      {</div>
<div class="line"><span class="lineno"> 2794</span>        <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_and_edges;</div>
<div class="line"><span class="lineno"> 2795</span>        ents_nodes_and_edges.merge(surface_skin);</div>
<div class="line"><span class="lineno"> 2796</span>        ents_nodes_and_edges.merge(fixed_edges_nodes);</div>
<div class="line"><span class="lineno"> 2797</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(ents_nodes_and_edges, edges_to_remove,</div>
<div class="line"><span class="lineno"> 2798</span>                                        <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2799</span>      }</div>
<div class="line"><span class="lineno"> 2800</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2801</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2802</span> </div>
<div class="line"><span class="lineno"> 2803</span>      <span class="comment">// remove edges connecting crack front and fixed edges, except those short</span></div>
<div class="line"><span class="lineno"> 2804</span>      {</div>
<div class="line"><span class="lineno"> 2805</span>        <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_and_edges;</div>
<div class="line"><span class="lineno"> 2806</span>        ents_nodes_and_edges.merge(surface_skin.subset_by_type(MBEDGE));</div>
<div class="line"><span class="lineno"> 2807</span>        ents_nodes_and_edges.merge(fixed_edges.subset_by_type(MBEDGE));</div>
<div class="line"><span class="lineno"> 2808</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(ents_nodes_and_edges, edges_to_remove,</div>
<div class="line"><span class="lineno"> 2809</span>                                        <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2810</span>      }</div>
<div class="line"><span class="lineno"> 2811</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2812</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2813</span> </div>
<div class="line"><span class="lineno"> 2814</span>      <span class="comment">// remove crack front nodes connected to the surface, except those short</span></div>
<div class="line"><span class="lineno"> 2815</span>      {</div>
<div class="line"><span class="lineno"> 2816</span>        <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_and_edges;</div>
<div class="line"><span class="lineno"> 2817</span>        ents_nodes_and_edges.merge(surface_front_nodes);</div>
<div class="line"><span class="lineno"> 2818</span>        ents_nodes_and_edges.merge(surface_front);</div>
<div class="line"><span class="lineno"> 2819</span>        ents_nodes_and_edges.merge(tets_skin_edges_verts);</div>
<div class="line"><span class="lineno"> 2820</span>        ents_nodes_and_edges.merge(tets_skin_edges);</div>
<div class="line"><span class="lineno"> 2821</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> removeSelfConectingEdges(ents_nodes_and_edges, edges_to_remove,</div>
<div class="line"><span class="lineno"> 2822</span>                                        <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno"> 2823</span>      }</div>
<div class="line"><span class="lineno"> 2824</span>      edges_to_merge = subtract(edges_to_merge, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2825</span>      not_merged_edges.merge(edges_to_remove);</div>
<div class="line"><span class="lineno"> 2826</span> </div>
<div class="line"><span class="lineno"> 2827</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2828</span>    }</div>
<div class="line"><span class="lineno"> 2829</span> </div>
<div class="line"><span class="lineno"> 2830</span>  <span class="keyword">private</span>:</div>
<div class="line"><span class="lineno"> 2831</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> removeSelfConectingEdges(<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;ents,</div>
<div class="line"><span class="lineno"> 2832</span>                                            <a class="code hl_class" href="class_range.html">Range</a> &amp;edges_to_remove,</div>
<div class="line"><span class="lineno"> 2833</span>                                            <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)<span class="keyword"> const </span>{</div>
<div class="line"><span class="lineno"> 2834</span>      moab::Interface &amp;moab(mField.get_moab());</div>
<div class="line"><span class="lineno"> 2835</span>      <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2836</span>      <span class="comment">// get nodes</span></div>
<div class="line"><span class="lineno"> 2837</span>      <a class="code hl_class" href="class_range.html">Range</a> ents_nodes = ents.subset_by_type(MBVERTEX);</div>
<div class="line"><span class="lineno"> 2838</span>      <span class="keywordflow">if</span> (ents_nodes.empty()) {</div>
<div class="line"><span class="lineno"> 2839</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(ents, ents_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2840</span>      }</div>
<div class="line"><span class="lineno"> 2841</span>      <span class="comment">// edges adj. to nodes</span></div>
<div class="line"><span class="lineno"> 2842</span>      <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_edges;</div>
<div class="line"><span class="lineno"> 2843</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents_nodes, 1, <span class="keyword">false</span>, ents_nodes_edges,</div>
<div class="line"><span class="lineno"> 2844</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2845</span>      <span class="comment">// nodes of adj. edges</span></div>
<div class="line"><span class="lineno"> 2846</span>      <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_edges_nodes;</div>
<div class="line"><span class="lineno"> 2847</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(ents_nodes_edges, ents_nodes_edges_nodes,</div>
<div class="line"><span class="lineno"> 2848</span>                                   <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2849</span>      <span class="comment">// hanging nodes</span></div>
<div class="line"><span class="lineno"> 2850</span>      ents_nodes_edges_nodes = subtract(ents_nodes_edges_nodes, ents_nodes);</div>
<div class="line"><span class="lineno"> 2851</span>      <a class="code hl_class" href="class_range.html">Range</a> ents_nodes_edges_nodes_edges;</div>
<div class="line"><span class="lineno"> 2852</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents_nodes_edges_nodes, 1, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 2853</span>                                  ents_nodes_edges_nodes_edges,</div>
<div class="line"><span class="lineno"> 2854</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2855</span>      <span class="comment">// remove edges adj. to hanging edges</span></div>
<div class="line"><span class="lineno"> 2856</span>      ents_nodes_edges =</div>
<div class="line"><span class="lineno"> 2857</span>          subtract(ents_nodes_edges, ents_nodes_edges_nodes_edges);</div>
<div class="line"><span class="lineno"> 2858</span>      ents_nodes_edges =</div>
<div class="line"><span class="lineno"> 2859</span>          subtract(ents_nodes_edges, ents.subset_by_type(MBEDGE));</div>
<div class="line"><span class="lineno"> 2860</span> </div>
<div class="line"><span class="lineno"> 2861</span>      edges_to_remove.swap(ents_nodes_edges);</div>
<div class="line"><span class="lineno"> 2862</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno"> 2863</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;edges_to_remove.vtk&quot;</span>, edges_to_remove);</div>
<div class="line"><span class="lineno"> 2864</span>      }</div>
<div class="line"><span class="lineno"> 2865</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2866</span>    }</div>
<div class="line"><span class="lineno"> 2867</span>  };</div>
<div class="line"><span class="lineno"> 2868</span> </div>
<div class="line"><span class="lineno"> 2869</span>  <a class="code hl_class" href="class_range.html">Range</a> not_merged_edges;</div>
<div class="line"><span class="lineno"> 2870</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Toplogy(m_field, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 2871</span>      .removeBadEdges(<a class="code hl_namespace" href="namespacesurface.html">surface</a>, tets, fixed_edges, corner_nodes,</div>
<div class="line"><span class="lineno"> 2872</span>                      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>, edges_to_merge, not_merged_edges);</div>
<div class="line"><span class="lineno"> 2873</span>  Toplogy::SetsMap sets_map;</div>
<div class="line"><span class="lineno"> 2874</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Toplogy(m_field, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 2875</span>      .classifyVerts(<a class="code hl_namespace" href="namespacesurface.html">surface</a>, tets, fixed_edges, corner_nodes, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>,</div>
<div class="line"><span class="lineno"> 2876</span>                     sets_map);</div>
<div class="line"><span class="lineno"> 2877</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno"> 2878</span>    <span class="keywordflow">for</span> (Toplogy::SetsMap::reverse_iterator sit = sets_map.rbegin();</div>
<div class="line"><span class="lineno"> 2879</span>         sit != sets_map.rend(); sit++) {</div>
<div class="line"><span class="lineno"> 2880</span>      std::string name = <span class="stringliteral">&quot;classification_verts_&quot;</span> +</div>
<div class="line"><span class="lineno"> 2881</span>                         boost::lexical_cast&lt;std::string&gt;(sit-&gt;first) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><span class="lineno"> 2882</span>      <span class="keywordflow">if</span> (!sit-&gt;second.empty())</div>
<div class="line"><span class="lineno"> 2883</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(name, sit-&gt;second);</div>
<div class="line"><span class="lineno"> 2884</span>    }</div>
<div class="line"><span class="lineno"> 2885</span>  }</div>
<div class="line"><span class="lineno"> 2886</span>  <a class="code hl_class" href="class_range.html">Range</a> proc_tets;</div>
<div class="line"><span class="lineno"> 2887</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Toplogy(m_field, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>).getProcTets(tets, edges_to_merge, proc_tets);</div>
<div class="line"><span class="lineno"> 2888</span>  out_tets = subtract(tets, proc_tets);</div>
<div class="line"><span class="lineno"> 2889</span> </div>
<div class="line"><span class="lineno"> 2890</span>  <span class="keywordflow">if</span> (bit_ptr) {</div>
<div class="line"><span class="lineno"> 2891</span>    <a class="code hl_class" href="class_range.html">Range</a> all_out_ents = out_tets;</div>
<div class="line"><span class="lineno"> 2892</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 2; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> &gt;= 0; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>--) {</div>
<div class="line"><span class="lineno"> 2893</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(out_tets, dd, <span class="keyword">false</span>, all_out_ents,</div>
<div class="line"><span class="lineno"> 2894</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2895</span>    }</div>
<div class="line"><span class="lineno"> 2896</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;addBitRefLevel(all_out_ents,</div>
<div class="line"><span class="lineno"> 2897</span>                                                                 *bit_ptr);</div>
<div class="line"><span class="lineno"> 2898</span>  }</div>
<div class="line"><span class="lineno"> 2899</span> </div>
<div class="line"><span class="lineno"> 2900</span>  <span class="keywordtype">int</span> nb_nodes_merged = 0;</div>
<div class="line"><span class="lineno"> 2901</span>  <a class="code hl_typedef" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a97177b5e49ae7783439f2237db188563">LengthMapData_multi_index</a> length_map;</div>
<div class="line"><span class="lineno"> 2902</span>  new_surf = <a class="code hl_namespace" href="namespacesurface.html">surface</a>;</div>
<div class="line"><span class="lineno"> 2903</span> </div>
<div class="line"><span class="lineno"> 2904</span>  <span class="keyword">auto</span> save_merge_step = [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> pp, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> collapsed_edges) {</div>
<div class="line"><span class="lineno"> 2905</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2906</span>    <a class="code hl_class" href="class_range.html">Range</a> adj_faces;</div>
<div class="line"><span class="lineno"> 2907</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(proc_tets, 2, <span class="keyword">false</span>, adj_faces,</div>
<div class="line"><span class="lineno"> 2908</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2909</span>    std::string name;</div>
<div class="line"><span class="lineno"> 2910</span>    name = <span class="stringliteral">&quot;node_merge_step_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(pp) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><span class="lineno"> 2911</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(</div>
<div class="line"><span class="lineno"> 2912</span>        name, unite(intersect(new_surf, adj_faces), collapsed_edges));</div>
<div class="line"><span class="lineno"> 2913</span>    name =</div>
<div class="line"><span class="lineno"> 2914</span>        <span class="stringliteral">&quot;edges_to_merge_step_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(pp) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><span class="lineno"> 2915</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(</div>
<div class="line"><span class="lineno"> 2916</span>        name, unite(intersect(new_surf, adj_faces), edges_to_merge));</div>
<div class="line"><span class="lineno"> 2917</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2918</span>  };</div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 2921</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_merge_step(0, <a class="code hl_class" href="class_range.html">Range</a>());</div>
<div class="line"><span class="lineno"> 2922</span> </div>
<div class="line"><span class="lineno"> 2923</span>  <span class="keywordtype">double</span> ave0 = 0, ave = 0, min = 0, min_p = 0, min_pp;</div>
<div class="line"><span class="lineno"> 2924</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pp = 0; pp != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa4a886cef884b12a6fc193fb98cace45">nbMaxMergingCycles</a>; ++pp) {</div>
<div class="line"><span class="lineno"> 2925</span> </div>
<div class="line"><span class="lineno"> 2926</span>    <span class="keywordtype">int</span> nb_nodes_merged_p = nb_nodes_merged;</div>
<div class="line"><span class="lineno"> 2927</span>    length_map.clear();</div>
<div class="line"><span class="lineno"> 2928</span>    min_pp = min_p;</div>
<div class="line"><span class="lineno"> 2929</span>    min_p = min;</div>
<div class="line"><span class="lineno"> 2930</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> LengthMap(m_field, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a27ab998c8029b8adcbcc89c4f967d43a">aveLength</a>)(proc_tets, edges_to_merge,</div>
<div class="line"><span class="lineno"> 2931</span>                                             length_map, ave);</div>
<div class="line"><span class="lineno"> 2932</span> </div>
<div class="line"><span class="lineno"> 2933</span>    <span class="keywordflow">if</span>(!length_map.empty())</div>
<div class="line"><span class="lineno"> 2934</span>      min = length_map.get&lt;2&gt;().begin()-&gt;qUality;</div>
<div class="line"><span class="lineno"> 2935</span>    <span class="keywordflow">if</span> (pp == 0) {</div>
<div class="line"><span class="lineno"> 2936</span>      ave0 = ave;</div>
<div class="line"><span class="lineno"> 2937</span>    }</div>
<div class="line"><span class="lineno"> 2938</span> </div>
<div class="line"><span class="lineno"> 2939</span>    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><span class="lineno"> 2940</span>    <a class="code hl_class" href="class_range.html">Range</a> collapsed_edges;</div>
<div class="line"><span class="lineno"> 2941</span>    MergeNodes merge_nodes(m_field, <span class="keyword">true</span>, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, update_meshsets);</div>
<div class="line"><span class="lineno"> 2942</span> </div>
<div class="line"><span class="lineno"> 2943</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> mit = length_map.get&lt;0&gt;().begin();</div>
<div class="line"><span class="lineno"> 2944</span>         mit != length_map.get&lt;0&gt;().end(); mit++, nn++) {</div>
<div class="line"><span class="lineno"> 2945</span> </div>
<div class="line"><span class="lineno"> 2946</span>      <span class="keywordflow">if</span> (!mit-&gt;skip) {</div>
<div class="line"><span class="lineno"> 2947</span> </div>
<div class="line"><span class="lineno"> 2948</span>        <span class="keyword">auto</span> get_father_and_mother =</div>
<div class="line"><span class="lineno"> 2949</span>            [&amp;](<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> &amp;father, <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> &amp;mother, <span class="keywordtype">int</span> &amp;line_search) {</div>
<div class="line"><span class="lineno"> 2950</span>              <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2951</span>              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 2952</span>              <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 2953</span>              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(mit-&gt;eDge, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2954</span>              std::array&lt;int, 2&gt; conn_type = {0, 0};</div>
<div class="line"><span class="lineno"> 2955</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 2; nn++) {</div>
<div class="line"><span class="lineno"> 2956</span>                <span class="keywordflow">for</span> (Toplogy::SetsMap::reverse_iterator sit = sets_map.rbegin();</div>
<div class="line"><span class="lineno"> 2957</span>                     sit != sets_map.rend(); sit++) {</div>
<div class="line"><span class="lineno"> 2958</span>                  <span class="keywordflow">if</span> (sit-&gt;second.find(conn[nn]) != sit-&gt;second.end()) {</div>
<div class="line"><span class="lineno"> 2959</span>                    conn_type[nn] |= sit-&gt;first;</div>
<div class="line"><span class="lineno"> 2960</span>                  }</div>
<div class="line"><span class="lineno"> 2961</span>                }</div>
<div class="line"><span class="lineno"> 2962</span>              }</div>
<div class="line"><span class="lineno"> 2963</span>              <span class="keywordtype">int</span> type_father, type_mother;</div>
<div class="line"><span class="lineno"> 2964</span>              <span class="keywordflow">if</span> (conn_type[0] &gt; conn_type[1]) {</div>
<div class="line"><span class="lineno"> 2965</span>                father = conn[0];</div>
<div class="line"><span class="lineno"> 2966</span>                mother = conn[1];</div>
<div class="line"><span class="lineno"> 2967</span>                type_father = conn_type[0];</div>
<div class="line"><span class="lineno"> 2968</span>                type_mother = conn_type[1];</div>
<div class="line"><span class="lineno"> 2969</span>              } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 2970</span>                father = conn[1];</div>
<div class="line"><span class="lineno"> 2971</span>                mother = conn[0];</div>
<div class="line"><span class="lineno"> 2972</span>                type_father = conn_type[1];</div>
<div class="line"><span class="lineno"> 2973</span>                type_mother = conn_type[0];</div>
<div class="line"><span class="lineno"> 2974</span>              }</div>
<div class="line"><span class="lineno"> 2975</span>              <span class="keywordflow">if</span> (type_father == type_mother) {</div>
<div class="line"><span class="lineno"> 2976</span>                line_search = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4f4d5194089ca2d3fbbc483eeb75c817">lineSearchSteps</a>;</div>
<div class="line"><span class="lineno"> 2977</span>              }</div>
<div class="line"><span class="lineno"> 2978</span>              <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2979</span>            };</div>
<div class="line"><span class="lineno"> 2980</span> </div>
<div class="line"><span class="lineno"> 2981</span>        <span class="keywordtype">int</span> line_search = 0;</div>
<div class="line"><span class="lineno"> 2982</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> father, mother;</div>
<div class="line"><span class="lineno"> 2983</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_father_and_mother(father, mother, line_search);</div>
<div class="line"><span class="lineno"> 2984</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> merge_nodes.mergeNodes(line_search, father, mother, proc_tets);</div>
<div class="line"><span class="lineno"> 2985</span>        <span class="keywordflow">if</span> (m_field.getInterface&lt;NodeMergerInterface&gt;()-&gt;getSuccessMerge()) {</div>
<div class="line"><span class="lineno"> 2986</span>          <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> father_and_mother[] = {father, mother};</div>
<div class="line"><span class="lineno"> 2987</span>          <a class="code hl_class" href="class_range.html">Range</a> adj_tets;</div>
<div class="line"><span class="lineno"> 2988</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(father_and_mother, 1, 3, <span class="keyword">false</span>, adj_tets);</div>
<div class="line"><span class="lineno"> 2989</span>          <a class="code hl_class" href="class_range.html">Range</a> adj_tets_nodes;</div>
<div class="line"><span class="lineno"> 2990</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(adj_tets, adj_tets_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2991</span>          <a class="code hl_class" href="class_range.html">Range</a> adj_edges;</div>
<div class="line"><span class="lineno"> 2992</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(adj_tets_nodes, 1, <span class="keyword">false</span>, adj_edges,</div>
<div class="line"><span class="lineno"> 2993</span>                                      moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2994</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> ait : adj_edges) {</div>
<div class="line"><span class="lineno"> 2995</span>            <span class="keyword">auto</span> miit = length_map.get&lt;1&gt;().find(ait);</div>
<div class="line"><span class="lineno"> 2996</span>            <span class="keywordflow">if</span> (miit != length_map.get&lt;1&gt;().end())</div>
<div class="line"><span class="lineno"> 2997</span>              (<span class="keyword">const_cast&lt;</span>LengthMapData &amp;<span class="keyword">&gt;</span>(*miit)).skip = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2998</span>          }</div>
<div class="line"><span class="lineno"> 2999</span>          nb_nodes_merged++;</div>
<div class="line"><span class="lineno"> 3000</span>          collapsed_edges.insert(mit-&gt;eDge);</div>
<div class="line"><span class="lineno"> 3001</span>        }</div>
<div class="line"><span class="lineno"> 3002</span> </div>
<div class="line"><span class="lineno"> 3003</span>        <span class="keywordflow">if</span> (nn &gt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(length_map.size() / fraction_level))</div>
<div class="line"><span class="lineno"> 3004</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3005</span>        <span class="keywordflow">if</span> (mit-&gt;qUality &gt; ave)</div>
<div class="line"><span class="lineno"> 3006</span>          <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3007</span>      }</div>
<div class="line"><span class="lineno"> 3008</span>    }</div>
<div class="line"><span class="lineno"> 3009</span> </div>
<div class="line"><span class="lineno"> 3010</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> merge_nodes.updateRangeByChilds(new_surf, edges_to_merge,</div>
<div class="line"><span class="lineno"> 3011</span>                                           not_merged_edges, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 3012</span> </div>
<div class="line"><span class="lineno"> 3013</span>    <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::verbose,</div>
<div class="line"><span class="lineno"> 3014</span>                <span class="stringliteral">&quot;(%d) Number of nodes merged %d ave q %3.4e min q %3.4e&quot;</span>, pp,</div>
<div class="line"><span class="lineno"> 3015</span>                nb_nodes_merged, ave, min);</div>
<div class="line"><span class="lineno"> 3016</span> </div>
<div class="line"><span class="lineno"> 3017</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 3018</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_merge_step(pp + 1, collapsed_edges);</div>
<div class="line"><span class="lineno"> 3019</span> </div>
<div class="line"><span class="lineno"> 3020</span>    <span class="keywordflow">if</span> (nb_nodes_merged == nb_nodes_merged_p)</div>
<div class="line"><span class="lineno"> 3021</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3022</span>    <span class="keywordflow">if</span> (min &gt; 1e-2 &amp;&amp; min == min_pp)</div>
<div class="line"><span class="lineno"> 3023</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3024</span>    <span class="keywordflow">if</span> (min &gt; ave0)</div>
<div class="line"><span class="lineno"> 3025</span>      <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno"> 3026</span> </div>
<div class="line"><span class="lineno"> 3027</span>    <a class="code hl_class" href="class_range.html">Range</a> adj_edges;</div>
<div class="line"><span class="lineno"> 3028</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(proc_tets, 1, <span class="keyword">false</span>, adj_edges,</div>
<div class="line"><span class="lineno"> 3029</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 3030</span>    edges_to_merge = intersect(edges_to_merge, adj_edges);</div>
<div class="line"><span class="lineno"> 3031</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Toplogy(m_field, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 3032</span>        .removeBadEdges(new_surf, proc_tets, fixed_edges, corner_nodes,</div>
<div class="line"><span class="lineno"> 3033</span>                        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>, edges_to_merge, not_merged_edges);</div>
<div class="line"><span class="lineno"> 3034</span>  }</div>
<div class="line"><span class="lineno"> 3035</span> </div>
<div class="line"><span class="lineno"> 3036</span>  <span class="keyword">auto</span> reconstruct_refined_ents = [&amp;]() {</div>
<div class="line"><span class="lineno"> 3037</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 3038</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a315359c2e34aac52f9fa976960b1a46d">reconstructMultiIndex</a>(*m_field.get_ref_ents());</div>
<div class="line"><span class="lineno"> 3039</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3040</span>  };</div>
<div class="line"><span class="lineno"> 3041</span> </div>
<div class="line"><span class="lineno"> 3042</span>  <span class="comment">// Add function which reconstruct core multi-index. Node merging is messy</span></div>
<div class="line"><span class="lineno"> 3043</span>  <span class="comment">// process and entity parent could be changed without notification to</span></div>
<div class="line"><span class="lineno"> 3044</span>  <span class="comment">// multi-index. TODO Issue has to be tracked down better, however in principle</span></div>
<div class="line"><span class="lineno"> 3045</span>  <span class="comment">// is better not to modify multi-index each time parent is changed, that makes</span></div>
<div class="line"><span class="lineno"> 3046</span>  <span class="comment">// code slow. Is better to do it in the bulk as below.</span></div>
<div class="line"><span class="lineno"> 3047</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> reconstruct_refined_ents();</div>
<div class="line"><span class="lineno"> 3048</span> </div>
<div class="line"><span class="lineno"> 3049</span>  <span class="keywordflow">if</span> (bit_ptr)</div>
<div class="line"><span class="lineno"> 3050</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;setBitRefLevel(proc_tets,</div>
<div class="line"><span class="lineno"> 3051</span>                                                                 *bit_ptr);</div>
<div class="line"><span class="lineno"> 3052</span> </div>
<div class="line"><span class="lineno"> 3053</span>  out_tets.merge(proc_tets);</div>
<div class="line"><span class="lineno"> 3054</span>  <a class="code hl_class" href="class_range.html">Range</a> adj_faces;</div>
<div class="line"><span class="lineno"> 3055</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(out_tets, 2, <span class="keyword">false</span>, adj_faces,</div>
<div class="line"><span class="lineno"> 3056</span>                              moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 3057</span>  new_surf = intersect(new_surf, adj_faces);</div>
<div class="line"><span class="lineno"> 3058</span> </div>
<div class="line"><span class="lineno"> 3059</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3060</span>}</div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00447">definitions.h:447</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00440">definitions.h:440</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa7fc3e87cd6f5fcd5770d87260ea8c1a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_FOR_LOOP_(MESHSET_MANAGER, IT)</div><div class="ttdoc">Iterator that loops over all the Cubit MeshSets in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="_meshsets_manager_8hpp_source.html#l00034">MeshsetsManager.hpp:34</a></div></div>
<div class="ttc" id="anamespace_f_tensor_html_ad4a6ecc7f7a6e3b3903a9cff27887f39"><div class="ttname"><a href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">FTensor::dd</a></div><div class="ttdeci">const Tensor2_symmetric_Expr&lt; const ddTensor0&lt; T, Dim, i, j &gt;, typename promote&lt; T, double &gt;::V, Dim, i, j &gt; dd(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index1, const Index&lt; j, Dim &gt; index2, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition:</b> <a href="dd_tensor0_8hpp_source.html#l00033">ddTensor0.hpp:33</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a315359c2e34aac52f9fa976960b1a46d"><div class="ttname"><a href="namespace_mo_f_e_m.html#a315359c2e34aac52f9fa976960b1a46d">MoFEM::reconstructMultiIndex</a></div><div class="ttdeci">MoFEMErrorCode reconstructMultiIndex(const MI &amp;mi, MO &amp;&amp;mo=Modify_change_nothing())</div><div class="ttdoc">Template used to reconstruct multi-index.</div><div class="ttdef"><b>Definition:</b> <a href="_templates_8hpp_source.html#l01734">Templates.hpp:1734</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a97177b5e49ae7783439f2237db188563"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a97177b5e49ae7783439f2237db188563">MoFEM::CutMeshInterface::LengthMapData_multi_index</a></div><div class="ttdeci">multi_index_container&lt; LengthMapData, indexed_by&lt; ordered_non_unique&lt; member&lt; LengthMapData, double, &amp;LengthMapData::lEngth &gt; &gt;, hashed_unique&lt; member&lt; LengthMapData, EntityHandle, &amp;LengthMapData::eDge &gt; &gt;, ordered_non_unique&lt; member&lt; LengthMapData, double, &amp;LengthMapData::qUality &gt; &gt; &gt; &gt; LengthMapData_multi_index</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8hpp_source.html#l00535">CutMeshInterface.hpp:535</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae575455a4cad61089229a473bbb14d66" name="ae575455a4cad61089229a473bbb14d66"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae575455a4cad61089229a473bbb14d66">&#9670;&#160;</a></span>mergeSurface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::mergeSurface </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>surface</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>merge surface entities </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">surface</td><td>entities which going to be added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00120">120</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  120</span>                                                                 {</div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">  122</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>.merge(<a class="code hl_namespace" href="namespacesurface.html">surface</a>);</div>
<div class="line"><span class="lineno">  123</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  124</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8446bcb36213697a1c86009044b44cef" name="a8446bcb36213697a1c86009044b44cef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8446bcb36213697a1c86009044b44cef">&#9670;&#160;</a></span>mergeVolumes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::mergeVolumes </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>volume</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>merge volume entities </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">volume</td><td>entities which going to be added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00126">126</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  126</span>                                                                {</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">  128</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>.merge(volume);</div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  130</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8e8a8509c57589e4de9b347821a9dd99" name="a8e8a8509c57589e4de9b347821a9dd99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8e8a8509c57589e4de9b347821a9dd99">&#9670;&#160;</a></span>moveMidNodesOnCutEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::moveMidNodesOnCutEdges </td>
          <td>(</td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>projecting of mid edge nodes on new mesh on surface </p>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l01447">1447</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1447</span>                                                              {</div>
<div class="line"><span class="lineno"> 1448</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 1449</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 1450</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1451</span> </div>
<div class="line"><span class="lineno"> 1452</span>  <span class="comment">// Range out_side_vertices;</span></div>
<div class="line"><span class="lineno"> 1453</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a>) {</div>
<div class="line"><span class="lineno"> 1454</span>    <span class="keywordtype">double</span> dist = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.dIst;</div>
<div class="line"><span class="lineno"> 1455</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> new_coors = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.rayPoint + dist * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.unitRayDir;</div>
<div class="line"><span class="lineno"> 1456</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 1457</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first, 1, &amp;new_coors[0]);</div>
<div class="line"><span class="lineno"> 1458</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1459</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.set_coords(&amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first, 1, &amp;new_coors[0]);</div>
<div class="line"><span class="lineno"> 1460</span>  }</div>
<div class="line"><span class="lineno"> 1461</span> </div>
<div class="line"><span class="lineno"> 1462</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1463</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0fcd2cc277293c8530dd28b24ddbe6e7" name="a0fcd2cc277293c8530dd28b24ddbe6e7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fcd2cc277293c8530dd28b24ddbe6e7">&#9670;&#160;</a></span>moveMidNodesOnTrimmedEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::moveMidNodesOnTrimmedEdges </td>
          <td>(</td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>move trimmed edges mid nodes </p>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l01465">1465</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1465</span>                                                                  {</div>
<div class="line"><span class="lineno"> 1466</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 1467</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 1468</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1469</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>) {</div>
<div class="line"><span class="lineno"> 1470</span>    <span class="keywordtype">double</span> dist = <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second.dIst;</div>
<div class="line"><span class="lineno"> 1471</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> new_coors = <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second.rayPoint + dist * <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second.unitRayDir;</div>
<div class="line"><span class="lineno"> 1472</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 1473</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.first, 1, &amp;new_coors[0]);</div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1475</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.set_coords(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.first, 1, &amp;new_coors[0]);</div>
<div class="line"><span class="lineno"> 1476</span>  }</div>
<div class="line"><span class="lineno"> 1477</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1478</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3028c39783a3c872e50a146b488929f9" name="a3028c39783a3c872e50a146b488929f9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3028c39783a3c872e50a146b488929f9">&#9670;&#160;</a></span>projectZeroDistanceEnts() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="class_range.html">Range</a> &amp; MoFEM::CutMeshInterface::projectZeroDistanceEnts </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00473">473</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  473</span>                                                      {</div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">zeroDistanceEnts</a>;</div>
<div class="line"><span class="lineno">  475</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a10dfa5939be386611e2719d98ea1d01e" name="a10dfa5939be386611e2719d98ea1d01e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10dfa5939be386611e2719d98ea1d01e">&#9670;&#160;</a></span>projectZeroDistanceEnts() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::projectZeroDistanceEnts </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>corner_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>geometry_tol</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>close_tol</em> = <code>0</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Find entities on cut surface which can be projected. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fixed_edges</td><td>pointer to fix edges </td></tr>
    <tr><td class="paramname">corner_nodes</td><td>pointer to corner nodes </td></tr>
    <tr><td class="paramname">close</td><td>tolerance is tolerance how close entities has to be </td></tr>
    <tr><td class="paramname">verb</td><td>verbosity level </td></tr>
    <tr><td class="paramname">debug</td><td>true for debuging purposes </td></tr>
  </table>
  </dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00991">991</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  993</span>                                                              {</div>
<div class="line"><span class="lineno">  994</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  995</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  996</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno">  997</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  998</span> </div>
<div class="line"><span class="lineno">  999</span>  <span class="keyword">auto</span> get_ent_adj = [&amp;moab](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>) {</div>
<div class="line"><span class="lineno"> 1000</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno"> 1001</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>)</div>
<div class="line"><span class="lineno"> 1002</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, <span class="keyword">true</span>, a);</div>
<div class="line"><span class="lineno"> 1003</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno"> 1004</span>  };</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>  <span class="keyword">auto</span> get_adj = [&amp;moab](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>) {</div>
<div class="line"><span class="lineno"> 1007</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno"> 1008</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>)</div>
<div class="line"><span class="lineno"> 1009</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(r, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, <span class="keyword">false</span>, a, moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 1010</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1011</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(r, a, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1012</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno"> 1013</span>  };</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>  <span class="keyword">auto</span> get_skin = [&amp;skin](<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line"><span class="lineno"> 1016</span>    <a class="code hl_class" href="class_range.html">Range</a> s;</div>
<div class="line"><span class="lineno"> 1017</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, r, <span class="keyword">false</span>, s);</div>
<div class="line"><span class="lineno"> 1018</span>    <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno"> 1019</span>  };</div>
<div class="line"><span class="lineno"> 1020</span> </div>
<div class="line"><span class="lineno"> 1021</span> </div>
<div class="line"><span class="lineno"> 1022</span>  <span class="keyword">auto</span> get_range = [](std::vector&lt;EntityHandle&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno"> 1023</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"><span class="lineno"> 1024</span>    <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.insert_list(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.begin(), <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.end());</div>
<div class="line"><span class="lineno"> 1025</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"><span class="lineno"> 1026</span>  };</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>  <span class="keyword">auto</span> get_coords = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno"> 1029</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> coords(3);</div>
<div class="line"><span class="lineno"> 1030</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 1031</span>    <span class="keywordflow">return</span> coords;</div>
<div class="line"><span class="lineno"> 1032</span>  };</div>
<div class="line"><span class="lineno"> 1033</span> </div>
<div class="line"><span class="lineno"> 1034</span>  Tag th_normal_dist;</div>
<div class="line"><span class="lineno"> 1035</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;DIST_SURFACE_NORMAL_VECTOR&quot;</span>, th_normal_dist);</div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>  <span class="keyword">auto</span> get_normal_dits = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line"><span class="lineno"> 1038</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> dist_vec(3);</div>
<div class="line"><span class="lineno"> 1039</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(th_normal_dist, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, &amp;*dist_vec.begin());</div>
<div class="line"><span class="lineno"> 1040</span>    <span class="keywordflow">return</span> dist_vec;</div>
<div class="line"><span class="lineno"> 1041</span>  };</div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>  <span class="keyword">auto</span> get_prj_point = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> edges,</div>
<div class="line"><span class="lineno"> 1044</span>                           <span class="keyword">const</span> <span class="keywordtype">double</span> geometry_tol) {</div>
<div class="line"><span class="lineno"> 1045</span>    <span class="keyword">auto</span> get_tuple = [](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> e, <span class="keyword">const</span> <span class="keywordtype">double</span> dist,</div>
<div class="line"><span class="lineno"> 1046</span>                        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) { <span class="keywordflow">return</span> std::make_tuple(e, dist, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>); };</div>
<div class="line"><span class="lineno"> 1047</span> </div>
<div class="line"><span class="lineno"> 1048</span>    std::tuple&lt;EntityHandle, double, double&gt; min_tuple{0, 0, 0};</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : edges) {</div>
<div class="line"><span class="lineno"> 1051</span>      <span class="keyword">auto</span> eit = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.find(e);</div>
<div class="line"><span class="lineno"> 1052</span>      <span class="keywordflow">if</span> (eit != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.end()) {</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>        <span class="keyword">auto</span> get_dist = [&amp;](<span class="keyword">auto</span> eit) {</div>
<div class="line"><span class="lineno"> 1055</span>          <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 1056</span>          <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 1057</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(eit-&gt;first, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1058</span>          <span class="keywordflow">if</span> (conn[0] == <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>)</div>
<div class="line"><span class="lineno"> 1059</span>            <span class="keywordflow">return</span> eit-&gt;second.dIst;</div>
<div class="line"><span class="lineno"> 1060</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (conn[1] == <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>)</div>
<div class="line"><span class="lineno"> 1061</span>            <span class="keywordflow">return</span> (eit-&gt;second.lEngth - eit-&gt;second.dIst);</div>
<div class="line"><span class="lineno"> 1062</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1063</span>            <a class="code hl_define" href="definitions_8h.html#af1d7ca96eafbfaebd5f26bf7fcc4c285">THROW_MESSAGE</a>(<span class="stringliteral">&quot;Data inconsistency&quot;</span>);</div>
<div class="line"><span class="lineno"> 1064</span>        };</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a> = get_dist(eit);</div>
<div class="line"><span class="lineno"> 1067</span>        <span class="keywordflow">if</span> (std::get&lt;0&gt;(min_tuple) == 0) {</div>
<div class="line"><span class="lineno"> 1068</span>          min_tuple = get_tuple(e, d, eit-&gt;second.lEngth);</div>
<div class="line"><span class="lineno"> 1069</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (std::get&lt;1&gt;(min_tuple) &gt; d) {</div>
<div class="line"><span class="lineno"> 1070</span>          min_tuple = get_tuple(e, d, eit-&gt;second.lEngth);</div>
<div class="line"><span class="lineno"> 1071</span>        }</div>
<div class="line"><span class="lineno"> 1072</span>      }</div>
<div class="line"><span class="lineno"> 1073</span>    }</div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span>    <span class="keyword">const</span> <span class="keyword">auto</span> geom_dist_vec = get_normal_dits(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1076</span>    <span class="keyword">const</span> <span class="keyword">auto</span> geom_tol = norm_2(geom_dist_vec);</div>
<div class="line"><span class="lineno"> 1077</span>    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = std::get&lt;2&gt;(min_tuple);</div>
<div class="line"><span class="lineno"> 1078</span> </div>
<div class="line"><span class="lineno"> 1079</span>    <span class="keywordflow">if</span> (geom_tol &lt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> * geometry_tol) {</div>
<div class="line"><span class="lineno"> 1080</span>      <span class="keywordflow">return</span> std::make_pair(get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>), <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1083</span>      <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a> = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.at(std::get&lt;0&gt;(min_tuple));</div>
<div class="line"><span class="lineno"> 1084</span>      <span class="keywordflow">return</span> std::make_pair(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a>(<a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.rayPoint + <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.dIst * <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.unitRayDir),</div>
<div class="line"><span class="lineno"> 1085</span>                            <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"><span class="lineno"> 1086</span>    }</div>
<div class="line"><span class="lineno"> 1087</span>  };</div>
<div class="line"><span class="lineno"> 1088</span> </div>
<div class="line"><span class="lineno"> 1089</span>  <span class="keyword">auto</span> get_in_range = [](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) { <span class="keywordflow">return</span> (<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.find(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) != <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.end()); };</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keyword">auto</span> project_nodes = [&amp;](<span class="keyword">auto</span> nodes_to_check) {</div>
<div class="line"><span class="lineno"> 1092</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1093</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;nodes_to_check.vtk&quot;</span>, nodes_to_check);</div>
<div class="line"><span class="lineno"> 1094</span> </div>
<div class="line"><span class="lineno"> 1095</span>    <span class="keyword">auto</span> get_fix_e = [](<span class="keyword">auto</span> fixed_edges) {</div>
<div class="line"><span class="lineno"> 1096</span>      <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 1097</span>        <span class="keywordflow">return</span> *fixed_edges;</div>
<div class="line"><span class="lineno"> 1098</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1099</span>        <span class="keywordflow">return</span> <a class="code hl_class" href="class_range.html">Range</a>();</div>
<div class="line"><span class="lineno"> 1100</span>    };</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>    <span class="keyword">const</span> <span class="keyword">auto</span> fix_e = get_fix_e(fixed_edges);</div>
<div class="line"><span class="lineno"> 1103</span>    <span class="keyword">const</span> <span class="keyword">auto</span> skin_e = get_adj(unite(get_skin(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>), <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>), 1);</div>
<div class="line"><span class="lineno"> 1104</span>    <span class="keyword">const</span> <span class="keyword">auto</span> cut_fix = intersect(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>, fix_e);</div>
<div class="line"><span class="lineno"> 1105</span>    <span class="keyword">const</span> <span class="keyword">auto</span> cut_skin = intersect(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>, skin_e);</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>    <a class="code hl_class" href="class_range.html">Range</a> corner_n;</div>
<div class="line"><span class="lineno"> 1108</span>    <span class="keywordflow">if</span> (corner_nodes)</div>
<div class="line"><span class="lineno"> 1109</span>      corner_n = intersect(*corner_nodes, nodes_to_check);</div>
<div class="line"><span class="lineno"> 1110</span>    <span class="keyword">auto</span> fixe_n = intersect(get_adj(fix_e, 0), nodes_to_check);</div>
<div class="line"><span class="lineno"> 1111</span>    <span class="keyword">auto</span> skin_n = intersect(get_adj(skin_e, 0), nodes_to_check);</div>
<div class="line"><span class="lineno"> 1112</span> </div>
<div class="line"><span class="lineno"> 1113</span>    std::vector&lt;std::pair&lt;EntityHandle, TreeData&gt;&gt; vertices_on_cut_edges;</div>
<div class="line"><span class="lineno"> 1114</span>    vertices_on_cut_edges.reserve(nodes_to_check.size());</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>    <span class="keyword">auto</span> add_zero_vertex = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">auto</span> &amp;&amp;new_pos) {</div>
<div class="line"><span class="lineno"> 1117</span>      <span class="keyword">auto</span> coords = get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line"><span class="lineno"> 1118</span>      <span class="keyword">auto</span> ray = new_pos - coords;</div>
<div class="line"><span class="lineno"> 1119</span>      <span class="keyword">auto</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = norm_2(ray);</div>
<div class="line"><span class="lineno"> 1120</span>      TreeData data;</div>
<div class="line"><span class="lineno"> 1121</span>      data.dIst = <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1122</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><span class="lineno"> 1123</span>        data.unitRayDir = ray / <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"><span class="lineno"> 1124</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1125</span>        data.dIst = 0;</div>
<div class="line"><span class="lineno"> 1126</span>        data.unitRayDir = ray;</div>
<div class="line"><span class="lineno"> 1127</span>      }</div>
<div class="line"><span class="lineno"> 1128</span>      data.rayPoint = coords;</div>
<div class="line"><span class="lineno"> 1129</span>      <span class="keywordflow">return</span> std::make_pair(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, data);</div>
<div class="line"><span class="lineno"> 1130</span>    };</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>    <span class="keyword">auto</span> intersect_v = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line"><span class="lineno"> 1133</span>      <span class="keywordflow">return</span> intersect(r, get_ent_adj(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1));</div>
<div class="line"><span class="lineno"> 1134</span>    };</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : nodes_to_check) {</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>      <span class="keyword">const</span> <span class="keyword">auto</span> e = intersect_v(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>);</div>
<div class="line"><span class="lineno"> 1139</span>      <span class="keywordflow">if</span> (!e.empty()) {</div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>        <span class="keywordflow">if</span> (get_in_range(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, corner_n)) {</div>
<div class="line"><span class="lineno"> 1142</span>          <span class="keyword">auto</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> = get_prj_point(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, e, 0);</div>
<div class="line"><span class="lineno"> 1143</span>          <span class="keywordflow">if</span> (norm_2(get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) - <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first) &lt; close_tol * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.second) {</div>
<div class="line"><span class="lineno"> 1144</span>            vertices_on_cut_edges.push_back(add_zero_vertex(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>)));</div>
<div class="line"><span class="lineno"> 1145</span>            <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1146</span>          }</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_in_range(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, fixe_n)) {</div>
<div class="line"><span class="lineno"> 1149</span>          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a> = intersect_v(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, cut_fix);</div>
<div class="line"><span class="lineno"> 1150</span>          <span class="keywordflow">if</span> (!<a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1151</span>            <span class="keyword">auto</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> = get_prj_point(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, b, geometry_tol);</div>
<div class="line"><span class="lineno"> 1152</span>            <span class="keywordflow">if</span> (norm_2(get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) - <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first) &lt; close_tol * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.second) {</div>
<div class="line"><span class="lineno"> 1153</span>              vertices_on_cut_edges.push_back(add_zero_vertex(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first));</div>
<div class="line"><span class="lineno"> 1154</span>              <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1155</span>            }</div>
<div class="line"><span class="lineno"> 1156</span> </div>
<div class="line"><span class="lineno"> 1157</span>          } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (get_in_range(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, skin_n)) {</div>
<div class="line"><span class="lineno"> 1158</span>            <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a> = intersect_v(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, cut_skin);</div>
<div class="line"><span class="lineno"> 1159</span>            <span class="keywordflow">if</span> (!<a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a>.empty()) {</div>
<div class="line"><span class="lineno"> 1160</span>              <span class="keyword">auto</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> = get_prj_point(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, b, geometry_tol);</div>
<div class="line"><span class="lineno"> 1161</span>              <span class="keywordflow">if</span> (norm_2(get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) - <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first) &lt; close_tol * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.second) {</div>
<div class="line"><span class="lineno"> 1162</span>                vertices_on_cut_edges.push_back(add_zero_vertex(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first));</div>
<div class="line"><span class="lineno"> 1163</span>                <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno"> 1164</span>              }</div>
<div class="line"><span class="lineno"> 1165</span>            }</div>
<div class="line"><span class="lineno"> 1166</span> </div>
<div class="line"><span class="lineno"> 1167</span>          }</div>
<div class="line"><span class="lineno"> 1168</span>        }</div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>        <span class="keyword">auto</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> = get_prj_point(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, e, geometry_tol);</div>
<div class="line"><span class="lineno"> 1171</span>        <span class="keywordflow">if</span> (norm_2(get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) - <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first) &lt; close_tol * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.second) {</div>
<div class="line"><span class="lineno"> 1172</span>          <span class="keywordflow">if</span> (get_in_range(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, fixe_n) || get_in_range(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, skin_n))</div>
<div class="line"><span class="lineno"> 1173</span>            vertices_on_cut_edges.push_back(add_zero_vertex(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, get_coords(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>)));</div>
<div class="line"><span class="lineno"> 1174</span>          <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 1175</span>            vertices_on_cut_edges.push_back(add_zero_vertex(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>.first));</div>
<div class="line"><span class="lineno"> 1176</span>          }</div>
<div class="line"><span class="lineno"> 1177</span>        }</div>
<div class="line"><span class="lineno"> 1178</span>        </div>
<div class="line"><span class="lineno"> 1179</span>    }</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>    <span class="keyword">auto</span> get_distances = [&amp;](<span class="keyword">auto</span> &amp;data) {</div>
<div class="line"><span class="lineno"> 1182</span>      std::map&lt;EntityHandle, double&gt; dist_map;</div>
<div class="line"><span class="lineno"> 1183</span>      <span class="keywordflow">if</span> (!data.empty()) {</div>
<div class="line"><span class="lineno"> 1184</span>        Tag <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><span class="lineno"> 1185</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;DIST_SURFACE_NORMAL_SIGNED&quot;</span>, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno"> 1186</span> </div>
<div class="line"><span class="lineno"> 1187</span>        std::vector&lt;EntityHandle&gt; verts;</div>
<div class="line"><span class="lineno"> 1188</span>        verts.reserve(data.size());</div>
<div class="line"><span class="lineno"> 1189</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : data)</div>
<div class="line"><span class="lineno"> 1190</span>          verts.emplace_back(<a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.first);</div>
<div class="line"><span class="lineno"> 1191</span>        std::vector&lt;double&gt; distances(verts.size());</div>
<div class="line"><span class="lineno"> 1192</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;*verts.begin(), verts.size(),</div>
<div class="line"><span class="lineno"> 1193</span>                                 &amp;*distances.begin());</div>
<div class="line"><span class="lineno"> 1194</span>        <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != verts.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)</div>
<div class="line"><span class="lineno"> 1195</span>          dist_map[verts[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]] = distances[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>];</div>
<div class="line"><span class="lineno"> 1196</span>      }</div>
<div class="line"><span class="lineno"> 1197</span>      <span class="keywordflow">return</span> dist_map;</div>
<div class="line"><span class="lineno"> 1198</span>    };</div>
<div class="line"><span class="lineno"> 1199</span> </div>
<div class="line"><span class="lineno"> 1200</span>    <span class="keyword">auto</span> dist_map = get_distances(vertices_on_cut_edges);</div>
<div class="line"><span class="lineno"> 1201</span>    <span class="keywordflow">if</span> (!dist_map.empty()) {</div>
<div class="line"><span class="lineno"> 1202</span>      <span class="keyword">auto</span> cmp = [&amp;dist_map](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, <span class="keyword">const</span> <span class="keyword">auto</span> &amp;<a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a>) {</div>
<div class="line"><span class="lineno"> 1203</span>        <span class="keywordflow">return</span> dist_map[<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>.first] &lt; dist_map[<a class="code hl_variable" href="namespace_electro_physiology.html#a1fe436402a5f686843b69639433d8ce9">b</a>.first];</div>
<div class="line"><span class="lineno"> 1204</span>      };</div>
<div class="line"><span class="lineno"> 1205</span>      std::sort(vertices_on_cut_edges.begin(), vertices_on_cut_edges.end(),</div>
<div class="line"><span class="lineno"> 1206</span>                cmp);</div>
<div class="line"><span class="lineno"> 1207</span>    }</div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>    <span class="keywordflow">return</span> vertices_on_cut_edges;</div>
<div class="line"><span class="lineno"> 1210</span>  };</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span>  <span class="keyword">auto</span> get_min_quality =</div>
<div class="line"><span class="lineno"> 1213</span>      [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;adj_tets,</div>
<div class="line"><span class="lineno"> 1214</span>          <span class="keyword">const</span> map&lt;EntityHandle, TreeData&gt; &amp;vertices_on_cut_edges,</div>
<div class="line"><span class="lineno"> 1215</span>          <span class="keyword">const</span> std::pair&lt;EntityHandle, TreeData&gt; *test_data_ptr) {</div>
<div class="line"><span class="lineno"> 1216</span>        <span class="keywordtype">double</span> min_q = 1;</div>
<div class="line"><span class="lineno"> 1217</span>        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : adj_tets) {</div>
<div class="line"><span class="lineno"> 1218</span>          <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 1219</span>          <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 1220</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.get_moab().get_connectivity(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 1221</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a6d261dceb89bbe340a2c40bb7f08e47d">VectorDouble12</a> coords(12);</div>
<div class="line"><span class="lineno"> 1222</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 1223</span> </div>
<div class="line"><span class="lineno"> 1224</span>          <span class="keyword">auto</span> set_new_coord = [](<span class="keyword">auto</span> <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>) {</div>
<div class="line"><span class="lineno"> 1225</span>            <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.rayPoint + <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.dIst * <a class="code hl_function" href="namespace_f_tensor.html#a1d0f17584c86640bd9683fe881c5dbe4">d</a>.unitRayDir;</div>
<div class="line"><span class="lineno"> 1226</span>          };</div>
<div class="line"><span class="lineno"> 1227</span> </div>
<div class="line"><span class="lineno"> 1228</span>          <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> : {0, 1, 2, 3}) {</div>
<div class="line"><span class="lineno"> 1229</span>            <span class="keyword">auto</span> n_coords = <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;coords[3 * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>], 3);</div>
<div class="line"><span class="lineno"> 1230</span>            <span class="keywordflow">if</span> (test_data_ptr) {</div>
<div class="line"><span class="lineno"> 1231</span>              <span class="keywordflow">if</span> (test_data_ptr-&gt;first == conn[<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>]) {</div>
<div class="line"><span class="lineno"> 1232</span>                noalias(n_coords) = set_new_coord(test_data_ptr-&gt;second);</div>
<div class="line"><span class="lineno"> 1233</span>              }</div>
<div class="line"><span class="lineno"> 1234</span>            }</div>
<div class="line"><span class="lineno"> 1235</span>            <span class="keyword">auto</span> mit = vertices_on_cut_edges.find(conn[<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>]);</div>
<div class="line"><span class="lineno"> 1236</span>            <span class="keywordflow">if</span> (mit != vertices_on_cut_edges.end()) {</div>
<div class="line"><span class="lineno"> 1237</span>              noalias(n_coords) = set_new_coord(mit-&gt;second);</div>
<div class="line"><span class="lineno"> 1238</span>            }</div>
<div class="line"><span class="lineno"> 1239</span>          }</div>
<div class="line"><span class="lineno"> 1240</span>          min_q = std::min(min_q, <a class="code hl_function" href="struct_mo_f_e_m_1_1_tools.html#aad9f4194435be50a6c0b32600e7789b4">Tools::volumeLengthQuality</a>(&amp;coords[0]));</div>
<div class="line"><span class="lineno"> 1241</span>        }</div>
<div class="line"><span class="lineno"> 1242</span>        <span class="keywordflow">return</span> min_q;</div>
<div class="line"><span class="lineno"> 1243</span>      };</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span>  <span class="keyword">auto</span> get_zero_distance_verts = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;&amp;vertices_on_cut_edges) {</div>
<div class="line"><span class="lineno"> 1246</span>    std::vector&lt;EntityHandle&gt; zero_dist_vec;</div>
<div class="line"><span class="lineno"> 1247</span>    zero_dist_vec.reserve(vertices_on_cut_edges.size());</div>
<div class="line"><span class="lineno"> 1248</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : vertices_on_cut_edges) {</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span>      <span class="keyword">auto</span> adj_tet = intersect(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, get_ent_adj(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>.first, 3));</div>
<div class="line"><span class="lineno"> 1251</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> q0 = get_min_quality(adj_tet, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a>, <span class="keyword">nullptr</span>);</div>
<div class="line"><span class="lineno"> 1252</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> q = get_min_quality(adj_tet, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a>, &amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line"><span class="lineno"> 1253</span>      <span class="keywordflow">if</span> (std::isnormal(q) &amp;&amp; (q / q0) &gt; <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a6b9776c73fa2731c98ee28deab409ed7">projectEntitiesQualityTrashold</a>) {</div>
<div class="line"><span class="lineno"> 1254</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a>[<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>.first] = <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>.second;</div>
<div class="line"><span class="lineno"> 1255</span>        zero_dist_vec.push_back(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>.first);</div>
<div class="line"><span class="lineno"> 1256</span>      }</div>
<div class="line"><span class="lineno"> 1257</span>    }</div>
<div class="line"><span class="lineno"> 1258</span>    <span class="keywordflow">return</span> zero_dist_vec;</div>
<div class="line"><span class="lineno"> 1259</span>  };</div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>  <span class="keyword">auto</span> vol_cut_ents = intersect(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, get_adj(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>, 3));</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>  <span class="keyword">auto</span> get_zero_distant_ents = [&amp;](<span class="keyword">auto</span> bridge_ents, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>,</div>
<div class="line"><span class="lineno"> 1264</span>                                   <span class="keyword">const</span> <span class="keywordtype">int</span> bridge_dim) {</div>
<div class="line"><span class="lineno"> 1265</span>    <span class="keyword">auto</span> ents =</div>
<div class="line"><span class="lineno"> 1266</span>        intersect(get_adj(bridge_ents, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>), get_adj(vol_cut_ents, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>));</div>
<div class="line"><span class="lineno"> 1267</span>    <span class="keyword">auto</span> ents_to_remove =</div>
<div class="line"><span class="lineno"> 1268</span>        get_adj(subtract(get_adj(ents, bridge_dim), bridge_ents), <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>);</div>
<div class="line"><span class="lineno"> 1269</span>    <span class="keywordflow">return</span> subtract(ents, ents_to_remove);</div>
<div class="line"><span class="lineno"> 1270</span>  };</div>
<div class="line"><span class="lineno"> 1271</span> </div>
<div class="line"><span class="lineno"> 1272</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a95629e9a8eaeb96f050d7c3d3e334a99">verticesOnCutEdges</a>.clear();</div>
<div class="line"><span class="lineno"> 1273</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a>.clear();</div>
<div class="line"><span class="lineno"> 1274</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a>.merge(</div>
<div class="line"><span class="lineno"> 1275</span>      get_range(get_zero_distance_verts(project_nodes(get_adj(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>, 0)))));</div>
<div class="line"><span class="lineno"> 1276</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">zeroDistanceEnts</a> = subtract(get_zero_distant_ents(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a>, 2, 0),</div>
<div class="line"><span class="lineno"> 1277</span>                              get_skin(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>));</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1280</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;zero_distance_verts.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a>);</div>
<div class="line"><span class="lineno"> 1281</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1282</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;zero_distance_ents.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">zeroDistanceEnts</a>);</div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#af8f5e939ef8a867d87ac6bc3b32e18ec">zeroDistanceVerts</a>) {</div>
<div class="line"><span class="lineno"> 1285</span>    <span class="keyword">auto</span> adj_edges = get_ent_adj(f, 1);</div>
<div class="line"><span class="lineno"> 1286</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : adj_edges) {</div>
<div class="line"><span class="lineno"> 1287</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>.erase(e);</div>
<div class="line"><span class="lineno"> 1288</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad277d5b4f2c7eb02619acca528e60f1c">edgesToCut</a>.erase(e);</div>
<div class="line"><span class="lineno"> 1289</span>    }</div>
<div class="line"><span class="lineno"> 1290</span>  }</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno"> 1293</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;cut_edges_to_cut.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>);</div>
<div class="line"><span class="lineno"> 1294</span> </div>
<div class="line"><span class="lineno"> 1295</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 1296</span>}</div>
<div class="ttc" id="adefinitions_8h_html_af1d7ca96eafbfaebd5f26bf7fcc4c285"><div class="ttname"><a href="definitions_8h.html#af1d7ca96eafbfaebd5f26bf7fcc4c285">THROW_MESSAGE</a></div><div class="ttdeci">#define THROW_MESSAGE(msg)</div><div class="ttdoc">Throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00561">definitions.h:561</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a555f150b1952dcf28dcde410e4138c9d" name="a555f150b1952dcf28dcde410e4138c9d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a555f150b1952dcf28dcde410e4138c9d">&#9670;&#160;</a></span>query_interface()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::query_interface </td>
          <td>(</td>
          <td class="paramtype">boost::typeindex::type_index&#160;</td>
          <td class="paramname"><em>type_index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html">UnknownInterface</a> **&#160;</td>
          <td class="paramname"><em>iface</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="struct_mo_f_e_m_1_1_unknown_interface.html#a525e4d5a451a5bb8c5437d0dd2588de6">MoFEM::UnknownInterface</a>.</p>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00016">16</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   17</span>                                                                  {</div>
<div class="line"><span class="lineno">   18</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">   19</span>  *iface = <span class="keyword">const_cast&lt;</span><a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1679da765e869dc8fd23fe08daaab8e">CutMeshInterface</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">   20</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">   21</span>}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ad1679da765e869dc8fd23fe08daaab8e"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1679da765e869dc8fd23fe08daaab8e">MoFEM::CutMeshInterface::CutMeshInterface</a></div><div class="ttdeci">CutMeshInterface(const MoFEM::Core &amp;core)</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00023">CutMeshInterface.cpp:23</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6cdd41a72a83c1e08ff57742b85da95" name="ae6cdd41a72a83c1e08ff57742b85da95"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6cdd41a72a83c1e08ff57742b85da95">&#9670;&#160;</a></span>refineMesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::refineMesh </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>init_bit_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>surf_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>front_levels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edges</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>verb</em> = <code><a class="el" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Refine and set level sets. </p>
<dl class="section note"><dt>Note</dt><dd>Should be run befor cutting</dd></dl>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">refine_front</td><td>refine nodes at front </td></tr>
    <tr><td class="paramname">update_front</td><td>update level set at front </td></tr>
    <tr><td class="paramname">init_bit_level</td><td>inital bit ref level to store refined meshes </td></tr>
    <tr><td class="paramname">surf_levels</td><td>number of mesh surface refinement </td></tr>
    <tr><td class="paramname">front_levels</td><td></td></tr>
    <tr><td class="paramname">fixed_edges</td><td></td></tr>
    <tr><td class="paramname">verb</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a34">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00809">809</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  813</span>                                                              {</div>
<div class="line"><span class="lineno">  814</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  815</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  816</span>  MeshRefinement *refiner;</div>
<div class="line"><span class="lineno">  817</span>  BitRefManager *bit_ref_manager;</div>
<div class="line"><span class="lineno">  818</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  819</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface(refiner);</div>
<div class="line"><span class="lineno">  820</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface(bit_ref_manager);</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>  <span class="keyword">auto</span> add_bit = [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><span class="lineno">  823</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  824</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_ref_manager-&gt;addBitRefLevel(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>),</div>
<div class="line"><span class="lineno">  825</span>                                           verb);</div>
<div class="line"><span class="lineno">  826</span>    <a class="code hl_class" href="class_range.html">Range</a> adj_ents;</div>
<div class="line"><span class="lineno">  827</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : {2, 1, 0}) {</div>
<div class="line"><span class="lineno">  828</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, d, <span class="keyword">true</span>, adj_ents,</div>
<div class="line"><span class="lineno">  829</span>                                  moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  830</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_ref_manager-&gt;addBitRefLevel(adj_ents, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>),</div>
<div class="line"><span class="lineno">  831</span>                                             verb);</div>
<div class="line"><span class="lineno">  832</span>    }</div>
<div class="line"><span class="lineno">  833</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  834</span>  };</div>
<div class="line"><span class="lineno">  835</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_bit(init_bit_level);</div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>  <span class="keyword">auto</span> update_range = [&amp;](<a class="code hl_class" href="class_range.html">Range</a> *r_ptr) {</div>
<div class="line"><span class="lineno">  838</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">if</span> (r_ptr) {</div>
<div class="line"><span class="lineno">  840</span>      <a class="code hl_class" href="class_range.html">Range</a> childs;</div>
<div class="line"><span class="lineno">  841</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_ref_manager-&gt;updateRangeByChildren(*r_ptr, childs);</div>
<div class="line"><span class="lineno">  842</span>      r_ptr-&gt;merge(childs);</div>
<div class="line"><span class="lineno">  843</span>    }</div>
<div class="line"><span class="lineno">  844</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  845</span>  };</div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>  <span class="keyword">auto</span> refine = [&amp;](<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> tets) {</div>
<div class="line"><span class="lineno">  848</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  849</span>    <a class="code hl_class" href="class_range.html">Range</a> verts;</div>
<div class="line"><span class="lineno">  850</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(tets, verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  851</span>    <a class="code hl_class" href="class_range.html">Range</a> ref_edges;</div>
<div class="line"><span class="lineno">  852</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(verts, 1, <span class="keyword">true</span>, ref_edges,</div>
<div class="line"><span class="lineno">  853</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refiner-&gt;addVerticesInTheMiddleOfEdges(ref_edges, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><span class="lineno">  856</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refiner-&gt;refineTets(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, verb);</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> update_range(fixed_edges);</div>
<div class="line"><span class="lineno">  859</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> update_range(&amp;<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>);</div>
<div class="line"><span class="lineno">  860</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;MeshsetsManager&gt;()</div>
<div class="line"><span class="lineno">  861</span>        -&gt;updateAllMeshsetsByEntitiesChildren(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>    <a class="code hl_class" href="class_range.html">Range</a> bit_tets;</div>
<div class="line"><span class="lineno">  864</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno">  865</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, bit_tets);</div>
<div class="line"><span class="lineno">  866</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a> = intersect(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>, bit_tets);</div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>    <a class="code hl_class" href="class_range.html">Range</a> bit_edges;</div>
<div class="line"><span class="lineno">  869</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno">  870</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE, bit_edges);</div>
<div class="line"><span class="lineno">  871</span>    <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno">  872</span>      *fixed_edges = intersect(*fixed_edges, bit_edges);</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  875</span>  };</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = init_bit_level; ll != init_bit_level + surf_levels; ++ll) {</div>
<div class="line"><span class="lineno">  878</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">findLevelSetVolumes</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  879</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1),</div>
<div class="line"><span class="lineno">  880</span>                  unite(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac9552b1279ac23cc91e58d42dafe7ce6">cutSurfaceVolumes</a>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a>));</div>
<div class="line"><span class="lineno">  881</span>  }</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = init_bit_level + surf_levels;</div>
<div class="line"><span class="lineno">  884</span>       ll != init_bit_level + surf_levels + front_levels; ++ll) {</div>
<div class="line"><span class="lineno">  885</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">findLevelSetVolumes</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  886</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(ll + 1), <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a208b503c4a559549484c8cae4af2b1aa">cutFrontVolumes</a>);</div>
<div class="line"><span class="lineno">  887</span>  }</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0dec0dd3ed43e1b5eacc618d4fa72a63">findLevelSetVolumes</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  892</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;refinedVolume.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>);</div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  895</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aacc6ac8832948e067b7b7dadf50c53d1" name="aacc6ac8832948e067b7b7dadf50c53d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aacc6ac8832948e067b7b7dadf50c53d1">&#9670;&#160;</a></span>removePathologicalFrontTris()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::removePathologicalFrontTris </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>split_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>ents</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Remove pathological elements on surface internal front. </p>
<p >Internal surface skin is a set of edges in iterior of the body on boundary of surface. This set of edges is called surface front. If surface face has three nodes on surface front, non of the face nodes is split and should be removed from surface if it is going to be split.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">split_bit</td><td>split bit level </td></tr>
    <tr><td class="paramname">bit</td><td>bit level of split mesh </td></tr>
    <tr><td class="paramname">ents</td><td>ents on the surface which is going to be split </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l02235">2235</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2236</span>                                                           {</div>
<div class="line"><span class="lineno"> 2237</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 2238</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 2239</span>  PrismInterface *interface;</div>
<div class="line"><span class="lineno"> 2240</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2241</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface(interface);</div>
<div class="line"><span class="lineno"> 2242</span>  <span class="comment">// Remove tris on surface front</span></div>
<div class="line"><span class="lineno"> 2243</span>  {</div>
<div class="line"><span class="lineno"> 2244</span>    <a class="code hl_class" href="class_range.html">Range</a> front_tris;</div>
<div class="line"><span class="lineno"> 2245</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><span class="lineno"> 2246</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><span class="lineno"> 2247</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><span class="lineno"> 2248</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> interface-&gt;findFacesWithThreeNodesOnInternalSurfaceSkin(</div>
<div class="line"><span class="lineno"> 2249</span>        meshset, split_bit, <span class="keyword">true</span>, front_tris);</div>
<div class="line"><span class="lineno"> 2250</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><span class="lineno"> 2251</span>    ents = subtract(ents, front_tris);</div>
<div class="line"><span class="lineno"> 2252</span>  }</div>
<div class="line"><span class="lineno"> 2253</span>  <span class="comment">// Remove entities on skin</span></div>
<div class="line"><span class="lineno"> 2254</span>  <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line"><span class="lineno"> 2255</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 2256</span>      split_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets);</div>
<div class="line"><span class="lineno"> 2257</span>  <span class="comment">// Remove entities on skin</span></div>
<div class="line"><span class="lineno"> 2258</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno"> 2259</span>  <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line"><span class="lineno"> 2260</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, tets_skin);</div>
<div class="line"><span class="lineno"> 2261</span>  ents = subtract(ents, tets_skin);</div>
<div class="line"><span class="lineno"> 2262</span> </div>
<div class="line"><span class="lineno"> 2263</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2264</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a99386261dc7636e7ccfd8348a311ef7c" name="a99386261dc7636e7ccfd8348a311ef7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a99386261dc7636e7ccfd8348a311ef7c">&#9670;&#160;</a></span>saveCutEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::saveCutEdges </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>prefix</em> = <code>&quot;&quot;</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l03147">3147</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3147</span>                                                                    {</div>
<div class="line"><span class="lineno"> 3148</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 3149</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 3150</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 3151</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(prefix + <span class="stringliteral">&quot;out_vol.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a>);</div>
<div class="line"><span class="lineno"> 3152</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(prefix + <span class="stringliteral">&quot;out_surface.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>);</div>
<div class="line"><span class="lineno"> 3153</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(prefix + <span class="stringliteral">&quot;out_cut_edges.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#afd47f33b2d5fb21c26ddf80444360bba">cutEdges</a>);</div>
<div class="line"><span class="lineno"> 3154</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(prefix + <span class="stringliteral">&quot;out_cut_new_volumes.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>);</div>
<div class="line"><span class="lineno"> 3155</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(prefix + <span class="stringliteral">&quot;out_cut_new_surfaces.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>);</div>
<div class="line"><span class="lineno"> 3156</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(prefix + <span class="stringliteral">&quot;out_cut_zero_distance_ents.vtk&quot;</span>,</div>
<div class="line"><span class="lineno"> 3157</span>                        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a86c2b9230209eebcf507ba5ca4e43c2c">zeroDistanceEnts</a>);</div>
<div class="line"><span class="lineno"> 3158</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3159</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9a8a8242b3e6eeb4de3ab284dd9933b9" name="a9a8a8242b3e6eeb4de3ab284dd9933b9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9a8a8242b3e6eeb4de3ab284dd9933b9">&#9670;&#160;</a></span>saveTrimEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::saveTrimEdges </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l03161">3161</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3161</span>                                               {</div>
<div class="line"><span class="lineno"> 3162</span>  moab::Interface &amp;moab = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;CoreInterface&gt;()-&gt;get_moab();</div>
<div class="line"><span class="lineno"> 3163</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 3164</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;out_trim_surface.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>);</div>
<div class="line"><span class="lineno"> 3165</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;out_trim_new_volumes.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">trimNewVolumes</a>);</div>
<div class="line"><span class="lineno"> 3166</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;out_trim_new_surfaces.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>);</div>
<div class="line"><span class="lineno"> 3167</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;out_trim_edges.vtk&quot;</span>, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>);</div>
<div class="line"><span class="lineno"> 3168</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3169</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad2bf7c3c4320b94832923df44d30e45" name="aad2bf7c3c4320b94832923df44d30e45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad2bf7c3c4320b94832923df44d30e45">&#9670;&#160;</a></span>setConstrainSurface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::setConstrainSurface </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>surf</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Set the constrain surface object. </p>
<p >Add surfaces which are restricted by mesh cut. <a class="el" href="struct_example.html" title="[Example]">Example</a> of surface which needs to be respected is an interface, the boundary between two materials, or crack surface.</p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">surf</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00114">114</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  114</span>                                                                     {</div>
<div class="line"><span class="lineno">  115</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">  116</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a> = surf;</div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  118</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2d2b84113a4d8dceb7476b648d01bdab" name="a2d2b84113a4d8dceb7476b648d01bdab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d2b84113a4d8dceb7476b648d01bdab">&#9670;&#160;</a></span>setCoords()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::setCoords </td>
          <td>(</td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>bit</em> = <code><a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>()</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>mask</em> = <code><a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set coords from tag </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">th</td><td>tag handle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a40">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l03130">3130</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3131</span>                                                                   {</div>
<div class="line"><span class="lineno"> 3132</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 3133</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 3134</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 3135</span>  <a class="code hl_class" href="class_range.html">Range</a> nodes;</div>
<div class="line"><span class="lineno"> 3136</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.none())</div>
<div class="line"><span class="lineno"> 3137</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(0, MBVERTEX, nodes);</div>
<div class="line"><span class="lineno"> 3138</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3139</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 3140</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, mask, MBVERTEX, nodes);</div>
<div class="line"><span class="lineno"> 3141</span>  std::vector&lt;double&gt; coords(3 * nodes.size());</div>
<div class="line"><span class="lineno"> 3142</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 3143</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.set_coords(nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 3144</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3145</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0c7c582d842a5540d10cc8d84c0c3486" name="a0c7c582d842a5540d10cc8d84c0c3486"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0c7c582d842a5540d10cc8d84c0c3486">&#9670;&#160;</a></span>setFront()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::setFront </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>surface</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00036">36</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   36</span>                                                           {</div>
<div class="line"><span class="lineno">   37</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">   38</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a> = front;</div>
<div class="line"><span class="lineno">   39</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">   40</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5691afdb9be3879de243aeea26c934c9" name="a5691afdb9be3879de243aeea26c934c9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5691afdb9be3879de243aeea26c934c9">&#9670;&#160;</a></span>setSurface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::setSurface </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>surface</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set surface entities </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">surface</td><td>entities which going to be added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00042">42</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   42</span>                                                               {</div>
<div class="line"><span class="lineno">   43</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">   44</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a> = <a class="code hl_namespace" href="namespacesurface.html">surface</a>;</div>
<div class="line"><span class="lineno">   45</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">   46</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8c2be86d34af5f6c71e5d7d2696b954" name="ac8c2be86d34af5f6c71e5d7d2696b954"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8c2be86d34af5f6c71e5d7d2696b954">&#9670;&#160;</a></span>setTagData()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::setTagData </td>
          <td>(</td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>bit</em> = <code><a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>()</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set coords to tag </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">th</td><td>tag handle </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a38">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l03114">3114</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 3114</span>                                                                         {</div>
<div class="line"><span class="lineno"> 3115</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 3116</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 3117</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 3118</span>  <a class="code hl_class" href="class_range.html">Range</a> nodes;</div>
<div class="line"><span class="lineno"> 3119</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.none())</div>
<div class="line"><span class="lineno"> 3120</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(0, MBVERTEX, nodes);</div>
<div class="line"><span class="lineno"> 3121</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 3122</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 3123</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBVERTEX, nodes);</div>
<div class="line"><span class="lineno"> 3124</span>  std::vector&lt;double&gt; coords(3 * nodes.size());</div>
<div class="line"><span class="lineno"> 3125</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 3126</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, nodes, &amp;coords[0]);</div>
<div class="line"><span class="lineno"> 3127</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 3128</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac49c841036ab310c3ade79eff45ddc1f" name="ac49c841036ab310c3ade79eff45ddc1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac49c841036ab310c3ade79eff45ddc1f">&#9670;&#160;</a></span>setVolume()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::setVolume </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>volume</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>set volume entities </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">volume</td><td>entities which going to be added </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>
<dl class="section examples"><dt>Examples</dt><dd><a class="el" href="mesh_cut_8cpp-example.html#a31">mesh_cut.cpp</a>.</dd>
</dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00108">108</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  108</span>                                                             {</div>
<div class="line"><span class="lineno">  109</span>  <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><span class="lineno">  110</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a1995cac02879c652163074223c5fb296">vOlume</a> = volume;</div>
<div class="line"><span class="lineno">  111</span>  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="lineno">  112</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9ccec2b7a1b94d021aedeccc2047c536" name="a9ccec2b7a1b94d021aedeccc2047c536"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9ccec2b7a1b94d021aedeccc2047c536">&#9670;&#160;</a></span>snapSurfaceSkinToEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::snapSurfaceSkinToEdges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>rel_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>abs_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00132">132</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  136</span>                                                                          {</div>
<div class="line"><span class="lineno">  137</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  138</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  <span class="comment">// Get cutting surface skin</span></div>
<div class="line"><span class="lineno">  142</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno">  143</span>  <a class="code hl_class" href="class_range.html">Range</a> surface_skin;</div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aedb15b073b44bdf2cd4d20fbc19a8060">snapSurfaceToEdges</a>(surface_skin, fixed_edges, rel_tol, abs_tol, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>,</div>
<div class="line"><span class="lineno">  147</span>                            <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  150</span>}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aedb15b073b44bdf2cd4d20fbc19a8060"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aedb15b073b44bdf2cd4d20fbc19a8060">MoFEM::CutMeshInterface::snapSurfaceToEdges</a></div><div class="ttdeci">MoFEMErrorCode snapSurfaceToEdges(const Range surface_edges, const Range fixed_edges, const double rel_tol, const double abs_tol, Tag th=nullptr, const bool debug=false)</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00152">CutMeshInterface.cpp:152</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aedb15b073b44bdf2cd4d20fbc19a8060" name="aedb15b073b44bdf2cd4d20fbc19a8060"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aedb15b073b44bdf2cd4d20fbc19a8060">&#9670;&#160;</a></span>snapSurfaceToEdges()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::snapSurfaceToEdges </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>surface_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a>&#160;</td>
          <td class="paramname"><em>fixed_edges</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>rel_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>abs_tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>nullptr</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00152">152</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  156</span>                                                                              {</div>
<div class="line"><span class="lineno">  157</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  158</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="lineno">  160</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>  map&lt;EntityHandle, double&gt; map_verts_length;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : surface_edges) {</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno">  166</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn_skin;</div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(f, conn_skin, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  168</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a5086bdfa8de362615048f470022a9898">VectorDouble6</a> coords_skin(6);</div>
<div class="line"><span class="lineno">  169</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno">  170</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn_skin, num_nodes, &amp;coords_skin[0]);</div>
<div class="line"><span class="lineno">  171</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  172</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn_skin, num_nodes, &amp;coords_skin[0]);</div>
<div class="line"><span class="lineno">  173</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt; t_n0(</div>
<div class="line"><span class="lineno">  174</span>        &amp;coords_skin[0], &amp;coords_skin[1], &amp;coords_skin[2]);</div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt; t_n1(</div>
<div class="line"><span class="lineno">  176</span>        &amp;coords_skin[3], &amp;coords_skin[4], &amp;coords_skin[5]);</div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_skin_delta;</div>
<div class="line"><span class="lineno">  178</span>    t_skin_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_n1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_n0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"><span class="lineno">  179</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> skin_edge_length = sqrt(t_skin_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_skin_delta(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 2; ++nn) {</div>
<div class="line"><span class="lineno">  181</span>      <span class="keyword">auto</span> it = map_verts_length.find(conn_skin[nn]);</div>
<div class="line"><span class="lineno">  182</span>      <span class="keywordflow">if</span> (it != map_verts_length.end())</div>
<div class="line"><span class="lineno">  183</span>        it-&gt;second = std::min(it-&gt;second, skin_edge_length);</div>
<div class="line"><span class="lineno">  184</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  185</span>        map_verts_length[conn_skin[nn]] = skin_edge_length;</div>
<div class="line"><span class="lineno">  186</span>    }</div>
<div class="line"><span class="lineno">  187</span>  }</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : map_verts_length) {</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_n;</div>
<div class="line"><span class="lineno">  192</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno">  193</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first, 1, &amp;t_n(0));</div>
<div class="line"><span class="lineno">  194</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  195</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(&amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first, 1, &amp;t_n(0));</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    <span class="keywordtype">double</span> min_dist = rel_tol * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second;</div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_min_coords;</div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;Tools&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><span class="lineno">  200</span>        &amp;t_n(0), 1, fixed_edges, &amp;min_dist, &amp;t_min_coords(0));</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">if</span> (min_dist &lt; rel_tol * <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second || min_dist &lt; abs_tol) {</div>
<div class="line"><span class="lineno">  203</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><span class="lineno">  204</span>        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;Snap &quot;</span> &lt;&lt; min_dist;</div>
<div class="line"><span class="lineno">  205</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno">  206</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first, 1, &amp;t_min_coords(0));</div>
<div class="line"><span class="lineno">  207</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  208</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.set_coords(&amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.first, 1, &amp;t_min_coords(0));</div>
<div class="line"><span class="lineno">  209</span>    }</div>
<div class="line"><span class="lineno">  210</span>  }</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  213</span>}</div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition:</b> <a href="_log_manager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a72dd731f79c384927ec506eb5ae759f7" name="a72dd731f79c384927ec506eb5ae759f7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a72dd731f79c384927ec506eb5ae759f7">&#9670;&#160;</a></span>splitSides()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::splitSides </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>split_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="class_range.html">Range</a> &amp;&#160;</td>
          <td class="paramname"><em>ents</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>split sides </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">split_bit</td><td>split bit level </td></tr>
    <tr><td class="paramname">bit</td><td>bit level of split mesh </td></tr>
    <tr><td class="paramname">ents</td><td>ents on the surface which is going to be split </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l02266">2266</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2268</span>                                                                       {</div>
<div class="line"><span class="lineno"> 2269</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 2270</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 2271</span>  PrismInterface *interface;</div>
<div class="line"><span class="lineno"> 2272</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2273</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface(interface);</div>
<div class="line"><span class="lineno"> 2274</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_volume;</div>
<div class="line"><span class="lineno"> 2275</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_volume);</div>
<div class="line"><span class="lineno"> 2276</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 2277</span>      split_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, meshset_volume);</div>
<div class="line"><span class="lineno"> 2278</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_surface;</div>
<div class="line"><span class="lineno"> 2279</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_surface);</div>
<div class="line"><span class="lineno"> 2280</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_surface, ents);</div>
<div class="line"><span class="lineno"> 2281</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> interface-&gt;getSides(meshset_surface, split_bit, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2282</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> interface-&gt;splitSides(meshset_volume, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, meshset_surface, <span class="keyword">true</span>,</div>
<div class="line"><span class="lineno"> 2283</span>                               <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2284</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_volume, 1);</div>
<div class="line"><span class="lineno"> 2285</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_surface, 1);</div>
<div class="line"><span class="lineno"> 2286</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>) {</div>
<div class="line"><span class="lineno"> 2287</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms;</div>
<div class="line"><span class="lineno"> 2288</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 2289</span>        <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, prisms);</div>
<div class="line"><span class="lineno"> 2290</span>    <span class="keywordflow">for</span> (Range::iterator pit = prisms.begin(); pit != prisms.end(); pit++) {</div>
<div class="line"><span class="lineno"> 2291</span>      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><span class="lineno"> 2292</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><span class="lineno"> 2293</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(*pit, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2294</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> data(3, 3);</div>
<div class="line"><span class="lineno"> 2295</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, conn, 3, &amp;data(0, 0));</div>
<div class="line"><span class="lineno"> 2296</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, &amp;conn[3], 3, &amp;data(0, 0));</div>
<div class="line"><span class="lineno"> 2297</span>    }</div>
<div class="line"><span class="lineno"> 2298</span>  }</div>
<div class="line"><span class="lineno"> 2299</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2300</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2a17e2e37581b566c13d274d10e58b34" name="a2a17e2e37581b566c13d274d10e58b34"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2a17e2e37581b566c13d274d10e58b34">&#9670;&#160;</a></span>trimEdgesInTheMiddle()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::trimEdgesInTheMiddle </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>trim edges </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">bit</td><td>bit level of the trimmed mesh </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>error code </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l01969">1969</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1970</span>                                                                        {</div>
<div class="line"><span class="lineno"> 1971</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 1972</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 1973</span>  MeshRefinement *refiner;</div>
<div class="line"><span class="lineno"> 1974</span>  <span class="keyword">auto</span> ref_ents_ptr = m_field.get_ref_ents();</div>
<div class="line"><span class="lineno"> 1975</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 1976</span> </div>
<div class="line"><span class="lineno"> 1977</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface(refiner);</div>
<div class="line"><span class="lineno"> 1978</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refiner-&gt;addVerticesInTheMiddleOfEdges(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a7010ac51af96c46b6038ba966a77012a">trimEdges</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><span class="lineno"> 1979</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refiner-&gt;refineTets(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a4e149175ff1d5e5086a6b36dc1477ca1">cutNewVolumes</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno"> 1980</span> </div>
<div class="line"><span class="lineno"> 1981</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">trimNewVolumes</a>.clear();</div>
<div class="line"><span class="lineno"> 1982</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 1983</span>      <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">trimNewVolumes</a>);</div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>  <span class="keywordflow">for</span> (map&lt;EntityHandle, TreeData&gt;::iterator mit = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>.begin();</div>
<div class="line"><span class="lineno"> 1986</span>       mit != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5953d82956ff923572fe91b1d967c0d9">edgesToTrim</a>.end(); mit++) {</div>
<div class="line"><span class="lineno"> 1987</span>    <span class="keyword">auto</span> vit = ref_ents_ptr-&gt;get&lt;Composite_ParentEnt_And_EntType_mi_tag&gt;().find(</div>
<div class="line"><span class="lineno"> 1988</span>        boost::make_tuple(MBVERTEX, mit-&gt;first));</div>
<div class="line"><span class="lineno"> 1989</span>    <span class="keywordflow">if</span> (vit ==</div>
<div class="line"><span class="lineno"> 1990</span>        ref_ents_ptr-&gt;get&lt;Composite_ParentEnt_And_EntType_mi_tag&gt;().end())</div>
<div class="line"><span class="lineno"> 1991</span>      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><span class="lineno"> 1992</span>              <span class="stringliteral">&quot;No vertex on trim edges, that make no sense&quot;</span>);</div>
<div class="line"><span class="lineno"> 1993</span> </div>
<div class="line"><span class="lineno"> 1994</span>    <span class="keyword">const</span> boost::shared_ptr&lt;RefEntity&gt; &amp;ref_ent = *vit;</div>
<div class="line"><span class="lineno"> 1995</span>    <span class="keywordflow">if</span> ((ref_ent-&gt;getBitRefLevel() &amp; <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>).any()) {</div>
<div class="line"><span class="lineno"> 1996</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> vert = ref_ent-&gt;getEnt();</div>
<div class="line"><span class="lineno"> 1997</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>.insert(vert);</div>
<div class="line"><span class="lineno"> 1998</span>      <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5c83ac6cfca374e4658a8c89691c18a2">verticesOnTrimEdges</a>[vert] = mit-&gt;second;</div>
<div class="line"><span class="lineno"> 1999</span>    }</div>
<div class="line"><span class="lineno"> 2000</span>  }</div>
<div class="line"><span class="lineno"> 2001</span> </div>
<div class="line"><span class="lineno"> 2002</span>  <span class="comment">// Get faces which are trimmed</span></div>
<div class="line"><span class="lineno"> 2003</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>.clear();</div>
<div class="line"><span class="lineno"> 2004</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 2005</span>      <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, MBTRI, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>);</div>
<div class="line"><span class="lineno"> 2006</span> </div>
<div class="line"><span class="lineno"> 2007</span>  <a class="code hl_class" href="class_range.html">Range</a> trim_new_surfaces_nodes;</div>
<div class="line"><span class="lineno"> 2008</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, trim_new_surfaces_nodes, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2009</span>  trim_new_surfaces_nodes = subtract(trim_new_surfaces_nodes, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>);</div>
<div class="line"><span class="lineno"> 2010</span>  trim_new_surfaces_nodes = subtract(trim_new_surfaces_nodes, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a75bdd40b1e7208d4c435acee21562669">cutNewVertices</a>);</div>
<div class="line"><span class="lineno"> 2011</span>  <a class="code hl_class" href="class_range.html">Range</a> faces_not_on_surface;</div>
<div class="line"><span class="lineno"> 2012</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(trim_new_surfaces_nodes, 2, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno"> 2013</span>                              faces_not_on_surface, moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2014</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a> = subtract(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, faces_not_on_surface);</div>
<div class="line"><span class="lineno"> 2015</span> </div>
<div class="line"><span class="lineno"> 2016</span>  <span class="comment">// Get surfaces which are not trimmed and add them to surface</span></div>
<div class="line"><span class="lineno"> 2017</span>  <a class="code hl_class" href="class_range.html">Range</a> all_surfaces_on_bit_level;</div>
<div class="line"><span class="lineno"> 2018</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno"> 2019</span>      <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTRI, all_surfaces_on_bit_level);</div>
<div class="line"><span class="lineno"> 2020</span>  all_surfaces_on_bit_level =</div>
<div class="line"><span class="lineno"> 2021</span>      intersect(all_surfaces_on_bit_level, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9d20a18617586fd01c1da8bc486d2061">cutNewSurfaces</a>);</div>
<div class="line"><span class="lineno"> 2022</span> </div>
<div class="line"><span class="lineno"> 2023</span>  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a> = unite(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, all_surfaces_on_bit_level);</div>
<div class="line"><span class="lineno"> 2024</span> </div>
<div class="line"><span class="lineno"> 2025</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2026</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a14f173d3cba5074db4437f5d578427d9" name="a14f173d3cba5074db4437f5d578427d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14f173d3cba5074db4437f5d578427d9">&#9670;&#160;</a></span>trimOnly()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::trimOnly </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>&#160;</td>
          <td class="paramname"><em>trim_bit</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol_trim_close</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edges</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>corner_nodes</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>update_meshsets</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trim mesh only. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">trim_bit</td><td></td></tr>
    <tr><td class="paramname">th</td><td></td></tr>
    <tr><td class="paramname">tol_cut_close</td><td></td></tr>
    <tr><td class="paramname">fixed_edges</td><td></td></tr>
    <tr><td class="paramname">corner_nodes</td><td></td></tr>
    <tr><td class="paramname">update_meshsets</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l00263">263</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  268</span>                                                            {</div>
<div class="line"><span class="lineno">  269</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno">  270</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno">  271</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>  <span class="comment">// trim mesh</span></div>
<div class="line"><span class="lineno">  274</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08769c58f2f2ad52cf371aadb1f62331">findEdgesToTrim</a>(fixed_edges, corner_nodes, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, tol_trim_close, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  275</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2a17e2e37581b566c13d274d10e58b34">trimEdgesInTheMiddle</a>(trim_bit, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>,</div>
<div class="line"><span class="lineno">  278</span>                                                         <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>);</div>
<div class="line"><span class="lineno">  279</span>  <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno">  280</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(*fixed_edges,</div>
<div class="line"><span class="lineno">  281</span>                                                           *fixed_edges);</div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>  <span class="keywordflow">if</span> (corner_nodes)</div>
<div class="line"><span class="lineno">  284</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;updateRangeByChildren(*corner_nodes,</div>
<div class="line"><span class="lineno">  285</span>                                                           *corner_nodes);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>  <span class="keywordflow">if</span> (update_meshsets)</div>
<div class="line"><span class="lineno">  288</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;MeshsetsManager&gt;()</div>
<div class="line"><span class="lineno">  289</span>        -&gt;updateAllMeshsetsByEntitiesChildren(trim_bit);</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">// move nodes</span></div>
<div class="line"><span class="lineno">  292</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0fcd2cc277293c8530dd28b24ddbe6e7">moveMidNodesOnTrimmedEdges</a>(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>  <span class="comment">// remove faces</span></div>
<div class="line"><span class="lineno">  295</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2520f629b1708b8d9dafb141c9b90ae5">trimSurface</a>(fixed_edges, corner_nodes, tol_trim_close, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="lineno">  298</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9a8a8242b3e6eeb4de3ab284dd9933b9">saveTrimEdges</a>();</div>
<div class="line"><span class="lineno">  299</span>    <a class="code hl_class" href="class_range.html">Range</a> bit2_edges;</div>
<div class="line"><span class="lineno">  300</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BitRefManager&gt;()-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line"><span class="lineno">  301</span>        trim_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE, bit2_edges);</div>
<div class="line"><span class="lineno">  302</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(moab)(<span class="stringliteral">&quot;trim_fixed_edges.vtk&quot;</span>,</div>
<div class="line"><span class="lineno">  303</span>                          intersect(*fixed_edges, bit2_edges));</div>
<div class="line"><span class="lineno">  304</span>  }</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno">  307</span>}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a08769c58f2f2ad52cf371aadb1f62331"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08769c58f2f2ad52cf371aadb1f62331">MoFEM::CutMeshInterface::findEdgesToTrim</a></div><div class="ttdeci">MoFEMErrorCode findEdgesToTrim(Range *fixed_edges, Range *corner_nodes, Tag th=NULL, const double tol=1e-4, const bool debug=false)</div><div class="ttdoc">Find edges to trimEdges.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l01480">CutMeshInterface.cpp:1480</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a0fcd2cc277293c8530dd28b24ddbe6e7"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0fcd2cc277293c8530dd28b24ddbe6e7">MoFEM::CutMeshInterface::moveMidNodesOnTrimmedEdges</a></div><div class="ttdeci">MoFEMErrorCode moveMidNodesOnTrimmedEdges(Tag th=NULL)</div><div class="ttdoc">move trimmed edges mid nodes</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l01465">CutMeshInterface.cpp:1465</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a2520f629b1708b8d9dafb141c9b90ae5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2520f629b1708b8d9dafb141c9b90ae5">MoFEM::CutMeshInterface::trimSurface</a></div><div class="ttdeci">MoFEMErrorCode trimSurface(Range *fixed_edge, Range *corner_nodes, const double tol=1e-4, Tag th=NULL, const bool debug=false)</div><div class="ttdoc">Trim surface from faces beyond front.</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l02028">CutMeshInterface.cpp:2028</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a2a17e2e37581b566c13d274d10e58b34"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2a17e2e37581b566c13d274d10e58b34">MoFEM::CutMeshInterface::trimEdgesInTheMiddle</a></div><div class="ttdeci">MoFEMErrorCode trimEdgesInTheMiddle(const BitRefLevel bit, const bool debug=false)</div><div class="ttdoc">trim edges</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l01969">CutMeshInterface.cpp:1969</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a9a8a8242b3e6eeb4de3ab284dd9933b9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a9a8a8242b3e6eeb4de3ab284dd9933b9">MoFEM::CutMeshInterface::saveTrimEdges</a></div><div class="ttdeci">MoFEMErrorCode saveTrimEdges()</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l03161">CutMeshInterface.cpp:3161</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2520f629b1708b8d9dafb141c9b90ae5" name="a2520f629b1708b8d9dafb141c9b90ae5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2520f629b1708b8d9dafb141c9b90ae5">&#9670;&#160;</a></span>trimSurface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> MoFEM::CutMeshInterface::trimSurface </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>fixed_edge</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="class_range.html">Range</a> *&#160;</td>
          <td class="paramname"><em>corner_nodes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classdouble.html">double</a>&#160;</td>
          <td class="paramname"><em>tol</em> = <code>1e-4</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Tag&#160;</td>
          <td class="paramname"><em>th</em> = <code>NULL</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classbool.html">bool</a>&#160;</td>
          <td class="paramname"><em>debug</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Trim surface from faces beyond front. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">fixed_edge</td><td></td></tr>
    <tr><td class="paramname">corner_nodes</td><td></td></tr>
    <tr><td class="paramname">debug</td><td></td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>MoFEMErrorCode </dd></dl>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8cpp_source.html#l02028">2028</a> of file <a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2031</span>                                                               {</div>
<div class="line"><span class="lineno"> 2032</span>  CoreInterface &amp;m_field = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>;</div>
<div class="line"><span class="lineno"> 2033</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a9ca0a8b7e9788553bacbc2661fb22af4">get_moab</a>();</div>
<div class="line"><span class="lineno"> 2034</span>  Skinner skin(&amp;moab);</div>
<div class="line"><span class="lineno"> 2035</span> </div>
<div class="line"><span class="lineno"> 2036</span>  <span class="keyword">auto</span> get_adj = [&amp;moab](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>) {</div>
<div class="line"><span class="lineno"> 2037</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno"> 2038</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>)</div>
<div class="line"><span class="lineno"> 2039</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(r, <a class="code hl_variable" href="elec__phys__2_d_8cpp.html#afe4f94e033c0d1c57d407b4338a64b33">dim</a>, <span class="keyword">false</span>, a, moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2040</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2041</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(r, a, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2042</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"><span class="lineno"> 2043</span>  };</div>
<div class="line"><span class="lineno"> 2044</span> </div>
<div class="line"><span class="lineno"> 2045</span>  <span class="keyword">auto</span> get_skin = [&amp;skin](<span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line"><span class="lineno"> 2046</span>    <a class="code hl_class" href="class_range.html">Range</a> s;</div>
<div class="line"><span class="lineno"> 2047</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, r, <span class="keyword">false</span>, s);</div>
<div class="line"><span class="lineno"> 2048</span>    <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="lineno"> 2049</span>  };</div>
<div class="line"><span class="lineno"> 2050</span> </div>
<div class="line"><span class="lineno"> 2051</span>  <a class="code hl_define" href="_cut_mesh_interface_8cpp.html#ac0f53b69ec9c555d10ce1b1ca620f165">CutMeshFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2052</span> </div>
<div class="line"><span class="lineno"> 2053</span>  <span class="keyword">auto</span> trim_tets_skin = get_skin(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a8d5acd0e2fc2974e7c44aed8794cc5f3">trimNewVolumes</a>);</div>
<div class="line"><span class="lineno"> 2054</span>  <span class="keyword">auto</span> trim_tets_skin_edges = get_adj(trim_tets_skin, 1);</div>
<div class="line"><span class="lineno"> 2055</span>  <span class="keyword">auto</span> trim_surface_edges = get_adj(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, 1);</div>
<div class="line"><span class="lineno"> 2056</span> </div>
<div class="line"><span class="lineno"> 2057</span>  <span class="keyword">auto</span> contarain_edges =</div>
<div class="line"><span class="lineno"> 2058</span>      intersect(trim_surface_edges, get_adj(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>, 1));</div>
<div class="line"><span class="lineno"> 2059</span>  <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 2060</span>    contarain_edges.merge(</div>
<div class="line"><span class="lineno"> 2061</span>        intersect(fixed_edges-&gt;subset_by_type(MBEDGE), trim_surface_edges));</div>
<div class="line"><span class="lineno"> 2062</span> </div>
<div class="line"><span class="lineno"> 2063</span>  <a class="code hl_class" href="class_range.html">Range</a> barrier_vertices(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a00e7da4bd6411bfc49661d00cc331d2b">trimNewVertices</a>);</div>
<div class="line"><span class="lineno"> 2064</span>  <span class="keywordflow">if</span> (corner_nodes) {</div>
<div class="line"><span class="lineno"> 2065</span>    <span class="comment">// Add nodes which re adjacent to corner nodes</span></div>
<div class="line"><span class="lineno"> 2066</span>    barrier_vertices.merge(get_adj(</div>
<div class="line"><span class="lineno"> 2067</span>        intersect(get_adj(intersect(*corner_nodes, barrier_vertices), 2),</div>
<div class="line"><span class="lineno"> 2068</span>                  <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>),</div>
<div class="line"><span class="lineno"> 2069</span>        0));</div>
<div class="line"><span class="lineno"> 2070</span>  }</div>
<div class="line"><span class="lineno"> 2071</span> </div>
<div class="line"><span class="lineno"> 2072</span>  <span class="keyword">auto</span> get_nodes_with_one_node_on_fixed_edge_other_not = [&amp;]() {</div>
<div class="line"><span class="lineno"> 2073</span>    <span class="keyword">const</span> <span class="keyword">auto</span> fixed_edges_on_surface =</div>
<div class="line"><span class="lineno"> 2074</span>        intersect(*fixed_edges, trim_surface_edges);</div>
<div class="line"><span class="lineno"> 2075</span>    <span class="keyword">const</span> <span class="keyword">auto</span> skin_fixed_edges_on_surface = get_skin(fixed_edges_on_surface);</div>
<div class="line"><span class="lineno"> 2076</span>    <span class="keyword">const</span> <span class="keyword">auto</span> barrier_nodes = subtract(skin_fixed_edges_on_surface,</div>
<div class="line"><span class="lineno"> 2077</span>                                  get_adj(get_skin(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>), 0));</div>
<div class="line"><span class="lineno"> 2078</span>    <span class="keywordflow">return</span> barrier_nodes;</div>
<div class="line"><span class="lineno"> 2079</span>  };</div>
<div class="line"><span class="lineno"> 2080</span> </div>
<div class="line"><span class="lineno"> 2081</span>  <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 2082</span>    barrier_vertices.merge(get_nodes_with_one_node_on_fixed_edge_other_not());</div>
<div class="line"><span class="lineno"> 2083</span> </div>
<div class="line"><span class="lineno"> 2084</span>  <span class="keyword">auto</span> add_close_surface_barrier = [&amp;]() {</div>
<div class="line"><span class="lineno"> 2085</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>    <span class="comment">// Ten algorytm dedykuje destylarni Bowmore. Jeżeli coś pójdzie nie tak, coś</span></div>
<div class="line"><span class="lineno"> 2088</span>    <span class="comment">// pęknie inaczej niż trzeba, to pełną odpowiedzialność ponosi Beam Suntory</span></div>
<div class="line"><span class="lineno"> 2089</span>    <span class="comment">// UK Ltd.</span></div>
<div class="line"><span class="lineno"> 2090</span> </div>
<div class="line"><span class="lineno"> 2091</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a67d0cdac80f09af5b4d821c671600ae9">buildTree</a>();</div>
<div class="line"><span class="lineno"> 2092</span> </div>
<div class="line"><span class="lineno"> 2093</span>    <span class="keyword">auto</span> test_edges =</div>
<div class="line"><span class="lineno"> 2094</span>        subtract(trim_surface_edges, get_adj(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a2775e2dc0fca083966780c4fd30eba07">constrainSurface</a>, 1));</div>
<div class="line"><span class="lineno"> 2095</span>    <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 2096</span>      test_edges = subtract(test_edges, *fixed_edges);</div>
<div class="line"><span class="lineno"> 2097</span>    <span class="keyword">auto</span> trim_surface_nodes = get_adj(test_edges, 0);</div>
<div class="line"><span class="lineno"> 2098</span>    trim_surface_nodes = subtract(trim_surface_nodes, barrier_vertices);</div>
<div class="line"><span class="lineno"> 2099</span>    <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 2100</span>      trim_surface_nodes =</div>
<div class="line"><span class="lineno"> 2101</span>          subtract(trim_surface_nodes, get_adj(*fixed_edges, 0));</div>
<div class="line"><span class="lineno"> 2102</span> </div>
<div class="line"><span class="lineno"> 2103</span>    <a class="code hl_class" href="class_range.html">Range</a> trim_skin;</div>
<div class="line"><span class="lineno"> 2104</span>    trim_skin.merge(contarain_edges);</div>
<div class="line"><span class="lineno"> 2105</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>.empty())</div>
<div class="line"><span class="lineno"> 2106</span>      trim_skin.merge(get_skin(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a096f5f19f72b2a300d274d55162b6f19">sUrface</a>));</div>
<div class="line"><span class="lineno"> 2107</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2108</span>      trim_skin.merge(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad31de547dbb35fc59c2d858e698179d6">fRont</a>);</div>
<div class="line"><span class="lineno"> 2109</span>    <span class="keywordflow">if</span> (fixed_edges)</div>
<div class="line"><span class="lineno"> 2110</span>      trim_skin.merge(intersect(*fixed_edges, trim_surface_edges));</div>
<div class="line"><span class="lineno"> 2111</span> </div>
<div class="line"><span class="lineno"> 2112</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> &amp;&amp; !trim_skin.empty())</div>
<div class="line"><span class="lineno"> 2113</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;trim_skin.vtk&quot;</span>, trim_skin);</div>
<div class="line"><span class="lineno"> 2114</span> </div>
<div class="line"><span class="lineno"> 2115</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> coords(3 * trim_surface_nodes.size());</div>
<div class="line"><span class="lineno"> 2116</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><span class="lineno"> 2117</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, trim_surface_nodes, &amp;*coords.begin());</div>
<div class="line"><span class="lineno"> 2118</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno"> 2119</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(trim_surface_nodes, &amp;*coords.begin());</div>
<div class="line"><span class="lineno"> 2120</span> </div>
<div class="line"><span class="lineno"> 2121</span>    <span class="keywordflow">if</span> (!trim_skin.empty()) {</div>
<div class="line"><span class="lineno"> 2122</span> </div>
<div class="line"><span class="lineno"> 2123</span>      std::vector&lt;double&gt; min_distances(trim_surface_nodes.size(), -1);</div>
<div class="line"><span class="lineno"> 2124</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a49d7537c2912c9ce8d20638088f0e0a4">cOre</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;Tools&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><span class="lineno"> 2125</span>          &amp;*coords.begin(), trim_surface_nodes.size(), trim_skin,</div>
<div class="line"><span class="lineno"> 2126</span>          &amp;*min_distances.begin());</div>
<div class="line"><span class="lineno"> 2127</span> </div>
<div class="line"><span class="lineno"> 2128</span>      <span class="keyword">auto</span> coords_ptr = &amp;*coords.begin();</div>
<div class="line"><span class="lineno"> 2129</span>      <span class="keyword">auto</span> min_dist = &amp;*min_distances.begin();</div>
<div class="line"><span class="lineno"> 2130</span> </div>
<div class="line"><span class="lineno"> 2131</span>      std::vector&lt;EntityHandle&gt; add_nodes;</div>
<div class="line"><span class="lineno"> 2132</span>      add_nodes.reserve(trim_surface_nodes.size());</div>
<div class="line"><span class="lineno"> 2133</span> </div>
<div class="line"><span class="lineno"> 2134</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a> : trim_surface_nodes) {</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span>        <span class="keywordflow">if</span> ((*min_dist) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><span class="lineno"> 2137</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> point_out(3);</div>
<div class="line"><span class="lineno"> 2138</span> </div>
<div class="line"><span class="lineno"> 2139</span>          <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> facets_out;</div>
<div class="line"><span class="lineno"> 2140</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#adc59d5f363970862abcd6d284d947c74">treeSurfPtr</a>-&gt;closest_to_location(coords_ptr, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a74b5639fd1bdc3d0bb759f9b53076483">rootSetSurf</a>,</div>
<div class="line"><span class="lineno"> 2141</span>                                                  &amp;point_out[0], facets_out);</div>
<div class="line"><span class="lineno"> 2142</span> </div>
<div class="line"><span class="lineno"> 2143</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> = point_out - <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(coords_ptr, 3);</div>
<div class="line"><span class="lineno"> 2144</span>          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> normal(3);</div>
<div class="line"><span class="lineno"> 2145</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.getInterface&lt;Tools&gt;()-&gt;getTriNormal(facets_out,</div>
<div class="line"><span class="lineno"> 2146</span>                                                             &amp;normal[0]);</div>
<div class="line"><span class="lineno"> 2147</span> </div>
<div class="line"><span class="lineno"> 2148</span>          normal /= norm_2(normal);</div>
<div class="line"><span class="lineno"> 2149</span>          <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> -= inner_prod(normal, <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>) * normal;</div>
<div class="line"><span class="lineno"> 2150</span> </div>
<div class="line"><span class="lineno"> 2151</span>          <span class="keywordtype">double</span> dist = norm_2(<a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>);</div>
<div class="line"><span class="lineno"> 2152</span>          <span class="keywordflow">if</span> (dist &lt; <a class="code hl_variable" href="mesh__smoothing_8cpp.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a> * (*min_dist))</div>
<div class="line"><span class="lineno"> 2153</span>            add_nodes.emplace_back(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>);</div>
<div class="line"><span class="lineno"> 2154</span>        }</div>
<div class="line"><span class="lineno"> 2155</span> </div>
<div class="line"><span class="lineno"> 2156</span>        coords_ptr += 3;</div>
<div class="line"><span class="lineno"> 2157</span>        min_dist += 1;</div>
<div class="line"><span class="lineno"> 2158</span>      }</div>
<div class="line"><span class="lineno"> 2159</span> </div>
<div class="line"><span class="lineno"> 2160</span>      barrier_vertices.insert_list(add_nodes.begin(), add_nodes.end());</div>
<div class="line"><span class="lineno"> 2161</span>    }</div>
<div class="line"><span class="lineno"> 2162</span> </div>
<div class="line"><span class="lineno"> 2163</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2164</span>  };</div>
<div class="line"><span class="lineno"> 2165</span> </div>
<div class="line"><span class="lineno"> 2166</span>  <span class="keyword">auto</span> remove_faces_on_skin = [&amp;]() {</div>
<div class="line"><span class="lineno"> 2167</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="lineno"> 2168</span>    <a class="code hl_class" href="class_range.html">Range</a> skin_faces = intersect(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, trim_tets_skin);</div>
<div class="line"><span class="lineno"> 2169</span>    <span class="keywordflow">if</span> (!skin_faces.empty()) {</div>
<div class="line"><span class="lineno"> 2170</span>      barrier_vertices.merge(get_adj(skin_faces, 0));</div>
<div class="line"><span class="lineno"> 2171</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : skin_faces)</div>
<div class="line"><span class="lineno"> 2172</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>.erase(f);</div>
<div class="line"><span class="lineno"> 2173</span>    }</div>
<div class="line"><span class="lineno"> 2174</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2175</span>  };</div>
<div class="line"><span class="lineno"> 2176</span> </div>
<div class="line"><span class="lineno"> 2177</span>  <span class="keyword">auto</span> get_trim_free_edges = [&amp;]() {</div>
<div class="line"><span class="lineno"> 2178</span>    <span class="comment">// get current surface skin</span></div>
<div class="line"><span class="lineno"> 2179</span>    <a class="code hl_class" href="class_range.html">Range</a> trim_surf_skin;</div>
<div class="line"><span class="lineno"> 2180</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, <span class="keyword">false</span>, trim_surf_skin);</div>
<div class="line"><span class="lineno"> 2181</span>    trim_surf_skin = subtract(trim_surf_skin, trim_tets_skin_edges);</div>
<div class="line"><span class="lineno"> 2182</span> </div>
<div class="line"><span class="lineno"> 2183</span>    <a class="code hl_class" href="class_range.html">Range</a> trim_surf_skin_verts;</div>
<div class="line"><span class="lineno"> 2184</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(trim_surf_skin, trim_surf_skin_verts, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno"> 2185</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : barrier_vertices)</div>
<div class="line"><span class="lineno"> 2186</span>      trim_surf_skin_verts.erase(e);</div>
<div class="line"><span class="lineno"> 2187</span> </div>
<div class="line"><span class="lineno"> 2188</span>    <a class="code hl_class" href="class_range.html">Range</a> free_edges;</div>
<div class="line"><span class="lineno"> 2189</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(trim_surf_skin_verts, 1, <span class="keyword">false</span>, free_edges,</div>
<div class="line"><span class="lineno"> 2190</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2191</span>    free_edges =</div>
<div class="line"><span class="lineno"> 2192</span>        subtract(intersect(free_edges, trim_surf_skin), contarain_edges);</div>
<div class="line"><span class="lineno"> 2193</span> </div>
<div class="line"><span class="lineno"> 2194</span>    <span class="keywordflow">return</span> free_edges;</div>
<div class="line"><span class="lineno"> 2195</span>  };</div>
<div class="line"><span class="lineno"> 2196</span> </div>
<div class="line"><span class="lineno"> 2197</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_faces_on_skin();</div>
<div class="line"><span class="lineno"> 2198</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_close_surface_barrier();</div>
<div class="line"><span class="lineno"> 2199</span> </div>
<div class="line"><span class="lineno"> 2200</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> &amp;&amp; !barrier_vertices.empty())</div>
<div class="line"><span class="lineno"> 2201</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(<span class="stringliteral">&quot;barrier_vertices.vtk&quot;</span>,</div>
<div class="line"><span class="lineno"> 2202</span>                                        barrier_vertices);</div>
<div class="line"><span class="lineno"> 2203</span> </div>
<div class="line"><span class="lineno"> 2204</span>  <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><span class="lineno"> 2205</span>  <a class="code hl_class" href="class_range.html">Range</a> out_edges;</div>
<div class="line"><span class="lineno"> 2206</span>  <span class="keywordflow">while</span> (!(out_edges = get_trim_free_edges()).empty()) {</div>
<div class="line"><span class="lineno"> 2207</span> </div>
<div class="line"><span class="lineno"> 2208</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> &amp;&amp; !<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>.empty())</div>
<div class="line"><span class="lineno"> 2209</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(</div>
<div class="line"><span class="lineno"> 2210</span>          <span class="stringliteral">&quot;trimNewSurfaces_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(nn) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line"><span class="lineno"> 2211</span>          <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>);</div>
<div class="line"><span class="lineno"> 2212</span> </div>
<div class="line"><span class="lineno"> 2213</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> &amp;&amp; !out_edges.empty())</div>
<div class="line"><span class="lineno"> 2214</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(</div>
<div class="line"><span class="lineno"> 2215</span>          <span class="stringliteral">&quot;trimNewSurfacesOutsideVerts_&quot;</span> +</div>
<div class="line"><span class="lineno"> 2216</span>              boost::lexical_cast&lt;std::string&gt;(nn) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line"><span class="lineno"> 2217</span>          out_edges);</div>
<div class="line"><span class="lineno"> 2218</span> </div>
<div class="line"><span class="lineno"> 2219</span>    <a class="code hl_class" href="class_range.html">Range</a> outside_faces;</div>
<div class="line"><span class="lineno"> 2220</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(out_edges, 2, <span class="keyword">false</span>, outside_faces,</div>
<div class="line"><span class="lineno"> 2221</span>                                moab::Interface::UNION);</div>
<div class="line"><span class="lineno"> 2222</span>    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a> = subtract(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>, outside_faces);</div>
<div class="line"><span class="lineno"> 2223</span>    ++nn;</div>
<div class="line"><span class="lineno"> 2224</span>  }</div>
<div class="line"><span class="lineno"> 2225</span> </div>
<div class="line"><span class="lineno"> 2226</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> &amp;&amp; !<a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>.empty())</div>
<div class="line"><span class="lineno"> 2227</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SaveData(m_field.get_moab())(</div>
<div class="line"><span class="lineno"> 2228</span>        <span class="stringliteral">&quot;trimNewSurfaces_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(nn) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line"><span class="lineno"> 2229</span>        <a class="code hl_variable" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0b99aef4cb232c84d46a919494477220">trimNewSurfaces</a>);</div>
<div class="line"><span class="lineno"> 2230</span> </div>
<div class="line"><span class="lineno"> 2231</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><span class="lineno"> 2232</span>}</div>
<div class="ttc" id="amesh__smoothing_8cpp_html_a2687e4b3cb5da7dbd00e565343f66c6c"><div class="ttname"><a href="mesh__smoothing_8cpp.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a></div><div class="ttdeci">double tol</div><div class="ttdef"><b>Definition:</b> <a href="mesh__smoothing_8cpp_source.html#l00027">mesh_smoothing.cpp:27</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a67d0cdac80f09af5b4d821c671600ae9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a67d0cdac80f09af5b4d821c671600ae9">MoFEM::CutMeshInterface::buildTree</a></div><div class="ttdeci">MoFEMErrorCode buildTree()</div><div class="ttdoc">build tree</div><div class="ttdef"><b>Definition:</b> <a href="_cut_mesh_interface_8cpp_source.html#l00215">CutMeshInterface.cpp:215</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a27ab998c8029b8adcbcc89c4f967d43a" name="a27ab998c8029b8adcbcc89c4f967d43a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a27ab998c8029b8adcbcc89c4f967d43a">&#9670;&#160;</a></span>aveLength</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> MoFEM::CutMeshInterface::aveLength</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Average edge length. </p>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00572">572</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a2775e2dc0fca083966780c4fd30eba07" name="a2775e2dc0fca083966780c4fd30eba07"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2775e2dc0fca083966780c4fd30eba07">&#9670;&#160;</a></span>constrainSurface</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::constrainSurface</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00577">577</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a49d7537c2912c9ce8d20638088f0e0a4" name="a49d7537c2912c9ce8d20638088f0e0a4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49d7537c2912c9ce8d20638088f0e0a4">&#9670;&#160;</a></span>cOre</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="namespace_mo_f_e_m.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a>&amp; MoFEM::CutMeshInterface::cOre</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00023">23</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="afd47f33b2d5fb21c26ddf80444360bba" name="afd47f33b2d5fb21c26ddf80444360bba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afd47f33b2d5fb21c26ddf80444360bba">&#9670;&#160;</a></span>cutEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::cutEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00545">545</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a208b503c4a559549484c8cae4af2b1aa" name="a208b503c4a559549484c8cae4af2b1aa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a208b503c4a559549484c8cae4af2b1aa">&#9670;&#160;</a></span>cutFrontVolumes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::cutFrontVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00576">576</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a9d20a18617586fd01c1da8bc486d2061" name="a9d20a18617586fd01c1da8bc486d2061"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9d20a18617586fd01c1da8bc486d2061">&#9670;&#160;</a></span>cutNewSurfaces</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::cutNewSurfaces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00547">547</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a75bdd40b1e7208d4c435acee21562669" name="a75bdd40b1e7208d4c435acee21562669"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a75bdd40b1e7208d4c435acee21562669">&#9670;&#160;</a></span>cutNewVertices</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::cutNewVertices</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00550">550</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a4e149175ff1d5e5086a6b36dc1477ca1" name="a4e149175ff1d5e5086a6b36dc1477ca1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e149175ff1d5e5086a6b36dc1477ca1">&#9670;&#160;</a></span>cutNewVolumes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::cutNewVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00546">546</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="ac9552b1279ac23cc91e58d42dafe7ce6" name="ac9552b1279ac23cc91e58d42dafe7ce6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac9552b1279ac23cc91e58d42dafe7ce6">&#9670;&#160;</a></span>cutSurfaceVolumes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::cutSurfaceVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00575">575</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="ad277d5b4f2c7eb02619acca528e60f1c" name="ad277d5b4f2c7eb02619acca528e60f1c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad277d5b4f2c7eb02619acca528e60f1c">&#9670;&#160;</a></span>edgesToCut</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;<a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a>&gt; MoFEM::CutMeshInterface::edgesToCut</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00567">567</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a5953d82956ff923572fe91b1d967c0d9" name="a5953d82956ff923572fe91b1d967c0d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5953d82956ff923572fe91b1d967c0d9">&#9670;&#160;</a></span>edgesToTrim</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;<a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a>&gt; MoFEM::CutMeshInterface::edgesToTrim</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00569">569</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="ad31de547dbb35fc59c2d858e698179d6" name="ad31de547dbb35fc59c2d858e698179d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad31de547dbb35fc59c2d858e698179d6">&#9670;&#160;</a></span>fRont</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::fRont</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00538">538</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a4f4d5194089ca2d3fbbc483eeb75c817" name="a4f4d5194089ca2d3fbbc483eeb75c817"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4f4d5194089ca2d3fbbc483eeb75c817">&#9670;&#160;</a></span>lineSearchSteps</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MoFEM::CutMeshInterface::lineSearchSteps</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00027">27</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a729419c6fa252624215c8ec8b317a8e4" name="a729419c6fa252624215c8ec8b317a8e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a729419c6fa252624215c8ec8b317a8e4">&#9670;&#160;</a></span>maxLength</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> MoFEM::CutMeshInterface::maxLength</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Maximal edge length. </p>

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00573">573</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="aa54c4ce1e4f1249778ebb15e7e4d12ae" name="aa54c4ce1e4f1249778ebb15e7e4d12ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54c4ce1e4f1249778ebb15e7e4d12ae">&#9670;&#160;</a></span>mergedSurfaces</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::mergedSurfaces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00558">558</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a0662298092c0532e60151baa5040aadb" name="a0662298092c0532e60151baa5040aadb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0662298092c0532e60151baa5040aadb">&#9670;&#160;</a></span>mergedVolumes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::mergedVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00557">557</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="aa4a886cef884b12a6fc193fb98cace45" name="aa4a886cef884b12a6fc193fb98cace45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa4a886cef884b12a6fc193fb98cace45">&#9670;&#160;</a></span>nbMaxMergingCycles</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int MoFEM::CutMeshInterface::nbMaxMergingCycles</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00028">28</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a6b9776c73fa2731c98ee28deab409ed7" name="a6b9776c73fa2731c98ee28deab409ed7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b9776c73fa2731c98ee28deab409ed7">&#9670;&#160;</a></span>projectEntitiesQualityTrashold</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="classdouble.html">double</a> MoFEM::CutMeshInterface::projectEntitiesQualityTrashold</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00029">29</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a74b5639fd1bdc3d0bb759f9b53076483" name="a74b5639fd1bdc3d0bb759f9b53076483"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a74b5639fd1bdc3d0bb759f9b53076483">&#9670;&#160;</a></span>rootSetSurf</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_entity_handle.html">EntityHandle</a> MoFEM::CutMeshInterface::rootSetSurf</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00543">543</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a096f5f19f72b2a300d274d55162b6f19" name="a096f5f19f72b2a300d274d55162b6f19"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a096f5f19f72b2a300d274d55162b6f19">&#9670;&#160;</a></span>sUrface</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::sUrface</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00539">539</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="adc59d5f363970862abcd6d284d947c74" name="adc59d5f363970862abcd6d284d947c74"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc59d5f363970862abcd6d284d947c74">&#9670;&#160;</a></span>treeSurfPtr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">boost::shared_ptr&lt;OrientedBoxTreeTool&gt; MoFEM::CutMeshInterface::treeSurfPtr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00542">542</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a7010ac51af96c46b6038ba966a77012a" name="a7010ac51af96c46b6038ba966a77012a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7010ac51af96c46b6038ba966a77012a">&#9670;&#160;</a></span>trimEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::trimEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00555">555</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a0b99aef4cb232c84d46a919494477220" name="a0b99aef4cb232c84d46a919494477220"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b99aef4cb232c84d46a919494477220">&#9670;&#160;</a></span>trimNewSurfaces</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::trimNewSurfaces</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00554">554</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a00e7da4bd6411bfc49661d00cc331d2b" name="a00e7da4bd6411bfc49661d00cc331d2b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a00e7da4bd6411bfc49661d00cc331d2b">&#9670;&#160;</a></span>trimNewVertices</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::trimNewVertices</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00553">553</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a8d5acd0e2fc2974e7c44aed8794cc5f3" name="a8d5acd0e2fc2974e7c44aed8794cc5f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d5acd0e2fc2974e7c44aed8794cc5f3">&#9670;&#160;</a></span>trimNewVolumes</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::trimNewVolumes</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00552">552</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a95629e9a8eaeb96f050d7c3d3e334a99" name="a95629e9a8eaeb96f050d7c3d3e334a99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95629e9a8eaeb96f050d7c3d3e334a99">&#9670;&#160;</a></span>verticesOnCutEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;<a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a>&gt; MoFEM::CutMeshInterface::verticesOnCutEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00568">568</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a5c83ac6cfca374e4658a8c89691c18a2" name="a5c83ac6cfca374e4658a8c89691c18a2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5c83ac6cfca374e4658a8c89691c18a2">&#9670;&#160;</a></span>verticesOnTrimEdges</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">map&lt;<a class="el" href="class_entity_handle.html">EntityHandle</a>, <a class="el" href="struct_mo_f_e_m_1_1_cut_mesh_interface_1_1_tree_data.html">TreeData</a>&gt; MoFEM::CutMeshInterface::verticesOnTrimEdges</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00570">570</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a1995cac02879c652163074223c5fb296" name="a1995cac02879c652163074223c5fb296"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1995cac02879c652163074223c5fb296">&#9670;&#160;</a></span>vOlume</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::vOlume</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00540">540</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="a86c2b9230209eebcf507ba5ca4e43c2c" name="a86c2b9230209eebcf507ba5ca4e43c2c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86c2b9230209eebcf507ba5ca4e43c2c">&#9670;&#160;</a></span>zeroDistanceEnts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::zeroDistanceEnts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00548">548</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<a id="af8f5e939ef8a867d87ac6bc3b32e18ec" name="af8f5e939ef8a867d87ac6bc3b32e18ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af8f5e939ef8a867d87ac6bc3b32e18ec">&#9670;&#160;</a></span>zeroDistanceVerts</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="class_range.html">Range</a> MoFEM::CutMeshInterface::zeroDistanceVerts</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_cut_mesh_interface_8hpp_source.html#l00549">549</a> of file <a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this struct was generated from the following files:<ul>
<li>src/interfaces/<a class="el" href="_cut_mesh_interface_8hpp_source.html">CutMeshInterface.hpp</a></li>
<li>src/interfaces/impl/<a class="el" href="_cut_mesh_interface_8cpp_source.html">CutMeshInterface.cpp</a></li>
</ul>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
