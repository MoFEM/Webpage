<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: ADV-1: Contact problem</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">ADV-1: <a class="el" href="struct_contact.html">Contact</a> problem </div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>Prerequisites of this tutorial include <a class="el" href="tutorial_elastic_problem.html">VEC-0: Linear elasticity</a></dd></dl>
<p><br  />
</p>
<dl class="section note"><dt>Note</dt><dd>Intended learning outcome:<ul>
<li>general structure of a program developed using <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a></li>
<li>idea of <a href="http://mofem.eng.gla.ac.uk/mofem/html/struct_mo_f_e_m_1_1_simple.html">Simple Interface</a> in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and how to use it</li>
<li>idea of Domain element in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and how to use it</li>
<li>Use default Forms Integrals</li>
<li>how to <b>push</b> the developed UDOs to the <em>Pipeline</em></li>
<li>utilisation of tools to convert outputs (MOAB) and visualise them (Paraview)</li>
</ul>
</dd></dl>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file contact.cpp</span></div>
<div class="line"><span class="comment"> * \CONTACT contact.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * CONTACT of contact problem</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @copyright Copyright (c) 2023</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* The above code is a preprocessor directive in C++ that checks if the macro</span></div>
<div class="line"><span class="comment">&quot;EXECUTABLE_DIMENSION&quot; has been defined. If it has not been defined, it is set</span></div>
<div class="line"><span class="comment">to 3&quot; */</span></div>
<div class="line"><span class="preprocessor">#ifndef EXECUTABLE_DIMENSION</span></div>
<div class="line"><span class="preprocessor">#define EXECUTABLE_DIMENSION 3</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_matrix_function_8hpp.html">MatrixFunction.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python/def.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>bp = boost::python;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="group__mofem__forms.html#gabb82cd10e89a1d4d25fa7756360b181b">AssemblyType</a> <a class="code hl_variable" href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a> = AssemblyType::SCHUR; <span class="comment">//&lt; selected assembly type</span></div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="group__mofem__forms.html#ga2136fdd1cb130ca18f645e799b05569f">IntegrationType</a> <a class="code hl_variable" href="plastic_8cpp.html#a27f07ec7ec1b09221f6f421d6d7c9e58">IT</a> =</div>
<div class="line">    IntegrationType::GAUSS;                      <span class="comment">//&lt; selected integration type</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt; <span class="keyword">struct </span><a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps</a>&lt;2&gt; : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim</a>&lt;2&gt; {</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code hl_variable" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a> = <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82">HCURL</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps</a>&lt;3&gt; : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim</a>&lt;3&gt; {</div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code hl_variable" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a> = <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;2&gt;::CONTACT_SPACE</a>;</div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;3&gt;::CONTACT_SPACE</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> =</div>
<div class="line">    <a class="code hl_define" href="plastic_8cpp.html#a49d2a41e935ccc68adc5a9268619cba1">EXECUTABLE_DIMENSION</a>; <span class="comment">//&lt; Space dimension of problem, mesh</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* The above code is defining an alias `EntData` for the type</span></div>
<div class="line"><span class="comment">`EntitiesFieldData::EntData`. This is a C++ syntax for creating a new name for</span></div>
<div class="line"><span class="comment">an existing type. */</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::DomainEle</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">DomainEleOp</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">DomainEle::UserDataOperator</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Specialisation for assembly]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">// Assemble to A matrix, by default, however, some terms are assembled only to</span></div>
<div class="line"><span class="comment">// preconditioning. </span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code hl_typedef" href="struct_mo_f_e_m_1_1_op_base_impl.html#aff467503ecf30d8b2d0298f424658f34">MoFEM::OpBaseImpl&lt;AT, DomainEleOp&gt;::MatSetValuesHook</a></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">MoFEM::OpBaseImpl&lt;AT, DomainEleOp&gt;::matSetValuesHook</a> =</div>
<div class="line">        [](<a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html">ForcesAndSourcesCore::UserDataOperator</a> *op_ptr,</div>
<div class="line">           <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">           <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;col_data, <a class="code hl_class" href="class_u_blas_matrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>) {</div>
<div class="line">          <span class="keywordflow">return</span> MatSetValues&lt;AssemblyTypeSelector&lt;AT&gt;&gt;(</div>
<div class="line">              op_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa2f3a05951e205c8f7f0058ccc088400">getKSPA</a>(), row_data, col_data, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>, ADD_VALUES);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code hl_typedef" href="struct_mo_f_e_m_1_1_op_base_impl.html#aff467503ecf30d8b2d0298f424658f34">MoFEM::OpBaseImpl&lt;AT, BoundaryEleOp&gt;::MatSetValuesHook</a></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">MoFEM::OpBaseImpl&lt;AT, BoundaryEleOp&gt;::matSetValuesHook</a> =</div>
<div class="line">        [](<a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html">ForcesAndSourcesCore::UserDataOperator</a> *op_ptr,</div>
<div class="line">           <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">           <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;col_data, <a class="code hl_class" href="class_u_blas_matrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>) {</div>
<div class="line">          <span class="keywordflow">return</span> MatSetValues&lt;AssemblyTypeSelector&lt;AT&gt;&gt;(</div>
<div class="line">              op_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa2f3a05951e205c8f7f0058ccc088400">getKSPA</a>(), row_data, col_data, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>, ADD_VALUES);</div>
<div class="line">        };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Element used to specialise assembly</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_boundary_ele_op_stab.html">BoundaryEleOpStab</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a> {</div>
<div class="line">  <span class="keyword">using </span>BoundaryEleOp::BoundaryEleOp;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Specialise assembly for Stabilised matrix</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @tparam</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;&gt;</div>
<div class="line"><span class="keyword">typename</span> <a class="code hl_typedef" href="struct_mo_f_e_m_1_1_op_base_impl.html#aff467503ecf30d8b2d0298f424658f34">MoFEM::OpBaseImpl&lt;AT, BoundaryEleOpStab&gt;::MatSetValuesHook</a></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">MoFEM::OpBaseImpl&lt;AT, BoundaryEleOpStab&gt;::matSetValuesHook</a> =</div>
<div class="line">        [](<a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html">ForcesAndSourcesCore::UserDataOperator</a> *op_ptr,</div>
<div class="line">           <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">           <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;col_data, <a class="code hl_class" href="class_u_blas_matrix_3_01double_01_4.html">MatrixDouble</a> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>) {</div>
<div class="line">          <span class="keywordflow">return</span> MatSetValues&lt;AssemblyTypeSelector&lt;AT&gt;&gt;(</div>
<div class="line">              op_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), row_data, col_data, <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>, ADD_VALUES);</div>
<div class="line">        };<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Specialisation for assembly]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code hl_variable" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::CONTACT_SPACE</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Operators used for contact]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a1ec1816fd2578b2c878e1e7d55ef0c0e">OpSpringLhs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm</a>&lt;</div>
<div class="line">    <a class="code hl_variable" href="plastic_8cpp.html#a27f07ec7ec1b09221f6f421d6d7c9e58">IT</a>&gt;<a class="code hl_typedef" href="fluid__structure__eigenproblem_8cpp.html#a2993c54e90f2427566f6d9dc8e5399a9">::OpMass&lt;1, SPACE_DIM&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a9798b13657a78fb668c85f065d28ae9b">OpSpringRhs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm</a>&lt;</div>
<div class="line">    <a class="code hl_variable" href="plastic_8cpp.html#a27f07ec7ec1b09221f6f421d6d7c9e58">IT</a>&gt;::OpBaseTimesVector&lt;1, SPACE_DIM, 1&gt;;<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Operators used for contact]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">PetscBool <a class="code hl_variable" href="plastic_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a> = PETSC_TRUE;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 2;</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_variable" href="plastic_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a> = 1;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a> = 100;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a4533c564ae8668ad476bad5d95a64434">poisson_ratio</a> = 0.25;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = 0.0;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a> = 0.0;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a> = 0.0;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="plastic_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a> = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> = 1.;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_contact_ops.html">ContactOps</a> {</div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a> = 0.1;</div>
<div class="line">}; <span class="comment">// namespace ContactOps</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hencky_ops_8hpp.html">HenckyOps.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_hencky_ops.html">HenckyOps</a>;</div>
<div class="line"><span class="preprocessor">#include &lt;ContactOps.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;PostProcContact.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;ContactNaturalBC.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_linear_form.html">DomainRhsBCs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly.html">NaturalBC&lt;DomainEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;IT&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_flux_rhs_impl.html">OpDomainRhsBCs</a> =</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_flux_rhs_impl.html">DomainRhsBCs::OpFlux&lt;ContactOps::DomainBCs, 1, SPACE_DIM&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_linear_form.html">BoundaryRhsBCs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly.html">NaturalBC&lt;BoundaryEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;IT&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_flux_rhs_impl.html">OpBoundaryRhsBCs</a> =</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_flux_rhs_impl.html">BoundaryRhsBCs::OpFlux&lt;ContactOps::BoundaryBCs, 1, SPACE_DIM&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_bi_linear_form.html">BoundaryLhsBCs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly.html">NaturalBC&lt;BoundaryEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm&lt;IT&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_flux_lhs_impl.html">OpBoundaryLhsBCs</a> =</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_flux_lhs_impl.html">BoundaryLhsBCs::OpFlux&lt;ContactOps::BoundaryBCs, 1, SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_contact_ops.html">ContactOps</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_contact.html">Contact</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_contact.html">Contact</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field) : <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>(m_field) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a399ff55b433aca15a11c0883d5471fa7">runProblem</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a41561758ba88f46157a75abefe7b6b14">setupProblem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a4bdef6ab8fff7a1edbc2209ea3212aeb">createCommonData</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#ab60d85cbc4c204f7d7096b4f0de6df4f">bC</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a478ec2f06ecfd61b3130fa8669bac0ca">OPs</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a2b633ccf32e1328f60d0f1413dd4d63f">tsSolve</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a6e707d5be362b8db96412d97d468780f">checkResults</a>();</div>
<div class="line"> </div>
<div class="line">  std::tuple&lt;SmartPetscObj&lt;Vec&gt;, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a>&gt; <a class="code hl_variable" href="struct_contact.html#ab64bae7fbb254015787e568a3521bbe6">uXScatter</a>;</div>
<div class="line">  std::tuple&lt;SmartPetscObj&lt;Vec&gt;, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a>&gt; <a class="code hl_variable" href="struct_contact.html#a388ade03cde971890b6b3b65b3186b4f">uYScatter</a>;</div>
<div class="line">  std::tuple&lt;SmartPetscObj&lt;Vec&gt;, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a>&gt; <a class="code hl_variable" href="struct_contact.html#ad34f323d1598c882d77f4db10458181d">uZScatter</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  boost::shared_ptr&lt;SDFPython&gt; sdfPythonPtr;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span>ScaledTimeScale : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_time_scale.html">MoFEM::TimeScale</a> {</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_function" href="struct_mo_f_e_m_1_1_time_scale.html#a6fc95cd5d66b6a50035771ac36c3ca3a">MoFEM::TimeScale::TimeScale</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_function" href="struct_contact_1_1_scaled_time_scale.html#ab059a32288b8119751175fd03fe0574d">getScale</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> time) {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> * <a class="code hl_function" href="struct_mo_f_e_m_1_1_time_scale.html#a484091f75279db84601ea772abe3f530">MoFEM::TimeScale::getScale</a>(time);</div>
<div class="line">    };</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Run problem]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a399ff55b433aca15a11c0883d5471fa7">Contact::runProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_contact.html#a41561758ba88f46157a75abefe7b6b14">setupProblem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_contact.html#a4bdef6ab8fff7a1edbc2209ea3212aeb">createCommonData</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_contact.html#ab60d85cbc4c204f7d7096b4f0de6df4f">bC</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_contact.html#a478ec2f06ecfd61b3130fa8669bac0ca">OPs</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_contact.html#a2b633ccf32e1328f60d0f1413dd4d63f">tsSolve</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_contact.html#a6e707d5be362b8db96412d97d468780f">checkResults</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Run problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a41561758ba88f46157a75abefe7b6b14">Contact::setupProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a> *<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a class="code hl_variable" href="contact_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-geom_order&quot;</span>, &amp;<a class="code hl_variable" href="contact_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a>,</div>
<div class="line">                            PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Order &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Geom order &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Select base</span></div>
<div class="line">  <span class="keyword">enum</span> bases { AINSWORTH, DEMKOWICZ, LASBASETOPT };</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_bases[LASBASETOPT] = {<span class="stringliteral">&quot;ainsworth&quot;</span>, <span class="stringliteral">&quot;demkowicz&quot;</span>};</div>
<div class="line">  PetscInt choice_base_value = AINSWORTH;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#abee82d436d03244c6886fc99f71116f0">PetscOptionsGetEList</a>(PETSC_NULL, NULL, <span class="stringliteral">&quot;-base&quot;</span>, list_bases,</div>
<div class="line">                              LASBASETOPT, &amp;choice_base_value, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_enumeration" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a> base;</div>
<div class="line">  <span class="keywordflow">switch</span> (choice_base_value) {</div>
<div class="line">  <span class="keywordflow">case</span> AINSWORTH:</div>
<div class="line">    base = <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Set AINSWORTH_LEGENDRE_BASE for displacements&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> DEMKOWICZ:</div>
<div class="line">    base = <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Set DEMKOWICZ_JACOBI_BASE for displacements&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    base = <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a35e0a7e42f81919e776c310c509598da">LASTBASE</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Note: For tets we have only H1 Ainsworth base, for Hex we have only H1</span></div>
<div class="line">  <span class="comment">// Demkowicz base. We need to implement Demkowicz H1 base on tet.</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;SIGMA&quot;</span>, <a class="code hl_variable" href="contact_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>,</div>
<div class="line">                                <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;SIGMA&quot;</span>, <a class="code hl_variable" href="contact_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>,</div>
<div class="line">                                  <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDataField(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_variable" href="contact_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, <a class="code hl_variable" href="contact_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_skin = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> skin_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents);</div>
<div class="line">    <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> filter_blocks = [&amp;](<span class="keyword">auto</span> skin) {</div>
<div class="line">    <span class="keywordtype">bool</span> is_contact_block = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> contact_range;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> :</div>
<div class="line">         <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(std::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % <span class="stringliteral">&quot;CONTACT&quot;</span>).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      is_contact_block =</div>
<div class="line">          <span class="keyword">true</span>; <span class="comment">///&lt; bloks interation is collectibe, so that is set irrespective</span><span class="comment"></span></div>
<div class="line"><span class="comment">                ///&lt; if there are enerities in given rank or not in the block</span></div>
<div class="line"><span class="comment"></span>      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Find contact block set:  &quot;</span> &lt;&lt; <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>-&gt;getName();</div>
<div class="line">      <span class="keyword">auto</span> meshset = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>-&gt;getMeshset();</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> contact_meshset_range;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(</div>
<div class="line">          meshset, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, contact_meshset_range, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">          contact_meshset_range);</div>
<div class="line">      contact_range.merge(contact_meshset_range);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (is_contact_block) {</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Nb entities in contact surface: &quot;</span> &lt;&lt; contact_range.size();</div>
<div class="line">      <a class="code hl_define" href="_log_manager_8hpp.html#adacc7b9e7c4fa95cc0959ca359f999f5">MOFEM_LOG_SYNCHRONISE</a>(<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">      skin = intersect(skin, contact_range);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> filter_true_skin = [&amp;](<span class="keyword">auto</span> skin) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> boundary_ents;</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;boundary_ents);</div>
<div class="line">    <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> boundary_ents = filter_true_skin(filter_blocks(get_skin()));</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;SIGMA&quot;</span>, 0);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;SIGMA&quot;</span>, <a class="code hl_variable" href="contact_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a> - 1, &amp;boundary_ents);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setUp();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> project_ho_geometry = [&amp;]() {</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">Projection10NodeCoordsOnField</a> ent_method(<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, ent_method);</div>
<div class="line">  };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> project_ho_geometry();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">} <span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Create common data]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a4bdef6ab8fff7a1edbc2209ea3212aeb">Contact::createCommonData</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_options = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-scale&quot;</span>, &amp;<a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-young_modulus&quot;</span>,</div>
<div class="line">                                 &amp;<a class="code hl_variable" href="contact_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-poisson_ratio&quot;</span>,</div>
<div class="line">                                 &amp;<a class="code hl_variable" href="contact_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-rho&quot;</span>, &amp;<a class="code hl_variable" href="contact_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-cn&quot;</span>, &amp;cn_contact,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-spring_stiffness&quot;</span>,</div>
<div class="line">                                 &amp;<a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-vis_spring_stiffness&quot;</span>,</div>
<div class="line">                                 &amp;<a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-alpha_damping&quot;</span>,</div>
<div class="line">                                 &amp;<a class="code hl_variable" href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Young modulus &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Poisson_ratio &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Density &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;cn_contact &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Spring stiffness &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Vis spring_stiffness &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alpha_damping &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a>;</div>
<div class="line"> </div>
<div class="line">    PetscBool is_scale = PETSC_TRUE;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-is_scale&quot;</span>, &amp;is_scale,</div>
<div class="line">                               PETSC_NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (is_scale) {</div>
<div class="line">      <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> /= <a class="code hl_variable" href="contact_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Scale &quot;</span> &lt;&lt; <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-is_quasi_static&quot;</span>,</div>
<div class="line">                               &amp;<a class="code hl_variable" href="contact_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a>, PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Is quasi-static: &quot;</span> &lt;&lt; (<a class="code hl_variable" href="contact_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a> ? <span class="stringliteral">&quot;true&quot;</span> : <span class="stringliteral">&quot;false&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_options();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  sdfPythonPtr = boost::make_shared&lt;SDFPython&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sdfPythonPtr-&gt;sdfInit(<span class="stringliteral">&quot;sdf.py&quot;</span>);</div>
<div class="line">  sdfPythonWeakPtr = sdfPythonPtr;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Create common data]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#ab60d85cbc4c204f7d7096b4f0de6df4f">Contact::bC</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;SIGMA&quot;</span>}) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(),</div>
<div class="line">                                             <span class="stringliteral">&quot;REMOVE_X&quot;</span>, <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, 0, 0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(),</div>
<div class="line">                                             <span class="stringliteral">&quot;REMOVE_Y&quot;</span>, <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, 1, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(),</div>
<div class="line">                                             <span class="stringliteral">&quot;REMOVE_Z&quot;</span>, <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, 2, 2);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(),</div>
<div class="line">                                             <span class="stringliteral">&quot;REMOVE_ALL&quot;</span>, <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, 0, 3);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;FIX_X&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;FIX_Y&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;SIGMA&quot;</span>, 1, 1, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;FIX_Z&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;SIGMA&quot;</span>, 2, 2, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;FIX_ALL&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, 3, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(</div>
<div class="line">      <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;NO_CONTACT&quot;</span>, <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, 3, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Note remove has to be always before push. Then node marking will be</span></div>
<div class="line">  <span class="comment">// corrupted.</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;pushMarkDOFsOnEntities&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_displacement_cubit_bc_data.html">DisplacementCubitBcData</a>&gt;(</div>
<div class="line">      <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Push operators to pip]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a478ec2f06ecfd61b3130fa8669bac0ca">Contact::OPs</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> *pip_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> time_scale = boost::make_shared&lt;ScaledTimeScale&gt;();</div>
<div class="line">  <span class="keyword">auto</span> body_force_time_scale =</div>
<div class="line">      boost::make_shared&lt;ScaledTimeScale&gt;(<span class="stringliteral">&quot;body_force_hist.txt&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> integration_rule_vol = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="prism__polynomial__approximation_8cpp.html#a67c2672e3debe9c63fb239645337a1bd">approx_order</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="prism__polynomial__approximation_8cpp.html#a67c2672e3debe9c63fb239645337a1bd">approx_order</a> + <a class="code hl_variable" href="contact_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a> - 1;</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">auto</span> integration_rule_boundary = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="prism__polynomial__approximation_8cpp.html#a67c2672e3debe9c63fb239645337a1bd">approx_order</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="prism__polynomial__approximation_8cpp.html#a67c2672e3debe9c63fb239645337a1bd">approx_order</a> + <a class="code hl_variable" href="contact_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a> - 1;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_domain_base_ops = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>},</div>
<div class="line">                                                          <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> henky_common_data_ptr = boost::make_shared&lt;HenckyOps::CommonData&gt;();</div>
<div class="line">  henky_common_data_ptr-&gt;matDPtr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  henky_common_data_ptr-&gt;matGradPtr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_domain_ops_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Only used for dynamics]</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">using </span><a class="code hl_typedef" href="fluid__structure__eigenproblem_8cpp.html#a2993c54e90f2427566f6d9dc8e5399a9">OpMass</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;<a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm</a>&lt;</div>
<div class="line">        <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;<a class="code hl_typedef" href="fluid__structure__eigenproblem_8cpp.html#a2993c54e90f2427566f6d9dc8e5399a9">::OpMass&lt;1, SPACE_DIM&gt;</a>;<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Only used for dynamics]</span></div>
<div class="line"><span class="comment"></span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a> == PETSC_FALSE) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> *pip_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> fe_domain_lhs = pip_mng-&gt;getDomainLhsFE();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_inertia_and_mass_damping =</div>
<div class="line">          [<span class="keyword">this</span>, fe_domain_lhs](<span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>) {</div>
<div class="line">            <span class="keywordflow">return</span> (<a class="code hl_variable" href="contact_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>) * fe_domain_lhs-&gt;ts_aa +</div>
<div class="line">                   (<a class="code hl_variable" href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>) * fe_domain_lhs-&gt;ts_a;</div>
<div class="line">          };</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="fluid__structure__eigenproblem_8cpp.html#a2993c54e90f2427566f6d9dc8e5399a9">OpMass</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, get_inertia_and_mass_damping));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> *pip_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> fe_domain_lhs = pip_mng-&gt;getDomainLhsFE();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_inertia_and_mass_damping =</div>
<div class="line">          [<span class="keyword">this</span>, fe_domain_lhs](<span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>) {</div>
<div class="line">            <span class="keywordflow">return</span> (<a class="code hl_variable" href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>) * fe_domain_lhs-&gt;ts_a;</div>
<div class="line">          };</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="fluid__structure__eigenproblem_8cpp.html#a2993c54e90f2427566f6d9dc8e5399a9">OpMass</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, get_inertia_and_mass_damping));</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> HenckyOps::opFactoryDomainLhs&lt;SPACE_DIM, AT, IT, DomainEleOp&gt;(</div>
<div class="line">        <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, pip, <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;MAT_ELASTIC&quot;</span>, Sev::verbose, <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_domain_ops_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_add_flux_to_rhs_pipeline_impl.html">DomainRhsBCs::AddFluxToPipeline&lt;OpDomainRhsBCs&gt;::add</a>(</div>
<div class="line">        pip, <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, <span class="stringliteral">&quot;U&quot;</span>, {body_force_time_scale}, Sev::inform);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Only used for dynamics]</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a874eb87e8c107f75f4f4048683af4550">OpInertiaForce</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">        <a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;IT&gt;::OpBaseTimesVector</a>&lt;1, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, 1&gt;;<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Only used for dynamics]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    <span class="comment">// only in case of dynamics</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a> == PETSC_FALSE) {</div>
<div class="line">      <span class="keyword">auto</span> mat_acceleration = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDotDot&lt;SPACE_DIM&gt;</a>(</div>
<div class="line">          <span class="stringliteral">&quot;U&quot;</span>, mat_acceleration));</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a874eb87e8c107f75f4f4048683af4550">OpInertiaForce</a>(<span class="stringliteral">&quot;U&quot;</span>, mat_acceleration, [](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code hl_variable" href="contact_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>;</div>
<div class="line">          }));</div>
<div class="line"> </div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// only in case of viscosity</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a> &gt; 0) {</div>
<div class="line">      <span class="keyword">auto</span> mat_velocity = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDot&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, mat_velocity));</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a874eb87e8c107f75f4f4048683af4550">OpInertiaForce</a>(<span class="stringliteral">&quot;U&quot;</span>, mat_velocity, [](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code hl_variable" href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>;</div>
<div class="line">          }));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> HenckyOps::opFactoryDomainRhs&lt;SPACE_DIM, AT, IT, DomainEleOp&gt;(</div>
<div class="line">        <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, pip, <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;MAT_ELASTIC&quot;</span>, Sev::inform, <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ContactOps::opFactoryDomainRhs&lt;SPACE_DIM, AT, IT, DomainEleOp&gt;(</div>
<div class="line">        pip, <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_boundary_base_ops = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>},</div>
<div class="line">                                                              <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="comment">// We have to integrate on curved face geometry, thus integration weight</span></div>
<div class="line">    <span class="comment">// have to adjusted.</span></div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_h_o_weights_on_sub_dim.html">OpSetHOWeightsOnSubDim&lt;SPACE_DIM&gt;</a>());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_boundary_ops_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Operators used for contact]</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a1ec1816fd2578b2c878e1e7d55ef0c0e">OpSpringLhs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">        <a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm&lt;IT&gt;::OpMass</a>&lt;1, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt;;<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Operators used for contact]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    <span class="comment">// Add Natural BCs to LHS</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_add_flux_to_lhs_pipeline_impl.html">BoundaryLhsBCs::AddFluxToPipeline&lt;OpBoundaryLhsBCs&gt;::add</a>(</div>
<div class="line">        pip, <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, <span class="stringliteral">&quot;U&quot;</span>, Sev::inform);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a> &gt; 0 || <a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a> &gt; 0) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> *pip_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> fe_boundary_lhs = pip_mng-&gt;getBoundaryLhsFE();</div>
<div class="line"> </div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="contact_8cpp.html#aa8a9a346e33f38cd5ec82b6298e108da">OpSpringLhs</a>(</div>
<div class="line">          <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line"> </div>
<div class="line">          [<span class="keyword">this</span>, fe_boundary_lhs](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> +</div>
<div class="line">                   (<a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>) * fe_boundary_lhs-&gt;ts_a;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          ));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_contact_ops.html#a2eff5755e6337a8d2ad2efeca1807082">ContactOps::opFactoryBoundaryLhs</a>&lt;<a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>,</div>
<div class="line">                                            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>&gt;(pip, <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_contact_ops.html#aa054eea5f7b5dfa7769ea017e904c34b">ContactOps::opFactoryBoundaryToDomainLhs</a>&lt;<a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>,</div>
<div class="line">                                                    <a class="code hl_typedef" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a>&gt;(</div>
<div class="line">        <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, pip, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;GEOMETRY&quot;</span>,</div>
<div class="line">        integration_rule_vol);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_boundary_ops_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Operators used for contact]</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a9798b13657a78fb668c85f065d28ae9b">OpSpringRhs</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">        <a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;IT&gt;::OpBaseTimesVector</a>&lt;1, <a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, 1&gt;;<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Operators used for contact]</span></div>
<div class="line"><span class="comment"></span>    </div>
<div class="line">    <span class="comment">// Add Natural BCs to RHS</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_add_flux_to_rhs_pipeline_impl.html">BoundaryRhsBCs::AddFluxToPipeline&lt;OpBoundaryRhsBCs&gt;::add</a>(</div>
<div class="line">        pip, <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, <span class="stringliteral">&quot;U&quot;</span>, {time_scale}, Sev::inform);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a> &gt; 0 || <a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a> &gt; 0) {</div>
<div class="line">      <span class="keyword">auto</span> u_disp = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> dot_u_disp = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_disp));</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDot&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, dot_u_disp));</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_typedef" href="contact_8cpp.html#aec587ce097653e0b6a636da7ac91d788">OpSpringRhs</a>(<span class="stringliteral">&quot;U&quot;</span>, u_disp, [<span class="keyword">this</span>](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code hl_variable" href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>;</div>
<div class="line">          }));</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_typedef" href="contact_8cpp.html#aec587ce097653e0b6a636da7ac91d788">OpSpringRhs</a>(<span class="stringliteral">&quot;U&quot;</span>, dot_u_disp, [<span class="keyword">this</span>](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) {</div>
<div class="line">            <span class="keywordflow">return</span> <a class="code hl_variable" href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a> * <a class="code hl_variable" href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>;</div>
<div class="line">          }));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_contact_ops.html#adc0ef59ffb415069e3d6353638ff84fa">ContactOps::opFactoryBoundaryRhs</a>&lt;<a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a>, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>,</div>
<div class="line">                                            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>&gt;(pip, <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_base_ops(pip_mng-&gt;getOpDomainLhsPipeline());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_base_ops(pip_mng-&gt;getOpDomainRhsPipeline());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_ops_lhs(pip_mng-&gt;getOpDomainLhsPipeline());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_ops_rhs(pip_mng-&gt;getOpDomainRhsPipeline());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_boundary_base_ops(pip_mng-&gt;getOpBoundaryLhsPipeline());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_boundary_base_ops(pip_mng-&gt;getOpBoundaryRhsPipeline());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_boundary_ops_lhs(pip_mng-&gt;getOpBoundaryLhsPipeline());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_boundary_ops_rhs(pip_mng-&gt;getOpBoundaryRhsPipeline());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainRhsIntegrationRule(integration_rule_vol);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainLhsIntegrationRule(integration_rule_vol);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setBoundaryRhsIntegrationRule(integration_rule_boundary);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setBoundaryLhsIntegrationRule(integration_rule_boundary);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Push operators to pip]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">struct </span><a class="code hl_struct" href="struct_set_up_schur.html">SetUpSchur</a> {</div>
<div class="line">  <span class="keyword">static</span> boost::shared_ptr&lt;SetUpSchur&gt;</div>
<div class="line">  <a class="code hl_function" href="struct_set_up_schur.html#a3e073d1191c6086862360ed028127b1f">createSetUpSchur</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field);</div>
<div class="line">  <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur.html#ad71a485a37eeb5d74e76898f61a5dcca">setUp</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;TS&gt;</a> solver) = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a class="code hl_function" href="struct_set_up_schur.html#a0a92b8c06f626bcae7cb9bf3628c713e">SetUpSchur</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a2b633ccf32e1328f60d0f1413dd4d63f">Contact::tsSolve</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a> *<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a> *pip_mng = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a> *is_manager = <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_section_monitor = [&amp;](<span class="keyword">auto</span> solver) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    SNES snes;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(solver, &amp;snes);</div>
<div class="line">    PetscViewerAndFormat *vf;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscViewerAndFormatCreate(PETSC_VIEWER_STDOUT_WORLD,</div>
<div class="line">                                      PETSC_VIEWER_DEFAULT, &amp;vf);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(</div>
<div class="line">        snes,</div>
<div class="line">        (<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal, <span class="keywordtype">void</span> *))SNESMonitorFields,</div>
<div class="line">        vf, (<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(<span class="keywordtype">void</span> **))PetscViewerAndFormatDestroy);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> scatter_create = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, <span class="keyword">auto</span> coeff) {</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> is_manager-&gt;isCreateProblemFieldAndRank(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(),</div>
<div class="line">                                                   <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;U&quot;</span>, coeff, coeff, is);</div>
<div class="line">    <span class="keywordtype">int</span> loc_size;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISGetLocalSize(is, &amp;loc_size);</div>
<div class="line">    <a class="code hl_typedef" href="namespace_eigen_matrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecCreateMPI(<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), loc_size, PETSC_DETERMINE, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line">    VecScatter scatter;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterCreate(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, is, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, PETSC_NULL, &amp;scatter);</div>
<div class="line">    <span class="keywordflow">return</span> std::make_tuple(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>),</div>
<div class="line">                           <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a>(scatter));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_time_monitor = [&amp;](<span class="keyword">auto</span> dm, <span class="keyword">auto</span> solver) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    boost::shared_ptr&lt;Monitor&gt; monitor_ptr(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_monitor.html">Monitor</a>(dm, <a class="code hl_variable" href="struct_contact.html#ab64bae7fbb254015787e568a3521bbe6">uXScatter</a>, <a class="code hl_variable" href="struct_contact.html#a388ade03cde971890b6b3b65b3186b4f">uYScatter</a>, <a class="code hl_variable" href="struct_contact.html#ad34f323d1598c882d77f4db10458181d">uZScatter</a>));</div>
<div class="line">    boost::shared_ptr&lt;ForcesAndSourcesCore&gt; null;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a112dfab22d28426fcd0ab2d61cf8f494">DMMoFEMTSSetMonitor</a>(dm, solver, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(),</div>
<div class="line">                               monitor_ptr, null, null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_essential_bc = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// This is low level pushing finite elements (pipelines) to solver</span></div>
<div class="line">    <span class="keyword">auto</span> ts_ctx_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">    <span class="keyword">auto</span> pre_proc_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line">    <span class="keyword">auto</span> post_proc_rhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line">    <span class="keyword">auto</span> post_proc_lhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add boundary condition scaling</span></div>
<div class="line">    <span class="keyword">auto</span> time_scale = boost::make_shared&lt;TimeScale&gt;();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_bc_hook_rhs = [&amp;]() {</div>
<div class="line">      <a class="code hl_struct" href="struct_mo_f_e_m_1_1_essential_pre_proc.html">EssentialPreProc&lt;DisplacementCubitBcData&gt;</a> hook(<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, pre_proc_ptr,</div>
<div class="line">                                                     {time_scale}, <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordflow">return</span> hook;</div>
<div class="line">    };</div>
<div class="line">    pre_proc_ptr-&gt;preProcessHook = get_bc_hook_rhs();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_post_proc_hook_rhs = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_essential_post_proc_rhs.html">EssentialPostProcRhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, post_proc_rhs_ptr, 1.);</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> get_post_proc_hook_lhs = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_essential_post_proc_lhs.html">EssentialPostProcLhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>, post_proc_lhs_ptr, 1.);</div>
<div class="line">    };</div>
<div class="line">    post_proc_rhs_ptr-&gt;postProcessHook = get_post_proc_hook_rhs();</div>
<div class="line"> </div>
<div class="line">    ts_ctx_ptr-&gt;getPreProcessIFunction().push_front(pre_proc_ptr);</div>
<div class="line">    ts_ctx_ptr-&gt;getPreProcessIJacobian().push_front(pre_proc_ptr);</div>
<div class="line">    ts_ctx_ptr-&gt;getPostProcessIFunction().push_back(post_proc_rhs_ptr);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a> != AssemblyType::SCHUR) {</div>
<div class="line">      post_proc_lhs_ptr-&gt;postProcessHook = get_post_proc_hook_lhs();</div>
<div class="line">      ts_ctx_ptr-&gt;getPostProcessIJacobian().push_back(post_proc_lhs_ptr);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_schur_pc = [&amp;](<span class="keyword">auto</span> solver) {</div>
<div class="line">    boost::shared_ptr&lt;SetUpSchur&gt; schur_ptr;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a> == AssemblyType::SCHUR) {</div>
<div class="line">      schur_ptr = <a class="code hl_function" href="struct_set_up_schur.html#a3e073d1191c6086862360ed028127b1f">SetUpSchur::createSetUpSchur</a>(<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(schur_ptr-&gt;setUp(solver), <span class="stringliteral">&quot;SetUpSchur::setUp&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> schur_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#acad361eff40ea5259c2d789789fdf8d6">ContactOps::CommonData::createTotalTraction</a>(<a class="code hl_variable" href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">mField</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_contact.html#ab64bae7fbb254015787e568a3521bbe6">uXScatter</a> = scatter_create(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, 0);</div>
<div class="line">  <a class="code hl_variable" href="struct_contact.html#a388ade03cde971890b6b3b65b3186b4f">uYScatter</a> = scatter_create(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, 1);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> == 3)</div>
<div class="line">    <a class="code hl_variable" href="struct_contact.html#ad34f323d1598c882d77f4db10458181d">uZScatter</a> = scatter_create(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, 2);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add extra finite elements to SNES solver pipelines to resolve essential</span></div>
<div class="line">  <span class="comment">// boundary conditions</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_essential_bc();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="contact_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a> == PETSC_TRUE) {</div>
<div class="line">    <span class="keyword">auto</span> solver = pip_mng-&gt;createTSIM();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(solver);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line">    <span class="keyword">auto</span> schur_pc_ptr = set_schur_pc(solver);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section_monitor(solver);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_time_monitor(dm, solver);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(solver, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(solver);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(solver, NULL);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="keyword">auto</span> solver = pip_mng-&gt;createTSIM2();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(solver);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line">    <span class="keyword">auto</span> DD = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line">    <span class="keyword">auto</span> schur_pc_ptr = set_schur_pc(solver);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section_monitor(solver);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_time_monitor(dm, solver);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TS2SetSolution(solver, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, DD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(solver);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(solver, NULL);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>.reset();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Check]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_contact.html#a6e707d5be362b8db96412d97d468780f">Contact::checkResults</a>() { <span class="keywordflow">return</span> 0; }<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Check]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  Py_Initialize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialisation of MoFEM/PETSc and MOAB data structures</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="_default_params_8hpp.html#a3538d3053f6520cc492dbbc38480d626">param_file</a>[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, <a class="code hl_variable" href="_default_params_8hpp.html#a3538d3053f6520cc492dbbc38480d626">param_file</a>, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add logging channel for CONTACT</span></div>
<div class="line">  <span class="keyword">auto</span> core_log = logging::core::get();</div>
<div class="line">  core_log-&gt;add_sink(</div>
<div class="line">      LogManager::createSink(LogManager::getStrmWorld(), <span class="stringliteral">&quot;CONTACT&quot;</span>));</div>
<div class="line">  LogManager::setLog(<span class="stringliteral">&quot;CONTACT&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, <span class="stringliteral">&quot;Indent&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc]</span></div>
<div class="line"><span class="comment"></span>    DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span>    moab::Core mb_instance;              <span class="comment">///&lt; mesh database</span></div>
<div class="line">    moab::Interface &amp;moab = mb_instance; <span class="comment">///&lt; mesh database interface</span><span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span>    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);           <span class="comment">///&lt; finite element database</span></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = core; <span class="comment">///&lt; finite element database interface</span><span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Load mesh]</span></div>
<div class="line"><span class="comment"></span>    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a> *<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getOptions();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;loadFile(<span class="stringliteral">&quot;&quot;</span>);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Load mesh]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [CONTACT]</span></div>
<div class="line"><span class="comment"></span>    <a class="code hl_struct" href="struct_contact.html">Contact</a> ex(m_field);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ex.runProblem();<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [CONTACT]</span></div>
<div class="line"><span class="comment"></span>  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  <span class="keywordflow">if</span> (Py_FinalizeEx() &lt; 0) {</div>
<div class="line">    exit(120);</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_set_up_schur_impl.html">SetUpSchurImpl</a> : <span class="keyword">public</span> <a class="code hl_struct" href="struct_set_up_schur.html">SetUpSchur</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_set_up_schur_impl.html">SetUpSchurImpl</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field) : <a class="code hl_struct" href="struct_set_up_schur.html">SetUpSchur</a>(), <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>(m_field) {}</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <a class="code hl_function" href="struct_set_up_schur_impl.html#a9fd535e0519178f6ec351e88d5c5abdb">~SetUpSchurImpl</a>() {</div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>.reset();</div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>.reset();</div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>.reset();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#a2ace4eb0ec26a0a08ab73620b065c87a">setUp</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;TS&gt;</a> solver);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#a864ccc3fc16e4a3f35cf2e6617b92e87">setEntities</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#ad94a3db6b3dec4db56e09c8412854ab7">setOperator</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#aab3190b1423630d97aab4796d445052e">setPC</a>(PC pc);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#a656abc3ab41e000082465c838aac55e0">createSubDM</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Mat&gt;</a> <a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>;</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Mat&gt;</a> <a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>;</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Mat&gt;</a> <a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> <a class="code hl_variable" href="struct_set_up_schur_impl.html#a17a16ea26fd623e5790213ae462e8c7b">subDM</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#a2ace4eb0ec26a0a08ab73620b065c87a">SetUpSchurImpl::setUp</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;TS&gt;</a> solver) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> pip = <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line"> </div>
<div class="line">  SNES snes;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(solver, &amp;snes);</div>
<div class="line">  KSP ksp;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetKSP(snes, &amp;ksp);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(ksp);</div>
<div class="line"> </div>
<div class="line">  PC pc;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(ksp, &amp;pc);</div>
<div class="line"> </div>
<div class="line">  PetscBool is_pcfs = PETSC_FALSE;</div>
<div class="line">  PetscObjectTypeCompare((PetscObject)pc, PCFIELDSPLIT, &amp;is_pcfs);</div>
<div class="line">  <span class="keywordflow">if</span> (is_pcfs) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Setup Schur pc&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a> || <a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a> || <a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Is expected that schur matrix is not allocated. This is &quot;</span></div>
<div class="line">          <span class="stringliteral">&quot;possible only is PC is set up twice&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a> = <a class="code hl_function" href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">createDMMatrix</a>(dm);</div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#ad4539efc560ba880c27fac15f1a25865">matDuplicate</a>(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>, MAT_DO_NOT_COPY_VALUES);</div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a17a16ea26fd623e5790213ae462e8c7b">subDM</a> = <a class="code hl_function" href="struct_set_up_schur_impl.html#a656abc3ab41e000082465c838aac55e0">createSubDM</a>();</div>
<div class="line">    <a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a> = <a class="code hl_function" href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">createDMMatrix</a>(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a17a16ea26fd623e5790213ae462e8c7b">subDM</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetBlockSize(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>, <a class="code hl_variable" href="elastic_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> ts_ctx_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(dm);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIJacobian(solver, <a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>, <a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>, TsSetIJacobian, ts_ctx_ptr.get());</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#ad94a3db6b3dec4db56e09c8412854ab7">setOperator</a>();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#aab3190b1423630d97aab4796d445052e">setPC</a>(pc);</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;No Schur pc&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    pip-&gt;getOpBoundaryLhsPipeline().push_front(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_begin.html">OpSchurAssembleBegin</a>());</div>
<div class="line">    pip-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_end.html">OpSchurAssembleEnd&lt;SCHUR_DGESV&gt;</a>({}, {}, {}, {}, {}));</div>
<div class="line">    pip-&gt;getOpDomainLhsPipeline().push_front(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_begin.html">OpSchurAssembleBegin</a>());</div>
<div class="line">    pip-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_end.html">OpSchurAssembleEnd&lt;SCHUR_DGESV&gt;</a>({}, {}, {}, {}, {}));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> post_proc_schur_lhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line">    post_proc_schur_lhs_ptr-&gt;postProcessHook = [<span class="keyword">this</span>,</div>
<div class="line">                                                post_proc_schur_lhs_ptr]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_essential_post_proc_lhs.html">EssentialPostProcLhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>, post_proc_schur_lhs_ptr, 1.)();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> ts_ctx_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(dm);</div>
<div class="line">    ts_ctx_ptr-&gt;getPostProcessIJacobian().push_back(post_proc_schur_lhs_ptr);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#a656abc3ab41e000082465c838aac55e0">SetUpSchurImpl::createSubDM</a>() {</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> sub_dm = <a class="code hl_function" href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <span class="keyword">auto</span> set_up = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(sub_dm, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), <span class="stringliteral">&quot;SUB&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(sub_dm, PETSC_TRUE);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(sub_dm, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(sub_dm, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(sub_dm);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(set_up(), <span class="stringliteral">&quot;sey up dm&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> sub_dm;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#ad94a3db6b3dec4db56e09c8412854ab7">SetUpSchurImpl::setOperator</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> eps_stab = 1e-4;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-eps_stab&quot;</span>, &amp;eps_stab,</div>
<div class="line">                               PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_class" href="class_b.html">B</a> =</div>
<div class="line">      <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOpStab&gt;::Assembly</a>&lt;<a class="code hl_enumvalue" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e">SCHUR</a>&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm&lt;IT&gt;</a>;</div>
<div class="line">  <span class="keyword">using </span>OpMassStab = B::OpMass&lt;3, SPACE_DIM * SPACE_DIM&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pip = <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="comment">// Boundary</span></div>
<div class="line">  <span class="keyword">auto</span> dm_is = <a class="code hl_function" href="namespace_mo_f_e_m.html#a8135ef8cbf44f79a23a6909a47e160a0">getDMSubData</a>(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a17a16ea26fd623e5790213ae462e8c7b">subDM</a>)-&gt;getSmartRowIs();</div>
<div class="line">  <span class="keyword">auto</span> ao_up = <a class="code hl_function" href="namespace_mo_f_e_m.html#a9f975731f30667ce5912e6969ff5978e">createAOMappingIS</a>(dm_is, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  pip-&gt;getOpBoundaryLhsPipeline().push_front(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_begin.html">OpSchurAssembleBegin</a>());</div>
<div class="line">  pip-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpMassStab(<span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;SIGMA&quot;</span>,</div>
<div class="line">                     [eps_stab](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) { <span class="keywordflow">return</span> eps_stab; }));</div>
<div class="line">  pip-&gt;getOpBoundaryLhsPipeline().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_end.html">OpSchurAssembleEnd&lt;SCHUR_DGESV&gt;</a>(</div>
<div class="line">      {<span class="stringliteral">&quot;SIGMA&quot;</span>}, {<span class="keyword">nullptr</span>}, {ao_up}, {<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>}, {<span class="keyword">false</span>}, <span class="keyword">false</span>));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Domain</span></div>
<div class="line">  pip-&gt;getOpDomainLhsPipeline().push_front(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_begin.html">OpSchurAssembleBegin</a>());</div>
<div class="line">  pip-&gt;getOpDomainLhsPipeline().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_schur_assemble_end.html">OpSchurAssembleEnd&lt;SCHUR_DGESV&gt;</a>(</div>
<div class="line">      {<span class="stringliteral">&quot;SIGMA&quot;</span>}, {<span class="keyword">nullptr</span>}, {ao_up}, {<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>}, {<span class="keyword">false</span>}, <span class="keyword">false</span>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pre_proc_schur_lhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line">  <span class="keyword">auto</span> post_proc_schur_lhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line"> </div>
<div class="line">  pre_proc_schur_lhs_ptr-&gt;preProcessHook = [<span class="keyword">this</span>]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Lhs Assemble Begin&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  post_proc_schur_lhs_ptr-&gt;postProcessHook = [<span class="keyword">this</span>, ao_up,</div>
<div class="line">                                              post_proc_schur_lhs_ptr]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Lhs Assemble End&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    *post_proc_schur_lhs_ptr-&gt;matAssembleSwitch = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> print_mat_norm = [<span class="keyword">this</span>](<span class="keyword">auto</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, std::string prefix) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordtype">double</span> nrm;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatNorm(a, NORM_FROBENIUS, &amp;nrm);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::noisy) &lt;&lt; prefix &lt;&lt; <span class="stringliteral">&quot; norm = &quot;</span> &lt;&lt; nrm;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_essential_post_proc_lhs.html">EssentialPostProcLhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>, post_proc_schur_lhs_ptr, 1, <a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>)();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAXPY(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>, 1, <a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>, SAME_NONZERO_PATTERN);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_essential_post_proc_lhs.html">EssentialPostProcLhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>, post_proc_schur_lhs_ptr, 1, <a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>, ao_up)();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_mat_norm(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">A</a>, <span class="stringliteral">&quot;A&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_mat_norm(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">P</a>, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_mat_norm(<a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>, <span class="stringliteral">&quot;S&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Lhs Assemble Finish&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> ts_ctx_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">  ts_ctx_ptr-&gt;getPreProcessIJacobian().push_front(pre_proc_schur_lhs_ptr);</div>
<div class="line">  ts_ctx_ptr-&gt;getPostProcessIJacobian().push_back(post_proc_schur_lhs_ptr);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_set_up_schur_impl.html#aab3190b1423630d97aab4796d445052e">SetUpSchurImpl::setPC</a>(PC pc) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> is;</div>
<div class="line">  <a class="code hl_variable" href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line">      <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, <a class="code hl_variable" href="elastic_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, is);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetSchurPre(pc, PC_FIELDSPLIT_SCHUR_PRE_USER, <a class="code hl_variable" href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">S</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">boost::shared_ptr&lt;SetUpSchur&gt;</div>
<div class="line"><a class="code hl_function" href="struct_set_up_schur.html#a3e073d1191c6086862360ed028127b1f">SetUpSchur::createSetUpSchur</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field) {</div>
<div class="line">  <span class="keywordflow">return</span> boost::shared_ptr&lt;SetUpSchur&gt;(<span class="keyword">new</span> <a class="code hl_struct" href="struct_set_up_schur_impl.html">SetUpSchurImpl</a>(m_field));</div>
<div class="line">}</div>
<div class="ttc" id="a_default_params_8hpp_html_a3538d3053f6520cc492dbbc38480d626"><div class="ttname"><a href="_default_params_8hpp.html#a3538d3053f6520cc492dbbc38480d626">param_file</a></div><div class="ttdeci">std::string param_file</div><div class="ttdef"><b>Definition:</b> <a href="_default_params_8hpp_source.html#l00113">DefaultParams.hpp:113</a></div></div>
<div class="ttc" id="a_hencky_ops_8hpp_html"><div class="ttname"><a href="_hencky_ops_8hpp.html">HenckyOps.hpp</a></div></div>
<div class="ttc" id="a_log_manager_8hpp_html_adacc7b9e7c4fa95cc0959ca359f999f5"><div class="ttname"><a href="_log_manager_8hpp.html#adacc7b9e7c4fa95cc0959ca359f999f5">MOFEM_LOG_SYNCHRONISE</a></div><div class="ttdeci">#define MOFEM_LOG_SYNCHRONISE(comm)</div><div class="ttdoc">Synchronise &quot;SYNC&quot; channel.</div><div class="ttdef"><b>Definition:</b> <a href="_log_manager_8hpp_source.html#l00345">LogManager.hpp:345</a></div></div>
<div class="ttc" id="a_matrix_function_8hpp_html"><div class="ttname"><a href="_matrix_function_8hpp.html">MatrixFunction.hpp</a></div></div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aacoustic_8cpp_html_ad68ed57e17c71816ecfad0ea6746c8d3"><div class="ttname"><a href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a></div><div class="ttdeci">void simple(double P1[], double P2[], double P3[], double c[], const int N)</div><div class="ttdef"><b>Definition:</b> <a href="acoustic_8cpp_source.html#l00069">acoustic.cpp:69</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a80b637c04b8c449d54efa75ab73b67df"><div class="ttname"><a href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::DomainEle DomainEle</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00034">child_and_parent.cpp:34</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_abd1f0351e167546d82adc28b4dd0e681"><div class="ttname"><a href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryEle BoundaryEle</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00039">child_and_parent.cpp:39</a></div></div>
<div class="ttc" id="aclass_b_html"><div class="ttname"><a href="class_b.html">B</a></div></div>
<div class="ttc" id="aclass_bi_linear_form_html"><div class="ttname"><a href="class_bi_linear_form.html">BiLinearForm</a></div></div>
<div class="ttc" id="aclass_linear_form_html"><div class="ttname"><a href="class_linear_form.html">LinearForm</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="aclass_u_blas_matrix_3_01double_01_4_html"><div class="ttname"><a href="class_u_blas_matrix_3_01double_01_4.html">UBlasMatrix&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a0447f1370e525557f8d7c6a1ed22be14"><div class="ttname"><a href="contact_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a></div><div class="ttdeci">double young_modulus</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00121">contact.cpp:121</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a1615e8c5bc3857dde832b2aadca5b3a1"><div class="ttname"><a href="contact_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a></div><div class="ttdeci">constexpr AssemblyType AT</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00028">contact.cpp:28</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a35627e7403adca4326c2a3963b9e6883"><div class="ttname"><a href="contact_8cpp.html#a35627e7403adca4326c2a3963b9e6883">spring_stiffness</a></div><div class="ttdeci">double spring_stiffness</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00124">contact.cpp:124</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="contact_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00123">contact.cpp:123</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a4a5fcbe78f3285ba525f15c780eb6cd5"><div class="ttname"><a href="contact_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a></div><div class="ttdeci">PetscBool is_quasi_static</div><div class="ttdoc">[Operators used for contact]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00117">contact.cpp:117</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a515d6c646a153203968575b56842c08c"><div class="ttname"><a href="contact_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a></div><div class="ttdeci">double alpha_damping</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00126">contact.cpp:126</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="contact_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00045">contact.cpp:45</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a571fc4d0022947a6d01a56a53d5668e6"><div class="ttname"><a href="contact_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a></div><div class="ttdeci">double poisson_ratio</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00122">contact.cpp:122</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a6f519040c96b14f7acb898e2835cfda9"><div class="ttname"><a href="contact_8cpp.html#a6f519040c96b14f7acb898e2835cfda9">vis_spring_stiffness</a></div><div class="ttdeci">double vis_spring_stiffness</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00125">contact.cpp:125</a></div></div>
<div class="ttc" id="acontact_8cpp_html_a80d402d10e8341004c0caf10133b80ab"><div class="ttname"><a href="contact_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00128">contact.cpp:128</a></div></div>
<div class="ttc" id="acontact_8cpp_html_aa8a9a346e33f38cd5ec82b6298e108da"><div class="ttname"><a href="contact_8cpp.html#aa8a9a346e33f38cd5ec82b6298e108da">OpSpringLhs</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; AT &gt;::BiLinearForm&lt; IT &gt;::OpMass&lt; 1, SPACE_DIM &gt; OpSpringLhs</div><div class="ttdoc">[Operators used for contact]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00109">contact.cpp:110</a></div></div>
<div class="ttc" id="acontact_8cpp_html_ac85d5511fdb8d162a7278bfb440ae420"><div class="ttname"><a href="contact_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00119">contact.cpp:119</a></div></div>
<div class="ttc" id="acontact_8cpp_html_ad0d0f13c8ee6366de69b040e99c2c8bb"><div class="ttname"><a href="contact_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a></div><div class="ttdeci">int geom_order</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00120">contact.cpp:120</a></div></div>
<div class="ttc" id="acontact_8cpp_html_aec587ce097653e0b6a636da7ac91d788"><div class="ttname"><a href="contact_8cpp.html#aec587ce097653e0b6a636da7ac91d788">OpSpringRhs</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; AT &gt;::LinearForm&lt; IT &gt;::OpBaseTimesVector&lt; 1, SPACE_DIM, 1 &gt; OpSpringRhs</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00111">contact.cpp:112</a></div></div>
<div class="ttc" id="acontact_8cpp_html_afcb7aec2c7aac959ba87ce35ab9a1b87"><div class="ttname"><a href="contact_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a></div><div class="ttdeci">constexpr FieldSpace CONTACT_SPACE</div><div class="ttdoc">[Specialisation for assembly]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00106">contact.cpp:106</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00123">definitions.h:123</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00372">definitions.h:372</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a></div><div class="ttdeci">FieldApproximationBase</div><div class="ttdoc">approximation base</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00058">definitions.h:58</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a35e0a7e42f81919e776c310c509598da"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a35e0a7e42f81919e776c310c509598da">LASTBASE</a></div><div class="ttdeci">@ LASTBASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00070">definitions.h:69</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a></div><div class="ttdeci">@ DEMKOWICZ_JACOBI_BASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00067">definitions.h:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00595">definitions.h:595</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a></div><div class="ttdeci">FieldSpace</div><div class="ttdoc">approximation spaces</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00082">definitions.h:82</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82">HCURL</a></div><div class="ttdeci">@ HCURL</div><div class="ttdoc">field with continuous tangents</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00086">definitions.h:86</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a></div><div class="ttdeci">@ HDIV</div><div class="ttdoc">field with continuous normal traction</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00087">definitions.h:87</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00215">definitions.h:215</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00346">definitions.h:346</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a793899f524a281eb88e3ff2b01ce6acb"><div class="ttname"><a href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a></div><div class="ttdeci">#define CHK_MOAB_THROW(err, msg)</div><div class="ttdoc">Check error code of MoAB function and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00576">definitions.h:576</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00416">definitions.h:416</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00535">definitions.h:535</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="aelastic_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="elastic_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition:</b> <a href="elastic_8cpp_source.html#l00017">elastic.cpp:17</a></div></div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_a2993c54e90f2427566f6d9dc8e5399a9"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#a2993c54e90f2427566f6d9dc8e5399a9">OpMass</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; PETSC &gt;::BiLinearForm&lt; GAUSS &gt;::OpMass&lt; 1, SPACE_DIM &gt; OpMass</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00058">fluid_structure_eigenproblem.cpp:59</a></div></div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_a4533c564ae8668ad476bad5d95a64434"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#a4533c564ae8668ad476bad5d95a64434">poisson_ratio</a></div><div class="ttdeci">auto poisson_ratio</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00089">fluid_structure_eigenproblem.cpp:89</a></div></div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_aaeeb615e0d0b09b810b29ec6086e0112"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', SPACE_DIM &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00065">fluid_structure_eigenproblem.cpp:65</a></div></div>
<div class="ttc" id="agroup__dm_html_ga175a29f4cdd0e7b7ae6cc2a0d7ed1704"><div class="ttname"><a href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">MoFEM::DMMoFEMCreateSubDM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateSubDM(DM subdm, DM dm, const char problem_name[])</div><div class="ttdoc">Must be called by user to set Sub DM MoFEM data structures.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00219">DMMoFEM.cpp:219</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00483">DMMoFEM.cpp:483</a></div></div>
<div class="ttc" id="agroup__dm_html_ga27babc6dfb0df28667682a98b5822739"><div class="ttname"><a href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">MoFEM::DMMoFEMSetSquareProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetSquareProblem(DM dm, PetscBool square_problem)</div><div class="ttdoc">set squared problem</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00442">DMMoFEM.cpp:442</a></div></div>
<div class="ttc" id="agroup__dm_html_ga62400e040ecf09a00b7ec3767fc7f124"><div class="ttname"><a href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">MoFEM::DMMoFEMAddSubFieldRow</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldRow(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00242">DMMoFEM.cpp:242</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00047">DMMoFEM.cpp:47</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01003">DMMoFEM.hpp:1003</a></div></div>
<div class="ttc" id="agroup__dm_html_gad0c8678dac27b8ef08e604406ba783c7"><div class="ttname"><a href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">MoFEM::createDMMatrix</a></div><div class="ttdeci">auto createDMMatrix(DM dm)</div><div class="ttdoc">Get smart matrix from DM.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l00988">DMMoFEM.hpp:988</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_ga2136fdd1cb130ca18f645e799b05569f"><div class="ttname"><a href="group__mofem__forms.html#ga2136fdd1cb130ca18f645e799b05569f">MoFEM::IntegrationType</a></div><div class="ttdeci">IntegrationType</div><div class="ttdoc">Form integrator integration types.</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00128">FormsIntegrators.hpp:128</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_gabb82cd10e89a1d4d25fa7756360b181b"><div class="ttname"><a href="group__mofem__forms.html#gabb82cd10e89a1d4d25fa7756360b181b">MoFEM::AssemblyType</a></div><div class="ttdeci">AssemblyType</div><div class="ttdoc">[Storage and set boundary conditions]</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00104">FormsIntegrators.hpp:104</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced"><div class="ttname"><a href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">MoFEM::GAUSS</a></div><div class="ttdeci">@ GAUSS</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00128">FormsIntegrators.hpp:128</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e"><div class="ttname"><a href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181baf431510044640b08e6f1d1b99701555e">MoFEM::SCHUR</a></div><div class="ttdeci">@ SCHUR</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00104">FormsIntegrators.hpp:104</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition:</b> <a href="_log_manager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga202c2d0258d78f4c0d60ecac64bf2252"><div class="ttname"><a href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a></div><div class="ttdeci">#define MOFEM_LOG_TAG(channel, tag)</div><div class="ttdoc">Tag channel.</div><div class="ttdef"><b>Definition:</b> <a href="_log_manager_8hpp_source.html#l00339">LogManager.hpp:339</a></div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa54e3cb5e57c57a8d03d9c4c7a21a80a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">MoFEM::MeshsetsManager::getCubitMeshsetPtr</a></div><div class="ttdeci">MoFEMErrorCode getCubitMeshsetPtr(const int ms_id, const CubitBCType cubit_bc_type, const CubitMeshSets **cubit_meshset_ptr) const</div><div class="ttdoc">get cubit meshset</div><div class="ttdef"><b>Definition:</b> <a href="_meshsets_manager_8cpp_source.html#l00505">MeshsetsManager.cpp:505</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a1ec1816fd2578b2c878e1e7d55ef0c0e"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a1ec1816fd2578b2c878e1e7d55ef0c0e">OpSpringLhs</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::BiLinearForm&lt; GAUSS &gt;::OpMass&lt; 1, 3 &gt; OpSpringLhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00065">multifield_plasticity.cpp:66</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a874eb87e8c107f75f4f4048683af4550"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a874eb87e8c107f75f4f4048683af4550">OpInertiaForce</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::LinearForm&lt; GAUSS &gt;::OpBaseTimesVector&lt; 1, 3, 1 &gt; OpInertiaForce</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00072">multifield_plasticity.cpp:73</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a9798b13657a78fb668c85f065d28ae9b"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a9798b13657a78fb668c85f065d28ae9b">OpSpringRhs</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::LinearForm&lt; GAUSS &gt;::OpBaseTimesVector&lt; 1, 3, 1 &gt; OpSpringRhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00069">multifield_plasticity.cpp:70</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html"><div class="ttname"><a href="namespace_contact_ops.html">ContactOps</a></div><div class="ttdef"><b>Definition:</b> <a href="_eshelbian_contact_8hpp_source.html#l00010">EshelbianContact.hpp:10</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a2eff5755e6337a8d2ad2efeca1807082"><div class="ttname"><a href="namespace_contact_ops.html#a2eff5755e6337a8d2ad2efeca1807082">ContactOps::opFactoryBoundaryLhs</a></div><div class="ttdeci">MoFEMErrorCode opFactoryBoundaryLhs(boost::ptr_deque&lt; ForcesAndSourcesCore::UserDataOperator &gt; &amp;pip, std::string sigma, std::string u)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00920">ContactOps.hpp:920</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a3449dc094e02f6a72aa4c5ea32c55e2c"><div class="ttname"><a href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">ContactOps::cn_contact</a></div><div class="ttdeci">double cn_contact</div><div class="ttdef"><b>Definition:</b> <a href="_eshelbian_contact_8hpp_source.html#l00019">EshelbianContact.hpp:19</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_aa054eea5f7b5dfa7769ea017e904c34b"><div class="ttname"><a href="namespace_contact_ops.html#aa054eea5f7b5dfa7769ea017e904c34b">ContactOps::opFactoryBoundaryToDomainLhs</a></div><div class="ttdeci">MoFEMErrorCode opFactoryBoundaryToDomainLhs(MoFEM::Interface &amp;m_field, boost::ptr_deque&lt; ForcesAndSourcesCore::UserDataOperator &gt; &amp;pip, std::string fe_domain_name, std::string sigma, std::string u, std::string geom, ForcesAndSourcesCore::RuleHookFun rule)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00884">ContactOps.hpp:884</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_adc0ef59ffb415069e3d6353638ff84fa"><div class="ttname"><a href="namespace_contact_ops.html#adc0ef59ffb415069e3d6353638ff84fa">ContactOps::opFactoryBoundaryRhs</a></div><div class="ttdeci">MoFEMErrorCode opFactoryBoundaryRhs(boost::ptr_deque&lt; ForcesAndSourcesCore::UserDataOperator &gt; &amp;pip, std::string sigma, std::string u)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00944">ContactOps.hpp:944</a></div></div>
<div class="ttc" id="anamespace_eigen_matrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespace_eigen_matrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_function_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="anamespace_hencky_ops_html"><div class="ttname"><a href="namespace_hencky_ops.html">HenckyOps</a></div><div class="ttdef"><b>Definition:</b> <a href="_hencky_ops_8hpp_source.html#l00011">HenckyOps.hpp:11</a></div></div>
<div class="ttc" id="anamespace_hencky_ops_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="_hencky_ops_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a112dfab22d28426fcd0ab2d61cf8f494"><div class="ttname"><a href="namespace_mo_f_e_m.html#a112dfab22d28426fcd0ab2d61cf8f494">MoFEM::DMMoFEMTSSetMonitor</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetMonitor(DM dm, TS ts, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">Set Monitor To TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01042">DMMoFEM.cpp:1042</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a1808931312a0a80aad5a5e769aa9e536"><div class="ttname"><a href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">MoFEM::getDMTsCtx</a></div><div class="ttdeci">auto getDMTsCtx(DM dm)</div><div class="ttdoc">Get TS context data structure used by DM.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01045">DMMoFEM.hpp:1045</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_petsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespace_mo_f_e_m.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_petsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_petsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a681e912e2d0043503d2da810dc186d73"><div class="ttname"><a href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">MoFEM::vectorDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; vectorDuplicate(Vec vec)</div><div class="ttdoc">Create duplicate vector of smart vector.</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00217">PetscSmartObj.hpp:217</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a8135ef8cbf44f79a23a6909a47e160a0"><div class="ttname"><a href="namespace_mo_f_e_m.html#a8135ef8cbf44f79a23a6909a47e160a0">MoFEM::getDMSubData</a></div><div class="ttdeci">auto getDMSubData(DM dm)</div><div class="ttdoc">Get sub problem data structure.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01061">DMMoFEM.hpp:1061</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a9f975731f30667ce5912e6969ff5978e"><div class="ttname"><a href="namespace_mo_f_e_m.html#a9f975731f30667ce5912e6969ff5978e">MoFEM::createAOMappingIS</a></div><div class="ttdeci">auto createAOMappingIS(IS isapp, IS ispetsc)</div><div class="ttdoc">Creates an application mapping using two index sets.</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00302">PetscSmartObj.hpp:302</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_abee82d436d03244c6886fc99f71116f0"><div class="ttname"><a href="namespace_mo_f_e_m.html#abee82d436d03244c6886fc99f71116f0">MoFEM::PetscOptionsGetEList</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetEList(PetscOptions *, const char pre[], const char name[], const char *const *list, PetscInt next, PetscInt *value, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_petsc_8hpp_source.html#l00203">DeprecatedPetsc.hpp:203</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ad4539efc560ba880c27fac15f1a25865"><div class="ttname"><a href="namespace_mo_f_e_m.html#ad4539efc560ba880c27fac15f1a25865">MoFEM::matDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; matDuplicate(Mat mat, MatDuplicateOption op)</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00230">PetscSmartObj.hpp:230</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ae6b64312d73966f4cc41953bc77a4ba3"><div class="ttname"><a href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">MoFEM::createDM</a></div><div class="ttdeci">auto createDM(MPI_Comm comm, const std::string dm_type_name)</div><div class="ttdoc">Creates smart DM object.</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00137">PetscSmartObj.hpp:137</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a0447f1370e525557f8d7c6a1ed22be14"><div class="ttname"><a href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a></div><div class="ttdeci">double young_modulus</div><div class="ttdoc">Young modulus.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00168">plastic.cpp:168</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a1615e8c5bc3857dde832b2aadca5b3a1"><div class="ttname"><a href="plastic_8cpp.html#a1615e8c5bc3857dde832b2aadca5b3a1">AT</a></div><div class="ttdeci">constexpr AssemblyType AT</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00044">plastic.cpp:44</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a27f07ec7ec1b09221f6f421d6d7c9e58"><div class="ttname"><a href="plastic_8cpp.html#a27f07ec7ec1b09221f6f421d6d7c9e58">IT</a></div><div class="ttdeci">constexpr IntegrationType IT</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00047">plastic.cpp:47</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00187">plastic.cpp:187</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a49d2a41e935ccc68adc5a9268619cba1"><div class="ttname"><a href="plastic_8cpp.html#a49d2a41e935ccc68adc5a9268619cba1">EXECUTABLE_DIMENSION</a></div><div class="ttdeci">#define EXECUTABLE_DIMENSION</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00013">plastic.cpp:13</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a4a5fcbe78f3285ba525f15c780eb6cd5"><div class="ttname"><a href="plastic_8cpp.html#a4a5fcbe78f3285ba525f15c780eb6cd5">is_quasi_static</a></div><div class="ttdeci">PetscBool is_quasi_static</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00186">plastic.cpp:186</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a515d6c646a153203968575b56842c08c"><div class="ttname"><a href="plastic_8cpp.html#a515d6c646a153203968575b56842c08c">alpha_damping</a></div><div class="ttdeci">double alpha_damping</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00188">plastic.cpp:188</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a80d402d10e8341004c0caf10133b80ab"><div class="ttname"><a href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00166">plastic.cpp:166</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ad0d0f13c8ee6366de69b040e99c2c8bb"><div class="ttname"><a href="plastic_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a></div><div class="ttdeci">int geom_order</div><div class="ttdoc">Order if fixed.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00184">plastic.cpp:184</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_afcb7aec2c7aac959ba87ce35ab9a1b87"><div class="ttname"><a href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a></div><div class="ttdeci">constexpr FieldSpace CONTACT_SPACE</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00052">plastic.cpp:52</a></div></div>
<div class="ttc" id="aprism__polynomial__approximation_8cpp_html_a67c2672e3debe9c63fb239645337a1bd"><div class="ttname"><a href="prism__polynomial__approximation_8cpp.html#a67c2672e3debe9c63fb239645337a1bd">approx_order</a></div><div class="ttdeci">static constexpr int approx_order</div><div class="ttdef"><b>Definition:</b> <a href="prism__polynomial__approximation_8cpp_source.html#l00014">prism_polynomial_approximation.cpp:14</a></div></div>
<div class="ttc" id="astruct_boundary_ele_op_stab_html"><div class="ttname"><a href="struct_boundary_ele_op_stab.html">BoundaryEleOpStab</a></div><div class="ttdoc">Element used to specialise assembly.</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00086">contact.cpp:86</a></div></div>
<div class="ttc" id="astruct_contact_1_1_scaled_time_scale_html_ab059a32288b8119751175fd03fe0574d"><div class="ttname"><a href="struct_contact_1_1_scaled_time_scale.html#ab059a32288b8119751175fd03fe0574d">Contact::ScaledTimeScale::getScale</a></div><div class="ttdeci">double getScale(const double time)</div><div class="ttdoc">Get scaling at a given time.</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00178">contact.cpp:178</a></div></div>
<div class="ttc" id="astruct_contact_html"><div class="ttname"><a href="struct_contact.html">Contact</a></div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00152">contact.cpp:152</a></div></div>
<div class="ttc" id="astruct_contact_html_a2b633ccf32e1328f60d0f1413dd4d63f"><div class="ttname"><a href="struct_contact.html#a2b633ccf32e1328f60d0f1413dd4d63f">Contact::tsSolve</a></div><div class="ttdeci">MoFEMErrorCode tsSolve()</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00629">contact.cpp:629</a></div></div>
<div class="ttc" id="astruct_contact_html_a388ade03cde971890b6b3b65b3186b4f"><div class="ttname"><a href="struct_contact.html#a388ade03cde971890b6b3b65b3186b4f">Contact::uYScatter</a></div><div class="ttdeci">std::tuple&lt; SmartPetscObj&lt; Vec &gt;, SmartPetscObj&lt; VecScatter &gt; &gt; uYScatter</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00169">contact.cpp:169</a></div></div>
<div class="ttc" id="astruct_contact_html_a399ff55b433aca15a11c0883d5471fa7"><div class="ttname"><a href="struct_contact.html#a399ff55b433aca15a11c0883d5471fa7">Contact::runProblem</a></div><div class="ttdeci">MoFEMErrorCode runProblem()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00185">contact.cpp:185</a></div></div>
<div class="ttc" id="astruct_contact_html_a41561758ba88f46157a75abefe7b6b14"><div class="ttname"><a href="struct_contact.html#a41561758ba88f46157a75abefe7b6b14">Contact::setupProblem</a></div><div class="ttdeci">MoFEMErrorCode setupProblem()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00198">contact.cpp:198</a></div></div>
<div class="ttc" id="astruct_contact_html_a478ec2f06ecfd61b3130fa8669bac0ca"><div class="ttname"><a href="struct_contact.html#a478ec2f06ecfd61b3130fa8669bac0ca">Contact::OPs</a></div><div class="ttdeci">MoFEMErrorCode OPs()</div><div class="ttdoc">[Boundary condition]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00411">contact.cpp:411</a></div></div>
<div class="ttc" id="astruct_contact_html_a4bdef6ab8fff7a1edbc2209ea3212aeb"><div class="ttname"><a href="struct_contact.html#a4bdef6ab8fff7a1edbc2209ea3212aeb">Contact::createCommonData</a></div><div class="ttdeci">MoFEMErrorCode createCommonData()</div><div class="ttdoc">[Set up problem]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00313">contact.cpp:313</a></div></div>
<div class="ttc" id="astruct_contact_html_a6e707d5be362b8db96412d97d468780f"><div class="ttname"><a href="struct_contact.html#a6e707d5be362b8db96412d97d468780f">Contact::checkResults</a></div><div class="ttdeci">MoFEMErrorCode checkResults()</div><div class="ttdoc">[Solve]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00770">contact.cpp:770</a></div></div>
<div class="ttc" id="astruct_contact_html_a8e9e2a7dd4356f22c99e2c1597a94d6a"><div class="ttname"><a href="struct_contact.html#a8e9e2a7dd4356f22c99e2c1597a94d6a">Contact::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00159">contact.cpp:159</a></div></div>
<div class="ttc" id="astruct_contact_html_ab60d85cbc4c204f7d7096b4f0de6df4f"><div class="ttname"><a href="struct_contact.html#ab60d85cbc4c204f7d7096b4f0de6df4f">Contact::bC</a></div><div class="ttdeci">MoFEMErrorCode bC()</div><div class="ttdoc">[Create common data]</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00374">contact.cpp:374</a></div></div>
<div class="ttc" id="astruct_contact_html_ab64bae7fbb254015787e568a3521bbe6"><div class="ttname"><a href="struct_contact.html#ab64bae7fbb254015787e568a3521bbe6">Contact::uXScatter</a></div><div class="ttdeci">std::tuple&lt; SmartPetscObj&lt; Vec &gt;, SmartPetscObj&lt; VecScatter &gt; &gt; uXScatter</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00168">contact.cpp:168</a></div></div>
<div class="ttc" id="astruct_contact_html_ad34f323d1598c882d77f4db10458181d"><div class="ttname"><a href="struct_contact.html#ad34f323d1598c882d77f4db10458181d">Contact::uZScatter</a></div><div class="ttdeci">std::tuple&lt; SmartPetscObj&lt; Vec &gt;, SmartPetscObj&lt; VecScatter &gt; &gt; uZScatter</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00170">contact.cpp:170</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_aae635e19c3c8a2f55be1cc5a1285557f"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a></div><div class="ttdeci">static SmartPetscObj&lt; Vec &gt; totalTraction</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00028">ContactOps.hpp:28</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_acad361eff40ea5259c2d789789fdf8d6"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#acad361eff40ea5259c2d789789fdf8d6">ContactOps::CommonData::createTotalTraction</a></div><div class="ttdeci">static auto createTotalTraction(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00030">ContactOps.hpp:30</a></div></div>
<div class="ttc" id="astruct_elements_and_ops_html"><div class="ttname"><a href="struct_elements_and_ops.html">ElementsAndOps</a></div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00018">child_and_parent.cpp:18</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_add_flux_to_lhs_pipeline_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_add_flux_to_lhs_pipeline_impl.html">MoFEM::AddFluxToLhsPipelineImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00049">Natural.hpp:49</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_add_flux_to_rhs_pipeline_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_add_flux_to_rhs_pipeline_impl.html">MoFEM::AddFluxToRhsPipelineImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00046">Natural.hpp:46</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_add_h_o_ops_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_add_h_o_ops.html">MoFEM::AddHOOps</a></div><div class="ttdoc">Add operators pushing bases from local to physical configuration.</div><div class="ttdef"><b>Definition:</b> <a href="_h_o_data_operators_8hpp_source.html#l00503">HODataOperators.hpp:503</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bc_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bc_manager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="_bc_manager_8hpp_source.html#l00025">BcManager.hpp:25</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_comm_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_comm_interface.html">MoFEM::CommInterface</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="_comm_interface_8hpp_source.html#l00021">CommInterface.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a9b2bc8c1b980f49d31a0b5f7fbe756f5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_displacement_cubit_bc_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_displacement_cubit_bc_data.html">MoFEM::DisplacementCubitBcData</a></div><div class="ttdoc">Definition of the displacement bc data structure.</div><div class="ttdef"><b>Definition:</b> <a href="_b_c_data_8hpp_source.html#l00072">BCData.hpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l00127">EntitiesFieldData.hpp:127</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_essential_post_proc_lhs_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_essential_post_proc_lhs.html">MoFEM::EssentialPostProcLhs</a></div><div class="ttdoc">Class (Function) to enforce essential constrains on the left hand side diagonal.</div><div class="ttdef"><b>Definition:</b> <a href="_essential_8hpp_source.html#l00047">Essential.hpp:47</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_essential_post_proc_rhs_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_essential_post_proc_rhs.html">MoFEM::EssentialPostProcRhs</a></div><div class="ttdoc">Class (Function) to enforce essential constrains on the right hand side diagonal.</div><div class="ttdef"><b>Definition:</b> <a href="_essential_8hpp_source.html#l00055">Essential.hpp:55</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_essential_pre_proc_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_essential_pre_proc.html">MoFEM::EssentialPreProc</a></div><div class="ttdoc">Class (Function) to enforce essential constrains.</div><div class="ttdef"><b>Definition:</b> <a href="_essential_8hpp_source.html#l00039">Essential.hpp:39</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition:</b> <a href="_face_element_forces_and_sources_core_8hpp_source.html#l00095">FaceElementForcesAndSourcesCore.hpp:96</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l00546">ForcesAndSourcesCore.hpp:546</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_aa2f3a05951e205c8f7f0058ccc088400"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa2f3a05951e205c8f7f0058ccc088400">MoFEM::ForcesAndSourcesCore::UserDataOperator::getKSPA</a></div><div class="ttdeci">Mat getKSPA() const</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01092">ForcesAndSourcesCore.hpp:1092</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_ae6b967017977d2f79550627e2a6e89bd"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">MoFEM::ForcesAndSourcesCore::UserDataOperator::getKSPB</a></div><div class="ttdeci">Mat getKSPB() const</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01100">ForcesAndSourcesCore.hpp:1100</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forms_integrators_1_1_assembly_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">MoFEM::FormsIntegrators::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00296">FormsIntegrators.hpp:296</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_i_s_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_i_s_manager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition:</b> <a href="_i_s_manager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="_meshsets_manager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_bi_linear_form_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_bi_linear_form.html">MoFEM::NaturalBC::Assembly::BiLinearForm</a></div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00074">Natural.hpp:74</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_linear_form_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_1_1_linear_form.html">MoFEM::NaturalBC::Assembly::LinearForm</a></div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00067">Natural.hpp:67</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly.html">MoFEM::NaturalBC::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00065">Natural.hpp:65</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_base_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_base_impl.html">MoFEM::OpBaseImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00170">FormsIntegrators.hpp:170</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_base_impl_html_aff467503ecf30d8b2d0298f424658f34"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_base_impl.html#aff467503ecf30d8b2d0298f424658f34">MoFEM::OpBaseImpl::MatSetValuesHook</a></div><div class="ttdeci">boost::function&lt; MoFEMErrorCode(ForcesAndSourcesCore::UserDataOperator *op_ptr, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, MatrixDouble &amp;m)&gt; MatSetValuesHook</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00207">FormsIntegrators.hpp:210</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">MoFEM::OpCalculateVectorFieldValuesFromPetscVecImpl</a></div><div class="ttdoc">Approximate field values for given petsc vector.</div><div class="ttdef"><b>Definition:</b> <a href="_user_data_operators_8hpp_source.html#l00577">UserDataOperators.hpp:578</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">MoFEM::OpCalculateVectorFieldValues</a></div><div class="ttdoc">Get values at integration pts for tensor filed rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="_user_data_operators_8hpp_source.html#l00448">UserDataOperators.hpp:450</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_flux_lhs_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_flux_lhs_impl.html">MoFEM::OpFluxLhsImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00043">Natural.hpp:43</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_flux_rhs_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_flux_rhs_impl.html">MoFEM::OpFluxRhsImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="_natural_8hpp_source.html#l00039">Natural.hpp:39</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_schur_assemble_begin_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_schur_assemble_begin.html">MoFEM::OpSchurAssembleBegin</a></div><div class="ttdoc">Clear Schur complement internal data.</div><div class="ttdef"><b>Definition:</b> <a href="_schur_8hpp_source.html#l00022">Schur.hpp:22</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_schur_assemble_end_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_schur_assemble_end.html">MoFEM::OpSchurAssembleEnd</a></div><div class="ttdoc">Assemble Schur complement.</div><div class="ttdef"><b>Definition:</b> <a href="_schur_8hpp_source.html#l00104">Schur.hpp:104</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_h_o_weights_on_sub_dim_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_h_o_weights_on_sub_dim.html">MoFEM::OpSetHOWeightsOnSubDim</a></div><div class="ttdef"><b>Definition:</b> <a href="_h_o_data_operators_8hpp_source.html#l00145">HODataOperators.hpp:145</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">MoFEM::PipelineManager::ElementsAndOpsByDim</a></div><div class="ttdef"><b>Definition:</b> <a href="_pipeline_manager_8hpp_source.html#l00038">PipelineManager.hpp:38</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager.html">MoFEM::PipelineManager</a></div><div class="ttdoc">PipelineManager interface.</div><div class="ttdef"><b>Definition:</b> <a href="_pipeline_manager_8hpp_source.html#l00024">PipelineManager.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_projection10_node_coords_on_field_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition:</b> <a href="_projection10_node_coords_on_field_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_simple_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_simple.html">MoFEM::Simple</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="_simple_8hpp_source.html#l00027">Simple.hpp:27</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_smart_petsc_obj_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">MoFEM::SmartPetscObj</a></div><div class="ttdoc">intrusive_ptr for managing petsc objects</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00078">PetscSmartObj.hpp:79</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_time_scale_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_time_scale.html">MoFEM::TimeScale</a></div><div class="ttdoc">Force scale operator for reading two columns.</div><div class="ttdef"><b>Definition:</b> <a href="_scaling_method_8hpp_source.html#l00032">ScalingMethod.hpp:32</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_time_scale_html_a484091f75279db84601ea772abe3f530"><div class="ttname"><a href="struct_mo_f_e_m_1_1_time_scale.html#a484091f75279db84601ea772abe3f530">MoFEM::TimeScale::getScale</a></div><div class="ttdeci">double getScale(const double time)</div><div class="ttdoc">Get scaling at a given time.</div><div class="ttdef"><b>Definition:</b> <a href="_scaling_method_8cpp_source.html#l00121">ScalingMethod.cpp:121</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_time_scale_html_a6fc95cd5d66b6a50035771ac36c3ca3a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_time_scale.html#a6fc95cd5d66b6a50035771ac36c3ca3a">MoFEM::TimeScale::TimeScale</a></div><div class="ttdeci">TimeScale(std::string file_name=&quot;&quot;, bool error_if_file_not_given=false)</div><div class="ttdoc">TimeScale constructor.</div><div class="ttdef"><b>Definition:</b> <a href="_scaling_method_8cpp_source.html#l00022">ScalingMethod.cpp:22</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface refernce to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="_volume_element_forces_and_sources_core_8hpp_source.html#l00108">VolumeElementForcesAndSourcesCore.hpp:109</a></div></div>
<div class="ttc" id="astruct_monitor_html"><div class="ttname"><a href="struct_monitor.html">Monitor</a></div><div class="ttdoc">[Push operators to pipeline]</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00783">dynamic_first_order_con_law.cpp:783</a></div></div>
<div class="ttc" id="astruct_set_up_schur_html"><div class="ttname"><a href="struct_set_up_schur.html">SetUpSchur</a></div><div class="ttdoc">[Push operators to pipeline]</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00751">plastic.cpp:751</a></div></div>
<div class="ttc" id="astruct_set_up_schur_html_a0a92b8c06f626bcae7cb9bf3628c713e"><div class="ttname"><a href="struct_set_up_schur.html#a0a92b8c06f626bcae7cb9bf3628c713e">SetUpSchur::SetUpSchur</a></div><div class="ttdeci">SetUpSchur()=default</div></div>
<div class="ttc" id="astruct_set_up_schur_html_a3e073d1191c6086862360ed028127b1f"><div class="ttname"><a href="struct_set_up_schur.html#a3e073d1191c6086862360ed028127b1f">SetUpSchur::createSetUpSchur</a></div><div class="ttdeci">static boost::shared_ptr&lt; SetUpSchur &gt; createSetUpSchur(MoFEM::Interface &amp;m_field, SmartPetscObj&lt; DM &gt; sub_dm, SmartPetscObj&lt; IS &gt; field_split_it, SmartPetscObj&lt; AO &gt; ao_map)</div><div class="ttdoc">Create data structure for handling Schur complement.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l01470">plastic.cpp:1470</a></div></div>
<div class="ttc" id="astruct_set_up_schur_html_ad71a485a37eeb5d74e76898f61a5dcca"><div class="ttname"><a href="struct_set_up_schur.html#ad71a485a37eeb5d74e76898f61a5dcca">SetUpSchur::setUp</a></div><div class="ttdeci">virtual MoFEMErrorCode setUp(TS solver)=0</div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html"><div class="ttname"><a href="struct_set_up_schur_impl.html">SetUpSchurImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="_set_up_schur_impl_8cpp_source.html#l00009">SetUpSchurImpl.cpp:9</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a13c26fd9e2dc0f4af6b2b09f56ec6c14"><div class="ttname"><a href="struct_set_up_schur_impl.html#a13c26fd9e2dc0f4af6b2b09f56ec6c14">SetUpSchurImpl::A</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; A</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00852">contact.cpp:852</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a17a16ea26fd623e5790213ae462e8c7b"><div class="ttname"><a href="struct_set_up_schur_impl.html#a17a16ea26fd623e5790213ae462e8c7b">SetUpSchurImpl::subDM</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; subDM</div><div class="ttdoc">field split sub dm</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l01292">plastic.cpp:1292</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a2ace4eb0ec26a0a08ab73620b065c87a"><div class="ttname"><a href="struct_set_up_schur_impl.html#a2ace4eb0ec26a0a08ab73620b065c87a">SetUpSchurImpl::setUp</a></div><div class="ttdeci">MoFEMErrorCode setUp(KSP solver)</div><div class="ttdef"><b>Definition:</b> <a href="_set_up_schur_impl_8cpp_source.html#l00039">SetUpSchurImpl.cpp:39</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a2ea566e74cfe2a386828a77934393325"><div class="ttname"><a href="struct_set_up_schur_impl.html#a2ea566e74cfe2a386828a77934393325">SetUpSchurImpl::S</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; S</div><div class="ttdef"><b>Definition:</b> <a href="_set_up_schur_impl_8cpp_source.html#l00030">SetUpSchurImpl.cpp:30</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a35ef0c5c3dc7e742c5153042bc3de237"><div class="ttname"><a href="struct_set_up_schur_impl.html#a35ef0c5c3dc7e742c5153042bc3de237">SetUpSchurImpl::P</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; P</div><div class="ttdef"><b>Definition:</b> <a href="_set_up_schur_impl_8cpp_source.html#l00029">SetUpSchurImpl.cpp:29</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a656abc3ab41e000082465c838aac55e0"><div class="ttname"><a href="struct_set_up_schur_impl.html#a656abc3ab41e000082465c838aac55e0">SetUpSchurImpl::createSubDM</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; createSubDM()</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00925">contact.cpp:925</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a864ccc3fc16e4a3f35cf2e6617b92e87"><div class="ttname"><a href="struct_set_up_schur_impl.html#a864ccc3fc16e4a3f35cf2e6617b92e87">SetUpSchurImpl::setEntities</a></div><div class="ttdeci">MoFEMErrorCode setEntities()</div><div class="ttdef"><b>Definition:</b> <a href="elastic_8cpp_source.html#l00907">elastic.cpp:907</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_a9fd535e0519178f6ec351e88d5c5abdb"><div class="ttname"><a href="struct_set_up_schur_impl.html#a9fd535e0519178f6ec351e88d5c5abdb">SetUpSchurImpl::~SetUpSchurImpl</a></div><div class="ttdeci">virtual ~SetUpSchurImpl()</div><div class="ttdef"><b>Definition:</b> <a href="_set_up_schur_impl_8cpp_source.html#l00021">SetUpSchurImpl.cpp:21</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_aab3190b1423630d97aab4796d445052e"><div class="ttname"><a href="struct_set_up_schur_impl.html#aab3190b1423630d97aab4796d445052e">SetUpSchurImpl::setPC</a></div><div class="ttdeci">MoFEMErrorCode setPC(PC pc)</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l01029">contact.cpp:1029</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_ad94a3db6b3dec4db56e09c8412854ab7"><div class="ttname"><a href="struct_set_up_schur_impl.html#ad94a3db6b3dec4db56e09c8412854ab7">SetUpSchurImpl::setOperator</a></div><div class="ttdeci">MoFEMErrorCode setOperator()</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00941">contact.cpp:941</a></div></div>
<div class="ttc" id="astruct_set_up_schur_impl_html_aec7230c83e20f70ec2b4ad35896e72dc"><div class="ttname"><a href="struct_set_up_schur_impl.html#aec7230c83e20f70ec2b4ad35896e72dc">SetUpSchurImpl::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition:</b> <a href="_set_up_schur_impl_8cpp_source.html#l00035">SetUpSchurImpl.cpp:35</a></div></div>
</div><!-- fragment --> <div class="fragment"><div class="line"> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file ContactOps.hpp</span></div>
<div class="line"><span class="comment"> * \example ContactOps.hpp</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __CONTACTOPS_HPP__</span></div>
<div class="line"><span class="preprocessor">#define __CONTACTOPS_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_contact_ops.html">ContactOps</a> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Common data]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">struct </span><a class="code hl_struct" href="struct_common_data.html">CommonData</a> : <span class="keyword">public</span> boost::enable_shared_from_this&lt;CommonData&gt; {</div>
<div class="line">  <span class="comment">// MatrixDouble contactStress;</span></div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a4a0843d723416b4f6de26172d479b40a">contactTraction</a>;</div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a73cae071096b10b8a752e554e99eb6e2">contactDisp</a>;</div>
<div class="line"> </div>
<div class="line">  VectorDouble <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a156ca0a3ebf97981cc3886e583a6bf8a">sdfVals</a>; <span class="comment">///&lt; size is equal to number of gauss points on element</span></div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a9e5abc73f42d4b846e34a23d4091b5b0">gradsSdf</a>; <span class="comment">///&lt; nb of rows is equals to dimension, and nb of cols</span><span class="comment"></span></div>
<div class="line"><span class="comment">                         ///&lt; is equals to number of gauss points on element</span></div>
<div class="line"><span class="comment"></span>  MatrixDouble <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a8715a01efb0d29bec0d727f13cdb1915">hessSdf</a>;  <span class="comment">///&lt; nb of rows is equals to nb of element of symmetric</span><span class="comment"></span></div>
<div class="line"><span class="comment">                        ///&lt; matrix, and nb of cols is equals to number of gauss</span></div>
<div class="line"><span class="comment">                        ///&lt; points on element</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keyword">static</span> SmartPetscObj&lt;Vec&gt;</div>
<div class="line">      <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">totalTraction</a>; <span class="comment">// User have to release and create vector when appropiate.</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#acad361eff40ea5259c2d789789fdf8d6">createTotalTraction</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field) {</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> ghosts[] = {0, 1, 2};</div>
<div class="line">    <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">totalTraction</a> =</div>
<div class="line">        createGhostVector(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(),</div>
<div class="line"> </div>
<div class="line">                          (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) ? 3 : 0, 3,</div>
<div class="line"> </div>
<div class="line">                          (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) ? 0 : 3, ghosts);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">totalTraction</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#a5e05ac3846de04dbea1b09c79a775a87">getFTensor1TotalTraction</a>() {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">CommonData::totalTraction</a>) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> *t_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(VecGetArrayRead(<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">CommonData::totalTraction</a>, &amp;t_ptr),</div>
<div class="line">                        <span class="stringliteral">&quot;get array&quot;</span>);</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>{t_ptr[0], t_ptr[1], t_ptr[2]};</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(VecRestoreArrayRead(<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">CommonData::totalTraction</a>, &amp;t_ptr),</div>
<div class="line">                        <span class="stringliteral">&quot;restore array&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>{0., 0., 0.};</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#a713eb1a9fe7ebbe37e10e12a1497d2f9">contactTractionPtr</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> boost::shared_ptr&lt;MatrixDouble&gt;(shared_from_this(),</div>
<div class="line">                                           &amp;<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a4a0843d723416b4f6de26172d479b40a">contactTraction</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#ae161b9f0e428ca758abfdc3df05d11e0">contactDispPtr</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> boost::shared_ptr&lt;MatrixDouble&gt;(shared_from_this(), &amp;<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a73cae071096b10b8a752e554e99eb6e2">contactDisp</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#affcb1181ef02d0dba1f7a4fb23ea25d2">sdfPtr</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> boost::shared_ptr&lt;VectorDouble&gt;(shared_from_this(), &amp;<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a156ca0a3ebf97981cc3886e583a6bf8a">sdfVals</a>);</div>
<div class="line">  } </div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#a93960a0684f18798cced6c9604032a7d">gradSdfPtr</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> boost::shared_ptr&lt;MatrixDouble&gt;(shared_from_this(), &amp;<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a9e5abc73f42d4b846e34a23d4091b5b0">gradsSdf</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code hl_function" href="struct_contact_ops_1_1_common_data.html#a74572bf0df1fbe72541825d3b1e03d36">hessSdfPtr</a>() {</div>
<div class="line">    <span class="keywordflow">return</span> boost::shared_ptr&lt;MatrixDouble&gt;(shared_from_this(), &amp;<a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#a8715a01efb0d29bec0d727f13cdb1915">hessSdf</a>);</div>
<div class="line">  } </div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">SmartPetscObj&lt;Vec&gt; <a class="code hl_variable" href="struct_contact_ops_1_1_common_data.html#aae635e19c3c8a2f55be1cc5a1285557f">CommonData::totalTraction</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Common data]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Surface distance function from python]</span></div>
<div class="line"><span class="comment"></span><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line"><span class="keyword">struct </span>SDFPython {</div>
<div class="line">  SDFPython() = <span class="keywordflow">default</span>;</div>
<div class="line">  <span class="keyword">virtual</span> ~SDFPython() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> sdfInit(<span class="keyword">const</span> std::string py_file) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// create main module</span></div>
<div class="line">      <span class="keyword">auto</span> main_module = bp::import(<span class="stringliteral">&quot;__main__&quot;</span>);</div>
<div class="line">      mainNamespace = main_module.attr(<span class="stringliteral">&quot;__dict__&quot;</span>);</div>
<div class="line">      bp::exec_file(py_file.c_str(), mainNamespace, mainNamespace);</div>
<div class="line">      <span class="comment">// create a reference to python function</span></div>
<div class="line">      sdfFun = mainNamespace[<span class="stringliteral">&quot;sdf&quot;</span>];</div>
<div class="line">      sdfGradFun = mainNamespace[<span class="stringliteral">&quot;grad_sdf&quot;</span>];</div>
<div class="line">      sdfHessFun = mainNamespace[<span class="stringliteral">&quot;hess_sdf&quot;</span>];</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (bp::error_already_set <span class="keyword">const</span> &amp;) {</div>
<div class="line">      <span class="comment">// print all other errors to stderr</span></div>
<div class="line">      PyErr_Print();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;Python error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keyword">typename</span> T&gt;</div>
<div class="line">  <span class="keyword">inline</span> std::vector&lt;T&gt;</div>
<div class="line">  py_list_to_std_vector(<span class="keyword">const</span> boost::python::object &amp;iterable) {</div>
<div class="line">    <span class="keywordflow">return</span> std::vector&lt;T&gt;(boost::python::stl_input_iterator&lt;T&gt;(iterable),</div>
<div class="line">                          boost::python::stl_input_iterator&lt;T&gt;());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalSdf(</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz,</div>
<div class="line">      <span class="keywordtype">double</span> &amp;<a class="code hl_namespace" href="namespacesdf.html">sdf</a></div>
<div class="line"> </div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// call python function</span></div>
<div class="line">      <a class="code hl_namespace" href="namespacesdf.html">sdf</a> = bp::extract&lt;double&gt;(sdfFun(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, x, y, z, tx, ty, tz));</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (bp::error_already_set <span class="keyword">const</span> &amp;) {</div>
<div class="line">      <span class="comment">// print all other errors to stderr</span></div>
<div class="line">      PyErr_Print();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;Python error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalGradSdf(</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz,</div>
<div class="line">      std::vector&lt;double&gt; &amp;grad_sdf</div>
<div class="line"> </div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// call python function</span></div>
<div class="line">      <a class="code hl_function" href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">grad_sdf</a> =</div>
<div class="line">          py_list_to_std_vector&lt;double&gt;(sdfGradFun(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, x, y, z, tx, ty, tz));</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (bp::error_already_set <span class="keyword">const</span> &amp;) {</div>
<div class="line">      <span class="comment">// print all other errors to stderr</span></div>
<div class="line">      PyErr_Print();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;Python error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">grad_sdf</a>.size() != 3) {</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Expected size 3&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalHessSdf(</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz,</div>
<div class="line">      std::vector&lt;double&gt; &amp;hess_sdf</div>
<div class="line"> </div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// call python function</span></div>
<div class="line">      <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a> =</div>
<div class="line">          py_list_to_std_vector&lt;double&gt;(sdfHessFun(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, x, y, z, tx, ty, tz));</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (bp::error_already_set <span class="keyword">const</span> &amp;) {</div>
<div class="line">      <span class="comment">// print all other errors to stderr</span></div>
<div class="line">      PyErr_Print();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;Python error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>.size() != 6) {</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Expected size 6&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  bp::object mainNamespace;</div>
<div class="line">  bp::object sdfFun;</div>
<div class="line">  bp::object sdfGradFun;</div>
<div class="line">  bp::object sdfHessFun;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> boost::weak_ptr&lt;SDFPython&gt; sdfPythonWeakPtr;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span><span class="comment"></span></div>
<div class="line"><span class="comment">//! [Surface distance function from python]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="namespace_contact_ops.html#ae1f45b4ca1b7d35230ce5845d4bf8b7d">SurfaceDistanceFunction</a> = boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="namespace_contact_ops.html#aefc56dfd940e721beda48628646b3799">GradSurfaceDistanceFunction</a> = boost::function&lt;FTensor::Tensor1&lt;double, 3&gt;(</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="namespace_contact_ops.html#aa554fe9b83fccb4f716df3738689dd19">HessSurfaceDistanceFunction</a> =</div>
<div class="line">    boost::function&lt;FTensor::Tensor2_symmetric&lt;double, 3&gt;(</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty,</div>
<div class="line">        <span class="keywordtype">double</span> tz)&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespace_contact_ops.html#a6307b1442cabeb2b26677d621f3508f8">surface_distance_function</a>(<span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z,</div>
<div class="line">                                        <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz) {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> sdf_ptr = sdfPythonWeakPtr.lock()) {</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(sdf_ptr-&gt;evalSdf(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, x, y, z, tx, ty, tz, <a class="code hl_namespace" href="namespacesdf.html">sdf</a>),</div>
<div class="line">                   <span class="stringliteral">&quot;Failed python call&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a>;</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <span class="keywordflow">return</span> y + 0.5;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a></div>
<div class="line"><a class="code hl_function" href="namespace_contact_ops.html#a93733a1fe5f173b260515c7cf77e046e">grad_surface_distance_function</a>(<span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z,</div>
<div class="line">                               <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz) {</div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> sdf_ptr = sdfPythonWeakPtr.lock()) {</div>
<div class="line">    std::vector&lt;double&gt; <a class="code hl_function" href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">grad_sdf</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(sdf_ptr-&gt;evalGradSdf(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, x, y, z, tx, ty, tz, grad_sdf),</div>
<div class="line">                   <span class="stringliteral">&quot;Failed python call&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>{<a class="code hl_function" href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">grad_sdf</a>[0], <a class="code hl_function" href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">grad_sdf</a>[1], <a class="code hl_function" href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">grad_sdf</a>[2]};</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>{0., 1., 0.};</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a></div>
<div class="line"><a class="code hl_function" href="namespace_contact_ops.html#a924a743ac3b4585a4dbec0a09ca236a0">hess_surface_distance_function</a>(<span class="keywordtype">double</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z,</div>
<div class="line">                               <span class="keywordtype">double</span> tx, <span class="keywordtype">double</span> ty, <span class="keywordtype">double</span> tz) {</div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SFD</span></div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> sdf_ptr = sdfPythonWeakPtr.lock()) {</div>
<div class="line">    std::vector&lt;double&gt; <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(sdf_ptr-&gt;evalHessSdf(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, x, y, z, tx, ty, tz, hess_sdf),</div>
<div class="line">                   <span class="stringliteral">&quot;Failed python call&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>{<a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>[0], <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>[1],</div>
<div class="line">                                                 <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>[2], <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>[3],</div>
<div class="line">                                                 <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>[4], <a class="code hl_function" href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">hess_sdf</a>[5]};</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;double, 3&gt;</a>{0., 0., 0., 0., 0., 0.};</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpAssembleTotalContactTractionImpl;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpEvaluateSDFImpl;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpConstrainBoundaryRhsImpl;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpConstrainBoundaryLhs_dUImpl;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpConstrainBoundaryLhs_dTractionImpl;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpAssembleTotalContactTractionImpl&lt;DIM, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>&gt;</div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a> {</div>
<div class="line">  OpAssembleTotalContactTractionImpl(</div>
<div class="line">      boost::shared_ptr&lt;CommonData&gt; common_data_ptr, <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_contact_ops.html#a40f40d4218498f914cd8f0299eca116f">scale</a> = 1);</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonDataPtr;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> scaleTraction;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpEvaluateSDFImpl&lt;DIM, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>&gt; : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a> {</div>
<div class="line">  OpEvaluateSDFImpl(boost::shared_ptr&lt;CommonData&gt; common_data_ptr);</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonDataPtr;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#ae1f45b4ca1b7d35230ce5845d4bf8b7d">SurfaceDistanceFunction</a> surfaceDistanceFunction = <a class="code hl_function" href="namespace_contact_ops.html#a6307b1442cabeb2b26677d621f3508f8">surface_distance_function</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#aefc56dfd940e721beda48628646b3799">GradSurfaceDistanceFunction</a> gradSurfaceDistanceFunction =</div>
<div class="line">      <a class="code hl_function" href="namespace_contact_ops.html#a93733a1fe5f173b260515c7cf77e046e">grad_surface_distance_function</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#aa554fe9b83fccb4f716df3738689dd19">HessSurfaceDistanceFunction</a> hessSurfaceDistanceFunction =</div>
<div class="line">      <a class="code hl_function" href="namespace_contact_ops.html#a924a743ac3b4585a4dbec0a09ca236a0">hess_surface_distance_function</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpConstrainBoundaryRhsImpl&lt;DIM, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>&gt;</div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a> {</div>
<div class="line">  OpConstrainBoundaryRhsImpl(<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                             boost::shared_ptr&lt;CommonData&gt; common_data_ptr);</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(EntitiesFieldData::EntData &amp;data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#ae1f45b4ca1b7d35230ce5845d4bf8b7d">SurfaceDistanceFunction</a> surfaceDistanceFunction = <a class="code hl_function" href="namespace_contact_ops.html#a6307b1442cabeb2b26677d621f3508f8">surface_distance_function</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#aefc56dfd940e721beda48628646b3799">GradSurfaceDistanceFunction</a> gradSurfaceDistanceFunction =</div>
<div class="line">      <a class="code hl_function" href="namespace_contact_ops.html#a93733a1fe5f173b260515c7cf77e046e">grad_surface_distance_function</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonDataPtr;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpConstrainBoundaryLhs_dUImpl&lt;DIM, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>&gt;</div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a> {</div>
<div class="line">  OpConstrainBoundaryLhs_dUImpl(<span class="keyword">const</span> std::string row_field_name,</div>
<div class="line">                                <span class="keyword">const</span> std::string col_field_name,</div>
<div class="line">                                boost::shared_ptr&lt;CommonData&gt; common_data_ptr);</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(EntitiesFieldData::EntData &amp;row_data,</div>
<div class="line">                           EntitiesFieldData::EntData &amp;col_data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#ae1f45b4ca1b7d35230ce5845d4bf8b7d">SurfaceDistanceFunction</a> surfaceDistanceFunction = <a class="code hl_function" href="namespace_contact_ops.html#a6307b1442cabeb2b26677d621f3508f8">surface_distance_function</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#aefc56dfd940e721beda48628646b3799">GradSurfaceDistanceFunction</a> gradSurfaceDistanceFunction =</div>
<div class="line">      <a class="code hl_function" href="namespace_contact_ops.html#a93733a1fe5f173b260515c7cf77e046e">grad_surface_distance_function</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#aa554fe9b83fccb4f716df3738689dd19">HessSurfaceDistanceFunction</a> hessSurfaceDistanceFunction =</div>
<div class="line">      <a class="code hl_function" href="namespace_contact_ops.html#a924a743ac3b4585a4dbec0a09ca236a0">hess_surface_distance_function</a>;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonDataPtr;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><span class="keyword">struct </span>OpConstrainBoundaryLhs_dTractionImpl&lt;DIM, <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>&gt;</div>
<div class="line">    : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a> {</div>
<div class="line">  OpConstrainBoundaryLhs_dTractionImpl(</div>
<div class="line">      <span class="keyword">const</span> std::string row_field_name, <span class="keyword">const</span> std::string col_field_name,</div>
<div class="line">      boost::shared_ptr&lt;CommonData&gt; common_data_ptr);</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(EntitiesFieldData::EntData &amp;row_data,</div>
<div class="line">                           EntitiesFieldData::EntData &amp;col_data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#ae1f45b4ca1b7d35230ce5845d4bf8b7d">SurfaceDistanceFunction</a> surfaceDistanceFunction = <a class="code hl_function" href="namespace_contact_ops.html#a6307b1442cabeb2b26677d621f3508f8">surface_distance_function</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_contact_ops.html#aefc56dfd940e721beda48628646b3799">GradSurfaceDistanceFunction</a> gradSurfaceDistanceFunction =</div>
<div class="line">      <a class="code hl_function" href="namespace_contact_ops.html#a93733a1fe5f173b260515c7cf77e046e">grad_surface_distance_function</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonDataPtr;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> BoundaryEleOp&gt; <span class="keyword">struct </span>ContactIntegrators {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I&gt;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="struct_contact_ops_1_1_contact_integrators.html#ae323a46768620e9e849454690a6e1bde">OpAssembleTotalContactTraction</a> =</div>
<div class="line">      OpAssembleTotalContactTractionImpl&lt;DIM, I, BoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I&gt;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="struct_contact_ops_1_1_contact_integrators.html#a10fa799bc2437b803f5819e785179833">OpEvaluateSDF</a> = OpEvaluateSDFImpl&lt;DIM, I, BoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">template</span> &lt;AssemblyType A&gt; <span class="keyword">struct </span>Assembly {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a> =</div>
<div class="line">        <span class="keyword">typename</span> FormsIntegrators&lt;BoundaryEleOp&gt;::template Assembly&lt;A&gt;::OpBase;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I&gt;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="struct_contact_ops_1_1_contact_integrators_1_1_assembly.html#aab4f034d2ac56158f1e65407cde211a7">OpConstrainBoundaryRhs</a> =</div>
<div class="line">        OpConstrainBoundaryRhsImpl&lt;DIM, I, AssemblyBoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I&gt;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="struct_contact_ops_1_1_contact_integrators_1_1_assembly.html#a01acc83f62007cefaf77b220c0a7c726">OpConstrainBoundaryLhs_dU</a> =</div>
<div class="line">        OpConstrainBoundaryLhs_dUImpl&lt;DIM, I, AssemblyBoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I&gt;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="struct_contact_ops_1_1_contact_integrators_1_1_assembly.html#a5eaeb6222df94697f1ae4ab23bfcd108">OpConstrainBoundaryLhs_dTraction</a> =</div>
<div class="line">        OpConstrainBoundaryLhs_dTractionImpl&lt;DIM, I, AssemblyBoundaryEleOp&gt;;</div>
<div class="line">  };</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespace_contact_ops.html#afb70a363717d4c63c2845106eb914793">sign</a>(<span class="keywordtype">double</span> x) {</div>
<div class="line">  <span class="keywordflow">if</span> (x == 0)</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (x &gt; 0)</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> -1;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespace_contact_ops.html#a8e974de6a236ede72f5fb5babeafa4a2">w</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> tn) {</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a> - <a class="code hl_variable" href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a> * tn;</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief constrain function</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * return 1 if negative sdn or positive tn</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @param sdf signed distance</span></div>
<div class="line"><span class="comment"> * @param tn traction</span></div>
<div class="line"><span class="comment"> * @return double</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">inline</span> <span class="keywordtype">double</span> <a class="code hl_function" href="namespace_contact_ops.html#ad136d58cb7265b5585ff61dd83ea18c7">constrain</a>(<span class="keywordtype">double</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a>, <span class="keywordtype">double</span> tn) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> s = <a class="code hl_function" href="namespace_contact_ops.html#afb70a363717d4c63c2845106eb914793">sign</a>(<a class="code hl_function" href="namespace_contact_ops.html#a8e974de6a236ede72f5fb5babeafa4a2">w</a>(<a class="code hl_namespace" href="namespacesdf.html">sdf</a>, tn));</div>
<div class="line">  <span class="keywordflow">return</span> (1 - s) / 2;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line">OpAssembleTotalContactTractionImpl&lt;DIM, GAUSS, BoundaryEleOp&gt;::</div>
<div class="line">    OpAssembleTotalContactTractionImpl(</div>
<div class="line">        boost::shared_ptr&lt;CommonData&gt; common_data_ptr, <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_contact_ops.html#a40f40d4218498f914cd8f0299eca116f">scale</a>)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>::OPSPACE),</div>
<div class="line">      commonDataPtr(common_data_ptr), scaleTraction(<a class="code hl_variable" href="namespace_contact_ops.html#a40f40d4218498f914cd8f0299eca116f">scale</a>) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpAssembleTotalContactTractionImpl&lt;DIM, GAUSS, BoundaryEleOp&gt;::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_sum_t{0., 0., 0.};</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">BoundaryEleOp::getFTensor0IntegrationWeight</a>();</div>
<div class="line">  <span class="keyword">auto</span> t_traction = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactTraction);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> nb_gauss_pts = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">BoundaryEleOp::getGaussPts</a>().size2();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> = t_w * <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">BoundaryEleOp::getMeasure</a>();</div>
<div class="line">    t_sum_t(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> * t_traction(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_traction;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  t_sum_t(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= scaleTraction;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> ind[] = {0, 1, 2};</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(commonDataPtr-&gt;totalTraction, 3, ind, &amp;t_sum_t(0),</div>
<div class="line">                      ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line">OpEvaluateSDFImpl&lt;DIM, GAUSS, BoundaryEleOp&gt;::OpEvaluateSDFImpl(</div>
<div class="line">    boost::shared_ptr&lt;CommonData&gt; common_data_ptr)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">BoundaryEleOp</a>::OPSPACE),</div>
<div class="line">      commonDataPtr(common_data_ptr) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpEvaluateSDFImpl&lt;DIM, GAUSS, BoundaryEleOp&gt;::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> nb_gauss_pts = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">BoundaryEleOp::getGaussPts</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> &amp;sdf_vec = commonDataPtr-&gt;sdfVals;</div>
<div class="line">  <span class="keyword">auto</span> &amp;grad_mat = commonDataPtr-&gt;gradsSdf;</div>
<div class="line">  <span class="keyword">auto</span> &amp;hess_mat = commonDataPtr-&gt;hessSdf;</div>
<div class="line"> </div>
<div class="line">  sdf_vec.resize(nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  grad_mat.resize(DIM, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">  hess_mat.resize((DIM * (DIM + 1)) / 2, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_total_traction = CommonData::getFTensor1TotalTraction();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_sdf = getFTensor0FromVec(sdf_vec);</div>
<div class="line">  <span class="keyword">auto</span> t_grad_sdf = getFTensor1FromMat&lt;DIM&gt;(grad_mat);</div>
<div class="line">  <span class="keyword">auto</span> t_hess_sdf = getFTensor2SymmetricFromMat&lt;DIM&gt;(hess_mat);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_disp = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactDisp);</div>
<div class="line">  <span class="keyword">auto</span> t_coords = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5022d618bbaf375d0a07588e50a297a5">BoundaryEleOp::getFTensor1CoordsAtGaussPts</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> next = [&amp;]() {</div>
<div class="line">    ++t_sdf;</div>
<div class="line">    ++t_grad_sdf;</div>
<div class="line">    ++t_hess_sdf;</div>
<div class="line">    ++t_disp;</div>
<div class="line">    ++t_coords;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_time = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa7d672543f15f3c2d3b3159a4331d7bf">BoundaryEleOp::getTStime</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_spatial_coords{0., 0., 0.};</div>
<div class="line">    t_spatial_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_disp(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> sdf_v = surfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_grad_sdf_v = gradSurfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_hess_sdf_v = hessSurfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    t_sdf = sdf_v;</div>
<div class="line">    t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_grad_sdf_v(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    t_hess_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_hess_sdf_v(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    next();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line">OpConstrainBoundaryRhsImpl&lt;DIM, GAUSS, AssemblyBoundaryEleOp&gt;::</div>
<div class="line">    OpConstrainBoundaryRhsImpl(<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                               boost::shared_ptr&lt;CommonData&gt; common_data_ptr)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>::OPROW),</div>
<div class="line">      commonDataPtr(common_data_ptr) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpConstrainBoundaryRhsImpl&lt;DIM, GAUSS, AssemblyBoundaryEleOp&gt;::iNtegrate(</div>
<div class="line">    EntitiesFieldData::EntData &amp;data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'l', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = AssemblyBoundaryEleOp::getGaussPts().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;nf = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#a097ca344995d4a64b08a13c5fc2dbcf8">AssemblyBoundaryEleOp::locF</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_normal_at_pts = AssemblyBoundaryEleOp::getFTensor1NormalsAtGaussPts();</div>
<div class="line">  <span class="keyword">auto</span> t_total_traction = CommonData::getFTensor1TotalTraction();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_w = AssemblyBoundaryEleOp::getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="keyword">auto</span> t_disp = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactDisp);</div>
<div class="line">  <span class="keyword">auto</span> t_traction = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactTraction);</div>
<div class="line">  <span class="keyword">auto</span> t_coords = AssemblyBoundaryEleOp::getFTensor1CoordsAtGaussPts();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">size_t</span> nb_base_functions = data.getN().size2() / 3;</div>
<div class="line">  <span class="keyword">auto</span> t_base = data.getFTensor1N&lt;3&gt;();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, DIM&gt;</a> t_normal;</div>
<div class="line">    t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) =</div>
<div class="line">        t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / std::sqrt(t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_nf = getFTensor1FromPtr&lt;DIM&gt;(&amp;nf[0]);</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> = t_w * AssemblyBoundaryEleOp::getMeasure();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_spatial_coords{0., 0., 0.};</div>
<div class="line">    t_spatial_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_disp(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> ts_time = AssemblyBoundaryEleOp::getTStime();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a> = surfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_grad_sdf = gradSurfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> tn = -t_traction(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = <a class="code hl_function" href="namespace_contact_ops.html#ad136d58cb7265b5585ff61dd83ea18c7">constrain</a>(<a class="code hl_namespace" href="namespacesdf.html">sdf</a>, tn);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_cP;</div>
<div class="line">    t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_grad_sdf(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_cQ;</div>
<div class="line">    t_cQ(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = <a class="code hl_function" href="namespace_f_tensor.html#aa68cb0e32829e68be4df98b2f364bc2e">kronecker_delta</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, DIM&gt;</a> t_rhs;</div>
<div class="line">    t_rhs(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) =</div>
<div class="line"> </div>
<div class="line">        t_cQ(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * (t_disp(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - <a class="code hl_variable" href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a> * t_traction(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>))</div>
<div class="line"> </div>
<div class="line">        +</div>
<div class="line"> </div>
<div class="line">        t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_disp(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) +</div>
<div class="line">        <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * (<a class="code hl_namespace" href="namespacesdf.html">sdf</a> * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)); <span class="comment">// add gap0 displacements</span></div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> bb = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; bb != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#a6c48b3705b328e6da3123939fdbc3afa">AssemblyBoundaryEleOp::nbRows</a> / DIM; ++bb) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> * (t_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) -= beta * t_rhs(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      ++t_nf;</div>
<div class="line">      ++t_base;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; bb &lt; nb_base_functions; ++bb)</div>
<div class="line">      ++t_base;</div>
<div class="line"> </div>
<div class="line">    ++t_disp;</div>
<div class="line">    ++t_traction;</div>
<div class="line">    ++t_coords;</div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_normal_at_pts;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line">OpConstrainBoundaryLhs_dUImpl&lt;DIM, GAUSS, AssemblyBoundaryEleOp&gt;::</div>
<div class="line">    OpConstrainBoundaryLhs_dUImpl(<span class="keyword">const</span> std::string row_field_name,</div>
<div class="line">                                  <span class="keyword">const</span> std::string col_field_name,</div>
<div class="line">                                  boost::shared_ptr&lt;CommonData&gt; common_data_ptr)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>(row_field_name, col_field_name,</div>
<div class="line">                            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>::OPROWCOL),</div>
<div class="line">      commonDataPtr(common_data_ptr) {</div>
<div class="line">  AssemblyBoundaryEleOp::sYmm = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpConstrainBoundaryLhs_dUImpl&lt;DIM, GAUSS, AssemblyBoundaryEleOp&gt;::iNtegrate(</div>
<div class="line">    EntitiesFieldData::EntData &amp;row_data,</div>
<div class="line">    EntitiesFieldData::EntData &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = AssemblyBoundaryEleOp::getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> &amp;locMat = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#aa09421326d490a4e1d04a10b0f0a0311">AssemblyBoundaryEleOp::locMat</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_normal_at_pts = AssemblyBoundaryEleOp::getFTensor1NormalsAtGaussPts();</div>
<div class="line">  <span class="keyword">auto</span> t_total_traction = CommonData::getFTensor1TotalTraction();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_disp = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactDisp);</div>
<div class="line">  <span class="keyword">auto</span> t_traction = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactTraction);</div>
<div class="line">  <span class="keyword">auto</span> t_coords = AssemblyBoundaryEleOp::getFTensor1CoordsAtGaussPts();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_w = AssemblyBoundaryEleOp::getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="keyword">auto</span> t_row_base = row_data.getFTensor1N&lt;3&gt;();</div>
<div class="line">  <span class="keywordtype">size_t</span> nb_face_functions = row_data.getN().size2() / 3;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a class="code hl_class" href="class_f_tensor_1_1_kronecker___delta.html">FTensor::Kronecker_Delta&lt;int&gt;</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, DIM&gt;</a> t_normal;</div>
<div class="line">    t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) =</div>
<div class="line">        t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / std::sqrt(t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> = t_w * AssemblyBoundaryEleOp::getMeasure();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_spatial_coords{0., 0., 0.};</div>
<div class="line">    t_spatial_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_disp(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> ts_time = AssemblyBoundaryEleOp::getTStime();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a> = surfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line">    <span class="keyword">auto</span> t_grad_sdf = gradSurfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> tn = -t_traction(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = <a class="code hl_function" href="namespace_contact_ops.html#ad136d58cb7265b5585ff61dd83ea18c7">constrain</a>(<a class="code hl_namespace" href="namespacesdf.html">sdf</a>, tn);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_cP;</div>
<div class="line">    t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_grad_sdf(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_cQ;</div>
<div class="line">    t_cQ(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = <a class="code hl_function" href="namespace_f_tensor.html#aa68cb0e32829e68be4df98b2f364bc2e">kronecker_delta</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_res_dU;</div>
<div class="line">    t_res_dU(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = <a class="code hl_function" href="namespace_f_tensor.html#aa68cb0e32829e68be4df98b2f364bc2e">kronecker_delta</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) + t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> &gt; 0) {</div>
<div class="line">      <span class="keyword">auto</span> t_hess_sdf = hessSurfaceDistanceFunction(</div>
<div class="line">          ts_time, t_spatial_coords(0), t_spatial_coords(1),</div>
<div class="line">          t_spatial_coords(2), t_total_traction(0), t_total_traction(1),</div>
<div class="line">          t_total_traction(2));</div>
<div class="line">      t_res_dU(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) +=</div>
<div class="line">          (<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * <a class="code hl_variable" href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a>) *</div>
<div class="line">              (t_hess_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * (t_grad_sdf(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_traction(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) +</div>
<div class="line">               t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_hess_sdf(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_traction(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) +</div>
<div class="line">          <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * <a class="code hl_namespace" href="namespacesdf.html">sdf</a> * t_hess_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#a6c48b3705b328e6da3123939fdbc3afa">AssemblyBoundaryEleOp::nbRows</a> / DIM; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> t_mat = getFTensor2FromArray&lt;DIM, DIM, DIM&gt;(locMat, DIM * rr);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> row_base = t_row_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> t_col_base = col_data.getFTensor0N(gg, 0);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> cc = 0; cc != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#ae78132be7358cf14a3da7576328d7ccb">AssemblyBoundaryEleOp::nbCols</a> / DIM; ++cc) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> beta = <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> * row_base * t_col_base;</div>
<div class="line"> </div>
<div class="line">        t_mat(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) -= beta * t_res_dU(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">        ++t_col_base;</div>
<div class="line">        ++t_mat;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      ++t_row_base;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; rr &lt; nb_face_functions; ++rr)</div>
<div class="line">      ++t_row_base;</div>
<div class="line"> </div>
<div class="line">    ++t_disp;</div>
<div class="line">    ++t_traction;</div>
<div class="line">    ++t_coords;</div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_normal_at_pts;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line">OpConstrainBoundaryLhs_dTractionImpl&lt;DIM, GAUSS, AssemblyBoundaryEleOp&gt;::</div>
<div class="line">    OpConstrainBoundaryLhs_dTractionImpl(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field_name, <span class="keyword">const</span> std::string col_field_name,</div>
<div class="line">        boost::shared_ptr&lt;CommonData&gt; common_data_ptr)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>(row_field_name, col_field_name,</div>
<div class="line">                            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_base_impl.html">AssemblyBoundaryEleOp</a>::OPROWCOL),</div>
<div class="line">      commonDataPtr(common_data_ptr) {</div>
<div class="line">  AssemblyBoundaryEleOp::sYmm = <span class="keyword">false</span>;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyBoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">OpConstrainBoundaryLhs_dTractionImpl&lt;DIM, GAUSS, AssemblyBoundaryEleOp&gt;::</div>
<div class="line">    iNtegrate(EntitiesFieldData::EntData &amp;row_data,</div>
<div class="line">              EntitiesFieldData::EntData &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', DIM&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = AssemblyBoundaryEleOp::getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> &amp;locMat = <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#aa09421326d490a4e1d04a10b0f0a0311">AssemblyBoundaryEleOp::locMat</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_normal_at_pts = AssemblyBoundaryEleOp::getFTensor1NormalsAtGaussPts();</div>
<div class="line">  <span class="keyword">auto</span> t_total_traction = CommonData::getFTensor1TotalTraction();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_disp = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactDisp);</div>
<div class="line">  <span class="keyword">auto</span> t_traction = getFTensor1FromMat&lt;DIM&gt;(commonDataPtr-&gt;contactTraction);</div>
<div class="line">  <span class="keyword">auto</span> t_coords = AssemblyBoundaryEleOp::getFTensor1CoordsAtGaussPts();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_w = AssemblyBoundaryEleOp::getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="keyword">auto</span> t_row_base = row_data.getFTensor1N&lt;3&gt;();</div>
<div class="line">  <span class="keywordtype">size_t</span> nb_face_functions = row_data.getN().size2() / 3;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, DIM&gt;</a> t_normal;</div>
<div class="line">    t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) =</div>
<div class="line">        t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / std::sqrt(t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal_at_pts(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> = t_w * AssemblyBoundaryEleOp::getMeasure();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_spatial_coords{0., 0., 0.};</div>
<div class="line">    t_spatial_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_disp(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> ts_time = AssemblyBoundaryEleOp::getTStime();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_namespace" href="namespacesdf.html">sdf</a> = surfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line">    <span class="keyword">auto</span> t_grad_sdf = gradSurfaceDistanceFunction(</div>
<div class="line">        ts_time, t_spatial_coords(0), t_spatial_coords(1), t_spatial_coords(2),</div>
<div class="line">        t_total_traction(0), t_total_traction(1), t_total_traction(2));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> tn = -t_traction(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = <a class="code hl_function" href="namespace_contact_ops.html#ad136d58cb7265b5585ff61dd83ea18c7">constrain</a>(<a class="code hl_namespace" href="namespacesdf.html">sdf</a>, tn);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_cP;</div>
<div class="line">    t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * t_grad_sdf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_grad_sdf(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_cQ;</div>
<div class="line">    t_cQ(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = <a class="code hl_function" href="namespace_f_tensor.html#aa68cb0e32829e68be4df98b2f364bc2e">kronecker_delta</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - t_cP(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, DIM, DIM&gt;</a> t_res_dt;</div>
<div class="line">    t_res_dt(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -<a class="code hl_variable" href="namespace_contact_ops.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a> * t_cQ(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">size_t</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#a6c48b3705b328e6da3123939fdbc3afa">AssemblyBoundaryEleOp::nbRows</a> / DIM; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> t_mat = getFTensor2FromArray&lt;DIM, DIM, DIM&gt;(locMat, DIM * rr);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> row_base = t_row_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> t_col_base = col_data.getFTensor1N&lt;3&gt;(gg, 0);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> cc = 0; cc != <a class="code hl_variable" href="struct_mo_f_e_m_1_1_op_base_impl.html#ae78132be7358cf14a3da7576328d7ccb">AssemblyBoundaryEleOp::nbCols</a> / DIM; ++cc) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> col_base = t_col_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> beta = <a class="code hl_variable" href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">alpha</a> * row_base * col_base;</div>
<div class="line"> </div>
<div class="line">        t_mat(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) -= beta * t_res_dt(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">        ++t_col_base;</div>
<div class="line">        ++t_mat;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      ++t_row_base;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (; rr &lt; nb_face_functions; ++rr)</div>
<div class="line">      ++t_row_base;</div>
<div class="line"> </div>
<div class="line">    ++t_disp;</div>
<div class="line">    ++t_traction;</div>
<div class="line">    ++t_coords;</div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_normal_at_pts;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, AssemblyType A, IntegrationType I, <span class="keyword">typename</span> DomainEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="namespace_plastic_ops.html#a2dd4c839f6ca3d15607e4560fb5b4534">opFactoryDomainRhs</a>(</div>
<div class="line">    boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">    std::string sigma, std::string u) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_class" href="class_b.html">B</a> = <span class="keyword">typename</span> FormsIntegrators&lt;DomainEleOp&gt;::template Assembly&lt;</div>
<div class="line">      <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;::template <a class="code hl_class" href="class_linear_form.html">LinearForm&lt;I&gt;</a>;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a9873a909b4290618805add00b607b696">OpMixDivURhs</a> = <span class="keyword">typename</span> B::template OpMixDivTimesU&lt;3, DIM, DIM&gt;;</div>
<div class="line">  <span class="keyword">using </span>OpMixLambdaGradURhs = <span class="keyword">typename</span> B::template OpMixTensorTimesGradU&lt;DIM&gt;;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a80754f56c6b3e44f0b2caf88bad558b0">OpMixUTimesDivLambdaRhs</a> =</div>
<div class="line">      <span class="keyword">typename</span> B::template OpMixVecTimesDivLambda&lt;SPACE_DIM&gt;;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a34776614c34dcb0506c4077d794cbf56">OpMixUTimesLambdaRhs</a> =</div>
<div class="line">      <span class="keyword">typename</span> B::template <a class="code hl_typedef" href="operators__tests_8cpp.html#a221a1f7811ad523d9606b0294168e2c2">OpGradTimesTensor&lt;1, DIM, DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line">  <span class="keyword">auto</span> mat_grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> div_stress_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> contact_stress_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpCalculateVectorFieldValues&lt;DIM&gt;(</div>
<div class="line">      u, common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">  pip.push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateHVecTensorField&lt;DIM, DIM&gt;(sigma, contact_stress_ptr));</div>
<div class="line">  pip.push_back(</div>
<div class="line">      <span class="keyword">new</span> OpCalculateHVecTensorDivergence&lt;DIM, DIM&gt;(sigma, div_stress_ptr));</div>
<div class="line"> </div>
<div class="line">  pip.push_back(<span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;DIM, DIM&gt;</a>(u, mat_grad_ptr));</div>
<div class="line"> </div>
<div class="line">  pip.push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a9873a909b4290618805add00b607b696">OpMixDivURhs</a>(sigma, common_data_ptr-&gt;contactDispPtr(),</div>
<div class="line">                       [](<span class="keywordtype">double</span>, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) <span class="keyword">constexpr</span> { return 1; }));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpMixLambdaGradURhs(sigma, mat_grad_ptr));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a80754f56c6b3e44f0b2caf88bad558b0">OpMixUTimesDivLambdaRhs</a>(u, div_stress_ptr));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a34776614c34dcb0506c4077d794cbf56">OpMixUTimesLambdaRhs</a>(u, contact_stress_ptr));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> OpMixLhs&gt; <span class="keyword">struct </span>OpMixLhsSide : <span class="keyword">public</span> <a class="code hl_class" href="class_op_mix_lhs.html">OpMixLhs</a> {</div>
<div class="line">  <span class="keyword">using </span>OpMixLhs::OpMixLhs;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                        <a class="code hl_class" href="class_entity_type.html">EntityType</a> col_type,</div>
<div class="line">                        EntitiesFieldData::EntData &amp;row_data,</div>
<div class="line">                        EntitiesFieldData::EntData &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> side_fe_entity = OpMixLhs::getSidePtrFE()-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keyword">auto</span> side_fe_data = OpMixLhs::getSideEntity(row_side, row_type);</div>
<div class="line">    <span class="comment">// Only assemble side which correspond to edge entity on boundary</span></div>
<div class="line">    <span class="keywordflow">if</span> (side_fe_entity == side_fe_data) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> OpMixLhs::doWork(row_side, col_side, row_type, col_type, row_data,</div>
<div class="line">                              col_data);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, AssemblyType A, IntegrationType I, <span class="keyword">typename</span> DomainEle&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="namespace_contact_ops.html#aa054eea5f7b5dfa7769ea017e904c34b">opFactoryBoundaryToDomainLhs</a>(</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">    boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">    std::string fe_domain_name, std::string sigma, std::string u,</div>
<div class="line">    std::string geom, ForcesAndSourcesCore::RuleHookFun rule) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">DomainEleOp</a> = <span class="keyword">typename</span> DomainEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> OpLoopSide&lt;DomainEle&gt;(</div>
<div class="line">      m_field, fe_domain_name, DIM, Sev::noisy,</div>
<div class="line">      boost::make_shared&lt;ForcesAndSourcesCore::UserDataOperator::AdjCache&gt;());</div>
<div class="line">  pip.push_back(op_loop_side);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;DIM, DIM, DIM&gt;::add(op_loop_side-&gt;getOpPtrVector(),</div>
<div class="line">                                      {H1, HDIV}, geom);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_class" href="class_b.html">B</a> = <span class="keyword">typename</span> FormsIntegrators&lt;DomainEleOp&gt;::template Assembly&lt;</div>
<div class="line">      <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>&gt;::template <a class="code hl_class" href="class_bi_linear_form.html">BiLinearForm&lt;I&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#a4565e52706a37d6e11d1e95378231cdd">OpMixDivULhs</a> = <span class="keyword">typename</span> B::template OpMixDivTimesVec&lt;DIM&gt;;</div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="multifield__plasticity_8cpp.html#ae9090758f7220cd683fe1c712323d8f2">OpLambdaGraULhs</a> = <span class="keyword">typename</span> B::template OpMixTensorTimesGrad&lt;DIM&gt;;</div>
<div class="line">  <span class="keyword">using </span>OpMixDivULhsSide = OpMixLhsSide&lt;OpMixDivULhs&gt;;</div>
<div class="line">  <span class="keyword">using </span>OpLambdaGraULhsSide = OpMixLhsSide&lt;OpLambdaGraULhs&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> unity = []() { <span class="keywordflow">return</span> 1; };</div>
<div class="line">  op_loop_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpMixDivULhsSide(sigma, u, unity, <span class="keyword">true</span>));</div>
<div class="line">  op_loop_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> OpLambdaGraULhsSide(sigma, u, unity, <span class="keyword">true</span>));</div>
<div class="line"> </div>
<div class="line">  op_loop_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, AssemblyType A, IntegrationType I, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="namespace_contact_ops.html#a2eff5755e6337a8d2ad2efeca1807082">opFactoryBoundaryLhs</a>(</div>
<div class="line">    boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">    std::string sigma, std::string u) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>C = ContactIntegrators&lt;BoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpCalculateVectorFieldValues&lt;DIM&gt;(</div>
<div class="line">      u, common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpCalculateHVecTensorTrace&lt;DIM, BoundaryEleOp&gt;(</div>
<div class="line">      sigma, common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">  pip.push_back(</div>
<div class="line">      <span class="keyword">new</span> <span class="keyword">typename</span> C::template Assembly&lt;A&gt;::template OpConstrainBoundaryLhs_dU&lt;</div>
<div class="line">          DIM, GAUSS&gt;(sigma, u, common_data_ptr));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> <span class="keyword">typename</span> C::template Assembly&lt;A&gt;::</div>
<div class="line">                    <span class="keyword">template</span> OpConstrainBoundaryLhs_dTraction&lt;DIM, GAUSS&gt;(</div>
<div class="line">                        sigma, sigma, common_data_ptr));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, AssemblyType A, IntegrationType I, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="namespace_contact_ops.html#adc0ef59ffb415069e3d6353638ff84fa">opFactoryBoundaryRhs</a>(</div>
<div class="line">    boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">    std::string sigma, std::string u) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>C = ContactIntegrators&lt;BoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpCalculateVectorFieldValues&lt;DIM&gt;(</div>
<div class="line">      u, common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpCalculateHVecTensorTrace&lt;DIM, BoundaryEleOp&gt;(</div>
<div class="line">      sigma, common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">  pip.push_back(</div>
<div class="line">      <span class="keyword">new</span> <span class="keyword">typename</span> C::template Assembly&lt;A&gt;::template OpConstrainBoundaryRhs&lt;</div>
<div class="line">          DIM, GAUSS&gt;(sigma, common_data_ptr));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, IntegrationType I, <span class="keyword">typename</span> BoundaryEleOp&gt;</div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="namespace_contact_ops.html#ad497a4c309ac9772bb30ba870b90767c">opFactoryCalculateTraction</a>(</div>
<div class="line">    boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">    std::string sigma) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>C = ContactIntegrators&lt;BoundaryEleOp&gt;;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> OpCalculateHVecTensorTrace&lt;DIM, BoundaryEleOp&gt;(</div>
<div class="line">      sigma, common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">  pip.push_back(<span class="keyword">new</span> <span class="keyword">typename</span> C::template OpAssembleTotalContactTraction&lt;DIM, I&gt;(</div>
<div class="line">      common_data_ptr, 1. / <a class="code hl_variable" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">};     <span class="comment">// namespace ContactOps</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// __CONTACTOPS_HPP__</span></div>
<div class="ttc" id="aclass_entity_type_html"><div class="ttname"><a href="class_entity_type.html">EntityType</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition:</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_kronecker___delta_html"><div class="ttname"><a href="class_f_tensor_1_1_kronecker___delta.html">FTensor::Kronecker_Delta</a></div><div class="ttdoc">Kronecker Delta class.</div><div class="ttdef"><b>Definition:</b> <a href="_kronecker___delta_8hpp_source.html#l00015">Kronecker_Delta.hpp:15</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2__symmetric_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2__symmetric.html">FTensor::Tensor2_symmetric</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor2__symmetric__value_8hpp_source.html#l00013">Tensor2_symmetric_value.hpp:14</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclass_op_calculate_vector_field_gradient_html"><div class="ttname"><a href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient</a></div></div>
<div class="ttc" id="aclass_op_mix_lhs_html"><div class="ttname"><a href="class_op_mix_lhs.html">OpMixLhs</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a></div><div class="ttdeci">@ NOSPACE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00083">definitions.h:83</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a></div><div class="ttdeci">@ MOFEM_OPERATION_UNSUCCESSFUL</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00034">definitions.h:34</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a52438586143ef05bfe922220a317c144"><div class="ttname"><a href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a></div><div class="ttdeci">constexpr auto t_kd</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00137">free_surface.cpp:137</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a34776614c34dcb0506c4077d794cbf56"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a34776614c34dcb0506c4077d794cbf56">OpMixUTimesLambdaRhs</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::LinearForm&lt; GAUSS &gt;::OpGradTimesTensor&lt; 1, 3, 3 &gt; OpMixUTimesLambdaRhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00062">multifield_plasticity.cpp:63</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a4565e52706a37d6e11d1e95378231cdd"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a4565e52706a37d6e11d1e95378231cdd">OpMixDivULhs</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::BiLinearForm&lt; GAUSS &gt;::OpMixDivTimesVec&lt; 3 &gt; OpMixDivULhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00052">multifield_plasticity.cpp:53</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a80754f56c6b3e44f0b2caf88bad558b0"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a80754f56c6b3e44f0b2caf88bad558b0">OpMixUTimesDivLambdaRhs</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::LinearForm&lt; GAUSS &gt;::OpMixVecTimesDivLambda&lt; 3 &gt; OpMixUTimesDivLambdaRhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00060">multifield_plasticity.cpp:61</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_a9873a909b4290618805add00b607b696"><div class="ttname"><a href="multifield__plasticity_8cpp.html#a9873a909b4290618805add00b607b696">OpMixDivURhs</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::LinearForm&lt; GAUSS &gt;::OpMixDivTimesU&lt; 3, 3, 3 &gt; OpMixDivURhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00056">multifield_plasticity.cpp:57</a></div></div>
<div class="ttc" id="amultifield__plasticity_8cpp_html_ae9090758f7220cd683fe1c712323d8f2"><div class="ttname"><a href="multifield__plasticity_8cpp.html#ae9090758f7220cd683fe1c712323d8f2">OpLambdaGraULhs</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; USER_ASSEMBLE &gt;::BiLinearForm&lt; GAUSS &gt;::OpMixTensorTimesGrad&lt; 3 &gt; OpLambdaGraULhs</div><div class="ttdef"><b>Definition:</b> <a href="multifield__plasticity_8cpp_source.html#l00054">multifield_plasticity.cpp:55</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a40f40d4218498f914cd8f0299eca116f"><div class="ttname"><a href="namespace_contact_ops.html#a40f40d4218498f914cd8f0299eca116f">ContactOps::scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition:</b> <a href="_eshelbian_contact_8hpp_source.html#l00020">EshelbianContact.hpp:20</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a6307b1442cabeb2b26677d621f3508f8"><div class="ttname"><a href="namespace_contact_ops.html#a6307b1442cabeb2b26677d621f3508f8">ContactOps::surface_distance_function</a></div><div class="ttdeci">double surface_distance_function(double t, double x, double y, double z, double tx, double ty, double tz)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00214">ContactOps.hpp:214</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a8e974de6a236ede72f5fb5babeafa4a2"><div class="ttname"><a href="namespace_contact_ops.html#a8e974de6a236ede72f5fb5babeafa4a2">ContactOps::w</a></div><div class="ttdeci">double w(const double sdf, const double tn)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00387">ContactOps.hpp:387</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a924a743ac3b4585a4dbec0a09ca236a0"><div class="ttname"><a href="namespace_contact_ops.html#a924a743ac3b4585a4dbec0a09ca236a0">ContactOps::hess_surface_distance_function</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; double, 3 &gt; hess_surface_distance_function(double t, double x, double y, double z, double tx, double ty, double tz)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00243">ContactOps.hpp:243</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_a93733a1fe5f173b260515c7cf77e046e"><div class="ttname"><a href="namespace_contact_ops.html#a93733a1fe5f173b260515c7cf77e046e">ContactOps::grad_surface_distance_function</a></div><div class="ttdeci">FTensor::Tensor1&lt; double, 3 &gt; grad_surface_distance_function(double t, double x, double y, double z, double tx, double ty, double tz)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00229">ContactOps.hpp:229</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_aa554fe9b83fccb4f716df3738689dd19"><div class="ttname"><a href="namespace_contact_ops.html#aa554fe9b83fccb4f716df3738689dd19">ContactOps::HessSurfaceDistanceFunction</a></div><div class="ttdeci">boost::function&lt; FTensor::Tensor2_symmetric&lt; double, 3 &gt;(double t, double x, double y, double z, double tx, double ty, double tz)&gt; HessSurfaceDistanceFunction</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00209">ContactOps.hpp:212</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_ad136d58cb7265b5585ff61dd83ea18c7"><div class="ttname"><a href="namespace_contact_ops.html#ad136d58cb7265b5585ff61dd83ea18c7">ContactOps::constrain</a></div><div class="ttdeci">double constrain(double sdf, double tn)</div><div class="ttdoc">constrain function</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00400">ContactOps.hpp:400</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_ad497a4c309ac9772bb30ba870b90767c"><div class="ttname"><a href="namespace_contact_ops.html#ad497a4c309ac9772bb30ba870b90767c">ContactOps::opFactoryCalculateTraction</a></div><div class="ttdeci">MoFEMErrorCode opFactoryCalculateTraction(boost::ptr_deque&lt; ForcesAndSourcesCore::UserDataOperator &gt; &amp;pip, std::string sigma)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00965">ContactOps.hpp:965</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_ae1f45b4ca1b7d35230ce5845d4bf8b7d"><div class="ttname"><a href="namespace_contact_ops.html#ae1f45b4ca1b7d35230ce5845d4bf8b7d">ContactOps::SurfaceDistanceFunction</a></div><div class="ttdeci">boost::function&lt; double(double t, double x, double y, double z, double tx, double ty, double tz)&gt; SurfaceDistanceFunction</div><div class="ttdoc">[Common data]</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00203">ContactOps.hpp:204</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_aefc56dfd940e721beda48628646b3799"><div class="ttname"><a href="namespace_contact_ops.html#aefc56dfd940e721beda48628646b3799">ContactOps::GradSurfaceDistanceFunction</a></div><div class="ttdeci">boost::function&lt; FTensor::Tensor1&lt; double, 3 &gt;(double t, double x, double y, double z, double tx, double ty, double tz)&gt; GradSurfaceDistanceFunction</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00206">ContactOps.hpp:207</a></div></div>
<div class="ttc" id="anamespace_contact_ops_html_afb70a363717d4c63c2845106eb914793"><div class="ttname"><a href="namespace_contact_ops.html#afb70a363717d4c63c2845106eb914793">ContactOps::sign</a></div><div class="ttdeci">double sign(double x)</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00378">ContactOps.hpp:378</a></div></div>
<div class="ttc" id="anamespace_electro_physiology_html_ac689f6b04008c4247f9e34091437b2c9"><div class="ttname"><a href="namespace_electro_physiology.html#ac689f6b04008c4247f9e34091437b2c9">ElectroPhysiology::alpha</a></div><div class="ttdeci">const double alpha</div><div class="ttdef"><b>Definition:</b> <a href="_elec_phys_operators_8hpp_source.html#l00028">ElecPhysOperators.hpp:28</a></div></div>
<div class="ttc" id="anamespace_f_tensor_html_aa68cb0e32829e68be4df98b2f364bc2e"><div class="ttname"><a href="namespace_f_tensor.html#aa68cb0e32829e68be4df98b2f364bc2e">FTensor::kronecker_delta</a></div><div class="ttdeci">Tensor2_Expr&lt; Kronecker_Delta&lt; T &gt;, T, Dim0, Dim1, i, j &gt; kronecker_delta(const Index&lt; i, Dim0 &gt; &amp;, const Index&lt; j, Dim1 &gt; &amp;)</div><div class="ttdoc">Rank 2.</div><div class="ttdef"><b>Definition:</b> <a href="_kronecker___delta_8hpp_source.html#l00081">Kronecker_Delta.hpp:81</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01576">EntitiesFieldData.hpp:1576</a></div></div>
<div class="ttc" id="anamespace_plastic_ops_html_a2dd4c839f6ca3d15607e4560fb5b4534"><div class="ttname"><a href="namespace_plastic_ops.html#a2dd4c839f6ca3d15607e4560fb5b4534">PlasticOps::opFactoryDomainRhs</a></div><div class="ttdeci">MoFEMErrorCode opFactoryDomainRhs(MoFEM::Interface &amp;m_field, std::string block_name, Pip &amp;pip, std::string u, std::string ep, std::string tau)</div><div class="ttdef"><b>Definition:</b> <a href="_plastic_ops_8hpp_source.html#l00500">PlasticOps.hpp:500</a></div></div>
<div class="ttc" id="anamespacesdf_html"><div class="ttname"><a href="namespacesdf.html">sdf</a></div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00001">sdf.py:1</a></div></div>
<div class="ttc" id="anamespacesdf_html_a8e0cb8cd7d633df7070f4ac647dba6dd"><div class="ttname"><a href="namespacesdf.html#a8e0cb8cd7d633df7070f4ac647dba6dd">sdf.hess_sdf</a></div><div class="ttdeci">def hess_sdf(t, x, y, z, tx, ty, tz)</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00019">sdf.py:19</a></div></div>
<div class="ttc" id="anamespacesdf_html_ac2b07b9017ab10899f20d13248fdec5c"><div class="ttname"><a href="namespacesdf.html#ac2b07b9017ab10899f20d13248fdec5c">sdf.grad_sdf</a></div><div class="ttdeci">def grad_sdf(t, x, y, z, tx, ty, tz)</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00015">sdf.py:15</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a221a1f7811ad523d9606b0294168e2c2"><div class="ttname"><a href="operators__tests_8cpp.html#a221a1f7811ad523d9606b0294168e2c2">OpGradTimesTensor</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::LinearForm&lt; I &gt;::OpGradTimesTensor&lt; 1, FIELD_DIM, SPACE_DIM &gt; OpGradTimesTensor</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00047">operators_tests.cpp:48</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition:</b> <a href="plate_8cpp_source.html#l00059">plate.cpp:59</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="astruct_common_data_html"><div class="ttname"><a href="struct_common_data.html">CommonData</a></div><div class="ttdef"><b>Definition:</b> <a href="continuity__check__on__skeleton__with__simple__2d__for__h1_8cpp_source.html#l00022">continuity_check_on_skeleton_with_simple_2d_for_h1.cpp:22</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a156ca0a3ebf97981cc3886e583a6bf8a"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a156ca0a3ebf97981cc3886e583a6bf8a">ContactOps::CommonData::sdfVals</a></div><div class="ttdeci">VectorDouble sdfVals</div><div class="ttdoc">size is equal to number of gauss points on element</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00019">ContactOps.hpp:19</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a4a0843d723416b4f6de26172d479b40a"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a4a0843d723416b4f6de26172d479b40a">ContactOps::CommonData::contactTraction</a></div><div class="ttdeci">MatrixDouble contactTraction</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00016">ContactOps.hpp:16</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a5e05ac3846de04dbea1b09c79a775a87"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a5e05ac3846de04dbea1b09c79a775a87">ContactOps::CommonData::getFTensor1TotalTraction</a></div><div class="ttdeci">static auto getFTensor1TotalTraction()</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00041">ContactOps.hpp:41</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a713eb1a9fe7ebbe37e10e12a1497d2f9"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a713eb1a9fe7ebbe37e10e12a1497d2f9">ContactOps::CommonData::contactTractionPtr</a></div><div class="ttdeci">auto contactTractionPtr()</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00055">ContactOps.hpp:55</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a73cae071096b10b8a752e554e99eb6e2"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a73cae071096b10b8a752e554e99eb6e2">ContactOps::CommonData::contactDisp</a></div><div class="ttdeci">MatrixDouble contactDisp</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00017">ContactOps.hpp:17</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a74572bf0df1fbe72541825d3b1e03d36"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a74572bf0df1fbe72541825d3b1e03d36">ContactOps::CommonData::hessSdfPtr</a></div><div class="ttdeci">auto hessSdfPtr()</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00072">ContactOps.hpp:72</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a8715a01efb0d29bec0d727f13cdb1915"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a8715a01efb0d29bec0d727f13cdb1915">ContactOps::CommonData::hessSdf</a></div><div class="ttdeci">MatrixDouble hessSdf</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00022">ContactOps.hpp:22</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a93960a0684f18798cced6c9604032a7d"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a93960a0684f18798cced6c9604032a7d">ContactOps::CommonData::gradSdfPtr</a></div><div class="ttdeci">auto gradSdfPtr()</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00068">ContactOps.hpp:68</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_a9e5abc73f42d4b846e34a23d4091b5b0"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#a9e5abc73f42d4b846e34a23d4091b5b0">ContactOps::CommonData::gradsSdf</a></div><div class="ttdeci">MatrixDouble gradsSdf</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00020">ContactOps.hpp:20</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_ae161b9f0e428ca758abfdc3df05d11e0"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#ae161b9f0e428ca758abfdc3df05d11e0">ContactOps::CommonData::contactDispPtr</a></div><div class="ttdeci">auto contactDispPtr()</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00060">ContactOps.hpp:60</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_common_data_html_affcb1181ef02d0dba1f7a4fb23ea25d2"><div class="ttname"><a href="struct_contact_ops_1_1_common_data.html#affcb1181ef02d0dba1f7a4fb23ea25d2">ContactOps::CommonData::sdfPtr</a></div><div class="ttdeci">auto sdfPtr()</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00064">ContactOps.hpp:64</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_contact_integrators_1_1_assembly_html_a01acc83f62007cefaf77b220c0a7c726"><div class="ttname"><a href="struct_contact_ops_1_1_contact_integrators_1_1_assembly.html#a01acc83f62007cefaf77b220c0a7c726">ContactOps::ContactIntegrators::Assembly::OpConstrainBoundaryLhs_dU</a></div><div class="ttdeci">OpConstrainBoundaryLhs_dUImpl&lt; DIM, I, AssemblyBoundaryEleOp &gt; OpConstrainBoundaryLhs_dU</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00369">ContactOps.hpp:370</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_contact_integrators_1_1_assembly_html_a5eaeb6222df94697f1ae4ab23bfcd108"><div class="ttname"><a href="struct_contact_ops_1_1_contact_integrators_1_1_assembly.html#a5eaeb6222df94697f1ae4ab23bfcd108">ContactOps::ContactIntegrators::Assembly::OpConstrainBoundaryLhs_dTraction</a></div><div class="ttdeci">OpConstrainBoundaryLhs_dTractionImpl&lt; DIM, I, AssemblyBoundaryEleOp &gt; OpConstrainBoundaryLhs_dTraction</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00373">ContactOps.hpp:374</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_contact_integrators_1_1_assembly_html_aab4f034d2ac56158f1e65407cde211a7"><div class="ttname"><a href="struct_contact_ops_1_1_contact_integrators_1_1_assembly.html#aab4f034d2ac56158f1e65407cde211a7">ContactOps::ContactIntegrators::Assembly::OpConstrainBoundaryRhs</a></div><div class="ttdeci">OpConstrainBoundaryRhsImpl&lt; DIM, I, AssemblyBoundaryEleOp &gt; OpConstrainBoundaryRhs</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00365">ContactOps.hpp:366</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_contact_integrators_html_a10fa799bc2437b803f5819e785179833"><div class="ttname"><a href="struct_contact_ops_1_1_contact_integrators.html#a10fa799bc2437b803f5819e785179833">ContactOps::ContactIntegrators::OpEvaluateSDF</a></div><div class="ttdeci">OpEvaluateSDFImpl&lt; DIM, I, BoundaryEleOp &gt; OpEvaluateSDF</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00357">ContactOps.hpp:357</a></div></div>
<div class="ttc" id="astruct_contact_ops_1_1_contact_integrators_html_ae323a46768620e9e849454690a6e1bde"><div class="ttname"><a href="struct_contact_ops_1_1_contact_integrators.html#ae323a46768620e9e849454690a6e1bde">ContactOps::ContactIntegrators::OpAssembleTotalContactTraction</a></div><div class="ttdeci">OpAssembleTotalContactTractionImpl&lt; DIM, I, BoundaryEleOp &gt; OpAssembleTotalContactTraction</div><div class="ttdef"><b>Definition:</b> <a href="adv-1_2src_2_contact_ops_8hpp_source.html#l00353">ContactOps.hpp:354</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_a5022d618bbaf375d0a07588e50a297a5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5022d618bbaf375d0a07588e50a297a5">MoFEM::ForcesAndSourcesCore::UserDataOperator::getFTensor1CoordsAtGaussPts</a></div><div class="ttdeci">auto getFTensor1CoordsAtGaussPts()</div><div class="ttdoc">Get coordinates at integration points assuming linear geometry.</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01265">ForcesAndSourcesCore.hpp:1265</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_a8d917e73cbaa9f177cdea72e1e7500dd"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">MoFEM::ForcesAndSourcesCore::UserDataOperator::getFTensor0IntegrationWeight</a></div><div class="ttdeci">auto getFTensor0IntegrationWeight()</div><div class="ttdoc">Get integration weights.</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01236">ForcesAndSourcesCore.hpp:1236</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_aa0f5b68e1ab8bc7e79ea1b3d969eb400"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">MoFEM::ForcesAndSourcesCore::UserDataOperator::getMeasure</a></div><div class="ttdeci">double getMeasure() const</div><div class="ttdoc">get measure of element</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01271">ForcesAndSourcesCore.hpp:1271</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_aa7d672543f15f3c2d3b3159a4331d7bf"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa7d672543f15f3c2d3b3159a4331d7bf">MoFEM::ForcesAndSourcesCore::UserDataOperator::getTStime</a></div><div class="ttdeci">double getTStime() const</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01196">ForcesAndSourcesCore.hpp:1196</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_ae90a09d3c36b0a4ed9ab1d99fcce0c1d"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">MoFEM::ForcesAndSourcesCore::UserDataOperator::getGaussPts</a></div><div class="ttdeci">MatrixDouble &amp; getGaussPts()</div><div class="ttdoc">matrix of integration (Gauss) points for Volume Element</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01232">ForcesAndSourcesCore.hpp:1232</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_base_impl_html_a097ca344995d4a64b08a13c5fc2dbcf8"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_base_impl.html#a097ca344995d4a64b08a13c5fc2dbcf8">MoFEM::OpBaseImpl::locF</a></div><div class="ttdeci">VectorDouble locF</div><div class="ttdoc">local entity vector</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00242">FormsIntegrators.hpp:242</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_base_impl_html_a6c48b3705b328e6da3123939fdbc3afa"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_base_impl.html#a6c48b3705b328e6da3123939fdbc3afa">MoFEM::OpBaseImpl::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">number of dofs on rows</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00227">FormsIntegrators.hpp:227</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_base_impl_html_aa09421326d490a4e1d04a10b0f0a0311"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_base_impl.html#aa09421326d490a4e1d04a10b0f0a0311">MoFEM::OpBaseImpl::locMat</a></div><div class="ttdeci">MatrixDouble locMat</div><div class="ttdoc">local entity block matrix</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00240">FormsIntegrators.hpp:240</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_base_impl_html_ae78132be7358cf14a3da7576328d7ccb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_base_impl.html#ae78132be7358cf14a3da7576328d7ccb">MoFEM::OpBaseImpl::nbCols</a></div><div class="ttdeci">int nbCols</div><div class="ttdoc">number if dof on column</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00228">FormsIntegrators.hpp:228</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>