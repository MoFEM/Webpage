<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: COR-6: Solid elasticity</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">COR-6: Solid elasticity </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#simple_elasticity_introduction">Introduction</a></li>
<li class="level1"><a href="#simple_elasticity_problem">The problem</a></li>
<li class="level1"><a href="#simple_elasticity_mesh_input">Mesh input</a></li>
<li class="level1"><a href="#simple_elasticity_code_dissection">Code dissection</a><ul><li class="level2"><a href="#simple_elasticity_header_files">Header files</a></li>
<li class="level2"><a href="#simple_elasticity_initialisation">Initialisation</a></li>
<li class="level2"><a href="#simple_elasticity_createFE">Accessing simple interface</a></li>
<li class="level2"><a href="#simple_elasticity_mesh_block">Mesh block handling</a></li>
</ul>
</li>
<li class="level1"><a href="#simple_elastic_UDO_FE">Introduction of user defined finite element</a><ul><li class="level2"><a href="#simple_elastic_DMM">DMMoFEM</a></li>
<li class="level2"><a href="#simple_elastic_build">Build</a></li>
<li class="level2"><a href="#simple_elastic_fe_instances">Finite element instances</a></li>
</ul>
</li>
<li class="level1"><a href="#simple_elastic_solve_problem">Solving the problem</a></li>
<li class="level1"><a href="#simple_elastic_post_processing">Post processing</a></li>
<li class="level1"><a href="#simple_elastic_clean_memory">Clean memory</a></li>
<li class="level1"><a href="#simple_elastic_UDO">User Defined Operators (UDOs)</a><ul><li class="level2"><a href="#simple_elastic_element_stiffness">Element stiffness matrix</a></li>
<li class="level2"><a href="#simple_elasticity_OpK">OpK</a></li>
<li class="level2"><a href="#simple_elasticity_op_pressure">OpPressure</a></li>
<li class="level2"><a href="#simple_elasticity_apply_Dir_BC">ApplyDirichletBc</a></li>
</ul>
</li>
<li class="level1"><a href="#simple_elasticity_prog_run">Running the program</a></li>
<li class="level1"><a href="#simple_elasticity_exercises">Exercises</a></li>
<li class="level1"><a href="#mai_minimal_surface_equation">The plain program</a></li>
</ul>
</div>
<div class="textblock"><p>This tutorial's motivation is to show how finite element is implemented using basic blocks, like the Lego block where one can combine them in arbitrarily, restricted only by his or her imagination. That is not short and compact code, where PDE can be in single line, but code which can be modified and changed in a way that was not imagined by developers.</p>
<h1><a class="anchor" id="simple_elasticity_introduction"></a>
Introduction</h1>
<p>This tutorial presents in detail a number of basic Finite Element processes implemented in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> through a user module implementation that solves a simple linear elastic problem. The aim of this presentation is to facilitate new developers to familiarise themselves with certain practices and formulations regarding finite element processes and mesh information manipulation. Readers are encouraged to read <a class="el" href="general_data_structure.html">MoFEM Architecture</a>, <a class="el" href="hierarchical_approximation_1.html">FUN-2: Hierarchical approximation</a> and <a class="el" href="hello_world_tut1.html">FUN-0: Hello world</a> before starting the present tutorial. Initially, generation of a mesh is presented and then the module developed for this tutorial is dissected. Finally, code run and post processing of the results are discussed.</p>
<h1><a class="anchor" id="simple_elasticity_problem"></a>
The problem</h1>
<p>The linear elastic problem modelled here is an orthogonal parallelepiped of dimensions \(1.0\times1.0\times4.0 \,\,\rm{m}\), subjected to a uniformly distributed normal traction \(\bar t\) on one face while its opposite face being simply supported. The geometry of the problem is schematically presented in <a class="el" href="simple_elasticity_1.html#Figure_1_Elastic">Figure 1</a>. Boundary conditions are applied on the two faces with both edges equal to \(1\,\,\rm m\). Vertical displacements (along z direction) along the whole area of the bottom face are restricted. To prevent rigid body motion, one of the bottom corners displacements along the x and y direction are restricted by the supports numbered 3 and 2 presented in <a class="el" href="simple_elasticity_1.html#Figure_1_Elastic">Figure 1</a>, respectively. Finally, displacements along y direction is restricted at a different corner of the bottom face by the support number 1 to prevent rigid body rotation.</p>
<p><a class="anchor" id="Figure_1_Elastic"></a></p><div class="image">
<img src="Problem.png" alt="" width="300px"/>
<div class="caption">
Figure 1: Geometry of the problem under consideration: orthogonal parallelepiped with dimensions of 1 m along x and y axis and 4 m along z axis that is simply supported on the bottom face and uniformly distributed normal tractions along the upper face.</div></div>
<p>The boundary conditions where chosen to allow the body to deform freely on both horizontal directions. In this way, verification will be possible by checking the match between Poisson ratio recovered by the analysis results with the one used as input as a material parameter. Since only normal tractions are applied on the top face, no bending will occur along the faces parallel to the z axis and therefore no extra support is needed along the bottom edge connecting support 1 and 2.</p>
<p>Particular features associated to mesh input to solve the problem described here will be presented next.</p>
<h1><a class="anchor" id="simple_elasticity_mesh_input"></a>
Mesh input</h1>
<p>The user module presented here is associated with a specific mesh input. Therefore, mesh generation process is briefly presented focusing only on the steps that are closely linked to the module implementation. There is no intention to provide detail guidelines for using the mesh generator. Mesh generators that can be used to run analyses in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> are Salome, GMsh and Cubit. Mesh features presented here are identical to those found in all three aforementioned software packages.</p>
<p>The mesh presented in <a class="el" href="simple_elasticity_1.html#Figure_2_Elastic">Figure 2</a> corresponds to the geometry of the problem illustrated in <a class="el" href="simple_elasticity_1.html#Figure_1_Elastic">Figure 1</a>. However, it should be noted that the mesh generator as well as <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> do not require a particular choice of units. Instead, the user is responsible to be consisted with her/his own choice of units for any input parameter.</p>
<p><a class="anchor" id="Figure_2_Elastic"></a></p><div class="image">
<img src="CubitMesh1_1.png" alt="" width="600px"/>
<div class="caption">
Figure 2: Mesh geometry of an orthogonal parallelepiped of dimensions of 1x1x4 along x, y and z axis, respectively.</div></div>
<p>To prescribe the boundary conditions for the generated mesh presented in <a class="el" href="simple_elasticity_1.html#Figure_1_Elastic">Figure 1</a>, a number of blocks must be added to the mesh. To prescribe the restriction on the vertical displacements on the bottom face and the normal traction on the upper face, surface blocks 1 and 3 are added on the corresponding faces as presented in <a class="el" href="simple_elasticity_1.html#Figure_3_Elastic">Figure 3</a> and <a class="el" href="simple_elasticity_1.html#Figure_4_Elastic">Figure 4</a>, respectively. Moreover, to assign the displacement restrictions represented by rollers 1, 2 and 3 in <a class="el" href="simple_elasticity_1.html#Figure_1_Elastic">Figure 1</a>, vertex blocks have to be added as presented in <a class="el" href="simple_elasticity_1.html#Figure_5_Elastic">Figure 5</a> and <a class="el" href="simple_elasticity_1.html#Figure_6_Elastic">Figure 6</a>.</p>
<p><a class="anchor" id="Figure_3_Elastic"></a></p><div class="image">
<img src="Block1_1.png" alt="" width="600px"/>
<div class="caption">
Figure 3: Face block added to the bottom face of the orthogonal parallelepiped that will be used to restrain vertical displacements along that face.</div></div>
<p><a class="anchor" id="Figure_4_Elastic"></a></p><div class="image">
<img src="Block3_1.png" alt="" width="600px"/>
<div class="caption">
Figure 4: Face block added to the top face of the orthogonal parallelepiped that will be used to apply uniformly distributed normal tractions along that face.</div></div>
<p><a class="anchor" id="Figure_5_Elastic"></a></p><div class="image">
<img src="Block2_1.png" alt="" width="600px"/>
<div class="caption">
Figure 5: Vertex block added to one of the corners of the bottom face of the orthogonal parallelepiped that will be used to prescribe the boundary conditions represented by the rollers 2 and 3 presented in Figure 1.</div></div>
<p><a class="anchor" id="Figure_6_Elastic"></a></p><div class="image">
<img src="Block4_1.png" alt="" width="600px"/>
<div class="caption">
Figure 6: Vertex block added to one of the corners of the bottom face of the orthogonal parallelepiped that will be used to prescribe the boundary conditions represented by the roller 1 presented in Figure 1.</div></div>
<p>No specific boundary conditions are applied through the mesh generator. To achieve prescription of boundary conditions, certain mesh regions have to be numbered and characterised as ''Blocks''. As explained earlier, block feature exists in Salome, GMsh and Cubit. Therefore, this feature is not restricted to the particular choice of mesh generator. <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> user module executable will read the mesh input file and apply boundary conditions (see Sections <a class="el" href="simple_elasticity_1.html#simple_elasticity_mesh_block">Mesh block handling</a> and <a class="el" href="structApplyDirichletBc.html">ApplyDirichletBc</a>). As an example, a simple journal script which can be used in Cubit to generate the mesh is found below </p><pre class="fragment">reset

# Geometry
brick x 1 y 1 z 4

# Mesh preparation and generation
volume 1 scheme tetmesh
volume 1 size auto factor 10
mesh volume 1

block 1 surface 2
block 2 vertex 7
block 3 surface 1
block 4 vertex 6

# Boundary condition
# The boundary condition for this problem is defined in the source code

# Save the model to *.cub file which will be used in MoFEM code
save as "Users/username/mofem_install/um/build/basic_finite_elements/simple_elasticity/cubit.cub" overwrite
</pre><h1><a class="anchor" id="simple_elasticity_code_dissection"></a>
Code dissection</h1>
<h2><a class="anchor" id="simple_elasticity_header_files"></a>
Header files</h2>
<p>The header file included in the user module are presented below. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="simple_elasticity_initialisation"></a>
Initialisation</h2>
<p>Initially, <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and PETSc has to be initialised through the code line below</p>
<div class="fragment"><div class="line"> <span class="comment">// Initialize MoFEM</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, (<span class="keywordtype">char</span> *)0, <a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
</div><!-- fragment --><p>and now PETSc objects can now be declared. As discussed in <a class="el" href="general_data_structure.html">MoFEM Architecture</a> article, PETSc objects are used to solve the large computational problem of the system of linear equations.</p>
<p>To create the mesh database and an interface to interact with it, the following piece of code is included </p><div class="fragment"><div class="line"><span class="comment">// Create MoFEM database and link it to MoAB</span></div>
<div class="line"><a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> mb_instance;<span class="comment">//create database</span></div>
<div class="line"><a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = mb_instance; <span class="comment">//create interface to database  </span></div>
</div><!-- fragment --><p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database is created along with an interface object that will be used as a mean to interact with MoAB database </p><div class="fragment"><div class="line"><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab); <span class="comment">//MoFEM database</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core; <span class="comment">//create interface to database</span></div>
</div><!-- fragment --><p>This interaction is schematically presented as the interaction of level 1 and 2 in <a class="el" href="simple_elasticity_1.html#Figure_7_Elastic">Figure 7</a> on the right hand side.</p>
<p><a class="anchor" id="Figure_7_Elastic"></a></p><div class="image">
<img src="Interface.png" alt="" width="600px"/>
<div class="caption">
Figure 7: Database interaction using interface objects Discrete Manager, m_field and Simple interface.</div></div>
<p>Moreover, the Discrete Manager that is the PETSc implementation within <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> has to be register to PETSc (schematically presented as interaction of levels 1 and 2 on the left hand side in <a class="el" href="simple_elasticity_1.html#Figure_7_Elastic">Figure 7</a>) </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(<span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
</div><!-- fragment --><p>Interaction of levels 2 and 3 is going to be described in Section <a class="el" href="simple_elasticity_1.html#simple_elasticity_createFE">Accessing simple interface</a>.</p>
<p>To read data from the command line when executing the program the lines below are introduced </p><div class="fragment"><div class="line"><span class="comment">// Get command line options</span></div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 3;                    <span class="comment">// default approximation order</span></div>
<div class="line">PetscBool flg_test = PETSC_FALSE; <span class="comment">// true check if error is numerical error</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;SimpleElasticProblem&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set approximation order</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-order&quot;</span>, <span class="stringliteral">&quot;approximation order&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, &amp;<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set testing (used by CTest)</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-test&quot;</span>, <span class="stringliteral">&quot;if true is ctest&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, flg_test, &amp;flg_test, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEnd();</div>
</div><!-- fragment --><h2><a class="anchor" id="simple_elasticity_createFE"></a>
Accessing simple interface</h2>
<p>A pointer to an object of type <em>simple_interface</em> is declared. </p><div class="fragment"><div class="line">Simple *simple_interface;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(simple_interface);</div>
</div><!-- fragment --><p>The second line of code creates a link between <em>simple_interface</em> and <em>m_field</em> interface (schematically presented in <a class="el" href="simple_elasticity_1.html#Figure_7_Elastic">Figure 7</a> as the interaction of levels 2 and 3 by the left hand side arrow).</p>
<p>Interface <em>simple_interface</em> has a number of functions implemented that allows the user to build and manipulate PETSc, MoAB core and <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> core databases. For instance, using the code below the mesh file is loaded and information of the mesh is passed to <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database. </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;getOptions();</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;loadFile();</div>
</div><!-- fragment --><h2><a class="anchor" id="simple_elasticity_createFE"></a>
Accessing simple interface</h2>
<p>Fields of user's interest can be introduced to the <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database through <em>simple_interface</em> object as presented below for the shape functions field in our 3D domain. </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;addDomainField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setFieldOrder(<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>); <span class="comment">// to approximate function</span></div>
</div><!-- fragment --><p>By using <a class="el" href="structMoFEM_1_1Simple.html#a5b3d613d37bec6e737f2db6dfdce0f7d">MoFEM::Simple::addDomainField</a> function the name of the field chosen by the user can be introduced (in this case the name chosen is U). The space chosen to operate is H1 and the type of shape functions is chosen through the key-word AINSWORTH_LEGENDRE_BASE are Legendre polynomials proposed by Ainsworth and Coyle. Finally, the hard-coded number 3 determines the dimensions of the degrees of freedom related to each shape functions. Here, this number is 3 since it is a displacement field in a 3D space. Should the unknown field be pressure, then the hard-coded number will be 1 instead of 3 since pressure always has one dimension. Furthermore, the order of the approximation field is introduced through function <a class="el" href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d" title="Set field order.">MoFEM::Simple::setFieldOrder</a>. As explained earlier, the order of the approximated field can be chosen and the appropriate Hierarchical shape functions will be taken into account accordingly.</p>
<p>Other types of fields can also be introduced to <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database. For instance, an error field can be introduced to evaluate the error variance of the solution throughout the domain. There will be explicit presentation of introduction of other fields in next tutorials.</p>
<h2><a class="anchor" id="simple_elasticity_mesh_block"></a>
Mesh block handling</h2>
<dl class="section note"><dt>Note</dt><dd><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> has functionality which allow to set boundary conditions directly in in mesh preprocessor, however here we focus on simple where boundary conditions are handled in direct low level implementation.</dd></dl>
<p>The blocks numbered 1, 2, 3 and 4 (defined in Section <a class="el" href="simple_elasticity_1.html#simple_elasticity_mesh_input">Mesh input</a>) will now be used to apply boundary conditions. First, four Range objects (that are part of MoAB library) are declared for each block </p><div class="fragment"><div class="line"><a class="code" href="classRange.html">Range</a> fix_faces, pressure_faces, fix_nodes, fix_second_node;</div>
</div><!-- fragment --><p>By using the <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> core interface m_field, we loop through all meshSets in our <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> m_field through the macro <a class="el" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce" title="Iterator that loops over a specific Cubit MeshSet in a moFEM field.">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_(m_field, BLOCKSET, bit)</a> as </p><div class="fragment"><div class="line"><span class="keyword">enum</span> MyBcTypes {</div>
<div class="line">  FIX_BRICK_FACES      = 1,</div>
<div class="line">  FIX_NODES            = 2,</div>
<div class="line">  BRICK_PRESSURE_FACES = 3,</div>
<div class="line">  FIX_NODES_Y_DIR      = 4</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(m_field, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>)) {</div>
<div class="line">  <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset = <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshset();</div>
<div class="line">  <span class="keywordtype">int</span> <span class="keywordtype">id</span>               = <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshsetId();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == FIX_BRICK_FACES) { <span class="comment">// brick-faces</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(meshset, 2,</div>
<div class="line">                                                        fix_faces, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classRange.html">Range</a> adj_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(fix_faces, 0, <span class="keyword">false</span>, adj_ents,</div>
<div class="line">                                              moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(fix_faces, 1, <span class="keyword">false</span>, adj_ents,</div>
<div class="line">                                              moab::Interface::UNION);</div>
<div class="line">    fix_faces.merge(adj_ents);</div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == FIX_NODES) { <span class="comment">// node(s)</span></div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(meshset, 0,</div>
<div class="line">                                                        fix_nodes, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> == BRICK_PRESSURE_FACES) { <span class="comment">// brick pressure faces</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(</div>
<div class="line">        meshset, 2, pressure_faces, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<span class="keywordtype">id</span> ==</div>
<div class="line">             FIX_NODES_Y_DIR) { <span class="comment">// restrained second node in y direction</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(</div>
<div class="line">        meshset, 0, fix_second_node, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Unknown blockset&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>the identity of each meshSet is found as</p>
<div class="fragment"><div class="line"><a class="code" href="classEntityHandle.html">EntityHandle</a> meshset = <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshset();</div>
<div class="line"><span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;getMeshsetId();</div>
</div><!-- fragment --><p>the <em>id</em> values correspond to the block numbering presented in Section <a class="el" href="simple_elasticity_1.html#simple_elasticity_mesh_input">Mesh input</a>. When the value of id is equal to 1, 2, 3 or 4 boundary conditions are prescribed following the schematic in <a class="el" href="simple_elasticity_1.html#Figure_1_Elastic">Figure 1</a>.</p>
<p>For <em>id</em> equal to 1, the <em>meshset</em> is copied to object <em>fix_faces</em> through the MoAB function </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(meshset, 2, fix_faces, <span class="keyword">true</span>);</div>
</div><!-- fragment --><p>were the hard coded number 2, refers to the dimension of entity under consideration which in this case is a face. Numbers 0, 1 and 3 correspond to vertices, edges and volumes, respectively.</p>
<p>Since we are interested in prescribing all degrees of freedom lying along the faces, we need to copy all corresponding entities i.e. vertices and edges, to the fix_faces object. This can be achieved by using the MoAB function <em>get_adjacencies</em> that provides information for the entities adjacent to the input meshset (in this case <em>fix_faces</em>). To implement this, another <em>Range</em> object with name <em>adj_ents</em> is created where all the information of the adjacent entities are going to be copied as presented below.</p>
<div class="fragment"><div class="line"><a class="code" href="classRange.html">Range</a> adj_ents;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(fix_faces, 0, <span class="keyword">false</span>, adj_ents, moab::Interface::UNION);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(fix_faces, 1, <span class="keyword">false</span>, adj_ents, moab::Interface::UNION);</div>
</div><!-- fragment --><p>Similar to the case of function <em>get_entities_by_dimension</em>, hard coded integers indicate the type of entities under consideration. Thereafter, all information passed to the new <em>Range</em> object adj_ents is copied to <em>fix_faces</em> object through the MoAB function merge as </p><div class="fragment"><div class="line">fix_faces.merge(adj_ents);</div>
</div><!-- fragment --><p>For the vertex type <em>meshsets</em>, no adjacencies are needed since only the degrees of freedom associated to each block is going to be prescribed. Therefore, invoking <em>get_entities_by_dimension</em> function is sufficient.</p>
<p>For the case of the block of the upper face (<em>id</em> = 3), only the degrees of freedom associated to the face are needed. Since the traction is uniform and normal to the upper surface, it can be implemented as pressure and therefore its implementation requires only degrees of freedom associated to the face as presented in section `&lsquo;Application of boundary conditions&rsquo;'.</p>
<p>Finally, the rest of blocks are of vertex type and there is no need to search for adjacencies since only the degrees of freedom at those points are needed to be prescribed.</p>
<h2><a class="anchor" id="simple_elasticity_mesh_block"></a>
Mesh block handling</h2>
<p>All problems tackled by user modules proceed with the same workflow for construction of the FEM solution. The workflow implemented in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is schematically presented in <a class="el" href="simple_elasticity_1.html#Figure_8_Elastic">Figure 8</a> and consists of Definition,</p>
<p>Build and Assemble processes. <a class="anchor" id="Figure_8_Elastic"></a></p><div class="image">
<img src="WorkFlow.png" alt="" width="200px"/>
<div class="caption">
Figure 8: MoFEM work flow.</div></div>
<p>Definition process encompasses creation of stencils of finite elements, fields and problems that are going to be used for the problem solution. Field stencils include name, dimension and order and are defined as</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;addDomainField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 3);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setFieldOrder(<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
</div><!-- fragment --><p>For the elements, the stencil includes element's name, dimension, type of fields that are going to be approximated in this element and the location of the element that the fields operate (volume, boundary or skeleton). Each kind of element used needs a different kind of stencil to be defined.</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;defineFiniteElements();</div>
</div><!-- fragment --><p>For reasons that will be apparent in Section <a class="el" href="simple_elasticity_1.html#simple_elasticity_op_pressure">OpPressure</a>, we will apply traction boundary conditions through a new element. Since this element is unknown to the simple interface structure we need to explicitly define the element to be included in <em>m_field</em> </p><div class="fragment"><div class="line"><span class="comment">// Add pressure element</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);   </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
</div><!-- fragment --><p>Initially, the new finite element type with name is added to <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> core database through the function <em>add_finite_element</em>("PRESSURE"), where the string "PRESSURE" used as input is the name that we chose to call the new element. Then, the row and col field information of the "PRESSURE" element are set to be those of "U" type. Furthermore, the list of fields that are associated with "PRESSURE" element listed in the elements data is then set to be only the "U" type field. In a more complicated case, more than one fields can be added to the data, row and col structures of a finite element. Similarly, definition of each problem stencil consists of problem's name and the stencils of the various elements previously presented and are defined using the code lines below</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;defineProblem();</div>
</div><!-- fragment --><p>Before defining a problem, all kinds of elements used have to be previously defined.</p>
<h1><a class="anchor" id="simple_elastic_UDO_FE"></a>
Introduction of user defined finite element</h1>
<h2><a class="anchor" id="simple_elastic_DMM"></a>
DMMoFEM</h2>
<p>The new `&lsquo;PRESSURE&rsquo;' finite element has to be explicitly added to DMMoFEM since it was not created through <em>simple_interface</em>. Hence, a DM object is declared and it is set to point to the DMMoFEM create by the interface as </p><div class="fragment"><div class="line">DM dm;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;getDM(&amp;dm);</div>
</div><!-- fragment --><p>and then the `&lsquo;PRESSURE&rsquo;' finite element is going to be added to DMMoFEM as</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm, <span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
</div><!-- fragment --><p>This is schematically illustrated as the interaction of levels 2 and 3 on the left hand side of <a class="el" href="simple_elasticity_1.html#Figure_7_Elastic">Figure 7</a>. Then all information introduced to DMMoFEM manager is partitioned</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(dm, PETSC_TRUE);</div>
</div><!-- fragment --><p>This has to be explicitly defined in order to be able to solve the problem in parallel computing where matrix assembly, linear system of equations and mesh is distributed between processors.</p>
<h2><a class="anchor" id="simple_elastic_build"></a>
Build</h2>
<p>Then, fields and finite elements declared through <em>simple_interface</em> are built (second stage presented in <a class="el" href="simple_elasticity_1.html#Figure_8_Elastic">Figure 8</a>).</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;buildFields();</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;buildFiniteElements();</div>
</div><!-- fragment --><p>First, the dimension and order of fields according to the specific input chosen is added to the field. In this case, the approximation field of Hierarchic shape functions of Ainsworth and Coyle Legendre polynomials type of order 3 and dimension 3 will be set to the field.</p>
<p>Thereafter, finite elements are built i.e. entities of the finite elements are linked to the field components that were previously built and the order of approximation is set to each entity.</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">add_ents_to_finite_element_by_dim</a>(0, simple_interface-&gt;getDim(), simple_interface-&gt;getDomainFEName(), <span class="keyword">true</span>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(simple_interface-&gt;getDomainFEName());</div>
</div><!-- fragment --><p>entities associated with the user defined `&lsquo;PRESSURE&rsquo;' finite element have to be explicitly added to the finite element</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">add_ents_to_finite_element_by_dim</a>(pressure_faces, 2, <span class="stringliteral">&quot;PRESSURE&quot;</span>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<span class="stringliteral">&quot;PRESSURE&quot;</span>, &amp;pressure_faces);</div>
</div><!-- fragment --><p>Then to build all information regarding the element connectivities, and fields associated to element entities into <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> core, the function below is invoked.</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;buildProblem();</div>
</div><!-- fragment --><h2><a class="anchor" id="simple_elastic_fe_instances"></a>
Finite element instances</h2>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is designed such that approximation fields definition, FE element declaration, FE element definition and FE implementation is explicitly disentangled. That gives us great flexibility allowing for combining individual parts of the code in a countless number of variations.</p>
<p>Implementation FE element can be done on range of levels of abstractions. Here we present implementation which introduces the concept of <em>User</em> <em>Defined</em> <em>Operator</em>. Using its implementation is not constrained to finite element shape or approximation base of fields. In case of coupled or mix formulation, it enables to break down complex code into smaller easy sub-tasks. Here we only introduce basic concepts of this technology.</p>
<p>To create stiffness matrices and apply boundary conditions we will need to finite element instance and attach <em>User</em> <em>Defined</em> <em>Operators</em> (UDOs). For the stiffness matrix evaluation a new shared pointer <em>elastic_fe</em> is instantiated to build elastic finite element instance and a UDO is pushed to the elastic finite elements</p>
<div class="fragment"><div class="line">boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; elastic_fe(<span class="keyword">new</span> VolumeElementForcesAndSourcesCore(m_field));</div>
<div class="line">elastic_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>());</div>
</div><!-- fragment --><p>schematically presented in <a class="el" href="simple_elasticity_1.html#Figure_9_Elastic">Figure 9</a>.</p>
<p><a class="anchor" id="Figure_9_Elastic"></a></p><div class="image">
<img src="OperatorPush.png" alt="" width="600px"/>
<div class="caption">
Figure 9: Schematic representation inclusion process of User Defined Operators to finite element data structure.</div></div>
<p>It is important to state that each instance of the structure of elastic finite element pointed by shared pointed <em>elastic_fe</em> carries with it the operator <a class="el" href="structOpK.html">OpK</a>. Element can have sequence of operators, see for example <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a>.</p>
<p>To apply the traction boundary conditions, shared pointer <em>pressure_fe</em> is instantiated and then the operator <a class="el" href="structOpPressure.html">OpPressure</a> is attached to it to prescribe the traction boundary conditions.</p>
<div class="fragment"><div class="line"><span class="comment">// push operators to elastic_fe</span></div>
<div class="line">boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; pressure_fe(<span class="keyword">new</span> <a class="code" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(m_field));</div>
<div class="line">pressure_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structOpPressure.html">OpPressure</a>());</div>
</div><!-- fragment --><p>Finally, to prescribe the Dirichlet boundary conditions, the shared pointer fix_dofs_fe is instantiated as a <a class="el" href="structApplyDirichletBc.html">ApplyDirichletBc</a> that is inherited from <a class="el" href="structMoFEM_1_1FEMethod.html" title="structure for User Loop Methods on finite elements">MoFEM::FEMethod</a> type (which lies within the class that are in the finite elements family within <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>) as </p><div class="fragment"><div class="line">boost::shared_ptr&lt;FEMethod&gt; fix_dofs_fe(<span class="keyword">new</span> <a class="code" href="structApplyDirichletBc.html">ApplyDirichletBc</a>(fix_faces, fix_nodes, fix_second_node));</div>
</div><!-- fragment --><p>The Ranges of <em>fix_faces</em>, <em>fix_nodes</em> and <em>fix_second_node</em> are given as input to the constructor of <a class="el" href="structApplyDirichletBc.html">ApplyDirichletBc</a> to provide the mesh information regarding the location of the degrees of freedom that will be prescribed.</p>
<p>Implementation of <a class="el" href="structOpK.html">OpK</a>, <a class="el" href="structOpPressure.html">OpPressure</a> and <a class="el" href="structApplyDirichletBc.html">ApplyDirichletBc</a> is presented in Section <a class="el" href="simple_elasticity_1.html#simple_elastic_UDO">User Defined Operators (UDOs)</a>. A more general implementation for application of boundary conditions will be presented in future tutorials.</p>
<h1><a class="anchor" id="simple_elastic_solve_problem"></a>
Solving the problem</h1>
<p>In this example the KSP solver provided by PETSc is used. Initially, finite elements are pushed to the discrete manager and set KSP operators for assembling the stiffness matrix.</p>
<div class="fragment"><div class="line"><span class="comment">// Set operators for KSP solver</span></div>
<div class="line">    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code" href="group__dm.html#gadf1d5425969ed88f332549c5b4ba5291">DMMoFEMKSPSetComputeOperators</a>(</div>
<div class="line">        dm, simple_interface-&gt;getDomainFEName(), elastic_fe, nullFE, nullFE);</div>
</div><!-- fragment --><p>Then, right hand side vector is evaluated and KSP operators are set to handle it.</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga96ba475206db6215c72937e77047415c">DMMoFEMKSPSetComputeRHS</a>(</div>
<div class="line">    dm, <span class="stringliteral">&quot;PRESSURE&quot;</span>, pressure_fe, nullFE, nullFE);</div>
</div><!-- fragment --><p>Thereafter, stiffness matrix <em>A</em>, vector of degrees of freedom <em>x</em> and right hand side vector <em>f</em> are declared and associated to the Discrete Manager DM</p>
<div class="fragment"><div class="line"><span class="comment">//initialise matrix A used as the global stiffness matrix</span></div>
<div class="line"> Mat <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//initialise left hand side vector x and right hand side vector f</span></div>
<div class="line"> <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> x, <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>; </div>
<div class="line"> </div>
<div class="line"> <span class="comment">//allocate memory handled by MoFEM discrete manager for matrix A</span></div>
<div class="line"> <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm, &amp;<a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//allocate memory handled by MoFEM discrete manager for vector x</span></div>
<div class="line"> <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm, &amp;x);</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//allocate memory handled by MoFEM discrete manager for vector f of the same size as x</span></div>
<div class="line"> <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(x, &amp;<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>);</div>
</div><!-- fragment --><p>Thereafter, members of finite elements instances are set to point to the aforementioned objects </p><div class="fragment"><div class="line"><span class="comment">//precondition matrix A according to fix_dofs_fe  and elastic_fe finite elements</span></div>
<div class="line">elastic_fe-&gt;ksp_B  = <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line">fix_dofs_fe-&gt;ksp_B = <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line"> </div>
<div class="line"> <span class="comment">//precondition the right hand side vector f according to fix_dofs_fe  and elastic_fe finite elements</span></div>
<div class="line">fix_dofs_fe-&gt;ksp_f = <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>;</div>
<div class="line">pressure_fe-&gt;ksp_f = <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>;</div>
</div><!-- fragment --><p>Now all finite elements are prepared to be iterated (all operators have been pushed to the elements and their members point to the structural problem A, f and x objects) in order to Assembly the problem, i.e. the third part of the work flow presented in <a class="el" href="simple_elasticity_1.html#Figure_8_Elastic">Figure 8</a>. Now, each element created is iterated to compute and assemble the stiffness matrix and left hand and right hand vectors as </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, simple_interface-&gt;getDomainFEName(), elastic_fe);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;PRESSURE&quot;</span>, pressure_fe);</div>
</div><!-- fragment --><p>Furthermore, the part of the prescribed degrees of freedom are assembled in the left hand side vector through </p><div class="fragment"><div class="line"><span class="comment">//This is done because only post processor is implemented in the ApplyDirichletBc struct</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(dm, fix_dofs_fe.get());</div>
</div><!-- fragment --><p>Implementation of UDOs associated with <em>pressure_fe</em> and <em>fix_dof_fe</em> are going to be presented in Section <a class="el" href="simple_elasticity_1.html#simple_elastic_UDO">User Defined Operators (UDOs)</a>.</p>
<p>At this point matrix and two vectors have been assembled and we can now solve our system of linear equations. Solver is declared first and then connected to the <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> core as </p><div class="fragment"><div class="line"> <span class="comment">//make available a KSP solver</span></div>
<div class="line">KSP solver;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//make the solver available for parallel computing by determining its MPI communicator</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPCreate(PETSC_COMM_WORLD, &amp;solver);</div>
</div><!-- fragment --><p>The solver object operators have to be prepared </p><div class="fragment"><div class="line"><span class="comment">//making available running all options available for KSP solver in running command</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(solver);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set A matrix to KSP solver and preconditioner</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(solver, <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>, <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//set up the solver data structure for the iterative solver</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(solver);</div>
</div><!-- fragment --><p> and finally the problem is solved </p><div class="fragment"><div class="line"><span class="comment">//solve the system of linear equations</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(solver, <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, x);</div>
</div><!-- fragment --><p> the results are written in left hand side vector x </p><div class="fragment"><div class="line"><span class="comment">//make vector x available for parallel computations for visualization context</span></div>
<div class="line">VecView(x, PETSC_VIEWER_STDOUT_WORLD);</div>
</div><!-- fragment --><p> and all values of degrees of freedom in x are mapped onto mesh entities </p><div class="fragment"><div class="line"><span class="comment">// save solution in vector x on mesh</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gad94692d0472b346672a25c63e91fb930">DMoFEMMeshToGlobalVector</a>(dm, x, INSERT_VALUES, SCATTER_REVERSE);</div>
</div><!-- fragment --><h1><a class="anchor" id="simple_elastic_post_processing"></a>
Post processing</h1>
<p>To post process numerical results, initially a post processor object of type <a class="el" href="structPostProcVolumeOnRefinedMesh.html" title="Post processing.">PostProcVolumeOnRefinedMesh</a> has to be created based on MoAB database </p><div class="fragment"><div class="line"><span class="comment">// Set up post-processor. It is some generic implementation of finite</span></div>
<div class="line"><span class="comment">// element</span></div>
<div class="line"><a class="code" href="structPostProcVolumeOnRefinedMesh.html">PostProcVolumeOnRefinedMesh</a> post_proc(m_field);</div>
</div><!-- fragment --><p>  Thereafter, information of the problem solution is passed to the post processor as <br  />
 </p><div class="fragment"><div class="line"><span class="comment">// Add operators to the elements, strating with some generic</span></div>
<div class="line"><span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"><span class="keyword">auto</span> grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">post_proc_ele-&gt;getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">post_proc_ele-&gt;getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code" href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                                               grad_ptr));</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPPMap</a> = OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;;</div>
<div class="line"> </div>
<div class="line">post_proc_ele-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">          post_proc_ele-&gt;getPostProcMesh(), post_proc_ele-&gt;getMapGaussPts(),</div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;GRAD&quot;</span>, grad_ptr}},</div>
<div class="line"> </div>
<div class="line">          {})</div>
<div class="line"> </div>
<div class="line">);</div>
<div class="line"> </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, simple_interface-&gt;getDomainFEName().c_str(), &amp;post_proc);</div>
</div><!-- fragment --><p> where initially a reference mesh is created is created, then field values are added and finally all information related to finite elements such ass stain and stresses are added into the post processor.</p>
<p>Finally, all information introduced to the post processor object is written to an output file (in this case named out.h5m) as presented below </p><div class="fragment"><div class="line"><span class="comment">//write output</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.writeFile(<span class="stringliteral">&quot;out.h5m&quot;</span>);</div>
</div><!-- fragment --><h1><a class="anchor" id="simple_elastic_clean_memory"></a>
Clean memory</h1>
<p>All dynamic memory objects A, x, f and DM that were created have to be destroyed as presented below </p><div class="fragment"><div class="line"><span class="comment">//free memory handled by mofem discrete manager for A, x and f</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;<a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;x);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>);</div>
<div class="line"> </div>
<div class="line"><span class="comment">//free memory allocated for mofem discrete manager</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm);</div>
</div><!-- fragment --><p> to free the heap memory and prevent any memory leaks. </p>
<h1><a class="anchor" id="simple_elastic_UDO"></a>
User Defined Operators (UDOs)</h1>
<h2><a class="anchor" id="simple_elastic_element_stiffness"></a>
Element stiffness matrix</h2>
<p>In structural computational mechanics, the relationship to evaluate the element stiffness matrix \(\mathbf{K}\) is given by </p><p class="formulaDsp">
\[ {}^{(r,c)}_eK^{\alpha\beta}_{ik} = \int_{\Omega^e} \varphi_{,j}^\alpha D_{ijkl} \phi_{,k}^\beta \, {d\Omega^e} \label{eq:StiffnessIntegral} \]
</p>
<p> where \({\Omega^e}\) is the element volume, \({\mathbf {D}}\) is the elastic material stiffness tensor. The row base funcrions and column base functions are represented by \(\pmb\varphi^\alpha\) and \(\pmb\phi^\beta\), respectively. \(\alpha=1,\dots,N^\textrm{row}\) and \(\beta= 1,\dots,N^\textrm{col}\) are indices of base function on row entities and column entities, respectively. \(N^\textrm{row}\) and \(N^\textrm{col}\) are numbers of base funcions on row entity and collumn entity. The differentation is indicated by subscript and index after the comma, as follows </p><p class="formulaDsp">
\[ \varphi^\alpha_{,j} := \frac{\partial \varphi^\alpha}{\partial x_j}. \]
</p>
<p> where </p><p class="formulaDsp">
\[ i,j = 0,1,2 \]
</p>
<p>The integration of the element stiffness matrix is broken down into blocks, utilizing the construction of hierarchical approximation basis. For a hierarchical approximation, base DOFs are grouped on vertices, edges, faces and in the volume of the element, see for details to tutorial <a class="el" href="hello_world_tut1.html">FUN-0: Hello world</a>. In this tutorial matrix \({}^{(r,c)}_e\mathbf{K}\) is integrated by running over a combination of block, that is indicated by superscripts \((r,c)\) on the left to the matrix \(\mathbf{K}\), where left-subscripts takes values </p><p class="formulaDsp">
\[ r,c := \{\textrm{ver, edge, face, vol} \} \label{eq:setI} \]
</p>
<p> The element matrix broked down on block subentities cab be represented as follows </p><p class="formulaDsp">
\[ {}_e\mathbf{K} = \left[ \begin{array}{cccc} {}^{\textrm {ver ver}}\mathbf{K} &amp; {}^{\textrm {ver edge}}\mathbf{K} &amp; {}^{\textrm {ver face}}\mathbf{K} &amp; {}^{\textrm {ver vol}}\mathbf{K}\\ &amp; {}^{\textrm {edge edge}}\mathbf{K} &amp; {}^{\textrm {edge face}}\mathbf{K} &amp; {}^{\textrm {edge vol}}\mathbf{K}\\ &amp;&amp; {}^{\textrm {face face}}\mathbf{K} &amp; {}^{\textrm {face vol}}\mathbf{K}\\ &amp;&amp;&amp; {}^{\textrm {vol vol}}\mathbf{K}\\ \end{array} \right] \label{eq:StiffStiff} \]
</p>
<p> Note that only symmetric part is calculated since the element stiffness matrix is symmetric.</p>
<h2><a class="anchor" id="simple_elasticity_OpK"></a>
OpK</h2>
<p>The operator called <a class="el" href="structOpK.html">OpK</a> is implemented as a class inheriting class <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a> </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structOpK.html">OpK</a> : <span class="keyword">public</span> <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --><p>Struct's public members are </p><div class="fragment"><div class="line"><span class="comment">// Finite element stiffness sub-matrix K</span></div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major symmetry)</span></div>
<div class="line"><a class="code" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;double, 3, 3&gt;</a> tD;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//Young&#39;s modulus</span></div>
<div class="line"><span class="keywordtype">double</span> yOung;</div>
<div class="line"><span class="comment">//Poisson&#39;s ratio</span></div>
<div class="line"><span class="keywordtype">double</span> pOisson;</div>
</div><!-- fragment --><p>The first four lines encompass the declaration of matrices used for the calculation of the elements stiffness matrix as presented in Section <a class="el" href="simple_elasticity_1.html#simple_elastic_element_stiffness">Element stiffness matrix</a>.</p>
<p>The next line variables are associated to the material stiffness tensor where D is forth order tensor symmetric on two fisrt and two last indices, <em>yOung</em> is the Young's modulus and <em>pOisson</em> is Poisson's ratio. <a class="el" href="structOpK.html">OpK</a> constructor is implemented as follows </p><div class="fragment"><div class="line"><a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>(<span class="keywordtype">bool</span> symm = <span class="keyword">true</span>) : VolumeElementForcesAndSourcesCore::<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">UserDataOperator</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, OPROWCOL, symm)</div>
<div class="line"> {</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Evaluation of the elastic stiffness tensor, D, in the Voigt notation is</span></div>
<div class="line">   <span class="comment">// done in the constructor</span></div>
<div class="line"> </div>
<div class="line">   <span class="comment">// hardcoded choice of elastic parameters</span></div>
<div class="line">   pOisson = 0.1;</div>
<div class="line">   yOung   = 10;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// coefficient used in intermediate calculation</span></div>
<div class="line">   <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = yOung / ((1 + pOisson) * (1 - 2 * pOisson));</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">   <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">   <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">   <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">   tD(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line"> </div>
<div class="line">   tD(0, 0, 0, 0) = 1 - pOisson;</div>
<div class="line">   tD(1, 1, 1, 1) = 1 - pOisson;</div>
<div class="line">   tD(2, 2, 2, 2) = 1 - pOisson;</div>
<div class="line"> </div>
<div class="line">   tD(0, 1, 0, 1) = 0.5 * (1 - 2 * pOisson);</div>
<div class="line">   tD(0, 2, 0, 2) = 0.5 * (1 - 2 * pOisson);</div>
<div class="line">   tD(1, 2, 1, 2) = 0.5 * (1 - 2 * pOisson);</div>
<div class="line"> </div>
<div class="line">   tD(0, 0, 1, 1) = pOisson;</div>
<div class="line">   tD(1, 1, 0, 0) = pOisson;</div>
<div class="line">   tD(0, 0, 2, 2) = pOisson;</div>
<div class="line">   tD(2, 2, 0, 0) = pOisson;</div>
<div class="line">   tD(1, 1, 2, 2) = pOisson;</div>
<div class="line">   tD(2, 2, 1, 1) = pOisson;</div>
<div class="line"> </div>
<div class="line">   tD(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient;</div>
<div class="line"> }</div>
</div><!-- fragment --><p> where the material stiffness tensor for <a class="el" href="structHooke.html" title="Hook equation.">Hooke</a> material is calculated.</p>
<p>When solving the problem, as presented in Section <a class="el" href="simple_elasticity_1.html#simple_elastic_solve_problem">Solving the problem</a>, all finite elements are looped where this loop invokes the <a class="el" href="structOpK.html#ade86d0908a39a05133b670975ac0896e" title="Do calculations for give operator.">OpK::doWork</a> method of each operator of the finite element. The <a class="el" href="structOpK.html#ade86d0908a39a05133b670975ac0896e" title="Do calculations for give operator.">OpK::doWork</a> method of operator <a class="el" href="structOpK.html">OpK</a> is implemented as follows </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(</div>
<div class="line">      <span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side,</div>
<div class="line">      EntityType row_type, EntityType col_type,</div>
<div class="line">      <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data, <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    nbRows = row_data.getIndices().size();</div>
<div class="line">    <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">    <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get number of dofs on column</span></div>
<div class="line">    nbCols = col_data.getIndices().size();</div>
<div class="line">    <span class="comment">// if no dofs on Columbia, exit nothing to do here</span></div>
<div class="line">    <span class="keywordflow">if</span> (!nbCols)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// K_ij matrix will have 3 times the number of degrees of freedom of the</span></div>
<div class="line">    <span class="comment">// i-th entity set (nbRows)</span></div>
<div class="line">    <span class="comment">// and 3 times the number of degrees of freedom of the j-th entity set</span></div>
<div class="line">    <span class="comment">// (nbCols)</span></div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.clear();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    nbIntegrationPts = getGaussPts().size2();</div>
<div class="line">    <span class="comment">// check if entity block is on matrix diagonal</span></div>
<div class="line">    <span class="keywordflow">if</span> (row_side == col_side &amp;&amp; row_type == col_type) {</div>
<div class="line">      isDiag = <span class="keyword">true</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      isDiag = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data, col_data);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data, col_data);</div>
<div class="line">    </div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --><p>The element's column and row data structures as described in `&lsquo;Hierarchic approximation&rsquo;' tutorial are passed to this function as <em>col_type</em> and <em>row_type</em> respectively.</p>
<p>The number of degrees of freedom associated to each structure (which are equal to the length of the column and row) is then passed to variables <em>nbCols</em> and <em>nbRows</em> and checked that they are non-zero </p><div class="fragment"><div class="line"><span class="comment">// get number of dofs on row</span></div>
<div class="line">nbRows = row_data.getIndices().size();</div>
<div class="line"><span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line"><span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">  <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><span class="comment">// get number of dofs on column</span></div>
<div class="line">nbCols = col_data.getIndices().size();</div>
<div class="line"><span class="comment">// if no dofs on columns, exit nothing to do here</span></div>
<div class="line"><span class="keywordflow">if</span> (!nbCols)</div>
<div class="line">  <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
</div><!-- fragment --><p> after the element's lengths of row and columns are passed to nbRows and nbCols and checked to be non-zero, memory for the element's stiffness matrix K that is allocated; </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line"><a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.clear();</div>
</div><!-- fragment --><p>Next, integration of element block stiffnes matrxi is executed, explained in \(\eqref {eq:StiffnessIntegral}\), and finally local matrix is assmble into global stiffnes matrix as follows </p><div class="fragment"><div class="line"><span class="comment">// integrate local matrix for entity block</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data, col_data);</div>
<div class="line"> </div>
<div class="line"><span class="comment">// assemble local matrix</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data, col_data);</div>
</div><!-- fragment --><p>Lets first see the <a class="el" href="structOpK.html#a29289954d152dbefb6a08a0a9c0bef26" title="Integrate B^T D B operator.">OpK::iNtegrate</a> implementation that performs the two inner loops described in Section <a class="el" href="hierarchical_approximation_1.html#hierarchical_approximation_data_structures">Entity approximation functions</a> of <a class="el" href="hierarchical_approximation_1.html">FUN-2: Hierarchical approximation</a> tutorial </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(</div>
<div class="line">      <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data, <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data)</div>
<div class="line">  {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by second</span></div>
<div class="line">    <span class="comment">// order tensor</span></div>
<div class="line">    <span class="keyword">auto</span> get_tensor2 = [](<a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">          &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2),</div>
<div class="line">          &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2),</div>
<div class="line">          &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get intergrayion weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_row_diff_base = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line">    <span class="comment">// iterate over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate over row base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// get sub matrix for the row</span></div>
<div class="line">        <span class="keyword">auto</span> t_m = get_tensor2(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">        <span class="keyword">auto</span> t_col_diff_base = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// iterate column base functions</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3;++cc) {</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// integrate block local stiffens matrix</span></div>
<div class="line">          t_m(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) +=</div>
<div class="line">              <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (tD(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * (t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_col_diff_base(<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>)));</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to next column base function</span></div>
<div class="line">          ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">          ++t_m;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next row base function</span></div>
<div class="line">        ++t_row_diff_base;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next integration weight</span></div>
<div class="line">      ++t_w;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --><p> The code iterates over integration points, base functions on rows and base functions on columns. The essential part of the code is integration itself, </p><div class="fragment"><div class="line">t_m(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (tD(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * (t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_col_diff_base(<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>)));</div>
</div><!-- fragment --><p> Note that is equivalent of sub integral (eq:StiffnessIntegral ). Here we group operation in blocks using brackets, that first derivatives of base functions on rows and columns are multiplied yielding tensor of rank 2 </p><div class="fragment"><div class="line">t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_col_diff_base(<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>)</div>
</div><!-- fragment --><p> and then the tenor of rank two is multiplied by the tenor of rank two, yielding tensor of rank two. Resultant is multiplied by integration weight times volume of the element and added to local element stiffnes matrix. For more information about tenorial operations see <a class="el" href="group__ftensor.html">FTensor library</a></p>
<p>Finally, block local stiffness matrix is assembled into global stiffness matrix as follows </p><div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment">   * \brief Assemble local entity block matrix</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.getIndices().data().begin();</div>
<div class="line">  <span class="comment">// get pointer to first global index on column</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.getIndices().data().begin();</div>
<div class="line">  Mat B = getFEMethod()-&gt;ksp_B != PETSC_NULL ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                             : getFEMethod()-&gt;snes_B;</div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbRows, row_indices, nbCols, col_indices,</div>
<div class="line">                      &amp;*<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.data().begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!isDiag &amp;&amp; sYmm) {</div>
<div class="line">    <span class="comment">// if not diagonal term and since global matrix is symmetric assemble</span></div>
<div class="line">    <span class="comment">// transpose term.</span></div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a> = trans(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbCols, col_indices, nbRows, row_indices,</div>
<div class="line">                        &amp;*<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.data().begin(), ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"> }</div>
</div><!-- fragment --><h2><a class="anchor" id="simple_elasticity_op_pressure"></a>
OpPressure</h2>
<p>The operator created for the "PRESSURE" finite element that is used to evaluate and assign Neumann boundary conditions according to (12) presented in <a class="el" href="hierarchical_approximation_1.html">FUN-2: Hierarchical approximation</a> will be presented in detail. The operator is the struct presented below </p><div class="fragment"><div class="line">  <a class="code" href="structOpPressure.html">OpPressure</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> pressure_val = 1) :</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html">MoFEM</a>::<a class="code" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>::<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">UserDataOperator</a>(<span class="stringliteral">&quot;U&quot;</span>, OPROW),</div>
<div class="line">    pressureVal(pressure_val)</div>
<div class="line">  {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//vector used to store force vector for each degree of freedom</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> nF;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data)</div>
<div class="line">  {</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// check that the faces have associated degrees of freedom</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line">    <span class="keywordflow">if</span> (nb_dofs == 0)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//size of force vector associated to the entity </span></div>
<div class="line">    <span class="comment">//set equal to the number of degrees of freedom of associated with the entity</span></div>
<div class="line">    nF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">    nF.clear();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get number of gauss points</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// create a 3d vector to be used as the normal to the face with length equal</span></div>
<div class="line">    <span class="comment">// to the face area</span></div>
<div class="line">    <span class="keyword">auto</span> t_normal = getFTensor1Normal();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//vector of base functions </span></div>
<div class="line">    <span class="keyword">auto</span> t_base = data.getFTensor0N();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get intergrayion weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// loop over all gauss points of the face</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line">      <span class="comment">// weight of gg gauss point</span></div>
<div class="line">      <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = 0.5 * t_w;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//create a vector t_nf whose pointer points an array of 3 pointers pointing to nF </span></div>
<div class="line">      <span class="comment">//memory location of components</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt; t_nf(&amp;nF[0], &amp;nF[1], &amp;nF[2]);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bb = 0; bb != nb_dofs / 3; ++bb) {</div>
<div class="line">        <span class="comment">//scale the three components of t_normal and pass them to the t_nf (hence to nF)</span></div>
<div class="line">        t_nf(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += (<a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pressureVal * t_base) * t_normal(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        <span class="comment">//move the pointer to next element of t_nf</span></div>
<div class="line">        ++t_nf;</div>
<div class="line">        <span class="comment">//move to next base function</span></div>
<div class="line">        ++t_base;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next integration weight</span></div>
<div class="line">      ++t_w;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line">        getFEMethod()-&gt;ksp_f, nb_dofs, &amp;data.getIndices()[0], &amp;nF[0], ADD_VALUES);</div>
<div class="line">  </div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p>Initially, vector <em>nF</em> that will contain the boundary condition forces is declared and index i is defined to be used to perform compact operations later discussed </p><div class="fragment"><div class="line"> <span class="comment">//vector used to store force vector for each degree of freedom</span></div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> nF;</div>
</div><!-- fragment --><p>The evaluation of boundary conditions for each element that are applied is performed within the <a class="el" href="structOpPressure.html#aa625dc1673e07da64858c80129eed7e6" title="Operator for linear form, usually to calculate values on right hand side.">OpPressure::doWork</a> function. The number of degrees of freedom is initially passed to <em>nb_dofs</em> that is used to appropriately resize vector <em>nF</em>. </p><div class="fragment"><div class="line"><span class="comment">//size of force vector associated to the entity </span></div>
<div class="line"><span class="comment">//set equal to the number of degrees of freedom of associated with the entity</span></div>
<div class="line">nF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">nF.clear();</div>
</div><!-- fragment --><p>Thereafter, the number of gauss points associated to the triangular element is assigned to variable <em>nb_gauss_pts</em> </p><div class="fragment"><div class="line"><span class="comment">// get number of gauss points</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
</div><!-- fragment --><p>the normal to the face is passed to <em>t_normal</em> variable</p>
<div class="fragment"><div class="line"><span class="comment">// create a 3d vector to be used as the normal to the face with length equal</span></div>
<div class="line"><span class="comment">// to the face area</span></div>
<div class="line"><span class="keyword">auto</span> t_normal = getFTensor1Normal();</div>
</div><!-- fragment --><p>Vector <em>t_normal</em> has 3 component (one for each global axis). Its magnitude is equal to the double of the area of the triangle face since FaceElementForcesAndSourcesCore:UserDataOperator:getTensor1Norma() function returns the vector evaluated by the cross product of the vectors having a common origin on one of the faces vertex and their non-coinciding ends located at the other two vertices. This product is the area defined by the parallelogram rule.</p>
<p>Furthermore, <em>t_base</em> vector containing the element's shape functions is initialised </p><div class="fragment"><div class="line"><span class="comment">//vector of base functions </span></div>
<div class="line"><span class="keyword">auto</span> t_base = data.getFTensor0N();</div>
</div><!-- fragment --><p>Then, the loop over all gauss points is performed to evaluate the area integral </p><div class="fragment"><div class="line"><span class="comment">// get intergrayion weights</span></div>
<div class="line"><span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// loop over all gauss points of the face</span></div>
<div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_gauss_pts; ++gg) {</div>
<div class="line">  <span class="comment">// weight of gg gauss point</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = 0.5 * t_w;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">//create a vector t_nf whose pointer points an array of 3 pointers pointing to nF </span></div>
<div class="line">  <span class="comment">//memory location of components</span></div>
<div class="line">  <span class="keyword">auto</span> t_nf(&amp;nF[0], &amp;nF[1], &amp;nF[2], 3);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bb = 0; bb != nb_dofs / 3; ++bb) {</div>
<div class="line">    <span class="comment">//scale the three components of t_normal and pass them to the t_nf (hence to nF)</span></div>
<div class="line">    t_nf(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += (<a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pressureVal * t_base) * t_normal(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    <span class="comment">//move the pointer to next element of t_nf</span></div>
<div class="line">    ++t_nf;</div>
<div class="line">    <span class="comment">//move to next base function</span></div>
<div class="line">    ++t_base;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// move to next integration weight</span></div>
<div class="line">  ++t_w;</div>
<div class="line">}</div>
</div><!-- fragment --><p>In the loop, initially the weight of the gauss point is assigned to w</p>
<div class="fragment"><div class="line"><span class="keywordtype">double</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = getGaussPts()(2, gg);</div>
</div><!-- fragment --><p>then <em>t_nF</em> that is a pointer to a vector is initialised in a fashion that points to a piece of memory containing three contiguous double values that are in this case the first three elements of the boundary condition vector <em>nF</em>.</p>
<p>Since the <em>t_nF</em> presents this structure of three contiguous elements pointed by each pointer value, we only need to loop over a third of the number of degrees of freedom. </p><div class="fragment"><div class="line"><span class="keywordflow">for</span> (<span class="keywordtype">int</span> bb = 0; bb != nb_dofs / 3; bb++)</div>
</div><!-- fragment --><p>and the within the loop for each <em>t_nF</em> value, the corresponding block of three members of nF can be evaluated as</p>
<div class="fragment"><div class="line">t_nf(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += (<a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> * pressureVal * t_base) * 0.5 * t_normal(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>); </div>
</div><!-- fragment --><p><a class="el" href="classIndex.html">Index</a> i in the last line operates the for each part of the three elements of <em>nF</em>. So in the first instance, where bb = 0, <em>nF</em>[0], <em>nF</em>[1] and <em>nF</em>[2] are evaluated.</p>
<p>Thereafter, pointers <em>t_nf</em> and <em>t_base</em> are increased, and now they are pointing to the next corresponding bit of memory. </p><div class="fragment"><div class="line">++t_nf;</div>
<div class="line">++t_base;</div>
</div><!-- fragment --><p>In the second instance, where <em>bb</em> = 1, <em>t_nf(i)</em> operates in the next three elements of <em>nF</em>, i.e. <em>nF</em>[3], <em>nF</em>[4], <em>nF</em>[5] are evaluated and so on.</p>
<p>Each member of <em>nF</em> contains the surface integral presented in (12) of `&lsquo;Hierarchical Approximation&rsquo;' associated to the the corresponding to gauss point gg and degree of freedom 3*bb. The product that is assigned to <em>t_nf(i)</em> involves multiplication of weight w of gauss point gg, the uniformly distributed traction is a scalar pressureVal times the shape function <em>t_base</em> of degrees of freedom encapsulated in bb, times half the vector normal to the surface. The halving of the vector is done to recover the face area that is the double of the vector magnitude as describe previously.</p>
<p>Finally, the values passed to vector <em>nF</em> are then copied to the right hand side vector \r ksp_f that points to vector f presented in Section <a class="el" href="simple_elasticity_1.html#simple_elastic_solve_problem">Solving the problem</a> used for the solution of the system of linear equations.</p>
<div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(getFEMethod()-&gt;ksp_f, nb_dofs, &amp;data.getIndices()[0], &amp;nF[0], ADD_VALUES);</div>
</div><!-- fragment --><h2><a class="anchor" id="simple_elasticity_apply_Dir_BC"></a>
ApplyDirichletBc</h2>
<p>The class implemented to apply homogeneous Dirichlet boundary conditions named <a class="el" href="structApplyDirichletBc.html">ApplyDirichletBc</a> is presented below </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structApplyDirichletBc.html">ApplyDirichletBc</a> : <span class="keyword">public</span> <a class="code" href="structMoFEM_1_1FEMethod.html">MoFEM::FEMethod</a> {</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="classRange.html">Range</a> <a class="code" href="structApplyDirichletBc.html#a14e4b37a798074ccebb83b302ef4ab9a">fixFaces</a>, <a class="code" href="structApplyDirichletBc.html#ae648f6695c0531a0bd51d9a6019a921b">fixNodes</a>, <a class="code" href="structApplyDirichletBc.html#abe4041e0e4e12ac18ff8cd502fb568f3">fixSecondNode</a>;</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="structApplyDirichletBc.html#a63919f2933d2c1daedc2704e82b9d058">ApplyDirichletBc</a>(<span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;fix_faces, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;fix_nodes,</div>
<div class="line">                    <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;fix_second_node)</div>
<div class="line">       : <a class="code" href="namespaceMoFEM.html">MoFEM</a>::<a class="code" href="classFEMethod.html">FEMethod</a>(), <a class="code" href="structApplyDirichletBc.html#a14e4b37a798074ccebb83b302ef4ab9a">fixFaces</a>(fix_faces), <a class="code" href="structApplyDirichletBc.html#ae648f6695c0531a0bd51d9a6019a921b">fixNodes</a>(fix_nodes),</div>
<div class="line">         <a class="code" href="structApplyDirichletBc.html#abe4041e0e4e12ac18ff8cd502fb568f3">fixSecondNode</a>(fix_second_node) {</div>
<div class="line">     <span class="comment">// constructor</span></div>
<div class="line">   }</div>
<div class="line"> </div>
<div class="line">   <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structApplyDirichletBc.html#adc0dab70c25b407f1d2c87a99672b341">postProcess</a>() {</div>
<div class="line">     <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">     std::set&lt;int&gt; set_fix_dofs;</div>
<div class="line"> </div>
<div class="line">     <span class="keywordflow">for</span> (<a class="code" href="group__problems__multi__indices.html#gaec069dde05ca3e495751e25d77547bf4">_IT_NUMEREDDOF_ROW_FOR_LOOP_</a>(<a class="code" href="structMoFEM_1_1BasicMethod.html#ac644bfef2d6f5d557ca7e3d60eb926c5">problemPtr</a>, dit)) {</div>
<div class="line">       <span class="keywordflow">if</span> (dit-&gt;get()-&gt;getDofCoeffIdx() == 2) {</div>
<div class="line">         <span class="keywordflow">if</span> (<a class="code" href="structApplyDirichletBc.html#a14e4b37a798074ccebb83b302ef4ab9a">fixFaces</a>.find(dit-&gt;get()-&gt;getEnt()) != <a class="code" href="structApplyDirichletBc.html#a14e4b37a798074ccebb83b302ef4ab9a">fixFaces</a>.end()) {</div>
<div class="line">           set_fix_dofs.insert(dit-&gt;get()-&gt;getPetscGlobalDofIdx());</div>
<div class="line">         }</div>
<div class="line">       }</div>
<div class="line"> </div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="structApplyDirichletBc.html#abe4041e0e4e12ac18ff8cd502fb568f3">fixSecondNode</a>.find(dit-&gt;get()-&gt;getEnt()) != <a class="code" href="structApplyDirichletBc.html#abe4041e0e4e12ac18ff8cd502fb568f3">fixSecondNode</a>.end()) {</div>
<div class="line">         <span class="keywordflow">if</span> (dit-&gt;get()-&gt;getDofCoeffIdx() == 1) {</div>
<div class="line">           set_fix_dofs.insert(dit-&gt;get()-&gt;getPetscGlobalDofIdx());</div>
<div class="line">         }</div>
<div class="line">       }</div>
<div class="line"> </div>
<div class="line">       <span class="keywordflow">if</span> (<a class="code" href="structApplyDirichletBc.html#ae648f6695c0531a0bd51d9a6019a921b">fixNodes</a>.find(dit-&gt;get()-&gt;getEnt()) != <a class="code" href="structApplyDirichletBc.html#ae648f6695c0531a0bd51d9a6019a921b">fixNodes</a>.end()) {</div>
<div class="line">         set_fix_dofs.insert(dit-&gt;get()-&gt;getPetscGlobalDofIdx());</div>
<div class="line">       }</div>
<div class="line">     }</div>
<div class="line"> </div>
<div class="line">     std::vector&lt;int&gt; fix_dofs(set_fix_dofs.size());</div>
<div class="line">     std::copy(set_fix_dofs.begin(), set_fix_dofs.end(), fix_dofs.begin());</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(<a class="code" href="structMoFEM_1_1KspMethod.html#a18d603d8a983e8aba704d4c38f809b4c">ksp_B</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(<a class="code" href="structMoFEM_1_1KspMethod.html#a18d603d8a983e8aba704d4c38f809b4c">ksp_B</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(<a class="code" href="structMoFEM_1_1KspMethod.html#ad7d80a709dec612d8491f9667cc30cef">ksp_f</a>);</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(<a class="code" href="structMoFEM_1_1KspMethod.html#ad7d80a709dec612d8491f9667cc30cef">ksp_f</a>);</div>
<div class="line"> </div>
<div class="line">     <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code" href="structMoFEM_1_1PetscData.html#ac2a6f6f72f81d4e62d1d58deb591827b">x</a>;</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(<a class="code" href="structMoFEM_1_1KspMethod.html#ad7d80a709dec612d8491f9667cc30cef">ksp_f</a>, &amp;<a class="code" href="structMoFEM_1_1PetscData.html#ac2a6f6f72f81d4e62d1d58deb591827b">x</a>);</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code" href="structMoFEM_1_1PetscData.html#ac2a6f6f72f81d4e62d1d58deb591827b">x</a>);</div>
<div class="line"> </div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRowsColumns(<a class="code" href="structMoFEM_1_1KspMethod.html#a18d603d8a983e8aba704d4c38f809b4c">ksp_B</a>, fix_dofs.size(), &amp;fix_dofs[0], 1, <a class="code" href="structMoFEM_1_1PetscData.html#ac2a6f6f72f81d4e62d1d58deb591827b">x</a>, <a class="code" href="structMoFEM_1_1KspMethod.html#ad7d80a709dec612d8491f9667cc30cef">ksp_f</a>);</div>
<div class="line">     <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code" href="structMoFEM_1_1PetscData.html#ac2a6f6f72f81d4e62d1d58deb591827b">x</a>);</div>
<div class="line"> </div>
<div class="line">     <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">   }</div>
<div class="line"> };</div>
</div><!-- fragment --><p>Entities that were previously handled in Section <a class="el" href="simple_elasticity_1.html#simple_elasticity_mesh_block">Mesh block handling</a> are assigned through the constructor in public variables <em>fixFaces</em>, <em>fixNodes</em>, <em>fixSecondNode</em> </p>
<div class="fragment"><div class="line"><a class="code" href="classRange.html">Range</a> fixFaces, fixNodes, fixSecondNode;</div>
<div class="line"> </div>
<div class="line"><a class="code" href="structApplyDirichletBc.html">ApplyDirichletBc</a>(<span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;fix_faces, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;fix_nodes,</div>
<div class="line">                 <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;fix_second_node)</div>
<div class="line">    : <a class="code" href="namespaceMoFEM.html">MoFEM</a>::<a class="code" href="classFEMethod.html">FEMethod</a>(), fixFaces(fix_faces), fixNodes(fix_nodes),</div>
<div class="line">      fixSecondNode(fix_second_node) {</div>
<div class="line">  <span class="comment">// constructor</span></div>
<div class="line">}</div>
</div><!-- fragment --><p>The homogeneous boundary conditions are then implemented in postProcess() function. Initially, a loop over degrees of freedom is performed through macro `&lsquo;for (\_IT\_NUMEREDDOF\_ROW\_FOR\_LOOP\_(problemPtr, dit))&rsquo;'. Within the loop, the degrees of freedom corresponding to the entities passed to the public variables of the struct are inserted to vector of integers <em>set_fix_dofs</em> through insert function</p>
<div class="fragment"><div class="line">std::set&lt;int&gt; set_fix_dofs;</div>
<div class="line"> </div>
<div class="line"><span class="keywordflow">for</span> (<a class="code" href="group__problems__multi__indices.html#gaec069dde05ca3e495751e25d77547bf4">_IT_NUMEREDDOF_ROW_FOR_LOOP_</a>(problemPtr, dit)) {</div>
<div class="line">  <span class="keywordflow">if</span> (dit-&gt;get()-&gt;getDofCoeffIdx() == 2) {</div>
<div class="line">    <span class="keywordflow">if</span> (fixFaces.find(dit-&gt;get()-&gt;getEnt()) != fixFaces.end()) {</div>
<div class="line">      set_fix_dofs.insert(dit-&gt;get()-&gt;getPetscGlobalDofIdx());</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (fixSecondNode.find(dit-&gt;get()-&gt;getEnt()) != fixSecondNode.end()) {</div>
<div class="line">    <span class="keywordflow">if</span> (dit-&gt;get()-&gt;getDofCoeffIdx() == 1) {</div>
<div class="line">      printf(<span class="stringliteral">&quot;The extra node \n&quot;</span>);</div>
<div class="line">      set_fix_dofs.insert(dit-&gt;get()-&gt;getPetscGlobalDofIdx());</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (fixNodes.find(dit-&gt;get()-&gt;getEnt()) != fixNodes.end()) {</div>
<div class="line">    set_fix_dofs.insert(dit-&gt;get()-&gt;getPetscGlobalDofIdx());</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><p>then this data is pass to a new vector of integers <em>fix_dofs</em> </p>
<div class="fragment"><div class="line">std::vector&lt;int&gt; fix_dofs(set_fix_dofs.size());</div>
<div class="line">std::copy(set_fix_dofs.begin(), set_fix_dofs.end(), fix_dofs.begin());</div>
</div><!-- fragment --><p>Thereafter, the stiffness matrix <em>ksp_B</em> and right hand side vector ksp_f structures are constructed <br  />
 </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(ksp_B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(ksp_B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(ksp_f);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(ksp_f);</div>
</div><!-- fragment --><p>and the left hand side vector <em>x</em> is constructed by copying <em>ksp_f</em> to <em>x</em> and subsequently zeroing it </p><div class="fragment"><div class="line"><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> x;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(ksp_f, &amp;x);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(x);</div>
</div><!-- fragment --><p>Invoking function <a href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/Mat/MatZeroRowsColumns.html">MatZeroRowsColumns</a> the columns and rows corresponding to the prescribed degrees of freedom stored in fix_dofs and the diagonal element is set to unity and the corresponding degrees of freedom in vector x are set to zero.</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroRowsColumns(ksp_B, fix_dofs.size(), &amp;fix_dofs[0], 1, x, ksp_f);</div>
</div><!-- fragment --><p>finally the memory allocated for vector <em>x</em> is freed</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;x);</div>
</div><!-- fragment --><h1><a class="anchor" id="simple_elasticity_prog_run"></a>
Running the program</h1>
<p>To run the code one should change directory to</p>
<div class="fragment"><div class="line">cd $HOME/mofem_installation/users_modules/basic_finite_elements/simple_elasticity</div>
</div><!-- fragment --><p>Then run the command</p>
<div class="fragment"><div class="line">./simple_elasticity -file_name simple_elasticity_part.h5m -my_order 2</div>
</div><!-- fragment --><p>To visualise results first convert the out put file from .h5m format to a vtk one </p><div class="fragment"><div class="line">mbconvert out.h5m out.vtk</div>
</div><!-- fragment --><p>then open the .vtk file in ParaView <a href="http://www.paraview.org">http://www.paraview.org</a>. For example on macOS </p><div class="fragment"><div class="line">open out.vtk</div>
</div><!-- fragment --><p><a class="el" href="simple_elasticity_1.html#Figure_10_displacement_result">Figure 10</a> shows the ParaView visualisation of the result of the considering problem.</p>
<p><a class="anchor" id="Figure_10_displacement_result"></a></p><div class="image">
<img src="simple_elasticity_result.png" alt="" width="600px"/>
<div class="caption">
Figure 10: Result visualisation in Paraview</div></div>
<dl class="section note"><dt>Note</dt><dd>In the following example solution is homogenous. Thus linear approximation is sufficient to get the exact the solution. Thus setting second order approximation does not improve solution. Note that all DOFs on edges for this case have zero values.</dd></dl>
<h1><a class="anchor" id="simple_elasticity_exercises"></a>
Exercises</h1>
<ul>
<li>Change boundary conditions to have fix cantilever and apply tractions to bend beam in <em>x</em> or <em>y</em> direction? Check how displacements would converge with increasing approximation order?</li>
<li>Modify code to apply torsion to the beam.</li>
<li>Write finite element to calculate strain energy of the beam. With that at hand plot convergence for beam subjected bending and torsion.</li>
</ul>
<p>If you have problems with understanding this tutorial or exercises, please contact us on Q&amp;A forum, see <a href="https://groups.google.com/forum/#!categories/mofem-group">link</a>.</p>
<h1><a class="anchor" id="mai_minimal_surface_equation"></a>
The plain program</h1>
<p>The plain program is located in <em>users_modules/basic_finite_elements/simple_elasticity/simple_elasticity.cpp</em> </p>
<div class="fragment"></div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astructApplyDirichletBc_html_abe4041e0e4e12ac18ff8cd502fb568f3"><div class="ttname"><a href="structApplyDirichletBc.html#abe4041e0e4e12ac18ff8cd502fb568f3">ApplyDirichletBc::fixSecondNode</a></div><div class="ttdeci">Range fixSecondNode</div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00303">simple_elasticity.cpp:303</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="aelastic_8cpp_html_aefa6a347aab3bc50a8c1b6b4aa0f1e60"><div class="ttname"><a href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpGradSymTensorGrad&lt; BASE_DIM, SPACE_DIM, SPACE_DIM, 0 &gt; OpK</div><div class="ttdoc">[Define entities]</div><div class="ttdef"><b>Definition:</b> <a href="elastic_8cpp_source.html#l00039">elastic.cpp:39</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="agroup__dm_html_ga96ba475206db6215c72937e77047415c"><div class="ttname"><a href="group__dm.html#ga96ba475206db6215c72937e77047415c">MoFEM::DMMoFEMKSPSetComputeRHS</a></div><div class="ttdeci">PetscErrorCode DMMoFEMKSPSetComputeRHS(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set KSP right hand side evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00637">DMMoFEM.cpp:637</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PetscData_html_ac2a6f6f72f81d4e62d1d58deb591827b"><div class="ttname"><a href="structMoFEM_1_1PetscData.html#ac2a6f6f72f81d4e62d1d58deb591827b">MoFEM::PetscData::x</a></div><div class="ttdeci">Vec x</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00051">LoopMethods.hpp:51</a></div></div>
<div class="ttc" id="astructMoFEM_1_1KspMethod_html_a18d603d8a983e8aba704d4c38f809b4c"><div class="ttname"><a href="structMoFEM_1_1KspMethod.html#a18d603d8a983e8aba704d4c38f809b4c">MoFEM::KspMethod::ksp_B</a></div><div class="ttdeci">Mat &amp; ksp_B</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00091">LoopMethods.hpp:91</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:8</a></div></div>
<div class="ttc" id="astructOpK_html"><div class="ttname"><a href="structOpK.html">OpK</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00016">simple_elasticity.cpp:16</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FEMethod_html"><div class="ttname"><a href="structMoFEM_1_1FEMethod.html">MoFEM::FEMethod</a></div><div class="ttdoc">structure for User Loop Methods on finite elements</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00369">LoopMethods.hpp:369</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga6bd6335f024a22cde370ee807d9185ce"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00049">MeshsetsManager.hpp:49</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aBasicFiniteElements_8hpp_html"><div class="ttname"><a href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="agroup__dm_html_gadf1d5425969ed88f332549c5b4ba5291"><div class="ttname"><a href="group__dm.html#gadf1d5425969ed88f332549c5b4ba5291">MoFEM::DMMoFEMKSPSetComputeOperators</a></div><div class="ttdeci">PetscErrorCode DMMoFEMKSPSetComputeOperators(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">Set KSP operators and push mofem finite element methods.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00678">DMMoFEM.cpp:678</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:16</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="astructApplyDirichletBc_html_a63919f2933d2c1daedc2704e82b9d058"><div class="ttname"><a href="structApplyDirichletBc.html#a63919f2933d2c1daedc2704e82b9d058">ApplyDirichletBc::ApplyDirichletBc</a></div><div class="ttdeci">ApplyDirichletBc(const Range &amp;fix_faces, const Range &amp;fix_nodes, const Range &amp;fix_second_node)</div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00305">simple_elasticity.cpp:305</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="aclassFEMethod_html"><div class="ttname"><a href="classFEMethod.html">FEMethod</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00549">ForcesAndSourcesCore.hpp:549</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition:</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition:</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="agroup__dm_html_gad94692d0472b346672a25c63e91fb930"><div class="ttname"><a href="group__dm.html#gad94692d0472b346672a25c63e91fb930">MoFEM::DMoFEMMeshToGlobalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToGlobalVector(DM dm, Vec g, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set ghosted vector values on all existing mesh entities</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00535">DMMoFEM.cpp:535</a></div></div>
<div class="ttc" id="astructApplyDirichletBc_html_adc0dab70c25b407f1d2c87a99672b341"><div class="ttname"><a href="structApplyDirichletBc.html#adc0dab70c25b407f1d2c87a99672b341">ApplyDirichletBc::postProcess</a></div><div class="ttdeci">MoFEMErrorCode postProcess()</div><div class="ttdoc">function is run at the end of loop</div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00312">simple_elasticity.cpp:312</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_ga3fcdbd5c74eba11ee82492e57d730756"><div class="ttname"><a href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">MoFEM::DMoFEMPostProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPostProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00556">DMMoFEM.cpp:556</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga3a32fd9345258c23de8d1230795f8ff3"><div class="ttname"><a href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">MoFEM::CoreInterface::add_ents_to_finite_element_by_dim</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_dim(const EntityHandle entities, const int dim, const std::string &amp;name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="aclassFaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a1342a5bb82a44eb578a7246723649d11"><div class="ttname"><a href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a></div><div class="ttdeci">EntitiesFieldData::EntData EntData</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00037">child_and_parent.cpp:37</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', 3 &gt;</a></div></div>
<div class="ttc" id="agroup__problems__multi__indices_html_gaec069dde05ca3e495751e25d77547bf4"><div class="ttname"><a href="group__problems__multi__indices.html#gaec069dde05ca3e495751e25d77547bf4">_IT_NUMEREDDOF_ROW_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_NUMEREDDOF_ROW_FOR_LOOP_(PROBLEMPTR, IT)</div><div class="ttdoc">use with loops to iterate row DOFs</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00164">ProblemsMultiIndices.hpp:164</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astructPostProcVolumeOnRefinedMesh_html"><div class="ttname"><a href="structPostProcVolumeOnRefinedMesh.html">PostProcVolumeOnRefinedMesh</a></div><div class="ttdoc">Post processing.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00955">PostProcOnRefMesh.hpp:955</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Ddg_html"><div class="ttname"><a href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt; double, 3, 3 &gt;</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BasicMethod_html_ac644bfef2d6f5d557ca7e3d60eb926c5"><div class="ttname"><a href="structMoFEM_1_1BasicMethod.html#ac644bfef2d6f5d557ca7e3d60eb926c5">MoFEM::BasicMethod::problemPtr</a></div><div class="ttdeci">const Problem * problemPtr</div><div class="ttdoc">raw pointer to problem</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00250">LoopMethods.hpp:250</a></div></div>
<div class="ttc" id="astructApplyDirichletBc_html"><div class="ttname"><a href="structApplyDirichletBc.html">ApplyDirichletBc</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00301">simple_elasticity.cpp:301</a></div></div>
<div class="ttc" id="astructMoFEM_1_1KspMethod_html_ad7d80a709dec612d8491f9667cc30cef"><div class="ttname"><a href="structMoFEM_1_1KspMethod.html#ad7d80a709dec612d8491f9667cc30cef">MoFEM::KspMethod::ksp_f</a></div><div class="ttdeci">Vec &amp; ksp_f</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00089">LoopMethods.hpp:89</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="astructOpPressure_html"><div class="ttname"><a href="structOpPressure.html">OpPressure</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00229">simple_elasticity.cpp:229</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="astructApplyDirichletBc_html_a14e4b37a798074ccebb83b302ef4ab9a"><div class="ttname"><a href="structApplyDirichletBc.html#a14e4b37a798074ccebb83b302ef4ab9a">ApplyDirichletBc::fixFaces</a></div><div class="ttdeci">Range fixFaces</div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00303">simple_elasticity.cpp:303</a></div></div>
<div class="ttc" id="astructApplyDirichletBc_html_ae648f6695c0531a0bd51d9a6019a921b"><div class="ttname"><a href="structApplyDirichletBc.html#ae648f6695c0531a0bd51d9a6019a921b">ApplyDirichletBc::fixNodes</a></div><div class="ttdeci">Range fixNodes</div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00303">simple_elasticity.cpp:303</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="aclassOpCalculateVectorFieldGradient_html"><div class="ttname"><a href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01123">DMMoFEM.cpp:1123</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00698">PostProcBrokenMeshInMoabBase.hpp:698</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>