<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: PoissonOperators.hpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">PoissonOperators.hpp</div>  </div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file PoissonOperators.hpp</span></div>
<div class="line"><span class="comment"> * \example PoissonOperators.hpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __POISSONOPERATORS_HPP__</span></div>
<div class="line"><span class="preprocessor">#define __POISSONOPERATORS_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespacePoissonExample.html">PoissonExample</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a name="a0"></a><a class="code" href="namespacePoissonExample.html#a097610ce0a8fd450f66ead79cc7e81a7">PostProcFE</a> = <a name="_a1"></a><a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoab_3_01VolumeElementForcesAndSourcesCore_01_4.html">PostProcBrokenMeshInMoab&lt;VolumeElementForcesAndSourcesCore&gt;</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Calculate the grad-grad operator and assemble matrix</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Calculate</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{K}=\int_\Omega \nabla \boldsymbol\phi \cdot \nabla \boldsymbol\phi</span></div>
<div class="line"><span class="comment"> * \textrm{d}\Omega \f] and assemble to global matrix.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This operator is executed on element for each unique combination of entities.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a name="_a2"></a><a class="code" href="structOpK.html">OpK</a> : <span class="keyword">public</span> <a name="_a3"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolumeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">  <a name="a4"></a><a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>(<span class="keywordtype">bool</span> symm = <span class="keyword">true</span>)</div>
<div class="line">      : <a name="a5"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html#a9c0a9a269e2e1026ee94cedc069fd0cf">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, OPROWCOL,</div>
<div class="line">                                                            symm) {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Do calculations for give operator</span></div>
<div class="line"><span class="comment">   * @param  row_side row side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">   * @param  col_side column side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">   * @param  row_type type of row entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">   * @param  col_type type of column entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">   * @param  row_data data for row</span></div>
<div class="line"><span class="comment">   * @param  col_data data for column</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a name="a6"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                        EntityType col_type,</div>
<div class="line">                        <a name="_a7"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a name="a8"></a><a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    nbRows = row_data.<a name="a9"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">    <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">      <a name="a10"></a><a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of dofs on column</span></div>
<div class="line">    nbCols = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// if no dofs on Columbia, exit nothing to do here</span></div>
<div class="line">    <span class="keywordflow">if</span> (!nbCols)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    nbIntegrationPts = getGaussPts().size2();</div>
<div class="line">    <span class="comment">// check if entity block is on matrix diagonal</span></div>
<div class="line">    <span class="keywordflow">if</span> (row_side == col_side &amp;&amp; row_type == col_type) {</div>
<div class="line">      isDiag = <span class="keyword">true</span>; <span class="comment">// yes, it is</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      isDiag = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">    <a name="a11"></a><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data, col_data);</div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data, col_data);</div>
<div class="line">    <a name="a12"></a><a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  ///&lt; error code</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keywordtype">int</span> nbRows;           <span class="comment">///&lt; number of dofs on rows</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> nbCols;           <span class="comment">///&lt; number if dof on column</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> nbIntegrationPts; <span class="comment">///&lt; number of integration points</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">bool</span> isDiag;          <span class="comment">///&lt; true if this block is on diagonal</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a name="_a13"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a name="a14"></a><a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>; <span class="comment">///&lt; summit Index</span></div>
<div class="line"><span class="comment"></span>  <a name="a15"></a><a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> locMat;      <span class="comment">///&lt; local entity block matrix</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate grad-grad operator</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                   <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local entity bock</span></div>
<div class="line">    locMat.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear matrix</span></div>
<div class="line">    locMat.clear();</div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function gradient on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_row_grad = row_data.<a name="a16"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">    <span class="comment">// loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// take into account Jacobean</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = t_w * vol;</div>
<div class="line">      <span class="comment">// noalias(locMat) +=</span></div>
<div class="line">      <span class="comment">// alpha*prod(row_data.getDiffN(gg),trans(col_data.getDiffN(gg))); take</span></div>
<div class="line">      <span class="comment">// fist element to local matrix</span></div>
<div class="line">      <a name="_a17"></a><a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;double *&gt;</a> <a name="a18"></a><a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>(&amp;*locMat.data().begin());</div>
<div class="line">      <span class="comment">// loop over rows base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        <span class="comment">// get column base functions gradient at gauss point gg</span></div>
<div class="line">        <span class="keyword">auto</span> t_col_grad = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line">        <span class="comment">// loop over columns</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols; cc++) {</div>
<div class="line">          <span class="comment">// calculate element of local matrix</span></div>
<div class="line">          <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += alpha * (t_row_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_col_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">          ++t_col_grad; <span class="comment">// move to another gradient of base function on column</span></div>
<div class="line">          ++<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;          <span class="comment">// move to another element of local matrix in column</span></div>
<div class="line">        }</div>
<div class="line">        ++t_row_grad; <span class="comment">// move to another element of gradient of base function on</span></div>
<div class="line">                      <span class="comment">// row</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w; <span class="comment">// move to another integration weight</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Assemble local entity block matrix</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                  <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">    <span class="comment">// get pointer to first global index on column</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">    Mat B = getFEMethod()-&gt;ksp_B != PETSC_NULL ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                               : getFEMethod()-&gt;snes_B;</div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a19"></a><a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbRows, row_indices, nbCols, col_indices,</div>
<div class="line">                        &amp;*locMat.data().begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!isDiag &amp;&amp; sYmm) {</div>
<div class="line">      <span class="comment">// if not diagonal term and since global matrix is symmetric assemble</span></div>
<div class="line">      <span class="comment">// transpose term.</span></div>
<div class="line">      locMat = trans(locMat);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbCols, col_indices, nbRows, row_indices,</div>
<div class="line">                          &amp;*locMat.data().begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief template class for integration oh the right hand side</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> OPBASE&gt; <span class="keyword">struct </span>OpBaseRhs : <span class="keyword">public</span> <a name="_a20"></a><a class="code" href="classOPBASE.html">OPBASE</a> {</div>
<div class="line"> </div>
<div class="line">  OpBaseRhs(<span class="keyword">const</span> std::string <a name="a21"></a><a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) : <a class="code" href="classOPBASE.html">OPBASE</a>(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, OPBASE::OPROW) {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief This function is called by finite element</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * Do work is composed from two operations, integrate and assembly. Also,</span></div>
<div class="line"><span class="comment">   * it set values nbRows, and nbIntegrationPts.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    nbRows = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    nbIntegrationPts = OPBASE::getGaussPts().size2();</div>
<div class="line">    <span class="comment">// integrate local vector</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data);</div>
<div class="line">    <span class="comment">// assemble local vector</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Class dedicated to integrate operator</span></div>
<div class="line"><span class="comment">   * @param  data entity data on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) = 0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Class dedicated to assemble operator to global system vector</span></div>
<div class="line"><span class="comment">   * @param  data entity data (indices, base functions, etc. ) on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  ///&lt; error code</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> nbRows;           <span class="comment">///&lt; number of dofs on row</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> nbIntegrationPts; <span class="comment">///&lt; number of integration points</span></div>
<div class="line"><span class="comment"></span>};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Operator calculate source term,</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{F} = \int_\Omega \boldsymbol\phi f \textrm{d}\Omega</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>OpF</div>
<div class="line">    : <span class="keyword">public</span> OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a name="_a22"></a><a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      FSource;</div>
<div class="line"> </div>
<div class="line">  OpF(FSource f_source)</div>
<div class="line">      : OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;(<span class="stringliteral">&quot;U&quot;</span>),</div>
<div class="line">        fSource(f_source) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a name="_a23"></a><a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> NX;</div>
<div class="line">  <a name="_a24"></a><a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> NY;</div>
<div class="line">  <a name="_a25"></a><a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> NZ;</div>
<div class="line">  FSource fSource;</div>
<div class="line"> </div>
<div class="line">  <a name="a26"></a><a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> locVec;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local entity vector</span></div>
<div class="line"><span class="comment">   * @param  data entity data on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local vector</span></div>
<div class="line">    locVec.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local entity vector</span></div>
<div class="line">    locVec.clear();</div>
<div class="line">    <span class="comment">// get finite element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base functions on entity</span></div>
<div class="line">    <span class="keyword">auto</span> t_v = data.<a name="a27"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get coordinates at integration points</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// loop over all integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// evaluate constant term</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha =</div>
<div class="line">          vol * t_w * fSource(t_coords(NX), t_coords(NY), t_coords(NZ));</div>
<div class="line">      <span class="comment">// get element of local vector</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*locVec.data().begin());</div>
<div class="line">      <span class="comment">// loop over base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        <span class="comment">// add to local vector source term</span></div>
<div class="line">        t_a -= alpha * t_v;</div>
<div class="line">        ++t_a; <span class="comment">// move to next element of local vector</span></div>
<div class="line">        ++t_v; <span class="comment">// move to next base function</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w;      <span class="comment">// move to next integration weight</span></div>
<div class="line">      ++t_coords; <span class="comment">// move to next physical coordinates at integration point</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief assemble local entity vector to the global right hand side</span></div>
<div class="line"><span class="comment">   * @param  data entity data, i.e. global indices of local vector</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get global indices of local vector</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *indices = &amp;*data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">    <span class="comment">// get values from local vector</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> *vals = &amp;*locVec.data().begin();</div>
<div class="line">    <a name="a28"></a><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a name="a29"></a><a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> = getFEMethod()-&gt;ksp_f != PETSC_NULL ? getFEMethod()-&gt;ksp_f</div>
<div class="line">                                               : getFEMethod()-&gt;snes_f;</div>
<div class="line">    <span class="comment">// assemble vector</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a30"></a><a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, nbRows, indices, vals, ADD_VALUES);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Calculate constrains matrix</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{C} = \int_{\partial\Omega} \boldsymbol\psi \boldsymbol\phi</span></div>
<div class="line"><span class="comment"> * \textrm{d}\partial\Omega \f] where \f$\lambda \f$ is base function on</span></div>
<div class="line"><span class="comment"> * boundary</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>OpC : <span class="keyword">public</span> <a name="_a31"></a><a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">  OpC(<span class="keyword">const</span> <span class="keywordtype">bool</span> assemble_transpose)</div>
<div class="line">      : <a name="a32"></a><a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html#a9c0a9a269e2e1026ee94cedc069fd0cf">FaceElementForcesAndSourcesCore::UserDataOperator</a>(<span class="stringliteral">&quot;L&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, OPROWCOL,</div>
<div class="line">                                                          <span class="keyword">false</span>),</div>
<div class="line">        assembleTranspose(assemble_transpose) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                        EntityType col_type,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    nbRows = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// exit here if no dofs on row, nothing to do</span></div>
<div class="line">    <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of dofs on column,</span></div>
<div class="line">    nbCols = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// exit here if no dofs on roe, nothing to do</span></div>
<div class="line">    <span class="keywordflow">if</span> (!nbCols)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    nbIntegrationPts = getGaussPts().size2();</div>
<div class="line">    <span class="comment">// integrate local constrains matrix</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data, col_data);</div>
<div class="line">    <span class="comment">// assemble local constrains matrix</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data, col_data);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  ///&lt; error code</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keywordtype">int</span> nbRows;                   <span class="comment">///&lt; number of dofs on row</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> nbCols;                   <span class="comment">///&lt; number of dofs on column</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> nbIntegrationPts;         <span class="comment">///&lt; number of integration points</span></div>
<div class="line"><span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> assembleTranspose; <span class="comment">///&lt; assemble transpose, i.e. CT if set to true</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> locMat; <span class="comment">///&lt; local constrains matrix</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** \brief Integrate local constrains matrix</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                  <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local constrains matrix</span></div>
<div class="line">    locMat.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear matrix</span></div>
<div class="line">    locMat.clear();</div>
<div class="line">    <span class="comment">// get area of element</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base functions on entity</span></div>
<div class="line">    <span class="keyword">auto</span> t_row = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// run over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = area * t_w;</div>
<div class="line">      <span class="comment">// get element of local matrix</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; <a name="a33"></a><a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>(</div>
<div class="line">          &amp;*locMat.data().begin());</div>
<div class="line">      <span class="comment">// run over base functions on rows</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        <span class="comment">// get first base functions on column for integration point gg</span></div>
<div class="line">        <span class="keyword">auto</span> t_col = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">        <span class="comment">// run over base function on column</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols; cc++) {</div>
<div class="line">          <span class="comment">// integrate element of constrains matrix</span></div>
<div class="line">          <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> += alpha * t_row * t_col;</div>
<div class="line">          ++t_col; <span class="comment">// move to next base function on column</span></div>
<div class="line">          ++<a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>;     <span class="comment">// move to next element of local matrix</span></div>
<div class="line">        }</div>
<div class="line">        ++t_row; <span class="comment">// move to next base function on row</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w; <span class="comment">// move to next integrate weight</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief integrate local constrains matrix</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                 <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get indices on row</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">    <span class="comment">// get indices on column</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">    Mat B = getFEMethod()-&gt;ksp_B != PETSC_NULL ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                               : getFEMethod()-&gt;snes_B;</div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbRows, row_indices, nbCols, col_indices,</div>
<div class="line">                        &amp;*locMat.data().begin(), ADD_VALUES);</div>
<div class="line">    <span class="comment">// cerr &lt;&lt; locMat &lt;&lt; endl;</span></div>
<div class="line">    <span class="keywordflow">if</span> (assembleTranspose) {</div>
<div class="line">      <span class="comment">// assemble transpose of local matrix</span></div>
<div class="line">      locMat = trans(locMat);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbCols, col_indices, nbRows, row_indices,</div>
<div class="line">                          &amp;*locMat.data().begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Assemble constrains vector</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{g} = \int_{\partial\Omega} \boldsymbol\psi \overline{u}</span></div>
<div class="line"><span class="comment"> * \textrm{d}\partial\Omega \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>Op_g</div>
<div class="line">    : <span class="keyword">public</span> OpBaseRhs&lt;FaceElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      FVal;</div>
<div class="line"> </div>
<div class="line">  Op_g(FVal f_value, <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> = <span class="stringliteral">&quot;L&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">double</span> beta = 1)</div>
<div class="line">      : OpBaseRhs&lt;FaceElementForcesAndSourcesCore::UserDataOperator&gt;(</div>
<div class="line">            <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>),</div>
<div class="line">        fValue(f_value), bEta(beta) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> NX; <span class="comment">///&lt; x-direction index</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> NY; <span class="comment">///&lt; y-direction index</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> NZ; <span class="comment">///&lt; z-direction index</span></div>
<div class="line"><span class="comment"></span>  FVal fValue; <span class="comment">///&lt; Function pointer evaluating values of &quot;U&quot; at the boundary</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> locVec;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> bEta;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local constrains vector</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size to local vector</span></div>
<div class="line">    locVec.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local vector</span></div>
<div class="line">    locVec.clear();</div>
<div class="line">    <span class="comment">// get face area</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea() * bEta;</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function</span></div>
<div class="line">    <span class="keyword">auto</span> t_l = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get coordinates at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// make loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// evaluate function on boundary and scale it by area and integration</span></div>
<div class="line">      <span class="comment">// weight</span></div>
<div class="line">      <span class="keywordtype">double</span> alpha =</div>
<div class="line">          area * t_w * fValue(t_coords(NX), t_coords(NY), t_coords(NZ));</div>
<div class="line">      <span class="comment">// get element of vector</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*locVec.data().begin());</div>
<div class="line">      <span class="comment">//</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        t_a += alpha * t_l;</div>
<div class="line">        ++t_a;</div>
<div class="line">        ++t_l;</div>
<div class="line">      }</div>
<div class="line">      ++t_w;</div>
<div class="line">      ++t_coords;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief assemble constrains vectors</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *indices = &amp;*data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> *vals = &amp;*locVec.data().begin();</div>
<div class="line">    <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> = getFEMethod()-&gt;ksp_f != PETSC_NULL ? getFEMethod()-&gt;ksp_f</div>
<div class="line">                                               : getFEMethod()-&gt;snes_f;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, nbRows, indices, &amp;*vals, ADD_VALUES);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Evaluate error</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a name="_a34"></a><a class="code" href="structOpError.html">OpError</a></div>
<div class="line">    : <span class="keyword">public</span> OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      UVal;</div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;FTensor::Tensor1&lt;double, 3&gt;(</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      GVal;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structOpError.html">OpError</a>(UVal u_value, GVal g_value,</div>
<div class="line">          boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals,</div>
<div class="line">          boost::shared_ptr&lt;MatrixDouble&gt; &amp;grad_vals, <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> global_error)</div>
<div class="line">      : OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;(<span class="stringliteral">&quot;ERROR&quot;</span>),</div>
<div class="line">        globalError(global_error), uValue(u_value), gValue(g_value),</div>
<div class="line">        fieldVals(field_vals), gradVals(grad_vals) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, EntityType row_type,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    nbRows = row_data.<a name="a35"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a8e10860da32e3936c8509b022f78b0f6">getFieldData</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    nbIntegrationPts = getGaussPts().size2();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> globalError; <span class="comment">///&lt; ghost vector with global (integrated over volume) error</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> NX;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> NY;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> NZ;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  UVal uValue; <span class="comment">///&lt; function with exact solution</span></div>
<div class="line"><span class="comment"></span>  GVal gValue; <span class="comment">///&lt; function with exact solution for gradient</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; fieldVals;</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt; gradVals;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate error</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// clear field dofs</span></div>
<div class="line">    data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a8e10860da32e3936c8509b022f78b0f6">getFieldData</a>().clear();</div>
<div class="line">    <span class="comment">// get volume of element</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = <a name="a36"></a><a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*fieldVals);</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*gradVals);</div>
<div class="line">    <span class="comment">// get coordinates at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// keep exact gradient and error or gradient</span></div>
<div class="line">    <a name="_a37"></a><a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_exact_grad, t_error_grad;</div>
<div class="line">    <span class="comment">// integrate over</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="keywordtype">double</span> alpha = vol * t_w;</div>
<div class="line">      <span class="comment">// evaluate exact value</span></div>
<div class="line">      <span class="keywordtype">double</span> exact_u = uValue(t_coords(NX), t_coords(NY), t_coords(NZ));</div>
<div class="line">      <span class="comment">// evaluate exact gradient</span></div>
<div class="line">      t_exact_grad = gValue(t_coords(NX), t_coords(NY), t_coords(NZ));</div>
<div class="line">      <span class="comment">// calculate gradient errro</span></div>
<div class="line">      t_error_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_exact_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <span class="comment">// error</span></div>
<div class="line">      <span class="keywordtype">double</span> error = pow(t_u - exact_u, 2) + t_error_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_error_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <span class="comment">// iterate over base functions</span></div>
<div class="line">      data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a8e10860da32e3936c8509b022f78b0f6">getFieldData</a>()[0] += alpha * error;</div>
<div class="line">      ++t_w;      <span class="comment">// move to next integration point</span></div>
<div class="line">      ++t_u;      <span class="comment">// next value of function at integration point</span></div>
<div class="line">      ++t_grad;   <span class="comment">// next gradient at integration point</span></div>
<div class="line">      ++t_coords; <span class="comment">// next coordinate at integration point</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Assemble error</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set error on mesh</span></div>
<div class="line">    data.<a name="a38"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a14f5bf9a76b74ed8a2ca283b369e54ad">getFieldDofs</a>()[0]-&gt;getFieldData() = sqrt(data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a8e10860da32e3936c8509b022f78b0f6">getFieldData</a>()[0]);</div>
<div class="line">    <span class="comment">// assemble vector to global error</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(globalError, 0, data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a8e10860da32e3936c8509b022f78b0f6">getFieldData</a>()[0], ADD_VALUES);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpKt : <span class="keyword">public</span> <a class="code" href="structOpK.html">OpK</a> {</div>
<div class="line"> </div>
<div class="line">  OpKt(boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line">       boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; diff_a,</div>
<div class="line">       boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals,</div>
<div class="line">       boost::shared_ptr&lt;MatrixDouble&gt; &amp;grad_vals)</div>
<div class="line">      : <a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>(<span class="keyword">false</span>), <a name="a39"></a><a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>), diffA(diff_a), fieldVals(field_vals),</div>
<div class="line">        gradVals(grad_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate grad-grad operator</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                  <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local entity bock</span></div>
<div class="line">    locMat.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear matrix</span></div>
<div class="line">    locMat.clear();</div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*fieldVals);</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*gradVals);</div>
<div class="line">    <span class="comment">// get base function gradient on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_row_grad = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">    <span class="comment">// loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// take into account Jacobian</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = t_w * vol;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = alpha * <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(t_u);</div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_gamma;</div>
<div class="line">      t_gamma(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = (alpha * diffA(t_u)) * t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <span class="comment">// take fist element to local matrix</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>(</div>
<div class="line">          &amp;*locMat.data().begin());</div>
<div class="line">      <span class="comment">// loop over rows base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        <span class="comment">// get column base function</span></div>
<div class="line">        <span class="keyword">auto</span> t_col = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">        <span class="comment">// get column base functions gradient at gauss point gg</span></div>
<div class="line">        <span class="keyword">auto</span> t_col_grad = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line">        <span class="comment">// loop over columns</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols; cc++) {</div>
<div class="line">          <span class="comment">// calculate element of local matrix</span></div>
<div class="line">          <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += (t_row_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * beta) * t_col_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) +</div>
<div class="line">               t_row_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * (t_gamma(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_col);</div>
<div class="line">          ++t_col;      <span class="comment">// move to next base function</span></div>
<div class="line">          ++t_col_grad; <span class="comment">// move to another gradient of base function on column</span></div>
<div class="line">          ++<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;          <span class="comment">// move to another element of local matrix in column</span></div>
<div class="line">        }</div>
<div class="line">        ++t_row_grad; <span class="comment">// move to another element of gradient of base function on</span></div>
<div class="line">                      <span class="comment">// row</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w;    <span class="comment">// move to another integration weight</span></div>
<div class="line">      ++t_u;    <span class="comment">// move to next value at integration point</span></div>
<div class="line">      ++t_grad; <span class="comment">// move to next gradient value</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line">  boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; diffA;</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; fieldVals;</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt; gradVals;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpResF_Domain : <span class="keyword">public</span> OpF {</div>
<div class="line"> </div>
<div class="line">  OpResF_Domain(FSource f_source, boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line">                boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals,</div>
<div class="line">                boost::shared_ptr&lt;MatrixDouble&gt; &amp;grad_vals)</div>
<div class="line">      : OpF(f_source), <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>), fieldVals(field_vals), gradVals(grad_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local entity vector</span></div>
<div class="line"><span class="comment">   * @param  data entity data on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local vector</span></div>
<div class="line">    locVec.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local entity vector</span></div>
<div class="line">    locVec.clear();</div>
<div class="line">    <span class="comment">// get finite element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*fieldVals);</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*gradVals);</div>
<div class="line">    <span class="comment">// get base functions on entity</span></div>
<div class="line">    <span class="keyword">auto</span> t_v = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get base function gradient on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_v_grad = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">    <span class="comment">// get coordinates at integration points</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// loop over all integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// evaluate constant term</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = vol * t_w;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> source_term =</div>
<div class="line">          alpha * fSource(t_coords(NX), t_coords(NY), t_coords(NZ));</div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> grad_term;</div>
<div class="line">      grad_term(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = (alpha * <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(t_u)) * t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <span class="comment">// get element of local vector</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*locVec.data().begin());</div>
<div class="line">      <span class="comment">// loop over base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        <span class="comment">// add to local vector source term</span></div>
<div class="line">        t_a += t_v_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * grad_term(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_v * source_term;</div>
<div class="line">        ++t_a;      <span class="comment">// move to next element of local vector</span></div>
<div class="line">        ++t_v;      <span class="comment">// move to next base function</span></div>
<div class="line">        ++t_v_grad; <span class="comment">// move to next gradient of base function</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w;      <span class="comment">// move to next integration weights</span></div>
<div class="line">      ++t_u;      <span class="comment">// move to next value</span></div>
<div class="line">      ++t_grad;   <span class="comment">// move to next gradient value</span></div>
<div class="line">      ++t_coords; <span class="comment">// move to next physical coordinates at integration point</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  boost::function&lt;<a class="code" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; fieldVals;</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt; gradVals;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpRes_g : <span class="keyword">public</span> Op_g {</div>
<div class="line"> </div>
<div class="line">  OpRes_g(FVal f_value, boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals)</div>
<div class="line">      : Op_g(f_value, <span class="stringliteral">&quot;L&quot;</span>, 1), fieldVals(field_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; fieldVals;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local constrains vector</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size to local vector</span></div>
<div class="line">    locVec.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local vector</span></div>
<div class="line">    locVec.clear();</div>
<div class="line">    <span class="comment">// get face area</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea() * bEta;</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function</span></div>
<div class="line">    <span class="keyword">auto</span> t_l = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*fieldVals);</div>
<div class="line">    <span class="comment">// get coordinates at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// make loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// evaluate function on boundary and scale it by area and integration</span></div>
<div class="line">      <span class="comment">// weight</span></div>
<div class="line">      <span class="keywordtype">double</span> alpha = area * t_w;</div>
<div class="line">      <span class="comment">// get element of vector</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*locVec.data().begin());</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        t_a += alpha * t_l *</div>
<div class="line">               (t_u - fValue(t_coords(NX), t_coords(NY), t_coords(NZ)));</div>
<div class="line">        ++t_a;</div>
<div class="line">        ++t_l;</div>
<div class="line">      }</div>
<div class="line">      ++t_w;</div>
<div class="line">      ++t_u;</div>
<div class="line">      ++t_coords;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpResF_Boundary : <span class="keyword">public</span> Op_g {</div>
<div class="line"> </div>
<div class="line">  OpResF_Boundary(boost::shared_ptr&lt;VectorDouble&gt; &amp;lambda_vals)</div>
<div class="line">      : Op_g(FVal(), <span class="stringliteral">&quot;U&quot;</span>, 1), lambdaVals(lambda_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; lambdaVals;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local constrains vector</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size to local vector</span></div>
<div class="line">    locVec.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local vector</span></div>
<div class="line">    locVec.clear();</div>
<div class="line">    <span class="comment">// get face area</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea() * bEta;</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_lambda = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*lambdaVals);</div>
<div class="line">    <span class="comment">// make loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; gg++) {</div>
<div class="line">      <span class="comment">// evaluate function on boundary and scale it by area and integration</span></div>
<div class="line">      <span class="comment">// weight</span></div>
<div class="line">      <span class="keywordtype">double</span> alpha = area * t_w;</div>
<div class="line">      <span class="comment">// get element of vector</span></div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*locVec.data().begin());</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nbRows; rr++) {</div>
<div class="line">        t_a += alpha * t_u * t_lambda;</div>
<div class="line">        ++t_a;</div>
<div class="line">        ++t_u;</div>
<div class="line">      }</div>
<div class="line">      ++t_w;</div>
<div class="line">      ++t_lambda;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Set integration rule to volume elements</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This rule is used to integrate \f$\nabla v \cdot \nabla u\f$, thus</span></div>
<div class="line"><span class="comment"> * if approximation field and testing field are polynomial order &quot;p&quot;,</span></div>
<div class="line"><span class="comment"> * then rule for exact integration is 2*(p-1).</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Integration rule is order of polynomial which is calculated exactly. Finite</span></div>
<div class="line"><span class="comment"> * element selects integration method based on return of this function.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a name="_a40"></a><a class="code" href="structVolRule.html">VolRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> operator()(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span> p)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2 * (p - 1); }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Set integration rule to boundary elements</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This is uses to integrate values on the face. Is used to integrate</span></div>
<div class="line"><span class="comment"> * \f$(\mathbf{n} \cdot \lambda) u\f$, where Lagrange multiplayer</span></div>
<div class="line"><span class="comment"> * is order &quot;p_row&quot; and approximate function is order &quot;p_col&quot;.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Integration rule is order of polynomial which is calculated exactly. Finite</span></div>
<div class="line"><span class="comment"> * element selects integration method based on return of this function.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a name="_a41"></a><a class="code" href="structFaceRule.html">FaceRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> operator()(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * p_data + 1;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Create finite elements instances</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Create finite element instances and add operators to finite elements.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>CreateFiniteElements {</div>
<div class="line"> </div>
<div class="line">  CreateFiniteElements(<a name="_a42"></a><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : mField(m_field) {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to calculate matrix and vectors</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> createFEToAssembleMatrixAndVector(</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; f_u,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">          f_source,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_rhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_rhs_fe,</div>
<div class="line">      <span class="keywordtype">bool</span> trans = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create elements element instances</span></div>
<div class="line">    domain_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a43"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    boundary_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a44"></a><a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    domain_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    boundary_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rule to elements instances</span></div>
<div class="line">    domain_lhs_fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">    domain_rhs_fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">    boundary_lhs_fe-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line">    boundary_rhs_fe-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operators to element instances</span></div>
<div class="line">    <span class="comment">// Add operator grad-grad for calculate matrix</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>());</div>
<div class="line">    <span class="comment">// Add operator to calculate source terms</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpF(f_source));</div>
<div class="line">    <span class="comment">// Add operator calculating constrains matrix</span></div>
<div class="line">    boundary_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC(trans));</div>
<div class="line">    <span class="comment">// Add operator calculating constrains vector</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> Op_g(f_u));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to calculate error</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> createFEToEvaluateError(</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; f_u,</div>
<div class="line">      boost::function&lt;<a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>,</div>
<div class="line">                                                  <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">          g_u,</div>
<div class="line">      <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> global_error,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_error)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// Create finite element instance to calculate error</span></div>
<div class="line">    domain_error = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    domain_error-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">    <span class="comment">// Set integration rule</span></div>
<div class="line">    <span class="comment">// Crate shared vector storing values of field &quot;u&quot; on integration points on</span></div>
<div class="line">    <span class="comment">// element. element is local and is used to exchange data between operators.</span></div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; values_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="comment">// Storing gradients of field</span></div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; grad_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a45"></a><a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate field gradient at integration points</span></div>
<div class="line">    domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a46"></a><a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator to integrate error element by element.</span></div>
<div class="line">    domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structOpError.html">OpError</a>(f_u, g_u, values_at_integration_ptr,</div>
<div class="line">                    grad_at_integration_ptr, global_error));</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to post-process results</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> creatFEToPostProcessResults(</div>
<div class="line">      boost::shared_ptr&lt;PostProcFE&gt; &amp;post_proc_volume)<span class="keyword"> const </span>{</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Note that user can stack together arbitrary number of operators to</span></div>
<div class="line">    <span class="comment">// compose complex PDEs.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Post-process results. This is standard element, with functionality</span></div>
<div class="line">    <span class="comment">// enabling refining mesh for post-processing. In addition in</span></div>
<div class="line">    <span class="comment">// PostProcOnRefMesh.hpp are implanted set of  users operators to</span></div>
<div class="line">    <span class="comment">// post-processing fields. Here using simplified mechanism for</span></div>
<div class="line">    <span class="comment">// post-processing finite element, we add operators to save data from field</span></div>
<div class="line">    <span class="comment">// on mesh tags for ParaView visualization.</span></div>
<div class="line">    post_proc_volume =</div>
<div class="line">        boost::shared_ptr&lt;PostProcFE&gt;(<span class="keyword">new</span> <a class="code" href="namespacePoissonExample.html#a097610ce0a8fd450f66ead79cc7e81a7">PostProcFE</a>(mField));</div>
<div class="line">    <span class="comment">// Add operators to the elements, starting with some generic</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> det_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> inv_jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a47"></a><a class="code" href="structMoFEM_1_1OpCalculateHOJac_3_013_01_4.html">OpCalculateHOJac&lt;3&gt;</a>(jac_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a48"></a><a class="code" href="structMoFEM_1_1OpInvertMatrix.html">OpInvertMatrix&lt;3&gt;</a>(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a name="_a49"></a><a class="code" href="structMoFEM_1_1OpSetHOInvJacToScalarBases.html">OpSetHOInvJacToScalarBases&lt;3&gt;</a>(<a name="a50"></a><a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, inv_jac_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> e_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;ERROR&quot;</span>, e_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using</span> <a name="_a51"></a><a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPPMap</a> = <a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;3, 3&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a name="a52"></a><a class="code" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">            post_proc_volume-&gt;getPostProcMesh(),</div>
<div class="line">            post_proc_volume-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}, {<span class="stringliteral">&quot;ERROR&quot;</span>, e_ptr}},</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;GRAD&quot;</span>, grad_ptr}},</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {}</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to calculate matrix and vectors</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> createFEToAssembleMatrixAndVectorForNonlinearProblem(</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; f_u,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">          f_source,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; diff_a,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_rhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_rhs_fe,</div>
<div class="line">      <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html#ab74a230ea17b23143370a833d5b476b2">ForcesAndSourcesCore::RuleHookFun</a> vol_rule,</div>
<div class="line">      <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html#ab74a230ea17b23143370a833d5b476b2">ForcesAndSourcesCore::RuleHookFun</a> face_rule = <a class="code" href="structFaceRule.html">FaceRule</a>(),</div>
<div class="line">      <span class="keywordtype">bool</span> trans = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create elements element instances</span></div>
<div class="line">    domain_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    boundary_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    domain_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    boundary_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rule to elements instances</span></div>
<div class="line">    domain_lhs_fe-&gt;getRuleHook = vol_rule;</div>
<div class="line">    domain_rhs_fe-&gt;getRuleHook = vol_rule;</div>
<div class="line">    boundary_lhs_fe-&gt;getRuleHook = face_rule;</div>
<div class="line">    boundary_rhs_fe-&gt;getRuleHook = face_rule;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rule</span></div>
<div class="line">    <span class="comment">// Crate shared vector storing values of field &quot;u&quot; on integration points on</span></div>
<div class="line">    <span class="comment">// element. element is local and is used to exchange data between operators.</span></div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; values_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="comment">// Storing gradients of field</span></div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; grad_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// multipliers values</span></div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; multiplier_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operators to element instances</span></div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate field gradient at integration points</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator grad-(1+u^2)grad for calculate matrix</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpKt(</div>
<div class="line">        <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, diff_a, values_at_integration_ptr, grad_at_integration_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate field gradient at integration points</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator to calculate source terms</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpResF_Domain(</div>
<div class="line">        f_source, <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, values_at_integration_ptr, grad_at_integration_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operator calculating constrains matrix</span></div>
<div class="line">    boundary_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC(trans));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate values of Lagrange multipliers</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;L&quot;</span>, multiplier_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator calculating constrains vector</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpRes_g(f_u, values_at_integration_ptr));</div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpResF_Boundary(multiplier_at_integration_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;mField;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace PoissonExample</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif //__POISSONOPERATORS_HPP__</span></div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="aelastic_8cpp_html_aefa6a347aab3bc50a8c1b6b4aa0f1e60"><div class="ttname"><a href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpGradSymTensorGrad&lt; BASE_DIM, SPACE_DIM, SPACE_DIM, 0 &gt; OpK</div><div class="ttdoc">[Define entities]</div><div class="ttdef"><b>Definition:</b> <a href="elastic_8cpp_source.html#l00039">elastic.cpp:39</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="astructOpError_html"><div class="ttname"><a href="structOpError.html">OpError</a></div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00061">initial_diffusion.cpp:61</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="astructOpK_html"><div class="ttname"><a href="structOpK.html">OpK</a></div><div class="ttdef"><b>Definition:</b> <a href="simple__elasticity_8cpp_source.html#l00016">simple_elasticity.cpp:16</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="anamespacePoissonExample_html"><div class="ttname"><a href="namespacePoissonExample.html">PoissonExample</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxPoissonFunctions_8hpp_source.html#l00012">AuxPoissonFunctions.hpp:12</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a8e10860da32e3936c8509b022f78b0f6"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a8e10860da32e3936c8509b022f78b0f6">MoFEM::EntitiesFieldData::EntData::getFieldData</a></div><div class="ttdeci">const VectorDouble &amp; getFieldData() const</div><div class="ttdoc">get dofs values</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01254">EntitiesFieldData.hpp:1254</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="astructVolRule_html"><div class="ttname"><a href="structVolRule.html">VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00088">simple_interface.cpp:88</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aclassOPBASE_html"><div class="ttname"><a href="classOPBASE.html">OPBASE</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">MoFEM::OpCalculateScalarFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01293">UserDataOperators.hpp:1293</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01502">EntitiesFieldData.hpp:1502</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Number_html"><div class="ttname"><a href="classFTensor_1_1Number.html">FTensor::Number&lt; 0 &gt;</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html_a9c0a9a269e2e1026ee94cedc069fd0cf"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html#a9c0a9a269e2e1026ee94cedc069fd0cf">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdeci">friend class UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00086">FaceElementForcesAndSourcesCore.hpp:86</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespacePoissonExample_html_a097610ce0a8fd450f66ead79cc7e81a7"><div class="ttname"><a href="namespacePoissonExample.html#a097610ce0a8fd450f66ead79cc7e81a7">PoissonExample::PostProcFE</a></div><div class="ttdeci">PostProcBrokenMeshInMoab&lt; VolumeElementForcesAndSourcesCore &gt; PostProcFE</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00015">PoissonOperators.hpp:15</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00094">FaceElementForcesAndSourcesCore.hpp:94</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetHOInvJacToScalarBases_html"><div class="ttname"><a href="structMoFEM_1_1OpSetHOInvJacToScalarBases.html">MoFEM::OpSetHOInvJacToScalarBases</a></div><div class="ttdoc">Set inverse jacobian to base functions.</div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00073">HODataOperators.hpp:73</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition:</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aa464ad90a188180427136b22e078ec7d"><div class="ttname"><a href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">MoFEM::getFTensor0FromVec</a></div><div class="ttdeci">static auto getFTensor0FromVec(ublas::vector&lt; T, A &gt; &amp;data)</div><div class="ttdoc">Get tensor rank 0 (scalar) form data vector.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l00135">Templates.hpp:135</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValues.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00082">UserDataOperators.hpp:82</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html_a9c0a9a269e2e1026ee94cedc069fd0cf"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html#a9c0a9a269e2e1026ee94cedc069fd0cf">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdeci">friend class UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00105">VolumeElementForcesAndSourcesCore.hpp:105</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a632d60524d4b1682a472437b9277e480"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01214">EntitiesFieldData.hpp:1214</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoab_3_01VolumeElementForcesAndSourcesCore_01_4_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoab_3_01VolumeElementForcesAndSourcesCore_01_4.html">MoFEM::PostProcBrokenMeshInMoab&lt; VolumeElementForcesAndSourcesCore &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00670">PostProcBrokenMeshInMoabBase.hpp:670</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHOJac_3_013_01_4_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHOJac_3_013_01_4.html">MoFEM::OpCalculateHOJac&lt; 3 &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00269">HODataOperators.hpp:269</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a14f5bf9a76b74ed8a2ca283b369e54ad"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a14f5bf9a76b74ed8a2ca283b369e54ad">MoFEM::EntitiesFieldData::EntData::getFieldDofs</a></div><div class="ttdeci">const VectorDofs &amp; getFieldDofs() const</div><div class="ttdoc">get dofs data stature FEDofEntity</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01269">EntitiesFieldData.hpp:1269</a></div></div>
<div class="ttc" id="astructFaceRule_html"><div class="ttname"><a href="structFaceRule.html">FaceRule</a></div><div class="ttdoc">Set integration rule to boundary elements.</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00091">simple_interface.cpp:91</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">MoFEM::VolumeElementForcesAndSourcesCore</a></div><div class="ttdoc">Volume finite element base.</div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00026">VolumeElementForcesAndSourcesCore.hpp:26</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00108">VolumeElementForcesAndSourcesCore.hpp:108</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', 3 &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8cpp_source.html#l00526">EntitiesFieldData.cpp:526</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor0_html"><div class="ttname"><a href="classFTensor_1_1Tensor0.html">FTensor::Tensor0</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor0_8hpp_source.html#l00016">Tensor0.hpp:16</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpInvertMatrix_html"><div class="ttname"><a href="structMoFEM_1_1OpInvertMatrix.html">MoFEM::OpInvertMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l03249">UserDataOperators.hpp:3249</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_ab74a230ea17b23143370a833d5b476b2"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#ab74a230ea17b23143370a833d5b476b2">MoFEM::ForcesAndSourcesCore::RuleHookFun</a></div><div class="ttdeci">boost::function&lt; int(int order_row, int order_col, int order_data)&gt; RuleHookFun</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00028">ForcesAndSourcesCore.hpp:28</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00698">PostProcBrokenMeshInMoabBase.hpp:698</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>