<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: users_modules/gels/gel_analysis.cpp File Reference</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fdd23f46654bee42f0ef7ae5010b806.html">users_modules</a></li><li class="navelem"><a class="el" href="dir_853e17180f5ad5702b5773996048148e.html">gels</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">gel_analysis.cpp File Reference<div class="ingroups"><a class="el" href="group__user__modules.html">User modules</a> &raquo; <a class="el" href="group__gel.html">Gel model</a></div></div></div>
</div><!--header-->
<div class="contents">

<p>Reads cubit file and solves problem with gel material.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &lt;<a class="el" href="_mo_f_e_m_8hpp_source.html">MoFEM.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_post_proc_on_ref_mesh_8hpp_source.html">PostProcOnRefMesh.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_projection10_node_coords_on_field_8hpp_source.html">Projection10NodeCoordsOnField.hpp</a>&gt;</code><br />
<code>#include &lt;boost/numeric/ublas/vector_proxy.hpp&gt;</code><br />
<code>#include &lt;boost/numeric/ublas/matrix.hpp&gt;</code><br />
<code>#include &lt;boost/numeric/ublas/matrix_proxy.hpp&gt;</code><br />
<code>#include &lt;boost/numeric/ublas/vector.hpp&gt;</code><br />
<code>#include &lt;adolc/adolc.h&gt;</code><br />
<code>#include &lt;<a class="el" href="_gels_8hpp_source.html">Gels.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_user_gel_model_8hpp_source.html">UserGelModel.hpp</a>&gt;</code><br />
<code>#include &lt;boost/program_options.hpp&gt;</code><br />
<code>#include &lt;<a class="el" href="_method_for_force_scaling_8hpp_source.html">MethodForForceScaling.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_dirichlet_b_c_8hpp_source.html">DirichletBC.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_surface_pressure_8hpp_source.html">SurfacePressure.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_nodal_force_8hpp_source.html">NodalForce.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_edge_force_8hpp_source.html">EdgeForce.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_thermal_element_8hpp_source.html">ThermalElement.hpp</a>&gt;</code><br />
<code>#include &lt;<a class="el" href="_time_force_scale_8hpp_source.html">TimeForceScale.hpp</a>&gt;</code><br />
<code>#include &lt;boost/iostreams/tee.hpp&gt;</code><br />
<code>#include &lt;boost/iostreams/stream.hpp&gt;</code><br />
<code>#include &lt;fstream&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
</div>
<p><a href="gel__analysis_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="struct_block_data.html">BlockData</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a0ddf1224851353fc92bfbff6f499fa97"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gel__analysis_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a> (int argc, char *argv[])</td></tr>
<tr class="separator:a0ddf1224851353fc92bfbff6f499fa97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a29680e68c64040f4884f60691a193226"><td class="memItemLeft" align="right" valign="top">static char&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="gel__analysis_8cpp.html#a29680e68c64040f4884f60691a193226">help</a> [] = &quot;...\n\n&quot;</td></tr>
<tr class="separator:a29680e68c64040f4884f60691a193226"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p >Reads cubit file and solves problem with gel material. </p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000062">Todo:</a></b></dt><dd>Current version is limited only to one material. If one like to have general problem for nonlinear elasticity should implement general time dependent problem. If inertia terms need to be considered, this material should be add to nonlinear dynamics problem.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000063">Todo:</a></b></dt><dd>Internal history state variables need to be statically condensed. It can be done by implementing static condensation on finite element level or by implementing pre-conditioner.</dd></dl>

<p class="definition">Definition in file <a class="el" href="gel__analysis_8cpp_source.html">gel_analysis.cpp</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a id="a0ddf1224851353fc92bfbff6f499fa97" name="a0ddf1224851353fc92bfbff6f499fa97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ddf1224851353fc92bfbff6f499fa97">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char *&#160;</td>
          <td class="paramname"><em>argv</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gel__analysis_8cpp_source.html#l00081">81</a> of file <a class="el" href="gel__analysis_8cpp_source.html">gel_analysis.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>                                 {</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc,&amp;argv,(<span class="keywordtype">char</span> *)0,<a class="code hl_variable" href="gel__analysis_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  moab::Core mb_instance;</div>
<div class="line"><span class="lineno">   88</span>  moab::Interface&amp; moab = mb_instance;</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>  PetscBool flg_gel_config,flg_file;</div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordtype">char</span> <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>[255];</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordtype">char</span> gel_config_file[255];</div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 2;</div>
<div class="line"><span class="lineno">   94</span>  PetscBool is_partitioned = PETSC_FALSE;</div>
<div class="line"><span class="lineno">   95</span>  PetscBool is_atom_test = PETSC_FALSE;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  {</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsBegin(PETSC_COMM_WORLD,<span class="stringliteral">&quot;&quot;</span>,<span class="stringliteral">&quot;Elastic Config&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  100</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsString(</div>
<div class="line"><span class="lineno">  101</span>      <span class="stringliteral">&quot;-my_file&quot;</span>,</div>
<div class="line"><span class="lineno">  102</span>      <span class="stringliteral">&quot;mesh file name&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  103</span>      <span class="stringliteral">&quot;mesh.h5m&quot;</span>,</div>
<div class="line"><span class="lineno">  104</span>      <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>,</div>
<div class="line"><span class="lineno">  105</span>      255,</div>
<div class="line"><span class="lineno">  106</span>      &amp;flg_file</div>
<div class="line"><span class="lineno">  107</span>    ); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  108</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsInt(</div>
<div class="line"><span class="lineno">  109</span>      <span class="stringliteral">&quot;-my_order&quot;</span>,</div>
<div class="line"><span class="lineno">  110</span>      <span class="stringliteral">&quot;default approximation order&quot;</span>,</div>
<div class="line"><span class="lineno">  111</span>      <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  112</span>      <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,</div>
<div class="line"><span class="lineno">  113</span>      &amp;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,</div>
<div class="line"><span class="lineno">  114</span>      PETSC_NULL</div>
<div class="line"><span class="lineno">  115</span>    ); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsBool(</div>
<div class="line"><span class="lineno">  118</span>      <span class="stringliteral">&quot;-my_is_partitioned&quot;</span>,</div>
<div class="line"><span class="lineno">  119</span>      <span class="stringliteral">&quot;set if mesh is partitioned (this result that each process keeps only part of the mes&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  120</span>      PETSC_FALSE,&amp;is_partitioned,PETSC_NULL</div>
<div class="line"><span class="lineno">  121</span>    ); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsString(</div>
<div class="line"><span class="lineno">  123</span>      <span class="stringliteral">&quot;-my_gel_config&quot;</span>,</div>
<div class="line"><span class="lineno">  124</span>      <span class="stringliteral">&quot;gel configuration file name&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  125</span>      <span class="stringliteral">&quot;gel_config.in&quot;</span>,gel_config_file,255,&amp;flg_gel_config</div>
<div class="line"><span class="lineno">  126</span>    ); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsBool(</div>
<div class="line"><span class="lineno">  129</span>      <span class="stringliteral">&quot;-my_is_atom_test&quot;</span>,</div>
<div class="line"><span class="lineno">  130</span>      <span class="stringliteral">&quot;is used with testing, exit with error when diverged&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><span class="lineno">  131</span>      PETSC_FALSE,&amp;is_atom_test,PETSC_NULL</div>
<div class="line"><span class="lineno">  132</span>    ); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd(); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="comment">//Reade parameters from line command</span></div>
<div class="line"><span class="lineno">  137</span>    <span class="keywordflow">if</span>(flg_file != PETSC_TRUE) {</div>
<div class="line"><span class="lineno">  138</span>      SETERRQ(PETSC_COMM_SELF,1,<span class="stringliteral">&quot;*** ERROR -my_file (MESH FILE NEEDED)&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>    <span class="keywordflow">if</span>(is_partitioned == PETSC_TRUE) {</div>
<div class="line"><span class="lineno">  142</span>      <span class="comment">//Read mesh to MOAB</span></div>
<div class="line"><span class="lineno">  143</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line"><span class="lineno">  144</span>      option =</div>
<div class="line"><span class="lineno">  145</span>      <span class="stringliteral">&quot;PARALLEL=BCAST_DELETE;&quot;</span></div>
<div class="line"><span class="lineno">  146</span>      <span class="stringliteral">&quot;PARALLEL_RESOLVE_SHARED_ENTS;&quot;</span></div>
<div class="line"><span class="lineno">  147</span>      <span class="stringliteral">&quot;PARTITION=PARALLEL_PARTITION;&quot;</span>;</div>
<div class="line"><span class="lineno">  148</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  149</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  150</span>      <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line"><span class="lineno">  151</span>      option = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line"><span class="lineno">  152</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  153</span>    }</div>
<div class="line"><span class="lineno">  154</span>    ParallelComm* pcomm = ParallelComm::get_pcomm(&amp;moab,<a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">if</span>(pcomm == NULL) pcomm =  <span class="keyword">new</span> ParallelComm(&amp;moab,PETSC_COMM_WORLD);</div>
<div class="line"><span class="lineno">  156</span>  }</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line"><span class="lineno">  159</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a>&amp; m_field = core;</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  <span class="comment">// Seed all mesh entities to MoFEM database, those entities can be potentially used as finite elements</span></div>
<div class="line"><span class="lineno">  162</span>  <span class="comment">// or as entities which carry some approximation field.</span></div>
<div class="line"><span class="lineno">  163</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_level0;</div>
<div class="line"><span class="lineno">  164</span>  bit_level0.set(0);</div>
<div class="line"><span class="lineno">  165</span>  <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#ac30fe9bd2cd5d13d375097927a783c43">seed_ref_level_3D</a>(0,bit_level0); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  <span class="comment">// Define fields and finite elements</span></div>
<div class="line"><span class="lineno">  168</span>  <a class="code hl_struct" href="struct_gel_module_1_1_gel.html">Gel</a> gel(m_field);</div>
<div class="line"><span class="lineno">  169</span>  map&lt;int,ThermalElement::FluxData&gt; set_of_solvent_fluxes;</div>
<div class="line"><span class="lineno">  170</span>  {</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>    <span class="comment">// Set approximation fields</span></div>
<div class="line"><span class="lineno">  173</span>    {</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>      <span class="comment">// Add fields</span></div>
<div class="line"><span class="lineno">  176</span>      <span class="keywordtype">bool</span> check_if_spatial_field_exist = m_field.<a class="code hl_function" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>);</div>
<div class="line"><span class="lineno">  177</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,3,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  178</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,1,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  179</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;HAT_EPS&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,6,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  180</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,3,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  181</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,1,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  182</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,6,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>      <span class="comment">//Add field H1 space rank 3 to approximate geometry using hierarchical basis</span></div>
<div class="line"><span class="lineno">  185</span>      <span class="comment">//For 10 node tetrahedral, before use, geometry is projected on that field (see below)</span></div>
<div class="line"><span class="lineno">  186</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">add_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,3,MB_TAG_SPARSE,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>      <span class="comment">//meshset consisting all entities in mesh</span></div>
<div class="line"><span class="lineno">  189</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> root_set = moab.get_root_set();</div>
<div class="line"><span class="lineno">  190</span>      <span class="comment">//Add entities to field (root_mesh, i.e. on all mesh entities fields are approx.)</span></div>
<div class="line"><span class="lineno">  191</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  192</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  193</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;HAT_EPS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  194</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  195</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  196</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>      <span class="comment">// Set approximation order. Solvent concentration has one order less than</span></div>
<div class="line"><span class="lineno">  199</span>      <span class="comment">// order of of spatial position field. Tests need to be maid if that is</span></div>
<div class="line"><span class="lineno">  200</span>      <span class="comment">// good enough to have stability for this type of problem. If not bubble</span></div>
<div class="line"><span class="lineno">  201</span>      <span class="comment">// functions could be easily added by increasing approximate order for</span></div>
<div class="line"><span class="lineno">  202</span>      <span class="comment">// volume.</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTET,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,2); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  205</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTRI,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,2); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  206</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBEDGE,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,2); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  207</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBVERTEX,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTET,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  210</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTRI,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  211</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBEDGE,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  212</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBVERTEX,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTET,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  215</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTRI,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  216</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBEDGE,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  217</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBVERTEX,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTET,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  220</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTRI,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  221</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBEDGE,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  222</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBVERTEX,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>,1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTET,<span class="stringliteral">&quot;HAT_EPS&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  225</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set,MBTET,<span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>      <span class="comment">//gemetry approximation is set to 2nd oreder</span></div>
<div class="line"><span class="lineno">  228</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set,MBTET,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  229</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0,MBTET,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,2); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  230</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0,MBTRI,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,2); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  231</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0,MBEDGE,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,2); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  232</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0,MBVERTEX,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>      <span class="keywordflow">try</span> {</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>        map&lt;int,BlockData&gt; block_data;</div>
<div class="line"><span class="lineno">  237</span>        map&lt;int,Gel::BlockMaterialData&gt; &amp;material_data = gel.blockMaterialData;</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>        ifstream ini_file(gel_config_file);</div>
<div class="line"><span class="lineno">  240</span>        po::variables_map vm;</div>
<div class="line"><span class="lineno">  241</span>        po::options_description config_file_options;</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordtype">int</span> def_block = 0;</div>
<div class="line"><span class="lineno">  244</span>        Tag th_block_id;</div>
<div class="line"><span class="lineno">  245</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.tag_get_handle(</div>
<div class="line"><span class="lineno">  246</span>          <span class="stringliteral">&quot;BLOCK_ID&quot;</span>,1,MB_TYPE_INTEGER,th_block_id,MB_TAG_CREAT|MB_TAG_SPARSE,&amp;def_block</div>
<div class="line"><span class="lineno">  247</span>        ); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>        <span class="keywordflow">for</span>(<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field,<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>,it)) {</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>          <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name = it-&gt;getName();</div>
<div class="line"><span class="lineno">  252</span>          <span class="keywordflow">if</span>(name.compare(0,3,<span class="stringliteral">&quot;GEL&quot;</span>)!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>          <span class="keywordtype">int</span> block_id = it-&gt;getMeshsetId();</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>          ostringstream str_order;</div>
<div class="line"><span class="lineno">  257</span>          str_order &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.oRder&quot;</span>;</div>
<div class="line"><span class="lineno">  258</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  259</span>          (str_order.str().c_str(),po::value&lt;int&gt;(</div>
<div class="line"><span class="lineno">  260</span>            &amp;block_data[block_id].oRder</div>
<div class="line"><span class="lineno">  261</span>          )-&gt;default_value(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>));</div>
<div class="line"><span class="lineno">  262</span>          <a class="code hl_class" href="class_range.html">Range</a> block_ents;</div>
<div class="line"><span class="lineno">  263</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.get_entities_by_handle(</div>
<div class="line"><span class="lineno">  264</span>            it-&gt;getMeshset(),block_ents,true</div>
<div class="line"><span class="lineno">  265</span>          ); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  266</span>          material_data[block_id].tEts = block_ents.subset_by_type(MBTET);</div>
<div class="line"><span class="lineno">  267</span>          std::vector&lt;int&gt; block_id_vec(material_data[block_id].tEts.size(),it-&gt;getMeshsetId());</div>
<div class="line"><span class="lineno">  268</span>          <span class="comment">// cerr &lt;&lt; &quot;AAA &quot; &lt;&lt; block_id_vec.size() &lt;&lt; &quot; &quot; &lt;&lt; material_data[block_id].tEts.size() &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  269</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.tag_set_data(</div>
<div class="line"><span class="lineno">  270</span>            th_block_id,material_data[block_id].tEts,&amp;*block_id_vec.begin()</div>
<div class="line"><span class="lineno">  271</span>          );</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>          ostringstream str_g_alpha;</div>
<div class="line"><span class="lineno">  274</span>          str_g_alpha &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.gAlpha&quot;</span>;</div>
<div class="line"><span class="lineno">  275</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  276</span>          (str_g_alpha.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].gAlpha)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  277</span>          ostringstream str_v_alpha;</div>
<div class="line"><span class="lineno">  278</span>          str_v_alpha &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.vAlpha&quot;</span>;</div>
<div class="line"><span class="lineno">  279</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  280</span>          (str_v_alpha.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].vAlpha)-&gt;default_value(0));</div>
<div class="line"><span class="lineno">  281</span>          ostringstream str_g_beta;</div>
<div class="line"><span class="lineno">  282</span>          str_g_beta &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.gBeta&quot;</span>;</div>
<div class="line"><span class="lineno">  283</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  284</span>          (str_g_beta.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].gBeta)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  285</span>          ostringstream str_v_beta;</div>
<div class="line"><span class="lineno">  286</span>          str_v_beta &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.vBeta&quot;</span>;</div>
<div class="line"><span class="lineno">  287</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  288</span>          (str_v_beta.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].vBeta)-&gt;default_value(0));</div>
<div class="line"><span class="lineno">  289</span>          ostringstream str_g_beta_hat;</div>
<div class="line"><span class="lineno">  290</span>          str_g_beta_hat &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.gBetaHat&quot;</span>;</div>
<div class="line"><span class="lineno">  291</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  292</span>          (str_g_beta_hat.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].gBetaHat)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  293</span>          ostringstream str_v_beta_hat;</div>
<div class="line"><span class="lineno">  294</span>          str_v_beta_hat &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.vBetaHat&quot;</span>;</div>
<div class="line"><span class="lineno">  295</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  296</span>          (str_v_beta_hat.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].vBetaHat)-&gt;default_value(0));</div>
<div class="line"><span class="lineno">  297</span>          ostringstream str_omega;</div>
<div class="line"><span class="lineno">  298</span>          str_omega &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.oMega&quot;</span>;</div>
<div class="line"><span class="lineno">  299</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  300</span>          (str_omega.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].oMega)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  301</span>          ostringstream str_viscosity;</div>
<div class="line"><span class="lineno">  302</span>          str_viscosity &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.vIscosity&quot;</span>;</div>
<div class="line"><span class="lineno">  303</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  304</span>          (str_viscosity.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].vIscosity)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  305</span>          ostringstream str_permeability;</div>
<div class="line"><span class="lineno">  306</span>          str_permeability &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.pErmeability&quot;</span>;</div>
<div class="line"><span class="lineno">  307</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  308</span>          (str_permeability.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].pErmeability)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  309</span>          ostringstream str_mu0;</div>
<div class="line"><span class="lineno">  310</span>          str_mu0 &lt;&lt; <span class="stringliteral">&quot;block_&quot;</span> &lt;&lt; block_id &lt;&lt; <span class="stringliteral">&quot;.mU0&quot;</span>;</div>
<div class="line"><span class="lineno">  311</span>          config_file_options.add_options()</div>
<div class="line"><span class="lineno">  312</span>          (str_mu0.str().c_str(),po::value&lt;double&gt;(&amp;material_data[block_id].mU0)-&gt;default_value(1));</div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>        }</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>        po::parsed_options parsed = parse_config_file(ini_file,config_file_options,<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  317</span>        store(parsed,vm);</div>
<div class="line"><span class="lineno">  318</span>        po::notify(vm);</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">for</span>(<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field,<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>,it)) {</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>          <span class="keyword">const</span> <span class="keywordtype">string</span> &amp;name = it-&gt;getName();</div>
<div class="line"><span class="lineno">  322</span>          <span class="keywordflow">if</span>(name.compare(0,3,<span class="stringliteral">&quot;GEL&quot;</span>)!=0) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>          <span class="keywordflow">if</span>(block_data[it-&gt;getMeshsetId()].oRder == -1) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  325</span>          <span class="keywordflow">if</span>(block_data[it-&gt;getMeshsetId()].oRder == <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) <span class="keywordflow">continue</span>;</div>
<div class="line"><span class="lineno">  326</span>          PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;Set block %d order to %d\n&quot;</span>,it-&gt;getMeshsetId(),block_data[it-&gt;getMeshsetId()].oRder);</div>
<div class="line"><span class="lineno">  327</span>          <a class="code hl_class" href="class_range.html">Range</a> block_ents;</div>
<div class="line"><span class="lineno">  328</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.get_entities_by_handle(it-&gt;getMeshset(),block_ents,<span class="keyword">true</span>); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  329</span>          <a class="code hl_class" href="class_range.html">Range</a> ents_to_set_order;</div>
<div class="line"><span class="lineno">  330</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.get_adjacencies(block_ents,3,<span class="keyword">false</span>,ents_to_set_order,moab::Interface::UNION); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  331</span>          ents_to_set_order = ents_to_set_order.subset_by_type(MBTET);</div>
<div class="line"><span class="lineno">  332</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.get_adjacencies(block_ents,2,<span class="keyword">false</span>,ents_to_set_order,moab::Interface::UNION); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  333</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.get_adjacencies(block_ents,1,<span class="keyword">false</span>,ents_to_set_order,moab::Interface::UNION); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  334</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">synchronise_entities</a>(ents_to_set_order); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  335</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents_to_set_order,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,block_data[it-&gt;getMeshsetId()].oRder); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  336</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents_to_set_order,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,block_data[it-&gt;getMeshsetId()].oRder-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  337</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents_to_set_order,<span class="stringliteral">&quot;HAT_EPS&quot;</span>,block_data[it-&gt;getMeshsetId()].oRder-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  338</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents_to_set_order,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,block_data[it-&gt;getMeshsetId()].oRder); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  339</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents_to_set_order,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>,block_data[it-&gt;getMeshsetId()].oRder-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  340</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(ents_to_set_order,<span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>,block_data[it-&gt;getMeshsetId()].oRder-1); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  341</span>        }</div>
<div class="line"><span class="lineno">  342</span>        vector&lt;string&gt; additional_parameters;</div>
<div class="line"><span class="lineno">  343</span>        additional_parameters = collect_unrecognized(parsed.options,po::include_positional);</div>
<div class="line"><span class="lineno">  344</span>        <span class="keywordflow">for</span>(vector&lt;string&gt;::iterator vit = additional_parameters.begin();</div>
<div class="line"><span class="lineno">  345</span>        vit!=additional_parameters.end();vit++) {</div>
<div class="line"><span class="lineno">  346</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;** WARNING Unrecognised option %s\n&quot;</span>,vit-&gt;c_str()); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  347</span>        }</div>
<div class="line"><span class="lineno">  348</span>      } <span class="keywordflow">catch</span> (<span class="keyword">const</span> std::exception&amp; ex) {</div>
<div class="line"><span class="lineno">  349</span>        ostringstream ss;</div>
<div class="line"><span class="lineno">  350</span>        ss &lt;&lt; ex.what() &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  351</span>        SETERRQ(PETSC_COMM_SELF,<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a>,ss.str().c_str());</div>
<div class="line"><span class="lineno">  352</span>      }</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">for</span>(</div>
<div class="line"><span class="lineno">  355</span>        map&lt;int,Gel::BlockMaterialData&gt;::iterator mit = gel.blockMaterialData.begin();</div>
<div class="line"><span class="lineno">  356</span>        mit!=gel.blockMaterialData.end();mit++</div>
<div class="line"><span class="lineno">  357</span>      ) {</div>
<div class="line"><span class="lineno">  358</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;** Block Id %d\n&quot;</span>,mit-&gt;first); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  359</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;vAlpha = %5.4g\n&quot;</span>,mit-&gt;second.vAlpha);</div>
<div class="line"><span class="lineno">  360</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;gAlpha = %5.4g\n&quot;</span>,mit-&gt;second.gAlpha);</div>
<div class="line"><span class="lineno">  361</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;vBeta = %5.4g\n&quot;</span>,mit-&gt;second.vBeta);</div>
<div class="line"><span class="lineno">  362</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;gBeta = %5.4g\n&quot;</span>,mit-&gt;second.gBeta);</div>
<div class="line"><span class="lineno">  363</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;vBetaHat = %5.4g\n&quot;</span>,mit-&gt;second.vBetaHat);</div>
<div class="line"><span class="lineno">  364</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;gBetaHat = %5.4g\n&quot;</span>,mit-&gt;second.gBetaHat);</div>
<div class="line"><span class="lineno">  365</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;pErmeability = %5.4g\n&quot;</span>,mit-&gt;second.pErmeability);</div>
<div class="line"><span class="lineno">  366</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;vIscosity = %5.4g\n&quot;</span>,mit-&gt;second.vIscosity);</div>
<div class="line"><span class="lineno">  367</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;oMega = %5.4g\n&quot;</span>,mit-&gt;second.oMega);</div>
<div class="line"><span class="lineno">  368</span>        PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;mU0 = %5.4g\n&quot;</span>,mit-&gt;second.mU0);</div>
<div class="line"><span class="lineno">  369</span>      }</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>(); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>      <span class="comment">// Sett geometry approximation and initial spatial positions</span></div>
<div class="line"><span class="lineno">  374</span>      <span class="comment">// 10 node tets</span></div>
<div class="line"><span class="lineno">  375</span>      <span class="keywordflow">if</span> (!check_if_spatial_field_exist) {</div>
<div class="line"><span class="lineno">  376</span>        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">Projection10NodeCoordsOnField</a> ent_method_material(m_field, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line"><span class="lineno">  377</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_material); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  378</span>        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">Projection10NodeCoordsOnField</a> ent_method_spatial(m_field, <span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>);</div>
<div class="line"><span class="lineno">  379</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>, ent_method_spatial); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  380</span>        <span class="comment">// Set value to chemical load</span></div>
<div class="line"><span class="lineno">  381</span>        map&lt;int,Gel::BlockMaterialData&gt; &amp;material_data = gel.blockMaterialData;</div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">for</span>(</div>
<div class="line"><span class="lineno">  383</span>          map&lt;int,Gel::BlockMaterialData&gt;::iterator mit = material_data.begin();</div>
<div class="line"><span class="lineno">  384</span>          mit!=material_data.end();mit++</div>
<div class="line"><span class="lineno">  385</span>        ) {</div>
<div class="line"><span class="lineno">  386</span>          <span class="comment">// FIXME mu0 at border in undefined, if two blackset have different mu0</span></div>
<div class="line"><span class="lineno">  387</span>          <a class="code hl_class" href="class_range.html">Range</a> vertices;</div>
<div class="line"><span class="lineno">  388</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = moab.get_connectivity(mit-&gt;second.tEts,vertices,<span class="keyword">true</span>); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  389</span>          <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.set_field(mit-&gt;second.mU0,MBVERTEX,vertices,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  390</span>        }</div>
<div class="line"><span class="lineno">  391</span>      }</div>
<div class="line"><span class="lineno">  392</span> </div>
<div class="line"><span class="lineno">  393</span>    }</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <span class="comment">//Set finite elements. The primary element is GEL_FE in addition elements</span></div>
<div class="line"><span class="lineno">  396</span>    <span class="comment">//for applying tractions and fluxes are added.</span></div>
<div class="line"><span class="lineno">  397</span>    {</div>
<div class="line"><span class="lineno">  398</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  399</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  400</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  401</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  402</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  403</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;HAT_EPS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  404</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;HAT_EPS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  405</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  406</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  407</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  408</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  409</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;HAT_EPS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  410</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  411</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;GEL_FE&quot;</span>,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>      map&lt;int,Gel::BlockMaterialData&gt; &amp;material_data = gel.blockMaterialData;</div>
<div class="line"><span class="lineno">  414</span>      <span class="keywordflow">for</span>(</div>
<div class="line"><span class="lineno">  415</span>        map&lt;int,Gel::BlockMaterialData&gt;::iterator mit = material_data.begin();</div>
<div class="line"><span class="lineno">  416</span>        mit!=material_data.end();</div>
<div class="line"><span class="lineno">  417</span>        mit++</div>
<div class="line"><span class="lineno">  418</span>      ) {</div>
<div class="line"><span class="lineno">  419</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(mit-&gt;second.tEts,MBTET,<span class="stringliteral">&quot;GEL_FE&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  420</span>      }</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>      <span class="comment">// Add Neumann forces, i.e. on triangles, edges and nodes.</span></div>
<div class="line"><span class="lineno">  423</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = MetaNeummanForces::addNeumannBCElements(m_field,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  424</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="struct_meta_nodal_forces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a>(m_field,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  425</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="struct_meta_edge_forces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a>(m_field,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>      <span class="comment">// Add solvent flux element</span></div>
<div class="line"><span class="lineno">  428</span>      {</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  431</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  432</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  433</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  434</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>,<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>        <span class="comment">// Assume that boundary conditions are set in block containing surface</span></div>
<div class="line"><span class="lineno">  437</span>        <span class="comment">// triangle elements and block name is &quot;CHEMICAL_LOAD_FLUX&quot;</span></div>
<div class="line"><span class="lineno">  438</span>        <span class="keywordflow">for</span>(<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field,<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>,it)) {</div>
<div class="line"><span class="lineno">  439</span>          <span class="keywordflow">if</span>(it-&gt;getName().compare(0,18,<span class="stringliteral">&quot;FLUX_CHEMICAL_LOAD&quot;</span>) == 0) {</div>
<div class="line"><span class="lineno">  440</span>            vector&lt;double&gt; data;</div>
<div class="line"><span class="lineno">  441</span>            <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = it-&gt;getAttributes(data); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  442</span>            <span class="keywordflow">if</span>(data.size()!=1) {</div>
<div class="line"><span class="lineno">  443</span>              SETERRQ(PETSC_COMM_SELF,1,<span class="stringliteral">&quot;Data inconsistency&quot;</span>);</div>
<div class="line"><span class="lineno">  444</span>            }</div>
<div class="line"><span class="lineno">  445</span>            <span class="comment">// Here it set how block of for heat flux is set.  This is because</span></div>
<div class="line"><span class="lineno">  446</span>            <span class="comment">// implementation from thermal element is used to enforce this</span></div>
<div class="line"><span class="lineno">  447</span>            <span class="comment">// boundary condition.</span></div>
<div class="line"><span class="lineno">  448</span>            strcpy(set_of_solvent_fluxes[it-&gt;getMeshsetId()].dAta.data.name,<span class="stringliteral">&quot;HeatFlu&quot;</span>);</div>
<div class="line"><span class="lineno">  449</span>            set_of_solvent_fluxes[it-&gt;getMeshsetId()].dAta.data.flag1 = 1;</div>
<div class="line"><span class="lineno">  450</span>            set_of_solvent_fluxes[it-&gt;getMeshsetId()].dAta.data.value1 = data[0];</div>
<div class="line"><span class="lineno">  451</span>            <span class="comment">//cerr &lt;&lt; set_of_solvent_fluxes[it-&gt;getMeshsetId()].dAta &lt;&lt; endl;</span></div>
<div class="line"><span class="lineno">  452</span>            <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(</div>
<div class="line"><span class="lineno">  453</span>              it-&gt;meshset,MBTRI,set_of_solvent_fluxes[it-&gt;getMeshsetId()].tRis,<span class="keyword">true</span></div>
<div class="line"><span class="lineno">  454</span>            ); <a class="code hl_define" href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line"><span class="lineno">  455</span>            <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(</div>
<div class="line"><span class="lineno">  456</span>              set_of_solvent_fluxes[it-&gt;getMeshsetId()].tRis,MBTRI,<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span></div>
<div class="line"><span class="lineno">  457</span>            ); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  458</span>          }</div>
<div class="line"><span class="lineno">  459</span>        }</div>
<div class="line"><span class="lineno">  460</span>      }</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>      <span class="comment">//build finite elements</span></div>
<div class="line"><span class="lineno">  463</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  464</span>      <span class="comment">//build adjacencies</span></div>
<div class="line"><span class="lineno">  465</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(bit_level0); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  466</span>    }</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>  }</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <span class="comment">// attach tags for each recorder</span></div>
<div class="line"><span class="lineno">  471</span>  vector&lt;int&gt; tags;</div>
<div class="line"><span class="lineno">  472</span>  tags.push_back(<a class="code hl_enumvalue" href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efa233337574cabf9b2dd37e8e2b2a68cf8">Gel::STRESSTOTAL</a>); <span class="comment">// ADOL-C tag used to calculate total stress</span></div>
<div class="line"><span class="lineno">  473</span>  tags.push_back(<a class="code hl_enumvalue" href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efaca12bba3fa5f0c2ee78243b1acb98fb7">Gel::SOLVENTFLUX</a>);</div>
<div class="line"><span class="lineno">  474</span>  tags.push_back(<a class="code hl_enumvalue" href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efa07588422ebef3bad03013e12e48945f8">Gel::SOLVENTRATE</a>);</div>
<div class="line"><span class="lineno">  475</span>  tags.push_back(<a class="code hl_enumvalue" href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efa1d3f203bb4da9c23ac713503e939c054">Gel::RESIDUALSTRAINHAT</a>);</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>  <span class="comment">// Create gel instance and set operators.</span></div>
<div class="line"><span class="lineno">  478</span>  {</div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span>    gel.constitutiveEquationPtr = boost::shared_ptr&lt;UserGelConstitutiveEquation&lt;adouble&gt; &gt;(</div>
<div class="line"><span class="lineno">  481</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_user_gel_constitutive_equation.html">UserGelConstitutiveEquation&lt;adouble&gt;</a>(gel.blockMaterialData)</div>
<div class="line"><span class="lineno">  482</span>    );</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">// Set name of fields which has been choose to approximate spatial</span></div>
<div class="line"><span class="lineno">  485</span>    <span class="comment">// displacements, solvent concentration and internal state variables.</span></div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_common_data.html">Gel::CommonData</a> &amp;common_data = gel.commonData;</div>
<div class="line"><span class="lineno">  487</span>    common_data.<a class="code hl_variable" href="struct_gel_module_1_1_gel_1_1_common_data.html#a0dd3e4c520282a3166b59d54ad64edf0">spatialPositionName</a> = <span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>;</div>
<div class="line"><span class="lineno">  488</span>    common_data.spatialPositionNameDot = <span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>;</div>
<div class="line"><span class="lineno">  489</span>    common_data.muName = <span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>;</div>
<div class="line"><span class="lineno">  490</span>    common_data.muNameDot = <span class="stringliteral">&quot;CHEMICAL_LOAD_DOT&quot;</span>;</div>
<div class="line"><span class="lineno">  491</span>    common_data.strainHatName = <span class="stringliteral">&quot;HAT_EPS&quot;</span>;</div>
<div class="line"><span class="lineno">  492</span>    common_data.strainHatNameDot = <span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>;</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    <span class="comment">// Set operators to calculate field values at integration points, both for</span></div>
<div class="line"><span class="lineno">  495</span>    <span class="comment">// left and right hand side elements.</span></div>
<div class="line"><span class="lineno">  496</span>    <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_gel_f_e.html">Gel::GelFE</a> *fe_ptr[] = { &amp;gel.feRhs, &amp;gel.feLhs };</div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ss = 0;ss&lt;2;ss++) {</div>
<div class="line"><span class="lineno">  498</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *fe_ptr[ss], <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line"><span class="lineno">  499</span>                         <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  500</span>      CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  501</span>      fe_ptr[ss]-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">getOpPtrVector</a>().push_back(</div>
<div class="line"><span class="lineno">  502</span>        <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts.html">Gel::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,common_data,<span class="keyword">false</span>,<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  503</span>      );</div>
<div class="line"><span class="lineno">  504</span>      fe_ptr[ss]-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">getOpPtrVector</a>().push_back(</div>
<div class="line"><span class="lineno">  505</span>        <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts.html">Gel::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;SPATIAL_POSITION_DOT&quot;</span>,common_data,<span class="keyword">false</span>,<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  506</span>      );</div>
<div class="line"><span class="lineno">  507</span>      fe_ptr[ss]-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">getOpPtrVector</a>().push_back(</div>
<div class="line"><span class="lineno">  508</span>        <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts.html">Gel::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,common_data,<span class="keyword">true</span>,<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  509</span>      );</div>
<div class="line"><span class="lineno">  510</span>      fe_ptr[ss]-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">getOpPtrVector</a>().push_back(</div>
<div class="line"><span class="lineno">  511</span>        <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts.html">Gel::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;HAT_EPS&quot;</span>,common_data,<span class="keyword">true</span>,<span class="keyword">false</span>,MBTET)</div>
<div class="line"><span class="lineno">  512</span>      );</div>
<div class="line"><span class="lineno">  513</span>      fe_ptr[ss]-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">getOpPtrVector</a>().push_back(</div>
<div class="line"><span class="lineno">  514</span>        <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts.html">Gel::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;HAT_EPS_DOT&quot;</span>,common_data,<span class="keyword">true</span>,<span class="keyword">false</span>,MBTET)</div>
<div class="line"><span class="lineno">  515</span>      );</div>
<div class="line"><span class="lineno">  516</span>    }</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="comment">// Right hand side operators</span></div>
<div class="line"><span class="lineno">  520</span>    gel.feRhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  521</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_jacobian.html">Gel::OpJacobian</a>(</div>
<div class="line"><span class="lineno">  522</span>        <span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,tags,gel.constitutiveEquationPtr,gel.commonData,<span class="keyword">true</span>,<span class="keyword">false</span></div>
<div class="line"><span class="lineno">  523</span>      )</div>
<div class="line"><span class="lineno">  524</span>    );</div>
<div class="line"><span class="lineno">  525</span>    gel.feRhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  526</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_rhs_stress_total.html">Gel::OpRhsStressTotal</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  527</span>    );</div>
<div class="line"><span class="lineno">  528</span>    gel.feRhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  529</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_rhs_solvent_flux.html">Gel::OpRhsSolventFlux</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  530</span>    );</div>
<div class="line"><span class="lineno">  531</span>    gel.feRhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  532</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_rhs_solvent_concetration_dot.html">Gel::OpRhsSolventConcetrationDot</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  533</span>    );</div>
<div class="line"><span class="lineno">  534</span>    gel.feRhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  535</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_rhs_strain_hat.html">Gel::OpRhsStrainHat</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  536</span>    );</div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>    <span class="comment">// Left hand side operators</span></div>
<div class="line"><span class="lineno">  539</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  540</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_jacobian.html">Gel::OpJacobian</a>(</div>
<div class="line"><span class="lineno">  541</span>        <span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,tags,gel.constitutiveEquationPtr,gel.commonData,<span class="keyword">false</span>,<span class="keyword">true</span></div>
<div class="line"><span class="lineno">  542</span>      )</div>
<div class="line"><span class="lineno">  543</span>    );</div>
<div class="line"><span class="lineno">  544</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  545</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsdxdx.html">Gel::OpLhsdxdx</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  546</span>    );</div>
<div class="line"><span class="lineno">  547</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  548</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsdxd_mu.html">Gel::OpLhsdxdMu</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  549</span>    );</div>
<div class="line"><span class="lineno">  550</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  551</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsdxd_strain_hat.html">Gel::OpLhsdxdStrainHat</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  552</span>    );</div>
<div class="line"><span class="lineno">  553</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  554</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsd_strain_hatd_strain_hat.html">Gel::OpLhsdStrainHatdStrainHat</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  555</span>    );</div>
<div class="line"><span class="lineno">  556</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  557</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsd_strain_hatdx.html">Gel::OpLhsdStrainHatdx</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  558</span>    );</div>
<div class="line"><span class="lineno">  559</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  560</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsd_mud_mu.html">Gel::OpLhsdMudMu</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  561</span>    );</div>
<div class="line"><span class="lineno">  562</span>    gel.feLhs.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  563</span>      <span class="keyword">new</span> <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_op_lhsd_mudx.html">Gel::OpLhsdMudx</a>(gel.commonData)</div>
<div class="line"><span class="lineno">  564</span>    );</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>  }</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span>  <span class="comment">// Create discrete manager instance</span></div>
<div class="line"><span class="lineno">  569</span>  DM dm;</div>
<div class="line"><span class="lineno">  570</span>  DMType dm_name = <span class="stringliteral">&quot;DMGEL&quot;</span>;</div>
<div class="line"><span class="lineno">  571</span>  {</div>
<div class="line"><span class="lineno">  572</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  573</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = DMCreate(PETSC_COMM_WORLD,&amp;dm);CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  574</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = DMSetType(dm,dm_name);CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  575</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(dm,&amp;m_field,dm_name,bit_level0); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  576</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = DMSetFromOptions(dm); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">//add elements to dm</span></div>
<div class="line"><span class="lineno">  578</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm,<span class="stringliteral">&quot;GEL_FE&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  579</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm,<span class="stringliteral">&quot;FORCE_FE&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  580</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm,<span class="stringliteral">&quot;PRESSURE_FE&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  581</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm,<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  582</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = DMSetUp(dm); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  583</span>  }</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>  <span class="comment">// Create matrices and vectors used for analysis</span></div>
<div class="line"><span class="lineno">  586</span>  <a class="code hl_typedef" href="namespace_eigen_matrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code hl_variable" href="mixed__reac__diff_8cpp.html#aee9271065c005ea3392646a1151202c8">T</a>,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line"><span class="lineno">  587</span>  Mat <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line"><span class="lineno">  588</span>  {</div>
<div class="line"><span class="lineno">  589</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gad39405cdec4e369e9a14c330456cd541">DMCreateGlobalVector_MoFEM</a>(dm,&amp;T); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  590</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = VecDuplicate(T,&amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  591</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga7ceaaf7c6121bf86a998297a44647afe">DMCreateMatrix_MoFEM</a>(dm,&amp;A); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  592</span>  }</div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span>  <span class="comment">// Setting finite element methods for Dirichelt boundary conditions</span></div>
<div class="line"><span class="lineno">  595</span>  <a class="code hl_variable" href="_dirichlet_b_c_8hpp.html#aeb7e90b5e0887f91840668f047686626">SpatialPositionsBCFEMethodPreAndPostProc</a> spatial_position_bc(</div>
<div class="line"><span class="lineno">  596</span>    m_field,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>,A,T,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div>
<div class="line"><span class="lineno">  597</span>  );</div>
<div class="line"><span class="lineno">  598</span>  spatial_position_bc.methodsOp.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_time_force_scale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_displacements_history&quot;</span>,<span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  599</span>  <a class="code hl_variable" href="_dirichlet_b_c_8hpp.html#a94df81558c6ad598dd97c002b6b7386d">DirichletBCFromBlockSetFEMethodPreAndPostProc</a> concentration_bc(</div>
<div class="line"><span class="lineno">  600</span>    m_field,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,A,T,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div>
<div class="line"><span class="lineno">  601</span>  );</div>
<div class="line"><span class="lineno">  602</span>  concentration_bc.methodsOp.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_time_force_scale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_chemical_load_history&quot;</span>,<span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <span class="comment">// Setting finite element method for applying tractions</span></div>
<div class="line"><span class="lineno">  605</span>  boost::ptr_map&lt;string,NeummanForcesSurface&gt; neumann_forces;</div>
<div class="line"><span class="lineno">  606</span>  boost::ptr_map&lt;string,NodalForce&gt; nodal_forces;</div>
<div class="line"><span class="lineno">  607</span>  boost::ptr_map&lt;string,EdgeForce&gt; edge_forces;</div>
<div class="line"><span class="lineno">  608</span>  {</div>
<div class="line"><span class="lineno">  609</span>    <span class="comment">//forces and pressures on surface</span></div>
<div class="line"><span class="lineno">  610</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = MetaNeummanForces::setMomentumFluxOperators(m_field,neumann_forces,PETSC_NULL,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  611</span>    <span class="comment">//noadl forces</span></div>
<div class="line"><span class="lineno">  612</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="struct_meta_nodal_forces.html#a84ba4b4c66e9df18c139cb81808cadc2">MetaNodalForces::setOperators</a>(m_field,nodal_forces,PETSC_NULL,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  613</span>    <span class="comment">//edge forces</span></div>
<div class="line"><span class="lineno">  614</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="struct_meta_edge_forces.html#a46625c9571b0469a5c4a7aa1c8f6c272">MetaEdgeForces::setOperators</a>(m_field,edge_forces,PETSC_NULL,<span class="stringliteral">&quot;SPATIAL_POSITION&quot;</span>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">for</span>(</div>
<div class="line"><span class="lineno">  616</span>      boost::ptr_map&lt;string,NeummanForcesSurface&gt;::iterator mit = neumann_forces.begin();</div>
<div class="line"><span class="lineno">  617</span>      mit!=neumann_forces.end();mit++</div>
<div class="line"><span class="lineno">  618</span>    ) {</div>
<div class="line"><span class="lineno">  619</span>      mit-&gt;second-&gt;methodsOp.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_time_force_scale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>,<span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  620</span>    }</div>
<div class="line"><span class="lineno">  621</span>    <span class="keywordflow">for</span>(</div>
<div class="line"><span class="lineno">  622</span>      boost::ptr_map&lt;string,NodalForce&gt;::iterator mit = nodal_forces.begin();</div>
<div class="line"><span class="lineno">  623</span>      mit!=nodal_forces.end();mit++</div>
<div class="line"><span class="lineno">  624</span>    ) {</div>
<div class="line"><span class="lineno">  625</span>      mit-&gt;second-&gt;methodsOp.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_time_force_scale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>,<span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  626</span>    }</div>
<div class="line"><span class="lineno">  627</span>    <span class="keywordflow">for</span>(</div>
<div class="line"><span class="lineno">  628</span>      boost::ptr_map&lt;string,EdgeForce&gt;::iterator mit = edge_forces.begin();</div>
<div class="line"><span class="lineno">  629</span>      mit!=edge_forces.end();mit++</div>
<div class="line"><span class="lineno">  630</span>    ) {</div>
<div class="line"><span class="lineno">  631</span>      mit-&gt;second-&gt;methodsOp.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_time_force_scale.html">TimeForceScale</a>(<span class="stringliteral">&quot;-my_load_history&quot;</span>,<span class="keyword">false</span>));</div>
<div class="line"><span class="lineno">  632</span>    }</div>
<div class="line"><span class="lineno">  633</span>  }</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="comment">// Solvent surface element, flux, convection radiation</span></div>
<div class="line"><span class="lineno">  636</span>  <span class="comment">// TODO: add radiation and convection</span></div>
<div class="line"><span class="lineno">  637</span>  <a class="code hl_struct" href="struct_thermal_element_1_1_my_tri_f_e.html">ThermalElement::MyTriFE</a> solvent_surface_fe(m_field);</div>
<div class="line"><span class="lineno">  638</span>  {</div>
<div class="line"><span class="lineno">  639</span>    map&lt;int,ThermalElement::FluxData&gt;::iterator sit = set_of_solvent_fluxes.begin();</div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">for</span>(;sit!=set_of_solvent_fluxes.end();sit++) {</div>
<div class="line"><span class="lineno">  641</span>      <span class="comment">// add flux operator</span></div>
<div class="line"><span class="lineno">  642</span>      solvent_surface_fe.getOpPtrVector().push_back(</div>
<div class="line"><span class="lineno">  643</span>        <span class="keyword">new</span> <a class="code hl_struct" href="struct_thermal_element_1_1_op_heat_flux.html">ThermalElement::OpHeatFlux</a>(<span class="stringliteral">&quot;CHEMICAL_LOAD&quot;</span>,PETSC_NULL,sit-&gt;second,<span class="keyword">true</span>)</div>
<div class="line"><span class="lineno">  644</span>      );</div>
<div class="line"><span class="lineno">  645</span>    }</div>
<div class="line"><span class="lineno">  646</span>  }</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>  <span class="comment">// Add finite elements to Time Stepping Solver, using Discrete Manager Interface</span></div>
<div class="line"><span class="lineno">  649</span>  {</div>
<div class="line"><span class="lineno">  650</span>    <span class="comment">//Rhs</span></div>
<div class="line"><span class="lineno">  651</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,&amp;spatial_position_bc,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  652</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,&amp;concentration_bc,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  653</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,<span class="stringliteral">&quot;GEL_FE&quot;</span>,&amp;gel.feRhs,NULL,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  654</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,<span class="stringliteral">&quot;CHEMICAL_LOAD_FLUX_FE&quot;</span>,&amp;solvent_surface_fe,NULL,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  655</span>    {</div>
<div class="line"><span class="lineno">  656</span>      boost::ptr_map&lt;string,NeummanForcesSurface&gt;::iterator mit = neumann_forces.begin();</div>
<div class="line"><span class="lineno">  657</span>      <span class="keywordflow">for</span>(;mit!=neumann_forces.end();mit++) {</div>
<div class="line"><span class="lineno">  658</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,mit-&gt;first.c_str(),&amp;mit-&gt;second-&gt;getLoopFe(),NULL,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  659</span>      }</div>
<div class="line"><span class="lineno">  660</span>    }</div>
<div class="line"><span class="lineno">  661</span>    {</div>
<div class="line"><span class="lineno">  662</span>      boost::ptr_map&lt;string,NodalForce&gt;::iterator fit = nodal_forces.begin();</div>
<div class="line"><span class="lineno">  663</span>      <span class="keywordflow">for</span>(;fit!=nodal_forces.end();fit++) {</div>
<div class="line"><span class="lineno">  664</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,fit-&gt;first.c_str(),&amp;fit-&gt;second-&gt;getLoopFe(),NULL,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  665</span>      }</div>
<div class="line"><span class="lineno">  666</span>    }</div>
<div class="line"><span class="lineno">  667</span>    {</div>
<div class="line"><span class="lineno">  668</span>      boost::ptr_map&lt;string,EdgeForce&gt;::iterator fit = edge_forces.begin();</div>
<div class="line"><span class="lineno">  669</span>      <span class="keywordflow">for</span>(;fit!=edge_forces.end();fit++) {</div>
<div class="line"><span class="lineno">  670</span>        <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,fit-&gt;first.c_str(),&amp;fit-&gt;second-&gt;getLoopFe(),NULL,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  671</span>      }</div>
<div class="line"><span class="lineno">  672</span>    }</div>
<div class="line"><span class="lineno">  673</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,NULL,&amp;spatial_position_bc); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  674</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,NULL,&amp;concentration_bc); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>    <span class="comment">//Lhs</span></div>
<div class="line"><span class="lineno">  677</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,&amp;spatial_position_bc,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  678</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,&amp;concentration_bc,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  679</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm,<span class="stringliteral">&quot;GEL_FE&quot;</span>,&amp;gel.feLhs,NULL,NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  680</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,NULL,&amp;spatial_position_bc); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  681</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,NULL,&amp;concentration_bc); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>  }</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>  <span class="comment">// Create Time Stepping solver</span></div>
<div class="line"><span class="lineno">  687</span>  TS ts;</div>
<div class="line"><span class="lineno">  688</span>  {</div>
<div class="line"><span class="lineno">  689</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSCreate(PETSC_COMM_WORLD,&amp;ts); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  690</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetType(ts,TSBEULER); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  691</span>  }</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>  {</div>
<div class="line"><span class="lineno">  694</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm,T,INSERT_VALUES,SCATTER_FORWARD); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  695</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dm,&amp;spatial_position_bc); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  696</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dm,&amp;concentration_bc); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  697</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="group__dm.html#gad94692d0472b346672a25c63e91fb930">DMoFEMMeshToGlobalVector</a>(dm,T,INSERT_VALUES,SCATTER_REVERSE); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  698</span>  }</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>  <span class="comment">// Solve problem</span></div>
<div class="line"><span class="lineno">  701</span>  {</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetIFunction(ts,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,PETSC_NULL,PETSC_NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  704</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetIJacobian(ts,A,A,PETSC_NULL,PETSC_NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <span class="comment">//Monitor</span></div>
<div class="line"><span class="lineno">  707</span>    <a class="code hl_struct" href="struct_gel_module_1_1_gel_1_1_monitor_post_proc.html">Gel::MonitorPostProc</a> post_proc(</div>
<div class="line"><span class="lineno">  708</span>      m_field,<span class="stringliteral">&quot;DMGEL&quot;</span>,<span class="stringliteral">&quot;GEL_FE&quot;</span>,gel.commonData,gel.constitutiveEquationPtr,tags</div>
<div class="line"><span class="lineno">  709</span>    );</div>
<div class="line"><span class="lineno">  710</span>    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_ts_ctx.html">TsCtx</a> *<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>;</div>
<div class="line"><span class="lineno">  711</span>    <a class="code hl_function" href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">DMMoFEMGetTsCtx</a>(dm,&amp;<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line"><span class="lineno">  712</span>    {</div>
<div class="line"><span class="lineno">  713</span>      <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>-&gt;get_postProcess_to_do_Monitor().push_back(&amp;post_proc);</div>
<div class="line"><span class="lineno">  714</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSMonitorSet(ts,f_TSMonitorSet,<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>,PETSC_NULL); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  715</span>    }</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line"><span class="lineno">  718</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetDuration(ts,PETSC_DEFAULT,ftime); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  719</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetFromOptions(ts); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  720</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetDM(ts,dm); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  721</span><span class="preprocessor">    #if PETSC_VERSION_GE(3,7,0)</span></div>
<div class="line"><span class="lineno">  722</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetExactFinalTime(ts,TS_EXACTFINALTIME_STEPOVER); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  723</span><span class="preprocessor">    #endif</span></div>
<div class="line"><span class="lineno">  724</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSolve(ts,T); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  725</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSGetTime(ts,&amp;ftime); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  726</span>    PetscInt steps,snesfails,rejects,nonlinits,linits;</div>
<div class="line"><span class="lineno">  727</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSGetTimeStepNumber(ts,&amp;steps); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  728</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSGetSNESFailures(ts,&amp;snesfails); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  729</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSGetStepRejections(ts,&amp;rejects); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  730</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSGetSNESIterations(ts,&amp;nonlinits); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  731</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSGetKSPIterations(ts,&amp;linits); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  732</span>    PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><span class="lineno">  733</span>      <span class="stringliteral">&quot;steps %D (%D rejected, %D SNES fails), ftime %g, nonlinits %D, linits %D\n&quot;</span>,</div>
<div class="line"><span class="lineno">  734</span>      steps,rejects,snesfails,ftime,nonlinits,linits</div>
<div class="line"><span class="lineno">  735</span>    );</div>
<div class="line"><span class="lineno">  736</span>  }</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>  <span class="keywordflow">if</span>(is_atom_test) {</div>
<div class="line"><span class="lineno">  739</span>    <span class="keywordtype">double</span> sum = 0;</div>
<div class="line"><span class="lineno">  740</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = VecSum(T,&amp;sum); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  741</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;sum  = %9.8e\n&quot;</span>,sum); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordtype">double</span> fnorm;</div>
<div class="line"><span class="lineno">  743</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = VecNorm(T,NORM_2,&amp;fnorm); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  744</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscPrintf(PETSC_COMM_WORLD,<span class="stringliteral">&quot;fnorm  = %9.8e\n&quot;</span>,fnorm); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> (fabs(sum - 6.82084809e+01) &gt; 1e-6) {</div>
<div class="line"><span class="lineno">  747</span>      SETERRQ(PETSC_COMM_WORLD,<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,<span class="stringliteral">&quot;Failed to pass test&quot;</span>);</div>
<div class="line"><span class="lineno">  748</span>    }</div>
<div class="line"><span class="lineno">  749</span>    <span class="keywordflow">if</span> (fabs(fnorm - 3.66184607e+01) &gt; 1e-6) {</div>
<div class="line"><span class="lineno">  750</span>      SETERRQ(PETSC_COMM_WORLD,<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,<span class="stringliteral">&quot;Failed to pass test&quot;</span>);</div>
<div class="line"><span class="lineno">  751</span>    }</div>
<div class="line"><span class="lineno">  752</span>  }</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>  <span class="comment">// Clean and destroy</span></div>
<div class="line"><span class="lineno">  755</span>  {</div>
<div class="line"><span class="lineno">  756</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = DMDestroy(&amp;dm); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  757</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = VecDestroy(&amp;T); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  758</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = VecDestroy(&amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  759</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = MatDestroy(&amp;A); CHKERRQ(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><span class="lineno">  760</span>    <span class="comment">//ierr = TSDestroy(&amp;ts); CHKERRQ(ierr);</span></div>
<div class="line"><span class="lineno">  761</span>  }</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>  }</div>
<div class="line"><span class="lineno">  764</span>  <a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  769</span>}</div>
<div class="ttc" id="a_d_m_mo_f_e_m_8hpp_html_a8643d43312bdd9afb90733cfdcc77cf9"><div class="ttname"><a href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a></div><div class="ttdeci">#define DM_NO_ELEMENT</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l00010">DMMoFEM.hpp:10</a></div></div>
<div class="ttc" id="a_dirichlet_b_c_8hpp_html_a94df81558c6ad598dd97c002b6b7386d"><div class="ttname"><a href="_dirichlet_b_c_8hpp.html#a94df81558c6ad598dd97c002b6b7386d">DirichletBCFromBlockSetFEMethodPreAndPostProc</a></div><div class="ttdeci">DEPRECATED typedef DirichletSetFieldFromBlockWithFlags DirichletBCFromBlockSetFEMethodPreAndPostProc</div><div class="ttdef"><b>Definition:</b> <a href="_dirichlet_b_c_8hpp_source.html#l00381">DirichletBC.hpp:381</a></div></div>
<div class="ttc" id="a_dirichlet_b_c_8hpp_html_aeb7e90b5e0887f91840668f047686626"><div class="ttname"><a href="_dirichlet_b_c_8hpp.html#aeb7e90b5e0887f91840668f047686626">SpatialPositionsBCFEMethodPreAndPostProc</a></div><div class="ttdeci">DEPRECATED typedef DirichletSpatialPositionsBc SpatialPositionsBCFEMethodPreAndPostProc</div><div class="ttdef"><b>Definition:</b> <a href="_dirichlet_b_c_8hpp_source.html#l00237">DirichletBC.hpp:237</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00372">definitions.h:372</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00098">definitions.h:98</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00215">definitions.h:215</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00148">definitions.h:148</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a8442924ad14c1689310f457dd0e75937"><div class="ttname"><a href="definitions_8h.html#a8442924ad14c1689310f457dd0e75937">CHKERRQ_MOAB</a></div><div class="ttdeci">#define CHKERRQ_MOAB(a)</div><div class="ttdoc">check error code of MoAB function</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00454">definitions.h:454</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea8f04bede6073e008cc179c0dd77948ec">MOFEM_STD_EXCEPTION_THROW</a></div><div class="ttdeci">@ MOFEM_STD_EXCEPTION_THROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00039">definitions.h:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="agel__analysis_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="gel__analysis_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="gel__analysis_8cpp_source.html#l00072">gel_analysis.cpp:72</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00483">DMMoFEM.cpp:483</a></div></div>
<div class="ttc" id="agroup__dm_html_ga286b3dbf0959ea028035e1d808a9403a"><div class="ttname"><a href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">MoFEM::DMMoFEMTSSetIFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00786">DMMoFEM.cpp:786</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00118">DMMoFEM.cpp:118</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00509">DMMoFEM.cpp:509</a></div></div>
<div class="ttc" id="agroup__dm_html_ga7ceaaf7c6121bf86a998297a44647afe"><div class="ttname"><a href="group__dm.html#ga7ceaaf7c6121bf86a998297a44647afe">MoFEM::DMCreateMatrix_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMCreateMatrix_MoFEM(DM dm, Mat *M)</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01183">DMMoFEM.cpp:1183</a></div></div>
<div class="ttc" id="agroup__dm_html_ga81d1702e6a5cbe505aa79e94c4aa9d74"><div class="ttname"><a href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">MoFEM::DMMoFEMGetTsCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetTsCtx(DM dm, MoFEM::TsCtx **ts_ctx)</div><div class="ttdoc">get MoFEM::TsCtx data structure</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01128">DMMoFEM.cpp:1128</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00047">DMMoFEM.cpp:47</a></div></div>
<div class="ttc" id="agroup__dm_html_gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3"><div class="ttname"><a href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">MoFEM::DMMoFEMTSSetIJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIJacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00839">DMMoFEM.cpp:839</a></div></div>
<div class="ttc" id="agroup__dm_html_gad39405cdec4e369e9a14c330456cd541"><div class="ttname"><a href="group__dm.html#gad39405cdec4e369e9a14c330456cd541">MoFEM::DMCreateGlobalVector_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMCreateGlobalVector_MoFEM(DM dm, Vec *g)</div><div class="ttdoc">DMShellSetCreateGlobalVector.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01153">DMMoFEM.cpp:1153</a></div></div>
<div class="ttc" id="agroup__dm_html_gad94692d0472b346672a25c63e91fb930"><div class="ttname"><a href="group__dm.html#gad94692d0472b346672a25c63e91fb930">MoFEM::DMoFEMMeshToGlobalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToGlobalVector(DM dm, Vec g, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set ghosted vector values on all existing mesh entities</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00521">DMMoFEM.cpp:521</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00532">DMMoFEM.cpp:532</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8b068eced1fd720631edcaea59289a15"><div class="ttname"><a href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">MoFEM::CoreInterface::add_ents_to_finite_element_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_type(const EntityHandle entities, const EntityType type, const std::string &amp;name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaa2337ef6cebd2ecb83e4c3eb5e5e1090"><div class="ttname"><a href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_filed)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__field_html_gaa584a5c9cc28f5ae0a7088d130683be8"><div class="ttname"><a href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">MoFEM::CoreInterface::add_ents_to_field_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_type(const Range &amp;ents, const EntityType type, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__field_html_gad43a6631f7d465ad31403cbb1d1896ba"><div class="ttname"><a href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">MoFEM::CoreInterface::check_field</a></div><div class="ttdeci">virtual bool check_field(const std::string &amp;name) const =0</div><div class="ttdoc">check if field is in database</div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="_meshsets_manager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition:</b> <a href="level__set_8cpp_source.html#l01884">level_set.cpp:1884</a></div></div>
<div class="ttc" id="amesh__smoothing_8cpp_html_ae20b66af13b03d8e8a4593186c23cd07"><div class="ttname"><a href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a></div><div class="ttdeci">char mesh_file_name[255]</div><div class="ttdef"><b>Definition:</b> <a href="mesh__smoothing_8cpp_source.html#l00023">mesh_smoothing.cpp:23</a></div></div>
<div class="ttc" id="amixed__reac__diff_8cpp_html_aee9271065c005ea3392646a1151202c8"><div class="ttname"><a href="mixed__reac__diff_8cpp.html#aee9271065c005ea3392646a1151202c8">T</a></div><div class="ttdeci">const double T</div><div class="ttdef"><b>Definition:</b> <a href="mixed__reac__diff_8cpp_source.html#l00158">mixed_reac_diff.cpp:158</a></div></div>
<div class="ttc" id="anamespace_eigen_matrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespace_eigen_matrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_function_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a6ffd47b9e0afb9f78ad9e88ca71e65a7"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">MoFEM::Exceptions::rval</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; moab::ErrorCode &gt; rval</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00074">Exceptions.hpp:74</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespace_mo_f_e_m.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition:</b> <a href="_h_o_data_operators_8hpp_source.html#l00754">HODataOperators.hpp:754</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_common_data_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_common_data.html">GelModule::Gel::CommonData</a></div><div class="ttdoc">Common data for gel model.</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00345">Gels.hpp:345</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_common_data_html_a0dd3e4c520282a3166b59d54ad64edf0"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_common_data.html#a0dd3e4c520282a3166b59d54ad64edf0">GelModule::Gel::CommonData::spatialPositionName</a></div><div class="ttdeci">string spatialPositionName</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00347">Gels.hpp:347</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_gel_f_e_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_gel_f_e.html">GelModule::Gel::GelFE</a></div><div class="ttdoc">definition of volume element</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00379">Gels.hpp:379</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_monitor_post_proc_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_monitor_post_proc.html">GelModule::Gel::MonitorPostProc</a></div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l02038">Gels.hpp:2038</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_get_data_at_gauss_pts.html">GelModule::Gel::OpGetDataAtGaussPts</a></div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00444">Gels.hpp:444</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_jacobian_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_jacobian.html">GelModule::Gel::OpJacobian</a></div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00541">Gels.hpp:541</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsd_mud_mu_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsd_mud_mu.html">GelModule::Gel::OpLhsdMudMu</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01815">Gels.hpp:1815</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsd_mudx_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsd_mudx.html">GelModule::Gel::OpLhsdMudx</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01895">Gels.hpp:1895</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsd_strain_hatd_strain_hat_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsd_strain_hatd_strain_hat.html">GelModule::Gel::OpLhsdStrainHatdStrainHat</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01650">Gels.hpp:1650</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsd_strain_hatdx_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsd_strain_hatdx.html">GelModule::Gel::OpLhsdStrainHatdx</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01729">Gels.hpp:1729</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsdxd_mu_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsdxd_mu.html">GelModule::Gel::OpLhsdxdMu</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01482">Gels.hpp:1482</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsdxd_strain_hat_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsdxd_strain_hat.html">GelModule::Gel::OpLhsdxdStrainHat</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01562">Gels.hpp:1562</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_lhsdxdx_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_lhsdxdx.html">GelModule::Gel::OpLhsdxdx</a></div><div class="ttdoc">Assemble matrix .</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01390">Gels.hpp:1390</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_rhs_solvent_concetration_dot_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_rhs_solvent_concetration_dot.html">GelModule::Gel::OpRhsSolventConcetrationDot</a></div><div class="ttdoc">Calculating right hand side.</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01254">Gels.hpp:1254</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_rhs_solvent_flux_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_rhs_solvent_flux.html">GelModule::Gel::OpRhsSolventFlux</a></div><div class="ttdoc">Calculate internal forces for solvent flux.</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01205">Gels.hpp:1205</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_rhs_strain_hat_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_rhs_strain_hat.html">GelModule::Gel::OpRhsStrainHat</a></div><div class="ttdoc">Residual strain hat.</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01302">Gels.hpp:1302</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_1_1_op_rhs_stress_total_html"><div class="ttname"><a href="struct_gel_module_1_1_gel_1_1_op_rhs_stress_total.html">GelModule::Gel::OpRhsStressTotal</a></div><div class="ttdoc">Assemble internal force vector.</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l01154">Gels.hpp:1154</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_html"><div class="ttname"><a href="struct_gel_module_1_1_gel.html">GelModule::Gel</a></div><div class="ttdoc">Implementation of Gel constitutive model.</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00074">Gels.hpp:74</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_html_a8331f363d64a1e152b7d47c73005d1efa07588422ebef3bad03013e12e48945f8"><div class="ttname"><a href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efa07588422ebef3bad03013e12e48945f8">GelModule::Gel::SOLVENTRATE</a></div><div class="ttdeci">@ SOLVENTRATE</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00079">Gels.hpp:79</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_html_a8331f363d64a1e152b7d47c73005d1efa1d3f203bb4da9c23ac713503e939c054"><div class="ttname"><a href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efa1d3f203bb4da9c23ac713503e939c054">GelModule::Gel::RESIDUALSTRAINHAT</a></div><div class="ttdeci">@ RESIDUALSTRAINHAT</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00081">Gels.hpp:80</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_html_a8331f363d64a1e152b7d47c73005d1efa233337574cabf9b2dd37e8e2b2a68cf8"><div class="ttname"><a href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efa233337574cabf9b2dd37e8e2b2a68cf8">GelModule::Gel::STRESSTOTAL</a></div><div class="ttdeci">@ STRESSTOTAL</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00077">Gels.hpp:77</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_gel_html_a8331f363d64a1e152b7d47c73005d1efaca12bba3fa5f0c2ee78243b1acb98fb7"><div class="ttname"><a href="struct_gel_module_1_1_gel.html#a8331f363d64a1e152b7d47c73005d1efaca12bba3fa5f0c2ee78243b1acb98fb7">GelModule::Gel::SOLVENTFLUX</a></div><div class="ttdeci">@ SOLVENTFLUX</div><div class="ttdef"><b>Definition:</b> <a href="_gels_8hpp_source.html#l00078">Gels.hpp:78</a></div></div>
<div class="ttc" id="astruct_gel_module_1_1_user_gel_constitutive_equation_html"><div class="ttname"><a href="struct_gel_module_1_1_user_gel_constitutive_equation.html">GelModule::UserGelConstitutiveEquation</a></div><div class="ttdoc">User (hackable) Gel model.</div><div class="ttdef"><b>Definition:</b> <a href="_user_gel_model_8hpp_source.html#l00039">UserGelModel.hpp:39</a></div></div>
<div class="ttc" id="astruct_meta_edge_forces_html_a46625c9571b0469a5c4a7aa1c8f6c272"><div class="ttname"><a href="struct_meta_edge_forces.html#a46625c9571b0469a5c4a7aa1c8f6c272">MetaEdgeForces::setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, EdgeForce &gt; &amp;edge_forces, Vec F, const std::string field_name, std::string mesh_node_positions=&quot;MESH_NODE_POSITIONS&quot;)</div><div class="ttdoc">Set integration point operators.</div><div class="ttdef"><b>Definition:</b> <a href="_edge_force_8hpp_source.html#l00097">EdgeForce.hpp:97</a></div></div>
<div class="ttc" id="astruct_meta_edge_forces_html_ad4ba172a5f79e0c41430c6dcecdd95f8"><div class="ttname"><a href="struct_meta_edge_forces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition:</b> <a href="_edge_force_8hpp_source.html#l00062">EdgeForce.hpp:62</a></div></div>
<div class="ttc" id="astruct_meta_nodal_forces_html_a84ba4b4c66e9df18c139cb81808cadc2"><div class="ttname"><a href="struct_meta_nodal_forces.html#a84ba4b4c66e9df18c139cb81808cadc2">MetaNodalForces::setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(MoFEM::Interface &amp;m_field, boost::ptr_map&lt; std::string, NodalForce &gt; &amp;nodal_forces, Vec F, const std::string field_name)</div><div class="ttdoc">Set integration point operators.</div><div class="ttdef"><b>Definition:</b> <a href="_nodal_force_8hpp_source.html#l00128">NodalForce.hpp:128</a></div></div>
<div class="ttc" id="astruct_meta_nodal_forces_html_a8e0b96853208e8320b7268f96f4fd8ee"><div class="ttname"><a href="struct_meta_nodal_forces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition:</b> <a href="_nodal_force_8hpp_source.html#l00092">NodalForce.hpp:92</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_ad0ad06f9662a225c2d5b5570e15d083d"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#ad0ad06f9662a225c2d5b5570e15d083d">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string &amp;name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html_a4ff0811a785a91df31f0aeed637a34d8"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#a4ff0811a785a91df31f0aeed637a34d8">MoFEM::DeprecatedCoreInterface::synchronise_entities</a></div><div class="ttdeci">DEPRECATED MoFEMErrorCode synchronise_entities(Range &amp;ent, int verb=DEFAULT_VERBOSITY)</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_core_interface_8cpp_source.html#l00041">DeprecatedCoreInterface.cpp:41</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html_ac30fe9bd2cd5d13d375097927a783c43"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html#ac30fe9bd2cd5d13d375097927a783c43">MoFEM::DeprecatedCoreInterface::seed_ref_level_3D</a></div><div class="ttdeci">DEPRECATED MoFEMErrorCode seed_ref_level_3D(const EntityHandle meshset, const BitRefLevel &amp;bit, int verb=-1)</div><div class="ttdoc">seed 2D entities in the meshset and their adjacencies (only TETs adjacencies) in a particular BitRefL...</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_core_interface_8cpp_source.html#l00018">DeprecatedCoreInterface.cpp:18</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_html_aba236b9f5892be49d6ae6756b12f5a88"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">MoFEM::ForcesAndSourcesCore::getOpPtrVector</a></div><div class="ttdeci">boost::ptr_deque&lt; UserDataOperator &gt; &amp; getOpPtrVector()</div><div class="ttdoc">Use to push back operator for row operator.</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l00083">ForcesAndSourcesCore.hpp:83</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_projection10_node_coords_on_field_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition:</b> <a href="_projection10_node_coords_on_field_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_ts_ctx_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_ts_ctx.html">MoFEM::TsCtx</a></div><div class="ttdoc">Interface for Time Stepping (TS) solver.</div><div class="ttdef"><b>Definition:</b> <a href="_ts_ctx_8hpp_source.html#l00015">TsCtx.hpp:15</a></div></div>
<div class="ttc" id="astruct_thermal_element_1_1_my_tri_f_e_html"><div class="ttname"><a href="struct_thermal_element_1_1_my_tri_f_e.html">ThermalElement::MyTriFE</a></div><div class="ttdoc">define surface element</div><div class="ttdef"><b>Definition:</b> <a href="_thermal_element_8hpp_source.html#l00060">ThermalElement.hpp:60</a></div></div>
<div class="ttc" id="astruct_thermal_element_1_1_op_heat_flux_html"><div class="ttname"><a href="struct_thermal_element_1_1_op_heat_flux.html">ThermalElement::OpHeatFlux</a></div><div class="ttdoc">operator for calculate heat flux and assemble to right hand side</div><div class="ttdef"><b>Definition:</b> <a href="_thermal_element_8hpp_source.html#l00380">ThermalElement.hpp:381</a></div></div>
<div class="ttc" id="astruct_time_force_scale_html"><div class="ttname"><a href="struct_time_force_scale.html">TimeForceScale</a></div><div class="ttdoc">Force scale operator for reading two columns.</div><div class="ttdef"><b>Definition:</b> <a href="_time_force_scale_8hpp_source.html#l00018">TimeForceScale.hpp:18</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a29680e68c64040f4884f60691a193226" name="a29680e68c64040f4884f60691a193226"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a29680e68c64040f4884f60691a193226">&#9670;&#160;</a></span>help</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">char help[] = &quot;...\n\n&quot;</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="gel__analysis_8cpp_source.html#l00072">72</a> of file <a class="el" href="gel__analysis_8cpp_source.html">gel_analysis.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>