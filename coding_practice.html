<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Coding practice</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Coding practice</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Naming conventions and coding policies and principles in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>.</p>
<h1><a class="anchor" id="mofem_and_user_modules"></a>
MoFEM and User Modules</h1>
<p>All new finite elements or modifications or finite elements are implemented in users modules (UM). In the future it will be always a single version of <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library but many UM forks. UMs are developed independently from <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library repository. How to add user modules see <a class="el" href="faqs.html#adding_user_module">How to add user module?</a></p>
<h1><a class="anchor" id="Making"></a>
Repository Commits</h1>
<p>As a general rule, developers should update frequently, and commit changes often. However, the repository should always remain in a state which allows the code to be compiled. Most of the time, the code should also successfully execute "ctest" run from the top-level directory. If you commit code that violates this principle, it should be your first priority to return the repository code to a compilable state and next to make sure that all tests (ctest) run without errors.</p>
<p>Intermediate development stages should be committed by pull-request to develop branch. The committed code has to compile, and the committer should verify if tests are running successfully.</p>
<p>The finished portion of work should be committed by pull-request to CDashTesting branch. Commits to the CDashTesting branch should also come with a non-trivial, useful, non-verbose log message. It is required that before the pull request user merges the current CDashTesting branch and verify if all tests run without fails. If pull request is accepted it is user responsibility to verify results on CDash server <a href="http://cdash.eng.gla.ac.uk/cdash/">http://cdash.eng.gla.ac.uk/cdash/</a>. The first priority will be to eliminate compilation errors, completion warnings, failed tests, and memory leaks.</p>
<p>Some guidance about branches:</p><ul>
<li>Make often updates (git pull)</li>
<li>Do not commit to other people's branch. You can commit only to branches created by yourself.</li>
<li>If you like to commit to other (not own created) branch you have to do a pull request.</li>
<li>Before marking a pull request, pull from the branch to which you like to commit.</li>
<li>Pull regularly form CDashTesting branch.</li>
<li>If you are working on two different tasks make two different branches. This simplifies code revision.</li>
<li>We have use three major branches, i.e. <em>major</em> branch, <em>CDashTesting</em> branch and <em>develop</em> branch.</li>
<li>User branches should have name as follows <em>john/branch_name</em>, for example <em>lukas/work_on_new_aprox_base</em>.</li>
</ul>
<h1><a class="anchor" id="Source"></a>
Code Style and Best Practices</h1>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> code should follow MoAB code style and best practices listed here <a href="http://www.mcs.anl.gov/~fathom/moab-docs/html/styleguide.html">http://www.mcs.anl.gov/~fathom/moab-docs/html/styleguide.html</a>.</p>
<ul>
<li>Style:</li>
<li>Code formatting style makes code easier to read and follow by other. For that reason, we choose to use LLVM style, i.e. one of the built-in styles offered by clang-format. The motivation for use this style is as follows; is popular, can be set-up in many editors and compact.</li>
<li>Make indentations. Indent code to better convey the logical structure of your code. Without indenting, code becomes difficult to follow. <div class="fragment"><div class="line"><span class="keywordflow">if</span> (...) {</div>
<div class="line"><span class="keywordflow">if</span> (...) {</div>
<div class="line">...</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">...</div>
<div class="line">}} <span class="keywordflow">else</span> <span class="keywordflow">if</span> {</div>
<div class="line">...</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">...</div>
<div class="line">}</div>
</div><!-- fragment --> Can you follow this? This is much better <div class="fragment"><div class="line"><span class="keywordflow">if</span> (...) {</div>
<div class="line">  <span class="keywordflow">if</span> (...) {</div>
<div class="line">    ...</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    ...</div>
<div class="line">  }</div>
<div class="line">} <span class="keywordflow">else</span> <span class="keywordflow">if</span> {</div>
<div class="line">  ...</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  ...</div>
<div class="line">}</div>
</div><!-- fragment --><ul>
<li>Enable syntax highlighting in your text editor.</li>
<li>Break large, complex sections of code into smaller, comprehensible modules (subroutine/functions/methods). A good rule is that modules do not exceed the size of the text editor window.</li>
<li>Indentation should have TWO SPACES. You have to set up your favorite editor to make TWO SPACES for TAB.</li>
<li>Use empty lines to provide organizational clues to source code, blocks (<em>paragraphs</em> -like structure) help the reader in comprehending the logical segmenting.</li>
</ul>
</li>
<li><p class="startli">Types:</p>
<p class="startli">Use types to indicate what it is, and the name of the variable what it is. For example </p><div class="fragment"><div class="line">std::vector&lt;PetscLocalDofIdx&gt; on_boundary;</div>
</div><!-- fragment --><p> In the above one can see that you will be going to have local indices, and the vector will store indices on indices on boundary only.</p>
<p class="startli">An alternative to the example above you can see less informative, but equivalent definition below </p><div class="fragment"><div class="line">std::vector&lt;int&gt; local_petsc_indices_on_boundary;</div>
</div><!-- fragment --><p class="startli">For <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> data types see <a class="el" href="namespaceMoFEM_1_1Types.html">MoFEM::Types</a>.</p>
</li>
<li>Names:<ul>
<li>A name should tell what rather than how, avoid names that expose underlying implementation.</li>
<li>Class names should be in the CamelBack style, e.g. EdgeMesh or VertexMesher.</li>
<li>Class member variables should be camelBack, e.g. EdgeMesh::schemeType; each member variable, e.g. int memberVariable, should have set/get functions void member_variable(int newval) and int member_variable(), respectively</li>
<li>Abstract class members should be abstract_class_member, e.g. set_field_orer()</li>
<li>Enumeration values should be all capitalized, with underscores avoided if possible (the enumeration name indicates the general purpose of the enumeration, so e.g. we use EQUAL, not EQUAL_MESH)</li>
<li>It is advised that names of vectors should start with "v", e.g. VectorDouble v_coordinate_vector; VectorDouble vCoordinateVector, respectively for local variables and class members.</li>
<li>It is advised names of matrices should start with "m", e.g. MatrixDouble m_deformation_gradient; MatrixDouble mDeformationGradient, respectively for local variables and class members.</li>
<li>Use a verb-noun method to name routines that perform some operation-on-a-given-object. Most names are constructed by concatenating several words, use mixed-case formatting or underscore to ease reading. <div class="fragment"><div class="line">calculateKineticEnergy ( . . . )</div>
<div class="line">calculate_kinetic_energy ( . . . )</div>
</div><!-- fragment --> or any other derivatives.</li>
<li>Avoid elusive names, open to subjective interpretation like <br  />
 <div class="fragment"><div class="line">Analyze ( . . . ) / / subroutine or function or method</div>
<div class="line">nnsmcomp1 / / variable</div>
</div><!-- fragment --></li>
<li>Each class header should be fully commented.</li>
<li>A \file comment block at the top of the file; DO NOT include things like Author and Date blocks; this stuff is available from subversion if we really need to know.</li>
<li>Each function in both the public and private interfaces should be commented, INCLUDING ANY ARGUMENTS AND RETURN VALUES. See the MOAB classes for examples of how to format these comments.</li>
<li>Developers should avoid using #include in header files, as they propagate dependencies more widely than necessary.</li>
<li>Local variables and function argument have names with small letters, i.e. temperature_val, nodal_position.</li>
<li>If variable is a pointer, it should have name as follows <div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a> {</div>
<div class="line">  boost::shared_ptr&lt;double&gt; valPtr; <span class="comment">///&lt; class member variable</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> f() {</div>
<div class="line">  boost::shared_ptr&lt;double&gt; val_ptr; <span class="comment">///&lt; local variable\</span></div>
<div class="line">}</div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
</div><!-- fragment --></li>
<li>All <a class="el" href="namespaceFTensor.html" title="Tensors class implemented by Walter Landry.">FTensor</a> variables should be named as follows <div class="fragment"><div class="line"><span class="keyword">class </span><a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a> {</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double,3&gt;</a> tForce; <span class="comment">///&lt; class member variable</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> f() {</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double,3&gt;</a> t_force; <span class="comment">///&lt; local variable</span></div>
<div class="line">}</div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
</div><!-- fragment --></li>
<li>Append/Prepend computation qualifiers like Av, Sum, Min, Max and <a class="el" href="classIndex.html">Index</a> to the end of a variable when appropriate.</li>
<li>If you commit your code remove are depreciated functions names. Use of OLD function name (or old functions arguments) generate compilation warring, f.e. <div class="fragment"><div class="line">In file included from mofem/users_modules/basic_finite_elements/src/impl/DirichletBC.cpp:39:0:</div>
<div class="line">mofem/src/interfaces/Interface.hpp: In member function <span class="stringliteral">&#39;MoFEMErrorCode MoFEM::Interface::set_other_local_VecCreateGhost(const MoFEM::Problem*, const std::string&amp;, const std::string&amp;, RowColData, Vec, InsertMode, ScatterMode, int)&#39;</span>:</div>
<div class="line">mofem/src/interfaces/Interface.hpp:1300:107: warning: <span class="stringliteral">&#39;MoFEMErrorCode MoFEM::Interface::set_other_local_VecCreateGhost(const MoFEM::Problem*, const std::string&amp;, const std::string&amp;, RowColData, Vec, InsertMode, ScatterMode, int)&#39;</span> is deprecated (declared at mofem/src/interfaces/Interface.hpp:1296) [-Wdeprecated-declarations]</div>
<div class="line">     <a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a> = set_other_local_VecCreateGhost(problem_ptr,fiel_name,cpy_field_name,rc,V,mode,scatter_mode,verb); CHKERRQ(<a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a>);</div>
<div class="ttc" id="abase__functions_8c_html_a56d2889a19d8d7affaa85cfca4aadd67"><div class="ttname"><a href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a></div><div class="ttdeci">static PetscErrorCode ierr</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00013">base_functions.c:13</a></div></div>
</div><!-- fragment --></li>
<li>Constants and Macros<ul>
<li>Don't use a pre-processor macro where a const variable or an inline or template function will suffice. There is absolutely beneficial to the former over the later with modern compilers. Furthermore, using macros bypasses type checking that the compiler would otherwise do for you and if used in headers, introduce names into the global rather than <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> namespace.</li>
<li>Don't define constants that are already provided by standard libraries. For example, use M_PI as defined in math.h rather than defining your own constant.</li>
</ul>
</li>
</ul>
</li>
<li>Each header file should have defined macro, following example <div class="fragment"><div class="line"><span class="preprocessor">#ifndef __CLASS_NAME_HPP__</span></div>
<div class="line"><span class="preprocessor">#define __CLASS_NAME_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">class </span>ClassName {</div>
<div class="line"> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//__CLASS_NAME_HPP__</span></div>
</div><!-- fragment --></li>
<li>Each function should have build in error checking, following example <div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_variable" href="dg__projection_8cpp.html#a47f5c9a54ebf753d18651f417f81f4e8">fun</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="dg__projection_8cpp.html#a47f5c9a54ebf753d18651f417f81f4e8">fun</a>();</div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_a47f5c9a54ebf753d18651f417f81f4e8"><div class="ttname"><a href="dg__projection_8cpp.html#a47f5c9a54ebf753d18651f417f81f4e8">fun</a></div><div class="ttdeci">auto fun</div><div class="ttdoc">Function to approximate.</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00036">dg_projection.cpp:36</a></div></div>
</div><!-- fragment --></li>
<li>About pointers:<ul>
<li>Read it backwards (as driven by <a href="http://c-faq.com/decl/spiral.anderson.html">Clockwise/Spiral Rule</a>): <div class="fragment"><div class="line"><span class="keywordtype">int</span>* <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>; <span class="comment">// pointer to int</span></div>
<div class="line"><span class="keywordtype">int</span> <span class="keyword">const</span> * b; <span class="comment">// pointer to const int</span></div>
<div class="line"><span class="keywordtype">int</span> * <span class="keyword">const</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>; <span class="comment">// const pointer to int</span></div>
<div class="line"><span class="keywordtype">int</span> <span class="keyword">const</span> * <span class="keyword">const</span> d; <span class="comment">// const pointer to const int</span></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
</div><!-- fragment --></li>
<li>Now the first const can be on either side of the type so: <div class="fragment"><div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>; <span class="comment">// == int const *</span></div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> * <span class="keyword">const</span> b; <span class="comment">// == int const * const</span></div>
</div><!-- fragment --></li>
<li>If you want to do pointers to pointers: <div class="fragment"><div class="line"><span class="keywordtype">int</span> ** <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>; <span class="comment">// pointer to pointer to int</span></div>
<div class="line"><span class="keywordtype">int</span> ** <span class="keyword">const</span> b; <span class="comment">// a const pointer to a pointer to an int</span></div>
<div class="line"><span class="keywordtype">int</span> * <span class="keyword">const</span> * <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>; <span class="comment">// a pointer to a const pointer to an int</span></div>
<div class="line"><span class="keywordtype">int</span> <span class="keyword">const</span> ** d; <span class="comment">// a pointer to a pointer to a const int</span></div>
<div class="line"><span class="keywordtype">int</span> * <span class="keyword">const</span> * <span class="keyword">const</span> f; <span class="comment">// a const pointer to a const pointer to an int</span></div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Memory allocation<ul>
<li>USE VALGRIND. Valgrind is a powerful tool to find execution errors, use it if your code behaves differently on two different computers, or you get segmentation fault, ect. Valgrind can be used as follows <div class="fragment"><div class="line">valgrind --track-origins=yes ./program_name -my_file mesh.cub</div>
</div><!-- fragment --> Use small mesh, i.e. small problem, when you run valgrind, it take some time. YOU NEED TO COMPILE CODE WITH -DCMAKE_BUILD_TYPE=Debug.</li>
<li>Keep array of objects in STL vectors, multi-indexes or any other Boost or STL data structures. AVOID ALLOCATING ARRAY OF OBJECTS ON HEAP USING REGULAR POINTERS.</li>
<li>Use smart pointers <a href="http://www.boost.org/doc/libs/1_57_0/libs/smart_ptr/smart_ptr.htm">http://www.boost.org/doc/libs/1_57_0/libs/smart_ptr/smart_ptr.htm</a>. If existing code uses regular pointer, take opportunity and change it to smart pointer.</li>
<li>Use <a class="el" href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj</a> to create PETSc objects. SmartPetscObj will mangage ownership and destrcution of PETSc objects like Vec, Mat, KSP, SNES, IS and all others.</li>
<li>Check program with line command argument -log_view, verifying if number of created PTESc objects is equal to number of destroyed objects <div class="fragment"><div class="line">Memory usage is given in bytes:</div>
<div class="line"> </div>
<div class="line">Object Type          Creations   Destructions     Memory  Descendants<span class="stringliteral">&#39; Mem.</span></div>
<div class="line"><span class="stringliteral">Reports information only for process 0.</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">--- Event Stage 0: Main Stage</span></div>
<div class="line"><span class="stringliteral"></span> </div>
<div class="line"><span class="stringliteral">              Matrix     8              8      1526844     0</span></div>
<div class="line"><span class="stringliteral"> Matrix Partitioning     1              1          660     0</span></div>
<div class="line"><span class="stringliteral">           Index Set    40             40        42992     0</span></div>
<div class="line"><span class="stringliteral">   IS L to G Mapping    11             11        32016     0</span></div>
<div class="line"><span class="stringliteral">              Vector    68             68       361384     0</span></div>
<div class="line"><span class="stringliteral">      Vector Scatter    16             16         9792     0</span></div>
<div class="line"><span class="stringliteral">                SNES     1              1         1340     0</span></div>
<div class="line"><span class="stringliteral">      SNESLineSearch     1              1          880     0</span></div>
<div class="line"><span class="stringliteral">              DMSNES     1              1          680     0</span></div>
<div class="line"><span class="stringliteral">       Krylov Solver     1              1        18960     0</span></div>
<div class="line"><span class="stringliteral">     DMKSP interface     1              1          664     0</span></div>
<div class="line"><span class="stringliteral">      Preconditioner     2              2         2104     0</span></div>
<div class="line"><span class="stringliteral">    Distributed Mesh     2              2         9008     0</span></div>
<div class="line"><span class="stringliteral">Star Forest Bipartite Graph     5              5         4136     0</span></div>
<div class="line"><span class="stringliteral">     Discrete System     2              2         1632     0</span></div>
<div class="line"><span class="stringliteral">              Viewer     1              0            0     0</span></div>
</div><!-- fragment --></li>
</ul>
</li>
<li>Make member functions of class constant always when possible. Try to code that you can create such class members. Constant member function does not change the state of the class. So it does not influence the results or actions of another member of that class. That simplifies searching for the bug, testing and overall limits the likelihood of the error. <a class="el" href="structExample.html" title="[Example]">Example</a> of constant class member <div class="fragment"><div class="line"><span class="keyword">struct </span>{</div>
<div class="line">  MoFEMErrorCode someFunction(<span class="keyword">const</span> <span class="keywordtype">int</span> some_argument,<span class="keyword">const</span> <span class="keywordtype">double</span> &amp;some_return_value)<span class="keyword"> const </span>{</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --></li>
<li>Use static_cast&lt;&gt; and avoid C style casting. The compiler checks C++ style casts. C-style casts aren't and can fail at runtime also, C++ style casts can be searched for easily, whereas it's hard to find C style casts. Another big benefit is that the four different C++ style casts express the intent of the programmer more clearly. When writing C++, always use the C++ ones over the C style. If you see the C-style cast, please take the opportunity to fix this.</li>
<li>Use nullptr instead NULL as a default argument in the function. nullptr keyword designates an rvalue constant that serves as a universal null pointer literal, replacing the buggy and weakly-typed literal 0 and the infamous NULL macro.</li>
<li>C++ Partial Template Specialization, see <a href="https://stackoverflow.com/a/6142796/8043075">https://stackoverflow.com/a/6142796/8043075</a> for details. <div class="fragment"><div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> A, <span class="keyword">typename</span> B&gt;</div>
<div class="line"><span class="keyword">struct </span>TwoTypes { };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span>&lt;<span class="keyword">typename</span> A, <span class="keyword">typename</span> B&gt;</div>
<div class="line"><span class="keyword">struct </span>X {</div>
<div class="line">  <span class="comment">/* forwards ... */</span></div>
<div class="line">  <span class="keywordtype">void</span> f() { fImpl(TwoTypes&lt;A, B&gt;()); }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* special overload for &lt;A, int&gt; */</span></div>
<div class="line">  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> A1&gt;</div>
<div class="line">  <span class="keywordtype">void</span> fImpl(TwoTypes&lt;A1, int&gt;) {</div>
<div class="line">    <span class="comment">/* ... */</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* generic */</span></div>
<div class="line">  <span class="keyword">template</span>&lt;<span class="keyword">typename</span> A1, <span class="keyword">typename</span> B1&gt;</div>
<div class="line">  <span class="keywordtype">void</span> fImpl(TwoTypes&lt;A1, B1&gt;) {</div>
<div class="line">  <span class="comment">/* ... */</span></div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --> Explicitly specializing functions is never (almost never?) the right way. Never explicitly specialized a function template. Overloading and partial ordering is superior. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>