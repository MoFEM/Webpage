<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Gel Model Creep (response due to external load)</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="runningprograms.html">Programs</a></li>  </ul>
</div>
</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">Gel Model Creep (response due to external load) </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#gel_creep_mechanical_model">Mechanical model</a></li>
<li class="level1"><a href="#gel_creep_boundary">Dirichelt boundary condition for chemical potential</a></li>
<li class="level1"><a href="#gel_creep_mesh">Mesh</a><ul><li class="level2"><a href="#gel_creep_journal_file">Journal File (creep_force.jou)</a></li>
</ul>
</li>
<li class="level1"><a href="#gel_creep_material_properties">Material Properties</a></li>
<li class="level1"><a href="#gel_creep_load_history">Load History</a></li>
<li class="level1"><a href="#gel_creep_execution">Executing Problem</a></li>
<li class="level1"><a href="#gel_creep_results">Results</a><ul><li class="level2"><a href="#gel_creep_paraview">VTK files for ParaView</a></li>
<li class="level2"><a href="#gel_creep_paraview2">Paraview</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p >This is an example on how to run a simulation of a gel undergoing creep and sorption due to an external load.</p>
<p >To examine the creep response of a gel sample, a bar section (1/8th bar) is modelled in an environment of constant relative humidity (RH) on the boundary, and with a tensile load applied in the longitudinal direction of the bar. A dirichlet BC ( \(\mu\)) is imposed on surface 4 and a Neumann symmetry condition is imposed on surface 6.</p>
<h1><a class="anchor" id="gel_creep_mechanical_model"></a>
Mechanical model</h1>
<p >Native constitutive model is implemented after Yuhang Hu and Zhigang Suo. Viscoelasticity and poroelasticity in elastomeric gels. Acta Mechanica Solida Sinica, Vol. 25, No. 5 <a class="el" href="citelist.html#CITEREF_hu2012viscoelasticity">[28]</a>.</p>
<div class="image">
<img src="gel_spring_daspot_model.png" alt="" width="700px"/>
<div class="caption">
Gel model</div></div>
<p >The model represents a spring, \(\alpha\), in parallel with a spring/dashpot, \(\beta\)/ \(\hat{\beta}\), in series. Initially the load is taken up by both springs, and then over time the load in spring \beta is relaxed as the dashpot, \(\hat{\beta}\), is compressed. This happens until the spring \beta is completely relaxed and the load is taken up entirely by spring \alpha. At this point the system is in equilibrium with the environment.</p>
<div class="image">
<img src="zener_evolution.png" alt="" width="700px"/>
<div class="caption">
Zener Evolution</div></div>
<p >For more details about model implementation, equations and physical constants look here <a class="el" href="struct_gel_module_1_1_gel_1_1_constitutive_equation.html">GelModule::Gel::ConstitutiveEquation</a></p>
<h1><a class="anchor" id="gel_creep_boundary"></a>
Dirichelt boundary condition for chemical potential</h1>
<p >For given relative humidity chemical load is calculated form following equation,  </p><p class="formulaDsp">
\[
\mu = {\mu_0 + RT ln(\text{RH})) \over \text{L}}
\]
</p>
<p> where \(\mu_0\) is initial chemical potential, \(R\) is a gas constant, \(T\) is temperature, \(RH\) is relative humidity of environment (surrounding air) and \(L\) is Avogadro consistent <a class="el" href="citelist.html#CITEREF_hu2012viscoelasticity">[28]</a>.</p>
<p >The water vapour pressure in described in terms of relative humidity, i.e. the ratio of partial water vapour pressure to saturation pressure of the air at a given temperature. Above equation estimates the Gibb's free energy of each solvent molecule (in this case water vapour) entering the system.</p>
<h1><a class="anchor" id="gel_creep_mesh"></a>
Mesh</h1>
<p >Mesh is a 1/8th section of a rectangular cube, with 3 Dirichlet boundary conditions on the external faces and 3 Neumann conditions on the inner faces to impose symmetry. All dimensions are given in meters (m) and the chemical load is Gibb's free energy per solvent molecule entering the system with the units in Joules (J).</p>
<div class="image">
<img src="creep_mesh.png" alt="" width="500px"/>
<div class="caption">
Creep Mesh</div></div>
<h2><a class="anchor" id="gel_creep_journal_file"></a>
Journal File (creep_force.jou)</h2>
<p >Mesh is generated in Cubit using following script,</p>
<div class="fragment"><div class="line">reset</div>
<div class="line">set duplicate block elements on</div>
<div class="line"> </div>
<div class="line">brick x 0.0025 y 0.005 z 0.0025</div>
<div class="line"> </div>
<div class="line"># Set block with volume with gel material</div>
<div class="line">block 1 volume all</div>
<div class="line">block 1 name &#39;GEL&#39;</div>
<div class="line"> </div>
<div class="line"># Set Dirichelt boundary condition for solvent concentration</div>
<div class="line">block 2 surface 2 4 5 </div>
<div class="line">block 2 name &#39;CHEMICAL_LOAD_1&#39;</div>
<div class="line">block 2 attribute count 1</div>
<div class="line">block 2 attribute index 1 1.6102573617124e-17</div>
<div class="line"> </div>
<div class="line"># Set solvent flux, i.e. </div>
<div class="line">block 4 surface 1 3 6</div>
<div class="line">block 4 name &#39;FLUX_CHEMICAL_LOAD_2&#39;</div>
<div class="line">block 4 attribute count 1</div>
<div class="line">block 4 attribute index 1 0</div>
<div class="line"> </div>
<div class="line"># Static boundary condition, i.e. pressure</div>
<div class="line">create pressure on surface 5 magnitude -500</div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field</div>
<div class="line">create displacement on surface 6 dof 1 fix 0</div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field</div>
<div class="line">create displacement on surface 3 dof 2 fix 0</div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field</div>
<div class="line">create displacement on surface 1 dof 3 fix 0</div>
<div class="line"> </div>
<div class="line"># Make a mesh</div>
<div class="line">volume all scheme Tetmesh</div>
<div class="line">volume all size auto factor 7</div>
<div class="line">mesh volume all</div>
<div class="line"> </div>
<div class="line"># Set block 3 and set 10 node tetrahedrons in that block</div>
<div class="line">block 3 tet all</div>
<div class="line">block 3 element type TETRA10</div>
</div><!-- fragment --><p >The mesh file used in this example is located in $MODULE_DIRECTORY/meshes/creep_force.jou.</p>
<h1><a class="anchor" id="gel_creep_material_properties"></a>
Material Properties</h1>
<p >A simple section of amorphous cellulosic material is described. This material exhibits a viscoelastic response and is highly interactive with atmospheric water vapour content and makes a good case for analysis. The volume per solvent molecule (water) in it's liquid form, after chemically binding to the gel, is given by oMega in m^3. In this case the sample is initially in equilibium before the force is applied (i.e. \(\mu = \mu_0\)).</p>
<div class="fragment"><div class="line"># Material parameters for Gel material model</div>
<div class="line"> </div>
<div class="line"># Spring Alpha</div>
<div class="line">gAlpha = 6e3</div>
<div class="line">vAlpha = 0.232</div>
<div class="line"> </div>
<div class="line"># Spring Beta</div>
<div class="line">gBeta = 6e3</div>
<div class="line">vBeta = 0.232</div>
<div class="line"> </div>
<div class="line"># Daspot</div>
<div class="line">gBetaHat = 9e6</div>
<div class="line">vBetaHat = 0.232</div>
<div class="line"> </div>
<div class="line"># Volume per solvent molecule</div>
<div class="line">oMega = 2.988970058e-20</div>
<div class="line"> </div>
<div class="line"># Initial chemical potential</div>
<div class="line">mU0 = 0</div>
<div class="line"> </div>
<div class="line"># Solvent transport material parameters</div>
<div class="line">vIscosity = 9e6</div>
<div class="line">pErmeability = 3.4e-8</div>
<div class="line"> </div>
<div class="line"># User can set approximation order for each blocks independently</div>
<div class="line"># Set approximation order of block 1 as quadratic function.</div>
<div class="line"> </div>
<div class="line">[block_1]</div>
<div class="line"> </div>
<div class="line">oRder = 2</div>
</div><!-- fragment --><p >Above file can be found in $MODULE_DIRECTORY/gel_config_creep_sorption_example.in</p>
<h1><a class="anchor" id="gel_creep_load_history"></a>
Load History</h1>
<p >To model the creep behaviour, a tensile force is applied in the y direction to a sample in equilibrium with it's surroundings. The application of a tensile force will encourage solvent uptake within the sample until the sample reaches equilibrium with it's environment again (i.e. increased solvent content). The load is then released, encouraging ejection of solvent from the sample until the sample once again reaches equilibrium with it's external environment.</p>
<p >To implement the tensile force in this manner, a load history file is used. The file includes a left hand column (time in seconds (s)) and a right hand column of load factor. In this example, a load factor of 1.0 is applied for 50000s until it is released (load factor zero) and another 50000s is allowed for the sample to recover to it's initial state.</p>
<div class="fragment"><div class="line">0 1.00</div>
<div class="line">50000 1.00</div>
<div class="line">50001 0.00</div>
<div class="line">100000 0.00</div>
</div><!-- fragment --><h1><a class="anchor" id="gel_creep_execution"></a>
Executing Problem</h1>
<div class="fragment"><div class="line">mpirun -np 8 ./gel_analysis -my_file creep_force.cub -my_gel_config \</div>
<div class="line">gel_config_creep_sorption_example.in -my_load_history my_load_history.in -ksp_type fgmres \</div>
<div class="line">-ksp_final_residual -ksp_monitor -ksp_converged_reason -pc_type lu \</div>
<div class="line">-pc_factor_mat_solver_package mumps -my_order 3 -snes_monitor -ts_type beuler \</div>
<div class="line">-ts_dt 50 -ts_final_time 100000 -my_output_prt 10 -snes_linesearch_type basic \</div>
<div class="line">-ts_monitor</div>
</div><!-- fragment --><p >Notes:</p>
<ul>
<li>Option <em>-my_file</em> gives name of the mesh file</li>
<li>Option <em>-my_gel_config</em> gives the name of the material configuration file</li>
<li>Option <em>-my_load_history</em> gives the name of the load history file</li>
<li>Option <em>-ts_dt</em> gives the size of each time step in seconds (s)</li>
<li>Option <em>-ts_final_time</em> gives the final time in seconds (s)</li>
<li>Option <em>-my_output_prt</em> gives the number of vtk files output (i.e. -my_output_prt 1, means each time step is processed)</li>
<li>Option <em>-np</em> gives the number of processors to run on</li>
</ul>
<h1><a class="anchor" id="gel_creep_results"></a>
Results</h1>
<h2><a class="anchor" id="gel_creep_paraview"></a>
VTK files for ParaView</h2>
<p >Running dynamic analysis out_values_1.h5m, out_values_2.h5m, ... are created for each time step. Post-processing mesh in output fails is stored in native MoAB data format using standard h5m.</p>
<p >VTK files can be generated using script located in <em>users_modules/nonlinear_elasticity/do_vtk.sh</em>. For example </p><div class="fragment"><div class="line">../nonlinear_elasticity/do_vtk.sh out_*h5m</div>
</div><!-- fragment --><h2><a class="anchor" id="gel_creep_paraview2"></a>
Paraview</h2>
<div class="image">
<img src="creep_force_animation_v2.gif" alt="" width="400px"/>
<div class="caption">
Creep Test</div></div>
<p >To view the creep response of the material, first calculate the displacements (SPATIAL_POSISTION - coords). Plot the outside edge, furthest from the mid-point, against time. The solvent migration can also be plotted by selecting the corner that intersects all 3 inner faces (i.e. surface 1,3 and 6) and plotting against time. The results are plotted below.</p>
<div class="image">
<img src="bothplots_4.png" alt="" width="700px"/>
<div class="caption">
Left: Chemical Load Evolution, Right: Time Series Data</div></div>
<p >The left hand graph shows the chemical load, \(\mu\), through the sample from the top to bottom at various times given in minutes in the legend. The graph on the right gives the displacement at the top corner of the sample (left axis) vs the time in minutes. It shows the reversible creep behaviour that has been induced by the loading conditions, where immediately after the load has been released (t=33min), the sample does not go back to it's reference configuration immediately, instead taking a further 35 minutes to do so.</p>
<p >The right hand axis shows the chemical load at the bottom corner of the sample. Initially during the tensile loading phase, the chemical load decreases at this area of the sample, as space has been created, thus reducing the concentration. The sample responds to this by taking in more solvent in order to reach equilibrium with the environment (i.e. \( \mu \) inside the sample is equal to \( \mu \) in the environment).</p>
<p >After the load has been released, the extra solvent that has migrated into the sample from the environment is compressed as the sample tries to regain it's reference state, forcing the extra solvent out of the sample until equilibrium with the outside environment has been reached again. </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>