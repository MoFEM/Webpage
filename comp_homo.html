<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Computational homogenisation (Usage example)</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="runningprograms.html">Programs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Computational homogenisation (Usage example) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#comp_homo_theory">Theoretical background</a></li>
<li class="level1"><a href="#comp_homo_exp">Numerical examples</a><ul><li class="level2"><a href="#comp_homo_val">homogeneous linear elastic material</a></li>
<li class="level2"><a href="#comp_homo_exp_unidir">Unidirectional fibre reinforced composites</a></li>
<li class="level2"><a href="#comp_homo_exp_textile_a">Textile reinforced composites (a)</a></li>
<li class="level2"><a href="#comp_homo_exp_textile_b">Textile reinforced composites (b)</a></li>
</ul>
</li>
<li class="level1"><a href="#comp_homo_analysis_ack">Acknowledgements</a></li>
<li class="level1"><a href="#comp_homo_analysis_ref">References</a></li>
</ul>
</div>
<div class="textblock"><p>These are simple examples, which explains how to run simple problems for the computational homogenisation of representative volume element (RVE). The RVE boundary conditions (including linear displacement, uniform traction and periodic) are implemented in a generalized manner using the procedure given in [1]. The homogenised or effective stiffness matrices are calculated, which gives the relation between macro-strain and macro-stress.</p>
<p><a class="el" href="faqs.html#mofem_citation">How to cite us?</a></p>
<p> 
<a href="https://doi.org/10.5281/zenodo.439368"><img src="https://zenodo.org/badge/DOI/10.5281/zenodo.439368.svg" alt="DOI"></a>
</p>
<h1><a class="anchor" id="comp_homo_theory"></a>
Theoretical background</h1>
<p>Detailed theoretical background and implementation of the RVE boundary condition, while using hierarchic finite element [2] can be found in the attached pdf file and can be downloaded from <a href="homo_final_document.pdf" target="_blank"><b>this link.</b></a></p>
<h1><a class="anchor" id="comp_homo_exp"></a>
Numerical examples</h1>
<p>The following numerical examples are considered for the computational homogensation.</p>
<h2><a class="anchor" id="comp_homo_val"></a>
homogeneous linear elastic material</h2>
<p>Before applying the RVE boundary conditions to the actual two-phase composite materials. The implementation is validated by an RVE consisting of linear-elastic homogeneous cube with unit dimensions. Mesh file for the RVE with boundary conditions and material properties is created with the following CUBIT journal file. Same mesh file is used for all three types of boundary conditions including linear displacement, traction and periodic.</p>
<div class="fragment"><div class="line">#!python</div>
<div class="line">#To create RVE for all the three type of boundary conditions, i.e. (Linear dispacemet, traction and periodic)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;new&#39;)</div>
<div class="line">cubit.cmd(&#39;brick x 1 y 1 z 1&#39;)</div>
<div class="line">interval=4; </div>
<div class="line"> </div>
<div class="line">str1=&#39;block 1 &#39; +&#39; volume 1&#39;; cubit.cmd(str1)</div>
<div class="line">str1=&#39;block 1 &#39; +&#39; name &quot;MAT_ELASTIC&quot;&#39;; cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;block 1 attribute count 2&#39;)</div>
<div class="line">Elastic=[&#39;200&#39;, &#39;0.3&#39;]</div>
<div class="line">for i in range(0, 2):</div>
<div class="line">    str1=&#39;block 1 attribute index &#39; + str(i+1) +&#39; &#39;+Elastic[i]; cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">str1=&#39;surface 4 interval &#39;+str(interval); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;surface 4 scheme trimesh&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 4&#39;)</div>
<div class="line">cubit.cmd(&#39;surface 6 scheme copy source surface 4 source vertex 4 target vertex 1 source curve 9 target curve 10 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 6&#39;)</div>
<div class="line"> </div>
<div class="line">str1=&#39;surface 1 interval &#39;+str(interval); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;surface 1 scheme trimesh&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 1&#39;)</div>
<div class="line">cubit.cmd(&#39;surface 2 scheme copy source surface 1 source vertex 4 target vertex 7 source curve 3 target curve 7 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 2&#39;)</div>
<div class="line"> </div>
<div class="line">str1=&#39;surface 3 interval &#39;+str(interval); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;surface 3 scheme trimesh&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 3&#39;)</div>
<div class="line">cubit.cmd(&#39;surface 5 scheme copy source surface 3 source vertex 7 target vertex 8 source curve 9 target curve 11 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 5&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;volume 1 scheme tetmesh&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh volume 1&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;sideset 101 surface 2 3 4&#39;)  # all -ve boundary surfaces</div>
<div class="line">cubit.cmd(&#39;sideset 102 surface 1 5 6&#39;)  # all +ve boundary surfaces</div>
<div class="line">cubit.cmd(&#39;sideset 103 surface 1 2 3 4 5 6&#39;)  # all boundary surfaces</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;save as &quot;/Users/zahur/Documents/moFEM/mofem-cephas/mofem_v0.2/users_modules/homogenisation/meshes/Cube.cub&quot; overwrite&#39;)</div>
</div><!-- fragment --><p> The following material properties are used in this case</p>
<ul>
<li>Young’s modulus = 200</li>
<li>Poisson's ratio = 0.3</li>
</ul>
<p>The analysis procedure in this case consists of the following command, the output of which is full homogenised stiffness matrix</p>
<div class="fragment"><div class="line">mpirun -np 1 ./rve_mechanical -my_file Cube.cub  -ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor -my_order 1 -my_bc_type disp</div>
</div><!-- fragment --><p>Notes:</p><ul>
<li>Approximation order can be set using <em>-my_order</em>.</li>
<li>Mesh file can be specified using <em>-my_file</em>.</li>
<li>Number of processor can be specified using <em>-np</em>.</li>
<li>The type of boundary condiitons can be specified using <em>-my_bc_type</em> (disp, trac, periodic)</li>
</ul>
<p>Macro strain vector is written as </p><p class="formulaDsp">
\[ \overline{\boldsymbol{\varepsilon}}=\left[\begin{array}{cccccc}\overline{\varepsilon}_{xx} &amp; \overline{\varepsilon}_{yy} &amp; \overline{\varepsilon}_{zz} &amp; 2\overline{\varepsilon}_{xy} &amp; 2\overline{\varepsilon}_{yz} &amp; 2\overline{\varepsilon}_{zx}\end{array}\right]^{T} \]
</p>
<p>A sample mesh and corresponding x-displacement contours for a macro-strain of [1.0, 0.0, 0.0, 0.0, 0.0, 0.0] are shown in the following figure. </p><div class="image">
<img src="homo_cube_mesh_and_dispx.png" alt="" width="700px"/>
<div class="caption">
Mesh and x-contours of displacement for a linear-elastic homogeneous cube</div></div>
<p>The homogenised stiffness matrices calculated using all the three types of boundary conditions are shown in the following Table. The homogenized stiffness matrices for the three type of boundary conditions are also compared with one calculated directly from the <a class="el" href="structHooke.html" title="Hook equation.">Hooke</a>'s law, which is also given in the same table. It is clear from the Table, that the homogenised stiffness matrix calculated for a homogeneous material is the same for all three types of boundary conditions and is also the same as calculated directly from the <a class="el" href="structHooke.html" title="Hook equation.">Hooke</a>'s law. In the following, the code is used for a more complex case, i.e. a unidirectional fibre reinforced composites and textile composite RVEs. </p><div class="image">
<img src="homo_cube_stiff_matrix.png" alt="" width="700px"/>
<div class="caption">
Homogenised stiffness matrices for linear-elastic homogeneous cube</div></div>
<h2><a class="anchor" id="comp_homo_exp_unidir"></a>
Unidirectional fibre reinforced composites</h2>
<p>The second example consists of unidirectional fibre reinforced composites, the geometry for which is given in the following figure. Periodic mesh is created for the RVE, in which, e.g. for every nodes on the positive x-face there is a node on the negative x-face with same y and z coordinates. In this example matrix is considered as isotropic and yarn is considered as transversely isotropic materials. The following CUBIT journal file is used to create the geometry with boundary conditions and material properties. The material properties used for the matrix and fibres are given as</p>
<p>Matrix:</p><ul>
<li>Young’s modulus = 3.5 GPa</li>
<li>Poisson's ratio = 0.35</li>
</ul>
<p>Fibres:</p><ul>
<li>Young’s modulus in transverse direction E_p = 35 GPa</li>
<li>Poisson's ratio in transverse direction v_p = 0.26</li>
<li>Young’s modulus in fibre direction E_z = 70 GPa</li>
<li>Poisson's ratio in fibre direction v_pz = 0.26</li>
<li>Shear modulus in the fibre direction G_pz = 17.5 GPa <div class="image">
<img src="homo_cube_with_inclusion_gem_phi_fd.png" alt="" width="3cm"/>
<div class="caption">
Geometry, potential field and fibres directions for unidirectional fibre reinforced composites</div></div>
 <div class="fragment"><div class="line">#!python</div>
<div class="line">#To create RVE for all the three type of boundary conditions, i.e. (Linear dispacemet, traction and periodic)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;new&#39;)</div>
<div class="line"> </div>
<div class="line">autofactor=7; </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Geometry</div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;brick x 1 y 1 z 1&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;brick x 1 y 0.4 z 0.4&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;subtract volume 2 from volume 1 keep&#39;)</div>
<div class="line">cubit.cmd(&#39;delete volume 1&#39;) </div>
<div class="line">cubit.cmd(&#39;imprint volume 2 3&#39;)   </div>
<div class="line">cubit.cmd(&#39;merge volume 2 3&#39;) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Periodic mesh  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 20 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 20  size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 20&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 22 scheme copy source surface 20 source vertex 27 target vertex 26 source curve 47 target curve 48 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 22&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 10 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 10  size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 10&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 12 scheme copy source surface 10 source vertex 11 target vertex 10 source curve 23 target curve 24 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 12&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 17 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 17  size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 17&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 18 scheme copy source surface 17 source vertex 26 target vertex 29 source curve 38 target curve 44 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 18&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 19 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 19  size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 19&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 21 scheme copy source surface 19 source vertex 28 target vertex 27 source curve 45 target curve 47 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 21&#39;) </div>
<div class="line"> </div>
<div class="line">str1=&#39;volume all size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;volume all scheme tetmesh&#39;)  </div>
<div class="line">cubit.cmd(&#39;mesh volume all&#39;)  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining blocks for elastic, transversely-isotropic and potential flow problems  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">vol=[&#39;3&#39;, &#39;2&#39;,&#39;2&#39;]  </div>
<div class="line">mat=[&#39;MAT_ELASTIC_1&#39;,&#39;MAT_ELASTIC_TRANSISO_1&#39;,&#39;PotentialFlow_1&#39;]  </div>
<div class="line">for i in range(0, 3):  </div>
<div class="line">    cubit.cmd(&#39;set duplicate block elements on&#39;)  </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; volume &#39;+vol[i]; cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; name &quot;&#39;+mat[i] + &#39;&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Material properties for matrix part  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;block 1 attribute count 2&#39;)  </div>
<div class="line">Em=3.5e3; Enu=0.3;  #giga to mega as we used dimension in mm  </div>
<div class="line"> </div>
<div class="line">Elastic=[str(Em), str(Enu)]  </div>
<div class="line">for i in range(0, 2):  </div>
<div class="line">    str1=&#39;block 1 attribute index &#39; + str(i+1) +&#39; &#39;+Elastic[i]; cubit.cmd(str1)  </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Material properties for fibres  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">#to use as isotropic </div>
<div class="line">#cubit.cmd(&#39;block 2 attribute count 5&#39;)    </div>
<div class="line">#Ep=Em; Ez=Em; nup=Enu; nupz=Enu;  Gzp=Em/(2*(1+Enu));  </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;block 2 attribute count 5&#39;)   </div>
<div class="line">#Ep=40e3; Ez=230e3; nup=0.26; nupz=0.26; Gzp=24e3;    </div>
<div class="line">Ep=10*Em; Ez=20*Em; nup=0.26; nupz=0.26; Gzp=5*Em;    </div>
<div class="line">#Ep=2*Em; Ez=5*Em; nup=0.26; nupz=0.26; Gzp=2*Em;    </div>
<div class="line">   </div>
<div class="line">TransIso=[str(Ep), str(Ez), str(nup), str(nupz), str(Gzp)]   </div>
<div class="line">for i in range(0, 5):   </div>
<div class="line">    str1=&#39;block 2 attribute index &#39; + str(i+1) +&#39; &#39;+TransIso[i]; cubit.cmd(str1)   </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Material properties for interface between fibres and matrix  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">alpha_interf=500 </div>
<div class="line">cubit.cmd(&#39;set duplicate block elements on&#39;)  </div>
<div class="line">str1=&#39;block 7 surface 23 26 29 32&#39;; cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 name &quot;MAT_INTERF_1&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line">cubit.cmd(&#39;block 7 attribute count 4&#39;)  </div>
<div class="line">str1=&#39;block 7 attribute index 1 &#39;+str(alpha_interf); cubit.cmd(str1)    #now we use 4 parameters for interface  </div>
<div class="line">str1=&#39;block 7 attribute index 2 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 3 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 4 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining interfaces </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Interface=[&#39;7&#39;, &#39;8&#39;,&#39;9&#39;,&#39;11&#39;]   </div>
<div class="line">for i in range(0, 4):   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; surface &#39;+Interface[i]; cubit.cmd(str1)   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; name &quot;interface&#39;+str(i+1); cubit.cmd(str1)   </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining pressures for potential flow problem  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Pres=[&#39;10&#39;, &#39;12&#39;]; count=0;  count1=len(Interface);</div>
<div class="line">for i in range(0, 1):  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+1)+&#39; on surface &#39;+str(Pres[count])+&#39; magnitude 1&#39;;  cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+2)+&#39; on surface &#39;+str(Pres[count+1])+&#39; magnitude -1&#39;;  cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+1)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_1&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+2)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_2&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    count=count+2;   count1=count1+2; </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Definign zero proessrues for potential flow problem (This should be of the same order as PotentialFlow blocks )</div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">zeroPressureNode=[1]</div>
<div class="line">for i in range(0, 1):  </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1) + &#39; node &#39; + str(zeroPressureNode[i]); cubit.cmd(str1) </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1)+&#39; name &quot;ZeroPressure_&#39; + str(i+1)+ &#39;&quot;&#39;; cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining surfaces for dispacement, traction and periodic boundary conditions  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;sideset 101 surface 20 10 19 18&#39;)  # all -ve boundary surfaces  </div>
<div class="line">cubit.cmd(&#39;sideset 102 surface 21 17 22 12&#39;)  # all +ve boundary surfaces  </div>
<div class="line">cubit.cmd(&#39;sideset 103 surface 20 10 19 18 21 17 22 12&#39;)  # all boundary surfaces  </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;save as &quot;/Users/zahur/Documents/moFEM/mofem-cephas/mofem_v0.2/users_modules/homogenisation/meshes/Cube_RVE_with_reinforcement.cub&quot; overwrite&#39;)</div>
</div><!-- fragment --></li>
</ul>
<p>The fibre direction, required for the transversely isotropic material model is calculated by solving a potential flow problem across the fibre. The analysis procedure in this example consists of running a potential flow problem followed by actual computational homogenisation calculation. The commands used for this example is given as follows, the output of which is full homogenised stiffness matrix for linear displacement, uniform traction and periodic boundary conditions cases.</p>
<div class="fragment"><div class="line">mpirun -np 1 ./rve_fibre_directions -my_file Cube_RVE_with_reinforcement.cub  -ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package superlu_dist -ksp_monitor -my_order 1</div>
</div><!-- fragment --><div class="fragment"><div class="line">mpirun -np 1 ./rve_mechanical -my_file solution_RVE.h5m -ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor -my_order 1 -my_bc_type disp</div>
</div><!-- fragment --><p>The output of the potential flow, including potential filed and calculated fibre direction are also given in the above figure. The full-homogenised stiffness matrices calculated for displacement, periodic and traction boundary conditions for 1st, 2nd and 3rd order of approximation are given in the following table.</p>
<div class="image">
<img src="homo_cube_with_inclusion_matirces.png" alt="" width="3cm"/>
<div class="caption">
Homogenised stiffness matrix for 1st, 2nd and 3rd order of approximations for unidirectional fibre reinforced composites</div></div>
<p>Furthermore comparison and convergence of C11, C22, C33, C44, C55 and C66 for all the three types of boundary conditions are also given in the following figure. It is clear that as expected response for the periodic boundary condition case lies between the traction and displacement boundary conditions cases. Moreover Convergence can be observed in all Cs as we increase the order of approximation from 1st to 3rd. </p><div class="image">
<img src="homo_cube_with_inclusion_Cs.png" alt=""/>
<div class="caption">
Figure 6. Comparison of C11, C22, C33, C44, C55 and C66 for displacement, traction and periodic boundary conditions for unidirectional fibre reinforced composites</div></div>
<h2><a class="anchor" id="comp_homo_exp_textile_a"></a>
Textile reinforced composites (a)</h2>
<p>In this case a more complicated textile RVE is considered [3] consisting of matrix and textile fibres imbedded in matrix. Elliptical cross sections and cubic splines are used to model the cross-sections and paths of the fibre. Different parameters defining the RVE geometry are given in the following figure.</p>
<div class="image">
<img src="homo_textile_geometry_and_dimensions.png" alt="" width="700px"/>
<div class="caption">
RVE geometry for the textile composite</div></div>
<p>The CUBIT journal file required to generate the input model is given as follows (same file is used for all the three types of boundary conditions): </p><div class="fragment"><div class="line">#!python</div>
<div class="line">#This scrip will create RVE including fibres and matrix, which can be used for all </div>
<div class="line">#three type of boundary conditions including dispalcement, traction and periodic. </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;new&#39;)</div>
<div class="line">#=============================================================</div>
<div class="line">#Geometry Input parametrs</div>
<div class="line">#=============================================================</div>
<div class="line">W_wrap=0.3; H_wrap=0.1514; hgap_wrap=0.09 </div>
<div class="line">W_weft=0.3; H_weft=0.0757; hgap_weft=1.2 </div>
<div class="line">L_RVE=3.0;    W_RVE=0.8;        H_RVE=0.3;  </div>
<div class="line">Vgap=0.012 </div>
<div class="line"> </div>
<div class="line">s_weft=hgap_weft+W_weft;    s_wraf=hgap_wrap+W_wrap</div>
<div class="line">T=(H_weft/2+H_wrap/2)/2+Vgap</div>
<div class="line"> </div>
<div class="line">L_RVE=2*s_weft;    W_RVE=2*s_wraf;     H_RVE=0.3;    </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Create vartices for splines to create splines</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">coordx=-22.5*s_weft;  coordy=T; coordz=0;</div>
<div class="line">for i in range(0, 48):</div>
<div class="line">    if i % 2 == 0:</div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordx=coordx+s_weft; </div>
<div class="line">        cubit.cmd(str1)</div>
<div class="line">    if i % 2 == 1:</div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(-coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordx=coordx+s_weft; </div>
<div class="line">        cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">coordx=-22.5*s_weft;  coordy=-T; coordz=s_wraf; </div>
<div class="line">for i in range(0, 48): </div>
<div class="line">    if i % 2 == 0: </div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordx=coordx+s_weft;  </div>
<div class="line">        cubit.cmd(str1) </div>
<div class="line">    if i % 2 == 1: </div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(-coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordx=coordx+s_weft;  </div>
<div class="line">        cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">coordx=-0.5*s_weft;  coordy=-T; coordz=-22*s_wraf; </div>
<div class="line">for i in range(0, 48): </div>
<div class="line">    if i % 2 == 0: </div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordz=coordz+s_wraf;  </div>
<div class="line">        cubit.cmd(str1) </div>
<div class="line">    if i % 2 == 1: </div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(-coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordz=coordz+s_wraf;  </div>
<div class="line">        cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">coordx=0.5*s_weft;  coordy=T; coordz=-22*s_wraf; </div>
<div class="line">for i in range(0, 48): </div>
<div class="line">    if i % 2 == 0: </div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordz=coordz+s_wraf;  </div>
<div class="line">        cubit.cmd(str1) </div>
<div class="line">    if i % 2 == 1: </div>
<div class="line">        str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(-coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ; coordz=coordz+s_wraf;  </div>
<div class="line">        cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Joint vertices to create splines </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">Tvertices=48;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=0;   </div>
<div class="line">for i in range(0, 4): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 48):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+48;</div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Creating fibers with elliptical cross sections  </div>
<div class="line">#=============================================================</div>
<div class="line">     </div>
<div class="line">cubit.cmd(&#39;create planar surface with plane normal to curve 1 distance 0 from vertex 1&#39;) </div>
<div class="line">str1=&#39;create curve location vertex 1 direction curve 8 length &#39;+ str(W_wrap/2); cubit.cmd(str1) </div>
<div class="line">str1=&#39;create curve location vertex 1 direction curve 7 length  &#39;+str(H_wrap/2); cubit.cmd(str1) </div>
<div class="line">cubit.cmd(&#39;create surface ellipse vertex 198 200 1&#39;)</div>
<div class="line">cubit.cmd(&#39;sweep surface 2 along curve 1&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;create planar surface with plane normal to curve 2 distance 0 from vertex 49&#39;) </div>
<div class="line">str1=&#39;create curve location vertex 49 direction curve 17 length &#39;+ str(W_wrap/2); cubit.cmd(str1) </div>
<div class="line">str1=&#39;create curve location vertex 49 direction curve 16 length  &#39;+str(H_wrap/2); cubit.cmd(str1) </div>
<div class="line">cubit.cmd(&#39;create surface ellipse vertex 208 210 49&#39;)</div>
<div class="line">cubit.cmd(&#39;sweep surface 6 along curve 2&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;create planar surface with plane normal to curve 3 distance 0 from vertex 97&#39;)</div>
<div class="line">str1=&#39;create curve location vertex 97 direction curve 24 length &#39;+ str(W_weft/2); cubit.cmd(str1)</div>
<div class="line">str1=&#39;create curve location vertex 97 direction curve 23 length  &#39;+str(H_weft/2); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;create surface ellipse vertex 218 220 97&#39;)</div>
<div class="line">cubit.cmd(&#39;sweep surface 10 along curve 3&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;create planar surface with plane normal to curve 4 distance 0 from vertex 145&#39;)</div>
<div class="line">str1=&#39;create curve location vertex 145 direction curve 33 length &#39;+ str(W_weft/2); cubit.cmd(str1)</div>
<div class="line">str1=&#39;create curve location vertex 145 direction curve 32 length  &#39;+str(H_weft/2); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;create surface ellipse vertex 228 230 145&#39;)</div>
<div class="line">cubit.cmd(&#39;sweep surface 14 along curve 4&#39;)</div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Deletion of remaining free vertices, curves and bodies </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;delete vertex all&#39;)</div>
<div class="line">cubit.cmd(&#39;delete curve all&#39;)</div>
<div class="line">cubit.cmd(&#39;delete body 7 3 5 1&#39;)</div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Create matrix and imprint and merge fibres and matrix to create common surfaces</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">str1=&#39;brick x &#39;+str(L_RVE)+&#39; y &#39;+str(H_RVE)+&#39; z &#39;+str(W_RVE); cubit.cmd(str1) </div>
<div class="line">str1=&#39;move Volume &#39;+str(9)+&#39; x &#39;+str(0)+&#39; y &#39;+str(0)+&#39; z &#39;+str(s_wraf/2); cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;intersect volume all keep&#39;) </div>
<div class="line">cubit.cmd(&#39;delete volume 6 2 8 4&#39;) </div>
<div class="line">cubit.cmd(&#39;subtract volume 10 11 12 13 from volume 9 keep&#39;) </div>
<div class="line">cubit.cmd(&#39;delete volume 9&#39;) </div>
<div class="line">cubit.cmd(&#39;imprint volume 10 11 12 13 14&#39;)   </div>
<div class="line">cubit.cmd(&#39;merge volume 10 11 12 13 14&#39;) </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Meshing negative x, y and z face of the RVE and coping the same to its positive faces</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;group 1 add surface 42 27 24&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g2&quot; add surface 44 25 28&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g3&quot; add surface 39 30 33&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g4&quot; add surface 31 40 34&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g5&quot; add surface 43&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g6&quot; add surface 41&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 42 27 24 size auto factor 6&#39;)       </div>
<div class="line">cubit.cmd(&#39;surface 42 27 24 scheme trimesh&#39;)      </div>
<div class="line">cubit.cmd(&#39;mesh surface 42 27 24&#39;)      </div>
<div class="line">cubit.cmd(&#39;surface 28 25 44 scheme mirror source surface 27 24 42 source vertex 263 target vertex 262 nosmoothing&#39;)  </div>
<div class="line">cubit.cmd(&#39;mesh surface 28 25 44&#39;)  </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 39 30 33 size auto factor 5&#39;)     </div>
<div class="line">cubit.cmd(&#39;surface 39 30 33 scheme trimesh&#39;)     </div>
<div class="line">cubit.cmd(&#39;mesh surface 39 30 33&#39;)     </div>
<div class="line">cubit.cmd(&#39;surface 31 34 40 scheme mirror source surface 30 33 39 source vertex 257 target vertex 262 nosmoothing&#39;) </div>
<div class="line">cubit.cmd(&#39;mesh surface 31 34 40&#39;) </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;surface 43 scheme trimesh&#39;)    </div>
<div class="line">cubit.cmd(&#39;mesh surface 43&#39;)    </div>
<div class="line">cubit.cmd(&#39;surface 41 scheme mirror source surface 43 source vertex 259 target vertex 260 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 41&#39;)</div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Mesh volume </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;volume all scheme Tetmesh&#39;) </div>
<div class="line">cubit.cmd(&#39;mesh volume all&#39;) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining blocks for elastic, transversely-isotropic and potential flow problems  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">vol=[&#39;14&#39;, &#39;10,11,12,13&#39;,&#39;10&#39;, &#39;11&#39;, &#39;12&#39;, &#39;13&#39;]  </div>
<div class="line">mat=[&#39;MAT_ELASTIC_1&#39;,&#39;MAT_ELASTIC_TRANSISO_1&#39;,&#39;PotentialFlow_1&#39;,&#39;PotentialFlow_2&#39;,&#39;PotentialFlow_3&#39;,&#39;PotentialFlow_4&#39;]  </div>
<div class="line">for i in range(0, 6):  </div>
<div class="line">    cubit.cmd(&#39;set duplicate block elements on&#39;)  </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; volume &#39;+vol[i]; cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; name &quot;&#39;+mat[i] + &#39;&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Material properties for matrix part  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;block 1 attribute count 2&#39;)  </div>
<div class="line">Em=3.5e3; Enu=0.3;  #gig to mega as we used dimension in mm  </div>
<div class="line"> </div>
<div class="line">Elastic=[str(Em), str(Enu)]  </div>
<div class="line">for i in range(0, 2):  </div>
<div class="line">    str1=&#39;block 1 attribute index &#39; + str(i+1) +&#39; &#39;+Elastic[i]; cubit.cmd(str1)  </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Material properties for fibres  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">#to use as isotropic </div>
<div class="line">#cubit.cmd(&#39;block 2 attribute count 5&#39;)    </div>
<div class="line">#Ep=Em; Ez=Em; nup=Enu; nupz=Enu;  Gzp=Em/(2*(1+Enu));  </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;block 2 attribute count 5&#39;)   </div>
<div class="line">#Ep=40e3; Ez=230e3; nup=0.26; nupz=0.26; Gzp=24e3;    </div>
<div class="line">Ep=10*Em; Ez=20*Em; nup=0.26; nupz=0.26; Gzp=5*Em;    </div>
<div class="line">#Ep=2*Em; Ez=5*Em; nup=0.26; nupz=0.26; Gzp=2*Em;    </div>
<div class="line">   </div>
<div class="line">TransIso=[str(Ep), str(Ez), str(nup), str(nupz), str(Gzp)]   </div>
<div class="line">for i in range(0, 5):   </div>
<div class="line">    str1=&#39;block 2 attribute index &#39; + str(i+1) +&#39; &#39;+TransIso[i]; cubit.cmd(str1)   </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Material properties for interface between fibres and matrix  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">alpha_interf=500 </div>
<div class="line">cubit.cmd(&#39;set duplicate block elements on&#39;)  </div>
<div class="line">str1=&#39;block 7 surface 23 26 29 32&#39;; cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 name &quot;MAT_INTERF_1&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line">cubit.cmd(&#39;block 7 attribute count 4&#39;)  </div>
<div class="line">str1=&#39;block 7 attribute index 1 &#39;+str(alpha_interf); cubit.cmd(str1)    #now we use 4 parameters for interface  </div>
<div class="line">str1=&#39;block 7 attribute index 2 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 3 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 4 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">  </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining interfaces </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Interface=[&#39;23&#39;, &#39;26&#39;,&#39;29&#39;,&#39;32&#39;]   </div>
<div class="line">for i in range(0, 4):   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; surface &#39;+Interface[i]; cubit.cmd(str1)   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; name &quot;interface&#39;+str(i+1); cubit.cmd(str1)   </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining pressures for potential flow problem  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Pres=[&#39;24&#39;, &#39;25&#39;,&#39;27&#39;,&#39;28&#39;,&#39;30&#39;,&#39;31&#39;,&#39;33&#39;,&#39;34&#39;]; count=0;  count1=len(Interface);</div>
<div class="line">for i in range(0, 4):  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+1)+&#39; on surface &#39;+str(Pres[count])+&#39; magnitude 1&#39;;  cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+2)+&#39; on surface &#39;+str(Pres[count+1])+&#39; magnitude -1&#39;;  cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+1)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_1&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+2)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_2&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    count=count+2;   count1=count1+2; </div>
<div class="line">  </div>
<div class="line">#============================================================= </div>
<div class="line">#Defining surfaces for dispacement, traction and periodic boundary conditions  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;sideset 101 surface 41 31 34 40 42 27 24&#39;)  # all -ve boundary surfaces for periodic boundary conditions  </div>
<div class="line">cubit.cmd(&#39;sideset 102 surface 43 30 33 39 25 44 28&#39;)  # all +ve boundary surfaces  for periodic boundary conditions  </div>
<div class="line">cubit.cmd(&#39;sideset 103 surface 41 31 34 40 42 27 24 43 30 33 39 25 44 28&#39;)  # all boundary surfaces  </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">#To check for indiviual side for inserstion of prisms of any problem </div>
<div class="line">#cubit.cmd(&#39;sideset 101 surface 42 27 24&#39;) </div>
<div class="line">#cubit.cmd(&#39;sideset 102 surface 25 44 28&#39;)  </div>
<div class="line">#cubit.cmd(&#39;sideset 101 surface 41&#39;) </div>
<div class="line">#cubit.cmd(&#39;sideset 102 surface 43&#39;)  </div>
<div class="line">#cubit.cmd(&#39;sideset 101 surface 31 34 40&#39;)  </div>
<div class="line">#cubit.cmd(&#39;sideset 102 surface 30 33 39&#39;)   </div>
<div class="line">#cubit.cmd(&#39;sideset 101 surface 40&#39;)  </div>
<div class="line">#cubit.cmd(&#39;sideset 102 surface 39&#39;)   </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Definign zero proessrues for potential flow problem (This should be of the same order as PotentialFlow blocks )</div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">zeroPressureNode=[140, 106, 279, 272]</div>
<div class="line">for i in range(0, 4):  </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1) + &#39; node &#39; + str(zeroPressureNode[i]); cubit.cmd(str1) </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1)+&#39; name &quot;ZeroPressure_&#39; + str(i+1)+ &#39;&quot;&#39;; cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line">#Saving input RVE file  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;save as &quot;/Users/zahur/Documents/moFEM/mofem-cephas/mofem_v0.2/users_modules/homogenisation/meshes/Textile_RVE_TransIso.cub&quot; overwrite&#39;)    </div>
</div><!-- fragment --><p>Similar to the previous unidirectional fibre reinforced composites example, matrix and fibres are considered as isotropic and transversely isotropic materials respectively with the same material properties. The finite element mesh (periodic) in this case consists of 4-node tetrahedral elements and is shown in following figure.</p>
<div class="image">
<img src="homo_textile_geom_and_mesh.png" alt="" width="700px"/>
<div class="caption">
RVE geometry and corresponding mesh for the textile composite</div></div>
<p>The commands for the calculation of e.g. the first column of the homogenised stiffness matrix for the displacement, periodic and traction boundary conditions for this example is given as</p>
<div class="fragment"><div class="line">mpirun -np 1 ./rve_fibre_directions -my_file Textile_RVE_TransIso.cub -ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package superlu_dist -ksp_monitor -my_order 1</div>
</div><!-- fragment --><div class="fragment"><div class="line">mpirun -np 1 ./rve_mechanical -my_file solution_RVE.h5m -ksp_type fgmres -pc_type lu -pc_factor_mat_solver_package mumps -ksp_monitor -my_order 1 -my_bc_type disp</div>
</div><!-- fragment --><p>For this example, the potential field and calculated fibres directions are shown in the following figure.</p>
<div class="image">
<img src="homo_textile_phi_and_Fdir.png" alt="" width="700px"/>
<div class="caption">
Potential field (left) and calculated fibres directions (right) for the textile composite</div></div>
<p>Finally, the full homogenised stiffness matrices (6x6) is calculated for all the three types of boundary conditions for 1st and 2nd order of approximation and is given in the following table</p>
<div class="image">
<img src="homo_textile_stiff_matrix2.png" alt="" width="3cm"/>
<div class="caption">
Homogenised stiffness matrix for 1st, 2nd and 3rd order of approximations for the textile composite</div></div>
<p>Comparison of C11, C22, C33, C44, C55 and C66 for displacement, traction and periodic boundary conditions for this example are shown in the following figure. It is clear that response for the periodic boundary conditions case lies between the displacement and traction boundary conditions cases. Convergence can also be observed in C11, C22, C33, C44, C55 and C66 as we increase the order of approximation from 1st to 3rd.</p>
<div class="image">
<img src="homo_textile_Cs_plot.png" alt="" width="3cm"/>
<div class="caption">
Comparison of C11, C22, C33, C44, C55 and C66 for displacement, traction and periodic boundary conditions for the textile composite</div></div>
<h2><a class="anchor" id="comp_homo_exp_textile_b"></a>
Textile reinforced composites (b)</h2>
<p>Two RVE microstructures with plain weave fabric reinforcement [4, 5] and [4, 6] are selected to evaluate the applicability of computational homogenization scheme for textile composites, comparing with experimental and/or existing model results. These two models are named the Barbero model and the Scida model here after. The Barbero model is based on photomicrograph measurements of geometrical parameters and the Mori-Tanaka asymptotic homogenization method has been applied to predict the effective elastic parameters. The geometrical parameters of the Scida model were also obtained by photomicrography, and experiments were conducted to obtain the longitudinal and transversal Young’s moduli and the in-plane Poisson’s ratio. The geometry for this case with different parameters and fibres directions are shown in the following figures, in which 4a1 and 4a2 are the periodic length of warp and weft yarns, 2a3 is the waviness amplitude and ag1 and ag2 are spacing between adjacent warp and weft yarns respectively. </p><div class="image">
<img src="homo_textile_Xiaoyi_geometry.png" alt="" width="700px"/>
<div class="caption">
RVE geometry and potential flow for the textile composite (b) [4]</div></div>
<p> The RVE of the Barbero model has been discretized into 12148 four-node tetrahedral elements consisting of 5346 elements for the yarns and 6802 elements for the matrix, with a total of 2454 nodes, while the RVE of Scida model has been discretized into 20053 tetrahedral elements with 8101 of them for the yarns and 11952 for matrix.</p>
<p>The effective engineering parameters predicted by the computational homogenization method are compared with experimental and/or numerical results. The results are listed in the following table. The reference numerical results for both models are taken from [5], where both models have been analysed using the Mori-Tanaka asymptotic homogenization method. For the Scida model, the experimental results reported are from [6]. For the computational homogenization, the results for the three boundary conditions of linear displacement, periodic, and uniform traction are given in the following table. From these results it can be seen that the model predicts moduli values that are within or very near the published standard deviation. </p><div class="image">
<img src="homo_textile_Xiaoyi_homo_properties.png" alt="" width="700px"/>
<div class="caption">
Comparison between current and reference homogenised elastic properties [4]</div></div>
<p>The CUBIT journal file used to generate the input model for Barbero RVE is given as: </p><div class="fragment"><div class="line">#!python</div>
<div class="line">#This scrip will create RVE including fibres and matrix, which can be used for all </div>
<div class="line">#three type of boundary conditions including dispalcement, traction and periodic. </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;new&#39;)</div>
<div class="line">#=============================================================</div>
<div class="line">#Geometry Input parametrs</div>
<div class="line">#=============================================================</div>
<div class="line">a1=0.920</div>
<div class="line">a2=0.920</div>
<div class="line">a3=0.250</div>
<div class="line">ag1=0.17</div>
<div class="line">ag2=0.17</div>
<div class="line"> </div>
<div class="line">W_warp=a2-ag2/2</div>
<div class="line">W_weft=a1-ag1/2</div>
<div class="line"> </div>
<div class="line">L_RVE=4*a2</div>
<div class="line">W_RVE=4*a1</div>
<div class="line">H_RVE=2.12*a3 </div>
<div class="line"> </div>
<div class="line">dy_w=W_warp/100</div>
<div class="line">dy_g=ag2/50   </div>
<div class="line">dx_w=W_weft/100</div>
<div class="line">dx_g=ag1/50  </div>
<div class="line"> </div>
<div class="line">autofactor=5; </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Create vartices for splines to create splines</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">import math</div>
<div class="line">da3=0.014;</div>
<div class="line">a3=a3+da3;</div>
<div class="line">#---------------------</div>
<div class="line"># Fill 1 path (14) top</div>
<div class="line">#---------------------</div>
<div class="line">coordx=-a1</div>
<div class="line">coordy=-3*a2-dy_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordy=coordy+dy_w;</div>
<div class="line">    else:</div>
<div class="line">        coordy=coordy+dy_g;</div>
<div class="line">    coordz=a3/2*(math.sin(-math.pi*(coordy)/(2*a2)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">#---------------------</div>
<div class="line"># Fill 2 path (12) top</div>
<div class="line">#---------------------      </div>
<div class="line">coordx=a1</div>
<div class="line">coordy=-3*a2-dy_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordy=coordy+dy_w;</div>
<div class="line">    else:</div>
<div class="line">        coordy=coordy+dy_g;</div>
<div class="line">    coordz=a3/2*(math.sin(math.pi*(coordy)/(2*a2)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line">        </div>
<div class="line">#---------------------</div>
<div class="line"># Warp 1 path (2) top</div>
<div class="line">#---------------------</div>
<div class="line">coordy=-a2</div>
<div class="line">coordx=-3*a1-dx_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordx=coordx+dx_w;</div>
<div class="line">    else:</div>
<div class="line">        coordx=coordx+dx_g;</div>
<div class="line">    coordz=a3/2*(math.sin(math.pi*(coordx)/(2*a1)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#---------------------</div>
<div class="line"># Warp 2 path (8) top</div>
<div class="line">#---------------------</div>
<div class="line">coordy=a2</div>
<div class="line">coordx=-3*a1-dx_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordx=coordx+dx_w;</div>
<div class="line">    else:</div>
<div class="line">        coordx=coordx+dx_g;</div>
<div class="line">    coordz=a3/2*(math.sin(-math.pi*(coordx)/(2*a1)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)         </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Joint vertices to create splines </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">Tvertices=751;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=0;   </div>
<div class="line">for i in range(0, 4): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(125, 626):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+751;   </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Creating yarns/inclusions with sinusoidal cross sections  </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">a3=a3-da3;</div>
<div class="line">#-------------------------------------</div>
<div class="line"># Fill 1 front surface top profile (1)</div>
<div class="line">#-------------------------------------</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=-2*a1+ag1/2-dx_w</div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag1/4/a1)-a3/2</div>
<div class="line">B_coef=math.pi/(ag1-2*a1)</div>
<div class="line">C_coef=-math.pi*(ag1-4*a1)/2/(ag1-2*a1)</div>
<div class="line">D_coef=-a3/2*math.sin(math.pi*ag1/4/a1)+a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">dzmax=A_coef*math.sin(B_coef*(-a1)+C_coef)+D_coef</div>
<div class="line">dzmin=A_coef*math.sin(B_coef*(-ag1/2)+C_coef)+D_coef</div>
<div class="line">dz_f1=dzmax-dzmin</div>
<div class="line"> </div>
<div class="line">#----------------------------------------</div>
<div class="line"># Fill 1 front surface bottom profile (2)</div>
<div class="line">#----------------------------------------   </div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=math.pi/(2*a1)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=a3/2</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=-2*a1+ag1/2-dx_w </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)     </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=3004;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;</div>
<div class="line"> </div>
<div class="line">#-------------------------------------</div>
<div class="line"># Fill 2 front surface top profile (5)</div>
<div class="line">#-------------------------------------</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=ag1/2-dx_w</div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=math.pi/(2*a1)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=-a3/2</div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef;</div>
<div class="line">    coordz=coordz;  </div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">dzmax=A_coef*math.sin(B_coef*a1+C_coef)+D_coef</div>
<div class="line">dzmin=A_coef*math.sin(B_coef*ag1/2+C_coef)+D_coef</div>
<div class="line">dz_f2=dzmax-dzmin</div>
<div class="line"> </div>
<div class="line">#----------------------------------------</div>
<div class="line"># Fill 2 front surface bottom profile (6)</div>
<div class="line">#----------------------------------------</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=ag1/2-dx_w</div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag1/4/a1)-a3/2</div>
<div class="line">B_coef=math.pi/(ag1-2*a1)</div>
<div class="line">C_coef=math.pi*(ag1-4*a1)/2/(ag1-2*a1)</div>
<div class="line">D_coef=a3/2*math.sin(math.pi*ag1/4/a1)-a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef;</div>
<div class="line">    coordz=coordz;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=3406;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;    </div>
<div class="line"> </div>
<div class="line">#-------------------------------------</div>
<div class="line"># Wrap 1 front surface top profile (9)</div>
<div class="line">#-------------------------------------</div>
<div class="line"> </div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=-2*a2+ag2/2-dy_w</div>
<div class="line"> </div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=-math.pi/(2*a2)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=-a3/2</div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef </div>
<div class="line">    coordz=coordz;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)</div>
<div class="line">    </div>
<div class="line">dzmax=A_coef*math.sin(B_coef*(-a2)+C_coef)+D_coef</div>
<div class="line">dzmin=A_coef*math.sin(B_coef*(-ag2/2)+C_coef)+D_coef</div>
<div class="line">dz_w1=dzmax-dzmin</div>
<div class="line">    </div>
<div class="line">#-----------------------------------------</div>
<div class="line"># Warp 1 front surface bottom profile (10)</div>
<div class="line">#-----------------------------------------  </div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=-2*a2+ag2/2-dy_w </div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag2/4/a2)-a3/2</div>
<div class="line">B_coef=-math.pi/(ag2-2*a2)</div>
<div class="line">C_coef=math.pi*(ag2-4*a2)/2/(ag2-2*a2)</div>
<div class="line">D_coef=a3/2*math.sin(math.pi*ag2/4/a2)-a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef; </div>
<div class="line">    coordz=coordz;  </div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)  </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=3808;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">#-------------------------------------</div>
<div class="line"># Wrap 2 front surface top profile (13)</div>
<div class="line">#-------------------------------------</div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=ag2/2-dy_w</div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag2/4/a2)-a3/2</div>
<div class="line">B_coef=-math.pi/(ag2-2*a2)</div>
<div class="line">C_coef=-math.pi*(ag2-4*a2)/2/(ag2-2*a2)</div>
<div class="line">D_coef=-a3/2*math.sin(math.pi*ag2/4/a2)+a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">dzmax=A_coef*math.sin(B_coef*a2+C_coef)+D_coef</div>
<div class="line">dzmin=A_coef*math.sin(B_coef*ag2/2+C_coef)+D_coef</div>
<div class="line">dz_w2=dzmax-dzmin</div>
<div class="line">#-----------------------------------------</div>
<div class="line"># Warp 2 front surface bottom profile (14)</div>
<div class="line">#-----------------------------------------  </div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=ag2/2-dy_w   </div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=-math.pi/(2*a2)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=a3/2</div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;  </div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)     </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=4210;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Create yarn cross-section and </div>
<div class="line">#        sweep along guideline/path to generate yarn volume</div>
<div class="line"># </div>
<div class="line"> </div>
<div class="line"># Fill/weft 1-2</div>
<div class="line">cubit.cmd(&#39;create surface curve 5 6&#39;)  </div>
<div class="line">cubit.cmd(&#39;create surface curve 7 8&#39;) </div>
<div class="line"># Warp 1-2</div>
<div class="line">cubit.cmd(&#39;create surface curve 9 10&#39;)  </div>
<div class="line">cubit.cmd(&#39;create surface curve 11 12&#39;)  </div>
<div class="line"> </div>
<div class="line">str1=&#39;move surface 1 x 0 y &#39;+str(-a1)+&#39; z &#39;+str(-(a3+da3)/2); cubit.cmd(str1);</div>
<div class="line">str1=&#39;move surface 2 x 0 y &#39;+str(-a1)+&#39; z &#39;+str((a3+da3)/2); cubit.cmd(str1);</div>
<div class="line">str1=&#39;move surface 3 x &#39;+str(-a2)+&#39; y 0 z &#39;+str((a3+da3)/2); cubit.cmd(str1);</div>
<div class="line">str1=&#39;move surface 4 x &#39;+str(-a2)+&#39; y 0 z &#39;+str(-(a3+da3)/2); cubit.cmd(str1);</div>
<div class="line"> </div>
<div class="line">str1=&#39;curve 1 copy move x &#39;+str(-W_weft)+&#39; y 0 z &#39;+str(-dz_f1);cubit.cmd(str1)</div>
<div class="line">str1=&#39;curve 1 copy move x &#39;+str(W_weft)+&#39; y 0 z &#39;+str(-dz_f1);cubit.cmd(str1)</div>
<div class="line">str1=&#39;curve 2 copy move x &#39;+str(-W_weft)+&#39; y 0 z &#39;+str(-dz_f2);cubit.cmd(str1)</div>
<div class="line">str1=&#39;curve 2 copy move x &#39;+str(W_weft)+&#39; y 0 z &#39;+str(-dz_f2);cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">str1=&#39;curve 3 copy move x 0 y &#39;+str(-W_warp)+&#39; z &#39;+str(-dz_w1);cubit.cmd(str1)</div>
<div class="line">str1=&#39;curve 3 copy move x 0 y &#39;+str(W_warp)+&#39; z &#39;+str(-dz_w1);cubit.cmd(str1)</div>
<div class="line">str1=&#39;curve 4 copy move x 0 y &#39;+str(-W_warp)+&#39; z &#39;+str(-dz_w2);cubit.cmd(str1)</div>
<div class="line">str1=&#39;curve 4 copy move x 0 y &#39;+str(W_warp)+&#39; z &#39;+str(-dz_w2);cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">str1=&#39;surface 1 copy move x 0 y &#39;+str(-W_RVE)+&#39; z 0&#39;;cubit.cmd(str1)</div>
<div class="line">str1=&#39;surface 2 copy move x 0 y &#39;+str(-W_RVE)+&#39; z 0&#39;;cubit.cmd(str1)</div>
<div class="line">str1=&#39;surface 3 copy move x &#39;+str(-L_RVE)+&#39; y 0 z 0&#39;;cubit.cmd(str1)</div>
<div class="line">str1=&#39;surface 4 copy move x &#39;+str(-L_RVE)+&#39; y 0 z 0&#39;;cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;create surface 5 22 13 14&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 6 21 13 14&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 7 24 15 16&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 8 23 15 16&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 9 26 17 18&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 10 25 17 18&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 11 28 19 20&#39;)</div>
<div class="line">cubit.cmd(&#39;create surface 12 27 19 20&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;create volume surface 1 5 9 10&#39;)</div>
<div class="line">cubit.cmd(&#39;create volume surface 2 6 11 12&#39;)</div>
<div class="line">cubit.cmd(&#39;create volume surface 3 7 13 14&#39;)</div>
<div class="line">cubit.cmd(&#39;create volume surface 4 8 15 16&#39;)</div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Deletion of remaining free vertices, curves and bodies </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;delete vertex all&#39;)</div>
<div class="line">cubit.cmd(&#39;delete curve all&#39;)</div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Create matrix and imprint and merge fibres and matrix to create common surfaces</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">str1=&#39;brick x &#39;+str(L_RVE)+&#39; y &#39;+str(W_RVE)+&#39; z &#39;+str(H_RVE); cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;intersect volume all keep&#39;)</div>
<div class="line">cubit.cmd(&#39;subtract volume 18 19 20 21 from volume 17 keep&#39;)</div>
<div class="line">cubit.cmd(&#39;delete volume 10 12 14 16 17&#39;)</div>
<div class="line">cubit.cmd(&#39;imprint volume 18 19 20 21 22&#39;)   </div>
<div class="line">cubit.cmd(&#39;merge volume 18 19 20 21 22&#39;) </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Meshing negative x, y and z face of the RVE and coping the same to its positive faces</div>
<div class="line">#=============================================================</div>
<div class="line"># 1: +x 2: +y 3: +z</div>
<div class="line"># 4: -x 5: -y 6: -z  </div>
<div class="line">cubit.cmd(&#39;group &quot;g1&quot; add surface 34 38 52&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g2&quot; add surface 26 30 51&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g3&quot; add surface 47&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g4&quot; add surface 33 37 50&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g5&quot; add surface 25 29 49&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g6&quot; add surface 48&#39;) </div>
<div class="line"> </div>
<div class="line"># --------</div>
<div class="line"># x plane</div>
<div class="line"># --------</div>
<div class="line">cubit.cmd(&#39;surface 52 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 52 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 52&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 50 scheme copy source surface 52 source vertex 4697 target vertex 4700 source curve 113 target curve 115 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 50&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 34 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 34 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 34&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 33 scheme copy source surface 34 source vertex 4674 target vertex 4673 source curve 78 target curve 80 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 33&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 38 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 38 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 38&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 37 scheme copy source surface 38 source vertex 4678 target vertex 4677 source curve 84 target curve 86 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 37&#39;)</div>
<div class="line"> </div>
<div class="line"># --------</div>
<div class="line"># y plane</div>
<div class="line"># --------</div>
<div class="line">#</div>
<div class="line">cubit.cmd(&#39;surface 51 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 51 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 51&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 49 scheme copy source surface 51 source vertex 4698 target vertex 4697 source curve 114 target curve 116 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 49&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 26 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 26 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 26&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 25 scheme copy source surface 26 source vertex 4666 target vertex 4665 source curve 68 target curve 66 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 25&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 30 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 30 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 30&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 29 scheme copy source surface 30 source vertex 4670 target vertex 4669 source curve 74 target curve 72 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 29&#39;)</div>
<div class="line"> </div>
<div class="line"># --------</div>
<div class="line"># z plane</div>
<div class="line"># --------</div>
<div class="line">cubit.cmd(&#39;surface 47 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 47 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 47&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 48 scheme copy source surface 47 source vertex 4700 target vertex 4703 source curve 116 target curve 118 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 48&#39;)</div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Mesh volume </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;volume all scheme Tetmesh&#39;) </div>
<div class="line">cubit.cmd(&#39;mesh volume all&#39;) </div>
<div class="line"> </div>
<div class="line">#================================================================================ </div>
<div class="line"># Defining blocks for elastic, transversely-isotropic and potential flow problems  </div>
<div class="line">#================================================================================ </div>
<div class="line"> </div>
<div class="line">vol=[&#39;22&#39;, &#39;18,19,20,21&#39;, &#39;18&#39;, &#39;19&#39;, &#39;20&#39;, &#39;21&#39;]  </div>
<div class="line">mat=[&#39;MAT_ELASTIC_1&#39;,&#39;MAT_ELASTIC_TRANSISO_1&#39;,&#39;PotentialFlow_1&#39;,&#39;PotentialFlow_2&#39;,&#39;PotentialFlow_3&#39;,&#39;PotentialFlow_4&#39;]  </div>
<div class="line">for i in range(0, 6):  </div>
<div class="line">    cubit.cmd(&#39;set duplicate block elements on&#39;) </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; volume &#39;+vol[i]; cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; name &quot;&#39;+mat[i] + &#39;&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line">    </div>
<div class="line">#============================================================= </div>
<div class="line"># Material properties for matrix part  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;block 1 attribute count 2&#39;)  </div>
<div class="line">Em=3.4e3; Enu=0.35;  #gig to mega as we used dimension in mm  </div>
<div class="line"> </div>
<div class="line">Elastic=[str(Em), str(Enu)]  </div>
<div class="line">for i in range(0, 2):  </div>
<div class="line">    str1=&#39;block 1 attribute index &#39; + str(i+1) +&#39; &#39;+Elastic[i]; cubit.cmd(str1)     </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Material properties for fibres  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">#to use as isotropic </div>
<div class="line">#cubit.cmd(&#39;block 2 attribute count 5&#39;)    </div>
<div class="line">#Ep=Em; Ez=Em; nup=Enu; nupz=Enu;  Gzp=Em/(2*(1+Enu));  </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;block 2 attribute count 5&#39;)    </div>
<div class="line">Ep=19.489e3; Ez=160.755e3; nup=0.415; nupz=0.03395; Gzp=7.393e3;    </div>
<div class="line">   </div>
<div class="line">TransIso=[str(Ep), str(Ez), str(nup), str(nupz), str(Gzp)]   </div>
<div class="line">for i in range(0, 5):   </div>
<div class="line">    str1=&#39;block 2 attribute index &#39; + str(i+1) +&#39; &#39;+TransIso[i]; cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Material properties for interface between fibres and matrix  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">alpha_interf=500 </div>
<div class="line">cubit.cmd(&#39;set duplicate block elements on&#39;)  </div>
<div class="line">str1=&#39;block 7 surface 23 24 27 28 31 32 35 36&#39;; cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 name &quot;MAT_INTERF_1&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line">cubit.cmd(&#39;block 7 attribute count 4&#39;)  </div>
<div class="line">str1=&#39;block 7 attribute index 1 &#39;+str(alpha_interf); cubit.cmd(str1)    #now we use 4 parameters for interface  </div>
<div class="line">str1=&#39;block 7 attribute index 2 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 3 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 4 &#39;+str(0.0); cubit.cmd(str1)   </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Defining interfaces </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Interface=[&#39;23&#39;, &#39;24&#39;,&#39;27&#39;,&#39;28&#39;, &#39;31&#39;, &#39;32&#39;,&#39;35&#39;,&#39;36&#39;]   </div>
<div class="line">for i in range(0, 8):   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; surface &#39;+Interface[i]; cubit.cmd(str1)   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; name &quot;interface&#39;+str(i+1); cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Defining pressures for potential flow problem  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Pres=[&#39;25&#39;,&#39;26&#39;,&#39;29&#39;,&#39;30&#39;,&#39;33&#39;,&#39;34&#39;,&#39;37&#39;,&#39;38&#39;]; count=0;  count1=len(Interface);</div>
<div class="line">for i in range(0, 4):  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+1)+&#39; on surface &#39;+str(Pres[count])+&#39; magnitude 1&#39;;  cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+2)+&#39; on surface &#39;+str(Pres[count+1])+&#39; magnitude -1&#39;;  cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+1)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_1&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+2)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_2&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    count=count+2;   count1=count1+2;   </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Definign zero proessrues for potential flow problem (This should be of the same order as PotentialFlow blocks )</div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">#zeroPressureNode=[178, 172, 8, 2] # autofactor = 8</div>
<div class="line">#zeroPressureNode=[233, 223, 12, 2] # autofactor = 7</div>
<div class="line">#zeroPressureNode=[290, 276, 16, 2] # autofactor = 6</div>
<div class="line">zeroPressureNode=[366, 344, 24, 2] # autofactor = 5</div>
<div class="line"># zeroPressureNode=[816, 782, 36, 2] # autofactor = 4</div>
<div class="line">for i in range(0, 4):  </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1) + &#39; node &#39; + str(zeroPressureNode[i]); cubit.cmd(str1) </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1)+&#39; name &quot;ZeroPressure_&#39; + str(i+1)+ &#39;&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    </div>
<div class="line">#============================================================= </div>
<div class="line"># Defining surfaces for dispacement, traction and periodic boundary conditions  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;sideset 101 surface 33 37 50 25 29 49 48&#39;)  # all -ve boundary surfaces for periodic boundary conditions  </div>
<div class="line">cubit.cmd(&#39;sideset 102 surface 34 38 52 26 30 51 47&#39;)  # all +ve boundary surfaces  for periodic boundary conditions  </div>
<div class="line">cubit.cmd(&#39;sideset 103 surface 34 38 52 26 30 51 47 33 37 50 25 29 49 48&#39;)  # all boundary surfaces     </div>
</div><!-- fragment --><p>The CUBIT journal file used to generate the input model for Scida RVE is given as: </p><div class="fragment"><div class="line">#!python</div>
<div class="line">#This scrip will create RVE including fibres and matrix, which can be used for all </div>
<div class="line">#three type of boundary conditions including dispalcement, traction and periodic. </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;new&#39;)</div>
<div class="line">#=============================================================</div>
<div class="line">#Geometry Input parametrs</div>
<div class="line">#=============================================================</div>
<div class="line">a1=0.6</div>
<div class="line">a2=0.6</div>
<div class="line">a3=0.05</div>
<div class="line">ag1=0.02</div>
<div class="line">ag2=0.02</div>
<div class="line"> </div>
<div class="line">W_warp=a2-ag2/2</div>
<div class="line">W_weft=a1-ag1/2</div>
<div class="line"> </div>
<div class="line">L_RVE=4*a2</div>
<div class="line">W_RVE=4*a1</div>
<div class="line">H_RVE=2.28*a3 </div>
<div class="line"> </div>
<div class="line">dy_w=W_warp/100</div>
<div class="line">dy_g=ag2/50   </div>
<div class="line">dx_w=W_weft/100</div>
<div class="line">dx_g=ag1/50  </div>
<div class="line"> </div>
<div class="line">autofactor=7; </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Create vartices for splines to create splines</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">import math</div>
<div class="line">da3=0.003;</div>
<div class="line">a3=a3+da3;</div>
<div class="line">#---------------------</div>
<div class="line"># Fill 1 path (14) top</div>
<div class="line">#---------------------</div>
<div class="line">coordx=-a1</div>
<div class="line">coordy=-3*a2-dy_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordy=coordy+dy_w;</div>
<div class="line">    else:</div>
<div class="line">        coordy=coordy+dy_g;</div>
<div class="line">    coordz=a3/2*(math.sin(-math.pi*(coordy)/(2*a2)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">#---------------------</div>
<div class="line"># Fill 2 path (12) top</div>
<div class="line">#---------------------      </div>
<div class="line">coordx=a1</div>
<div class="line">coordy=-3*a2-dy_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordy=coordy+dy_w;</div>
<div class="line">    else:</div>
<div class="line">        coordy=coordy+dy_g;</div>
<div class="line">    coordz=a3/2*(math.sin(math.pi*(coordy)/(2*a2)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line">        </div>
<div class="line">#---------------------</div>
<div class="line"># Warp 1 path (2) top</div>
<div class="line">#---------------------</div>
<div class="line">coordy=-a2</div>
<div class="line">coordx=-3*a1-dx_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordx=coordx+dx_w;</div>
<div class="line">    else:</div>
<div class="line">        coordx=coordx+dx_g;</div>
<div class="line">    coordz=a3/2*(math.sin(math.pi*(coordx)/(2*a1)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#---------------------</div>
<div class="line"># Warp 2 path (8) top</div>
<div class="line">#---------------------</div>
<div class="line">coordy=a2</div>
<div class="line">coordx=-3*a1-dx_w </div>
<div class="line">for i in range(0, 751):</div>
<div class="line">    if (i&lt;101) or (i&gt;150 and i&lt;351) or (i&gt;400 and i&lt;601) or (i&gt;650):</div>
<div class="line">        coordx=coordx+dx_w;</div>
<div class="line">    else:</div>
<div class="line">        coordx=coordx+dx_g;</div>
<div class="line">    coordz=a3/2*(math.sin(-math.pi*(coordx)/(2*a1)))+a3/2</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)         </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Joint vertices to create splines </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">Tvertices=751;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=0;   </div>
<div class="line">for i in range(0, 4): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 751):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+751;   </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Creating yarns/inclusions with sinusoidal cross sections  </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">a3=a3-da3;</div>
<div class="line">#-------------------------------------</div>
<div class="line"># Fill 1 front surface top profile (1)</div>
<div class="line">#-------------------------------------</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=-2*a1+ag1/2-dx_w</div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag1/4/a1)-a3/2</div>
<div class="line">B_coef=math.pi/(ag1-2*a1)</div>
<div class="line">C_coef=-math.pi*(ag1-4*a1)/2/(ag1-2*a1)</div>
<div class="line">D_coef=-a3/2*math.sin(math.pi*ag1/4/a1)+a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">#----------------------------------------</div>
<div class="line"># Fill 1 front surface bottom profile (2)</div>
<div class="line">#----------------------------------------   </div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=math.pi/(2*a1)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=a3/2</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=-2*a1+ag1/2-dx_w </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)     </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=3004;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;</div>
<div class="line"> </div>
<div class="line">#-------------------------------------</div>
<div class="line"># Fill 2 front surface top profile (5)</div>
<div class="line">#-------------------------------------</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=ag1/2-dx_w</div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=math.pi/(2*a1)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=-a3/2</div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef;</div>
<div class="line">    coordz=coordz;  </div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#----------------------------------------</div>
<div class="line"># Fill 2 front surface bottom profile (6)</div>
<div class="line">#----------------------------------------</div>
<div class="line">coordy=3*a2</div>
<div class="line">coordx=ag1/2-dx_w</div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag1/4/a1)-a3/2</div>
<div class="line">B_coef=math.pi/(ag1-2*a1)</div>
<div class="line">C_coef=math.pi*(ag1-4*a1)/2/(ag1-2*a1)</div>
<div class="line">D_coef=a3/2*math.sin(math.pi*ag1/4/a1)-a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordx=coordx+dx_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordx+C_coef)+D_coef;</div>
<div class="line">    coordz=coordz;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=3406;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;    </div>
<div class="line"> </div>
<div class="line">#-------------------------------------</div>
<div class="line"># Wrap 1 front surface top profile (9)</div>
<div class="line">#-------------------------------------</div>
<div class="line"> </div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=-2*a2+ag2/2-dy_w</div>
<div class="line"> </div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=-math.pi/(2*a2)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=-a3/2</div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef </div>
<div class="line">    coordz=coordz;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)</div>
<div class="line">#-----------------------------------------</div>
<div class="line"># Warp 1 front surface bottom profile (10)</div>
<div class="line">#-----------------------------------------  </div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=-2*a2+ag2/2-dy_w </div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag2/4/a2)-a3/2</div>
<div class="line">B_coef=-math.pi/(ag2-2*a2)</div>
<div class="line">C_coef=math.pi*(ag2-4*a2)/2/(ag2-2*a2)</div>
<div class="line">D_coef=a3/2*math.sin(math.pi*ag2/4/a2)-a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef; </div>
<div class="line">    coordz=coordz;  </div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)  </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=3808;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;</div>
<div class="line">    </div>
<div class="line"> </div>
<div class="line">#-------------------------------------</div>
<div class="line"># Wrap 2 front surface top profile (13)</div>
<div class="line">#-------------------------------------</div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=ag2/2-dy_w</div>
<div class="line">A_coef=-a3/2*math.sin(math.pi*ag2/4/a2)-a3/2</div>
<div class="line">B_coef=-math.pi/(ag2-2*a2)</div>
<div class="line">C_coef=-math.pi*(ag2-4*a2)/2/(ag2-2*a2)</div>
<div class="line">D_coef=-a3/2*math.sin(math.pi*ag2/4/a2)+a3/2 </div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;</div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)</div>
<div class="line"> </div>
<div class="line">#-----------------------------------------</div>
<div class="line"># Warp 2 front surface bottom profile (14)</div>
<div class="line">#-----------------------------------------  </div>
<div class="line">coordx=3*a1</div>
<div class="line">coordy=ag2/2-dy_w   </div>
<div class="line">A_coef=a3/2</div>
<div class="line">B_coef=-math.pi/(2*a2)</div>
<div class="line">C_coef=0</div>
<div class="line">D_coef=a3/2</div>
<div class="line">for i in range(0, 201):</div>
<div class="line">    coordy=coordy+dy_w;</div>
<div class="line">    coordz=A_coef*math.sin(B_coef*coordy+C_coef)+D_coef</div>
<div class="line">    coordz=coordz+da3;  </div>
<div class="line">    str1=&#39;create vertex &#39; + str(coordx) +&#39; &#39;+str(coordy)+&#39; &#39;+str(coordz)+&#39; color&#39; ;</div>
<div class="line">    cubit.cmd(str1)     </div>
<div class="line"> </div>
<div class="line">Tvertices=201;  </div>
<div class="line">vertices=range(1,Tvertices+1); count1=4210;   </div>
<div class="line">for i in range(0, 2): </div>
<div class="line">    str1=&#39;create curve spline vertex &#39;</div>
<div class="line">    for j in range(0, 201):</div>
<div class="line">        str1=str1+&#39; &#39;+ str(count1+vertices[j])</div>
<div class="line">    cubit.cmd(str1);  count1=count1+201;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"># Create yarn cross-section and </div>
<div class="line">#        sweep along guideline/path to generate yarn volume</div>
<div class="line"># </div>
<div class="line"> </div>
<div class="line"># Fill/weft 1-2</div>
<div class="line">cubit.cmd(&#39;create surface curve 5 6&#39;)  </div>
<div class="line">cubit.cmd(&#39;create surface curve 7 8&#39;) </div>
<div class="line"># Warp 1-2</div>
<div class="line">cubit.cmd(&#39;create surface curve 9 10&#39;)  </div>
<div class="line">cubit.cmd(&#39;create surface curve 11 12&#39;)  </div>
<div class="line">#</div>
<div class="line">cubit.cmd(&#39;sweep surface 1 along curve 1&#39;)   </div>
<div class="line">cubit.cmd(&#39;sweep surface 2 along curve 2&#39;) </div>
<div class="line">cubit.cmd(&#39;sweep surface 3 along curve 3&#39;)   </div>
<div class="line">cubit.cmd(&#39;sweep surface 4 along curve 4&#39;)  </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Deletion of remaining free vertices, curves and bodies </div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;delete vertex all&#39;)</div>
<div class="line">cubit.cmd(&#39;delete curve all&#39;)</div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Create matrix and imprint and merge fibres and matrix to create common surfaces</div>
<div class="line">#=============================================================</div>
<div class="line"> </div>
<div class="line">str1=&#39;brick x &#39;+str(L_RVE)+&#39; y &#39;+str(W_RVE)+&#39; z &#39;+str(H_RVE); cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;intersect volume all keep&#39;)</div>
<div class="line">cubit.cmd(&#39;subtract volume 6 7 8 9 from volume 5 keep&#39;)</div>
<div class="line">cubit.cmd(&#39;delete volume 1 2 3 4 5&#39;)</div>
<div class="line">cubit.cmd(&#39;imprint volume 6 7 8 9 10&#39;)   </div>
<div class="line">cubit.cmd(&#39;merge volume 6 7 8 9 10&#39;) </div>
<div class="line"> </div>
<div class="line">#=============================================================</div>
<div class="line">#Meshing negative x, y and z face of the RVE and coping the same to its positive faces</div>
<div class="line">#=============================================================</div>
<div class="line"># 1: +x 2: +y 3: +z</div>
<div class="line"># 4: -x 5: -y 6: -z  </div>
<div class="line">cubit.cmd(&#39;group &quot;g1&quot; add surface 34 38 52&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g2&quot; add surface 26 30 51&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g3&quot; add surface 47&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g4&quot; add surface 33 37 50&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g5&quot; add surface 25 29 49&#39;) </div>
<div class="line">cubit.cmd(&#39;group &quot;g6&quot; add surface 48&#39;) </div>
<div class="line"> </div>
<div class="line"># --------</div>
<div class="line"># x plane</div>
<div class="line"># --------</div>
<div class="line">cubit.cmd(&#39;surface 52 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 52 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 52&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 50 scheme copy source surface 52 source vertex 4661 target vertex 4664 source curve 89 target curve 91 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 50&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 34 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 34 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 34&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 33 scheme copy source surface 34 source vertex 4640 target vertex 4637 source curve 55 target curve 53 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 33&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 38 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 38 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 38&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 37 scheme copy source surface 38 source vertex 4644 target vertex 4641 source curve 61 target curve 59 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 37&#39;)</div>
<div class="line"> </div>
<div class="line"># --------</div>
<div class="line"># y plane</div>
<div class="line"># --------</div>
<div class="line">#</div>
<div class="line">cubit.cmd(&#39;surface 51 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 51 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 51&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 49 scheme copy source surface 51 source vertex 4662 target vertex 4661 source curve 90 target curve 92 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 49&#39;)</div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 26 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 26 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 26&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 25 scheme copy source surface 26 source vertex 4631 target vertex 4630 source curve 43 target curve 41 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 25&#39;) </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;surface 30 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 30 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 30&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 29 scheme copy source surface 30 source vertex 4635 target vertex 4634 source curve 49 target curve 47 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 29&#39;)</div>
<div class="line"> </div>
<div class="line"># --------</div>
<div class="line"># z plane</div>
<div class="line"># --------</div>
<div class="line">cubit.cmd(&#39;surface 47 scheme trimesh&#39;) </div>
<div class="line">str1=&#39;surface 47 size auto factor &#39;+str(autofactor); cubit.cmd(str1)</div>
<div class="line">cubit.cmd(&#39;mesh surface 47&#39;) </div>
<div class="line">cubit.cmd(&#39;surface 48 scheme copy source surface 47 source vertex 4664 target vertex 4667 source curve 92 target curve 94 nosmoothing&#39;)</div>
<div class="line">cubit.cmd(&#39;mesh surface 48&#39;)</div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Mesh volume </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;volume all scheme Tetmesh&#39;) </div>
<div class="line">cubit.cmd(&#39;mesh volume all&#39;) </div>
<div class="line"> </div>
<div class="line">#================================================================================ </div>
<div class="line"># Defining blocks for elastic, transversely-isotropic and potential flow problems  </div>
<div class="line">#================================================================================ </div>
<div class="line"> </div>
<div class="line">vol=[&#39;10&#39;, &#39;6,7,8,9&#39;, &#39;6&#39;, &#39;7&#39;, &#39;8&#39;, &#39;9&#39;]  </div>
<div class="line">mat=[&#39;MAT_ELASTIC_1&#39;,&#39;MAT_ELASTIC_TRANSISO_1&#39;,&#39;PotentialFlow_1&#39;,&#39;PotentialFlow_2&#39;,&#39;PotentialFlow_3&#39;,&#39;PotentialFlow_4&#39;]  </div>
<div class="line">for i in range(0, 6):  </div>
<div class="line">    cubit.cmd(&#39;set duplicate block elements on&#39;) </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; volume &#39;+vol[i]; cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;block  &#39; + str(i+1) +&#39; name &quot;&#39;+mat[i] + &#39;&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line">    </div>
<div class="line">#============================================================= </div>
<div class="line"># Material properties for matrix part  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;block 1 attribute count 2&#39;)  </div>
<div class="line">Em=3.4e3; Enu=0.35;  #gig to mega as we used dimension in mm  </div>
<div class="line"> </div>
<div class="line">Elastic=[str(Em), str(Enu)]  </div>
<div class="line">for i in range(0, 2):  </div>
<div class="line">    str1=&#39;block 1 attribute index &#39; + str(i+1) +&#39; &#39;+Elastic[i]; cubit.cmd(str1)     </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Material properties for fibres  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">#to use as isotropic </div>
<div class="line">#cubit.cmd(&#39;block 2 attribute count 5&#39;)    </div>
<div class="line">#Ep=Em; Ez=Em; nup=Enu; nupz=Enu;  Gzp=Em/(2*(1+Enu));  </div>
<div class="line"> </div>
<div class="line">cubit.cmd(&#39;block 2 attribute count 5&#39;)    </div>
<div class="line">Ep=20.865e3; Ez=58.397e3; nup=0.386; nupz=0.08611; Gzp=8.465e3;    </div>
<div class="line">   </div>
<div class="line">TransIso=[str(Ep), str(Ez), str(nup), str(nupz), str(Gzp)]   </div>
<div class="line">for i in range(0, 5):   </div>
<div class="line">    str1=&#39;block 2 attribute index &#39; + str(i+1) +&#39; &#39;+TransIso[i]; cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Material properties for interface between fibres and matrix  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">alpha_interf=500 </div>
<div class="line">cubit.cmd(&#39;set duplicate block elements on&#39;)  </div>
<div class="line">str1=&#39;block 7 surface 23 24 27 28 31 32 35 36&#39;; cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 name &quot;MAT_INTERF_1&quot;&#39;; cubit.cmd(str1)  </div>
<div class="line">cubit.cmd(&#39;block 7 attribute count 4&#39;)  </div>
<div class="line">str1=&#39;block 7 attribute index 1 &#39;+str(alpha_interf); cubit.cmd(str1)    #now we use 4 parameters for interface  </div>
<div class="line">str1=&#39;block 7 attribute index 2 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 3 &#39;+str(0.0); cubit.cmd(str1)  </div>
<div class="line">str1=&#39;block 7 attribute index 4 &#39;+str(0.0); cubit.cmd(str1)   </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Defining interfaces </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Interface=[&#39;23&#39;, &#39;24&#39;,&#39;27&#39;,&#39;28&#39;, &#39;31&#39;, &#39;32&#39;,&#39;35&#39;,&#39;36&#39;]   </div>
<div class="line">for i in range(0, 8):   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; surface &#39;+Interface[i]; cubit.cmd(str1)   </div>
<div class="line">    str1=&#39;sideset &#39; + str(i+1) +&#39; name &quot;interface&#39;+str(i+1); cubit.cmd(str1) </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Defining pressures for potential flow problem  </div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">Pres=[&#39;25&#39;,&#39;26&#39;,&#39;29&#39;,&#39;30&#39;,&#39;33&#39;,&#39;34&#39;,&#39;37&#39;,&#39;38&#39;]; count=0;  count1=len(Interface);</div>
<div class="line">for i in range(0, 4):  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+1)+&#39; on surface &#39;+str(Pres[count])+&#39; magnitude 1&#39;;  cubit.cmd(str1)  </div>
<div class="line">    str1=&#39;create pressure &#39;+str(count+2)+&#39; on surface &#39;+str(Pres[count+1])+&#39; magnitude -1&#39;;  cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+1)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_1&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    str1=&#39;sideset &#39;+str(count1+2)+&#39; name &quot;PressureIO_&#39; + str(i+1) + &#39;_2&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    count=count+2;   count1=count1+2;   </div>
<div class="line"> </div>
<div class="line">#============================================================= </div>
<div class="line"># Definign zero proessrues for potential flow problem (This should be of the same order as PotentialFlow blocks )</div>
<div class="line">#============================================================= </div>
<div class="line"> </div>
<div class="line">#zeroPressureNode=[545, 517, 30, 2]</div>
<div class="line">#zeroPressureNode=[660, 618, 157, 115]</div>
<div class="line">#zeroPressureNode=[561, 519, 44, 2]</div>
<div class="line"># da3=0.003; H_RVE=2.28*a3</div>
<div class="line">zeroPressureNode=[407, 389, 20, 2] </div>
<div class="line"># da3=0.002; H_RVE=2.22*a3</div>
<div class="line">#zeroPressureNode=[409, 391, 20, 2] </div>
<div class="line">#zeroPressureNode=[331, 319, 14, 2] </div>
<div class="line">for i in range(0, 4):  </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1) + &#39; node &#39; + str(zeroPressureNode[i]); cubit.cmd(str1) </div>
<div class="line">    str1=&#39;nodeset &#39; + str(i+1)+&#39; name &quot;ZeroPressure_&#39; + str(i+1)+ &#39;&quot;&#39;; cubit.cmd(str1) </div>
<div class="line">    </div>
<div class="line">#============================================================= </div>
<div class="line"># Defining surfaces for dispacement, traction and periodic boundary conditions  </div>
<div class="line">#============================================================= </div>
<div class="line">  </div>
<div class="line">cubit.cmd(&#39;sideset 101 surface 33 37 50 25 29 49 48&#39;)  # all -ve boundary surfaces for periodic boundary conditions  </div>
<div class="line">cubit.cmd(&#39;sideset 102 surface 34 38 52 26 30 51 47&#39;)  # all +ve boundary surfaces  for periodic boundary conditions  </div>
<div class="line">cubit.cmd(&#39;sideset 103 surface 34 38 52 26 30 51 47 33 37 50 25 29 49 48&#39;)  # all boundary surfaces     </div>
</div><!-- fragment --><h1><a class="anchor" id="comp_homo_analysis_ack"></a>
Acknowledgements</h1>
<p>Results were obtained as part of the Providing Confidence in Durable Composites (DURACOMP) project sponsored by UK Engineering and Physical Sciences Research Council (EPSRC) (Grant Ref.: EP/K026925/1).</p>
<h1><a class="anchor" id="comp_homo_analysis_ref"></a>
References</h1>
<ul>
<li>[1]. L. Kaczmarczyk, C. J. Pearce, and N. Bicanic. Scale transition and enforcement of RVE boundary conditions in second-order computational homogenization. International Journal for Numerical Methods in Engineering, 74(3):506–522, 2008.</li>
<li>[2]. M. Ainsworth and J. Coyle. Hierarchic finite element bases on unstructured tetrahedral meshes. International Journal for Numerical Methods in Engineering, 58(14):2103– 2130, 2003.</li>
<li>[3]. Z. Ullah, Ł. Kaczmarczyk and C. J. Pearce. Multiscale computational homogenisation to predict the long-term durability of composite structures. In proceedings of the 23rd UK Conference of the Association for Computational Mechanics in Engineering (ACME), University of Swansea, Swansea, UK, 8-10 April 2015, 95–98.</li>
<li>[4]. X.-Y. Zhoua, P. D. Goslinga, C. J. Pearceb, Z. Ullahb, L. Kaczmarczykb 3D Hierarchical Finite Element Implementation of Perturbation-based Stochastic Multi-scale Computational Homogenization Method for Woven Textile Composites, submitted to International Journal of Solids and Structures, 2015</li>
<li>[5]. <a class="el" href="classE.html">E</a>. J. Barbero, <a class="el" href="classT.html">T</a>. M. Damiani, J. Trovillion, Micromechanics of fabric reinforced composites with periodic microstructure. International Journal of Solids and Structures 42 (910), 2489–2504, 2005.</li>
<li>[6]. D. Scida, Z. Aboura,M. L. Benzeggagh, <a class="el" href="classE.html">E</a>. Bocherens. A microme-chanics model for 3d elasticity and failure of woven-fibre composite materials. Composites Science and Technology 59 (4), 505–517, 1999. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>