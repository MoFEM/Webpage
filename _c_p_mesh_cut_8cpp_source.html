<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: users_modules/fracture_mechanics/src/impl/CPMeshCut.cpp Source File</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fdd23f46654bee42f0ef7ae5010b806.html">users_modules</a></li><li class="navelem"><a class="el" href="dir_7626fbc05232202d1d8bfa59989e6f33.html">fracture_mechanics</a></li><li class="navelem"><a class="el" href="dir_07077e7f1516256a5d6d7071e8df818e.html">src</a></li><li class="navelem"><a class="el" href="dir_2330faccad92f32be9236dbecc1648e3.html">impl</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div class="header">
  <div class="headertitle"><div class="title">CPMeshCut.cpp</div></div>
</div><!--header-->
<div class="contents">
<a href="_c_p_mesh_cut_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">/** \file CPSolvers.cpp</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment"> */</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span> </div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">/* This file is part of MoFEM.</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment"> * MoFEM is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment"> * the terms of the GNU Lesser General Public License as published by the</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment"> * Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment"> * option) any later version.</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment"> *</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment"> * MoFEM is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span><span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span><span class="comment"> * License for more details.</span></div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="comment"> *</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="comment"> * License along with MoFEM. If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#ifdef WITH_TETGEN</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span> </div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &lt;tetgen.h&gt;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#ifdef REAL</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#undef REAL</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span> </div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &lt;<a class="code" href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &lt;<a class="code" href="_mortar_8hpp.html">Mortar.hpp</a>&gt;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &lt;<a class="code" href="_neo_hookean_8hpp.html">NeoHookean.hpp</a>&gt;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &lt;<a class="code" href="_hooke_8hpp.html">Hooke.hpp</a>&gt;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span> </div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &lt;<a class="code" href="_crack_front_element_8hpp.html">CrackFrontElement.hpp</a>&gt;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &lt;<a class="code" href="_complex_const_area_8hpp.html">ComplexConstArea.hpp</a>&gt;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &lt;<a class="code" href="_m_w_l_s_8hpp.html">MWLS.hpp</a>&gt;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &lt;<a class="code" href="_griffith_force_element_8hpp.html">GriffithForceElement.hpp</a>&gt;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#include &lt;VolumeLengthQuality.hpp&gt;</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &lt;<a class="code" href="_crack_propagation_8hpp.html">CrackPropagation.hpp</a>&gt;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &lt;<a class="code" href="_c_p_mesh_cut_8hpp.html">CPMeshCut.hpp</a>&gt;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span> </div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_fracture_mechanics.html">FractureMechanics</a> {</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span> </div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="foldopen" id="foldopen00045" data-start="{" data-end="}">
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a035106e51ac3d931a68d52df374f8e84">   45</a></span><a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a035106e51ac3d931a68d52df374f8e84">CPMeshCut::query_interface</a>(boost::typeindex::type_index type_index,</div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span>                           <a class="code hl_struct" href="struct_mo_f_e_m_1_1_unknown_interface.html">UnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span>  *iface = <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html">CPMeshCut</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>}</div>
</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="foldopen" id="foldopen00051" data-start="{" data-end="}">
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60da5d0a79906a1ee01dcc46862d8de6">   51</a></span><a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60da5d0a79906a1ee01dcc46862d8de6">CPMeshCut::CPMeshCut</a>(<a class="code hl_struct" href="struct_fracture_mechanics_1_1_crack_propagation.html">CrackPropagation</a> &amp;cp) : cP(cp) {</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>  <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">getInterfacesPtr</a>();</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  CHKERRABORT(PETSC_COMM_SELF, <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span> </div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  <span class="keywordflow">try</span> {</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>    <a class="code hl_function" href="group__mofem__log__manager.html#gab5e77a98a6ecc9e134bd34fdb161f80a">MoFEM::LogManager::getLog</a>(<span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>);</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="keyword">auto</span> core_log = logging::core::get();</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    core_log-&gt;add_sink(</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>        <a class="code hl_function" href="struct_mo_f_e_m_1_1_log_manager.html#a1eb7382ca81a927c24b76ffd20134cfd">LogManager::createSink</a>(<a class="code hl_function" href="struct_mo_f_e_m_1_1_log_manager.html#ac1e5721da24d53aa5e6f5b9901b338b3">LogManager::getStrmSelf</a>(), <span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>));</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <a class="code hl_function" href="group__mofem__log__manager.html#ga037d7b63954d2ec6d367a5c959f16068">LogManager::setLog</a>(<span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>);</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>    core_log-&gt;add_sink(</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>        <a class="code hl_function" href="struct_mo_f_e_m_1_1_log_manager.html#a1eb7382ca81a927c24b76ffd20134cfd">LogManager::createSink</a>(<a class="code hl_function" href="struct_mo_f_e_m_1_1_log_manager.html#a745c3e2cfb9fdea08ecd2e85316e8639">LogManager::getStrmWorld</a>(), <span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>));</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>    <a class="code hl_function" href="group__mofem__log__manager.html#ga037d7b63954d2ec6d367a5c959f16068">LogManager::setLog</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>);</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    core_log-&gt;add_sink(</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>        <a class="code hl_function" href="struct_mo_f_e_m_1_1_log_manager.html#a1eb7382ca81a927c24b76ffd20134cfd">LogManager::createSink</a>(<a class="code hl_function" href="struct_mo_f_e_m_1_1_log_manager.html#aab2b7c52e9893aaab48afecb6406c12f">LogManager::getStrmSync</a>(), <span class="stringliteral">&quot;CPMeshCutSync&quot;</span>));</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    <a class="code hl_function" href="group__mofem__log__manager.html#ga037d7b63954d2ec6d367a5c959f16068">LogManager::setLog</a>(<span class="stringliteral">&quot;CPMeshCutSync&quot;</span>);</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>    <a class="code hl_define" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>, <span class="stringliteral">&quot;CPMeshCut&quot;</span>);</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>    <a class="code hl_define" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, <span class="stringliteral">&quot;CPMeshCut&quot;</span>);</div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>    <a class="code hl_define" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CPMeshCutSync&quot;</span>, <span class="stringliteral">&quot;CPMeshCut&quot;</span>);</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  }</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span> </div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  <a class="code hl_define" href="group__mofem__log__manager.html#gafa1c3eb219cdb812ccdb6bad1a7a1454">MOFEM_LOG_FUNCTION</a>();</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;CPMeshCutSelf interface created&quot;</span>;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>}</div>
</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span> </div>
<div class="foldopen" id="foldopen00077" data-start="{" data-end="}">
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">   77</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">CPMeshCut::getInterfacesPtr</a>() {</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>);</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>);</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>);</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>}</div>
</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span> </div>
<div class="foldopen" id="foldopen00085" data-start="{" data-end="}">
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa00fad9f771a0e8338dcaec2e29e724f">   85</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa00fad9f771a0e8338dcaec2e29e724f">CPMeshCut::getOptions</a>() {</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>  PetscBool shift_flg;</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>  <span class="keywordtype">int</span> nmax_shift = 3;</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span> </div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Mesh cut options&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span> </div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a> = 100;</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-edges_block_set&quot;</span>, <span class="stringliteral">&quot;edges side set&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a09cc55b947e434358857d740bdd1c99d">edgesBlockSetFlg</a>);</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a> = 101;</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-vertex_block_set&quot;</span>, <span class="stringliteral">&quot;vertex block set&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, PETSC_NULL);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>  <span class="comment">//to resolve issues with newer cubit</span></div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a> = 102;</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-vertex_node_set&quot;</span>, <span class="stringliteral">&quot;vertex node set&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, PETSC_NULL);</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a> = 2;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-fraction_level&quot;</span>, <span class="stringliteral">&quot;fraction of merges merged&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>, PETSC_NULL);</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a> = 1e-2;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-tol_cut&quot;</span>, <span class="stringliteral">&quot;get tolerance for cut edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>                            <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>, PETSC_NULL);</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a> = 2e-1;</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-tol_cut_close&quot;</span>, <span class="stringliteral">&quot;get tolerance for cut edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>                            <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>, PETSC_NULL);</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a> = 2e-1;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-tol_trim_close&quot;</span>, <span class="stringliteral">&quot;get tolerance for trim edges&quot;</span>,</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>                            <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>, PETSC_NULL);</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span> </div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a> = PETSC_FALSE;</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-cut_debug_cut&quot;</span>, <span class="stringliteral">&quot;debug mesh cutting&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>,</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>                          &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>, NULL);</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span> </div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a> = PETSC_FALSE;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>      <span class="stringliteral">&quot;-remove_pathological_front_tris&quot;</span>,</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>      <span class="stringliteral">&quot;remove triangles which have three nodes on crack front&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a>, NULL);</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span> </div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>              <span class="stringliteral">&quot;### Input parameter: -fraction_level %d&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>              <span class="stringliteral">&quot;### Input parameter: -tol_cut %6.4e&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>);</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>              <span class="stringliteral">&quot;### Input parameter: -tol_cut_close %6.4e&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>              <span class="stringliteral">&quot;### Input parameter: -tol_trim_close %6.4e&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>);</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span> </div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>  PetscBool crack_surf_mesh_flg;</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>  <span class="keywordtype">char</span> crack_surf_mesh_name[255];</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      <span class="stringliteral">&quot;-my_cut_surface_file&quot;</span>, <span class="stringliteral">&quot;file with crack surface for initial cut&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>      crack_surf_mesh_name, crack_surf_mesh_name, 255, &amp;crack_surf_mesh_flg);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>  <span class="keywordflow">if</span> (crack_surf_mesh_flg)</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a> = std::string(crack_surf_mesh_name);</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span> </div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>[0] = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>[1] = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>[2] = 0;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsRealArray(<span class="stringliteral">&quot;-crack_shift&quot;</span>, <span class="stringliteral">&quot;shift surface by vector&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>, &amp;nmax_shift, &amp;shift_flg);</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span> </div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a> = 400;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      <span class="stringliteral">&quot;-cut_surface_side_set&quot;</span>, <span class="stringliteral">&quot;sideset id with cutting surface&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, PETSC_NULL);</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span> </div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a> = 102;</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-body_skin&quot;</span>, <span class="stringliteral">&quot;body skin sideset id&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, PETSC_NULL);</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a> = 200;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-crack_side_set&quot;</span>, <span class="stringliteral">&quot;sideset id with crack surface&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, PETSC_NULL);</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a> = 201;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-front_side_set&quot;</span>, <span class="stringliteral">&quot;sideset id with crack front&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, PETSC_NULL);</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span> </div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> = 0;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-ref_before_cut&quot;</span>, <span class="stringliteral">&quot;number of refinements before cut&quot;</span>,</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>                         <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>, PETSC_NULL);</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>              <span class="stringliteral">&quot;### Input parameter: -ref_before_cut %d&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>);</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span> </div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a> = 0;</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  PetscBool flg = PETSC_FALSE;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-ref_before_tim&quot;</span>, <span class="stringliteral">&quot;number of refinements before trim&quot;</span>,</div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>                         <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;flg);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>  <span class="keywordflow">if</span> (flg == PETSC_TRUE) {</div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform)</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>        &lt;&lt; <span class="stringliteral">&quot;### Input parameter: -ref_before_tim is still valid but will be &quot;</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>           <span class="stringliteral">&quot;made obsolete in the next release, please use -ref_before_trim &quot;</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>           <span class="stringliteral">&quot;instead.&quot;</span>;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>  }</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span> </div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-ref_before_trim&quot;</span>,</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>                         <span class="stringliteral">&quot;number of refinements before trim&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>                         <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, PETSC_NULL);</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>              <span class="stringliteral">&quot;### Input parameter: -ref_before_trim %d&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span> </div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> = -1;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <span class="stringliteral">&quot;-my_cracked_body_block_set&quot;</span>, <span class="stringliteral">&quot;blockset id of the cracked body&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, PETSC_NULL);</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span> </div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>              <span class="stringliteral">&quot;### Input parameter: -my_cracked_body_block_set %d&quot;</span>,</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>              <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>);</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span> </div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a> = 10000;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>      <span class="stringliteral">&quot;-my_contact_prisms_block_set&quot;</span>, <span class="stringliteral">&quot;blockset id of contact prisms&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, PETSC_NULL);</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span> </div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>  <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>  <a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span> </div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>  <span class="keywordflow">if</span> (shift_flg &amp;&amp; nmax_shift != 3) {</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;three values expected&quot;</span>);</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>}</div>
</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span> </div>
<div class="foldopen" id="foldopen00209" data-start="{" data-end="}">
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae0315c5240da22b778d5dbed90e6d01a">  209</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae0315c5240da22b778d5dbed90e6d01a">CPMeshCut::setVolume</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  <a class="code hl_class" href="class_range.html">Range</a> bit_tets;</div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>                                                 MBTET, bit_tets);</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac49c841036ab310c3ade79eff45ddc1f">setVolume</a>(bit_tets);</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>}</div>
</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span> </div>
<div class="foldopen" id="foldopen00218" data-start="{" data-end="}">
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aac80b6de09e6f065a25a8b2a8f30f9bd">  218</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aac80b6de09e6f065a25a8b2a8f30f9bd">CPMeshCut::refineMesh</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> *vol, <span class="keyword">const</span> <span class="keywordtype">bool</span> make_front,</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                                     <span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span> </div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>  <span class="keywordflow">if</span> (vol) {</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga57f6316b2f1061a314f40eb794d733ab">setBitRefLevel</a>(</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>        *vol, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_define" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - 1), <span class="keyword">true</span>, verb);</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac49c841036ab310c3ade79eff45ddc1f">setVolume</a>(*vol);</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  } <span class="keywordflow">else</span></div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>    <span class="comment">// Set cutted front</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae0315c5240da22b778d5dbed90e6d01a">setVolume</a>(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_define" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - 1));</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span> </div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a557a1b16f8c7516726e4a1e85cc8ff17">setMeshOrgCoords</a>();</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span> </div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  <span class="keywordflow">if</span> (make_front)</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>    <span class="comment">// make crack front from mesh skin</span></div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad76d17c62d4f9337953222d2092697ab">makeFront</a>(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>  <span class="keyword">auto</span> save_entities = [&amp;](<span class="keyword">const</span> std::string name, <a class="code hl_class" href="class_range.html">Range</a> ents) {</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>    <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>    <span class="keywordflow">if</span> (!ents.empty()) {</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset, ents);</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>                                             1);</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>    }</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>  };</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span> </div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>  <span class="comment">// build tree</span></div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a67d0cdac80f09af5b4d821c671600ae9">buildTree</a>();</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>  <span class="comment">// refine and calculate level sets</span></div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>  std::size_t idx = 0;</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>  <span class="keywordflow">while</span> (!<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.test(idx))</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>    ++idx;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae6cdd41a72a83c1e08ff57742b85da95">refineMesh</a>(idx, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>,</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>                                verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span> </div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>  <span class="keyword">auto</span> set_last_bit_ref = [&amp;]() {</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>) {</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bits;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 1; ll &lt;= <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a> + 2; ++ll)</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        bits.set(ll);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask = bits;</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a42896dd46513db84c3a4c8e49af197e6">delete_ents_by_bit_ref</a>(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(20),</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>                                              <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(20), <span class="keyword">true</span>,</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>                                              <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gae0020f4f7cf7b27b8562f77fe5f21cab">getEntitiesByRefLevel</a>(bits, mask, ents, verb);</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>      ents = subtract(ents, ents.subset_by_type(MBENTITYSET));</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga486c46f5509f4e3e1d2f92b474ca781a">addBitRefLevel</a>(ents, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(20));</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>    }</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>  };</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_last_bit_ref();</div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span> </div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>  <span class="keyword">auto</span> shift_after_ref = [&amp;]() {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>) {</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt;= <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a> + 2; ++ll)</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        mask.set(ll);</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, mask,</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>                                         verb, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>    }</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>  };</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> shift_after_ref();</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span> </div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>  <span class="comment">// save coordinates to be later restored</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a58d5922a7275bd9cc350d7678de4c909">getMeshOrgCoords</a>();</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span> </div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#aa269940e9fc185fb230e2b34f62641d8">writeEntitiesAllBitLevelsByType</a>(</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, <span class="stringliteral">&quot;all_after_ref_bits.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span> </div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>}</div>
</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span> </div>
<div class="foldopen" id="foldopen00301" data-start="{" data-end="}">
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a93023984d8c5a456c1e70090fda992c9">  301</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a93023984d8c5a456c1e70090fda992c9">CPMeshCut::setCutSurfaceFromFile</a>() {</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a>.empty()) {</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_from_file;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>                                     meshset_from_file);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <span class="comment">// FIXME:</span></div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    <span class="comment">// if its cubit file (.cub) it will show the error :</span></div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="comment">// [0]MOAB ERROR: -m-------------------- Error Message</span></div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>    <span class="comment">// ------------------------------------ [0]MOAB ERROR: Non-geometric entity</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>    <span class="comment">// provided! [0]MOAB ERROR: set_sense() line 741 in src/GeomTopoTool.cpp</span></div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>    <span class="comment">// Failed to restore topology</span></div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    <span class="comment">//</span></div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>    <span class="comment">// but the program will continue</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().load_file(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a>.c_str(),</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>                                          &amp;meshset_from_file, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a>.clear();</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  }</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>}</div>
</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="foldopen" id="foldopen00322" data-start="{" data-end="}">
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1f749459397b97eed48150fa01167a2b">  322</a></span>PetscErrorCode <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1f749459397b97eed48150fa01167a2b">CPMeshCut::copySurface</a>(<span class="keyword">const</span> std::string save_mesh) {</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span> </div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>.clear();</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>.clear();</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span> </div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>    PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>                <span class="stringliteral">&quot;Sideset %d with cutting crack surface not found\n&quot;</span>,</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>                <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  }</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>                                               2, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span> </div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>  <span class="comment">// Copy surface</span></div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="class_range.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>()).clear();</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08b8bbab5b73482ebe67655c8211e77b">copySurface</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, NULL, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>, NULL, NULL, save_mesh);</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>}</div>
</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="foldopen" id="foldopen00344" data-start="{" data-end="}">
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5d2fc244f49e0b52a81e52b9b9bb32ee">  344</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5d2fc244f49e0b52a81e52b9b9bb32ee">CPMeshCut::rebuildCrackSurface</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> factor,</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>                                              <span class="keyword">const</span> std::string save_mesh,</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>                                              <span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>  Skinner skin(&amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>)</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>    <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>];</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5edebe082848c57745b69722a9d173bc">setFixEdgesAndCorners</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span> </div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>  <a class="code hl_class" href="class_range.html">Range</a> bit_edges;</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span> </div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_griffith_force;</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_griffith_force_projected;</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_w;</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_front_positions;</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_area_change;</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_material_force;</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span> </div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>  boost::shared_ptr&lt;OrientedBoxTreeTool&gt; tree_body_skin_ptr;</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>  tree_body_skin_ptr = boost::shared_ptr&lt;OrientedBoxTreeTool&gt;(</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>      <span class="keyword">new</span> OrientedBoxTreeTool(&amp;<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;ROOTSETSURF&quot;</span>, <span class="keyword">true</span>));</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> rootset_tree_body_skin;</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span><span class="comment"></span> </div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span><span class="comment">  /// Maps nodes on old crack surface and new crack surface</span></div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span><span class="comment"></span>  std::map&lt;EntityHandle, EntityHandle&gt; verts_map;</div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span> </div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>  <span class="comment">// Seed pseudo-random generator with step. Algorithm is deterministic.</span></div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>  srand(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a06c3eddabfef8d0db78348fb8605842e">startStep</a>);</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span> </div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>  <span class="keyword">struct </span>SetFrontPositionsParameters {</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span> </div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>    <span class="keywordtype">double</span> tolRelSnapToFixedEdges; <span class="comment">///&lt; Relative tolerance to snap edges to</span><span class="comment"></span></div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span><span class="comment">                                   ///&lt; fixed edges</span></div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span><span class="comment"></span>    <span class="keywordtype">double</span> tolAbsSnapToFixedEdges; <span class="comment">///&lt; Relative tolerance to snap edges to</span><span class="comment"></span></div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span><span class="comment">                                   ///&lt; fixed edges</span></div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span><span class="comment"></span>    <span class="keywordtype">double</span> cornerFactor; <span class="comment">///&lt; extension of the edge beyond corner when node on</span><span class="comment"></span></div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span><span class="comment">                         ///&lt; corner edge</span></div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span><span class="comment"></span>    <span class="keywordtype">double</span> skinFactor;   <span class="comment">///&lt; extension of cutting surface when node on the skin</span></div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    <span class="keywordtype">double</span> endNodeEdgeDeltaFactor; <span class="comment">///&lt; End node edge extension</span></div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span> </div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    SetFrontPositionsParameters() {</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>      tolRelSnapToFixedEdges = 0.1;</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>      tolAbsSnapToFixedEdges = 0.;</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>      cornerFactor = 0.2;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>      skinFactor = 0.2;</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>      endNodeEdgeDeltaFactor = 0.2;</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = getOptions();</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>      CHKERRABORT(PETSC_COMM_WORLD, <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>    }</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> getOptions() {</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span> </div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;cutting_&quot;</span>,</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>                               <span class="stringliteral">&quot;Set front positions&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span> </div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>          <span class="stringliteral">&quot;-surf_corner_factor&quot;</span>,</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>          <span class="stringliteral">&quot;extension of the edge beyond corner when node on corer edge&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>          cornerFactor, &amp;cornerFactor, PETSC_NULL);</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>          <span class="stringliteral">&quot;-surf_skin_factor&quot;</span>,</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>          <span class="stringliteral">&quot;extension of cutting surface when node on the skin&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, skinFactor,</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>          &amp;skinFactor, PETSC_NULL);</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>          <span class="stringliteral">&quot;-end_node_edge_delta_factor&quot;</span>,</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>          <span class="stringliteral">&quot;extension of the front edge at the node on the surface&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>          endNodeEdgeDeltaFactor, &amp;endNodeEdgeDeltaFactor, PETSC_NULL);</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-snap_to_fixed_edge_rtol&quot;</span>,</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>                                <span class="stringliteral">&quot;snap to fixed edges (relative tolerances)&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>                                tolRelSnapToFixedEdges, &amp;tolRelSnapToFixedEdges,</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>                                PETSC_NULL);</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-snap_to_fixed_edge_atol&quot;</span>,</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>                                <span class="stringliteral">&quot;snap to fixed edges (absolute tolerances)&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>                                tolAbsSnapToFixedEdges, &amp;tolAbsSnapToFixedEdges,</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>                                PETSC_NULL);</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span>      <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>                  <span class="stringliteral">&quot;### Input parameter: -cutting_surf_corner_factor %6.4e&quot;</span>,</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>                  cornerFactor);</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>      <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>                  <span class="stringliteral">&quot;### Input parameter: -cutting_surf_skin_factor %6.4e&quot;</span>,</div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>                  skinFactor);</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>      <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>          <span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>          <span class="stringliteral">&quot;### Input parameter: -cutting_end_node_edge_delta_factor %6.4e&quot;</span>,</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>          endNodeEdgeDeltaFactor);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>      <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>                  <span class="stringliteral">&quot;### Input parameter: -cutting_snap_to_fixed_edge_rtol %6.4e&quot;</span>,</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>                  tolRelSnapToFixedEdges);</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>      <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>                  <span class="stringliteral">&quot;### Input parameter: -cutting_snap_to_fixed_edge_atol %6.4e&quot;</span>,</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>                  tolAbsSnapToFixedEdges);</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span> </div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>      <a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span> </div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>    }</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>  };</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span> </div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>  <span class="keyword">auto</span> save_entities = [&amp;](<span class="keyword">const</span> std::string name, <a class="code hl_class" href="class_range.html">Range</a> ents) {</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>    <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>    <span class="keywordflow">if</span> (!ents.empty()) {</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset, ents);</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>                                             1);</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>    }</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>  };</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span> </div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>  <span class="keyword">auto</span> get_tags = [&amp;]() {</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;GRIFFITH_FORCE&quot;</span>,</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>                                               th_griffith_force);</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;GRIFFITH_FORCE_PROJECTED&quot;</span>,</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>                                               th_griffith_force_projected);</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;W&quot;</span>, th_w);</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;MATERIAL_FORCE&quot;</span>,</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>                                               th_material_force);</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span> </div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;FRONT_POSITIONS&quot;</span>,</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>                                               th_front_positions);</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_delete(th_front_positions);</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span> </div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>    <span class="keywordtype">double</span> def_val[] = {0, 0, 0};</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(</div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span>        <span class="stringliteral">&quot;FRONT_POSITIONS&quot;</span>, 3, MB_TYPE_DOUBLE, th_front_positions,</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>        MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span> </div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;AREA_CHANGE&quot;</span>, th_area_change);</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_delete(th_area_change);</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span> </div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>        <span class="stringliteral">&quot;AREA_CHANGE&quot;</span>, 3, MB_TYPE_DOUBLE, th_area_change,</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>        MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span>  };</div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span> </div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>  <span class="keyword">auto</span> get_surface = [<span class="keyword">this</span>, &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>]() {</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_namespace" href="namespacesurface.html">surface</a>;</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>                                                 <a class="code hl_namespace" href="namespacesurface.html">surface</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>    <a class="code hl_class" href="class_range.html">Range</a> bit_faces;</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>                                                   MBTRI, bit_faces);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>    <span class="keywordflow">return</span> intersect(<a class="code hl_namespace" href="namespacesurface.html">surface</a>, bit_faces);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  };</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span> </div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>  <span class="keyword">auto</span> get_crack_front = [&amp;]() {</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_front;</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>                                                 crack_front, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>    <a class="code hl_class" href="class_range.html">Range</a> bit_edges;</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>                                                   MBEDGE, bit_edges);</div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>    <span class="keywordflow">return</span> intersect(crack_front, bit_edges);</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  };</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <span class="comment">// blockset where crack propagation takes place</span></div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  <span class="keyword">auto</span> get_cracked_body_blockset = [&amp;]() {</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>    <a class="code hl_class" href="class_range.html">Range</a> cracked_body_tets;</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, cracked_body_tets, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span>    <span class="keywordflow">return</span> cracked_body_tets;</div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  };</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span> </div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  <span class="comment">// build tree to search distances to body surface</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>  <span class="keyword">auto</span> build_body_skin_tree =</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>      [&amp;](boost::shared_ptr&lt;OrientedBoxTreeTool&gt; &amp;tree_body_skin_ptr,</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>          <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> &amp;rootset_tree_body_skin) {</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>        <a class="code hl_class" href="class_range.html">Range</a> last_bit_tets;</div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>            <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_define" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - 1), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>            last_bit_tets);</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> &gt; 0)</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>          last_bit_tets = intersect(last_bit_tets, get_cracked_body_blockset());</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>        <a class="code hl_class" href="class_range.html">Range</a> last_bit_tets_skin;</div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, last_bit_tets, <span class="keyword">false</span>, last_bit_tets_skin);</div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tree_body_skin_ptr-&gt;build(last_bit_tets_skin,</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>                                         rootset_tree_body_skin);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>      };</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>  <span class="comment">// Set coords</span></div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  <span class="keyword">auto</span> set_positions = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> nodes, <a class="code hl_class" href="class_tag.html">Tag</a> *<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a> = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>    VectorDouble coords(3 * nodes.size());</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(*<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, nodes, &amp;*coords.begin());</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(nodes, &amp;*coords.begin());</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_front_positions, nodes,</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>                                             &amp;*coords.begin());</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  };</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>  <span class="keyword">auto</span> get_nodes = [<span class="keyword">this</span>](<a class="code hl_class" href="class_range.html">Range</a> edges) {</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <a class="code hl_class" href="class_range.html">Range</a> verts;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(edges, verts, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="keywordflow">return</span> verts;</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>  };</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span> </div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>  <span class="keyword">auto</span> get_surface_skin = [<span class="keyword">this</span>, &amp;skin](<span class="keyword">auto</span> &amp;<a class="code hl_namespace" href="namespacesurface.html">surface</a>) {</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>    <a class="code hl_class" href="class_range.html">Range</a> surface_skin;</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_namespace" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>    <span class="keywordflow">return</span> surface_skin;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>  };</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span> </div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>  <span class="keyword">auto</span> get_crack_front_ends = [<span class="keyword">this</span>, &amp;skin](<a class="code hl_class" href="class_range.html">Range</a> crack_front) {</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>    <a class="code hl_class" href="class_range.html">Range</a> end_nodes;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, crack_front, <span class="keyword">false</span>, end_nodes);</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>    <span class="keywordflow">return</span> end_nodes;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>  };</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span> </div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>  <span class="keyword">auto</span> get_edge_delta = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> edge, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> node,</div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>                            VectorDouble3 &amp;<a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>) {</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>    <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(edge, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>    VectorDouble3 n0(3), n1(3);</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span>    <span class="keywordflow">if</span> (conn[1] == node) {</div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;conn[0], 1, &amp;n0[0]);</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;conn[1], 1, &amp;n1[0]);</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;conn[1], 1, &amp;n0[0]);</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;conn[0], 1, &amp;n1[0]);</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>    }</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>    <a class="code hl_variable" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> = n1 - n0;</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  };</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span> </div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <span class="keyword">auto</span> get_node_vec = [](std::vector&lt;double&gt; &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> nn) {</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>    <span class="keywordflow">return</span> <a class="code hl_function" href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>[3 * nn], 3);</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>  };</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span> </div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>  <span class="keyword">auto</span> check_if_node_is_in_range = [](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> node,</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>                                      <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;ents) {</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>    <span class="keywordflow">return</span> (ents.find(node) != ents.end());</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>  };</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span> </div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>  <span class="keyword">auto</span> check_for_nan = [&amp;](<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, std::string msg = <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>    <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>)</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>      <span class="keywordflow">if</span> (std::isnan(d) || std::isinf(d))</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>        <span class="keywordflow">if</span> (msg.size()) {</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>          SETERRQ2(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>                   <span class="stringliteral">&quot;(%s) Not number %3.4e&quot;</span>, msg.c_str(), d);</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>          SETERRQ1(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>                   <span class="stringliteral">&quot;Not number %3.4e&quot;</span>, d);</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>        }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span> </div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>  };</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span> </div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>  <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> node, <span class="keyword">auto</span> coords) {</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno">  613</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;set_tag&quot;</span>);</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_front_positions, &amp;node, 1,</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>                                             &amp;coords[0]);</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>  };</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span> </div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>  <span class="keyword">auto</span> get_str = [](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) { <span class="keywordflow">return</span> boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>); };</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span> </div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>  <span class="keyword">auto</span> get_tag_data = [<span class="keyword">this</span>](<a class="code hl_class" href="class_tag.html">Tag</a> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;ents) {</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>    std::vector&lt;double&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(3 * ents.size());</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, ents, &amp;*<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.begin());</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span>  };</div>
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno">  626</span> </div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>  <span class="keyword">auto</span> get_coords_vec = [<span class="keyword">this</span>](<span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> &amp;ents) {</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>    std::vector&lt;double&gt; <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(3 * ents.size());</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(ents, &amp;*<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.begin());</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  };</div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span> </div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  <span class="keyword">auto</span> get_prisms = [&amp;]() {</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms;</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(get_surface(), 3, <span class="keyword">false</span>, prisms,</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>                                                moab::Interface::UNION);</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>    prisms = prisms.subset_by_type(MBPRISM);</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="keywordflow">return</span> prisms;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  };</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  <span class="keyword">auto</span> get_prims_surface = [&amp;](<a class="code hl_class" href="class_range.html">Range</a> prisms) {</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms_surface;</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> prism : prisms) {</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> face;</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(prism, 2, 4, face);</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>      prisms_surface.insert(face);</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>    }</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>    <span class="keywordflow">return</span> prisms_surface;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>  };</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span> </div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>  <span class="keyword">auto</span> get_random_double = []() {</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(rand()) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(RAND_MAX);</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  };</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span> </div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>  <span class="comment">// Check if point is outside or inside of body</span></div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span>  <span class="keyword">auto</span> is_point_is_outside = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;coords) {</div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span>    VectorDouble3 random_ray(3);</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>    random_ray[0] =</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>        get_random_double() + std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>    random_ray[1] = get_random_double();</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>    random_ray[2] = get_random_double();</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>    random_ray /= norm_2(random_ray);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>    std::vector&lt;double&gt; distances_out;</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>    std::vector&lt;EntityHandle&gt; facets_out;</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tree_body_skin_ptr-&gt;ray_intersect_triangles(</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>        distances_out, facets_out, rootset_tree_body_skin, 1e-12, &amp;coords[0],</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span>        &amp;random_ray[0]);</div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>    <span class="keywordflow">return</span> ((facets_out.size() % 2) == 0);</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  };</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span> </div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>  <span class="comment">// Check until results is consistent</span></div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  <span class="keyword">auto</span> is_point_is_outside_with_check = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;coords) {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <span class="keywordtype">bool</span> is_out = is_point_is_outside(coords);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>    <span class="keywordtype">bool</span> test_out;</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span>      test_out = is_out;</div>
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno">  677</span>      is_out = is_point_is_outside(coords);</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>    } <span class="keywordflow">while</span> (test_out != is_out);</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>    <span class="keywordflow">return</span> is_out;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  };</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keyword">auto</span> get_proj_front_disp = [&amp;](<span class="keyword">auto</span> front_disp,</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>                                 <span class="keyword">auto</span> griffith_force_projected) {</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mgn_force_projected = norm_2(griffith_force_projected);</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>    VectorDouble3 disp(3);</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span> </div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>    <span class="keywordflow">if</span> (mgn_force_projected &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>      griffith_force_projected /= mgn_force_projected;</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>      noalias(disp) = factor * griffith_force_projected *</div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span>                      fmax(0, inner_prod(front_disp, griffith_force_projected));</div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>      disp.clear();</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>    }</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span> </div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>    <span class="keywordflow">return</span> disp;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  };</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span> </div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>  <span class="comment">// get average area increment</span></div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>  <span class="keyword">auto</span> get_ave_a_change = [&amp;](<a class="code hl_class" href="class_range.html">Range</a> &amp;crack_front_nodes,</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>                              std::vector&lt;double&gt; &amp;area_change) {</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>    <span class="keywordtype">double</span> ave_a_change = 0;</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : crack_front_nodes) {</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>      <span class="keyword">auto</span> a_change = get_node_vec(area_change, nn);</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>      ave_a_change += norm_2(a_change);</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>    }</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>    ave_a_change /= crack_front_nodes.size();</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>    <span class="keywordflow">return</span> ave_a_change;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>  };</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span> </div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>  <span class="keyword">auto</span> get_ray_pout = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> coords, <span class="keyword">const</span> <span class="keyword">auto</span> ray) {</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>    std::vector&lt;double&gt; distances_out;</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>    std::vector&lt;EntityHandle&gt; facets_out;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>    <span class="keywordtype">double</span> ray_length = norm_2(ray);</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>    VectorDouble3 unit_ray = ray / ray_length;</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>    <span class="comment">// send the ray in the direction of the edge</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tree_body_skin_ptr-&gt;ray_intersect_triangles(</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        distances_out, facets_out, rootset_tree_body_skin, 1e-12, &amp;coords[0],</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>        &amp;unit_ray[0], &amp;ray_length);</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>    <span class="keywordflow">if</span> (distances_out.empty())</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>      <span class="keywordflow">return</span> -1.;</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>    <span class="keywordflow">else</span></div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>      <span class="keywordflow">return</span> *std::min_element(distances_out.begin(), distances_out.end());</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>  };</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span> </div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE, bit_edges);</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span> </div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>  SetFrontPositionsParameters front_params;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span> </div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_tags();</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a> = get_prims_surface(get_prisms());</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span> </div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>  <a class="code hl_class" href="class_range.html">Range</a> surface_skin = get_surface_skin(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>);</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>  <a class="code hl_class" href="class_range.html">Range</a> crack_front = intersect(get_crack_front(), surface_skin);</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>  <a class="code hl_class" href="class_range.html">Range</a> crack_front_nodes = get_nodes(crack_front);</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>  <a class="code hl_class" href="class_range.html">Range</a> end_nodes = get_crack_front_ends(crack_front);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>  <a class="code hl_class" href="class_range.html">Range</a> surface_skin_nodes =</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>      subtract(subtract(get_nodes(surface_skin), crack_front_nodes),</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>               get_nodes(intersect(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, surface_skin)));</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>  surface_skin_nodes.merge(intersect(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, get_nodes(surface_skin)));</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span> </div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_fracture_mechanics_1_1_griffith_force_element_1_1_save_griffith_force_on_tags.html">GriffithForceElement::SaveGriffithForceOnTags</a>(</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>, th_area_change, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">nullptr</span>)();</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_positions(get_nodes(get_prisms()), <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> build_body_skin_tree(tree_body_skin_ptr, rootset_tree_body_skin);</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span> </div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;prisms_surface.vtk&quot;</span>, get_prims_surface(get_prisms()));</div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;surface_skin.vtk&quot;</span>, surface_skin);</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;crack_front.vtk&quot;</span>, crack_front);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;crack_front_nodes.vtk&quot;</span>, crack_front_nodes);</div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;end_nodes.vtk&quot;</span>, end_nodes);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span> </div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="keyword">auto</span> surface_snap = [&amp;]() {</div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aedb15b073b44bdf2cd4d20fbc19a8060">snapSurfaceToEdges</a>(</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>        surface_skin, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, front_params.tolRelSnapToFixedEdges,</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>        front_params.tolAbsSnapToFixedEdges, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>  };</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span> </div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>  <span class="keyword">auto</span> move_front_nodes = [&amp;]() {</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span> </div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    <span class="keyword">auto</span> w = get_tag_data(th_w, crack_front_nodes);</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="keyword">auto</span> griffith_forces_projected =</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>        get_tag_data(th_griffith_force_projected, crack_front_nodes);</div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>    <span class="keyword">auto</span> area_change = get_tag_data(th_area_change, crack_front_nodes);</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    <span class="keyword">auto</span> mesh_node_positions = get_coords_vec(crack_front_nodes);</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span> </div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> ave_a_change =</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>        get_ave_a_change(crack_front_nodes, area_change);</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : crack_front_nodes) {</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span> </div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>      <span class="keyword">auto</span> front_disp = get_node_vec(w, nn);</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>      <span class="keyword">auto</span> force_projected = get_node_vec(griffith_forces_projected, nn);</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>      <span class="keyword">auto</span> a_change = get_node_vec(area_change, nn);</div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>      <span class="keyword">auto</span> position = get_node_vec(mesh_node_positions, nn);</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span> </div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(front_disp, <span class="stringliteral">&quot;front_disp&quot;</span>);</div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(force_projected, <span class="stringliteral">&quot;force_projected&quot;</span>);</div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(a_change, <span class="stringliteral">&quot;a_change&quot;</span>);</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span> </div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>      VectorDouble3 disp = get_proj_front_disp(front_disp, force_projected);</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span> </div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(position);</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(disp);</div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>      }</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span> </div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>      VectorDouble3 coords = position + disp;</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span> </div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>      <span class="comment">// check if nodes on fixed edges</span></div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span>      <a class="code hl_class" href="class_range.html">Range</a> adj_crack_front_nodes_edges;</div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;node, 1, 1, <span class="keyword">false</span>,</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>                                                  adj_crack_front_nodes_edges,</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>                                                  moab::Interface::UNION);</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>      <a class="code hl_class" href="class_range.html">Range</a> adj_crack_front_nodes_on_fixed_edges;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>      adj_crack_front_nodes_on_fixed_edges =</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>          intersect(adj_crack_front_nodes_edges, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>);</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>      adj_crack_front_nodes_on_fixed_edges =</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>          intersect(adj_crack_front_nodes_on_fixed_edges, bit_edges);</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span> </div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(front_disp, <span class="stringliteral">&quot;front_disp&quot;</span>);</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;coords&quot;</span>);</div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(disp, <span class="stringliteral">&quot;disp&quot;</span>);</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span> </div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>      <span class="keyword">enum</span> Classifier {</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>        FREE = 0,</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>        FIXED_EDGE = 1 &lt;&lt; 0,</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>        END_NODE = 1 &lt;&lt; 1,</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>        FIXED_EDGE_KIND0 = 1 &lt;&lt; 2,</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>        FIXED_EDGE_KIND1 = 1 &lt;&lt; 3</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>      };</div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span> </div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kind = FREE;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>      <span class="keywordflow">if</span> (check_if_node_is_in_range(node, get_nodes(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>)))</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>        kind |= FIXED_EDGE;</div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>      <span class="keywordflow">if</span> (check_if_node_is_in_range(node, end_nodes))</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>        kind |= END_NODE;</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span> </div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>      <span class="keywordflow">if</span> (kind == FREE) {</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span> </div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>        <span class="comment">// check pushing other nodes, which are not end nodes</span></div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        VectorDouble3 scaled_a_change =</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>            ave_a_change * a_change /</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>            (norm_2(a_change) + std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        <span class="keywordflow">if</span> (is_point_is_outside_with_check(coords)) {</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span> </div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>          coords += front_params.skinFactor * scaled_a_change;</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords,</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>                               <span class="stringliteral">&quot;Pushed through surface (out by factor)&quot;</span>);</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>              &lt;&lt; <span class="stringliteral">&quot;Pushed through surface (out by factor): &quot;</span>;</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span> </div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>          VectorDouble3 tmp_coords =</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>              coords + front_params.skinFactor * scaled_a_change;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>          <span class="keywordflow">if</span> (is_point_is_outside_with_check(tmp_coords)) {</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>            VectorDouble3 ray =</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>                scaled_a_change / (norm_2(scaled_a_change) +</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>                                   std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> dist = get_ray_pout(coords, scaled_a_change);</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>            <span class="keywordflow">if</span> (dist &gt; -0)</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>              coords += dist * ray;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span> </div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>            coords += front_params.skinFactor * scaled_a_change;</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>                coords, <span class="stringliteral">&quot;Pushing through surface (out by skin factor)&quot;</span>);</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span> </div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>                &lt;&lt; <span class="stringliteral">&quot;Pushing through surface (out by skin factor): &quot;</span>;</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>          }</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>        }</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>      }</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span> </div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>      <span class="keywordflow">if</span> (kind &amp; END_NODE) {</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span> </div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>        <span class="keywordtype">double</span> min_dist = front_params.skinFactor * ave_a_change;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span> </div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>        <span class="keywordflow">if</span> (kind &amp; FIXED_EDGE) {</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span> </div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>          VectorDouble3 pt_out(3);</div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_tools.html">Tools</a>&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>              &amp;coords[0], 1, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, &amp;min_dist, &amp;pt_out[0]);</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span>          <span class="keywordflow">if</span> (min_dist &lt; front_params.skinFactor * ave_a_change)</div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span>            coords = pt_out;</div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span> </div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;End node on the fixed edge&quot;</span>);</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span> </div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>              &lt;&lt; <span class="stringliteral">&quot;End node on the fixed edge: &quot;</span>;</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span> </div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span>          <span class="comment">// Find corner edge and check if crack can go through it</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span> </div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>          VectorDouble3 pt_out(3);</div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_tools.html">Tools</a>&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>              &amp;coords[0], 1, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, &amp;min_dist, &amp;pt_out[0]);</div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>          <span class="keywordflow">if</span> (min_dist &lt; front_params.skinFactor * ave_a_change) {</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>            VectorDouble3 ray = pt_out - coords;</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>            <span class="keywordflow">if</span> (inner_prod(a_change, ray) &gt; 0) {</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>              VectorDouble3 scaled_ray =</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>                  front_params.skinFactor * ave_a_change * ray / norm_2(ray);</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>              coords += ray + scaled_ray;</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>                  coords, <span class="stringliteral">&quot;Pushing through surface dist (close to edge)&quot;</span>);</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>                  &lt;&lt; <span class="stringliteral">&quot;Pushing through surface dist (close to edge): &quot;</span>;</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>            }</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>          }</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>        }</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>      }</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span> </div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>      <span class="keywordflow">if</span> (!adj_crack_front_nodes_on_fixed_edges.empty()) {</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span> </div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> nb_edges_on_fix_edges =</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span>            adj_crack_front_nodes_on_fixed_edges.size() - 1;</div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span>        adj_crack_front_nodes_on_fixed_edges =</div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>            intersect(adj_crack_front_nodes_on_fixed_edges, surface_skin);</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span> </div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>        <span class="comment">// adj node edge is on fixed edge and on the skin</span></div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>        <span class="keywordflow">if</span> (!adj_crack_front_nodes_on_fixed_edges.empty()) {</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> nb_edges_on_fix_edges_and_surface_skin =</div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>              adj_crack_front_nodes_on_fixed_edges.size();</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>          <span class="keyword">const</span> <span class="keywordtype">int</span> diff_nb_edges =</div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span>              nb_edges_on_fix_edges - nb_edges_on_fix_edges_and_surface_skin;</div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span> </div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>          <span class="comment">// If is  &gt;- in that case diff_nb_edges = 1</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>          <span class="comment">// If is  &gt;| in that case diff_nb_edges &gt; 1</span></div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span> </div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>          <span class="keywordflow">if</span> (diff_nb_edges &gt; 1) {</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span> </div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>            VectorDouble3 edge_delta;</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_edge_delta(adj_crack_front_nodes_on_fixed_edges[0], node,</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span>                                  edge_delta);</div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>            coords += front_params.cornerFactor * edge_delta;</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>                &lt;&lt; <span class="stringliteral">&quot;Node on fixed edge (crack meeting fixed edge &gt;|): &quot;</span>;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>                coords, <span class="stringliteral">&quot;Node on fixed edge (crack meeting fixed edge &gt;|)&quot;</span>);</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span> </div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>            kind |= FIXED_EDGE_KIND0;</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>          }</div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span> </div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((kind &amp; END_NODE) &amp;&amp; (kind &amp; FIXED_EDGE)) {</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span> </div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>          <span class="comment">// It s =|&gt;</span></div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span> </div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>          <span class="comment">// adj edge is on fixed edge but that edge is not on the skin</span></div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>          <a class="code hl_class" href="class_range.html">Range</a> adj_edges_on_skin =</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>              intersect(adj_crack_front_nodes_edges, surface_skin);</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>          <span class="keywordflow">if</span> (!adj_edges_on_skin.empty()) {</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span> </div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>            VectorDouble3 edge_delta;</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_edge_delta(adj_edges_on_skin[0], node, edge_delta);</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span>            coords += front_params.cornerFactor * edge_delta;</div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span>                coords, <span class="stringliteral">&quot;Node on fixed edge (crack crossing fixed edge =|&gt;)&quot;</span>);</div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span> </div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>                &lt;&lt; <span class="stringliteral">&quot;Node on fixed edge (crack crossing fixed edge =|&gt;): &quot;</span>;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span> </div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span>            kind |= FIXED_EDGE_KIND1;</div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>          }</div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>        }</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span>      }</div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span> </div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>      <span class="keywordflow">if</span> (</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span> </div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>          (kind &amp; END_NODE) &amp;&amp;</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span> </div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>          !(kind &amp; FIXED_EDGE_KIND0) &amp;&amp;</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span> </div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>          !(kind &amp; FIXED_EDGE_KIND1)) {</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span> </div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>        <span class="comment">// is a end node on the skin, just go outside, in the direction</span></div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>        <span class="comment">// of crack front edged</span></div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>        <a class="code hl_class" href="class_range.html">Range</a> adj_edges = intersect(adj_crack_front_nodes_edges, crack_front);</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>        VectorDouble3 edge_delta;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_edge_delta(adj_edges[0], node, edge_delta);</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>        coords += edge_delta * front_params.endNodeEdgeDeltaFactor;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;End node on the skin&quot;</span>);</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span> </div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>        <span class="comment">// front_params.skinFactor;</span></div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span>        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;End node on the skin: &quot;</span>;</div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>      }</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span> </div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>      <a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose, <span class="stringliteral">&quot;Disp front %s at node %lu&quot;</span>,</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>                  get_str(front_disp).c_str(), node);</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span> </div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag(node, coords);</div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span> </div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>      ++nn;</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>    }</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span> </div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>  };</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span> </div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>  <span class="keyword">auto</span> smooth_front = [&amp;]() {</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>    <a class="code hl_class" href="class_range.html">Range</a> smoothed_nodes = subtract(crack_front_nodes, end_nodes);</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>    std::vector&lt;double&gt; new_positions(3 * smoothed_nodes.size());</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span>    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : smoothed_nodes) {</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>      <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;node, 1, 1, <span class="keyword">false</span>, edges);</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>      edges = intersect(edges, crack_front);</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>      <a class="code hl_class" href="class_range.html">Range</a> edges_nodes;</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(edges, edges_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>      edges_nodes.erase(node);</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>      <span class="keywordflow">if</span> (edges_nodes.size() != 2)</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span>        SETERRQ1(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span>                 <span class="stringliteral">&quot;Expected two nodes but have %d&quot;</span>, edges_nodes.size());</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>      VectorDouble3 node0(3), node1(3), node2(3);</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> n0 = edges_nodes[0];</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> n2 = edges_nodes[1];</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_front_positions, &amp;n0, 1,</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>                                               &amp;node0[0]);</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_front_positions, &amp;node, 1,</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>                                               &amp;node1[0]);</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_front_positions, &amp;n2, 1,</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>                                               &amp;node2[0]);</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>      VectorDouble3 delta0 = node0 - node1;</div>
<div class="line"><a id="l01015" name="l01015"></a><span class="lineno"> 1015</span>      VectorDouble3 delta2 = node2 - node1;</div>
<div class="line"><a id="l01016" name="l01016"></a><span class="lineno"> 1016</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> l0 = norm_2(delta0);</div>
<div class="line"><a id="l01017" name="l01017"></a><span class="lineno"> 1017</span>      <span class="keyword">const</span> <span class="keywordtype">double</span> l2 = norm_2(delta2);</div>
<div class="line"><a id="l01018" name="l01018"></a><span class="lineno"> 1018</span> </div>
<div class="line"><a id="l01019" name="l01019"></a><span class="lineno"> 1019</span>      <span class="keywordflow">if</span> ((l0 / (l0 + l2)) &lt; 0.5)</div>
<div class="line"><a id="l01020" name="l01020"></a><span class="lineno"> 1020</span>        node1 += 2 * (0.5 - (l0 / (l0 + l2))) * (delta2 / l2) * l0;</div>
<div class="line"><a id="l01021" name="l01021"></a><span class="lineno"> 1021</span>      <span class="keywordflow">else</span></div>
<div class="line"><a id="l01022" name="l01022"></a><span class="lineno"> 1022</span>        node1 += 2 * (0.5 - (l2 / (l0 + l2))) * (delta0 / l0) * l2;</div>
<div class="line"><a id="l01023" name="l01023"></a><span class="lineno"> 1023</span> </div>
<div class="line"><a id="l01024" name="l01024"></a><span class="lineno"> 1024</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a9fdd168f6643241476f1a4407a3a0f7a">VectorAdaptor</a> new_coords = get_node_vec(new_positions, nn);</div>
<div class="line"><a id="l01025" name="l01025"></a><span class="lineno"> 1025</span>      new_coords = node1;</div>
<div class="line"><a id="l01026" name="l01026"></a><span class="lineno"> 1026</span>      ++nn;</div>
<div class="line"><a id="l01027" name="l01027"></a><span class="lineno"> 1027</span>    }</div>
<div class="line"><a id="l01028" name="l01028"></a><span class="lineno"> 1028</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_front_positions, smoothed_nodes,</div>
<div class="line"><a id="l01029" name="l01029"></a><span class="lineno"> 1029</span>                                             &amp;*new_positions.begin());</div>
<div class="line"><a id="l01030" name="l01030"></a><span class="lineno"> 1030</span> </div>
<div class="line"><a id="l01031" name="l01031"></a><span class="lineno"> 1031</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01032" name="l01032"></a><span class="lineno"> 1032</span>  };</div>
<div class="line"><a id="l01033" name="l01033"></a><span class="lineno"> 1033</span> </div>
<div class="line"><a id="l01034" name="l01034"></a><span class="lineno"> 1034</span>  <span class="keyword">auto</span> delete_mofem_meshsets = [&amp;]() {</div>
<div class="line"><a id="l01035" name="l01035"></a><span class="lineno"> 1035</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01036" name="l01036"></a><span class="lineno"> 1036</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a id="l01037" name="l01037"></a><span class="lineno"> 1037</span>        <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa73d6d4d08509b996a63604173694d8a">getSkinOfTheBodyId</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a id="l01038" name="l01038"></a><span class="lineno"> 1038</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a id="l01039" name="l01039"></a><span class="lineno"> 1039</span>        <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a001491969a5bbeea6147ce9d8ce0416b">getCrackSurfaceId</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a id="l01040" name="l01040"></a><span class="lineno"> 1040</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a id="l01041" name="l01041"></a><span class="lineno"> 1041</span>        <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5d19b596dfc352e6f25afb67a6be6eeb">getCrackFrontId</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a id="l01042" name="l01042"></a><span class="lineno"> 1042</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01043" name="l01043"></a><span class="lineno"> 1043</span>  };</div>
<div class="line"><a id="l01044" name="l01044"></a><span class="lineno"> 1044</span> </div>
<div class="line"><a id="l01045" name="l01045"></a><span class="lineno"> 1045</span>  <span class="keyword">auto</span> build_surface = [&amp;]() {</div>
<div class="line"><a id="l01046" name="l01046"></a><span class="lineno"> 1046</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01047" name="l01047"></a><span class="lineno"> 1047</span>    <span class="comment">// Create cutting surface from existing crack</span></div>
<div class="line"><a id="l01048" name="l01048"></a><span class="lineno"> 1048</span>    <a class="code hl_class" href="class_tag.html">Tag</a> th_interface_side;</div>
<div class="line"><a id="l01049" name="l01049"></a><span class="lineno"> 1049</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>,</div>
<div class="line"><a id="l01050" name="l01050"></a><span class="lineno"> 1050</span>                                               th_interface_side);</div>
<div class="line"><a id="l01051" name="l01051"></a><span class="lineno"> 1051</span>    <a class="code hl_class" href="class_range.html">Range</a> new_surface;</div>
<div class="line"><a id="l01052" name="l01052"></a><span class="lineno"> 1052</span>    <span class="comment">// Take nodes from top of the prims</span></div>
<div class="line"><a id="l01053" name="l01053"></a><span class="lineno"> 1053</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> face : <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>) {</div>
<div class="line"><a id="l01054" name="l01054"></a><span class="lineno"> 1054</span> </div>
<div class="line"><a id="l01055" name="l01055"></a><span class="lineno"> 1055</span>      <span class="keywordtype">int</span> side;</div>
<div class="line"><a id="l01056" name="l01056"></a><span class="lineno"> 1056</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_interface_side, &amp;face, 1,</div>
<div class="line"><a id="l01057" name="l01057"></a><span class="lineno"> 1057</span>                                               &amp;side);</div>
<div class="line"><a id="l01058" name="l01058"></a><span class="lineno"> 1058</span>      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a id="l01059" name="l01059"></a><span class="lineno"> 1059</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><a id="l01060" name="l01060"></a><span class="lineno"> 1060</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(face, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01061" name="l01061"></a><span class="lineno"> 1061</span> </div>
<div class="line"><a id="l01062" name="l01062"></a><span class="lineno"> 1062</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01063" name="l01063"></a><span class="lineno"> 1063</span>        <span class="keywordflow">if</span> (!(conn[0] != conn[1] &amp;&amp; conn[0] != conn[2] &amp;&amp; conn[1] != conn[2]))</div>
<div class="line"><a id="l01064" name="l01064"></a><span class="lineno"> 1064</span>          SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l01065" name="l01065"></a><span class="lineno"> 1065</span>                  <span class="stringliteral">&quot;Imposible trinagle&quot;</span>);</div>
<div class="line"><a id="l01066" name="l01066"></a><span class="lineno"> 1066</span> </div>
<div class="line"><a id="l01067" name="l01067"></a><span class="lineno"> 1067</span>      <a class="code hl_class" href="class_matrix_bounded_array_3_01double_00_019_01_4.html">MatrixDouble3by3</a> coords(3, 3);</div>
<div class="line"><a id="l01068" name="l01068"></a><span class="lineno"> 1068</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_front_positions, conn, 3,</div>
<div class="line"><a id="l01069" name="l01069"></a><span class="lineno"> 1069</span>                                               &amp;coords(0, 0));</div>
<div class="line"><a id="l01070" name="l01070"></a><span class="lineno"> 1070</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01071" name="l01071"></a><span class="lineno"> 1071</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords.data());</div>
<div class="line"><a id="l01072" name="l01072"></a><span class="lineno"> 1072</span> </div>
<div class="line"><a id="l01073" name="l01073"></a><span class="lineno"> 1073</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> new_verts[3] = {0, 0, 0};</div>
<div class="line"><a id="l01074" name="l01074"></a><span class="lineno"> 1074</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn : {0, 1, 2}) {</div>
<div class="line"><a id="l01075" name="l01075"></a><span class="lineno"> 1075</span>        <span class="keyword">auto</span> node_map = verts_map.find(conn[nn]);</div>
<div class="line"><a id="l01076" name="l01076"></a><span class="lineno"> 1076</span>        <span class="keywordflow">if</span> (node_map == verts_map.end()) {</div>
<div class="line"><a id="l01077" name="l01077"></a><span class="lineno"> 1077</span>          <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> new_node;</div>
<div class="line"><a id="l01078" name="l01078"></a><span class="lineno"> 1078</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_vertex(&amp;coords(nn, 0), new_node);</div>
<div class="line"><a id="l01079" name="l01079"></a><span class="lineno"> 1079</span>          verts_map[conn[nn]] = new_node;</div>
<div class="line"><a id="l01080" name="l01080"></a><span class="lineno"> 1080</span>        }</div>
<div class="line"><a id="l01081" name="l01081"></a><span class="lineno"> 1081</span>        new_verts[nn] = verts_map[conn[nn]];</div>
<div class="line"><a id="l01082" name="l01082"></a><span class="lineno"> 1082</span>      }</div>
<div class="line"><a id="l01083" name="l01083"></a><span class="lineno"> 1083</span>      <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn : {0, 1, 2})</div>
<div class="line"><a id="l01084" name="l01084"></a><span class="lineno"> 1084</span>        <span class="keywordflow">if</span> (new_verts[nn] == 0)</div>
<div class="line"><a id="l01085" name="l01085"></a><span class="lineno"> 1085</span>          SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l01086" name="l01086"></a><span class="lineno"> 1086</span>                  <span class="stringliteral">&quot;Imposible trinagle&quot;</span>);</div>
<div class="line"><a id="l01087" name="l01087"></a><span class="lineno"> 1087</span>      <span class="keywordflow">if</span> (side == 1) {</div>
<div class="line"><a id="l01088" name="l01088"></a><span class="lineno"> 1088</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> n0 = new_verts[0];</div>
<div class="line"><a id="l01089" name="l01089"></a><span class="lineno"> 1089</span>        new_verts[0] = new_verts[1];</div>
<div class="line"><a id="l01090" name="l01090"></a><span class="lineno"> 1090</span>        new_verts[1] = n0;</div>
<div class="line"><a id="l01091" name="l01091"></a><span class="lineno"> 1091</span>      }</div>
<div class="line"><a id="l01092" name="l01092"></a><span class="lineno"> 1092</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ele;</div>
<div class="line"><a id="l01093" name="l01093"></a><span class="lineno"> 1093</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_element(MBTRI, new_verts, 3, ele);</div>
<div class="line"><a id="l01094" name="l01094"></a><span class="lineno"> 1094</span>      new_surface.insert(ele);</div>
<div class="line"><a id="l01095" name="l01095"></a><span class="lineno"> 1095</span>    }</div>
<div class="line"><a id="l01096" name="l01096"></a><span class="lineno"> 1096</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>.swap(new_surface);</div>
<div class="line"><a id="l01097" name="l01097"></a><span class="lineno"> 1097</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01098" name="l01098"></a><span class="lineno"> 1098</span>  };</div>
<div class="line"><a id="l01099" name="l01099"></a><span class="lineno"> 1099</span> </div>
<div class="line"><a id="l01100" name="l01100"></a><span class="lineno"> 1100</span>  <span class="keyword">auto</span> build_front = [&amp;]() {</div>
<div class="line"><a id="l01101" name="l01101"></a><span class="lineno"> 1101</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01102" name="l01102"></a><span class="lineno"> 1102</span>    <a class="code hl_class" href="class_range.html">Range</a> new_surface_skin;</div>
<div class="line"><a id="l01103" name="l01103"></a><span class="lineno"> 1103</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">false</span>, new_surface_skin);</div>
<div class="line"><a id="l01104" name="l01104"></a><span class="lineno"> 1104</span>    <a class="code hl_class" href="class_range.html">Range</a> new_front;</div>
<div class="line"><a id="l01105" name="l01105"></a><span class="lineno"> 1105</span>    <span class="comment">// Creating crack front from existing crack</span></div>
<div class="line"><a id="l01106" name="l01106"></a><span class="lineno"> 1106</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : crack_front) {</div>
<div class="line"><a id="l01107" name="l01107"></a><span class="lineno"> 1107</span>      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a id="l01108" name="l01108"></a><span class="lineno"> 1108</span>      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line"><a id="l01109" name="l01109"></a><span class="lineno"> 1109</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(f, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01110" name="l01110"></a><span class="lineno"> 1110</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> new_verts[num_nodes];</div>
<div class="line"><a id="l01111" name="l01111"></a><span class="lineno"> 1111</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 2; nn++) {</div>
<div class="line"><a id="l01112" name="l01112"></a><span class="lineno"> 1112</span>        <span class="keyword">auto</span> node_map = verts_map.find(conn[nn]);</div>
<div class="line"><a id="l01113" name="l01113"></a><span class="lineno"> 1113</span>        <span class="keywordflow">if</span> (node_map != verts_map.end())</div>
<div class="line"><a id="l01114" name="l01114"></a><span class="lineno"> 1114</span>          new_verts[nn] = node_map-&gt;second;</div>
<div class="line"><a id="l01115" name="l01115"></a><span class="lineno"> 1115</span>        <span class="keywordflow">else</span></div>
<div class="line"><a id="l01116" name="l01116"></a><span class="lineno"> 1116</span>          SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l01117" name="l01117"></a><span class="lineno"> 1117</span>                  <span class="stringliteral">&quot;Expected that vertex should be already created&quot;</span>);</div>
<div class="line"><a id="l01118" name="l01118"></a><span class="lineno"> 1118</span>      }</div>
<div class="line"><a id="l01119" name="l01119"></a><span class="lineno"> 1119</span>      <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line"><a id="l01120" name="l01120"></a><span class="lineno"> 1120</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(new_verts, 2, 1, <span class="keyword">true</span>, edges,</div>
<div class="line"><a id="l01121" name="l01121"></a><span class="lineno"> 1121</span>                                                  moab::Interface::INTERSECT);</div>
<div class="line"><a id="l01122" name="l01122"></a><span class="lineno"> 1122</span>      edges = intersect(edges, new_surface_skin);</div>
<div class="line"><a id="l01123" name="l01123"></a><span class="lineno"> 1123</span>      new_front.merge(edges);</div>
<div class="line"><a id="l01124" name="l01124"></a><span class="lineno"> 1124</span>    }</div>
<div class="line"><a id="l01125" name="l01125"></a><span class="lineno"> 1125</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>.swap(new_front);</div>
<div class="line"><a id="l01126" name="l01126"></a><span class="lineno"> 1126</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01127" name="l01127"></a><span class="lineno"> 1127</span>  };</div>
<div class="line"><a id="l01128" name="l01128"></a><span class="lineno"> 1128</span> </div>
<div class="line"><a id="l01129" name="l01129"></a><span class="lineno"> 1129</span>  <span class="keyword">auto</span> edges_snap = [&amp;]() {</div>
<div class="line"><a id="l01130" name="l01130"></a><span class="lineno"> 1130</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01131" name="l01131"></a><span class="lineno"> 1131</span>    <a class="code hl_class" href="class_range.html">Range</a> new_surface_skin;</div>
<div class="line"><a id="l01132" name="l01132"></a><span class="lineno"> 1132</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">false</span>, new_surface_skin);</div>
<div class="line"><a id="l01133" name="l01133"></a><span class="lineno"> 1133</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aedb15b073b44bdf2cd4d20fbc19a8060">snapSurfaceToEdges</a>(</div>
<div class="line"><a id="l01134" name="l01134"></a><span class="lineno"> 1134</span>        new_surface_skin, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, front_params.tolRelSnapToFixedEdges,</div>
<div class="line"><a id="l01135" name="l01135"></a><span class="lineno"> 1135</span>        front_params.tolAbsSnapToFixedEdges, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l01136" name="l01136"></a><span class="lineno"> 1136</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01137" name="l01137"></a><span class="lineno"> 1137</span>  };</div>
<div class="line"><a id="l01138" name="l01138"></a><span class="lineno"> 1138</span> </div>
<div class="line"><a id="l01139" name="l01139"></a><span class="lineno"> 1139</span>  <span class="keyword">auto</span> delete_meshsets_with_crack_surfaces = [&amp;]() {</div>
<div class="line"><a id="l01140" name="l01140"></a><span class="lineno"> 1140</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01141" name="l01141"></a><span class="lineno"> 1141</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a id="l01142" name="l01142"></a><span class="lineno"> 1142</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 19; ++ll)</div>
<div class="line"><a id="l01143" name="l01143"></a><span class="lineno"> 1143</span>      mask.set(ll);</div>
<div class="line"><a id="l01144" name="l01144"></a><span class="lineno"> 1144</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(19, mask, verb, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a id="l01145" name="l01145"></a><span class="lineno"> 1145</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01146" name="l01146"></a><span class="lineno"> 1146</span>  };</div>
<div class="line"><a id="l01147" name="l01147"></a><span class="lineno"> 1147</span> </div>
<div class="line"><a id="l01148" name="l01148"></a><span class="lineno"> 1148</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> surface_snap();</div>
<div class="line"><a id="l01149" name="l01149"></a><span class="lineno"> 1149</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> move_front_nodes();</div>
<div class="line"><a id="l01150" name="l01150"></a><span class="lineno"> 1150</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> smooth_front();</div>
<div class="line"><a id="l01151" name="l01151"></a><span class="lineno"> 1151</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a id="l01152" name="l01152"></a><span class="lineno"> 1152</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> build_surface();</div>
<div class="line"><a id="l01153" name="l01153"></a><span class="lineno"> 1153</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01154" name="l01154"></a><span class="lineno"> 1154</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;set_new_crack_surface.vtk&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>);</div>
<div class="line"><a id="l01155" name="l01155"></a><span class="lineno"> 1155</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> build_front();</div>
<div class="line"><a id="l01156" name="l01156"></a><span class="lineno"> 1156</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> edges_snap();</div>
<div class="line"><a id="l01157" name="l01157"></a><span class="lineno"> 1157</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01158" name="l01158"></a><span class="lineno"> 1158</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;set_new_front.vtk&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>);</div>
<div class="line"><a id="l01159" name="l01159"></a><span class="lineno"> 1159</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_meshsets_with_crack_surfaces();</div>
<div class="line"><a id="l01160" name="l01160"></a><span class="lineno"> 1160</span> </div>
<div class="line"><a id="l01161" name="l01161"></a><span class="lineno"> 1161</span>  <span class="comment">// Set cutting inteface</span></div>
<div class="line"><a id="l01162" name="l01162"></a><span class="lineno"> 1162</span>  <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="class_range.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>()).clear();</div>
<div class="line"><a id="l01163" name="l01163"></a><span class="lineno"> 1163</span>  <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="class_range.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14b57638017e2cde6ccc6f6e51118847">getFront</a>()).clear();</div>
<div class="line"><a id="l01164" name="l01164"></a><span class="lineno"> 1164</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5691afdb9be3879de243aeea26c934c9">setSurface</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>);</div>
<div class="line"><a id="l01165" name="l01165"></a><span class="lineno"> 1165</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0c7c582d842a5540d10cc8d84c0c3486">setFront</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>);</div>
<div class="line"><a id="l01166" name="l01166"></a><span class="lineno"> 1166</span> </div>
<div class="line"><a id="l01167" name="l01167"></a><span class="lineno"> 1167</span>  <span class="keywordflow">if</span> (!save_mesh.empty())</div>
<div class="line"><a id="l01168" name="l01168"></a><span class="lineno"> 1168</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(save_mesh, unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>));</div>
<div class="line"><a id="l01169" name="l01169"></a><span class="lineno"> 1169</span> </div>
<div class="line"><a id="l01170" name="l01170"></a><span class="lineno"> 1170</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01171" name="l01171"></a><span class="lineno"> 1171</span>}</div>
</div>
<div class="line"><a id="l01172" name="l01172"></a><span class="lineno"> 1172</span> </div>
<div class="foldopen" id="foldopen01173" data-start="{" data-end="}">
<div class="line"><a id="l01173" name="l01173"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5edebe082848c57745b69722a9d173bc"> 1173</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5edebe082848c57745b69722a9d173bc">CPMeshCut::setFixEdgesAndCorners</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a id="l01174" name="l01174"></a><span class="lineno"> 1174</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01175" name="l01175"></a><span class="lineno"> 1175</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>.clear();</div>
<div class="line"><a id="l01176" name="l01176"></a><span class="lineno"> 1176</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>.clear();</div>
<div class="line"><a id="l01177" name="l01177"></a><span class="lineno"> 1177</span> </div>
<div class="line"><a id="l01178" name="l01178"></a><span class="lineno"> 1178</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line"><a id="l01179" name="l01179"></a><span class="lineno"> 1179</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 1,</div>
<div class="line"><a id="l01180" name="l01180"></a><span class="lineno"> 1180</span>                                                 <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01181" name="l01181"></a><span class="lineno"> 1181</span> </div>
<div class="line"><a id="l01182" name="l01182"></a><span class="lineno"> 1182</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a>) &amp;&amp;</div>
<div class="line"><a id="l01183" name="l01183"></a><span class="lineno"> 1183</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line"><a id="l01184" name="l01184"></a><span class="lineno"> 1184</span>    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a>,</div>
<div class="line"><a id="l01185" name="l01185"></a><span class="lineno"> 1185</span>            <span class="stringliteral">&quot;There are both BLOCKSET and NODESET with ID equal to input &quot;</span></div>
<div class="line"><a id="l01186" name="l01186"></a><span class="lineno"> 1186</span>            <span class="stringliteral">&quot;parameter -vertex_block_set&quot;</span>);</div>
<div class="line"><a id="l01187" name="l01187"></a><span class="lineno"> 1187</span> </div>
<div class="line"><a id="l01188" name="l01188"></a><span class="lineno"> 1188</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line"><a id="l01189" name="l01189"></a><span class="lineno"> 1189</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 0,</div>
<div class="line"><a id="l01190" name="l01190"></a><span class="lineno"> 1190</span>                                                 <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01191" name="l01191"></a><span class="lineno"> 1191</span> </div>
<div class="line"><a id="l01192" name="l01192"></a><span class="lineno"> 1192</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a>))</div>
<div class="line"><a id="l01193" name="l01193"></a><span class="lineno"> 1193</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a>, 0,</div>
<div class="line"><a id="l01194" name="l01194"></a><span class="lineno"> 1194</span>                                                 <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01195" name="l01195"></a><span class="lineno"> 1195</span> </div>
<div class="line"><a id="l01196" name="l01196"></a><span class="lineno"> 1196</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01197" name="l01197"></a><span class="lineno"> 1197</span>                                             <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>);</div>
<div class="line"><a id="l01198" name="l01198"></a><span class="lineno"> 1198</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01199" name="l01199"></a><span class="lineno"> 1199</span>                                             <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>);</div>
<div class="line"><a id="l01200" name="l01200"></a><span class="lineno"> 1200</span> </div>
<div class="line"><a id="l01201" name="l01201"></a><span class="lineno"> 1201</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01202" name="l01202"></a><span class="lineno"> 1202</span>}</div>
</div>
<div class="line"><a id="l01203" name="l01203"></a><span class="lineno"> 1203</span> </div>
<div class="foldopen" id="foldopen01204" data-start="{" data-end="}">
<div class="line"><a id="l01204" name="l01204"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1bbfb030bcbd86228047ec8c352128ba"> 1204</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1bbfb030bcbd86228047ec8c352128ba">CPMeshCut::cutMesh</a>(<span class="keywordtype">int</span> &amp;first_bit, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01205" name="l01205"></a><span class="lineno"> 1205</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01206" name="l01206"></a><span class="lineno"> 1206</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01207" name="l01207"></a><span class="lineno"> 1207</span> </div>
<div class="line"><a id="l01208" name="l01208"></a><span class="lineno"> 1208</span>  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> ents) {</div>
<div class="line"><a id="l01209" name="l01209"></a><span class="lineno"> 1209</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01210" name="l01210"></a><span class="lineno"> 1210</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a id="l01211" name="l01211"></a><span class="lineno"> 1211</span>      <span class="keywordflow">if</span> (!ents.empty()) {</div>
<div class="line"><a id="l01212" name="l01212"></a><span class="lineno"> 1212</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l01213" name="l01213"></a><span class="lineno"> 1213</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l01214" name="l01214"></a><span class="lineno"> 1214</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset, ents);</div>
<div class="line"><a id="l01215" name="l01215"></a><span class="lineno"> 1215</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a id="l01216" name="l01216"></a><span class="lineno"> 1216</span>                                             1);</div>
<div class="line"><a id="l01217" name="l01217"></a><span class="lineno"> 1217</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l01218" name="l01218"></a><span class="lineno"> 1218</span>      }</div>
<div class="line"><a id="l01219" name="l01219"></a><span class="lineno"> 1219</span>    }</div>
<div class="line"><a id="l01220" name="l01220"></a><span class="lineno"> 1220</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01221" name="l01221"></a><span class="lineno"> 1221</span>  };</div>
<div class="line"><a id="l01222" name="l01222"></a><span class="lineno"> 1222</span> </div>
<div class="line"><a id="l01223" name="l01223"></a><span class="lineno"> 1223</span>  <span class="keyword">auto</span> get_entities_from_contact_meshset = [&amp;](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a id="l01224" name="l01224"></a><span class="lineno"> 1224</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01225" name="l01225"></a><span class="lineno"> 1225</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>.clear();</div>
<div class="line"><a id="l01226" name="l01226"></a><span class="lineno"> 1226</span>    <a class="code hl_class" href="class_range.html">Range</a> tris;</div>
<div class="line"><a id="l01227" name="l01227"></a><span class="lineno"> 1227</span>    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, cit)) {</div>
<div class="line"><a id="l01228" name="l01228"></a><span class="lineno"> 1228</span>      <span class="keywordflow">if</span> (cit-&gt;getName().compare(0, 11, <span class="stringliteral">&quot;INT_CONTACT&quot;</span>) == 0) {</div>
<div class="line"><a id="l01229" name="l01229"></a><span class="lineno"> 1229</span>        tris.clear();</div>
<div class="line"><a id="l01230" name="l01230"></a><span class="lineno"> 1230</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(cit-&gt;getMeshsetId(),</div>
<div class="line"><a id="l01231" name="l01231"></a><span class="lineno"> 1231</span>                                                     <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 2, tris, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01232" name="l01232"></a><span class="lineno"> 1232</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>.merge(tris);</div>
<div class="line"><a id="l01233" name="l01233"></a><span class="lineno"> 1233</span>      }</div>
<div class="line"><a id="l01234" name="l01234"></a><span class="lineno"> 1234</span>    }</div>
<div class="line"><a id="l01235" name="l01235"></a><span class="lineno"> 1235</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01236" name="l01236"></a><span class="lineno"> 1236</span>                                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>);</div>
<div class="line"><a id="l01237" name="l01237"></a><span class="lineno"> 1237</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01238" name="l01238"></a><span class="lineno"> 1238</span>  };</div>
<div class="line"><a id="l01239" name="l01239"></a><span class="lineno"> 1239</span> </div>
<div class="line"><a id="l01240" name="l01240"></a><span class="lineno"> 1240</span>  <span class="keyword">auto</span> get_entities_from_constrained_interface = [&amp;](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a id="l01241" name="l01241"></a><span class="lineno"> 1241</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01242" name="l01242"></a><span class="lineno"> 1242</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>.clear();</div>
<div class="line"><a id="l01243" name="l01243"></a><span class="lineno"> 1243</span>    <a class="code hl_class" href="class_range.html">Range</a> tris;</div>
<div class="line"><a id="l01244" name="l01244"></a><span class="lineno"> 1244</span>    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, cit)) {</div>
<div class="line"><a id="l01245" name="l01245"></a><span class="lineno"> 1245</span>      <span class="keywordflow">if</span> (cit-&gt;getName().compare(0, 15, <span class="stringliteral">&quot;INT_CONSTRAINED&quot;</span>) == 0) {</div>
<div class="line"><a id="l01246" name="l01246"></a><span class="lineno"> 1246</span>        tris.clear();</div>
<div class="line"><a id="l01247" name="l01247"></a><span class="lineno"> 1247</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(cit-&gt;getMeshsetId(),</div>
<div class="line"><a id="l01248" name="l01248"></a><span class="lineno"> 1248</span>                                                     <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 2, tris, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01249" name="l01249"></a><span class="lineno"> 1249</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>.merge(tris);</div>
<div class="line"><a id="l01250" name="l01250"></a><span class="lineno"> 1250</span>      }</div>
<div class="line"><a id="l01251" name="l01251"></a><span class="lineno"> 1251</span>    }</div>
<div class="line"><a id="l01252" name="l01252"></a><span class="lineno"> 1252</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01253" name="l01253"></a><span class="lineno"> 1253</span>                                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>);</div>
<div class="line"><a id="l01254" name="l01254"></a><span class="lineno"> 1254</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01255" name="l01255"></a><span class="lineno"> 1255</span>  };</div>
<div class="line"><a id="l01256" name="l01256"></a><span class="lineno"> 1256</span> </div>
<div class="line"><a id="l01257" name="l01257"></a><span class="lineno"> 1257</span>  <a class="code hl_class" href="class_range.html">Range</a> all_constrained_faces;</div>
<div class="line"><a id="l01258" name="l01258"></a><span class="lineno"> 1258</span>  <span class="keyword">auto</span> get_all_constrained_faces = [&amp;](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a id="l01259" name="l01259"></a><span class="lineno"> 1259</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01260" name="l01260"></a><span class="lineno"> 1260</span>    all_constrained_faces.clear();</div>
<div class="line"><a id="l01261" name="l01261"></a><span class="lineno"> 1261</span> </div>
<div class="line"><a id="l01262" name="l01262"></a><span class="lineno"> 1262</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a id="l01263" name="l01263"></a><span class="lineno"> 1263</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_entities_from_contact_meshset(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a id="l01264" name="l01264"></a><span class="lineno"> 1264</span>      all_constrained_faces.merge(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>);</div>
<div class="line"><a id="l01265" name="l01265"></a><span class="lineno"> 1265</span>    }</div>
<div class="line"><a id="l01266" name="l01266"></a><span class="lineno"> 1266</span> </div>
<div class="line"><a id="l01267" name="l01267"></a><span class="lineno"> 1267</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_entities_from_constrained_interface(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a id="l01268" name="l01268"></a><span class="lineno"> 1268</span>    all_constrained_faces.merge(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>);</div>
<div class="line"><a id="l01269" name="l01269"></a><span class="lineno"> 1269</span> </div>
<div class="line"><a id="l01270" name="l01270"></a><span class="lineno"> 1270</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01271" name="l01271"></a><span class="lineno"> 1271</span>  };</div>
<div class="line"><a id="l01272" name="l01272"></a><span class="lineno"> 1272</span> </div>
<div class="line"><a id="l01273" name="l01273"></a><span class="lineno"> 1273</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01274" name="l01274"></a><span class="lineno"> 1274</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;crack_surface_before_merge.vtk&quot;</span>,</div>
<div class="line"><a id="l01275" name="l01275"></a><span class="lineno"> 1275</span>                     <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>());</div>
<div class="line"><a id="l01276" name="l01276"></a><span class="lineno"> 1276</span> </div>
<div class="line"><a id="l01277" name="l01277"></a><span class="lineno"> 1277</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01278" name="l01278"></a><span class="lineno"> 1278</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a id="l01279" name="l01279"></a><span class="lineno"> 1279</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBVERTEX,</div>
<div class="line"><a id="l01280" name="l01280"></a><span class="lineno"> 1280</span>        <span class="stringliteral">&quot;verts_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01281" name="l01281"></a><span class="lineno"> 1281</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a id="l01282" name="l01282"></a><span class="lineno"> 1282</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE,</div>
<div class="line"><a id="l01283" name="l01283"></a><span class="lineno"> 1283</span>        <span class="stringliteral">&quot;edges_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01284" name="l01284"></a><span class="lineno"> 1284</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a id="l01285" name="l01285"></a><span class="lineno"> 1285</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTRI,</div>
<div class="line"><a id="l01286" name="l01286"></a><span class="lineno"> 1286</span>        <span class="stringliteral">&quot;triangles_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01287" name="l01287"></a><span class="lineno"> 1287</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a id="l01288" name="l01288"></a><span class="lineno"> 1288</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l01289" name="l01289"></a><span class="lineno"> 1289</span>        <span class="stringliteral">&quot;tets_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a id="l01290" name="l01290"></a><span class="lineno"> 1290</span>  }</div>
<div class="line"><a id="l01291" name="l01291"></a><span class="lineno"> 1291</span> </div>
<div class="line"><a id="l01292" name="l01292"></a><span class="lineno"> 1292</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_all_constrained_faces(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>]);</div>
<div class="line"><a id="l01293" name="l01293"></a><span class="lineno"> 1293</span>  <span class="keywordflow">if</span> (!all_constrained_faces.empty()) {</div>
<div class="line"><a id="l01294" name="l01294"></a><span class="lineno"> 1294</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aad2bf7c3c4320b94832923df44d30e45">setConstrainSurface</a>(all_constrained_faces);</div>
<div class="line"><a id="l01295" name="l01295"></a><span class="lineno"> 1295</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01296" name="l01296"></a><span class="lineno"> 1296</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;constrained_surface_before_merge.vtk&quot;</span>,</div>
<div class="line"><a id="l01297" name="l01297"></a><span class="lineno"> 1297</span>                       all_constrained_faces);</div>
<div class="line"><a id="l01298" name="l01298"></a><span class="lineno"> 1298</span>  }</div>
<div class="line"><a id="l01299" name="l01299"></a><span class="lineno"> 1299</span> </div>
<div class="line"><a id="l01300" name="l01300"></a><span class="lineno"> 1300</span>  <span class="comment">// Cut mesh, trim surface and merge bad edges</span></div>
<div class="line"><a id="l01301" name="l01301"></a><span class="lineno"> 1301</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5edebe082848c57745b69722a9d173bc">setFixEdgesAndCorners</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>]);</div>
<div class="line"><a id="l01302" name="l01302"></a><span class="lineno"> 1302</span> </div>
<div class="line"><a id="l01303" name="l01303"></a><span class="lineno"> 1303</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1ef5dac44a93d2934fabd08e35c72a9">cutTrimAndMerge</a>(first_bit, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>, <span class="keyword">nullptr</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>,</div>
<div class="line"><a id="l01304" name="l01304"></a><span class="lineno"> 1304</span>                                     <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>,</div>
<div class="line"><a id="l01305" name="l01305"></a><span class="lineno"> 1305</span>                                     <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, <span class="keyword">true</span>, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l01306" name="l01306"></a><span class="lineno"> 1306</span> </div>
<div class="line"><a id="l01307" name="l01307"></a><span class="lineno"> 1307</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_after_merge = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(first_bit);</div>
<div class="line"><a id="l01308" name="l01308"></a><span class="lineno"> 1308</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a>)</div>
<div class="line"><a id="l01309" name="l01309"></a><span class="lineno"> 1309</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aacc6ac8832948e067b7b7dadf50c53d1">removePathologicalFrontTris</a>(</div>
<div class="line"><a id="l01310" name="l01310"></a><span class="lineno"> 1310</span>        bit_after_merge, <span class="keyword">const_cast&lt;</span><a class="code hl_class" href="class_range.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a452afd78f72fd0d9bde8985f5417d47d">getMergedSurfaces</a>()));</div>
<div class="line"><a id="l01311" name="l01311"></a><span class="lineno"> 1311</span> </div>
<div class="line"><a id="l01312" name="l01312"></a><span class="lineno"> 1312</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01313" name="l01313"></a><span class="lineno"> 1313</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;crack_surface_after_merge.vtk&quot;</span>,</div>
<div class="line"><a id="l01314" name="l01314"></a><span class="lineno"> 1314</span>                     <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a452afd78f72fd0d9bde8985f5417d47d">getMergedSurfaces</a>());</div>
<div class="line"><a id="l01315" name="l01315"></a><span class="lineno"> 1315</span> </div>
<div class="line"><a id="l01316" name="l01316"></a><span class="lineno"> 1316</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_all_constrained_faces(bit_after_merge);</div>
<div class="line"><a id="l01317" name="l01317"></a><span class="lineno"> 1317</span>  <span class="keywordflow">if</span> (!all_constrained_faces.empty() &amp;&amp; <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01318" name="l01318"></a><span class="lineno"> 1318</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;constrained_surface_after_merge.vtk&quot;</span>,</div>
<div class="line"><a id="l01319" name="l01319"></a><span class="lineno"> 1319</span>                     all_constrained_faces);</div>
<div class="line"><a id="l01320" name="l01320"></a><span class="lineno"> 1320</span>  }</div>
<div class="line"><a id="l01321" name="l01321"></a><span class="lineno"> 1321</span> </div>
<div class="line"><a id="l01322" name="l01322"></a><span class="lineno"> 1322</span>  <span class="keyword">auto</span> add_entities_to_crack_meshset = [&amp;]() {</div>
<div class="line"><a id="l01323" name="l01323"></a><span class="lineno"> 1323</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01324" name="l01324"></a><span class="lineno"> 1324</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>))</div>
<div class="line"><a id="l01325" name="l01325"></a><span class="lineno"> 1325</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a id="l01326" name="l01326"></a><span class="lineno"> 1326</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_faces = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a452afd78f72fd0d9bde8985f5417d47d">getMergedSurfaces</a>();</div>
<div class="line"><a id="l01327" name="l01327"></a><span class="lineno"> 1327</span> </div>
<div class="line"><a id="l01328" name="l01328"></a><span class="lineno"> 1328</span>    <span class="keywordflow">if</span> (!all_constrained_faces.empty() &amp;&amp; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> &lt; 0) {</div>
<div class="line"><a id="l01329" name="l01329"></a><span class="lineno"> 1329</span>      SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea2ed69dd8a1568d1e9b634b9fb37df873">MOFEM_NOT_FOUND</a>,</div>
<div class="line"><a id="l01330" name="l01330"></a><span class="lineno"> 1330</span>              <span class="stringliteral">&quot;Block set id of the cracked body is required for a simulation &quot;</span></div>
<div class="line"><a id="l01331" name="l01331"></a><span class="lineno"> 1331</span>              <span class="stringliteral">&quot;with contact and/or constrained interface, use &quot;</span></div>
<div class="line"><a id="l01332" name="l01332"></a><span class="lineno"> 1332</span>              <span class="stringliteral">&quot;&#39;-my_cracked_body_block_set&#39; parameter&quot;</span>);</div>
<div class="line"><a id="l01333" name="l01333"></a><span class="lineno"> 1333</span>    }</div>
<div class="line"><a id="l01334" name="l01334"></a><span class="lineno"> 1334</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> &gt; 0) {</div>
<div class="line"><a id="l01335" name="l01335"></a><span class="lineno"> 1335</span>      <a class="code hl_class" href="class_range.html">Range</a> cracked_body_tets, cracked_body_tris;</div>
<div class="line"><a id="l01336" name="l01336"></a><span class="lineno"> 1336</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a id="l01337" name="l01337"></a><span class="lineno"> 1337</span>          <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, cracked_body_tets, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01338" name="l01338"></a><span class="lineno"> 1338</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(cracked_body_tets, 2, <span class="keyword">false</span>,</div>
<div class="line"><a id="l01339" name="l01339"></a><span class="lineno"> 1339</span>                                                cracked_body_tris,</div>
<div class="line"><a id="l01340" name="l01340"></a><span class="lineno"> 1340</span>                                                moab::Interface::UNION);</div>
<div class="line"><a id="l01341" name="l01341"></a><span class="lineno"> 1341</span>      crack_faces = intersect(crack_faces, cracked_body_tris);</div>
<div class="line"><a id="l01342" name="l01342"></a><span class="lineno"> 1342</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01343" name="l01343"></a><span class="lineno"> 1343</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;crack_faces_intersected_with_body_block.vtk&quot;</span>,</div>
<div class="line"><a id="l01344" name="l01344"></a><span class="lineno"> 1344</span>                         crack_faces);</div>
<div class="line"><a id="l01345" name="l01345"></a><span class="lineno"> 1345</span>    }</div>
<div class="line"><a id="l01346" name="l01346"></a><span class="lineno"> 1346</span> </div>
<div class="line"><a id="l01347" name="l01347"></a><span class="lineno"> 1347</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>,</div>
<div class="line"><a id="l01348" name="l01348"></a><span class="lineno"> 1348</span>                                               crack_faces);</div>
<div class="line"><a id="l01349" name="l01349"></a><span class="lineno"> 1349</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01350" name="l01350"></a><span class="lineno"> 1350</span>  };</div>
<div class="line"><a id="l01351" name="l01351"></a><span class="lineno"> 1351</span> </div>
<div class="line"><a id="l01352" name="l01352"></a><span class="lineno"> 1352</span>  <span class="keyword">auto</span> clean_copied_cutting_surface_entities = [&amp;]() {</div>
<div class="line"><a id="l01353" name="l01353"></a><span class="lineno"> 1353</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01354" name="l01354"></a><span class="lineno"> 1354</span>    <a class="code hl_class" href="class_range.html">Range</a> surface_verts;</div>
<div class="line"><a id="l01355" name="l01355"></a><span class="lineno"> 1355</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>(),</div>
<div class="line"><a id="l01356" name="l01356"></a><span class="lineno"> 1356</span>                                               surface_verts);</div>
<div class="line"><a id="l01357" name="l01357"></a><span class="lineno"> 1357</span>    <a class="code hl_class" href="class_range.html">Range</a> surface_edges;</div>
<div class="line"><a id="l01358" name="l01358"></a><span class="lineno"> 1358</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>(), 1,</div>
<div class="line"><a id="l01359" name="l01359"></a><span class="lineno"> 1359</span>                                              <span class="keyword">false</span>, surface_edges,</div>
<div class="line"><a id="l01360" name="l01360"></a><span class="lineno"> 1360</span>                                              moab::Interface::UNION);</div>
<div class="line"><a id="l01361" name="l01361"></a><span class="lineno"> 1361</span>    <span class="comment">// Remove entities from meshsets</span></div>
<div class="line"><a id="l01362" name="l01362"></a><span class="lineno"> 1362</span>    <a class="code hl_class" href="class_range.html">Range</a> meshsets;</div>
<div class="line"><a id="l01363" name="l01363"></a><span class="lineno"> 1363</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(0, MBENTITYSET, meshsets,</div>
<div class="line"><a id="l01364" name="l01364"></a><span class="lineno"> 1364</span>                                                   <span class="keyword">false</span>);</div>
<div class="line"><a id="l01365" name="l01365"></a><span class="lineno"> 1365</span>    <span class="keywordflow">for</span> (Range::iterator mit = meshsets.begin(); mit != meshsets.end(); mit++) {</div>
<div class="line"><a id="l01366" name="l01366"></a><span class="lineno"> 1366</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().remove_entities(*mit, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>());</div>
<div class="line"><a id="l01367" name="l01367"></a><span class="lineno"> 1367</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().remove_entities(*mit, surface_edges);</div>
<div class="line"><a id="l01368" name="l01368"></a><span class="lineno"> 1368</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().remove_entities(*mit, surface_verts);</div>
<div class="line"><a id="l01369" name="l01369"></a><span class="lineno"> 1369</span>    }</div>
<div class="line"><a id="l01370" name="l01370"></a><span class="lineno"> 1370</span> </div>
<div class="line"><a id="l01371" name="l01371"></a><span class="lineno"> 1371</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">getSurface</a>());</div>
<div class="line"><a id="l01372" name="l01372"></a><span class="lineno"> 1372</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(surface_edges);</div>
<div class="line"><a id="l01373" name="l01373"></a><span class="lineno"> 1373</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(surface_verts);</div>
<div class="line"><a id="l01374" name="l01374"></a><span class="lineno"> 1374</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01375" name="l01375"></a><span class="lineno"> 1375</span>  };</div>
<div class="line"><a id="l01376" name="l01376"></a><span class="lineno"> 1376</span> </div>
<div class="line"><a id="l01377" name="l01377"></a><span class="lineno"> 1377</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_entities_to_crack_meshset();</div>
<div class="line"><a id="l01378" name="l01378"></a><span class="lineno"> 1378</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> clean_copied_cutting_surface_entities();</div>
<div class="line"><a id="l01379" name="l01379"></a><span class="lineno"> 1379</span> </div>
<div class="line"><a id="l01380" name="l01380"></a><span class="lineno"> 1380</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01381" name="l01381"></a><span class="lineno"> 1381</span>}</div>
</div>
<div class="line"><a id="l01382" name="l01382"></a><span class="lineno"> 1382</span> </div>
<div class="foldopen" id="foldopen01383" data-start="{" data-end="}">
<div class="line"><a id="l01383" name="l01383"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0016012d2fdfbaa3dea1c7de67159175"> 1383</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0016012d2fdfbaa3dea1c7de67159175">CPMeshCut::findBodySkin</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l01384" name="l01384"></a><span class="lineno"> 1384</span>                                       <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>,</div>
<div class="line"><a id="l01385" name="l01385"></a><span class="lineno"> 1385</span>                                       std::string file_name) {</div>
<div class="line"><a id="l01386" name="l01386"></a><span class="lineno"> 1386</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01387" name="l01387"></a><span class="lineno"> 1387</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l01388" name="l01388"></a><span class="lineno"> 1388</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01389" name="l01389"></a><span class="lineno"> 1389</span> </div>
<div class="line"><a id="l01390" name="l01390"></a><span class="lineno"> 1390</span>  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> ents) {</div>
<div class="line"><a id="l01391" name="l01391"></a><span class="lineno"> 1391</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01392" name="l01392"></a><span class="lineno"> 1392</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a id="l01393" name="l01393"></a><span class="lineno"> 1393</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l01394" name="l01394"></a><span class="lineno"> 1394</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l01395" name="l01395"></a><span class="lineno"> 1395</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><a id="l01396" name="l01396"></a><span class="lineno"> 1396</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a id="l01397" name="l01397"></a><span class="lineno"> 1397</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l01398" name="l01398"></a><span class="lineno"> 1398</span>    }</div>
<div class="line"><a id="l01399" name="l01399"></a><span class="lineno"> 1399</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01400" name="l01400"></a><span class="lineno"> 1400</span>  };</div>
<div class="line"><a id="l01401" name="l01401"></a><span class="lineno"> 1401</span> </div>
<div class="line"><a id="l01402" name="l01402"></a><span class="lineno"> 1402</span>  <span class="comment">// Find body skin, take it from meshset if is found, if not create meshest,</span></div>
<div class="line"><a id="l01403" name="l01403"></a><span class="lineno"> 1403</span>  <span class="comment">// and add skin entities</span></div>
<div class="line"><a id="l01404" name="l01404"></a><span class="lineno"> 1404</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>.clear();</div>
<div class="line"><a id="l01405" name="l01405"></a><span class="lineno"> 1405</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a id="l01406" name="l01406"></a><span class="lineno"> 1406</span>    <a class="code hl_class" href="class_range.html">Range</a> tets, prisms;</div>
<div class="line"><a id="l01407" name="l01407"></a><span class="lineno"> 1407</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01408" name="l01408"></a><span class="lineno"> 1408</span>                                                   MBTET, tets);</div>
<div class="line"><a id="l01409" name="l01409"></a><span class="lineno"> 1409</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01410" name="l01410"></a><span class="lineno"> 1410</span>                                                   MBPRISM, prisms);</div>
<div class="line"><a id="l01411" name="l01411"></a><span class="lineno"> 1411</span>    prisms = subtract(prisms, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>);</div>
<div class="line"><a id="l01412" name="l01412"></a><span class="lineno"> 1412</span>    prisms = subtract(prisms, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a id="l01413" name="l01413"></a><span class="lineno"> 1413</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms_faces;</div>
<div class="line"><a id="l01414" name="l01414"></a><span class="lineno"> 1414</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : prisms) {</div>
<div class="line"><a id="l01415" name="l01415"></a><span class="lineno"> 1415</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> f;</div>
<div class="line"><a id="l01416" name="l01416"></a><span class="lineno"> 1416</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 3, f);</div>
<div class="line"><a id="l01417" name="l01417"></a><span class="lineno"> 1417</span>      prisms_faces.insert(f);</div>
<div class="line"><a id="l01418" name="l01418"></a><span class="lineno"> 1418</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 4, f);</div>
<div class="line"><a id="l01419" name="l01419"></a><span class="lineno"> 1419</span>      prisms_faces.insert(f);</div>
<div class="line"><a id="l01420" name="l01420"></a><span class="lineno"> 1420</span>    }</div>
<div class="line"><a id="l01421" name="l01421"></a><span class="lineno"> 1421</span>    <a class="code hl_class" href="class_range.html">Range</a> skin_faces;</div>
<div class="line"><a id="l01422" name="l01422"></a><span class="lineno"> 1422</span>    Skinner skin(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line"><a id="l01423" name="l01423"></a><span class="lineno"> 1423</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, skin_faces);</div>
<div class="line"><a id="l01424" name="l01424"></a><span class="lineno"> 1424</span>    skin_faces = subtract(skin_faces, prisms_faces);</div>
<div class="line"><a id="l01425" name="l01425"></a><span class="lineno"> 1425</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>);</div>
<div class="line"><a id="l01426" name="l01426"></a><span class="lineno"> 1426</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l01427" name="l01427"></a><span class="lineno"> 1427</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, meshset);</div>
<div class="line"><a id="l01428" name="l01428"></a><span class="lineno"> 1428</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, skin_faces);</div>
<div class="line"><a id="l01429" name="l01429"></a><span class="lineno"> 1429</span>  }</div>
<div class="line"><a id="l01430" name="l01430"></a><span class="lineno"> 1430</span> </div>
<div class="line"><a id="l01431" name="l01431"></a><span class="lineno"> 1431</span>  <span class="comment">// take skin entities from meshset</span></div>
<div class="line"><a id="l01432" name="l01432"></a><span class="lineno"> 1432</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a id="l01433" name="l01433"></a><span class="lineno"> 1433</span>                                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01434" name="l01434"></a><span class="lineno"> 1434</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01435" name="l01435"></a><span class="lineno"> 1435</span>                                             <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>);</div>
<div class="line"><a id="l01436" name="l01436"></a><span class="lineno"> 1436</span> </div>
<div class="line"><a id="l01437" name="l01437"></a><span class="lineno"> 1437</span>  <span class="keywordflow">if</span> (verb &gt;= <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849">VERY_VERBOSE</a>)</div>
<div class="line"><a id="l01438" name="l01438"></a><span class="lineno"> 1438</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a id="l01439" name="l01439"></a><span class="lineno"> 1439</span>      cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01440" name="l01440"></a><span class="lineno"> 1440</span> </div>
<div class="line"><a id="l01441" name="l01441"></a><span class="lineno"> 1441</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01442" name="l01442"></a><span class="lineno"> 1442</span>    save_mesh(file_name, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>);</div>
<div class="line"><a id="l01443" name="l01443"></a><span class="lineno"> 1443</span> </div>
<div class="line"><a id="l01444" name="l01444"></a><span class="lineno"> 1444</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01445" name="l01445"></a><span class="lineno"> 1445</span>}</div>
</div>
<div class="line"><a id="l01446" name="l01446"></a><span class="lineno"> 1446</span> </div>
<div class="foldopen" id="foldopen01447" data-start="{" data-end="}">
<div class="line"><a id="l01447" name="l01447"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a90e33252d4b7e57d9c2a7596db8ab906"> 1447</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a90e33252d4b7e57d9c2a7596db8ab906">CPMeshCut::findCrack</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l01448" name="l01448"></a><span class="lineno"> 1448</span>                                    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01449" name="l01449"></a><span class="lineno"> 1449</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01450" name="l01450"></a><span class="lineno"> 1450</span>  moab::Interface &amp;moab = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l01451" name="l01451"></a><span class="lineno"> 1451</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01452" name="l01452"></a><span class="lineno"> 1452</span> </div>
<div class="line"><a id="l01453" name="l01453"></a><span class="lineno"> 1453</span>  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> ents) {</div>
<div class="line"><a id="l01454" name="l01454"></a><span class="lineno"> 1454</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01455" name="l01455"></a><span class="lineno"> 1455</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a id="l01456" name="l01456"></a><span class="lineno"> 1456</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l01457" name="l01457"></a><span class="lineno"> 1457</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l01458" name="l01458"></a><span class="lineno"> 1458</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><a id="l01459" name="l01459"></a><span class="lineno"> 1459</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a id="l01460" name="l01460"></a><span class="lineno"> 1460</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l01461" name="l01461"></a><span class="lineno"> 1461</span>    }</div>
<div class="line"><a id="l01462" name="l01462"></a><span class="lineno"> 1462</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01463" name="l01463"></a><span class="lineno"> 1463</span>  };</div>
<div class="line"><a id="l01464" name="l01464"></a><span class="lineno"> 1464</span> </div>
<div class="line"><a id="l01465" name="l01465"></a><span class="lineno"> 1465</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>.clear();</div>
<div class="line"><a id="l01466" name="l01466"></a><span class="lineno"> 1466</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a id="l01467" name="l01467"></a><span class="lineno"> 1467</span>    PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Sideset %d with crack surface not found\n&quot;</span>,</div>
<div class="line"><a id="l01468" name="l01468"></a><span class="lineno"> 1468</span>                <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a id="l01469" name="l01469"></a><span class="lineno"> 1469</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l01470" name="l01470"></a><span class="lineno"> 1470</span>  }</div>
<div class="line"><a id="l01471" name="l01471"></a><span class="lineno"> 1471</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a id="l01472" name="l01472"></a><span class="lineno"> 1472</span>                                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01473" name="l01473"></a><span class="lineno"> 1473</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01474" name="l01474"></a><span class="lineno"> 1474</span>                                             <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>);</div>
<div class="line"><a id="l01475" name="l01475"></a><span class="lineno"> 1475</span> </div>
<div class="line"><a id="l01476" name="l01476"></a><span class="lineno"> 1476</span>  <span class="comment">// Find crack front</span></div>
<div class="line"><a id="l01477" name="l01477"></a><span class="lineno"> 1477</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.clear();</div>
<div class="line"><a id="l01478" name="l01478"></a><span class="lineno"> 1478</span> </div>
<div class="line"><a id="l01479" name="l01479"></a><span class="lineno"> 1479</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a id="l01480" name="l01480"></a><span class="lineno"> 1480</span>    <a class="code hl_class" href="class_range.html">Range</a> skin_faces_edges;</div>
<div class="line"><a id="l01481" name="l01481"></a><span class="lineno"> 1481</span>    <a class="code hl_class" href="class_range.html">Range</a> constrained_faces =</div>
<div class="line"><a id="l01482" name="l01482"></a><span class="lineno"> 1482</span>        unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>);</div>
<div class="line"><a id="l01483" name="l01483"></a><span class="lineno"> 1483</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>, constrained_faces), 1, <span class="keyword">false</span>,</div>
<div class="line"><a id="l01484" name="l01484"></a><span class="lineno"> 1484</span>                                skin_faces_edges, moab::Interface::UNION);</div>
<div class="line"><a id="l01485" name="l01485"></a><span class="lineno"> 1485</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_front;</div>
<div class="line"><a id="l01486" name="l01486"></a><span class="lineno"> 1486</span>    Skinner skin(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line"><a id="l01487" name="l01487"></a><span class="lineno"> 1487</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>, <span class="keyword">false</span>, crack_front);</div>
<div class="line"><a id="l01488" name="l01488"></a><span class="lineno"> 1488</span>    crack_front = subtract(crack_front, skin_faces_edges);</div>
<div class="line"><a id="l01489" name="l01489"></a><span class="lineno"> 1489</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>);</div>
<div class="line"><a id="l01490" name="l01490"></a><span class="lineno"> 1490</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l01491" name="l01491"></a><span class="lineno"> 1491</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, meshset);</div>
<div class="line"><a id="l01492" name="l01492"></a><span class="lineno"> 1492</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, crack_front);</div>
<div class="line"><a id="l01493" name="l01493"></a><span class="lineno"> 1493</span>  }</div>
<div class="line"><a id="l01494" name="l01494"></a><span class="lineno"> 1494</span> </div>
<div class="line"><a id="l01495" name="l01495"></a><span class="lineno"> 1495</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a id="l01496" name="l01496"></a><span class="lineno"> 1496</span>                                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01497" name="l01497"></a><span class="lineno"> 1497</span> </div>
<div class="line"><a id="l01498" name="l01498"></a><span class="lineno"> 1498</span>  <a class="code hl_class" href="class_range.html">Range</a> crack_faces_edges;</div>
<div class="line"><a id="l01499" name="l01499"></a><span class="lineno"> 1499</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>, 1, <span class="keyword">false</span>, crack_faces_edges,</div>
<div class="line"><a id="l01500" name="l01500"></a><span class="lineno"> 1500</span>                              moab::Interface::UNION);</div>
<div class="line"><a id="l01501" name="l01501"></a><span class="lineno"> 1501</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> = intersect(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, crack_faces_edges);</div>
<div class="line"><a id="l01502" name="l01502"></a><span class="lineno"> 1502</span> </div>
<div class="line"><a id="l01503" name="l01503"></a><span class="lineno"> 1503</span>  <span class="keywordflow">if</span> (verb &gt;= <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>)</div>
<div class="line"><a id="l01504" name="l01504"></a><span class="lineno"> 1504</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a id="l01505" name="l01505"></a><span class="lineno"> 1505</span>      cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01506" name="l01506"></a><span class="lineno"> 1506</span> </div>
<div class="line"><a id="l01507" name="l01507"></a><span class="lineno"> 1507</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01508" name="l01508"></a><span class="lineno"> 1508</span>    save_mesh(<span class="stringliteral">&quot;out_crack_and_front.vtk&quot;</span>, unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>));</div>
<div class="line"><a id="l01509" name="l01509"></a><span class="lineno"> 1509</span> </div>
<div class="line"><a id="l01510" name="l01510"></a><span class="lineno"> 1510</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01511" name="l01511"></a><span class="lineno"> 1511</span>}</div>
</div>
<div class="line"><a id="l01512" name="l01512"></a><span class="lineno"> 1512</span> </div>
<div class="foldopen" id="foldopen01513" data-start="{" data-end="}">
<div class="line"><a id="l01513" name="l01513"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a014e0fb69b4ef71920cc16ba3a7a6447"> 1513</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a014e0fb69b4ef71920cc16ba3a7a6447">CPMeshCut::findCrackFromPrisms</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"><a id="l01514" name="l01514"></a><span class="lineno"> 1514</span>                                              <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l01515" name="l01515"></a><span class="lineno"> 1515</span>                                              <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01516" name="l01516"></a><span class="lineno"> 1516</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01517" name="l01517"></a><span class="lineno"> 1517</span>  moab::Interface &amp;moab = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l01518" name="l01518"></a><span class="lineno"> 1518</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01519" name="l01519"></a><span class="lineno"> 1519</span> </div>
<div class="line"><a id="l01520" name="l01520"></a><span class="lineno"> 1520</span>  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> ents) {</div>
<div class="line"><a id="l01521" name="l01521"></a><span class="lineno"> 1521</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01522" name="l01522"></a><span class="lineno"> 1522</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a id="l01523" name="l01523"></a><span class="lineno"> 1523</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l01524" name="l01524"></a><span class="lineno"> 1524</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l01525" name="l01525"></a><span class="lineno"> 1525</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><a id="l01526" name="l01526"></a><span class="lineno"> 1526</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a id="l01527" name="l01527"></a><span class="lineno"> 1527</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l01528" name="l01528"></a><span class="lineno"> 1528</span>    }</div>
<div class="line"><a id="l01529" name="l01529"></a><span class="lineno"> 1529</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01530" name="l01530"></a><span class="lineno"> 1530</span>  };</div>
<div class="line"><a id="l01531" name="l01531"></a><span class="lineno"> 1531</span> </div>
<div class="line"><a id="l01532" name="l01532"></a><span class="lineno"> 1532</span>  <a class="code hl_class" href="class_range.html">Range</a> prisms_level;</div>
<div class="line"><a id="l01533" name="l01533"></a><span class="lineno"> 1533</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01534" name="l01534"></a><span class="lineno"> 1534</span>                                                 MBPRISM, prisms_level);</div>
<div class="line"><a id="l01535" name="l01535"></a><span class="lineno"> 1535</span>  prisms_level = subtract(prisms_level, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>);</div>
<div class="line"><a id="l01536" name="l01536"></a><span class="lineno"> 1536</span>  prisms_level = subtract(prisms_level, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a id="l01537" name="l01537"></a><span class="lineno"> 1537</span> </div>
<div class="line"><a id="l01538" name="l01538"></a><span class="lineno"> 1538</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.clear();</div>
<div class="line"><a id="l01539" name="l01539"></a><span class="lineno"> 1539</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.clear();</div>
<div class="line"><a id="l01540" name="l01540"></a><span class="lineno"> 1540</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : prisms_level) {</div>
<div class="line"><a id="l01541" name="l01541"></a><span class="lineno"> 1541</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> face3, face4;</div>
<div class="line"><a id="l01542" name="l01542"></a><span class="lineno"> 1542</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(p, 2, 3, face3);</div>
<div class="line"><a id="l01543" name="l01543"></a><span class="lineno"> 1543</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(p, 2, 4, face4);</div>
<div class="line"><a id="l01544" name="l01544"></a><span class="lineno"> 1544</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.insert(face3);</div>
<div class="line"><a id="l01545" name="l01545"></a><span class="lineno"> 1545</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.insert(face4);</div>
<div class="line"><a id="l01546" name="l01546"></a><span class="lineno"> 1546</span>  }</div>
<div class="line"><a id="l01547" name="l01547"></a><span class="lineno"> 1547</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a> = unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>);</div>
<div class="line"><a id="l01548" name="l01548"></a><span class="lineno"> 1548</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a41119eae52ef09ee41400233e1da8d78">deleteMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a id="l01549" name="l01549"></a><span class="lineno"> 1549</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a id="l01550" name="l01550"></a><span class="lineno"> 1550</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>,</div>
<div class="line"><a id="l01551" name="l01551"></a><span class="lineno"> 1551</span>                                             <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>);</div>
<div class="line"><a id="l01552" name="l01552"></a><span class="lineno"> 1552</span> </div>
<div class="line"><a id="l01553" name="l01553"></a><span class="lineno"> 1553</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aeead6e0c0f5b67f3aee1062f4668248e">otherSideConstrains</a> == PETSC_TRUE)</div>
<div class="line"><a id="l01554" name="l01554"></a><span class="lineno"> 1554</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.swap(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>);</div>
<div class="line"><a id="l01555" name="l01555"></a><span class="lineno"> 1555</span> </div>
<div class="line"><a id="l01556" name="l01556"></a><span class="lineno"> 1556</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01557" name="l01557"></a><span class="lineno"> 1557</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a id="l01558" name="l01558"></a><span class="lineno"> 1558</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;out_one_side.vtk&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>);</div>
<div class="line"><a id="l01559" name="l01559"></a><span class="lineno"> 1559</span>      <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.empty())</div>
<div class="line"><a id="l01560" name="l01560"></a><span class="lineno"> 1560</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;out_other_side.vtk&quot;</span>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>);</div>
<div class="line"><a id="l01561" name="l01561"></a><span class="lineno"> 1561</span>    }</div>
<div class="line"><a id="l01562" name="l01562"></a><span class="lineno"> 1562</span> </div>
<div class="line"><a id="l01563" name="l01563"></a><span class="lineno"> 1563</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.empty()) {</div>
<div class="line"><a id="l01564" name="l01564"></a><span class="lineno"> 1564</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.size() != <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.size())</div>
<div class="line"><a id="l01565" name="l01565"></a><span class="lineno"> 1565</span>      SETERRQ2(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l01566" name="l01566"></a><span class="lineno"> 1566</span>               <span class="stringliteral">&quot;Wrong number of faces on both sides of crack %d != %d&quot;</span>,</div>
<div class="line"><a id="l01567" name="l01567"></a><span class="lineno"> 1567</span>               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.size(), <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.size());</div>
<div class="line"><a id="l01568" name="l01568"></a><span class="lineno"> 1568</span>  }</div>
<div class="line"><a id="l01569" name="l01569"></a><span class="lineno"> 1569</span> </div>
<div class="line"><a id="l01570" name="l01570"></a><span class="lineno"> 1570</span>  <span class="comment">// Find crack front</span></div>
<div class="line"><a id="l01571" name="l01571"></a><span class="lineno"> 1571</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.clear();</div>
<div class="line"><a id="l01572" name="l01572"></a><span class="lineno"> 1572</span> </div>
<div class="line"><a id="l01573" name="l01573"></a><span class="lineno"> 1573</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a41119eae52ef09ee41400233e1da8d78">deleteMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a id="l01574" name="l01574"></a><span class="lineno"> 1574</span>  <span class="keyword">auto</span> create_front_meshset = [&amp;]() {</div>
<div class="line"><a id="l01575" name="l01575"></a><span class="lineno"> 1575</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01576" name="l01576"></a><span class="lineno"> 1576</span>    <a class="code hl_class" href="class_range.html">Range</a> skin_faces_edges;</div>
<div class="line"><a id="l01577" name="l01577"></a><span class="lineno"> 1577</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>), 1,</div>
<div class="line"><a id="l01578" name="l01578"></a><span class="lineno"> 1578</span>                                <span class="keyword">false</span>, skin_faces_edges,</div>
<div class="line"><a id="l01579" name="l01579"></a><span class="lineno"> 1579</span>                                moab::Interface::UNION);</div>
<div class="line"><a id="l01580" name="l01580"></a><span class="lineno"> 1580</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_front;</div>
<div class="line"><a id="l01581" name="l01581"></a><span class="lineno"> 1581</span>    Skinner skin(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line"><a id="l01582" name="l01582"></a><span class="lineno"> 1582</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>, <span class="keyword">false</span>, crack_front);</div>
<div class="line"><a id="l01583" name="l01583"></a><span class="lineno"> 1583</span>    crack_front = subtract(crack_front, skin_faces_edges);</div>
<div class="line"><a id="l01584" name="l01584"></a><span class="lineno"> 1584</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>);</div>
<div class="line"><a id="l01585" name="l01585"></a><span class="lineno"> 1585</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>,</div>
<div class="line"><a id="l01586" name="l01586"></a><span class="lineno"> 1586</span>                                               crack_front);</div>
<div class="line"><a id="l01587" name="l01587"></a><span class="lineno"> 1587</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01588" name="l01588"></a><span class="lineno"> 1588</span>  };</div>
<div class="line"><a id="l01589" name="l01589"></a><span class="lineno"> 1589</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> create_front_meshset();</div>
<div class="line"><a id="l01590" name="l01590"></a><span class="lineno"> 1590</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a id="l01591" name="l01591"></a><span class="lineno"> 1591</span>                                               <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01592" name="l01592"></a><span class="lineno"> 1592</span> </div>
<div class="line"><a id="l01593" name="l01593"></a><span class="lineno"> 1593</span>  <span class="keywordflow">if</span> (verb &gt;= <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>)</div>
<div class="line"><a id="l01594" name="l01594"></a><span class="lineno"> 1594</span>    <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a id="l01595" name="l01595"></a><span class="lineno"> 1595</span>      cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> &lt;&lt; endl;</div>
<div class="line"><a id="l01596" name="l01596"></a><span class="lineno"> 1596</span> </div>
<div class="line"><a id="l01597" name="l01597"></a><span class="lineno"> 1597</span>  <span class="keywordflow">if</span> (verb &gt;= <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>) {</div>
<div class="line"><a id="l01598" name="l01598"></a><span class="lineno"> 1598</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(),</div>
<div class="line"><a id="l01599" name="l01599"></a><span class="lineno"> 1599</span>                       <span class="stringliteral">&quot;number of Crack Surfaces Faces = %d\n&quot;</span>,</div>
<div class="line"><a id="l01600" name="l01600"></a><span class="lineno"> 1600</span>                       <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>.size());</div>
<div class="line"><a id="l01601" name="l01601"></a><span class="lineno"> 1601</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(),</div>
<div class="line"><a id="l01602" name="l01602"></a><span class="lineno"> 1602</span>                       <span class="stringliteral">&quot;number of Crack Surfaces Faces On One Side = %d\n&quot;</span>,</div>
<div class="line"><a id="l01603" name="l01603"></a><span class="lineno"> 1603</span>                       <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.size());</div>
<div class="line"><a id="l01604" name="l01604"></a><span class="lineno"> 1604</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(),</div>
<div class="line"><a id="l01605" name="l01605"></a><span class="lineno"> 1605</span>                       <span class="stringliteral">&quot;number of Crack Surfaces Faces On Other Side = %d\n&quot;</span>,</div>
<div class="line"><a id="l01606" name="l01606"></a><span class="lineno"> 1606</span>                       <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.size());</div>
<div class="line"><a id="l01607" name="l01607"></a><span class="lineno"> 1607</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;number of Crack Front Edges = %d\n&quot;</span>,</div>
<div class="line"><a id="l01608" name="l01608"></a><span class="lineno"> 1608</span>                       <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.size());</div>
<div class="line"><a id="l01609" name="l01609"></a><span class="lineno"> 1609</span>    <a class="code hl_class" href="class_range.html">Range</a> prisms_level;</div>
<div class="line"><a id="l01610" name="l01610"></a><span class="lineno"> 1610</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01611" name="l01611"></a><span class="lineno"> 1611</span>                                                   MBPRISM, prisms_level);</div>
<div class="line"><a id="l01612" name="l01612"></a><span class="lineno"> 1612</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;number of Prisms = %d\n&quot;</span>,</div>
<div class="line"><a id="l01613" name="l01613"></a><span class="lineno"> 1613</span>                       prisms_level.size());</div>
<div class="line"><a id="l01614" name="l01614"></a><span class="lineno"> 1614</span>  }</div>
<div class="line"><a id="l01615" name="l01615"></a><span class="lineno"> 1615</span> </div>
<div class="line"><a id="l01616" name="l01616"></a><span class="lineno"> 1616</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01617" name="l01617"></a><span class="lineno"> 1617</span>    save_mesh(<span class="stringliteral">&quot;out_crack_and_front.vtk&quot;</span>, unite(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>));</div>
<div class="line"><a id="l01618" name="l01618"></a><span class="lineno"> 1618</span> </div>
<div class="line"><a id="l01619" name="l01619"></a><span class="lineno"> 1619</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01620" name="l01620"></a><span class="lineno"> 1620</span>}</div>
</div>
<div class="line"><a id="l01621" name="l01621"></a><span class="lineno"> 1621</span> </div>
<div class="foldopen" id="foldopen01622" data-start="{" data-end="}">
<div class="line"><a id="l01622" name="l01622"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad9414d2adc14b121e7f705819054458d"> 1622</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad9414d2adc14b121e7f705819054458d">CPMeshCut::splitFaces</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01623" name="l01623"></a><span class="lineno"> 1623</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01624" name="l01624"></a><span class="lineno"> 1624</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l01625" name="l01625"></a><span class="lineno"> 1625</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_prism_interface.html">PrismInterface</a> *prism_interface;</div>
<div class="line"><a id="l01626" name="l01626"></a><span class="lineno"> 1626</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01627" name="l01627"></a><span class="lineno"> 1627</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(prism_interface);</div>
<div class="line"><a id="l01628" name="l01628"></a><span class="lineno"> 1628</span> </div>
<div class="line"><a id="l01629" name="l01629"></a><span class="lineno"> 1629</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a id="l01630" name="l01630"></a><span class="lineno"> 1630</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_split = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>];</div>
<div class="line"><a id="l01631" name="l01631"></a><span class="lineno"> 1631</span> </div>
<div class="line"><a id="l01632" name="l01632"></a><span class="lineno"> 1632</span>  <span class="comment">// split sides</span></div>
<div class="line"><a id="l01633" name="l01633"></a><span class="lineno"> 1633</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_interface;</div>
<div class="line"><a id="l01634" name="l01634"></a><span class="lineno"> 1634</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a id="l01635" name="l01635"></a><span class="lineno"> 1635</span>    PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Sideset %d with crack surface not found\n&quot;</span>,</div>
<div class="line"><a id="l01636" name="l01636"></a><span class="lineno"> 1636</span>                <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a id="l01637" name="l01637"></a><span class="lineno"> 1637</span>    <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line"><a id="l01638" name="l01638"></a><span class="lineno"> 1638</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gae0020f4f7cf7b27b8562f77fe5f21cab">getEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), ents);</div>
<div class="line"><a id="l01639" name="l01639"></a><span class="lineno"> 1639</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga486c46f5509f4e3e1d2f92b474ca781a">addBitRefLevel</a>(ents, bit_split);</div>
<div class="line"><a id="l01640" name="l01640"></a><span class="lineno"> 1640</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l01641" name="l01641"></a><span class="lineno"> 1641</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l01642" name="l01642"></a><span class="lineno"> 1642</span> </div>
<div class="line"><a id="l01643" name="l01643"></a><span class="lineno"> 1643</span>    <span class="comment">// clear tags data created by previous use of prism interface</span></div>
<div class="line"><a id="l01644" name="l01644"></a><span class="lineno"> 1644</span>    <a class="code hl_class" href="class_tag.html">Tag</a> th_interface_side;</div>
<div class="line"><a id="l01645" name="l01645"></a><span class="lineno"> 1645</span>    <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> =</div>
<div class="line"><a id="l01646" name="l01646"></a><span class="lineno"> 1646</span>        m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>, th_interface_side);</div>
<div class="line"><a id="l01647" name="l01647"></a><span class="lineno"> 1647</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a id="l01648" name="l01648"></a><span class="lineno"> 1648</span>      <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_delete(th_interface_side);</div>
<div class="line"><a id="l01649" name="l01649"></a><span class="lineno"> 1649</span> </div>
<div class="line"><a id="l01650" name="l01650"></a><span class="lineno"> 1650</span>    <span class="comment">// create meshset and insert entities from bit level to it</span></div>
<div class="line"><a id="l01651" name="l01651"></a><span class="lineno"> 1651</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> bit_meshset;</div>
<div class="line"><a id="l01652" name="l01652"></a><span class="lineno"> 1652</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_meshset(MESHSET_SET, bit_meshset);</div>
<div class="line"><a id="l01653" name="l01653"></a><span class="lineno"> 1653</span> </div>
<div class="line"><a id="l01654" name="l01654"></a><span class="lineno"> 1654</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01655" name="l01655"></a><span class="lineno"> 1655</span>                                                   MBTET, bit_meshset);</div>
<div class="line"><a id="l01656" name="l01656"></a><span class="lineno"> 1656</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01657" name="l01657"></a><span class="lineno"> 1657</span>                                                   MBPRISM, bit_meshset);</div>
<div class="line"><a id="l01658" name="l01658"></a><span class="lineno"> 1658</span> </div>
<div class="line"><a id="l01659" name="l01659"></a><span class="lineno"> 1659</span>    <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset) {</div>
<div class="line"><a id="l01660" name="l01660"></a><span class="lineno"> 1660</span>      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01661" name="l01661"></a><span class="lineno"> 1661</span>      <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a id="l01662" name="l01662"></a><span class="lineno"> 1662</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a id="l01663" name="l01663"></a><span class="lineno"> 1663</span>      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01664" name="l01664"></a><span class="lineno"> 1664</span>    };</div>
<div class="line"><a id="l01665" name="l01665"></a><span class="lineno"> 1665</span> </div>
<div class="line"><a id="l01666" name="l01666"></a><span class="lineno"> 1666</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a id="l01667" name="l01667"></a><span class="lineno"> 1667</span>                                     meshset_interface);</div>
<div class="line"><a id="l01668" name="l01668"></a><span class="lineno"> 1668</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l01669" name="l01669"></a><span class="lineno"> 1669</span>      save_mesh(<span class="stringliteral">&quot;crack_surface_before_split.vtk&quot;</span>, meshset_interface);</div>
<div class="line"><a id="l01670" name="l01670"></a><span class="lineno"> 1670</span> </div>
<div class="line"><a id="l01671" name="l01671"></a><span class="lineno"> 1671</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_prism_interface.html#a647ba4accc02b9b9c863af097045bb42">getSides</a>(meshset_interface, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">true</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"><a id="l01672" name="l01672"></a><span class="lineno"> 1672</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_prism_interface.html#ada01f8c0c3d86a8ae0e5cc2abdf59ceb">splitSides</a>(bit_meshset, bit_split,</div>
<div class="line"><a id="l01673" name="l01673"></a><span class="lineno"> 1673</span>                                       meshset_interface, <span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"><a id="l01674" name="l01674"></a><span class="lineno"> 1674</span>    <span class="comment">// add refined ent to cubit meshsets</span></div>
<div class="line"><a id="l01675" name="l01675"></a><span class="lineno"> 1675</span>    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(m_field, cubit_it)) {</div>
<div class="line"><a id="l01676" name="l01676"></a><span class="lineno"> 1676</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> update_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><a id="l01677" name="l01677"></a><span class="lineno"> 1677</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a id="l01678" name="l01678"></a><span class="lineno"> 1678</span>          update_meshset, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_split, bit_split,</div>
<div class="line"><a id="l01679" name="l01679"></a><span class="lineno"> 1679</span>          update_meshset, MBMAXTYPE, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01680" name="l01680"></a><span class="lineno"> 1680</span>    }</div>
<div class="line"><a id="l01681" name="l01681"></a><span class="lineno"> 1681</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;bit_meshset, 1);</div>
<div class="line"><a id="l01682" name="l01682"></a><span class="lineno"> 1682</span> </div>
<div class="line"><a id="l01683" name="l01683"></a><span class="lineno"> 1683</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a65aee45b2a3a458fd753a730a81509bb">isPartitioned</a>) {</div>
<div class="line"><a id="l01684" name="l01684"></a><span class="lineno"> 1684</span>      ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a id="l01685" name="l01685"></a><span class="lineno"> 1685</span>      <a class="code hl_class" href="class_tag.html">Tag</a> part_tag = pcomm-&gt;part_tag();</div>
<div class="line"><a id="l01686" name="l01686"></a><span class="lineno"> 1686</span>      <a class="code hl_class" href="class_range.html">Range</a> tagged_sets;</div>
<div class="line"><a id="l01687" name="l01687"></a><span class="lineno"> 1687</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type_and_tag(</div>
<div class="line"><a id="l01688" name="l01688"></a><span class="lineno"> 1688</span>          0, MBENTITYSET, &amp;part_tag, NULL, 1, tagged_sets,</div>
<div class="line"><a id="l01689" name="l01689"></a><span class="lineno"> 1689</span>          moab::Interface::UNION);</div>
<div class="line"><a id="l01690" name="l01690"></a><span class="lineno"> 1690</span>      <span class="keywordflow">for</span> (Range::iterator mit = tagged_sets.begin(); mit != tagged_sets.end();</div>
<div class="line"><a id="l01691" name="l01691"></a><span class="lineno"> 1691</span>           mit++) {</div>
<div class="line"><a id="l01692" name="l01692"></a><span class="lineno"> 1692</span>        <span class="keywordtype">int</span> part;</div>
<div class="line"><a id="l01693" name="l01693"></a><span class="lineno"> 1693</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(part_tag, &amp;*mit, 1, &amp;part);</div>
<div class="line"><a id="l01694" name="l01694"></a><span class="lineno"> 1694</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a id="l01695" name="l01695"></a><span class="lineno"> 1695</span>            *mit, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_split, bit_split, *mit, MBTET,</div>
<div class="line"><a id="l01696" name="l01696"></a><span class="lineno"> 1696</span>            <span class="keyword">true</span>);</div>
<div class="line"><a id="l01697" name="l01697"></a><span class="lineno"> 1697</span>        <a class="code hl_class" href="class_range.html">Range</a> ents3d;</div>
<div class="line"><a id="l01698" name="l01698"></a><span class="lineno"> 1698</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(*mit, 3, ents3d, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01699" name="l01699"></a><span class="lineno"> 1699</span>        <span class="keywordflow">for</span> (Range::iterator eit = ents3d.begin(); eit != ents3d.end(); eit++) {</div>
<div class="line"><a id="l01700" name="l01700"></a><span class="lineno"> 1700</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a id="l01701" name="l01701"></a><span class="lineno"> 1701</span>        }</div>
<div class="line"><a id="l01702" name="l01702"></a><span class="lineno"> 1702</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; dd != 3; dd++) {</div>
<div class="line"><a id="l01703" name="l01703"></a><span class="lineno"> 1703</span>          <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line"><a id="l01704" name="l01704"></a><span class="lineno"> 1704</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, dd, <span class="keyword">false</span>, ents,</div>
<div class="line"><a id="l01705" name="l01705"></a><span class="lineno"> 1705</span>                                      moab::Interface::UNION);</div>
<div class="line"><a id="l01706" name="l01706"></a><span class="lineno"> 1706</span>          <span class="keywordflow">for</span> (Range::iterator eit = ents.begin(); eit != ents.end(); eit++) {</div>
<div class="line"><a id="l01707" name="l01707"></a><span class="lineno"> 1707</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a id="l01708" name="l01708"></a><span class="lineno"> 1708</span>          }</div>
<div class="line"><a id="l01709" name="l01709"></a><span class="lineno"> 1709</span>        }</div>
<div class="line"><a id="l01710" name="l01710"></a><span class="lineno"> 1710</span>      }</div>
<div class="line"><a id="l01711" name="l01711"></a><span class="lineno"> 1711</span>    }</div>
<div class="line"><a id="l01712" name="l01712"></a><span class="lineno"> 1712</span> </div>
<div class="line"><a id="l01713" name="l01713"></a><span class="lineno"> 1713</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01714" name="l01714"></a><span class="lineno"> 1714</span>      <a class="code hl_class" href="class_range.html">Range</a> tets_level;</div>
<div class="line"><a id="l01715" name="l01715"></a><span class="lineno"> 1715</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l01716" name="l01716"></a><span class="lineno"> 1716</span>          bit_split, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets_level);</div>
<div class="line"><a id="l01717" name="l01717"></a><span class="lineno"> 1717</span>      <a class="code hl_class" href="class_range.html">Range</a> prisms_level;</div>
<div class="line"><a id="l01718" name="l01718"></a><span class="lineno"> 1718</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l01719" name="l01719"></a><span class="lineno"> 1719</span>          bit_split, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, prisms_level);</div>
<div class="line"><a id="l01720" name="l01720"></a><span class="lineno"> 1720</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_level;</div>
<div class="line"><a id="l01721" name="l01721"></a><span class="lineno"> 1721</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_level);</div>
<div class="line"><a id="l01722" name="l01722"></a><span class="lineno"> 1722</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_level, tets_level);</div>
<div class="line"><a id="l01723" name="l01723"></a><span class="lineno"> 1723</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_tets_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset_level,</div>
<div class="line"><a id="l01724" name="l01724"></a><span class="lineno"> 1724</span>                             1);</div>
<div class="line"><a id="l01725" name="l01725"></a><span class="lineno"> 1725</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_level, 1);</div>
<div class="line"><a id="l01726" name="l01726"></a><span class="lineno"> 1726</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_prims_level;</div>
<div class="line"><a id="l01727" name="l01727"></a><span class="lineno"> 1727</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_prims_level);</div>
<div class="line"><a id="l01728" name="l01728"></a><span class="lineno"> 1728</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_prims_level, prisms_level);</div>
<div class="line"><a id="l01729" name="l01729"></a><span class="lineno"> 1729</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_prisms_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l01730" name="l01730"></a><span class="lineno"> 1730</span>                             &amp;meshset_prims_level, 1);</div>
<div class="line"><a id="l01731" name="l01731"></a><span class="lineno"> 1731</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_prims_level, 1);</div>
<div class="line"><a id="l01732" name="l01732"></a><span class="lineno"> 1732</span>    }</div>
<div class="line"><a id="l01733" name="l01733"></a><span class="lineno"> 1733</span>  }</div>
<div class="line"><a id="l01734" name="l01734"></a><span class="lineno"> 1734</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01735" name="l01735"></a><span class="lineno"> 1735</span>    <a class="code hl_class" href="class_range.html">Range</a> tets_level;</div>
<div class="line"><a id="l01736" name="l01736"></a><span class="lineno"> 1736</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(bit_split, bit_split, MBTET,</div>
<div class="line"><a id="l01737" name="l01737"></a><span class="lineno"> 1737</span>                                                   tets_level);</div>
<div class="line"><a id="l01738" name="l01738"></a><span class="lineno"> 1738</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_level;</div>
<div class="line"><a id="l01739" name="l01739"></a><span class="lineno"> 1739</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_level);</div>
<div class="line"><a id="l01740" name="l01740"></a><span class="lineno"> 1740</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_level, tets_level);</div>
<div class="line"><a id="l01741" name="l01741"></a><span class="lineno"> 1741</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_tets_level_only.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset_level,</div>
<div class="line"><a id="l01742" name="l01742"></a><span class="lineno"> 1742</span>                           1);</div>
<div class="line"><a id="l01743" name="l01743"></a><span class="lineno"> 1743</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_level, 1);</div>
<div class="line"><a id="l01744" name="l01744"></a><span class="lineno"> 1744</span>  }</div>
<div class="line"><a id="l01745" name="l01745"></a><span class="lineno"> 1745</span> </div>
<div class="line"><a id="l01746" name="l01746"></a><span class="lineno"> 1746</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01747" name="l01747"></a><span class="lineno"> 1747</span>}</div>
</div>
<div class="line"><a id="l01748" name="l01748"></a><span class="lineno"> 1748</span> </div>
<div class="foldopen" id="foldopen01749" data-start="{" data-end="}">
<div class="line"><a id="l01749" name="l01749"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac03fb84b9a137a9a8572682605040928"> 1749</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac03fb84b9a137a9a8572682605040928">CPMeshCut::addMortarContactPrisms</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l01750" name="l01750"></a><span class="lineno"> 1750</span>                                                 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01751" name="l01751"></a><span class="lineno"> 1751</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01752" name="l01752"></a><span class="lineno"> 1752</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l01753" name="l01753"></a><span class="lineno"> 1753</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01754" name="l01754"></a><span class="lineno"> 1754</span> </div>
<div class="line"><a id="l01755" name="l01755"></a><span class="lineno"> 1755</span>  <a class="code hl_class" href="class_range.html">Range</a> integration_triangles;</div>
<div class="line"><a id="l01756" name="l01756"></a><span class="lineno"> 1756</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2496119aca48db18ce9f7b07361b6918">mortarContactMasterFaces</a>.clear();</div>
<div class="line"><a id="l01757" name="l01757"></a><span class="lineno"> 1757</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2c41e0bae191cf557046c75f7f69fc29">mortarContactSlaveFaces</a>.clear();</div>
<div class="line"><a id="l01758" name="l01758"></a><span class="lineno"> 1758</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.clear();</div>
<div class="line"><a id="l01759" name="l01759"></a><span class="lineno"> 1759</span> </div>
<div class="line"><a id="l01760" name="l01760"></a><span class="lineno"> 1760</span>  <a class="code hl_class" href="class_range.html">Range</a> all_masters, all_slaves;</div>
<div class="line"><a id="l01761" name="l01761"></a><span class="lineno"> 1761</span> </div>
<div class="line"><a id="l01762" name="l01762"></a><span class="lineno"> 1762</span>  std::vector&lt;std::pair&lt;Range, Range&gt;&gt; contact_surface_pairs; <span class="comment">// &lt;Slave, Master&gt;</span></div>
<div class="line"><a id="l01763" name="l01763"></a><span class="lineno"> 1763</span> </div>
<div class="line"><a id="l01764" name="l01764"></a><span class="lineno"> 1764</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_mortar_contact_structures.html#a36efbaf00f3d8c24b61be4d22b8e005e">MortarContactStructures::findContactSurfacePairs</a>(</div>
<div class="line"><a id="l01765" name="l01765"></a><span class="lineno"> 1765</span>      m_field, contact_surface_pairs);</div>
<div class="line"><a id="l01766" name="l01766"></a><span class="lineno"> 1766</span> </div>
<div class="line"><a id="l01767" name="l01767"></a><span class="lineno"> 1767</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ada5dc07850715aa99eeec5ccbe219b22">contactSearchMultiIndexPtr</a> =</div>
<div class="line"><a id="l01768" name="l01768"></a><span class="lineno"> 1768</span>      boost::shared_ptr&lt;ContactSearchKdTree::ContactCommonData_multiIndex&gt;(</div>
<div class="line"><a id="l01769" name="l01769"></a><span class="lineno"> 1769</span>          <span class="keyword">new</span> <a class="code hl_typedef" href="struct_contact_search_kd_tree.html#a76b52767690dbadb0c82a9e370bfcbdf">ContactSearchKdTree::ContactCommonData_multiIndex</a>());</div>
<div class="line"><a id="l01770" name="l01770"></a><span class="lineno"> 1770</span> </div>
<div class="line"><a id="l01771" name="l01771"></a><span class="lineno"> 1771</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;contact_surface_pair : contact_surface_pairs) {</div>
<div class="line"><a id="l01772" name="l01772"></a><span class="lineno"> 1772</span> </div>
<div class="line"><a id="l01773" name="l01773"></a><span class="lineno"> 1773</span>    <a class="code hl_class" href="class_range.html">Range</a> slave_tris = contact_surface_pair.first;</div>
<div class="line"><a id="l01774" name="l01774"></a><span class="lineno"> 1774</span>    <a class="code hl_class" href="class_range.html">Range</a> master_tris = contact_surface_pair.second;</div>
<div class="line"><a id="l01775" name="l01775"></a><span class="lineno"> 1775</span> </div>
<div class="line"><a id="l01776" name="l01776"></a><span class="lineno"> 1776</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>],</div>
<div class="line"><a id="l01777" name="l01777"></a><span class="lineno"> 1777</span>                                               <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), slave_tris);</div>
<div class="line"><a id="l01778" name="l01778"></a><span class="lineno"> 1778</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(</div>
<div class="line"><a id="l01779" name="l01779"></a><span class="lineno"> 1779</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), master_tris);</div>
<div class="line"><a id="l01780" name="l01780"></a><span class="lineno"> 1780</span> </div>
<div class="line"><a id="l01781" name="l01781"></a><span class="lineno"> 1781</span>    all_slaves.merge(slave_tris);</div>
<div class="line"><a id="l01782" name="l01782"></a><span class="lineno"> 1782</span>    all_masters.merge(master_tris);</div>
<div class="line"><a id="l01783" name="l01783"></a><span class="lineno"> 1783</span> </div>
<div class="line"><a id="l01784" name="l01784"></a><span class="lineno"> 1784</span>    <span class="keywordflow">if</span> (slave_tris.empty() || master_tris.empty())</div>
<div class="line"><a id="l01785" name="l01785"></a><span class="lineno"> 1785</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l01786" name="l01786"></a><span class="lineno"> 1786</span> </div>
<div class="line"><a id="l01787" name="l01787"></a><span class="lineno"> 1787</span>    <a class="code hl_struct" href="struct_contact_search_kd_tree.html">ContactSearchKdTree</a> contact_search_kd_tree(m_field);</div>
<div class="line"><a id="l01788" name="l01788"></a><span class="lineno"> 1788</span> </div>
<div class="line"><a id="l01789" name="l01789"></a><span class="lineno"> 1789</span>    <span class="comment">// create kd_tree with master_surface only</span></div>
<div class="line"><a id="l01790" name="l01790"></a><span class="lineno"> 1790</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> contact_search_kd_tree.<a class="code hl_function" href="struct_contact_search_kd_tree.html#a8eeb01dfbd0d967160fb1c8f8f0bfe76">buildTree</a>(master_tris);</div>
<div class="line"><a id="l01791" name="l01791"></a><span class="lineno"> 1791</span> </div>
<div class="line"><a id="l01792" name="l01792"></a><span class="lineno"> 1792</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> contact_search_kd_tree.<a class="code hl_function" href="struct_contact_search_kd_tree.html#a88532ad59785dacf8a672f95b46d02b5">contactSearchAlgorithm</a>(</div>
<div class="line"><a id="l01793" name="l01793"></a><span class="lineno"> 1793</span>        master_tris, slave_tris, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ada5dc07850715aa99eeec5ccbe219b22">contactSearchMultiIndexPtr</a>,</div>
<div class="line"><a id="l01794" name="l01794"></a><span class="lineno"> 1794</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a id="l01795" name="l01795"></a><span class="lineno"> 1795</span>  }</div>
<div class="line"><a id="l01796" name="l01796"></a><span class="lineno"> 1796</span> </div>
<div class="line"><a id="l01797" name="l01797"></a><span class="lineno"> 1797</span>  <span class="keywordflow">if</span> (all_slaves.empty() || all_masters.empty())</div>
<div class="line"><a id="l01798" name="l01798"></a><span class="lineno"> 1798</span>    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l01799" name="l01799"></a><span class="lineno"> 1799</span> </div>
<div class="line"><a id="l01800" name="l01800"></a><span class="lineno"> 1800</span>  <a class="code hl_class" href="class_range.html">Range</a> tris_from_prism;</div>
<div class="line"><a id="l01801" name="l01801"></a><span class="lineno"> 1801</span>  <span class="comment">// find actual masters and slave used</span></div>
<div class="line"><a id="l01802" name="l01802"></a><span class="lineno"> 1802</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>, 2, <span class="keyword">true</span>,</div>
<div class="line"><a id="l01803" name="l01803"></a><span class="lineno"> 1803</span>                                            tris_from_prism,</div>
<div class="line"><a id="l01804" name="l01804"></a><span class="lineno"> 1804</span>                                            moab::Interface::UNION);</div>
<div class="line"><a id="l01805" name="l01805"></a><span class="lineno"> 1805</span> </div>
<div class="line"><a id="l01806" name="l01806"></a><span class="lineno"> 1806</span>  tris_from_prism = tris_from_prism.subset_by_type(MBTRI);</div>
<div class="line"><a id="l01807" name="l01807"></a><span class="lineno"> 1807</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2496119aca48db18ce9f7b07361b6918">mortarContactMasterFaces</a> = intersect(tris_from_prism, all_masters);</div>
<div class="line"><a id="l01808" name="l01808"></a><span class="lineno"> 1808</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2c41e0bae191cf557046c75f7f69fc29">mortarContactSlaveFaces</a> = intersect(tris_from_prism, all_slaves);</div>
<div class="line"><a id="l01809" name="l01809"></a><span class="lineno"> 1809</span> </div>
<div class="line"><a id="l01810" name="l01810"></a><span class="lineno"> 1810</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_slave_master_prisms;</div>
<div class="line"><a id="l01811" name="l01811"></a><span class="lineno"> 1811</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_slave_master_prisms);</div>
<div class="line"><a id="l01812" name="l01812"></a><span class="lineno"> 1812</span> </div>
<div class="line"><a id="l01813" name="l01813"></a><span class="lineno"> 1813</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line"><a id="l01814" name="l01814"></a><span class="lineno"> 1814</span>  moab.add_entities(meshset_slave_master_prisms, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a id="l01815" name="l01815"></a><span class="lineno"> 1815</span> </div>
<div class="line"><a id="l01816" name="l01816"></a><span class="lineno"> 1816</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a id="l01817" name="l01817"></a><span class="lineno"> 1817</span>      meshset_slave_master_prisms, 3, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a id="l01818" name="l01818"></a><span class="lineno"> 1818</span> </div>
<div class="line"><a id="l01819" name="l01819"></a><span class="lineno"> 1819</span>  <span class="keyword">typedef</span> ContactSearchKdTree::ContactCommonData_multiIndex::index&lt;</div>
<div class="line"><a id="l01820" name="l01820"></a><span class="lineno"> 1820</span>      <a class="code hl_struct" href="struct_contact_search_kd_tree_1_1_prism__tag.html">ContactSearchKdTree::Prism_tag</a>&gt;::type::iterator ItMultIndexPrism;</div>
<div class="line"><a id="l01821" name="l01821"></a><span class="lineno"> 1821</span> </div>
<div class="line"><a id="l01822" name="l01822"></a><span class="lineno"> 1822</span>  <span class="keywordflow">for</span> (Range::iterator it_tri = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.begin();</div>
<div class="line"><a id="l01823" name="l01823"></a><span class="lineno"> 1823</span>       it_tri != <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.end(); ++it_tri) {</div>
<div class="line"><a id="l01824" name="l01824"></a><span class="lineno"> 1824</span> </div>
<div class="line"><a id="l01825" name="l01825"></a><span class="lineno"> 1825</span>    ItMultIndexPrism it_mult_index_prism =</div>
<div class="line"><a id="l01826" name="l01826"></a><span class="lineno"> 1826</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ada5dc07850715aa99eeec5ccbe219b22">contactSearchMultiIndexPtr</a>-&gt;get&lt;<a class="code hl_struct" href="struct_contact_search_kd_tree_1_1_prism__tag.html">ContactSearchKdTree::Prism_tag</a>&gt;()</div>
<div class="line"><a id="l01827" name="l01827"></a><span class="lineno"> 1827</span>            .find(*it_tri);</div>
<div class="line"><a id="l01828" name="l01828"></a><span class="lineno"> 1828</span> </div>
<div class="line"><a id="l01829" name="l01829"></a><span class="lineno"> 1829</span>    <a class="code hl_class" href="class_range.html">Range</a> range_poly_tris;</div>
<div class="line"><a id="l01830" name="l01830"></a><span class="lineno"> 1830</span>    range_poly_tris.clear();</div>
<div class="line"><a id="l01831" name="l01831"></a><span class="lineno"> 1831</span>    range_poly_tris = it_mult_index_prism-&gt;get()-&gt;commonIntegratedTriangle;</div>
<div class="line"><a id="l01832" name="l01832"></a><span class="lineno"> 1832</span>    integration_triangles.insert(range_poly_tris.begin(),</div>
<div class="line"><a id="l01833" name="l01833"></a><span class="lineno"> 1833</span>                                 range_poly_tris.end());</div>
<div class="line"><a id="l01834" name="l01834"></a><span class="lineno"> 1834</span>  }</div>
<div class="line"><a id="l01835" name="l01835"></a><span class="lineno"> 1835</span> </div>
<div class="line"><a id="l01836" name="l01836"></a><span class="lineno"> 1836</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent_integration_vertex;</div>
<div class="line"><a id="l01837" name="l01837"></a><span class="lineno"> 1837</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ent_integration_vertex);</div>
<div class="line"><a id="l01838" name="l01838"></a><span class="lineno"> 1838</span> </div>
<div class="line"><a id="l01839" name="l01839"></a><span class="lineno"> 1839</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent_integration_edge;</div>
<div class="line"><a id="l01840" name="l01840"></a><span class="lineno"> 1840</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ent_integration_edge);</div>
<div class="line"><a id="l01841" name="l01841"></a><span class="lineno"> 1841</span> </div>
<div class="line"><a id="l01842" name="l01842"></a><span class="lineno"> 1842</span>  <a class="code hl_class" href="class_range.html">Range</a> edges, verts;</div>
<div class="line"><a id="l01843" name="l01843"></a><span class="lineno"> 1843</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(integration_triangles, 1, <span class="keyword">true</span>,</div>
<div class="line"><a id="l01844" name="l01844"></a><span class="lineno"> 1844</span>                                            edges, moab::Interface::UNION);</div>
<div class="line"><a id="l01845" name="l01845"></a><span class="lineno"> 1845</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(ent_integration_edge, edges);</div>
<div class="line"><a id="l01846" name="l01846"></a><span class="lineno"> 1846</span> </div>
<div class="line"><a id="l01847" name="l01847"></a><span class="lineno"> 1847</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(integration_triangles, verts,</div>
<div class="line"><a id="l01848" name="l01848"></a><span class="lineno"> 1848</span>                                             <span class="keyword">true</span>);</div>
<div class="line"><a id="l01849" name="l01849"></a><span class="lineno"> 1849</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(ent_integration_vertex, verts);</div>
<div class="line"><a id="l01850" name="l01850"></a><span class="lineno"> 1850</span> </div>
<div class="line"><a id="l01851" name="l01851"></a><span class="lineno"> 1851</span>  <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent_integration_tris;</div>
<div class="line"><a id="l01852" name="l01852"></a><span class="lineno"> 1852</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ent_integration_tris);</div>
<div class="line"><a id="l01853" name="l01853"></a><span class="lineno"> 1853</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(ent_integration_tris, integration_triangles);</div>
<div class="line"><a id="l01854" name="l01854"></a><span class="lineno"> 1854</span> </div>
<div class="line"><a id="l01855" name="l01855"></a><span class="lineno"> 1855</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a id="l01856" name="l01856"></a><span class="lineno"> 1856</span>      ent_integration_vertex, 0, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a id="l01857" name="l01857"></a><span class="lineno"> 1857</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a id="l01858" name="l01858"></a><span class="lineno"> 1858</span>      ent_integration_edge, 1, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a id="l01859" name="l01859"></a><span class="lineno"> 1859</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a id="l01860" name="l01860"></a><span class="lineno"> 1860</span>      ent_integration_tris, 2, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a id="l01861" name="l01861"></a><span class="lineno"> 1861</span> </div>
<div class="line"><a id="l01862" name="l01862"></a><span class="lineno"> 1862</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;ent_integration_tris, 1);</div>
<div class="line"><a id="l01863" name="l01863"></a><span class="lineno"> 1863</span> </div>
<div class="line"><a id="l01864" name="l01864"></a><span class="lineno"> 1864</span>  <span class="keyword">const</span> std::string output_name = <span class="stringliteral">&quot;slave_master_prisms.vtk&quot;</span>;</div>
<div class="line"><a id="l01865" name="l01865"></a><span class="lineno"> 1865</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_mesh(output_name.c_str(), &amp;meshset_slave_master_prisms, 1);</div>
<div class="line"><a id="l01866" name="l01866"></a><span class="lineno"> 1866</span> </div>
<div class="line"><a id="l01867" name="l01867"></a><span class="lineno"> 1867</span>  <span class="comment">// get integration tris of each prism</span></div>
<div class="line"><a id="l01868" name="l01868"></a><span class="lineno"> 1868</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_slave_master_prisms, 1);</div>
<div class="line"><a id="l01869" name="l01869"></a><span class="lineno"> 1869</span> </div>
<div class="line"><a id="l01870" name="l01870"></a><span class="lineno"> 1870</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01871" name="l01871"></a><span class="lineno"> 1871</span>}</div>
</div>
<div class="line"><a id="l01872" name="l01872"></a><span class="lineno"> 1872</span> </div>
<div class="foldopen" id="foldopen01873" data-start="{" data-end="}">
<div class="line"><a id="l01873" name="l01873"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a41a144d57c8ca97574d6b5714b2be697"> 1873</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a41a144d57c8ca97574d6b5714b2be697">CPMeshCut::insertContactInterface</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l01874" name="l01874"></a><span class="lineno"> 1874</span>                                                 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l01875" name="l01875"></a><span class="lineno"> 1875</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l01876" name="l01876"></a><span class="lineno"> 1876</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l01877" name="l01877"></a><span class="lineno"> 1877</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_prism_interface.html">PrismInterface</a> *prism_interface;</div>
<div class="line"><a id="l01878" name="l01878"></a><span class="lineno"> 1878</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l01879" name="l01879"></a><span class="lineno"> 1879</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(prism_interface);</div>
<div class="line"><a id="l01880" name="l01880"></a><span class="lineno"> 1880</span> </div>
<div class="line"><a id="l01881" name="l01881"></a><span class="lineno"> 1881</span>  std::vector&lt;BitRefLevel&gt; bit_levels;</div>
<div class="line"><a id="l01882" name="l01882"></a><span class="lineno"> 1882</span>  bit_levels.push_back(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>]);</div>
<div class="line"><a id="l01883" name="l01883"></a><span class="lineno"> 1883</span> </div>
<div class="line"><a id="l01884" name="l01884"></a><span class="lineno"> 1884</span>  <span class="keyword">auto</span> get_cracked_not_in_body_blockset = [&amp;](<span class="keyword">auto</span> ref_level_meshset) {</div>
<div class="line"><a id="l01885" name="l01885"></a><span class="lineno"> 1885</span>    <a class="code hl_class" href="class_range.html">Range</a> ref_level_tet;</div>
<div class="line"><a id="l01886" name="l01886"></a><span class="lineno"> 1886</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(ref_level_meshset, MBTET, ref_level_tet,</div>
<div class="line"><a id="l01887" name="l01887"></a><span class="lineno"> 1887</span>                                     0);</div>
<div class="line"><a id="l01888" name="l01888"></a><span class="lineno"> 1888</span>    <a class="code hl_class" href="class_range.html">Range</a> cracked_body_tets;</div>
<div class="line"><a id="l01889" name="l01889"></a><span class="lineno"> 1889</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a id="l01890" name="l01890"></a><span class="lineno"> 1890</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, cracked_body_tets, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01891" name="l01891"></a><span class="lineno"> 1891</span>    <span class="keywordflow">return</span> subtract(ref_level_tet, cracked_body_tets);</div>
<div class="line"><a id="l01892" name="l01892"></a><span class="lineno"> 1892</span>  };</div>
<div class="line"><a id="l01893" name="l01893"></a><span class="lineno"> 1893</span> </div>
<div class="line"><a id="l01894" name="l01894"></a><span class="lineno"> 1894</span>  std::size_t idx = 0;</div>
<div class="line"><a id="l01895" name="l01895"></a><span class="lineno"> 1895</span>  <span class="keywordflow">while</span> (!bit_levels.back().test(idx))</div>
<div class="line"><a id="l01896" name="l01896"></a><span class="lineno"> 1896</span>    ++idx;</div>
<div class="line"><a id="l01897" name="l01897"></a><span class="lineno"> 1897</span>  <span class="keywordtype">int</span> contact_lvl = idx + 1;</div>
<div class="line"><a id="l01898" name="l01898"></a><span class="lineno"> 1898</span> </div>
<div class="line"><a id="l01899" name="l01899"></a><span class="lineno"> 1899</span>  <span class="comment">// Remove parents, that should be no use anymore</span></div>
<div class="line"><a id="l01900" name="l01900"></a><span class="lineno"> 1900</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a315359c2e34aac52f9fa976960b1a46d">reconstructMultiIndex</a>(*m_field.<a class="code hl_function" href="group__mofem__access.html#gab81fea6cf1c5d738df6d2a043b1b45a8">get_ref_ents</a>(),</div>
<div class="line"><a id="l01901" name="l01901"></a><span class="lineno"> 1901</span>                               <a class="code hl_struct" href="struct_mo_f_e_m_1_1_ref_entity__change__parent.html">RefEntity_change_parent</a>(0));</div>
<div class="line"><a id="l01902" name="l01902"></a><span class="lineno"> 1902</span> </div>
<div class="line"><a id="l01903" name="l01903"></a><span class="lineno"> 1903</span>  <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, cit)) {</div>
<div class="line"><a id="l01904" name="l01904"></a><span class="lineno"> 1904</span>    <span class="keywordflow">if</span> (cit-&gt;getName().compare(0, 11, <span class="stringliteral">&quot;INT_CONTACT&quot;</span>) == 0) {</div>
<div class="line"><a id="l01905" name="l01905"></a><span class="lineno"> 1905</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Insert %s (id: %d)\n&quot;</span>,</div>
<div class="line"><a id="l01906" name="l01906"></a><span class="lineno"> 1906</span>                         cit-&gt;getName().c_str(), cit-&gt;getMeshsetId());</div>
<div class="line"><a id="l01907" name="l01907"></a><span class="lineno"> 1907</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> cubit_meshset = cit-&gt;getMeshset();</div>
<div class="line"><a id="l01908" name="l01908"></a><span class="lineno"> 1908</span> </div>
<div class="line"><a id="l01909" name="l01909"></a><span class="lineno"> 1909</span>      <span class="comment">// get tet entities form back bit_level</span></div>
<div class="line"><a id="l01910" name="l01910"></a><span class="lineno"> 1910</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ref_level_meshset;</div>
<div class="line"><a id="l01911" name="l01911"></a><span class="lineno"> 1911</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ref_level_meshset);</div>
<div class="line"><a id="l01912" name="l01912"></a><span class="lineno"> 1912</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l01913" name="l01913"></a><span class="lineno"> 1913</span>          bit_levels.back(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, ref_level_meshset);</div>
<div class="line"><a id="l01914" name="l01914"></a><span class="lineno"> 1914</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l01915" name="l01915"></a><span class="lineno"> 1915</span>          bit_levels.back(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, ref_level_meshset);</div>
<div class="line"><a id="l01916" name="l01916"></a><span class="lineno"> 1916</span> </div>
<div class="line"><a id="l01917" name="l01917"></a><span class="lineno"> 1917</span>      <span class="comment">// get faces and tets to split</span></div>
<div class="line"><a id="l01918" name="l01918"></a><span class="lineno"> 1918</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_prism_interface.html#a647ba4accc02b9b9c863af097045bb42">getSides</a>(</div>
<div class="line"><a id="l01919" name="l01919"></a><span class="lineno"> 1919</span>          cubit_meshset, bit_levels.back(),</div>
<div class="line"><a id="l01920" name="l01920"></a><span class="lineno"> 1920</span>          get_cracked_not_in_body_blockset(ref_level_meshset), <span class="keyword">true</span>, verb);</div>
<div class="line"><a id="l01921" name="l01921"></a><span class="lineno"> 1921</span>      <span class="comment">// set new bit level</span></div>
<div class="line"><a id="l01922" name="l01922"></a><span class="lineno"> 1922</span>      bit_levels.push_back(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(contact_lvl));</div>
<div class="line"><a id="l01923" name="l01923"></a><span class="lineno"> 1923</span>      <span class="comment">// split faces and tets</span></div>
<div class="line"><a id="l01924" name="l01924"></a><span class="lineno"> 1924</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_prism_interface.html#ada01f8c0c3d86a8ae0e5cc2abdf59ceb">splitSides</a>(ref_level_meshset, bit_levels.back(),</div>
<div class="line"><a id="l01925" name="l01925"></a><span class="lineno"> 1925</span>                                         cubit_meshset, <span class="keyword">true</span>, <span class="keyword">true</span>, verb);</div>
<div class="line"><a id="l01926" name="l01926"></a><span class="lineno"> 1926</span> </div>
<div class="line"><a id="l01927" name="l01927"></a><span class="lineno"> 1927</span>      <span class="comment">// clean meshsets</span></div>
<div class="line"><a id="l01928" name="l01928"></a><span class="lineno"> 1928</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;ref_level_meshset, 1);</div>
<div class="line"><a id="l01929" name="l01929"></a><span class="lineno"> 1929</span> </div>
<div class="line"><a id="l01930" name="l01930"></a><span class="lineno"> 1930</span>      <span class="comment">// update cubit meshsets</span></div>
<div class="line"><a id="l01931" name="l01931"></a><span class="lineno"> 1931</span>      <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(m_field, cubit_it)) {</div>
<div class="line"><a id="l01932" name="l01932"></a><span class="lineno"> 1932</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> updated_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><a id="l01933" name="l01933"></a><span class="lineno"> 1933</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a id="l01934" name="l01934"></a><span class="lineno"> 1934</span>            updated_meshset, bit_levels.front(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l01935" name="l01935"></a><span class="lineno"> 1935</span>            bit_levels.back(), bit_levels.back(), updated_meshset, MBMAXTYPE,</div>
<div class="line"><a id="l01936" name="l01936"></a><span class="lineno"> 1936</span>            <span class="keyword">true</span>);</div>
<div class="line"><a id="l01937" name="l01937"></a><span class="lineno"> 1937</span>      }</div>
<div class="line"><a id="l01938" name="l01938"></a><span class="lineno"> 1938</span> </div>
<div class="line"><a id="l01939" name="l01939"></a><span class="lineno"> 1939</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a65aee45b2a3a458fd753a730a81509bb">isPartitioned</a>) {</div>
<div class="line"><a id="l01940" name="l01940"></a><span class="lineno"> 1940</span>        <span class="comment">// FIXME check partitioned case</span></div>
<div class="line"><a id="l01941" name="l01941"></a><span class="lineno"> 1941</span>        ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a id="l01942" name="l01942"></a><span class="lineno"> 1942</span>        <a class="code hl_class" href="class_tag.html">Tag</a> part_tag = pcomm-&gt;part_tag();</div>
<div class="line"><a id="l01943" name="l01943"></a><span class="lineno"> 1943</span>        <a class="code hl_class" href="class_range.html">Range</a> tagged_sets;</div>
<div class="line"><a id="l01944" name="l01944"></a><span class="lineno"> 1944</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type_and_tag(</div>
<div class="line"><a id="l01945" name="l01945"></a><span class="lineno"> 1945</span>            0, MBENTITYSET, &amp;part_tag, NULL, 1, tagged_sets,</div>
<div class="line"><a id="l01946" name="l01946"></a><span class="lineno"> 1946</span>            moab::Interface::UNION);</div>
<div class="line"><a id="l01947" name="l01947"></a><span class="lineno"> 1947</span>        <span class="keywordflow">for</span> (Range::iterator mit = tagged_sets.begin();</div>
<div class="line"><a id="l01948" name="l01948"></a><span class="lineno"> 1948</span>             mit != tagged_sets.end(); mit++) {</div>
<div class="line"><a id="l01949" name="l01949"></a><span class="lineno"> 1949</span>          <span class="keywordtype">int</span> part;</div>
<div class="line"><a id="l01950" name="l01950"></a><span class="lineno"> 1950</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(part_tag, &amp;*mit, 1, &amp;part);</div>
<div class="line"><a id="l01951" name="l01951"></a><span class="lineno"> 1951</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a id="l01952" name="l01952"></a><span class="lineno"> 1952</span>              *mit, bit_levels.front(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_levels.back(),</div>
<div class="line"><a id="l01953" name="l01953"></a><span class="lineno"> 1953</span>              bit_levels.back(), *mit, MBTET, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01954" name="l01954"></a><span class="lineno"> 1954</span>          <a class="code hl_class" href="class_range.html">Range</a> ents3d;</div>
<div class="line"><a id="l01955" name="l01955"></a><span class="lineno"> 1955</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(*mit, 3, ents3d, <span class="keyword">true</span>);</div>
<div class="line"><a id="l01956" name="l01956"></a><span class="lineno"> 1956</span>          <span class="keywordflow">for</span> (Range::iterator eit = ents3d.begin(); eit != ents3d.end();</div>
<div class="line"><a id="l01957" name="l01957"></a><span class="lineno"> 1957</span>               eit++) {</div>
<div class="line"><a id="l01958" name="l01958"></a><span class="lineno"> 1958</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a id="l01959" name="l01959"></a><span class="lineno"> 1959</span>          }</div>
<div class="line"><a id="l01960" name="l01960"></a><span class="lineno"> 1960</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; dd != 3; dd++) {</div>
<div class="line"><a id="l01961" name="l01961"></a><span class="lineno"> 1961</span>            <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line"><a id="l01962" name="l01962"></a><span class="lineno"> 1962</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, dd, <span class="keyword">false</span>, ents,</div>
<div class="line"><a id="l01963" name="l01963"></a><span class="lineno"> 1963</span>                                        moab::Interface::UNION);</div>
<div class="line"><a id="l01964" name="l01964"></a><span class="lineno"> 1964</span>            <span class="keywordflow">for</span> (Range::iterator eit = ents.begin(); eit != ents.end(); eit++) {</div>
<div class="line"><a id="l01965" name="l01965"></a><span class="lineno"> 1965</span>              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a id="l01966" name="l01966"></a><span class="lineno"> 1966</span>            }</div>
<div class="line"><a id="l01967" name="l01967"></a><span class="lineno"> 1967</span>          }</div>
<div class="line"><a id="l01968" name="l01968"></a><span class="lineno"> 1968</span>        }</div>
<div class="line"><a id="l01969" name="l01969"></a><span class="lineno"> 1969</span>      }</div>
<div class="line"><a id="l01970" name="l01970"></a><span class="lineno"> 1970</span> </div>
<div class="line"><a id="l01971" name="l01971"></a><span class="lineno"> 1971</span>      <span class="keywordflow">if</span> (contact_lvl &gt; 1) {</div>
<div class="line"><a id="l01972" name="l01972"></a><span class="lineno"> 1972</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a42896dd46513db84c3a4c8e49af197e6">delete_ents_by_bit_ref</a>(bit_levels.front(),</div>
<div class="line"><a id="l01973" name="l01973"></a><span class="lineno"> 1973</span>                                              bit_levels.front(), <span class="keyword">true</span>);</div>
<div class="line"><a id="l01974" name="l01974"></a><span class="lineno"> 1974</span>      }</div>
<div class="line"><a id="l01975" name="l01975"></a><span class="lineno"> 1975</span>      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> shift_mask;</div>
<div class="line"><a id="l01976" name="l01976"></a><span class="lineno"> 1976</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = contact_lvl - 1; ll != 19; ++ll) {</div>
<div class="line"><a id="l01977" name="l01977"></a><span class="lineno"> 1977</span>        shift_mask.set(ll);</div>
<div class="line"><a id="l01978" name="l01978"></a><span class="lineno"> 1978</span>      }</div>
<div class="line"><a id="l01979" name="l01979"></a><span class="lineno"> 1979</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;shiftRightBitRef(</div>
<div class="line"><a id="l01980" name="l01980"></a><span class="lineno"> 1980</span>          1, shift_mask, verb);</div>
<div class="line"><a id="l01981" name="l01981"></a><span class="lineno"> 1981</span>      bit_levels.pop_back();</div>
<div class="line"><a id="l01982" name="l01982"></a><span class="lineno"> 1982</span>    }</div>
<div class="line"><a id="l01983" name="l01983"></a><span class="lineno"> 1983</span>  }</div>
<div class="line"><a id="l01984" name="l01984"></a><span class="lineno"> 1984</span> </div>
<div class="line"><a id="l01985" name="l01985"></a><span class="lineno"> 1985</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>)) {</div>
<div class="line"><a id="l01986" name="l01986"></a><span class="lineno"> 1986</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a41119eae52ef09ee41400233e1da8d78">deleteMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>);</div>
<div class="line"><a id="l01987" name="l01987"></a><span class="lineno"> 1987</span>  }</div>
<div class="line"><a id="l01988" name="l01988"></a><span class="lineno"> 1988</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>);</div>
<div class="line"><a id="l01989" name="l01989"></a><span class="lineno"> 1989</span> </div>
<div class="line"><a id="l01990" name="l01990"></a><span class="lineno"> 1990</span>  <a class="code hl_class" href="class_range.html">Range</a> prisms_level;</div>
<div class="line"><a id="l01991" name="l01991"></a><span class="lineno"> 1991</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a id="l01992" name="l01992"></a><span class="lineno"> 1992</span>      bit_levels.back(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, prisms_level);</div>
<div class="line"><a id="l01993" name="l01993"></a><span class="lineno"> 1993</span> </div>
<div class="line"><a id="l01994" name="l01994"></a><span class="lineno"> 1994</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_meshsets_manager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>,</div>
<div class="line"><a id="l01995" name="l01995"></a><span class="lineno"> 1995</span>                                             prisms_level);</div>
<div class="line"><a id="l01996" name="l01996"></a><span class="lineno"> 1996</span> </div>
<div class="line"><a id="l01997" name="l01997"></a><span class="lineno"> 1997</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l01998" name="l01998"></a><span class="lineno"> 1998</span>}</div>
</div>
<div class="line"><a id="l01999" name="l01999"></a><span class="lineno"> 1999</span> </div>
<div class="foldopen" id="foldopen02000" data-start="{" data-end="}">
<div class="line"><a id="l02000" name="l02000"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0de9d9a2e911031c8e9086441450a89d"> 2000</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0de9d9a2e911031c8e9086441450a89d">CPMeshCut::findContactFromPrisms</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"><a id="l02001" name="l02001"></a><span class="lineno"> 2001</span>                                                <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l02002" name="l02002"></a><span class="lineno"> 2002</span>                                                <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02003" name="l02003"></a><span class="lineno"> 2003</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l02004" name="l02004"></a><span class="lineno"> 2004</span>  moab::Interface &amp;moab = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l02005" name="l02005"></a><span class="lineno"> 2005</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02006" name="l02006"></a><span class="lineno"> 2006</span> </div>
<div class="line"><a id="l02007" name="l02007"></a><span class="lineno"> 2007</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>.clear();</div>
<div class="line"><a id="l02008" name="l02008"></a><span class="lineno"> 2008</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>.clear();</div>
<div class="line"><a id="l02009" name="l02009"></a><span class="lineno"> 2009</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>.clear();</div>
<div class="line"><a id="l02010" name="l02010"></a><span class="lineno"> 2010</span> </div>
<div class="line"><a id="l02011" name="l02011"></a><span class="lineno"> 2011</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a id="l02012" name="l02012"></a><span class="lineno"> 2012</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02013" name="l02013"></a><span class="lineno"> 2013</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02014" name="l02014"></a><span class="lineno"> 2014</span>                                             <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>);</div>
<div class="line"><a id="l02015" name="l02015"></a><span class="lineno"> 2015</span> </div>
<div class="line"><a id="l02016" name="l02016"></a><span class="lineno"> 2016</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.empty())</div>
<div class="line"><a id="l02017" name="l02017"></a><span class="lineno"> 2017</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a> = subtract(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a id="l02018" name="l02018"></a><span class="lineno"> 2018</span> </div>
<div class="line"><a id="l02019" name="l02019"></a><span class="lineno"> 2019</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>.empty()) {</div>
<div class="line"><a id="l02020" name="l02020"></a><span class="lineno"> 2020</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> tri;</div>
<div class="line"><a id="l02021" name="l02021"></a><span class="lineno"> 2021</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>) {</div>
<div class="line"><a id="l02022" name="l02022"></a><span class="lineno"> 2022</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 3, tri);</div>
<div class="line"><a id="l02023" name="l02023"></a><span class="lineno"> 2023</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>.insert(tri);</div>
<div class="line"><a id="l02024" name="l02024"></a><span class="lineno"> 2024</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 4, tri);</div>
<div class="line"><a id="l02025" name="l02025"></a><span class="lineno"> 2025</span>      <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>.insert(tri);</div>
<div class="line"><a id="l02026" name="l02026"></a><span class="lineno"> 2026</span>    }</div>
<div class="line"><a id="l02027" name="l02027"></a><span class="lineno"> 2027</span>  }</div>
<div class="line"><a id="l02028" name="l02028"></a><span class="lineno"> 2028</span> </div>
<div class="line"><a id="l02029" name="l02029"></a><span class="lineno"> 2029</span>  <a class="code hl_class" href="class_range.html">Range</a> slave_nodes, master_nodes;</div>
<div class="line"><a id="l02030" name="l02030"></a><span class="lineno"> 2030</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>, slave_nodes, <span class="keyword">false</span>);</div>
<div class="line"><a id="l02031" name="l02031"></a><span class="lineno"> 2031</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>, master_nodes, <span class="keyword">false</span>);</div>
<div class="line"><a id="l02032" name="l02032"></a><span class="lineno"> 2032</span> </div>
<div class="line"><a id="l02033" name="l02033"></a><span class="lineno"> 2033</span>  <span class="keywordflow">if</span> (slave_nodes.size() &lt; master_nodes.size()) {</div>
<div class="line"><a id="l02034" name="l02034"></a><span class="lineno"> 2034</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ad82f7651bfa9bdd97923bafe67507970">contactBothSidesSlaveFaces</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>;</div>
<div class="line"><a id="l02035" name="l02035"></a><span class="lineno"> 2035</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6f5533e767c5bbc98475098a32ae331d">contactBothSidesMasterFaces</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>;</div>
<div class="line"><a id="l02036" name="l02036"></a><span class="lineno"> 2036</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l02037" name="l02037"></a><span class="lineno"> 2037</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ad82f7651bfa9bdd97923bafe67507970">contactBothSidesSlaveFaces</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>;</div>
<div class="line"><a id="l02038" name="l02038"></a><span class="lineno"> 2038</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a6f5533e767c5bbc98475098a32ae331d">contactBothSidesMasterFaces</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>;</div>
<div class="line"><a id="l02039" name="l02039"></a><span class="lineno"> 2039</span>  }</div>
<div class="line"><a id="l02040" name="l02040"></a><span class="lineno"> 2040</span> </div>
<div class="line"><a id="l02041" name="l02041"></a><span class="lineno"> 2041</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02042" name="l02042"></a><span class="lineno"> 2042</span>}</div>
</div>
<div class="line"><a id="l02043" name="l02043"></a><span class="lineno"> 2043</span> </div>
<div class="foldopen" id="foldopen02044" data-start="{" data-end="}">
<div class="line"><a id="l02044" name="l02044"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a399c5f3e1a6af3220b14ea3720f542cf"> 2044</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a399c5f3e1a6af3220b14ea3720f542cf">CPMeshCut::refineCrackTip</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> front_id, <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l02045" name="l02045"></a><span class="lineno"> 2045</span>                                         <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02046" name="l02046"></a><span class="lineno"> 2046</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l02047" name="l02047"></a><span class="lineno"> 2047</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l02048" name="l02048"></a><span class="lineno"> 2048</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_mesh_refinement.html">MeshRefinement</a> *mesh_refiner_ptr;</div>
<div class="line"><a id="l02049" name="l02049"></a><span class="lineno"> 2049</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02050" name="l02050"></a><span class="lineno"> 2050</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(mesh_refiner_ptr);</div>
<div class="line"><a id="l02051" name="l02051"></a><span class="lineno"> 2051</span> </div>
<div class="line"><a id="l02052" name="l02052"></a><span class="lineno"> 2052</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a id="l02053" name="l02053"></a><span class="lineno"> 2053</span> </div>
<div class="line"><a id="l02054" name="l02054"></a><span class="lineno"> 2054</span>  std::size_t idx = 0;</div>
<div class="line"><a id="l02055" name="l02055"></a><span class="lineno"> 2055</span>  <span class="keywordflow">while</span> (!<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.test(idx))</div>
<div class="line"><a id="l02056" name="l02056"></a><span class="lineno"> 2056</span>    ++idx;</div>
<div class="line"><a id="l02057" name="l02057"></a><span class="lineno"> 2057</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_ref = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(idx + 1);</div>
<div class="line"><a id="l02058" name="l02058"></a><span class="lineno"> 2058</span> </div>
<div class="line"><a id="l02059" name="l02059"></a><span class="lineno"> 2059</span>  <span class="comment">// loop to refine at crack tip</span></div>
<div class="line"><a id="l02060" name="l02060"></a><span class="lineno"> 2060</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a47f76009627efe1034647a0582c73794">refAtCrackTip</a>; ll++) {</div>
<div class="line"><a id="l02061" name="l02061"></a><span class="lineno"> 2061</span> </div>
<div class="line"><a id="l02062" name="l02062"></a><span class="lineno"> 2062</span>    <span class="comment">// get tets at bit level</span></div>
<div class="line"><a id="l02063" name="l02063"></a><span class="lineno"> 2063</span>    <a class="code hl_class" href="class_range.html">Range</a> tets_level; <span class="comment">// test at level</span></div>
<div class="line"><a id="l02064" name="l02064"></a><span class="lineno"> 2064</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02065" name="l02065"></a><span class="lineno"> 2065</span>                                                   MBTET, tets_level);</div>
<div class="line"><a id="l02066" name="l02066"></a><span class="lineno"> 2066</span>    <a class="code hl_class" href="class_range.html">Range</a> edges_level; <span class="comment">// edges at level</span></div>
<div class="line"><a id="l02067" name="l02067"></a><span class="lineno"> 2067</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02068" name="l02068"></a><span class="lineno"> 2068</span>                                                   MBEDGE, edges_level);</div>
<div class="line"><a id="l02069" name="l02069"></a><span class="lineno"> 2069</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(front_id, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a id="l02070" name="l02070"></a><span class="lineno"> 2070</span>      PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Sideset %d with crack front not found\n&quot;</span>,</div>
<div class="line"><a id="l02071" name="l02071"></a><span class="lineno"> 2071</span>                  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>);</div>
<div class="line"><a id="l02072" name="l02072"></a><span class="lineno"> 2072</span>      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a id="l02073" name="l02073"></a><span class="lineno"> 2073</span>    }</div>
<div class="line"><a id="l02074" name="l02074"></a><span class="lineno"> 2074</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_front; <span class="comment">// crack front edges at level</span></div>
<div class="line"><a id="l02075" name="l02075"></a><span class="lineno"> 2075</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(front_id, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a id="l02076" name="l02076"></a><span class="lineno"> 2076</span>                                                 crack_front, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02077" name="l02077"></a><span class="lineno"> 2077</span>    crack_front = intersect(crack_front, edges_level);</div>
<div class="line"><a id="l02078" name="l02078"></a><span class="lineno"> 2078</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_front_nodes; <span class="comment">// nodes at crack front</span></div>
<div class="line"><a id="l02079" name="l02079"></a><span class="lineno"> 2079</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(crack_front, crack_front_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02080" name="l02080"></a><span class="lineno"> 2080</span> </div>
<div class="line"><a id="l02081" name="l02081"></a><span class="lineno"> 2081</span>    <a class="code hl_class" href="class_range.html">Range</a> crack_front_nodes_tets; <span class="comment">// tets adjacent to crack front nodes</span></div>
<div class="line"><a id="l02082" name="l02082"></a><span class="lineno"> 2082</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(crack_front_nodes, 3, <span class="keyword">false</span>,</div>
<div class="line"><a id="l02083" name="l02083"></a><span class="lineno"> 2083</span>                                              crack_front_nodes_tets,</div>
<div class="line"><a id="l02084" name="l02084"></a><span class="lineno"> 2084</span>                                              moab::Interface::UNION);</div>
<div class="line"><a id="l02085" name="l02085"></a><span class="lineno"> 2085</span>    crack_front_nodes_tets = intersect(crack_front_nodes_tets, tets_level);</div>
<div class="line"><a id="l02086" name="l02086"></a><span class="lineno"> 2086</span>    <a class="code hl_class" href="class_range.html">Range</a> edges_to_refine; <span class="comment">// edges which going to be refined</span></div>
<div class="line"><a id="l02087" name="l02087"></a><span class="lineno"> 2087</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(crack_front_nodes_tets, 1, <span class="keyword">false</span>,</div>
<div class="line"><a id="l02088" name="l02088"></a><span class="lineno"> 2088</span>                                              edges_to_refine,</div>
<div class="line"><a id="l02089" name="l02089"></a><span class="lineno"> 2089</span>                                              moab::Interface::UNION);</div>
<div class="line"><a id="l02090" name="l02090"></a><span class="lineno"> 2090</span>    edges_to_refine = intersect(edges_to_refine, edges_level);</div>
<div class="line"><a id="l02091" name="l02091"></a><span class="lineno"> 2091</span>    <span class="keywordflow">if</span> (edges_to_refine.empty())</div>
<div class="line"><a id="l02092" name="l02092"></a><span class="lineno"> 2092</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l02093" name="l02093"></a><span class="lineno"> 2093</span> </div>
<div class="line"><a id="l02094" name="l02094"></a><span class="lineno"> 2094</span>    <span class="comment">// create vertices in middle of refined edges</span></div>
<div class="line"><a id="l02095" name="l02095"></a><span class="lineno"> 2095</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mesh_refiner_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_mesh_refinement.html#aaed88f73c43b3030907ce108217c39e7">addVerticesInTheMiddleOfEdges</a>(</div>
<div class="line"><a id="l02096" name="l02096"></a><span class="lineno"> 2096</span>        edges_to_refine, bit_ref, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>);</div>
<div class="line"><a id="l02097" name="l02097"></a><span class="lineno"> 2097</span>    <span class="comment">// refine tets</span></div>
<div class="line"><a id="l02098" name="l02098"></a><span class="lineno"> 2098</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mesh_refiner_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_mesh_refinement.html#a7f731867b68b721d54096ceced3b9947">refineTets</a>(tets_level, bit_ref, <span class="keyword">false</span>);</div>
<div class="line"><a id="l02099" name="l02099"></a><span class="lineno"> 2099</span> </div>
<div class="line"><a id="l02100" name="l02100"></a><span class="lineno"> 2100</span>    <span class="comment">// update meshsets by new entities</span></div>
<div class="line"><a id="l02101" name="l02101"></a><span class="lineno"> 2101</span>    <span class="comment">// Meshsets are updated such that: if parent is in the meshset then its</span></div>
<div class="line"><a id="l02102" name="l02102"></a><span class="lineno"> 2102</span>    <span class="comment">// chiled is in the meshset to.</span></div>
<div class="line"><a id="l02103" name="l02103"></a><span class="lineno"> 2103</span>    <span class="keywordflow">for</span> (<a class="code hl_define" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(m_field, cubit_it)) {</div>
<div class="line"><a id="l02104" name="l02104"></a><span class="lineno"> 2104</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> cubit_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><a id="l02105" name="l02105"></a><span class="lineno"> 2105</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a id="l02106" name="l02106"></a><span class="lineno"> 2106</span>          cubit_meshset, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_ref, bit_ref,</div>
<div class="line"><a id="l02107" name="l02107"></a><span class="lineno"> 2107</span>          cubit_meshset, MBMAXTYPE, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02108" name="l02108"></a><span class="lineno"> 2108</span>    }</div>
<div class="line"><a id="l02109" name="l02109"></a><span class="lineno"> 2109</span> </div>
<div class="line"><a id="l02110" name="l02110"></a><span class="lineno"> 2110</span>    <span class="comment">// update meshsets with partition mesh</span></div>
<div class="line"><a id="l02111" name="l02111"></a><span class="lineno"> 2111</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a65aee45b2a3a458fd753a730a81509bb">isPartitioned</a>) {</div>
<div class="line"><a id="l02112" name="l02112"></a><span class="lineno"> 2112</span>      ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a id="l02113" name="l02113"></a><span class="lineno"> 2113</span>      <a class="code hl_class" href="class_tag.html">Tag</a> part_tag = pcomm-&gt;part_tag();</div>
<div class="line"><a id="l02114" name="l02114"></a><span class="lineno"> 2114</span>      <a class="code hl_class" href="class_range.html">Range</a> tagged_sets;</div>
<div class="line"><a id="l02115" name="l02115"></a><span class="lineno"> 2115</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type_and_tag(</div>
<div class="line"><a id="l02116" name="l02116"></a><span class="lineno"> 2116</span>          0, MBENTITYSET, &amp;part_tag, NULL, 1, tagged_sets,</div>
<div class="line"><a id="l02117" name="l02117"></a><span class="lineno"> 2117</span>          moab::Interface::UNION);</div>
<div class="line"><a id="l02118" name="l02118"></a><span class="lineno"> 2118</span>      <span class="keywordflow">for</span> (Range::iterator mit = tagged_sets.begin(); mit != tagged_sets.end();</div>
<div class="line"><a id="l02119" name="l02119"></a><span class="lineno"> 2119</span>           mit++) {</div>
<div class="line"><a id="l02120" name="l02120"></a><span class="lineno"> 2120</span>        <span class="keywordtype">int</span> part;</div>
<div class="line"><a id="l02121" name="l02121"></a><span class="lineno"> 2121</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(part_tag, &amp;*mit, 1, &amp;part);</div>
<div class="line"><a id="l02122" name="l02122"></a><span class="lineno"> 2122</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a id="l02123" name="l02123"></a><span class="lineno"> 2123</span>            *mit, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_ref, bit_ref, *mit, MBTET,</div>
<div class="line"><a id="l02124" name="l02124"></a><span class="lineno"> 2124</span>            <span class="keyword">true</span>);</div>
<div class="line"><a id="l02125" name="l02125"></a><span class="lineno"> 2125</span>        <a class="code hl_class" href="class_range.html">Range</a> ents3d;</div>
<div class="line"><a id="l02126" name="l02126"></a><span class="lineno"> 2126</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(*mit, 3, ents3d, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02127" name="l02127"></a><span class="lineno"> 2127</span>        <span class="keywordflow">for</span> (Range::iterator eit = ents3d.begin(); eit != ents3d.end(); eit++) {</div>
<div class="line"><a id="l02128" name="l02128"></a><span class="lineno"> 2128</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a id="l02129" name="l02129"></a><span class="lineno"> 2129</span>        }</div>
<div class="line"><a id="l02130" name="l02130"></a><span class="lineno"> 2130</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; dd != 3; dd++) {</div>
<div class="line"><a id="l02131" name="l02131"></a><span class="lineno"> 2131</span>          <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line"><a id="l02132" name="l02132"></a><span class="lineno"> 2132</span>          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, dd, <span class="keyword">false</span>, ents,</div>
<div class="line"><a id="l02133" name="l02133"></a><span class="lineno"> 2133</span>                                      moab::Interface::UNION);</div>
<div class="line"><a id="l02134" name="l02134"></a><span class="lineno"> 2134</span>          <span class="keywordflow">for</span> (Range::iterator eit = ents.begin(); eit != ents.end(); eit++) {</div>
<div class="line"><a id="l02135" name="l02135"></a><span class="lineno"> 2135</span>            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a id="l02136" name="l02136"></a><span class="lineno"> 2136</span>          }</div>
<div class="line"><a id="l02137" name="l02137"></a><span class="lineno"> 2137</span>        }</div>
<div class="line"><a id="l02138" name="l02138"></a><span class="lineno"> 2138</span>      }</div>
<div class="line"><a id="l02139" name="l02139"></a><span class="lineno"> 2139</span>    }</div>
<div class="line"><a id="l02140" name="l02140"></a><span class="lineno"> 2140</span> </div>
<div class="line"><a id="l02141" name="l02141"></a><span class="lineno"> 2141</span>    <span class="comment">// shift bits, if ents in on bit level 0, and only on that bit it is deleted</span></div>
<div class="line"><a id="l02142" name="l02142"></a><span class="lineno"> 2142</span>    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> shift_mask;</div>
<div class="line"><a id="l02143" name="l02143"></a><span class="lineno"> 2143</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 19; ++ll)</div>
<div class="line"><a id="l02144" name="l02144"></a><span class="lineno"> 2144</span>      shift_mask.set(ll);</div>
<div class="line"><a id="l02145" name="l02145"></a><span class="lineno"> 2145</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(1, shift_mask);</div>
<div class="line"><a id="l02146" name="l02146"></a><span class="lineno"> 2146</span> </div>
<div class="line"><a id="l02147" name="l02147"></a><span class="lineno"> 2147</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02148" name="l02148"></a><span class="lineno"> 2148</span>      <span class="keywordflow">if</span> (m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a id="l02149" name="l02149"></a><span class="lineno"> 2149</span>        std::string name;</div>
<div class="line"><a id="l02150" name="l02150"></a><span class="lineno"> 2150</span>        name = <span class="stringliteral">&quot;out_crack_surface_level_&quot;</span> +</div>
<div class="line"><a id="l02151" name="l02151"></a><span class="lineno"> 2151</span>               boost::lexical_cast&lt;std::string&gt;(ll) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><a id="l02152" name="l02152"></a><span class="lineno"> 2152</span>        <a class="code hl_class" href="class_range.html">Range</a> crack_faces;</div>
<div class="line"><a id="l02153" name="l02153"></a><span class="lineno"> 2153</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a id="l02154" name="l02154"></a><span class="lineno"> 2154</span>                                                     crack_faces, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02155" name="l02155"></a><span class="lineno"> 2155</span>        <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line"><a id="l02156" name="l02156"></a><span class="lineno"> 2156</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a id="l02157" name="l02157"></a><span class="lineno"> 2157</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(meshset, crack_faces);</div>
<div class="line"><a id="l02158" name="l02158"></a><span class="lineno"> 2158</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a id="l02159" name="l02159"></a><span class="lineno"> 2159</span>                                             1);</div>
<div class="line"><a id="l02160" name="l02160"></a><span class="lineno"> 2160</span>        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a id="l02161" name="l02161"></a><span class="lineno"> 2161</span>      }</div>
<div class="line"><a id="l02162" name="l02162"></a><span class="lineno"> 2162</span>    }</div>
<div class="line"><a id="l02163" name="l02163"></a><span class="lineno"> 2163</span>  }</div>
<div class="line"><a id="l02164" name="l02164"></a><span class="lineno"> 2164</span> </div>
<div class="line"><a id="l02165" name="l02165"></a><span class="lineno"> 2165</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02166" name="l02166"></a><span class="lineno"> 2166</span>}</div>
</div>
<div class="line"><a id="l02167" name="l02167"></a><span class="lineno"> 2167</span> </div>
<div class="foldopen" id="foldopen02168" data-start="{" data-end="}">
<div class="line"><a id="l02168" name="l02168"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a2bc35f903e155d4912ec603711c86f24"> 2168</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a2bc35f903e155d4912ec603711c86f24">CPMeshCut::refineAndSplit</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02169" name="l02169"></a><span class="lineno"> 2169</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l02170" name="l02170"></a><span class="lineno"> 2170</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02171" name="l02171"></a><span class="lineno"> 2171</span> </div>
<div class="line"><a id="l02172" name="l02172"></a><span class="lineno"> 2172</span>  <span class="comment">// clear tags data created by previous use of prism interface</span></div>
<div class="line"><a id="l02173" name="l02173"></a><span class="lineno"> 2173</span>  <a class="code hl_class" href="class_tag.html">Tag</a> th_interface_side;</div>
<div class="line"><a id="l02174" name="l02174"></a><span class="lineno"> 2174</span>  <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>, th_interface_side);</div>
<div class="line"><a id="l02175" name="l02175"></a><span class="lineno"> 2175</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a id="l02176" name="l02176"></a><span class="lineno"> 2176</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_delete(th_interface_side);</div>
<div class="line"><a id="l02177" name="l02177"></a><span class="lineno"> 2177</span> </div>
<div class="line"><a id="l02178" name="l02178"></a><span class="lineno"> 2178</span>  <span class="keyword">auto</span> delete_mofem_meshsets = [&amp;]() {</div>
<div class="line"><a id="l02179" name="l02179"></a><span class="lineno"> 2179</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02180" name="l02180"></a><span class="lineno"> 2180</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a id="l02181" name="l02181"></a><span class="lineno"> 2181</span>        <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa73d6d4d08509b996a63604173694d8a">getSkinOfTheBodyId</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a id="l02182" name="l02182"></a><span class="lineno"> 2182</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a id="l02183" name="l02183"></a><span class="lineno"> 2183</span>        <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5d19b596dfc352e6f25afb67a6be6eeb">getCrackFrontId</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a id="l02184" name="l02184"></a><span class="lineno"> 2184</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02185" name="l02185"></a><span class="lineno"> 2185</span>  };</div>
<div class="line"><a id="l02186" name="l02186"></a><span class="lineno"> 2186</span> </div>
<div class="line"><a id="l02187" name="l02187"></a><span class="lineno"> 2187</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit0 = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a id="l02188" name="l02188"></a><span class="lineno"> 2188</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit1 = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>];</div>
<div class="line"><a id="l02189" name="l02189"></a><span class="lineno"> 2189</span> </div>
<div class="line"><a id="l02190" name="l02190"></a><span class="lineno"> 2190</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a id="l02191" name="l02191"></a><span class="lineno"> 2191</span>  <span class="comment">// find body skin</span></div>
<div class="line"><a id="l02192" name="l02192"></a><span class="lineno"> 2192</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0016012d2fdfbaa3dea1c7de67159175">findBodySkin</a>(bit0, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;out_body_skin_bit0.vtk&quot;</span>);</div>
<div class="line"><a id="l02193" name="l02193"></a><span class="lineno"> 2193</span>  <span class="comment">// find/get crack surface</span></div>
<div class="line"><a id="l02194" name="l02194"></a><span class="lineno"> 2194</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a90e33252d4b7e57d9c2a7596db8ab906">findCrack</a>(bit0, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02195" name="l02195"></a><span class="lineno"> 2195</span> </div>
<div class="line"><a id="l02196" name="l02196"></a><span class="lineno"> 2196</span>  <span class="comment">// refine at crack trip</span></div>
<div class="line"><a id="l02197" name="l02197"></a><span class="lineno"> 2197</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a47f76009627efe1034647a0582c73794">refAtCrackTip</a> &gt; 0) {</div>
<div class="line"><a id="l02198" name="l02198"></a><span class="lineno"> 2198</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#ab5e9945e34978dce73ab7556f12fff63">doCutMesh</a>) {</div>
<div class="line"><a id="l02199" name="l02199"></a><span class="lineno"> 2199</span>      SETERRQ(</div>
<div class="line"><a id="l02200" name="l02200"></a><span class="lineno"> 2200</span>          <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>,</div>
<div class="line"><a id="l02201" name="l02201"></a><span class="lineno"> 2201</span>          <span class="stringliteral">&quot;Refinement at the crack front after the crack insertion (&#39;my_ref&#39;) &quot;</span></div>
<div class="line"><a id="l02202" name="l02202"></a><span class="lineno"> 2202</span>          <span class="stringliteral">&quot;should not be used when the mesh cutting is on, use &quot;</span></div>
<div class="line"><a id="l02203" name="l02203"></a><span class="lineno"> 2203</span>          <span class="stringliteral">&quot;&#39;ref_before_cut&#39; or &#39;ref_before_trim&#39; instead&quot;</span>);</div>
<div class="line"><a id="l02204" name="l02204"></a><span class="lineno"> 2204</span>    }</div>
<div class="line"><a id="l02205" name="l02205"></a><span class="lineno"> 2205</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a399c5f3e1a6af3220b14ea3720f542cf">refineCrackTip</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02206" name="l02206"></a><span class="lineno"> 2206</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a id="l02207" name="l02207"></a><span class="lineno"> 2207</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0016012d2fdfbaa3dea1c7de67159175">findBodySkin</a>(bit0, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;out_body_skin_bit0_ref.vtk&quot;</span>);</div>
<div class="line"><a id="l02208" name="l02208"></a><span class="lineno"> 2208</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a90e33252d4b7e57d9c2a7596db8ab906">findCrack</a>(bit0, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02209" name="l02209"></a><span class="lineno"> 2209</span>  }</div>
<div class="line"><a id="l02210" name="l02210"></a><span class="lineno"> 2210</span> </div>
<div class="line"><a id="l02211" name="l02211"></a><span class="lineno"> 2211</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l02212" name="l02212"></a><span class="lineno"> 2212</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(bit0, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l02213" name="l02213"></a><span class="lineno"> 2213</span>                                          <span class="stringliteral">&quot;out_mesh_after_refine.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>,</div>
<div class="line"><a id="l02214" name="l02214"></a><span class="lineno"> 2214</span>                                          <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02215" name="l02215"></a><span class="lineno"> 2215</span> </div>
<div class="line"><a id="l02216" name="l02216"></a><span class="lineno"> 2216</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a id="l02217" name="l02217"></a><span class="lineno"> 2217</span> </div>
<div class="line"><a id="l02218" name="l02218"></a><span class="lineno"> 2218</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02219" name="l02219"></a><span class="lineno"> 2219</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_interface;</div>
<div class="line"><a id="l02220" name="l02220"></a><span class="lineno"> 2220</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a id="l02221" name="l02221"></a><span class="lineno"> 2221</span>                                       meshset_interface);</div>
<div class="line"><a id="l02222" name="l02222"></a><span class="lineno"> 2222</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(</div>
<div class="line"><a id="l02223" name="l02223"></a><span class="lineno"> 2223</span>          <span class="stringliteral">&quot;crack_surface_before_contact_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l02224" name="l02224"></a><span class="lineno"> 2224</span>          &amp;meshset_interface, 1);</div>
<div class="line"><a id="l02225" name="l02225"></a><span class="lineno"> 2225</span>    }</div>
<div class="line"><a id="l02226" name="l02226"></a><span class="lineno"> 2226</span> </div>
<div class="line"><a id="l02227" name="l02227"></a><span class="lineno"> 2227</span>    <span class="comment">// split faces to insert contact elements</span></div>
<div class="line"><a id="l02228" name="l02228"></a><span class="lineno"> 2228</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a41a144d57c8ca97574d6b5714b2be697">insertContactInterface</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02229" name="l02229"></a><span class="lineno"> 2229</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02230" name="l02230"></a><span class="lineno"> 2230</span> </div>
<div class="line"><a id="l02231" name="l02231"></a><span class="lineno"> 2231</span>      <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset_interface;</div>
<div class="line"><a id="l02232" name="l02232"></a><span class="lineno"> 2232</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a id="l02233" name="l02233"></a><span class="lineno"> 2233</span>                                       meshset_interface);</div>
<div class="line"><a id="l02234" name="l02234"></a><span class="lineno"> 2234</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(</div>
<div class="line"><a id="l02235" name="l02235"></a><span class="lineno"> 2235</span>          <span class="stringliteral">&quot;crack_surface_after_contact_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l02236" name="l02236"></a><span class="lineno"> 2236</span>          &amp;meshset_interface, 1);</div>
<div class="line"><a id="l02237" name="l02237"></a><span class="lineno"> 2237</span> </div>
<div class="line"><a id="l02238" name="l02238"></a><span class="lineno"> 2238</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(</div>
<div class="line"><a id="l02239" name="l02239"></a><span class="lineno"> 2239</span>          <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l02240" name="l02240"></a><span class="lineno"> 2240</span>          <span class="stringliteral">&quot;out_mesh_after_contact_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02241" name="l02241"></a><span class="lineno"> 2241</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(</div>
<div class="line"><a id="l02242" name="l02242"></a><span class="lineno"> 2242</span>          <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM,</div>
<div class="line"><a id="l02243" name="l02243"></a><span class="lineno"> 2243</span>          <span class="stringliteral">&quot;out_mesh_contact_prisms.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02244" name="l02244"></a><span class="lineno"> 2244</span>    }</div>
<div class="line"><a id="l02245" name="l02245"></a><span class="lineno"> 2245</span>  }</div>
<div class="line"><a id="l02246" name="l02246"></a><span class="lineno"> 2246</span> </div>
<div class="line"><a id="l02247" name="l02247"></a><span class="lineno"> 2247</span>  <span class="comment">// split faces to create crack</span></div>
<div class="line"><a id="l02248" name="l02248"></a><span class="lineno"> 2248</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad9414d2adc14b121e7f705819054458d">splitFaces</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02249" name="l02249"></a><span class="lineno"> 2249</span> </div>
<div class="line"><a id="l02250" name="l02250"></a><span class="lineno"> 2250</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a id="l02251" name="l02251"></a><span class="lineno"> 2251</span>    <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0de9d9a2e911031c8e9086441450a89d">findContactFromPrisms</a>(bit1, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02252" name="l02252"></a><span class="lineno"> 2252</span>  }</div>
<div class="line"><a id="l02253" name="l02253"></a><span class="lineno"> 2253</span> </div>
<div class="line"><a id="l02254" name="l02254"></a><span class="lineno"> 2254</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a id="l02255" name="l02255"></a><span class="lineno"> 2255</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac03fb84b9a137a9a8572682605040928">addMortarContactPrisms</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02256" name="l02256"></a><span class="lineno"> 2256</span>  }</div>
<div class="line"><a id="l02257" name="l02257"></a><span class="lineno"> 2257</span> </div>
<div class="line"><a id="l02258" name="l02258"></a><span class="lineno"> 2258</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02259" name="l02259"></a><span class="lineno"> 2259</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(bit1, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l02260" name="l02260"></a><span class="lineno"> 2260</span>                                          <span class="stringliteral">&quot;out_mesh_after_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>,</div>
<div class="line"><a id="l02261" name="l02261"></a><span class="lineno"> 2261</span>                                          <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02262" name="l02262"></a><span class="lineno"> 2262</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(bit1, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM,</div>
<div class="line"><a id="l02263" name="l02263"></a><span class="lineno"> 2263</span>                                          <span class="stringliteral">&quot;out_mesh_after_split_prisms.vtk&quot;</span>,</div>
<div class="line"><a id="l02264" name="l02264"></a><span class="lineno"> 2264</span>                                          <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02265" name="l02265"></a><span class="lineno"> 2265</span>  }</div>
<div class="line"><a id="l02266" name="l02266"></a><span class="lineno"> 2266</span> </div>
<div class="line"><a id="l02267" name="l02267"></a><span class="lineno"> 2267</span>  <span class="comment">// get information about topology</span></div>
<div class="line"><a id="l02268" name="l02268"></a><span class="lineno"> 2268</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a id="l02269" name="l02269"></a><span class="lineno"> 2269</span> </div>
<div class="line"><a id="l02270" name="l02270"></a><span class="lineno"> 2270</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5edebe082848c57745b69722a9d173bc">setFixEdgesAndCorners</a>(bit1);</div>
<div class="line"><a id="l02271" name="l02271"></a><span class="lineno"> 2271</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0016012d2fdfbaa3dea1c7de67159175">findBodySkin</a>(bit1, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;out_body_skin_bit1.vtk&quot;</span>);</div>
<div class="line"><a id="l02272" name="l02272"></a><span class="lineno"> 2272</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a014e0fb69b4ef71920cc16ba3a7a6447">findCrackFromPrisms</a>(bit1, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02273" name="l02273"></a><span class="lineno"> 2273</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad4e135789ce6279536022842795a9305">getFrontEdgesAndElements</a>(bit1, verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02274" name="l02274"></a><span class="lineno"> 2274</span> </div>
<div class="line"><a id="l02275" name="l02275"></a><span class="lineno"> 2275</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02276" name="l02276"></a><span class="lineno"> 2276</span>}</div>
</div>
<div class="line"><a id="l02277" name="l02277"></a><span class="lineno"> 2277</span> </div>
<div class="foldopen" id="foldopen02278" data-start="{" data-end="}">
<div class="line"><a id="l02278" name="l02278"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0c8f8b6d829f5bbedc3e31536eb6fce4"> 2278</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0c8f8b6d829f5bbedc3e31536eb6fce4">CPMeshCut::cutRefineAndSplit</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02279" name="l02279"></a><span class="lineno"> 2279</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l02280" name="l02280"></a><span class="lineno"> 2280</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l02281" name="l02281"></a><span class="lineno"> 2281</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>)</div>
<div class="line"><a id="l02282" name="l02282"></a><span class="lineno"> 2282</span>    <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a id="l02283" name="l02283"></a><span class="lineno"> 2283</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02284" name="l02284"></a><span class="lineno"> 2284</span> </div>
<div class="line"><a id="l02285" name="l02285"></a><span class="lineno"> 2285</span>  <span class="comment">// FIXME: If will be needed in future one can cut, and split and then put</span></div>
<div class="line"><a id="l02286" name="l02286"></a><span class="lineno"> 2286</span>  <span class="comment">// meshes on the right bit ref level.</span></div>
<div class="line"><a id="l02287" name="l02287"></a><span class="lineno"> 2287</span> </div>
<div class="line"><a id="l02288" name="l02288"></a><span class="lineno"> 2288</span>  <span class="comment">// Get entities not in database</span></div>
<div class="line"><a id="l02289" name="l02289"></a><span class="lineno"> 2289</span>  <a class="code hl_class" href="class_range.html">Range</a> all_free_ents;</div>
<div class="line"><a id="l02290" name="l02290"></a><span class="lineno"> 2290</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a1646c70292128dbf98b8dca46d7ef10e">getAllEntitiesNotInDatabase</a>(all_free_ents);</div>
<div class="line"><a id="l02291" name="l02291"></a><span class="lineno"> 2291</span> </div>
<div class="line"><a id="l02292" name="l02292"></a><span class="lineno"> 2292</span>  <span class="comment">// Cut mesh</span></div>
<div class="line"><a id="l02293" name="l02293"></a><span class="lineno"> 2293</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a id="l02294" name="l02294"></a><span class="lineno"> 2294</span>  std::size_t idx = 0;</div>
<div class="line"><a id="l02295" name="l02295"></a><span class="lineno"> 2295</span>  <span class="keywordflow">while</span> (!<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.test(idx))</div>
<div class="line"><a id="l02296" name="l02296"></a><span class="lineno"> 2296</span>    ++idx;</div>
<div class="line"><a id="l02297" name="l02297"></a><span class="lineno"> 2297</span>  <span class="keywordtype">int</span> first_bit = idx + 1;</div>
<div class="line"><a id="l02298" name="l02298"></a><span class="lineno"> 2298</span> </div>
<div class="line"><a id="l02299" name="l02299"></a><span class="lineno"> 2299</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1bbfb030bcbd86228047ec8c352128ba">cutMesh</a>(first_bit, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02300" name="l02300"></a><span class="lineno"> 2300</span> </div>
<div class="line"><a id="l02301" name="l02301"></a><span class="lineno"> 2301</span>  <span class="comment">// Squash bits</span></div>
<div class="line"><a id="l02302" name="l02302"></a><span class="lineno"> 2302</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> shift_mask;</div>
<div class="line"><a id="l02303" name="l02303"></a><span class="lineno"> 2303</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != first_bit + 1; ++ll)</div>
<div class="line"><a id="l02304" name="l02304"></a><span class="lineno"> 2304</span>    shift_mask.set(ll);</div>
<div class="line"><a id="l02305" name="l02305"></a><span class="lineno"> 2305</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(first_bit, shift_mask, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>,</div>
<div class="line"><a id="l02306" name="l02306"></a><span class="lineno"> 2306</span>                                     <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a id="l02307" name="l02307"></a><span class="lineno"> 2307</span> </div>
<div class="line"><a id="l02308" name="l02308"></a><span class="lineno"> 2308</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l02309" name="l02309"></a><span class="lineno"> 2309</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>],</div>
<div class="line"><a id="l02310" name="l02310"></a><span class="lineno"> 2310</span>                                          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l02311" name="l02311"></a><span class="lineno"> 2311</span>                                          <span class="stringliteral">&quot;out_mesh_after_cut.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02312" name="l02312"></a><span class="lineno"> 2312</span> </div>
<div class="line"><a id="l02313" name="l02313"></a><span class="lineno"> 2313</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a2bc35f903e155d4912ec603711c86f24">refineAndSplit</a>(verb, <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a id="l02314" name="l02314"></a><span class="lineno"> 2314</span> </div>
<div class="line"><a id="l02315" name="l02315"></a><span class="lineno"> 2315</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a id="l02316" name="l02316"></a><span class="lineno"> 2316</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(</div>
<div class="line"><a id="l02317" name="l02317"></a><span class="lineno"> 2317</span>        <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>], <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a id="l02318" name="l02318"></a><span class="lineno"> 2318</span>        <span class="stringliteral">&quot;out_mesh_after_split_and_refine.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a id="l02319" name="l02319"></a><span class="lineno"> 2319</span> </div>
<div class="line"><a id="l02320" name="l02320"></a><span class="lineno"> 2320</span>  <span class="comment">// Delete left obsolete entities</span></div>
<div class="line"><a id="l02321" name="l02321"></a><span class="lineno"> 2321</span> </div>
<div class="line"><a id="l02322" name="l02322"></a><span class="lineno"> 2322</span>  <span class="keyword">auto</span> get_entities_to_delete = [&amp;]() {</div>
<div class="line"><a id="l02323" name="l02323"></a><span class="lineno"> 2323</span>    <a class="code hl_class" href="class_range.html">Range</a> ents_not_in_database;</div>
<div class="line"><a id="l02324" name="l02324"></a><span class="lineno"> 2324</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_handle(0, ents_not_in_database, <span class="keyword">false</span>);</div>
<div class="line"><a id="l02325" name="l02325"></a><span class="lineno"> 2325</span>    ents_not_in_database = subtract(</div>
<div class="line"><a id="l02326" name="l02326"></a><span class="lineno"> 2326</span>        ents_not_in_database, ents_not_in_database.subset_by_type(MBENTITYSET));</div>
<div class="line"><a id="l02327" name="l02327"></a><span class="lineno"> 2327</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a87ae77f924ed23ba3ce0f0889e34e093">filterEntitiesNotInDatabase</a>(ents_not_in_database);</div>
<div class="line"><a id="l02328" name="l02328"></a><span class="lineno"> 2328</span>    <span class="keywordflow">return</span> subtract(ents_not_in_database, all_free_ents);</div>
<div class="line"><a id="l02329" name="l02329"></a><span class="lineno"> 2329</span>  };</div>
<div class="line"><a id="l02330" name="l02330"></a><span class="lineno"> 2330</span>  <a class="code hl_class" href="class_range.html">Range</a> ents_to_remove = get_entities_to_delete();</div>
<div class="line"><a id="l02331" name="l02331"></a><span class="lineno"> 2331</span> </div>
<div class="line"><a id="l02332" name="l02332"></a><span class="lineno"> 2332</span>  <span class="keyword">auto</span> remove_entities_from_meshsets = [&amp;]() {</div>
<div class="line"><a id="l02333" name="l02333"></a><span class="lineno"> 2333</span>    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02334" name="l02334"></a><span class="lineno"> 2334</span>    <span class="comment">// Remove entities from meshsets</span></div>
<div class="line"><a id="l02335" name="l02335"></a><span class="lineno"> 2335</span>    <a class="code hl_class" href="class_range.html">Range</a> meshsets;</div>
<div class="line"><a id="l02336" name="l02336"></a><span class="lineno"> 2336</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(0, MBENTITYSET, meshsets, <span class="keyword">false</span>);</div>
<div class="line"><a id="l02337" name="l02337"></a><span class="lineno"> 2337</span>    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : meshsets)</div>
<div class="line"><a id="l02338" name="l02338"></a><span class="lineno"> 2338</span>      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.remove_entities(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, ents_to_remove);</div>
<div class="line"><a id="l02339" name="l02339"></a><span class="lineno"> 2339</span>    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02340" name="l02340"></a><span class="lineno"> 2340</span>  };</div>
<div class="line"><a id="l02341" name="l02341"></a><span class="lineno"> 2341</span> </div>
<div class="line"><a id="l02342" name="l02342"></a><span class="lineno"> 2342</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_entities_from_meshsets();</div>
<div class="line"><a id="l02343" name="l02343"></a><span class="lineno"> 2343</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(ents_to_remove);</div>
<div class="line"><a id="l02344" name="l02344"></a><span class="lineno"> 2344</span> </div>
<div class="line"><a id="l02345" name="l02345"></a><span class="lineno"> 2345</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02346" name="l02346"></a><span class="lineno"> 2346</span>}</div>
</div>
<div class="line"><a id="l02347" name="l02347"></a><span class="lineno"> 2347</span> </div>
<div class="foldopen" id="foldopen02348" data-start="{" data-end="}">
<div class="line"><a id="l02348" name="l02348"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad4e135789ce6279536022842795a9305"> 2348</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad4e135789ce6279536022842795a9305">CPMeshCut::getFrontEdgesAndElements</a>(<span class="keyword">const</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"><a id="l02349" name="l02349"></a><span class="lineno"> 2349</span>                                                   <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a id="l02350" name="l02350"></a><span class="lineno"> 2350</span>                                                   <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02351" name="l02351"></a><span class="lineno"> 2351</span>  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a id="l02352" name="l02352"></a><span class="lineno"> 2352</span>  moab::Interface &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"><a id="l02353" name="l02353"></a><span class="lineno"> 2353</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02354" name="l02354"></a><span class="lineno"> 2354</span> </div>
<div class="line"><a id="l02355" name="l02355"></a><span class="lineno"> 2355</span>  <a class="code hl_class" href="class_range.html">Range</a> level_edges;</div>
<div class="line"><a id="l02356" name="l02356"></a><span class="lineno"> 2356</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02357" name="l02357"></a><span class="lineno"> 2357</span>                                                 MBEDGE, level_edges);</div>
<div class="line"><a id="l02358" name="l02358"></a><span class="lineno"> 2358</span> </div>
<div class="line"><a id="l02359" name="l02359"></a><span class="lineno"> 2359</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>.clear();</div>
<div class="line"><a id="l02360" name="l02360"></a><span class="lineno"> 2360</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>, <span class="keyword">true</span>);</div>
<div class="line"><a id="l02361" name="l02361"></a><span class="lineno"> 2361</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>.clear();</div>
<div class="line"><a id="l02362" name="l02362"></a><span class="lineno"> 2362</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>, 1, <span class="keyword">false</span>,</div>
<div class="line"><a id="l02363" name="l02363"></a><span class="lineno"> 2363</span>                              <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>, moab::Interface::UNION);</div>
<div class="line"><a id="l02364" name="l02364"></a><span class="lineno"> 2364</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a> = subtract(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>);</div>
<div class="line"><a id="l02365" name="l02365"></a><span class="lineno"> 2365</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a> = intersect(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>, level_edges);</div>
<div class="line"><a id="l02366" name="l02366"></a><span class="lineno"> 2366</span> </div>
<div class="line"><a id="l02367" name="l02367"></a><span class="lineno"> 2367</span>  <a class="code hl_class" href="class_range.html">Range</a> level_tets;</div>
<div class="line"><a id="l02368" name="l02368"></a><span class="lineno"> 2368</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02369" name="l02369"></a><span class="lineno"> 2369</span>                                                 MBTET, level_tets);</div>
<div class="line"><a id="l02370" name="l02370"></a><span class="lineno"> 2370</span> </div>
<div class="line"><a id="l02371" name="l02371"></a><span class="lineno"> 2371</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>.clear();</div>
<div class="line"><a id="l02372" name="l02372"></a><span class="lineno"> 2372</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>, 3, <span class="keyword">false</span>,</div>
<div class="line"><a id="l02373" name="l02373"></a><span class="lineno"> 2373</span>                              <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>, moab::Interface::UNION);</div>
<div class="line"><a id="l02374" name="l02374"></a><span class="lineno"> 2374</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a> = intersect(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>, level_tets);</div>
<div class="line"><a id="l02375" name="l02375"></a><span class="lineno"> 2375</span> </div>
<div class="line"><a id="l02376" name="l02376"></a><span class="lineno"> 2376</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a id="l02377" name="l02377"></a><span class="lineno"> 2377</span>    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> out_meshset;</div>
<div class="line"><a id="l02378" name="l02378"></a><span class="lineno"> 2378</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().create_meshset(MESHSET_SET, out_meshset);</div>
<div class="line"><a id="l02379" name="l02379"></a><span class="lineno"> 2379</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(out_meshset, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>);</div>
<div class="line"><a id="l02380" name="l02380"></a><span class="lineno"> 2380</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().add_entities(out_meshset, <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>);</div>
<div class="line"><a id="l02381" name="l02381"></a><span class="lineno"> 2381</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().write_file(<span class="stringliteral">&quot;crack_front_nodes.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a id="l02382" name="l02382"></a><span class="lineno"> 2382</span>                                           &amp;out_meshset, 1);</div>
<div class="line"><a id="l02383" name="l02383"></a><span class="lineno"> 2383</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().delete_entities(&amp;out_meshset, 1);</div>
<div class="line"><a id="l02384" name="l02384"></a><span class="lineno"> 2384</span>  }</div>
<div class="line"><a id="l02385" name="l02385"></a><span class="lineno"> 2385</span> </div>
<div class="line"><a id="l02386" name="l02386"></a><span class="lineno"> 2386</span>  <span class="keywordflow">if</span> (verb &gt;= <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849">VERY_VERBOSE</a>) {</div>
<div class="line"><a id="l02387" name="l02387"></a><span class="lineno"> 2387</span>    cerr &lt;&lt; <span class="stringliteral">&quot;getFrontEdgesAndElements &quot;</span>;</div>
<div class="line"><a id="l02388" name="l02388"></a><span class="lineno"> 2388</span>    cerr &lt;&lt; <span class="stringliteral">&quot;crackFront\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> &lt;&lt; endl;</div>
<div class="line"><a id="l02389" name="l02389"></a><span class="lineno"> 2389</span>    cerr &lt;&lt; <span class="stringliteral">&quot;crackFrontNodes\n&quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a> &lt;&lt; endl;</div>
<div class="line"><a id="l02390" name="l02390"></a><span class="lineno"> 2390</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l02391" name="l02391"></a><span class="lineno"> 2391</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l02392" name="l02392"></a><span class="lineno"> 2392</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a id="l02393" name="l02393"></a><span class="lineno"> 2393</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>.size() &lt;&lt; endl;</div>
<div class="line"><a id="l02394" name="l02394"></a><span class="lineno"> 2394</span>  }</div>
<div class="line"><a id="l02395" name="l02395"></a><span class="lineno"> 2395</span> </div>
<div class="line"><a id="l02396" name="l02396"></a><span class="lineno"> 2396</span>  <span class="keywordflow">if</span> (verb &gt;= <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a>) {</div>
<div class="line"><a id="l02397" name="l02397"></a><span class="lineno"> 2397</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a> &lt;&lt; endl;</div>
<div class="line"><a id="l02398" name="l02398"></a><span class="lineno"> 2398</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a> &lt;&lt; endl;</div>
<div class="line"><a id="l02399" name="l02399"></a><span class="lineno"> 2399</span>    cerr &lt;&lt; <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a> &lt;&lt; endl;</div>
<div class="line"><a id="l02400" name="l02400"></a><span class="lineno"> 2400</span>  }</div>
<div class="line"><a id="l02401" name="l02401"></a><span class="lineno"> 2401</span> </div>
<div class="line"><a id="l02402" name="l02402"></a><span class="lineno"> 2402</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02403" name="l02403"></a><span class="lineno"> 2403</span>}</div>
</div>
<div class="line"><a id="l02404" name="l02404"></a><span class="lineno"> 2404</span> </div>
<div class="foldopen" id="foldopen02405" data-start="{" data-end="}">
<div class="line"><a id="l02405" name="l02405"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a557a1b16f8c7516726e4a1e85cc8ff17"> 2405</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a557a1b16f8c7516726e4a1e85cc8ff17">CPMeshCut::setMeshOrgCoords</a>() {</div>
<div class="line"><a id="l02406" name="l02406"></a><span class="lineno"> 2406</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02407" name="l02407"></a><span class="lineno"> 2407</span> </div>
<div class="line"><a id="l02408" name="l02408"></a><span class="lineno"> 2408</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a id="l02409" name="l02409"></a><span class="lineno"> 2409</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 20; ll != <a class="code hl_define" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a>; ++ll)</div>
<div class="line"><a id="l02410" name="l02410"></a><span class="lineno"> 2410</span>    mask.set(ll);</div>
<div class="line"><a id="l02411" name="l02411"></a><span class="lineno"> 2411</span> </div>
<div class="line"><a id="l02412" name="l02412"></a><span class="lineno"> 2412</span>  <span class="comment">// Get original mesh</span></div>
<div class="line"><a id="l02413" name="l02413"></a><span class="lineno"> 2413</span>  <a class="code hl_class" href="class_range.html">Range</a> org_verts;</div>
<div class="line"><a id="l02414" name="l02414"></a><span class="lineno"> 2414</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(mask, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02415" name="l02415"></a><span class="lineno"> 2415</span>                                                 MBVERTEX, org_verts);</div>
<div class="line"><a id="l02416" name="l02416"></a><span class="lineno"> 2416</span> </div>
<div class="line"><a id="l02417" name="l02417"></a><span class="lineno"> 2417</span>  <span class="comment">// Get original positions from tag</span></div>
<div class="line"><a id="l02418" name="l02418"></a><span class="lineno"> 2418</span>  <a class="code hl_class" href="class_tag.html">Tag</a> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><a id="l02419" name="l02419"></a><span class="lineno"> 2419</span>  <a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;ORG_POSITION&quot;</span>, <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><a id="l02420" name="l02420"></a><span class="lineno"> 2420</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS) {</div>
<div class="line"><a id="l02421" name="l02421"></a><span class="lineno"> 2421</span>    <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.resize(org_verts.size() * 3);</div>
<div class="line"><a id="l02422" name="l02422"></a><span class="lineno"> 2422</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, org_verts,</div>
<div class="line"><a id="l02423" name="l02423"></a><span class="lineno"> 2423</span>                                             &amp;*<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a id="l02424" name="l02424"></a><span class="lineno"> 2424</span>    <span class="comment">// Set cords</span></div>
<div class="line"><a id="l02425" name="l02425"></a><span class="lineno"> 2425</span>    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().set_coords(org_verts, &amp;*<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a id="l02426" name="l02426"></a><span class="lineno"> 2426</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> != MB_TAG_NOT_FOUND)</div>
<div class="line"><a id="l02427" name="l02427"></a><span class="lineno"> 2427</span>    SETERRQ(<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a id="l02428" name="l02428"></a><span class="lineno"> 2428</span>            <span class="stringliteral">&quot;Can not get tag handle&quot;</span>);</div>
<div class="line"><a id="l02429" name="l02429"></a><span class="lineno"> 2429</span> </div>
<div class="line"><a id="l02430" name="l02430"></a><span class="lineno"> 2430</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02431" name="l02431"></a><span class="lineno"> 2431</span>}</div>
</div>
<div class="line"><a id="l02432" name="l02432"></a><span class="lineno"> 2432</span> </div>
<div class="foldopen" id="foldopen02433" data-start="{" data-end="}">
<div class="line"><a id="l02433" name="l02433"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a58d5922a7275bd9cc350d7678de4c909"> 2433</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a58d5922a7275bd9cc350d7678de4c909">CPMeshCut::getMeshOrgCoords</a>() {</div>
<div class="line"><a id="l02434" name="l02434"></a><span class="lineno"> 2434</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02435" name="l02435"></a><span class="lineno"> 2435</span> </div>
<div class="line"><a id="l02436" name="l02436"></a><span class="lineno"> 2436</span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a id="l02437" name="l02437"></a><span class="lineno"> 2437</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 20; ll != <a class="code hl_define" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a>; ++ll)</div>
<div class="line"><a id="l02438" name="l02438"></a><span class="lineno"> 2438</span>    mask.set(ll);</div>
<div class="line"><a id="l02439" name="l02439"></a><span class="lineno"> 2439</span> </div>
<div class="line"><a id="l02440" name="l02440"></a><span class="lineno"> 2440</span>  <span class="comment">// Get node coordinates on original mesh</span></div>
<div class="line"><a id="l02441" name="l02441"></a><span class="lineno"> 2441</span>  <a class="code hl_class" href="class_range.html">Range</a> org_verts;</div>
<div class="line"><a id="l02442" name="l02442"></a><span class="lineno"> 2442</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code hl_function" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(mask, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a id="l02443" name="l02443"></a><span class="lineno"> 2443</span>                                                 MBVERTEX, org_verts);</div>
<div class="line"><a id="l02444" name="l02444"></a><span class="lineno"> 2444</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.resize(org_verts.size() * 3);</div>
<div class="line"><a id="l02445" name="l02445"></a><span class="lineno"> 2445</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(org_verts, &amp;*<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a id="l02446" name="l02446"></a><span class="lineno"> 2446</span> </div>
<div class="line"><a id="l02447" name="l02447"></a><span class="lineno"> 2447</span>  <span class="comment">// Save positions on tag</span></div>
<div class="line"><a id="l02448" name="l02448"></a><span class="lineno"> 2448</span>  <span class="keywordtype">double</span> def_position[] = {0, 0, 0};</div>
<div class="line"><a id="l02449" name="l02449"></a><span class="lineno"> 2449</span>  <a class="code hl_class" href="class_tag.html">Tag</a> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><a id="l02450" name="l02450"></a><span class="lineno"> 2450</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;ORG_POSITION&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><a id="l02451" name="l02451"></a><span class="lineno"> 2451</span>                                             <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line"><a id="l02452" name="l02452"></a><span class="lineno"> 2452</span>                                             def_position);</div>
<div class="line"><a id="l02453" name="l02453"></a><span class="lineno"> 2453</span>  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code hl_variable" href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(<a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, org_verts,</div>
<div class="line"><a id="l02454" name="l02454"></a><span class="lineno"> 2454</span>                                           &amp;*<a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a id="l02455" name="l02455"></a><span class="lineno"> 2455</span> </div>
<div class="line"><a id="l02456" name="l02456"></a><span class="lineno"> 2456</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02457" name="l02457"></a><span class="lineno"> 2457</span>}</div>
</div>
<div class="line"><a id="l02458" name="l02458"></a><span class="lineno"> 2458</span> </div>
<div class="foldopen" id="foldopen02459" data-start="{" data-end="}">
<div class="line"><a id="l02459" name="l02459"></a><span class="lineno"><a class="line" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ede3c2430549e561eb5af09519cafa0"> 2459</a></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ede3c2430549e561eb5af09519cafa0">CPMeshCut::clearData</a>() {</div>
<div class="line"><a id="l02460" name="l02460"></a><span class="lineno"> 2460</span>  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a id="l02461" name="l02461"></a><span class="lineno"> 2461</span> </div>
<div class="line"><a id="l02462" name="l02462"></a><span class="lineno"> 2462</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>.clear();</div>
<div class="line"><a id="l02463" name="l02463"></a><span class="lineno"> 2463</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>.clear();</div>
<div class="line"><a id="l02464" name="l02464"></a><span class="lineno"> 2464</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>.clear();</div>
<div class="line"><a id="l02465" name="l02465"></a><span class="lineno"> 2465</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>.clear();</div>
<div class="line"><a id="l02466" name="l02466"></a><span class="lineno"> 2466</span>  <a class="code hl_variable" href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.clear();</div>
<div class="line"><a id="l02467" name="l02467"></a><span class="lineno"> 2467</span> </div>
<div class="line"><a id="l02468" name="l02468"></a><span class="lineno"> 2468</span>  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a id="l02469" name="l02469"></a><span class="lineno"> 2469</span>};</div>
</div>
<div class="line"><a id="l02470" name="l02470"></a><span class="lineno"> 2470</span> </div>
<div class="line"><a id="l02471" name="l02471"></a><span class="lineno"> 2471</span>} <span class="comment">// namespace FractureMechanics</span></div>
<div class="ttc" id="a_basic_finite_elements_8hpp_html"><div class="ttname"><a href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="a_c_p_mesh_cut_8hpp_html"><div class="ttname"><a href="_c_p_mesh_cut_8hpp.html">CPMeshCut.hpp</a></div></div>
<div class="ttc" id="a_complex_const_area_8hpp_html"><div class="ttname"><a href="_complex_const_area_8hpp.html">ComplexConstArea.hpp</a></div></div>
<div class="ttc" id="a_crack_front_element_8hpp_html"><div class="ttname"><a href="_crack_front_element_8hpp.html">CrackFrontElement.hpp</a></div></div>
<div class="ttc" id="a_crack_propagation_8hpp_html"><div class="ttname"><a href="_crack_propagation_8hpp.html">CrackPropagation.hpp</a></div><div class="ttdoc">Main class for crack propagation.</div></div>
<div class="ttc" id="a_griffith_force_element_8hpp_html"><div class="ttname"><a href="_griffith_force_element_8hpp.html">GriffithForceElement.hpp</a></div></div>
<div class="ttc" id="a_hooke_8hpp_html"><div class="ttname"><a href="_hooke_8hpp.html">Hooke.hpp</a></div><div class="ttdoc">Implementation of linear elastic material.</div></div>
<div class="ttc" id="a_log_manager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="a_m_w_l_s_8hpp_html"><div class="ttname"><a href="_m_w_l_s_8hpp.html">MWLS.hpp</a></div></div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="a_mortar_8hpp_html"><div class="ttname"><a href="_mortar_8hpp.html">Mortar.hpp</a></div></div>
<div class="ttc" id="a_neo_hookean_8hpp_html"><div class="ttname"><a href="_neo_hookean_8hpp.html">NeoHookean.hpp</a></div><div class="ttdoc">Implementation of Neo-Hookean elastic material.</div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_matrix_bounded_array_3_01double_00_019_01_4_html"><div class="ttname"><a href="class_matrix_bounded_array_3_01double_00_019_01_4.html">MatrixBoundedArray&lt; double, 9 &gt;</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="aclass_tag_html"><div class="ttname"><a href="class_tag.html">Tag</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849">VERY_VERBOSE</a></div><div class="ttdeci">@ VERY_VERBOSE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00223">definitions.h:223</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a></div><div class="ttdeci">@ NOISY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00224">definitions.h:224</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a></div><div class="ttdeci">@ VERBOSE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00222">definitions.h:222</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a></div><div class="ttdeci">@ MF_NOT_THROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00115">definitions.h:114</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a3b43531d53059927f420c79cf954561a"><div class="ttname"><a href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a></div><div class="ttdeci">#define BITREFLEVEL_SIZE</div><div class="ttdoc">max number of refinements</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00232">definitions.h:232</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00496">definitions.h:496</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a></div><div class="ttdeci">@ NODESET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00159">definitions.h:159</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a></div><div class="ttdeci">@ SIDESET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00160">definitions.h:160</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea2ed69dd8a1568d1e9b634b9fb37df873"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea2ed69dd8a1568d1e9b634b9fb37df873">MOFEM_NOT_FOUND</a></div><div class="ttdeci">@ MOFEM_NOT_FOUND</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00033">definitions.h:33</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a></div><div class="ttdeci">@ MOFEM_IMPOSSIBLE_CASE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00035">definitions.h:35</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a></div><div class="ttdeci">@ MOFEM_INVALID_DATA</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00036">definitions.h:36</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_gab81fea6cf1c5d738df6d2a043b1b45a8"><div class="ttname"><a href="group__mofem__access.html#gab81fea6cf1c5d738df6d2a043b1b45a8">MoFEM::CoreInterface::get_ref_ents</a></div><div class="ttdeci">virtual const RefEntity_multiIndex * get_ref_ents() const =0</div><div class="ttdoc">Get the ref ents object.</div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga1e0b681fb93ac73542a68a0cf875cef3"><div class="ttname"><a href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">MoFEM::BitRefManager::updateMeshsetByEntitiesChildren</a></div><div class="ttdeci">MoFEMErrorCode updateMeshsetByEntitiesChildren(const EntityHandle parent, const BitRefLevel &amp;parent_bit, const BitRefLevel &amp;parent_mask, const BitRefLevel &amp;child_bit, const BitRefLevel &amp;child_mask, const EntityHandle child, EntityType child_type, const bool recursive=false, int verb=0)</div><div class="ttdoc">Get child entities form meshset containing parent entities.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l01029">BitRefManager.cpp:1029</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga2d955cc69ad392f69bc93fc037866772"><div class="ttname"><a href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">MoFEM::BitRefManager::shiftRightBitRef</a></div><div class="ttdeci">MoFEMErrorCode shiftRightBitRef(const int shift, const BitRefLevel mask=BitRefLevel().set(), int verb=DEFAULT_VERBOSITY, MoFEMTypes mf=MF_ZERO) const</div><div class="ttdoc">right shift bit ref level</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00603">BitRefManager.cpp:603</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga486c46f5509f4e3e1d2f92b474ca781a"><div class="ttname"><a href="group__mofem__bit__ref.html#ga486c46f5509f4e3e1d2f92b474ca781a">MoFEM::BitRefManager::addBitRefLevel</a></div><div class="ttdeci">MoFEMErrorCode addBitRefLevel(const Range &amp;ents, const BitRefLevel &amp;bit, int verb=QUIET) const</div><div class="ttdoc">add bit ref level to ref entity</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00554">BitRefManager.cpp:554</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga57f6316b2f1061a314f40eb794d733ab"><div class="ttname"><a href="group__mofem__bit__ref.html#ga57f6316b2f1061a314f40eb794d733ab">MoFEM::BitRefManager::setBitRefLevel</a></div><div class="ttdeci">MoFEMErrorCode setBitRefLevel(const Range &amp;ents, const BitRefLevel bit, const bool only_tets=true, int verb=0, Range *adj_ents_ptr=nullptr) const</div><div class="ttdoc">add entities to database and set bit ref level</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00279">BitRefManager.cpp:279</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_gaa84c211844221f1df66c2ab032fc5b7d"><div class="ttname"><a href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">MoFEM::BitRefManager::getEntitiesByTypeAndRefLevel</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByTypeAndRefLevel(const BitRefLevel bit, const BitRefLevel mask, const EntityType type, const EntityHandle meshset, int verb=0) const</div><div class="ttdoc">add all ents from ref level given by bit to meshset</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00734">BitRefManager.cpp:734</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_gae0020f4f7cf7b27b8562f77fe5f21cab"><div class="ttname"><a href="group__mofem__bit__ref.html#gae0020f4f7cf7b27b8562f77fe5f21cab">MoFEM::BitRefManager::getEntitiesByRefLevel</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByRefLevel(const BitRefLevel bit, const BitRefLevel mask, const EntityHandle meshset, const int verb=QUIET) const</div><div class="ttdoc">add all ents from ref level given by bit to meshset</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00845">BitRefManager.cpp:845</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga037d7b63954d2ec6d367a5c959f16068"><div class="ttname"><a href="group__mofem__log__manager.html#ga037d7b63954d2ec6d367a5c959f16068">MoFEM::LogManager::setLog</a></div><div class="ttdeci">static LoggerType &amp; setLog(const std::string channel)</div><div class="ttdoc">Set ans resset chanel logger.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8cpp_source.html#l00389">LogManager.cpp:389</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga202c2d0258d78f4c0d60ecac64bf2252"><div class="ttname"><a href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a></div><div class="ttdeci">#define MOFEM_LOG_TAG(channel, tag)</div><div class="ttdoc">Tag channel.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00339">LogManager.hpp:339</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_gab5e77a98a6ecc9e134bd34fdb161f80a"><div class="ttname"><a href="group__mofem__log__manager.html#gab5e77a98a6ecc9e134bd34fdb161f80a">MoFEM::LogManager::getLog</a></div><div class="ttdeci">static LoggerType &amp; getLog(const std::string channel)</div><div class="ttdoc">Get logger by channel.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8cpp_source.html#l00395">LogManager.cpp:395</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_gafa1c3eb219cdb812ccdb6bad1a7a1454"><div class="ttname"><a href="group__mofem__log__manager.html#gafa1c3eb219cdb812ccdb6bad1a7a1454">MOFEM_LOG_FUNCTION</a></div><div class="ttdeci">#define MOFEM_LOG_FUNCTION()</div><div class="ttdoc">Set scope.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00325">LogManager.hpp:325</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga1ca1b58c9fb5abc1be1e62729577daa8"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">MoFEM::MeshsetsManager::getMeshset</a></div><div class="ttdeci">MoFEMErrorCode getMeshset(const int ms_id, const unsigned int cubit_bc_type, EntityHandle &amp;meshset) const</div><div class="ttdoc">get meshset from CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00708">MeshsetsManager.cpp:708</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga59a61820bca209651d9a1886848ebc25"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">MoFEM::MeshsetsManager::checkMeshset</a></div><div class="ttdeci">bool checkMeshset(const int ms_id, const CubitBCType cubit_bc_type) const</div><div class="ttdoc">check for CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00360">MeshsetsManager.cpp:360</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga9fbf1b71bc44b8a83c7f69f1cfba8125"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">MoFEM::MeshsetsManager::addMeshset</a></div><div class="ttdeci">MoFEMErrorCode addMeshset(const CubitBCType cubit_bc_type, const int ms_id, const std::string name=&quot;&quot;)</div><div class="ttdoc">add cubit meshset</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00385">MeshsetsManager.cpp:385</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa7fc3e87cd6f5fcd5770d87260ea8c1a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_FOR_LOOP_(MESHSET_MANAGER, IT)</div><div class="ttdoc">Iterator that loops over all the Cubit MeshSets in a moFEM field.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00034">MeshsetsManager.hpp:34</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gab0614ec3ab18ec96717149423946ced7"><div class="ttname"><a href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">MoFEM::MeshsetsManager::getEntitiesByDimension</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByDimension(const int ms_id, const unsigned int cubit_bc_type, const int dimension, Range &amp;entities, const bool recursive=true) const</div><div class="ttdoc">get entities from CUBIT/meshset of a particular entity dimension</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00669">MeshsetsManager.cpp:669</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="anamespace_fracture_mechanics_html"><div class="ttname"><a href="namespace_fracture_mechanics.html">FractureMechanics</a></div><div class="ttdef"><b>Definition</b> <a href="_analytical_fun_8hpp_source.html#l00015">AnalyticalFun.hpp:15</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a6ffd47b9e0afb9f78ad9e88ca71e65a7"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">MoFEM::Exceptions::rval</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; moab::ErrorCode &gt; rval</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00074">Exceptions.hpp:74</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a9fdd168f6643241476f1a4407a3a0f7a"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a9fdd168f6643241476f1a4407a3a0f7a">MoFEM::Types::VectorAdaptor</a></div><div class="ttdeci">VectorShallowArrayAdaptor&lt; double &gt; VectorAdaptor</div><div class="ttdef"><b>Definition</b> <a href="_types_8hpp_source.html#l00115">Types.hpp:115</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition</b> <a href="_types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a00ca24984a29be87bd99504af7f6ebee"><div class="ttname"><a href="namespace_mo_f_e_m.html#a00ca24984a29be87bd99504af7f6ebee">MoFEM::getVectorAdaptor</a></div><div class="ttdeci">auto getVectorAdaptor(T1 ptr, const size_t n)</div><div class="ttdoc">Get Vector adaptor.</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l00031">Templates.hpp:31</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a315359c2e34aac52f9fa976960b1a46d"><div class="ttname"><a href="namespace_mo_f_e_m.html#a315359c2e34aac52f9fa976960b1a46d">MoFEM::reconstructMultiIndex</a></div><div class="ttdeci">MoFEMErrorCode reconstructMultiIndex(const MI &amp;mi, MO &amp;&amp;mo=Modify_change_nothing())</div><div class="ttdoc">Template used to reconstruct multi-index.</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01853">Templates.hpp:1853</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition</b> <a href="_projection10_node_coords_on_field_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="anamespacesurface_html"><div class="ttname"><a href="namespacesurface.html">surface</a></div><div class="ttdef"><b>Definition</b> <a href="surface_8py_source.html#l00001">surface.py:1</a></div></div>
<div class="ttc" id="aprism__elements__from__surface_8cpp_html_a9eb248cd425bb908c67fa311945029cc"><div class="ttname"><a href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a></div><div class="ttdeci">static constexpr double delta</div><div class="ttdef"><b>Definition</b> <a href="prism__elements__from__surface_8cpp_source.html#l00018">prism_elements_from_surface.cpp:18</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astruct_contact_search_kd_tree_1_1_prism__tag_html"><div class="ttname"><a href="struct_contact_search_kd_tree_1_1_prism__tag.html">ContactSearchKdTree::Prism_tag</a></div><div class="ttdef"><b>Definition</b> <a href="_contact_search_kd_tree_8hpp_source.html#l00044">ContactSearchKdTree.hpp:44</a></div></div>
<div class="ttc" id="astruct_contact_search_kd_tree_html"><div class="ttname"><a href="struct_contact_search_kd_tree.html">ContactSearchKdTree</a></div><div class="ttdef"><b>Definition</b> <a href="_contact_search_kd_tree_8hpp_source.html#l00018">ContactSearchKdTree.hpp:18</a></div></div>
<div class="ttc" id="astruct_contact_search_kd_tree_html_a76b52767690dbadb0c82a9e370bfcbdf"><div class="ttname"><a href="struct_contact_search_kd_tree.html#a76b52767690dbadb0c82a9e370bfcbdf">ContactSearchKdTree::ContactCommonData_multiIndex</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; ContactCommonData &gt;, indexed_by&lt; ordered_unique&lt; tag&lt; Prism_tag &gt;, member&lt; ContactCommonData, EntityHandle, &amp;ContactCommonData::pRism &gt; &gt; &gt; &gt; ContactCommonData_multiIndex</div><div class="ttdef"><b>Definition</b> <a href="_contact_search_kd_tree_8hpp_source.html#l00051">ContactSearchKdTree.hpp:51</a></div></div>
<div class="ttc" id="astruct_contact_search_kd_tree_html_a88532ad59785dacf8a672f95b46d02b5"><div class="ttname"><a href="struct_contact_search_kd_tree.html#a88532ad59785dacf8a672f95b46d02b5">ContactSearchKdTree::contactSearchAlgorithm</a></div><div class="ttdeci">PetscErrorCode contactSearchAlgorithm(Range &amp;range_surf_master, Range &amp;range_surf_slave, boost::shared_ptr&lt; ContactCommonData_multiIndex &gt; contact_commondata_multi_index, Range &amp;range_slave_master_prisms)</div><div class="ttdef"><b>Definition</b> <a href="_contact_search_kd_tree_8hpp_source.html#l00114">ContactSearchKdTree.hpp:114</a></div></div>
<div class="ttc" id="astruct_contact_search_kd_tree_html_a8eeb01dfbd0d967160fb1c8f8f0bfe76"><div class="ttname"><a href="struct_contact_search_kd_tree.html#a8eeb01dfbd0d967160fb1c8f8f0bfe76">ContactSearchKdTree::buildTree</a></div><div class="ttdeci">MoFEMErrorCode buildTree(Range &amp;range_surf_master)</div><div class="ttdef"><b>Definition</b> <a href="_contact_search_kd_tree_8hpp_source.html#l00028">ContactSearchKdTree.hpp:28</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html">FractureMechanics::CPMeshCut</a></div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00024">CPMeshCut.hpp:24</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a001491969a5bbeea6147ce9d8ce0416b"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a001491969a5bbeea6147ce9d8ce0416b">FractureMechanics::CPMeshCut::getCrackSurfaceId</a></div><div class="ttdeci">int getCrackSurfaceId() const</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00168">CPMeshCut.hpp:168</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a0016012d2fdfbaa3dea1c7de67159175"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0016012d2fdfbaa3dea1c7de67159175">FractureMechanics::CPMeshCut::findBodySkin</a></div><div class="ttdeci">MoFEMErrorCode findBodySkin(const BitRefLevel bit, const int verb=1, const bool debug=false, std::string file_name=&quot;out_body_skin.vtk&quot;)</div><div class="ttdoc">find body skin</div><div class="ttdef"><b>Definition</b> <a href="#l01383">CPMeshCut.cpp:1383</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a014e0fb69b4ef71920cc16ba3a7a6447"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a014e0fb69b4ef71920cc16ba3a7a6447">FractureMechanics::CPMeshCut::findCrackFromPrisms</a></div><div class="ttdeci">MoFEMErrorCode findCrackFromPrisms(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get crack front</div><div class="ttdef"><b>Definition</b> <a href="#l01513">CPMeshCut.cpp:1513</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a031605821bd53219746550d0c0cc55b3"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a031605821bd53219746550d0c0cc55b3">FractureMechanics::CPMeshCut::edgesBlockSet</a></div><div class="ttdeci">int edgesBlockSet</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00179">CPMeshCut.hpp:179</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a035106e51ac3d931a68d52df374f8e84"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a035106e51ac3d931a68d52df374f8e84">FractureMechanics::CPMeshCut::query_interface</a></div><div class="ttdeci">MoFEMErrorCode query_interface(boost::typeindex::type_index type_index, MoFEM::UnknownInterface **iface) const</div><div class="ttdoc">Getting interface of core database.</div><div class="ttdef"><b>Definition</b> <a href="#l00045">CPMeshCut.cpp:45</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a077eaab9fb4261bc6634d9fc6ed310c3"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a077eaab9fb4261bc6634d9fc6ed310c3">FractureMechanics::CPMeshCut::crackedBodyBlockSetId</a></div><div class="ttdeci">int crackedBodyBlockSetId</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00182">CPMeshCut.hpp:182</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a09cc55b947e434358857d740bdd1c99d"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a09cc55b947e434358857d740bdd1c99d">FractureMechanics::CPMeshCut::edgesBlockSetFlg</a></div><div class="ttdeci">PetscBool edgesBlockSetFlg</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00178">CPMeshCut.hpp:178</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a0c8f8b6d829f5bbedc3e31536eb6fce4"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0c8f8b6d829f5bbedc3e31536eb6fce4">FractureMechanics::CPMeshCut::cutRefineAndSplit</a></div><div class="ttdeci">MoFEMErrorCode cutRefineAndSplit(const int verb=VERBOSE, bool debug=false)</div><div class="ttdoc">Refine, cut, trim, merge and ref front and split.</div><div class="ttdef"><b>Definition</b> <a href="#l02278">CPMeshCut.cpp:2278</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a0de9d9a2e911031c8e9086441450a89d"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a0de9d9a2e911031c8e9086441450a89d">FractureMechanics::CPMeshCut::findContactFromPrisms</a></div><div class="ttdeci">MoFEMErrorCode findContactFromPrisms(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get contact elements</div><div class="ttdef"><b>Definition</b> <a href="#l02000">CPMeshCut.cpp:2000</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a1bbfb030bcbd86228047ec8c352128ba"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1bbfb030bcbd86228047ec8c352128ba">FractureMechanics::CPMeshCut::cutMesh</a></div><div class="ttdeci">MoFEMErrorCode cutMesh(int &amp;first_bit, const bool debug=false)</div><div class="ttdoc">Ref, cut and trim, merge and do TetGen, if option is on.</div><div class="ttdef"><b>Definition</b> <a href="#l01204">CPMeshCut.cpp:1204</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a1e38d7c612661e0476cd6142c5e3a333"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1e38d7c612661e0476cd6142c5e3a333">FractureMechanics::CPMeshCut::removePathologicalFrontTris</a></div><div class="ttdeci">PetscBool removePathologicalFrontTris</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00202">CPMeshCut.hpp:202</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a1f749459397b97eed48150fa01167a2b"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a1f749459397b97eed48150fa01167a2b">FractureMechanics::CPMeshCut::copySurface</a></div><div class="ttdeci">MoFEMErrorCode copySurface(const std::string save_mesh=&quot;&quot;)</div><div class="ttdef"><b>Definition</b> <a href="#l00322">CPMeshCut.cpp:322</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a2bc35f903e155d4912ec603711c86f24"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a2bc35f903e155d4912ec603711c86f24">FractureMechanics::CPMeshCut::refineAndSplit</a></div><div class="ttdeci">MoFEMErrorCode refineAndSplit(const int verb=1, const bool debug=false)</div><div class="ttdef"><b>Definition</b> <a href="#l02168">CPMeshCut.cpp:2168</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a399c5f3e1a6af3220b14ea3720f542cf"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a399c5f3e1a6af3220b14ea3720f542cf">FractureMechanics::CPMeshCut::refineCrackTip</a></div><div class="ttdeci">MoFEMErrorCode refineCrackTip(const int front_id, const int verb=1, const bool debug=false)</div><div class="ttdoc">refine elements at crack tip</div><div class="ttdef"><b>Definition</b> <a href="#l02044">CPMeshCut.cpp:2044</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a41a144d57c8ca97574d6b5714b2be697"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a41a144d57c8ca97574d6b5714b2be697">FractureMechanics::CPMeshCut::insertContactInterface</a></div><div class="ttdeci">MoFEMErrorCode insertContactInterface(const int verb=1, const bool debug=false)</div><div class="ttdoc">insert contact interface</div><div class="ttdef"><b>Definition</b> <a href="#l01873">CPMeshCut.cpp:1873</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a4649af251914e6e03223ccb8a01827d2"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a4649af251914e6e03223ccb8a01827d2">FractureMechanics::CPMeshCut::contactPrismsBlockSetId</a></div><div class="ttdeci">int contactPrismsBlockSetId</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00183">CPMeshCut.hpp:183</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a557a1b16f8c7516726e4a1e85cc8ff17"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a557a1b16f8c7516726e4a1e85cc8ff17">FractureMechanics::CPMeshCut::setMeshOrgCoords</a></div><div class="ttdeci">MoFEMErrorCode setMeshOrgCoords()</div><div class="ttdef"><b>Definition</b> <a href="#l02405">CPMeshCut.cpp:2405</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a5637028ffe9c96152a02c4865244d379"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5637028ffe9c96152a02c4865244d379">FractureMechanics::CPMeshCut::cuttingSurfaceSidesetId</a></div><div class="ttdeci">int cuttingSurfaceSidesetId</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00205">CPMeshCut.hpp:205</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a56c4f6d3f19a74f63cf63926ecd3e24a"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">FractureMechanics::CPMeshCut::getInterfacesPtr</a></div><div class="ttdeci">MoFEMErrorCode getInterfacesPtr()</div><div class="ttdef"><b>Definition</b> <a href="#l00077">CPMeshCut.cpp:77</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a58d5922a7275bd9cc350d7678de4c909"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a58d5922a7275bd9cc350d7678de4c909">FractureMechanics::CPMeshCut::getMeshOrgCoords</a></div><div class="ttdeci">MoFEMErrorCode getMeshOrgCoords()</div><div class="ttdef"><b>Definition</b> <a href="#l02433">CPMeshCut.cpp:2433</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a5d19b596dfc352e6f25afb67a6be6eeb"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5d19b596dfc352e6f25afb67a6be6eeb">FractureMechanics::CPMeshCut::getCrackFrontId</a></div><div class="ttdeci">int getCrackFrontId() const</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00169">CPMeshCut.hpp:169</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a5d2fc244f49e0b52a81e52b9b9bb32ee"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5d2fc244f49e0b52a81e52b9b9bb32ee">FractureMechanics::CPMeshCut::rebuildCrackSurface</a></div><div class="ttdeci">MoFEMErrorCode rebuildCrackSurface(const double factor, const std::string save_mesh=&quot;&quot;, const int verb=QUIET, bool debug=false)</div><div class="ttdef"><b>Definition</b> <a href="#l00344">CPMeshCut.cpp:344</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a5edebe082848c57745b69722a9d173bc"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a5edebe082848c57745b69722a9d173bc">FractureMechanics::CPMeshCut::setFixEdgesAndCorners</a></div><div class="ttdeci">MoFEMErrorCode setFixEdgesAndCorners(const BitRefLevel bit)</div><div class="ttdef"><b>Definition</b> <a href="#l01173">CPMeshCut.cpp:1173</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a6014f2074d9b8ec7320e7a6809855ab4"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6014f2074d9b8ec7320e7a6809855ab4">FractureMechanics::CPMeshCut::fixedEdges</a></div><div class="ttdeci">Range fixedEdges</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00189">CPMeshCut.hpp:189</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a60328079c70ac649884b270b60a2187c"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60328079c70ac649884b270b60a2187c">FractureMechanics::CPMeshCut::crackFrontId</a></div><div class="ttdeci">int crackFrontId</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00208">CPMeshCut.hpp:208</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a60da5d0a79906a1ee01dcc46862d8de6"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a60da5d0a79906a1ee01dcc46862d8de6">FractureMechanics::CPMeshCut::CPMeshCut</a></div><div class="ttdeci">CPMeshCut(CrackPropagation &amp;cp)</div><div class="ttdef"><b>Definition</b> <a href="#l00051">CPMeshCut.cpp:51</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a6ceba1bae8209220e1d2381ca2f2895e"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ceba1bae8209220e1d2381ca2f2895e">FractureMechanics::CPMeshCut::meshsetMngPtr</a></div><div class="ttdeci">MeshsetsManager * meshsetMngPtr</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00187">CPMeshCut.hpp:187</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a6ede3c2430549e561eb5af09519cafa0"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a6ede3c2430549e561eb5af09519cafa0">FractureMechanics::CPMeshCut::clearData</a></div><div class="ttdeci">MoFEMErrorCode clearData()</div><div class="ttdef"><b>Definition</b> <a href="#l02459">CPMeshCut.cpp:2459</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a702b24eb98806e8da55b7094d1fca832"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a702b24eb98806e8da55b7094d1fca832">FractureMechanics::CPMeshCut::fRont</a></div><div class="ttdeci">Range fRont</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00191">CPMeshCut.hpp:191</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a703d0a4dc13004e67d384af219007aaf"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a703d0a4dc13004e67d384af219007aaf">FractureMechanics::CPMeshCut::vertexNodeSet</a></div><div class="ttdeci">int vertexNodeSet</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00181">CPMeshCut.hpp:181</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a71d0f1c883305b8e5376c4406342f57f"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a71d0f1c883305b8e5376c4406342f57f">FractureMechanics::CPMeshCut::debugCut</a></div><div class="ttdeci">PetscBool debugCut</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00201">CPMeshCut.hpp:201</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a785e26f896311a92e090947a57a965f5"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a785e26f896311a92e090947a57a965f5">FractureMechanics::CPMeshCut::nbRefBeforTrim</a></div><div class="ttdeci">int nbRefBeforTrim</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00199">CPMeshCut.hpp:199</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a8abf9b06d3a7bc6de647451bc0822d51"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a8abf9b06d3a7bc6de647451bc0822d51">FractureMechanics::CPMeshCut::bitRefPtr</a></div><div class="ttdeci">BitRefManager * bitRefPtr</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00186">CPMeshCut.hpp:186</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a90e33252d4b7e57d9c2a7596db8ab906"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a90e33252d4b7e57d9c2a7596db8ab906">FractureMechanics::CPMeshCut::findCrack</a></div><div class="ttdeci">MoFEMErrorCode findCrack(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get crack front</div><div class="ttdef"><b>Definition</b> <a href="#l01447">CPMeshCut.cpp:1447</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a93023984d8c5a456c1e70090fda992c9"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a93023984d8c5a456c1e70090fda992c9">FractureMechanics::CPMeshCut::setCutSurfaceFromFile</a></div><div class="ttdeci">MoFEMErrorCode setCutSurfaceFromFile()</div><div class="ttdoc">Set the cut surface from file.</div><div class="ttdef"><b>Definition</b> <a href="#l00301">CPMeshCut.cpp:301</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_a9d28e04e4051a19811351a0d38f012a0"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#a9d28e04e4051a19811351a0d38f012a0">FractureMechanics::CPMeshCut::sHift</a></div><div class="ttdeci">double sHift[3]</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00204">CPMeshCut.hpp:204</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aa00fad9f771a0e8338dcaec2e29e724f"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa00fad9f771a0e8338dcaec2e29e724f">FractureMechanics::CPMeshCut::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div><div class="ttdoc">Get options from command line.</div><div class="ttdef"><b>Definition</b> <a href="#l00085">CPMeshCut.cpp:85</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aa4258ec6b03d917fdbb22c404a138dde"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa4258ec6b03d917fdbb22c404a138dde">FractureMechanics::CPMeshCut::cP</a></div><div class="ttdeci">CrackPropagation &amp; cP</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00035">CPMeshCut.hpp:35</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aa73d6d4d08509b996a63604173694d8a"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa73d6d4d08509b996a63604173694d8a">FractureMechanics::CPMeshCut::getSkinOfTheBodyId</a></div><div class="ttdeci">int getSkinOfTheBodyId() const</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00167">CPMeshCut.hpp:167</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aa928c18e5413b3b03461c589f076833c"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aa928c18e5413b3b03461c589f076833c">FractureMechanics::CPMeshCut::tolCut</a></div><div class="ttdeci">double tolCut</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00195">CPMeshCut.hpp:195</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aac80b6de09e6f065a25a8b2a8f30f9bd"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aac80b6de09e6f065a25a8b2a8f30f9bd">FractureMechanics::CPMeshCut::refineMesh</a></div><div class="ttdeci">MoFEMErrorCode refineMesh(const Range *vol, const bool make_front, const int verb=QUIET, const bool debug=false)</div><div class="ttdoc">Refine mesh close to crack surface and crack front.</div><div class="ttdef"><b>Definition</b> <a href="#l00218">CPMeshCut.cpp:218</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aae4a494e6840ae724fbe9476aa8537e0"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aae4a494e6840ae724fbe9476aa8537e0">FractureMechanics::CPMeshCut::originalCoords</a></div><div class="ttdeci">std::vector&lt; double &gt; originalCoords</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00210">CPMeshCut.hpp:210</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ab0c50ac037fc28c233cde4facd580d52"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab0c50ac037fc28c233cde4facd580d52">FractureMechanics::CPMeshCut::tolTrimClose</a></div><div class="ttdeci">double tolTrimClose</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00197">CPMeshCut.hpp:197</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ab5697439e436dae4f87c36567f05107a"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ab5697439e436dae4f87c36567f05107a">FractureMechanics::CPMeshCut::cutSurfMeshName</a></div><div class="ttdeci">std::string cutSurfMeshName</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00211">CPMeshCut.hpp:211</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_abc0e9a6b267f4059a2ba4c8eb41a2db8"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">FractureMechanics::CPMeshCut::fractionLevel</a></div><div class="ttdeci">int fractionLevel</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00194">CPMeshCut.hpp:194</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ac03fb84b9a137a9a8572682605040928"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac03fb84b9a137a9a8572682605040928">FractureMechanics::CPMeshCut::addMortarContactPrisms</a></div><div class="ttdeci">MoFEMErrorCode addMortarContactPrisms(const int verb=1, const bool debug=false)</div><div class="ttdoc">insert contact interface</div><div class="ttdef"><b>Definition</b> <a href="#l01749">CPMeshCut.cpp:1749</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ac675bad4a5faadf2211e0742feb1a02f"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ac675bad4a5faadf2211e0742feb1a02f">FractureMechanics::CPMeshCut::tolCutClose</a></div><div class="ttdeci">double tolCutClose</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00196">CPMeshCut.hpp:196</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_acc83f38b27d6f471473ad4f7abdeb471"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#acc83f38b27d6f471473ad4f7abdeb471">FractureMechanics::CPMeshCut::nbRefBeforCut</a></div><div class="ttdeci">int nbRefBeforCut</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00198">CPMeshCut.hpp:198</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ad4e135789ce6279536022842795a9305"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad4e135789ce6279536022842795a9305">FractureMechanics::CPMeshCut::getFrontEdgesAndElements</a></div><div class="ttdeci">MoFEMErrorCode getFrontEdgesAndElements(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get crack front edges and finite elements</div><div class="ttdef"><b>Definition</b> <a href="#l02348">CPMeshCut.cpp:2348</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ad5c8916b0ba5234628e7681985590014"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad5c8916b0ba5234628e7681985590014">FractureMechanics::CPMeshCut::skinOfTheBodyId</a></div><div class="ttdeci">int skinOfTheBodyId</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00206">CPMeshCut.hpp:206</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ad6905b29523af39338c36a72819105aa"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad6905b29523af39338c36a72819105aa">FractureMechanics::CPMeshCut::sUrface</a></div><div class="ttdeci">Range sUrface</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00192">CPMeshCut.hpp:192</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ad9414d2adc14b121e7f705819054458d"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ad9414d2adc14b121e7f705819054458d">FractureMechanics::CPMeshCut::splitFaces</a></div><div class="ttdeci">MoFEMErrorCode splitFaces(const int verb=1, const bool debug=false)</div><div class="ttdoc">split crack faces</div><div class="ttdef"><b>Definition</b> <a href="#l01622">CPMeshCut.cpp:1622</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_adcfbe67054ee9bccd0972e7828760c3f"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#adcfbe67054ee9bccd0972e7828760c3f">FractureMechanics::CPMeshCut::vertexBlockSet</a></div><div class="ttdeci">int vertexBlockSet</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00180">CPMeshCut.hpp:180</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ae0315c5240da22b778d5dbed90e6d01a"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae0315c5240da22b778d5dbed90e6d01a">FractureMechanics::CPMeshCut::setVolume</a></div><div class="ttdeci">MoFEMErrorCode setVolume(const BitRefLevel &amp;bit)</div><div class="ttdoc">Set cutting volume from bit ref level.</div><div class="ttdef"><b>Definition</b> <a href="#l00209">CPMeshCut.cpp:209</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_ae3e244a0c2d2cfb8989d1e41cddae404"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#ae3e244a0c2d2cfb8989d1e41cddae404">FractureMechanics::CPMeshCut::cutMeshPtr</a></div><div class="ttdeci">CutMeshInterface * cutMeshPtr</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00185">CPMeshCut.hpp:185</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_aec25a0b55a958cabc641d2ea1b9cda96"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#aec25a0b55a958cabc641d2ea1b9cda96">FractureMechanics::CPMeshCut::crackSurfaceId</a></div><div class="ttdeci">int crackSurfaceId</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00207">CPMeshCut.hpp:207</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_c_p_mesh_cut_html_afec7637243fb9ff0c5ccb0c7d91d155c"><div class="ttname"><a href="struct_fracture_mechanics_1_1_c_p_mesh_cut.html#afec7637243fb9ff0c5ccb0c7d91d155c">FractureMechanics::CPMeshCut::cornerNodes</a></div><div class="ttdeci">Range cornerNodes</div><div class="ttdef"><b>Definition</b> <a href="_c_p_mesh_cut_8hpp_source.html#l00190">CPMeshCut.hpp:190</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html">FractureMechanics::CrackPropagation</a></div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00077">CrackPropagation.hpp:77</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a06c3eddabfef8d0db78348fb8605842e"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a06c3eddabfef8d0db78348fb8605842e">FractureMechanics::CrackPropagation::startStep</a></div><div class="ttdeci">int startStep</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00168">CrackPropagation.hpp:168</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a227cd11a1687f2a979a16e5747104990"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a227cd11a1687f2a979a16e5747104990">FractureMechanics::CrackPropagation::mapBitLevel</a></div><div class="ttdeci">std::map&lt; std::string, BitRefLevel &gt; mapBitLevel</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00180">CrackPropagation.hpp:180</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a2496119aca48db18ce9f7b07361b6918"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a2496119aca48db18ce9f7b07361b6918">FractureMechanics::CrackPropagation::mortarContactMasterFaces</a></div><div class="ttdeci">Range mortarContactMasterFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01246">CrackPropagation.hpp:1246</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a26c1a33e8640aaa1467b6b854d0813e3"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a26c1a33e8640aaa1467b6b854d0813e3">FractureMechanics::CrackPropagation::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00106">CrackPropagation.hpp:106</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a2c41e0bae191cf557046c75f7f69fc29"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a2c41e0bae191cf557046c75f7f69fc29">FractureMechanics::CrackPropagation::mortarContactSlaveFaces</a></div><div class="ttdeci">Range mortarContactSlaveFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01247">CrackPropagation.hpp:1247</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a2d0efd2c622ed086c6a111f2f887c97a"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a2d0efd2c622ed086c6a111f2f887c97a">FractureMechanics::CrackPropagation::crackFrontNodesEdges</a></div><div class="ttdeci">Range crackFrontNodesEdges</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01165">CrackPropagation.hpp:1165</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a368e8d4d0b459f4e8397f63023ccb9df"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a368e8d4d0b459f4e8397f63023ccb9df">FractureMechanics::CrackPropagation::crackFrontElements</a></div><div class="ttdeci">Range crackFrontElements</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01167">CrackPropagation.hpp:1167</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a47f76009627efe1034647a0582c73794"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a47f76009627efe1034647a0582c73794">FractureMechanics::CrackPropagation::refAtCrackTip</a></div><div class="ttdeci">int refAtCrackTip</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00120">CrackPropagation.hpp:120</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a50d250b3d989ea7abcba684e97cbd55b"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a50d250b3d989ea7abcba684e97cbd55b">FractureMechanics::CrackPropagation::contactMeshsetFaces</a></div><div class="ttdeci">Range contactMeshsetFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01239">CrackPropagation.hpp:1239</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a5f7f7f5c9c615dffd79e5fd0f207ddf3"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">FractureMechanics::CrackPropagation::mortarContactElements</a></div><div class="ttdeci">Range mortarContactElements</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01245">CrackPropagation.hpp:1245</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a65aee45b2a3a458fd753a730a81509bb"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a65aee45b2a3a458fd753a730a81509bb">FractureMechanics::CrackPropagation::isPartitioned</a></div><div class="ttdeci">PetscBool isPartitioned</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00118">CrackPropagation.hpp:118</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a6ab2e568fe41e5c93bc6897a3b1c7928"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">FractureMechanics::CrackPropagation::otherSideCrackFaces</a></div><div class="ttdeci">Range otherSideCrackFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01162">CrackPropagation.hpp:1162</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a6b500d8c0d533494caf9b972bc3734bf"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a6b500d8c0d533494caf9b972bc3734bf">FractureMechanics::CrackPropagation::oneSideCrackFaces</a></div><div class="ttdeci">Range oneSideCrackFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01161">CrackPropagation.hpp:1161</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a6f5533e767c5bbc98475098a32ae331d"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a6f5533e767c5bbc98475098a32ae331d">FractureMechanics::CrackPropagation::contactBothSidesMasterFaces</a></div><div class="ttdeci">Range contactBothSidesMasterFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01251">CrackPropagation.hpp:1251</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a899008482c9bcbfdd18d65af79204765"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a899008482c9bcbfdd18d65af79204765">FractureMechanics::CrackPropagation::constrainedInterface</a></div><div class="ttdeci">Range constrainedInterface</div><div class="ttdoc">Range of faces on the constrained interface.</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01301">CrackPropagation.hpp:1301</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_a92c1aa239a4f20103ba309452c530f74"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#a92c1aa239a4f20103ba309452c530f74">FractureMechanics::CrackPropagation::bodySkin</a></div><div class="ttdeci">Range bodySkin</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01159">CrackPropagation.hpp:1159</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_aa4f64c0160ed1545739d6abaca7d0d0e"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">FractureMechanics::CrackPropagation::contactMasterFaces</a></div><div class="ttdeci">Range contactMasterFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01242">CrackPropagation.hpp:1242</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_ab5e9945e34978dce73ab7556f12fff63"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#ab5e9945e34978dce73ab7556f12fff63">FractureMechanics::CrackPropagation::doCutMesh</a></div><div class="ttdeci">PetscBool doCutMesh</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01327">CrackPropagation.hpp:1327</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_ab6024a39e3da574d0222508ec9098be3"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#ab6024a39e3da574d0222508ec9098be3">FractureMechanics::CrackPropagation::contactSlaveFaces</a></div><div class="ttdeci">Range contactSlaveFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01243">CrackPropagation.hpp:1243</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_ab97641158e60e745a8c5f53d0c4b4376"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#ab97641158e60e745a8c5f53d0c4b4376">FractureMechanics::CrackPropagation::crackFaces</a></div><div class="ttdeci">Range crackFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01160">CrackPropagation.hpp:1160</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_ad82f7651bfa9bdd97923bafe67507970"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#ad82f7651bfa9bdd97923bafe67507970">FractureMechanics::CrackPropagation::contactBothSidesSlaveFaces</a></div><div class="ttdeci">Range contactBothSidesSlaveFaces</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01252">CrackPropagation.hpp:1252</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_ada5dc07850715aa99eeec5ccbe219b22"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#ada5dc07850715aa99eeec5ccbe219b22">FractureMechanics::CrackPropagation::contactSearchMultiIndexPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; ContactSearchKdTree::ContactCommonData_multiIndex &gt; contactSearchMultiIndexPtr</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01250">CrackPropagation.hpp:1250</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_aebebb7a3a5d13b03cdef07c3d9528d47"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">FractureMechanics::CrackPropagation::contactElements</a></div><div class="ttdeci">Range contactElements</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01241">CrackPropagation.hpp:1241</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_aeead6e0c0f5b67f3aee1062f4668248e"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#aeead6e0c0f5b67f3aee1062f4668248e">FractureMechanics::CrackPropagation::otherSideConstrains</a></div><div class="ttdeci">PetscBool otherSideConstrains</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l00123">CrackPropagation.hpp:123</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_af24921bfa7f0d8a39f9889bd868a5b75"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#af24921bfa7f0d8a39f9889bd868a5b75">FractureMechanics::CrackPropagation::crackFront</a></div><div class="ttdeci">Range crackFront</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01163">CrackPropagation.hpp:1163</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_af340f907630e7bea7327c538dde8fc7c"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#af340f907630e7bea7327c538dde8fc7c">FractureMechanics::CrackPropagation::ignoreContact</a></div><div class="ttdeci">PetscBool ignoreContact</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01233">CrackPropagation.hpp:1233</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_crack_propagation_html_af6b25533cc1fdfb87bc95f4f23db8378"><div class="ttname"><a href="struct_fracture_mechanics_1_1_crack_propagation.html#af6b25533cc1fdfb87bc95f4f23db8378">FractureMechanics::CrackPropagation::crackFrontNodes</a></div><div class="ttdeci">Range crackFrontNodes</div><div class="ttdef"><b>Definition</b> <a href="_crack_propagation_8hpp_source.html#l01164">CrackPropagation.hpp:1164</a></div></div>
<div class="ttc" id="astruct_fracture_mechanics_1_1_griffith_force_element_1_1_save_griffith_force_on_tags_html"><div class="ttname"><a href="struct_fracture_mechanics_1_1_griffith_force_element_1_1_save_griffith_force_on_tags.html">FractureMechanics::GriffithForceElement::SaveGriffithForceOnTags</a></div><div class="ttdef"><b>Definition</b> <a href="_griffith_force_element_8hpp_source.html#l00532">GriffithForceElement.hpp:532</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html_a1646c70292128dbf98b8dca46d7ef10e"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a1646c70292128dbf98b8dca46d7ef10e">MoFEM::BitRefManager::getAllEntitiesNotInDatabase</a></div><div class="ttdeci">MoFEMErrorCode getAllEntitiesNotInDatabase(Range &amp;ents) const</div><div class="ttdoc">Get all entities not in database.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00898">BitRefManager.cpp:898</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html_a5d2eaccfec5512b7e5ef17fbe1e987b5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">MoFEM::BitRefManager::writeBitLevelByType</a></div><div class="ttdeci">MoFEMErrorCode writeBitLevelByType(const BitRefLevel bit, const BitRefLevel mask, const EntityType type, const char *file_name, const char *file_type, const char *options, const bool check_for_empty=true) const</div><div class="ttdoc">Write bit ref level to file.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00682">BitRefManager.cpp:682</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html_a788c9bc05dc1c1e2967a3764da80e1c1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a788c9bc05dc1c1e2967a3764da80e1c1">MoFEM::BitRefManager::filterEntitiesByRefLevel</a></div><div class="ttdeci">MoFEMErrorCode filterEntitiesByRefLevel(const BitRefLevel bit, const BitRefLevel mask, Range &amp;ents, int verb=QUIET) const</div><div class="ttdoc">filter entities by bit ref level</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00746">BitRefManager.cpp:746</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html_a87ae77f924ed23ba3ce0f0889e34e093"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html#a87ae77f924ed23ba3ce0f0889e34e093">MoFEM::BitRefManager::filterEntitiesNotInDatabase</a></div><div class="ttdeci">MoFEMErrorCode filterEntitiesNotInDatabase(Range &amp;ents) const</div><div class="ttdoc">Get entities not in database.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00908">BitRefManager.cpp:908</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html_aa269940e9fc185fb230e2b34f62641d8"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html#aa269940e9fc185fb230e2b34f62641d8">MoFEM::BitRefManager::writeEntitiesAllBitLevelsByType</a></div><div class="ttdeci">MoFEMErrorCode writeEntitiesAllBitLevelsByType(const BitRefLevel mask, const EntityType type, const char *file_name, const char *file_type, const char *options)</div><div class="ttdoc">Write all entities by bit levels and type.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00722">BitRefManager.cpp:722</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a42896dd46513db84c3a4c8e49af197e6"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a42896dd46513db84c3a4c8e49af197e6">MoFEM::CoreInterface::delete_ents_by_bit_ref</a></div><div class="ttdeci">virtual MoFEMErrorCode delete_ents_by_bit_ref(const BitRefLevel bit, const BitRefLevel mask, const bool remove_parent=false, int verb=DEFAULT_VERBOSITY, MoFEMTypes mf=MF_ZERO)=0</div><div class="ttdoc">delete entities form mofem and moab database</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a9b2bc8c1b980f49d31a0b5f7fbe756f5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a08b8bbab5b73482ebe67655c8211e77b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a08b8bbab5b73482ebe67655c8211e77b">MoFEM::CutMeshInterface::copySurface</a></div><div class="ttdeci">MoFEMErrorCode copySurface(const Range surface, Tag th=NULL, double *shift=NULL, double *origin=NULL, double *transform=NULL, const std::string save_mesh=&quot;&quot;)</div><div class="ttdoc">copy surface entities</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00048">CutMeshInterface.cpp:48</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a0c7c582d842a5540d10cc8d84c0c3486"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a0c7c582d842a5540d10cc8d84c0c3486">MoFEM::CutMeshInterface::setFront</a></div><div class="ttdeci">MoFEMErrorCode setFront(const Range surface)</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00036">CutMeshInterface.cpp:36</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a14b57638017e2cde6ccc6f6e51118847"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a14b57638017e2cde6ccc6f6e51118847">MoFEM::CutMeshInterface::getFront</a></div><div class="ttdeci">const Range &amp; getFront() const</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8hpp_source.html#l00467">CutMeshInterface.hpp:467</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a452afd78f72fd0d9bde8985f5417d47d"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a452afd78f72fd0d9bde8985f5417d47d">MoFEM::CutMeshInterface::getMergedSurfaces</a></div><div class="ttdeci">const Range &amp; getMergedSurfaces() const</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8hpp_source.html#l00483">CutMeshInterface.hpp:483</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a5691afdb9be3879de243aeea26c934c9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a5691afdb9be3879de243aeea26c934c9">MoFEM::CutMeshInterface::setSurface</a></div><div class="ttdeci">MoFEMErrorCode setSurface(const Range surface)</div><div class="ttdoc">set surface entities</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00042">CutMeshInterface.cpp:42</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_a67d0cdac80f09af5b4d821c671600ae9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#a67d0cdac80f09af5b4d821c671600ae9">MoFEM::CutMeshInterface::buildTree</a></div><div class="ttdeci">MoFEMErrorCode buildTree()</div><div class="ttdoc">build tree</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00215">CutMeshInterface.cpp:215</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aa1bbbb1d723e99d6503ffbb8f4caccfc"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aa1bbbb1d723e99d6503ffbb8f4caccfc">MoFEM::CutMeshInterface::getSurface</a></div><div class="ttdeci">const Range &amp; getSurface() const</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8hpp_source.html#l00466">CutMeshInterface.hpp:466</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aacc6ac8832948e067b7b7dadf50c53d1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aacc6ac8832948e067b7b7dadf50c53d1">MoFEM::CutMeshInterface::removePathologicalFrontTris</a></div><div class="ttdeci">MoFEMErrorCode removePathologicalFrontTris(const BitRefLevel split_bit, Range &amp;ents)</div><div class="ttdoc">Remove pathological elements on surface internal front.</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l02235">CutMeshInterface.cpp:2235</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aad2bf7c3c4320b94832923df44d30e45"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aad2bf7c3c4320b94832923df44d30e45">MoFEM::CutMeshInterface::setConstrainSurface</a></div><div class="ttdeci">MoFEMErrorCode setConstrainSurface(const Range surf)</div><div class="ttdoc">Set the constrain surface object.</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00114">CutMeshInterface.cpp:114</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ac49c841036ab310c3ade79eff45ddc1f"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ac49c841036ab310c3ade79eff45ddc1f">MoFEM::CutMeshInterface::setVolume</a></div><div class="ttdeci">MoFEMErrorCode setVolume(const Range volume)</div><div class="ttdoc">set volume entities</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00108">CutMeshInterface.cpp:108</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ad1ef5dac44a93d2934fabd08e35c72a9"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad1ef5dac44a93d2934fabd08e35c72a9">MoFEM::CutMeshInterface::cutTrimAndMerge</a></div><div class="ttdeci">MoFEMErrorCode cutTrimAndMerge(int &amp;first_bit, const int fraction_level, Tag th, const double tol_geometry, const double tol_cut_close, const double tol_trim_close, Range &amp;fixed_edges, Range &amp;corner_nodes, const bool update_meshsets=false, const bool debug=false)</div><div class="ttdoc">Cut, trim and merge.</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00379">CutMeshInterface.cpp:379</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ad76d17c62d4f9337953222d2092697ab"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ad76d17c62d4f9337953222d2092697ab">MoFEM::CutMeshInterface::makeFront</a></div><div class="ttdeci">MoFEMErrorCode makeFront(const bool debug=false)</div><div class="ttdoc">Create front from the surface.</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00450">CutMeshInterface.cpp:450</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_ae6cdd41a72a83c1e08ff57742b85da95"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#ae6cdd41a72a83c1e08ff57742b85da95">MoFEM::CutMeshInterface::refineMesh</a></div><div class="ttdeci">MoFEMErrorCode refineMesh(const int init_bit_level, const int surf_levels, const int front_levels, Range *fixed_edges=nullptr, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">Refine and set level sets.</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00809">CutMeshInterface.cpp:809</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_cut_mesh_interface_html_aedb15b073b44bdf2cd4d20fbc19a8060"><div class="ttname"><a href="struct_mo_f_e_m_1_1_cut_mesh_interface.html#aedb15b073b44bdf2cd4d20fbc19a8060">MoFEM::CutMeshInterface::snapSurfaceToEdges</a></div><div class="ttdeci">MoFEMErrorCode snapSurfaceToEdges(const Range surface_edges, const Range fixed_edges, const double rel_tol, const double abs_tol, Tag th=nullptr, const bool debug=false)</div><div class="ttdef"><b>Definition</b> <a href="_cut_mesh_interface_8cpp_source.html#l00152">CutMeshInterface.cpp:152</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_log_manager_html_a1eb7382ca81a927c24b76ffd20134cfd"><div class="ttname"><a href="struct_mo_f_e_m_1_1_log_manager.html#a1eb7382ca81a927c24b76ffd20134cfd">MoFEM::LogManager::createSink</a></div><div class="ttdeci">static boost::shared_ptr&lt; SinkType &gt; createSink(boost::shared_ptr&lt; std::ostream &gt; stream_ptr, std::string comm_filter)</div><div class="ttdoc">Create a sink object.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8cpp_source.html#l00298">LogManager.cpp:298</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_log_manager_html_a745c3e2cfb9fdea08ecd2e85316e8639"><div class="ttname"><a href="struct_mo_f_e_m_1_1_log_manager.html#a745c3e2cfb9fdea08ecd2e85316e8639">MoFEM::LogManager::getStrmWorld</a></div><div class="ttdeci">static boost::shared_ptr&lt; std::ostream &gt; getStrmWorld()</div><div class="ttdoc">Get the strm world object.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8cpp_source.html#l00344">LogManager.cpp:344</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_log_manager_html_aab2b7c52e9893aaab48afecb6406c12f"><div class="ttname"><a href="struct_mo_f_e_m_1_1_log_manager.html#aab2b7c52e9893aaab48afecb6406c12f">MoFEM::LogManager::getStrmSync</a></div><div class="ttdeci">static boost::shared_ptr&lt; std::ostream &gt; getStrmSync()</div><div class="ttdoc">Get the strm sync object.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8cpp_source.html#l00348">LogManager.cpp:348</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_log_manager_html_ac1e5721da24d53aa5e6f5b9901b338b3"><div class="ttname"><a href="struct_mo_f_e_m_1_1_log_manager.html#ac1e5721da24d53aa5e6f5b9901b338b3">MoFEM::LogManager::getStrmSelf</a></div><div class="ttdeci">static boost::shared_ptr&lt; std::ostream &gt; getStrmSelf()</div><div class="ttdoc">Get the strm self object.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8cpp_source.html#l00340">LogManager.cpp:340</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_mesh_refinement_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_mesh_refinement.html">MoFEM::MeshRefinement</a></div><div class="ttdoc">Mesh refinement interface.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_refinement_8hpp_source.html#l00026">MeshRefinement.hpp:26</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_mesh_refinement_html_a7f731867b68b721d54096ceced3b9947"><div class="ttname"><a href="struct_mo_f_e_m_1_1_mesh_refinement.html#a7f731867b68b721d54096ceced3b9947">MoFEM::MeshRefinement::refineTets</a></div><div class="ttdeci">MoFEMErrorCode refineTets(const EntityHandle meshset, const BitRefLevel &amp;bit, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">refine TET in the meshset</div><div class="ttdef"><b>Definition</b> <a href="_mesh_refinement_8cpp_source.html#l00197">MeshRefinement.cpp:197</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_mesh_refinement_html_aaed88f73c43b3030907ce108217c39e7"><div class="ttname"><a href="struct_mo_f_e_m_1_1_mesh_refinement.html#aaed88f73c43b3030907ce108217c39e7">MoFEM::MeshRefinement::addVerticesInTheMiddleOfEdges</a></div><div class="ttdeci">MoFEMErrorCode addVerticesInTheMiddleOfEdges(const EntityHandle meshset, const BitRefLevel &amp;bit, const bool recursive=false, int verb=QUIET, EntityHandle start_v=0)</div><div class="ttdoc">make vertices in the middle of edges in meshset and add them to refinement levels defined by bit</div><div class="ttdef"><b>Definition</b> <a href="_mesh_refinement_8cpp_source.html#l00042">MeshRefinement.cpp:42</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html_a41119eae52ef09ee41400233e1da8d78"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html#a41119eae52ef09ee41400233e1da8d78">MoFEM::MeshsetsManager::deleteMeshset</a></div><div class="ttdeci">MoFEMErrorCode deleteMeshset(const CubitBCType cubit_bc_type, const int ms_id, const MoFEMTypes bh=MF_EXIST)</div><div class="ttdoc">delete cubit meshset</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00553">MeshsetsManager.cpp:553</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html_a5367f1a046921a007dc217ac04e50964"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html#a5367f1a046921a007dc217ac04e50964">MoFEM::MeshsetsManager::addEntitiesToMeshset</a></div><div class="ttdeci">MoFEMErrorCode addEntitiesToMeshset(const CubitBCType cubit_bc_type, const int ms_id, const Range &amp;ents)</div><div class="ttdoc">add entities to cubit meshset</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00418">MeshsetsManager.cpp:418</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_prism_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_prism_interface.html">MoFEM::PrismInterface</a></div><div class="ttdoc">Create interface from given surface and insert flat prisms in-between.</div><div class="ttdef"><b>Definition</b> <a href="_prism_interface_8hpp_source.html#l00023">PrismInterface.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_prism_interface_html_a647ba4accc02b9b9c863af097045bb42"><div class="ttname"><a href="struct_mo_f_e_m_1_1_prism_interface.html#a647ba4accc02b9b9c863af097045bb42">MoFEM::PrismInterface::getSides</a></div><div class="ttdeci">MoFEMErrorCode getSides(const int msId, const CubitBCType cubit_bc_type, const BitRefLevel mesh_bit_level, const bool recursive, int verb=QUIET)</div><div class="ttdoc">Store tetrahedra from each side of the interface separately in two child meshsets of the parent meshs...</div><div class="ttdef"><b>Definition</b> <a href="_prism_interface_8cpp_source.html#l00056">PrismInterface.cpp:56</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_prism_interface_html_ada01f8c0c3d86a8ae0e5cc2abdf59ceb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_prism_interface.html#ada01f8c0c3d86a8ae0e5cc2abdf59ceb">MoFEM::PrismInterface::splitSides</a></div><div class="ttdeci">MoFEMErrorCode splitSides(const EntityHandle meshset, const BitRefLevel &amp;bit, const int msId, const CubitBCType cubit_bc_type, const bool add_interface_entities, const bool recursive=false, int verb=QUIET)</div><div class="ttdoc">Split nodes and other entities of tetrahedra on both sides of the interface and insert flat prisms in...</div><div class="ttdef"><b>Definition</b> <a href="_prism_interface_8cpp_source.html#l00519">PrismInterface.cpp:519</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_ref_entity__change__parent_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_ref_entity__change__parent.html">MoFEM::RefEntity_change_parent</a></div><div class="ttdoc">change parent</div><div class="ttdef"><b>Definition</b> <a href="_ref_ents_multi_indices_8hpp_source.html#l00812">RefEntsMultiIndices.hpp:812</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_tools_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_tools.html">MoFEM::Tools</a></div><div class="ttdoc">Auxiliary tools.</div><div class="ttdef"><b>Definition</b> <a href="_tools_8hpp_source.html#l00019">Tools.hpp:19</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html">MoFEM::UnknownInterface</a></div><div class="ttdoc">base class for all interface classes</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00034">UnknownInterface.hpp:34</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astruct_mortar_contact_structures_html_a36efbaf00f3d8c24b61be4d22b8e005e"><div class="ttname"><a href="struct_mortar_contact_structures.html#a36efbaf00f3d8c24b61be4d22b8e005e">MortarContactStructures::findContactSurfacePairs</a></div><div class="ttdeci">static MoFEMErrorCode findContactSurfacePairs(MoFEM::Interface &amp;m_field, std::vector&lt; std::pair&lt; Range, Range &gt; &gt; &amp;contact_surface_pairs)</div><div class="ttdef"><b>Definition</b> <a href="_make_structures_8hpp_source.html#l00043">MakeStructures.hpp:43</a></div></div>
</div><!-- fragment --></div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
