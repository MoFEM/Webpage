<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: HookeElement.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">HookeElement.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Operators and data structures for linear elastic analysisSee as well header file <a class="el" href="HookeElement_8hpp.html">HookeElement.hpp</a></p>
<p>Implemention of operators for <a class="el" href="structHooke.html" title="Hook equation.">Hooke</a> material. Implementation is extended to the case when the mesh is moving as results of topological changes, also the calculation of material forces and associated tangent matrices are added to implementation.</p>
<p>In other words spatial deformation is small but topological changes large.</p>
<div class="fragment"><div class="line"><span class="comment">/** \file HookeElement.cpp</span></div>
<div class="line"><span class="comment"> * \example HookeElement.cpp</span></div>
<div class="line"><span class="comment"> * \brief Operators and data structures for linear elastic analysis</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * See as well header file HookeElement.hpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Implemention of operators for Hooke material. Implementation is extended to</span></div>
<div class="line"><span class="comment"> * the case when the mesh is moving as results of topological changes, also the</span></div>
<div class="line"><span class="comment"> * calculation of material forces and associated tangent matrices are added to</span></div>
<div class="line"><span class="comment"> * implementation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * In other words spatial deformation is small but topological changes large.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="HookeElement_8hpp.html">HookeElement.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateStrainAle::OpCalculateStrainAle(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a name="_a0"></a><a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, false),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a name="a1"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStrainAle::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                          EntityType row_type,</div>
<div class="line">                                                          <a name="_a2"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a name="a3"></a><a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a name="_a4"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a name="a5"></a><a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a name="_a6"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a name="a7"></a><a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a name="_a8"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a name="a9"></a><a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line">  <span class="keyword">auto</span> t_H = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;HMat);</div>
<div class="line"> </div>
<div class="line">  dataAtPts-&gt;detHVec-&gt;resize(nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  dataAtPts-&gt;invHMat-&gt;resize(9, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  dataAtPts-&gt;FMat-&gt;resize(9, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  dataAtPts-&gt;smallStrainMat-&gt;resize(6, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_detH = <a name="a10"></a><a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*dataAtPts-&gt;detHVec);</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;FMat);</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*dataAtPts-&gt;smallStrainMat);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    <a name="a11"></a><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a12"></a><a class="code" href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">determinantTensor3by3</a>(t_H, t_detH);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a13"></a><a class="code" href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">invertTensor3by3</a>(t_H, t_detH, t_invH);</div>
<div class="line">    t_F(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_h(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_invH(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    t_strain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_F(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_F(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line"> </div>
<div class="line">    t_strain(0, 0) -= 1;</div>
<div class="line">    t_strain(1, 1) -= 1;</div>
<div class="line">    t_strain(2, 2) -= 1;</div>
<div class="line"> </div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_h;</div>
<div class="line">    ++t_H;</div>
<div class="line">    ++t_detH;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_F;</div>
<div class="line">  }</div>
<div class="line">  <a name="a14"></a><a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateEnergy::OpCalculateEnergy(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">    <a name="_a15"></a><a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> ghost_vec)</div>
<div class="line">    : <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts), ghostVec(ghost_vec, true) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateEnergy::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                       EntityType row_type,</div>
<div class="line">                                                       <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  dataAtPts-&gt;energyVec-&gt;resize(nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> t_energy = <a name="_a16"></a><a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt;(</div>
<div class="line">      &amp;*(dataAtPts-&gt;energyVec-&gt;data().begin()));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    t_energy = (t_strain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>)) / 2.;</div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_energy;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ghostVec.get()) {</div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get intergrayion weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">    <span class="keyword">auto</span> t_energy = <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt;(</div>
<div class="line">        &amp;*(dataAtPts-&gt;energyVec-&gt;data().begin()));</div>
<div class="line">    <span class="keywordtype">double</span> energy = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">      <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">      <span class="keywordtype">double</span> <a name="a17"></a><a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line">      <span class="keywordflow">if</span> (det_H.size()) {</div>
<div class="line">        <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> *= det_H[gg];</div>
<div class="line">      }</div>
<div class="line">      energy += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_energy;</div>
<div class="line">      ++t_energy;</div>
<div class="line">      ++t_w;</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(ghostVec, 0, energy, ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateEshelbyStress::OpCalculateEshelbyStress(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts)</div>
<div class="line">    : <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateEshelbyStress::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_energy = <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt;(</div>
<div class="line">      &amp;*(dataAtPts-&gt;energyVec-&gt;data().begin()));</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;FMat));</div>
<div class="line">  dataAtPts-&gt;eshelbyStressMat-&gt;resize(9, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;eshelbyStressMat));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    t_eshelby_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_F(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_cauchy_stress(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    t_eshelby_stress(0, 0) += t_energy;</div>
<div class="line">    t_eshelby_stress(1, 1) += t_energy;</div>
<div class="line">    t_eshelby_stress(2, 2) += t_energy;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_energy;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_F;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAssemble::OpAssemble(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts, <span class="keyword">const</span> <span class="keywordtype">char</span> <a name="a18"></a><a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">    <span class="keywordtype">bool</span> symm)</div>
<div class="line">    : <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, symm),</div>
<div class="line">      dataAtPts(data_at_pts) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side,</div>
<div class="line">                                                EntityType row_type,</div>
<div class="line">                                                EntityType col_type,</div>
<div class="line">                                                <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of dofs on row</span></div>
<div class="line">  nbRows = row_data.<a name="a19"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">  <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">    <a name="a20"></a><a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of dofs on column</span></div>
<div class="line">  nbCols = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">  <span class="comment">// if no dofs on Columbia, exit nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span> (!nbCols)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// K_ij matrix will have 3 times the number of degrees of freedom of the</span></div>
<div class="line">  <span class="comment">// i-th entity set (nbRows)</span></div>
<div class="line">  <span class="comment">// and 3 times the number of degrees of freedom of the j-th entity set</span></div>
<div class="line">  <span class="comment">// (nbCols)</span></div>
<div class="line">  <a name="a21"></a><a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  nbIntegrationPts = getGaussPts().size2();</div>
<div class="line">  <span class="comment">// check if entity block is on matrix diagonal</span></div>
<div class="line">  <span class="keywordflow">if</span> (row_side == col_side &amp;&amp; row_type == col_type) {</div>
<div class="line">    isDiag = <span class="keyword">true</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    isDiag = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data, col_data);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data, col_data);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                EntityType row_type,</div>
<div class="line">                                                <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of dofs on row</span></div>
<div class="line">  nbRows = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">  <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  nbIntegrationPts = getGaussPts().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                   <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  SETERRQ(PETSC_COMM_SELF, <a name="a22"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not implemented&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not implemented&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                  <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line">  <span class="comment">// get pointer to first global index on column</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;data = *dataAtPts;</div>
<div class="line">  <span class="keywordflow">if</span> (!data.forcesOnlyOnEntitiesRow.empty()) {</div>
<div class="line">    rowIndices.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    noalias(rowIndices) = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>();</div>
<div class="line">    row_indices = &amp;rowIndices[0];</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#afe24680af2bc8772d55bdf4ed5f9211a">VectorDofs</a> &amp;dofs = row_data.<a name="a23"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a14f5bf9a76b74ed8a2ca283b369e54ad">getFieldDofs</a>();</div>
<div class="line">    VectorDofs::iterator dit = dofs.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; dit != dofs.end(); dit++, ii++) {</div>
<div class="line">      <span class="keywordflow">if</span> (data.forcesOnlyOnEntitiesRow.find((*dit)-&gt;getEnt()) ==</div>
<div class="line">          data.forcesOnlyOnEntitiesRow.end()) {</div>
<div class="line">        rowIndices[ii] = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!data.forcesOnlyOnEntitiesCol.empty()) {</div>
<div class="line">    colIndices.resize(nbCols, <span class="keyword">false</span>);</div>
<div class="line">    noalias(colIndices) = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>();</div>
<div class="line">    col_indices = &amp;colIndices[0];</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#afe24680af2bc8772d55bdf4ed5f9211a">VectorDofs</a> &amp;dofs = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a14f5bf9a76b74ed8a2ca283b369e54ad">getFieldDofs</a>();</div>
<div class="line">    VectorDofs::iterator dit = dofs.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; dit != dofs.end(); dit++, ii++) {</div>
<div class="line">      <span class="keywordflow">if</span> (data.forcesOnlyOnEntitiesCol.find((*dit)-&gt;getEnt()) ==</div>
<div class="line">          data.forcesOnlyOnEntitiesCol.end()) {</div>
<div class="line">        colIndices[ii] = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  Mat B = getFEMethod()-&gt;ksp_B != PETSC_NULL ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                             : getFEMethod()-&gt;snes_B;</div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a24"></a><a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbRows, row_indices, nbCols, col_indices,</div>
<div class="line">                      &amp;*<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.data().begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!isDiag &amp;&amp; sYmm) {</div>
<div class="line">    <span class="comment">// if not diagonal term and since global matrix is symmetric assemble</span></div>
<div class="line">    <span class="comment">// transpose term.</span></div>
<div class="line">    transK.resize(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.size2(), <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>.size1(), <span class="keyword">false</span>);</div>
<div class="line">    noalias(transK) = trans(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(B, nbCols, col_indices, nbRows, row_indices,</div>
<div class="line">                        &amp;*transK.data().begin(), ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::aSsemble(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().data().begin();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;data = *dataAtPts;</div>
<div class="line">  <span class="keywordflow">if</span> (!data.forcesOnlyOnEntitiesRow.empty()) {</div>
<div class="line">    rowIndices.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    noalias(rowIndices) = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>();</div>
<div class="line">    row_indices = &amp;rowIndices[0];</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#afe24680af2bc8772d55bdf4ed5f9211a">VectorDofs</a> &amp;dofs = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a14f5bf9a76b74ed8a2ca283b369e54ad">getFieldDofs</a>();</div>
<div class="line">    VectorDofs::iterator dit = dofs.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; dit != dofs.end(); dit++, ii++) {</div>
<div class="line">      <span class="keywordflow">if</span> (data.forcesOnlyOnEntitiesRow.find((*dit)-&gt;getEnt()) ==</div>
<div class="line">          data.forcesOnlyOnEntitiesRow.end()) {</div>
<div class="line">        rowIndices[ii] = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a name="a25"></a><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a name="a26"></a><a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = getFEMethod()-&gt;snes_f;</div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a27"></a><a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, nbRows, row_indices, &amp;*nF.data().begin(), ADD_VALUES);</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpRhs_dx::OpRhs_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a name="_a28"></a><a class="code" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROW) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpRhs_dx::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](<a name="a29"></a><a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> &amp;<a name="a30"></a><a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a name="a31"></a><a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a name="_a32"></a><a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0), &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1), &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a name="_a33"></a><a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a name="a34"></a><a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a name="a35"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a name="a36"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*dataAtPts-&gt;cauchyStressMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      t_nf(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleRhs_dx::OpAleRhs_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROW) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleRhs_dx::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](<a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0), &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1), &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*dataAtPts-&gt;cauchyStressMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      <a name="_a37"></a><a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_nf(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleRhs_dX::OpAleRhs_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROW) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleRhs_dX::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](<a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0), &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1), &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;eshelbyStressMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_nf(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a38"></a><a class="code" href="HookeElement_8hpp.html#a876ae06004c50dfe806b15573a81b6ad">HookeElement::setBlocks</a>(</div>
<div class="line">    <a name="_a39"></a><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!block_sets_ptr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a name="a40"></a><a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Pointer to block of sets is null&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<a name="a41"></a><a class="code" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(</div>
<div class="line">           m_field, <a name="a42"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a> | <a name="a43"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca416c3e3070d3438afe45ae7359d0559e">MAT_ELASTICSET</a>, it)) {</div>
<div class="line">    <a name="_a44"></a><a class="code" href="structMoFEM_1_1Mat__Elastic.html">Mat_Elastic</a> mydata;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> it-&gt;getAttributeDataStructure(mydata);</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keywordtype">id</span> = it-&gt;getMeshsetId();</div>
<div class="line">    <span class="keyword">auto</span> &amp;block_data = (*block_sets_ptr)[id];</div>
<div class="line">    <a name="_a45"></a><a class="code" href="classEntityHandle.html">EntityHandle</a> meshset = it-&gt;getMeshset();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a46"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(meshset, 3,</div>
<div class="line">                                                        block_data.tEts, <span class="keyword">true</span>);</div>
<div class="line">    block_data.iD = id;</div>
<div class="line">    block_data.E = mydata.<a name="a47"></a><a class="code" href="structMoFEM_1_1Mat__Elastic.html#a4b9235ca86996296e5242976d5a12d58">data</a>.Young;</div>
<div class="line">    block_data.PoissonRatio = mydata.<a class="code" href="structMoFEM_1_1Mat__Elastic.html#a4b9235ca86996296e5242976d5a12d58">data</a>.Poisson;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a48"></a><a class="code" href="HookeElement_8hpp.html#a0f85137bea6f1d107f231a000fae355c">HookeElement::addElasticElement</a>(</div>
<div class="line">    <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">    <span class="keyword">const</span> std::string element_name, <span class="keyword">const</span> std::string x_field,</div>
<div class="line">    <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!block_sets_ptr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Pointer to block of sets is null&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a49"></a><a class="code" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(element_name, <a name="a50"></a><a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a51"></a><a class="code" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(element_name, x_field);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a52"></a><a class="code" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(element_name, x_field);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a53"></a><a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(element_name, x_field);</div>
<div class="line">  <span class="keywordflow">if</span> (m_field.<a name="a54"></a><a class="code" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(X_field)) {</div>
<div class="line">    <span class="keywordflow">if</span> (ale) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(element_name, X_field);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(element_name, X_field);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(element_name, X_field);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a name="a55"></a><a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : (*block_sets_ptr)) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a56"></a><a class="code" href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">add_ents_to_finite_element_by_dim</a>(<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts, 3,</div>
<div class="line">                                                     element_name);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a57"></a><a class="code" href="HookeElement_8hpp.html#a494863af803f80fe1269b83c2ad1fdce">HookeElement::setOperators</a>(</div>
<div class="line">    boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_lhs_ptr,</div>
<div class="line">    boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_rhs_ptr,</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line">    <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp, <span class="keyword">const</span> EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!block_sets_ptr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Pointer to block of sets is null&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!data_at_pts)</div>
<div class="line">    data_at_pts = boost::make_shared&lt;DataAtIntegrationPts&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (fe_lhs_ptr) {</div>
<div class="line">    <span class="keywordflow">if</span> (ale == PETSC_FALSE) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a name="a58"></a><a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a59"></a><a class="code" href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a60"></a><a class="code" href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a61"></a><a class="code" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt;true&gt;</a>(</div>
<div class="line">              x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a62"></a><a class="code" href="structOpLhs__dx__dx.html">OpLhs_dx_dx&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a63"></a><a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(X_field, data_at_pts-&gt;HMat));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt;true&gt;</a>(</div>
<div class="line">              x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a64"></a><a class="code" href="structOpCalculateStrainAle.html">OpCalculateStrainAle</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a65"></a><a class="code" href="structOpCalculateStress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a66"></a><a class="code" href="structOpAleLhs__dx__dx.html">OpAleLhs_dx_dx&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a67"></a><a class="code" href="structOpAleLhs__dx__dX.html">OpAleLhs_dx_dX&lt;0&gt;</a>(x_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a68"></a><a class="code" href="structOpCalculateEnergy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a69"></a><a class="code" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a70"></a><a class="code" href="structOpAleLhs__dX__dX.html">OpAleLhs_dX_dX&lt;0&gt;</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a71"></a><a class="code" href="structOpAleLhsPre__dX__dx.html">OpAleLhsPre_dX_dx&lt;0&gt;</a>(X_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a72"></a><a class="code" href="structOpAleLhs__dX__dx.html">OpAleLhs_dX_dx</a>(X_field, x_field, data_at_pts));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (fe_rhs_ptr) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ale == PETSC_FALSE) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(x_field, x_field,</div>
<div class="line">                                                 block_sets_ptr, data_at_pts));</div>
<div class="line">      <span class="keywordflow">if</span> (field_disp) {</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a name="_a73"></a><a class="code" href="structOpCalculateStrain.html">OpCalculateStrain&lt;true&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structOpCalculateStrain.html">OpCalculateStrain&lt;false&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      }</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateStress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a74"></a><a class="code" href="structOpRhs__dx.html">OpRhs_dx</a>(x_field, x_field, data_at_pts));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(X_field, data_at_pts-&gt;HMat));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(x_field, x_field,</div>
<div class="line">                                                 block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateStrainAle.html">OpCalculateStrainAle</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateStress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a75"></a><a class="code" href="structOpAleRhs__dx.html">OpAleRhs_dx</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateEnergy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a name="_a76"></a><a class="code" href="structOpAleRhs__dX.html">OpAleRhs_dX</a>(X_field, X_field, data_at_pts));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a name="a77"></a><a class="code" href="HookeElement_8hpp.html#a97383c2135b66fb5d03b8e15562ddf56">HookeElement::calculateEnergy</a>(</div>
<div class="line">    DM dm, boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line">    <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp, <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> &amp;v_energy) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a78"></a><a class="code" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dm, &amp;m_field_ptr);</div>
<div class="line"> </div>
<div class="line">  v_energy = <a name="a79"></a><a class="code" href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">createVectorMPI</a>(m_field_ptr-&gt;<a name="a80"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), PETSC_DECIDE, 1);</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts(</div>
<div class="line">      <span class="keyword">new</span> DataAtIntegrationPts());</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> fe_ptr =</div>
<div class="line">      boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(*m_field_ptr);</div>
<div class="line">  fe_ptr-&gt;getRuleHook = [](<span class="keyword">const</span> <a name="_a81"></a><a class="code" href="classdouble.html">double</a>, <span class="keyword">const</span> <a class="code" href="classdouble.html">double</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> o) {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * o;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (m_field_ptr-&gt;<a class="code" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>)) <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a82"></a><a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(</div>
<div class="line">      <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *fe_ptr, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a name="_a83"></a><a class="code" href="structPrismFE.html">PrismFE</a> : <span class="keyword">public</span> <a name="_a84"></a><a class="code" href="structMoFEM_1_1FatPrismElementForcesAndSourcesCore.html">FatPrismElementForcesAndSourcesCore</a> {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using</span> FatPrismElementForcesAndSourcesCore::</div>
<div class="line">        FatPrismElementForcesAndSourcesCore;</div>
<div class="line">    <span class="keywordtype">int</span> getRuleTrianglesOnly(<span class="keywordtype">int</span> <a name="a85"></a><a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) { <span class="keywordflow">return</span> 2 * <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>; }</div>
<div class="line">    <span class="keywordtype">int</span> getRuleThroughThickness(<span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) { <span class="keywordflow">return</span> 2 * <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>; }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;ForcesAndSourcesCore&gt; prism_fe_ptr(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structPrismFE.html">PrismFE</a>(*m_field_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> push_ops = [&amp;](boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_ptr,</div>
<div class="line">                      EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>) {</div>
<div class="line">    <a name="a86"></a><a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (ale == PETSC_FALSE) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBPRISM) {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(</div>
<div class="line">          x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      <span class="keywordflow">if</span> (field_disp) {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structOpCalculateStrain.html">OpCalculateStrain&lt;true&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structOpCalculateStrain.html">OpCalculateStrain&lt;false&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      }</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateStress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateEnergy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts, v_energy));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a> == MBPRISM) {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(X_field, data_at_pts-&gt;HMat));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(</div>
<div class="line">          x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateStrainAle.html">OpCalculateStrainAle</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateStress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structOpCalculateEnergy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts, v_energy));</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> push_ops(fe_ptr, MBTET);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> push_ops(prism_fe_ptr, MBPRISM);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(v_energy);</div>
<div class="line"> </div>
<div class="line">  fe_ptr-&gt;snes_ctx = SnesMethod::CTX_SNESNONE;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a87"></a><a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>, fe_ptr);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>, prism_fe_ptr);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(v_energy);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(v_energy);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dX_dx::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                       <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](<a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a name="a88"></a><a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a name="_a89"></a><a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'m', 3&gt;</a> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'n', 3&gt;</a> <a name="a90"></a><a class="code" href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">n</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_eshelby_stress_dx = [<span class="keyword">this</span>]() {</div>
<div class="line">    <a name="_a91"></a><a class="code" href="classFTensor_1_1Tensor4.html">FTensor::Tensor4&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3, 3, 3&gt;</div>
<div class="line">        t_eshelby_stress_dx;</div>
<div class="line">    <span class="keywordtype">int</span> mm = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line">            t_eshelby_stress_dx.ptr(ii, jj, kk, ll) =</div>
<div class="line">                &amp;(*dataAtPts-&gt;eshelbyStress_dx)(mm++, 0);</div>
<div class="line">    <span class="keywordflow">return</span> t_eshelby_stress_dx;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress_dx = get_eshelby_stress_dx();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a name="_a92"></a><a class="code" href="classFTensor_1_1Tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_stress_dx;</div>
<div class="line">      t_row_stress_dx(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line">          <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress_dx(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress_dx(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_eshelby_stress_dx;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleLhsWithDensity_dX_dX::OpAleLhsWithDensity_dX_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0)</div>
<div class="line">    : <a class="code" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false),</div>
<div class="line">      rhoAtGaussPtsPtr(rho_at_gauss_pts),</div>
<div class="line">      rhoGradAtGaussPtsPtr(rho_grad_at_gauss_pts), rhoN(rho_n), rHo0(rho_0) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">HookeElement::OpAleLhsWithDensity_dX_dX::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                   <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](<a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <span class="keyword">auto</span> <a name="a93"></a><a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*rhoAtGaussPtsPtr);</div>
<div class="line">  <span class="keyword">auto</span> t_grad_rho = getFTensor1FromMat&lt;3&gt;(*rhoGradAtGaussPtsPtr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;eshelbyStressMat);</div>
<div class="line">  <span class="comment">// auto t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</span></div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> stress_dho_coef = (rhoN / <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="comment">// (rhoN / rHo0) * pow(rho / rHo0, rhoN - 1.) * (1. / pow(rho / rHo0,</span></div>
<div class="line">    <span class="comment">// rhoN));</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line">      t_row_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="comment">// auto t_col_diff_base = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_base = col_data.<a name="a94"></a><a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) +=</div>
<div class="line">            t_row_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * stress_dho_coef * t_grad_rho(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_base;</div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++t_grad_rho;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleLhsWithDensity_dx_dX::OpAleLhsWithDensity_dx_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0)</div>
<div class="line">    : <a class="code" href="structOpAssemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false),</div>
<div class="line">      rhoAtGaussPtsPtr(rho_at_gauss_pts),</div>
<div class="line">      rhoGradAtGaussPtsPtr(rho_grad_at_gauss_pts), rhoN(rho_n), rHo0(rho_0) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">HookeElement::OpAleLhsWithDensity_dx_dX::iNtegrate(<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                   <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](<a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 0, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 1, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>(<a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> + 2, <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get integration weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*rhoAtGaussPtsPtr);</div>
<div class="line">  <span class="keyword">auto</span> t_grad_rho = getFTensor1FromMat&lt;3&gt;(*rhoGradAtGaussPtsPtr);</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="comment">// auto t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</span></div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> stress_dho_coef = (rhoN / <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="comment">// (rhoN / rHo0) * pow(rho / rHo0, rhoN - 1.) * (1. / pow(rho / rHo0,</span></div>
<div class="line">    <span class="comment">// rhoN)); iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line">      t_row_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_base = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) +=</div>
<div class="line">            t_row_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * stress_dho_coef * t_grad_rho(<a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_base;</div>
<div class="line"> </div>
<div class="line">        ++t_col_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    <span class="comment">// ++t_D;</span></div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    <span class="comment">// ++t_h;</span></div>
<div class="line">    ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++t_grad_rho;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateStiffnessScaledByDensityField::</div>
<div class="line">    OpCalculateStiffnessScaledByDensityField(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0)</div>
<div class="line"> </div>
<div class="line">    : <a class="code" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      blockSetsPtr(block_sets_ptr), dataAtPts(data_at_pts),</div>
<div class="line">      rhoAtGaussPtsPtr(rho_at_gauss_pts), rhoN(rho_n), rHo0(rho_0) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStiffnessScaledByDensityField::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, EntityType row_type, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!rhoAtGaussPtsPtr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;Calculate density with MWLS first.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : (*blockSetsPtr)) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.find(getNumeredEntFiniteElementPtr()-&gt;getEnt()) ==</div>
<div class="line">        <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.tEts.end()) {</div>
<div class="line">      <span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">    dataAtPts-&gt;stiffnessMat-&gt;resize(36, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <a name="_a95"></a><a class="code" href="classFTensor_1_1Ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">        <a name="a96"></a><a class="code" href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> young = <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.E;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.PoissonRatio;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*rhoAtGaussPtsPtr);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// coefficient used in intermediate calculation</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = young / ((1 + poisson) * (1 - 2 * poisson));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">    <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">      t_D(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line"> </div>
<div class="line">      t_D(0, 0, 0, 0) = 1 - poisson;</div>
<div class="line">      t_D(1, 1, 1, 1) = 1 - poisson;</div>
<div class="line">      t_D(2, 2, 2, 2) = 1 - poisson;</div>
<div class="line"> </div>
<div class="line">      t_D(0, 1, 0, 1) = 0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(0, 2, 0, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(1, 2, 1, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line"> </div>
<div class="line">      t_D(0, 0, 1, 1) = poisson;</div>
<div class="line">      t_D(1, 1, 0, 0) = poisson;</div>
<div class="line">      t_D(0, 0, 2, 2) = poisson;</div>
<div class="line">      t_D(2, 2, 0, 0) = poisson;</div>
<div class="line">      t_D(1, 1, 2, 2) = poisson;</div>
<div class="line">      t_D(2, 2, 1, 1) = poisson;</div>
<div class="line">      <span class="comment">// here the coefficient is modified to take density into account for</span></div>
<div class="line">      <span class="comment">// porous materials: E(p) = E * (p / p_0)^n</span></div>
<div class="line">      t_D(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient * pow(<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rHo0, rhoN);</div>
<div class="line"> </div>
<div class="line">      ++t_D;</div>
<div class="line">      ++<a class="code" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_a876ae06004c50dfe806b15573a81b6ad"><div class="ttname"><a href="HookeElement_8hpp.html#a876ae06004c50dfe806b15573a81b6ad">setBlocks</a></div><div class="ttdeci">static MoFEMErrorCode setBlocks(MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; map&lt; int, BlockData &gt;&gt; &amp;block_sets_ptr)</div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:8</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="astructOpLhs__dx__dx_html"><div class="ttname"><a href="structOpLhs__dx__dx.html">OpLhs_dx_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00410">HookeElement.hpp:410</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00140">plastic.cpp:140</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00674">HODataOperators.hpp:674</a></div></div>
<div class="ttc" id="astructOpAleLhsPre__dX__dx_html"><div class="ttname"><a href="structOpAleLhsPre__dX__dx.html">OpAleLhsPre_dX_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00536">HookeElement.hpp:536</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adecbcd03d7be8763b60a827f434fe726"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="astructMoFEM_1_1Mat__Elastic_html"><div class="ttname"><a href="structMoFEM_1_1Mat__Elastic.html">MoFEM::Mat_Elastic</a></div><div class="ttdoc">Elastic material data structure.</div><div class="ttdef"><b>Definition:</b> <a href="MaterialBlocks_8hpp_source.html#l00139">MaterialBlocks.hpp:139</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga6bd6335f024a22cde370ee807d9185ce"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00049">MeshsetsManager.hpp:49</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_a97383c2135b66fb5d03b8e15562ddf56"><div class="ttname"><a href="HookeElement_8hpp.html#a97383c2135b66fb5d03b8e15562ddf56">calculateEnergy</a></div><div class="ttdeci">static MoFEMErrorCode calculateEnergy(DM dm, boost::shared_ptr&lt; map&lt; int, BlockData &gt;&gt; block_sets_ptr, const std::string x_field, const std::string X_field, const bool ale, const bool field_disp, SmartPetscObj&lt; Vec &gt; &amp;v_energy_ptr)</div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:16</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateInvJacForFatPrism_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateInvJacForFatPrism.html">MoFEM::OpCalculateInvJacForFatPrism</a></div><div class="ttdoc">Calculate inverse of jacobian for face element.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l03145">UserDataOperators.hpp:3145</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a7064ec9e939c81c212cc726272c0e088"><div class="ttname"><a href="namespaceMoFEM.html#a7064ec9e939c81c212cc726272c0e088">MoFEM::invertTensor3by3</a></div><div class="ttdeci">MoFEMErrorCode invertTensor3by3(ublas::matrix&lt; T, L, A &gt; &amp;jac_data, ublas::vector&lt; T, A &gt; &amp;det_data, ublas::matrix&lt; T, L, A &gt; &amp;inv_jac_data)</div><div class="ttdoc">Calculate inverse of tensor rank 2 at integration points.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01588">Templates.hpp:1588</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01502">EntitiesFieldData.hpp:1502</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor3_html"><div class="ttname"><a href="classFTensor_1_1Tensor3.html">FTensor::Tensor3</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor3__value_8hpp_source.html#l00012">Tensor3_value.hpp:12</a></div></div>
<div class="ttc" id="astructOpCalculateStrainAle_html"><div class="ttname"><a href="structOpCalculateStrainAle.html">OpCalculateStrainAle</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00130">HookeElement.hpp:130</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astructOpAleRhs__dx_html"><div class="ttname"><a href="structOpAleRhs__dx.html">OpAleRhs_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00425">HookeElement.hpp:425</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetInvJacH1ForFatPrism_html"><div class="ttname"><a href="structMoFEM_1_1OpSetInvJacH1ForFatPrism.html">MoFEM::OpSetInvJacH1ForFatPrism</a></div><div class="ttdoc">Transform local reference derivatives of shape functions to global derivatives.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l03172">UserDataOperators.hpp:3172</a></div></div>
<div class="ttc" id="astructOpCalculateHomogeneousStiffness_html"><div class="ttname"><a href="structOpCalculateHomogeneousStiffness.html">OpCalculateHomogeneousStiffness</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00190">HookeElement.hpp:190</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aa464ad90a188180427136b22e078ec7d"><div class="ttname"><a href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">MoFEM::getFTensor0FromVec</a></div><div class="ttdeci">static auto getFTensor0FromVec(ublas::vector&lt; T, A &gt; &amp;data)</div><div class="ttdoc">Get tensor rank 0 (scalar) form data vector.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l00135">Templates.hpp:135</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca416c3e3070d3438afe45ae7359d0559e"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca416c3e3070d3438afe45ae7359d0559e">MAT_ELASTICSET</a></div><div class="ttdeci">@ MAT_ELASTICSET</div><div class="ttdoc">block name is &quot;MAT_ELASTIC&quot;</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00172">definitions.h:172</a></div></div>
<div class="ttc" id="astructOpAleRhs__dX_html"><div class="ttname"><a href="structOpAleRhs__dX.html">OpAleRhs_dX</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00512">HookeElement.hpp:512</a></div></div>
<div class="ttc" id="astructOpCalculateEshelbyStress_html"><div class="ttname"><a href="structOpCalculateEshelbyStress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00177">HookeElement.hpp:177</a></div></div>
<div class="ttc" id="astructOpCalculateEnergy_html"><div class="ttname"><a href="structOpCalculateEnergy.html">OpCalculateEnergy</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00164">HookeElement.hpp:164</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a632d60524d4b1682a472437b9277e480"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01214">EntitiesFieldData.hpp:1214</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html"><div class="ttname"><a href="HookeElement_8hpp.html">HookeElement.hpp</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_afe24680af2bc8772d55bdf4ed5f9211a"><div class="ttname"><a href="namespaceMoFEM.html#afe24680af2bc8772d55bdf4ed5f9211a">MoFEM::VectorDofs</a></div><div class="ttdeci">ublas::vector&lt; FEDofEntity *, DofsAllocator &gt; VectorDofs</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00023">EntitiesFieldData.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Mat__Elastic_html_a4b9235ca86996296e5242976d5a12d58"><div class="ttname"><a href="structMoFEM_1_1Mat__Elastic.html#a4b9235ca86996296e5242976d5a12d58">MoFEM::Mat_Elastic::data</a></div><div class="ttdeci">_data_ data</div><div class="ttdef"><b>Definition:</b> <a href="MaterialBlocks_8hpp_source.html#l00155">MaterialBlocks.hpp:155</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_gad43a6631f7d465ad31403cbb1d1896ba"><div class="ttname"><a href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">MoFEM::CoreInterface::check_field</a></div><div class="ttdeci">virtual bool check_field(const std::string &amp;name) const =0</div><div class="ttdoc">check if field is in database</div></div>
<div class="ttc" id="astructPrismFE_html"><div class="ttname"><a href="structPrismFE.html">PrismFE</a></div><div class="ttdef"><b>Definition:</b> <a href="prism__elements__from__surface_8cpp_source.html#l00062">prism_elements_from_surface.cpp:62</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a14f5bf9a76b74ed8a2ca283b369e54ad"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a14f5bf9a76b74ed8a2ca283b369e54ad">MoFEM::EntitiesFieldData::EntData::getFieldDofs</a></div><div class="ttdeci">const VectorDofs &amp; getFieldDofs() const</div><div class="ttdoc">get dofs data stature FEDofEntity</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01269">EntitiesFieldData.hpp:1269</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor4_html"><div class="ttname"><a href="classFTensor_1_1Tensor4.html">FTensor::Tensor4</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor4__value_8hpp_source.html#l00018">Tensor4_value.hpp:18</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga3a32fd9345258c23de8d1230795f8ff3"><div class="ttname"><a href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">MoFEM::CoreInterface::add_ents_to_finite_element_by_dim</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_dim(const EntityHandle entities, const int dim, const std::string &amp;name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="astructMoFEM_1_1FatPrismElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1FatPrismElementForcesAndSourcesCore.html">MoFEM::FatPrismElementForcesAndSourcesCore</a></div><div class="ttdoc">FatPrism finite element.</div><div class="ttdef"><b>Definition:</b> <a href="FatPrismElementForcesAndSourcesCore_8hpp_source.html#l00031">FatPrismElementForcesAndSourcesCore.hpp:31</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00108">VolumeElementForcesAndSourcesCore.hpp:108</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', 3 &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">MoFEM::OpCalculateVectorFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01535">UserDataOperators.hpp:1535</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a7e74026b069250283fc770ea21369587"><div class="ttname"><a href="namespaceconvert.html#a7e74026b069250283fc770ea21369587">convert.n</a></div><div class="ttdeci">n</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00082">convert.py:82</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ae3a0416ae2eb4b327e43ef2dfc21a15a"><div class="ttname"><a href="namespaceMoFEM.html#ae3a0416ae2eb4b327e43ef2dfc21a15a">MoFEM::determinantTensor3by3</a></div><div class="ttdeci">static auto determinantTensor3by3(T &amp;t)</div><div class="ttdoc">Calculate the determinant of a 3x3 matrix or a tensor of rank 2.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01540">Templates.hpp:1540</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8cpp_source.html#l00526">EntitiesFieldData.cpp:526</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor0_html"><div class="ttname"><a href="classFTensor_1_1Tensor0.html">FTensor::Tensor0</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor0_8hpp_source.html#l00016">Tensor0.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a6803bfc79169740e108bd5e2666de739"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6803bfc79169740e108bd5e2666de739">MoFEM::EntitiesFieldData::EntData::getN</a></div><div class="ttdeci">MatrixDouble &amp; getN(const FieldApproximationBase base)</div><div class="ttdoc">get base functions this return matrix (nb. of rows is equal to nb. of Gauss pts, nb....</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01318">EntitiesFieldData.hpp:1318</a></div></div>
<div class="ttc" id="astructOpCalculateStrain_html"><div class="ttname"><a href="structOpCalculateStrain.html">OpCalculateStrain</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00119">HookeElement.hpp:119</a></div></div>
<div class="ttc" id="agroup__dm_html_gac5ffe05a59f8ff6145029d62093f2e9b"><div class="ttname"><a href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">MoFEM::DMoFEMGetInterfacePtr</a></div><div class="ttdeci">PetscErrorCode DMoFEMGetInterfacePtr(DM dm, MoFEM::Interface **m_field_ptr)</div><div class="ttdoc">Get pointer to MoFEM::Interface.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00414">DMMoFEM.cpp:414</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_ab02600da9e2ca129f6258b0e880c1e0e"><div class="ttname"><a href="HookeElement_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a></div><div class="ttdeci">#define MAT_TO_DDG(SM)</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00142">HookeElement.hpp:142</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Ddg_html"><div class="ttname"><a href="classFTensor_1_1Ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition:</b> <a href="Ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:7</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="astructOpAleLhs__dx__dX_html"><div class="ttname"><a href="structOpAleLhs__dx__dX.html">OpAleLhs_dx_dX</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00449">HookeElement.hpp:449</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a77d94d2111c0c988bc3100b3910cc25c"><div class="ttname"><a href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">MoFEM::createVectorMPI</a></div><div class="ttdeci">auto createVectorMPI(MPI_Comm comm, PetscInt n, PetscInt N)</div><div class="ttdoc">Create MPI Vector.</div><div class="ttdef"><b>Definition:</b> <a href="PetscSmartObj_8hpp_source.html#l00202">PetscSmartObj.hpp:202</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_a0f85137bea6f1d107f231a000fae355c"><div class="ttname"><a href="HookeElement_8hpp.html#a0f85137bea6f1d107f231a000fae355c">addElasticElement</a></div><div class="ttdeci">static MoFEMErrorCode addElasticElement(MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; map&lt; int, BlockData &gt;&gt; &amp;block_sets_ptr, const std::string element_name, const std::string x_field, const std::string X_field, const bool ale)</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8cpp_source.html#l00533">HookeElement.cpp:533</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="astructOpCalculateStress_html"><div class="ttname"><a href="structOpCalculateStress.html">OpCalculateStress</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00153">HookeElement.hpp:153</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_a494863af803f80fe1269b83c2ad1fdce"><div class="ttname"><a href="HookeElement_8hpp.html#a494863af803f80fe1269b83c2ad1fdce">setOperators</a></div><div class="ttdeci">static MoFEMErrorCode setOperators(boost::shared_ptr&lt; ForcesAndSourcesCore &gt; fe_lhs_ptr, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; fe_rhs_ptr, boost::shared_ptr&lt; map&lt; int, BlockData &gt;&gt; block_sets_ptr, const std::string x_field, const std::string X_field, const bool ale, const bool field_disp, const EntityType type=MBTET, boost::shared_ptr&lt; DataAtIntegrationPts &gt; data_at_pts=nullptr)</div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructOpAssemble_html"><div class="ttname"><a href="structOpAssemble.html">OpAssemble</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00340">HookeElement.hpp:340</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="astructOpAleLhs__dx__dx_html"><div class="ttname"><a href="structOpAleLhs__dx__dx.html">OpAleLhs_dx_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00434">HookeElement.hpp:434</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SmartPetscObj_html"><div class="ttname"><a href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj&lt; Vec &gt;</a></div></div>
<div class="ttc" id="astructOpAleLhs__dX__dX_html"><div class="ttname"><a href="structOpAleLhs__dX__dX.html">OpAleLhs_dX_dX</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00521">HookeElement.hpp:521</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="astructOpRhs__dx_html"><div class="ttname"><a href="structOpRhs__dx.html">OpRhs_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00401">HookeElement.hpp:401</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a></div><div class="ttdeci">@ MOFEM_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00032">definitions.h:32</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="astructOpAleLhs__dX__dx_html"><div class="ttname"><a href="structOpAleLhs__dX__dx.html">OpAleLhs_dX_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00547">HookeElement.hpp:547</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>