<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: nonlinear_dynamics.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">nonlinear_dynamics.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<p>Non-linear elastic dynamics.</p><dl class="section note"><dt>Note</dt><dd>For block solver is only for settings, some features are not implemented for this part.</dd>
<dd>
This is implementation where first order ODE is solved, and displacements and velocities are independently approximated. User can set lowe approximation order to velocities. However this method is inefficient comparing to method using Alpha method sor second order ODEs. Look into tutorials to see how to implement dynamic problem for TS type alpha2</dd></dl>
<div class="fragment"><div class="line"><span class="comment">/** </span></div>
<div class="line"><span class="comment"> * \file nonlinear_dynamics.cpp</span></div>
<div class="line"><span class="comment"> * \example nonlinear_dynamics.cpp</span></div>
<div class="line"><span class="comment"> * \ingroup nonlinear_elastic_ele</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brief Non-linear elastic dynamics.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> \note For block solver is only for settings, some features are not implemented</span></div>
<div class="line"><span class="comment"> for this part.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> \note This is implementation where first order ODE is solved, and displacements</span></div>
<div class="line"><span class="comment"> and velocities are independently approximated. User can set lowe approximation</span></div>
<div class="line"><span class="comment"> order to velocities. However this method is inefficient comparing to method</span></div>
<div class="line"><span class="comment"> using Alpha method sor second order ODEs. Look into tutorials to see how to</span></div>
<div class="line"><span class="comment"> implement dynamic problem for TS type alpha2</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ElasticMaterials_8hpp.html">ElasticMaterials.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="SurfacePressureComplexForLazy_8hpp.html">SurfacePressureComplexForLazy.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a name="a0"></a><a class="code" href="nonlinear__dynamics_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a name="_a1"></a><a class="code" href="structMonitorPostProc.html">MonitorPostProc</a> : <span class="keyword">public</span> <a name="_a2"></a><a class="code" href="structMoFEM_1_1FEMethod.html">FEMethod</a> {</div>
<div class="line"> </div>
<div class="line">  <a name="_a3"></a><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;mField;</div>
<div class="line">  <a name="_a4"></a><a class="code" href="structPostProcVolumeOnRefinedMesh.html">PostProcVolumeOnRefinedMesh</a> postProc;</div>
<div class="line">  std::map&lt;int, NonlinearElasticElement::BlockData&gt; &amp;setOfBlocks;</div>
<div class="line">  <a name="_a5"></a><a class="code" href="structNonlinearElasticElement_1_1MyVolumeFE.html">NonlinearElasticElement::MyVolumeFE</a></div>
<div class="line">      &amp;feElasticEnergy; <span class="comment">///&lt; calculate elastic energy</span></div>
<div class="line"><span class="comment"></span>  <a name="_a6"></a><a class="code" href="structConvectiveMassElement_1_1MyVolumeFE.html">ConvectiveMassElement::MyVolumeFE</a></div>
<div class="line">      &amp;feKineticEnergy; <span class="comment">///&lt; calculate elastic energy</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keywordtype">bool</span> iNit;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> pRT;</div>
<div class="line">  <span class="keywordtype">int</span> *step;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structMonitorPostProc.html">MonitorPostProc</a>(</div>
<div class="line">      <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">      std::map&lt;int, NonlinearElasticElement::BlockData&gt; &amp;set_of_blocks,</div>
<div class="line">      <a class="code" href="structNonlinearElasticElement_1_1MyVolumeFE.html">NonlinearElasticElement::MyVolumeFE</a> &amp;fe_elastic_energy,</div>
<div class="line">      <a class="code" href="structConvectiveMassElement_1_1MyVolumeFE.html">ConvectiveMassElement::MyVolumeFE</a> &amp;fe_kinetic_energy)</div>
<div class="line">      : <a class="code" href="structMoFEM_1_1FEMethod.html">FEMethod</a>(), mField(m_field), postProc(m_field),</div>
<div class="line">        setOfBlocks(set_of_blocks), feElasticEnergy(fe_elastic_energy),</div>
<div class="line">        feKineticEnergy(fe_kinetic_energy), iNit(<span class="keyword">false</span>) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> def_t_val = 0;</div>
<div class="line">    <span class="keyword">const</span> <a name="_a7"></a><a class="code" href="classEntityHandle.html">EntityHandle</a> root_meshset = mField.<a name="a8"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_root_set();</div>
<div class="line"> </div>
<div class="line">    Tag th_step;</div>
<div class="line">    <a name="a9"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(</div>
<div class="line">        <span class="stringliteral">&quot;_TsStep_&quot;</span>, 1, MB_TYPE_INTEGER, th_step,</div>
<div class="line">        MB_TAG_CREAT | MB_TAG_EXCL | MB_TAG_MESH, &amp;def_t_val);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_ALREADY_ALLOCATED) {</div>
<div class="line">      <a name="a10"></a><a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_by_ptr(th_step, &amp;root_meshset, 1,</div>
<div class="line">                                               (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;step));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(th_step, &amp;root_meshset, 1,</div>
<div class="line">                                                 &amp;def_t_val));</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_by_ptr(th_step, &amp;root_meshset, 1,</div>
<div class="line">                                                   (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;step));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    PetscBool flg = PETSC_TRUE;</div>
<div class="line">    <a name="a11"></a><a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a name="a12"></a><a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, PETSC_NULL,</div>
<div class="line">                                         <span class="stringliteral">&quot;-my_output_prt&quot;</span>, &amp;pRT, &amp;flg),</div>
<div class="line">                      <span class="stringliteral">&quot;Can not get option&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (flg != PETSC_TRUE) {</div>
<div class="line">      pRT = 10;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a name="a13"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> preProcess() {</div>
<div class="line">    <a name="a14"></a><a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!iNit) {</div>
<div class="line">      <a name="a15"></a><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.<a name="a16"></a><a class="code" href="structPostProcTemplateVolumeOnRefinedMesh.html#a093f5ac63678cfad18c87cd36c6962be">generateReferenceElementMesh</a>();</div>
<div class="line">      <span class="keywordflow">if</span>(mField.<a name="a17"></a><a class="code" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>))</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a18"></a><a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, postProc, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>,</div>
<div class="line">                        <span class="keyword">false</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.<a name="a19"></a><a class="code" href="group__mofem__fs__post__proc.html#ga69f5c71346638cb62c87f70ef1062b91">addFieldValuesPostProc</a>(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.<a class="code" href="group__mofem__fs__post__proc.html#ga69f5c71346638cb62c87f70ef1062b91">addFieldValuesPostProc</a>(<span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.<a class="code" href="group__mofem__fs__post__proc.html#ga69f5c71346638cb62c87f70ef1062b91">addFieldValuesPostProc</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.<a name="a20"></a><a class="code" href="group__mofem__fs__post__proc.html#ga5b5f38d5d91d2f4e03c51dbeadbb8130">addFieldValuesGradientPostProc</a>(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      std::map&lt;int, NonlinearElasticElement::BlockData&gt;::iterator sit =</div>
<div class="line">          setOfBlocks.begin();</div>
<div class="line">      <span class="keywordflow">for</span> (; sit != setOfBlocks.end(); sit++) {</div>
<div class="line">        postProc.<a name="a21"></a><a class="code" href="structMoFEM_1_1ForcesAndSourcesCore.html#ad27ed878e829d18291a9a6d869546c47">getOpPtrVector</a>().push_back(<span class="keyword">new</span> <a name="_a22"></a><a class="code" href="structPostProcStress.html">PostProcStress</a>(</div>
<div class="line">            postProc.<a name="a23"></a><a class="code" href="structPostProcTemplateOnRefineMesh.html#acd29730f88cf549ab0e5deb0b76476ee">postProcMesh</a>, postProc.<a name="a24"></a><a class="code" href="structPostProcTemplateOnRefineMesh.html#a47d46ec67f3f7c3e82a846f3f3887830">mapGaussPts</a>, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>,</div>
<div class="line">            sit-&gt;second, postProc.<a name="a25"></a><a class="code" href="structPostProcTemplateVolumeOnRefinedMesh.html#a829053948cb06f10651b18a9adcac873">commonData</a>, <span class="keyword">true</span>));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      iNit = <span class="keyword">true</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> ((*step) % pRT == 0) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a name="a26"></a><a class="code" href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">loop_finite_elements</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>, postProc);</div>
<div class="line">      std::ostringstream sss;</div>
<div class="line">      sss &lt;&lt; <span class="stringliteral">&quot;out_values_&quot;</span> &lt;&lt; (*step) &lt;&lt; <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc.<a name="a27"></a><a class="code" href="group__mofem__fs__post__proc.html#gac9592cc8071671f2363846c1aa049923">writeFile</a>(sss.str().c_str());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    feElasticEnergy.<a name="a28"></a><a class="code" href="structMoFEM_1_1TSMethod.html#ab83e4a69396dd343422809f7f4b57d41">ts_ctx</a> = <a name="a29"></a><a class="code" href="structMoFEM_1_1TSMethod.html#a0c125a07b85ceceb72d9f3afea241dfeae17f6c302dca802c8f2e6d45f53bf3da">TSMethod::CTX_TSNONE</a>;</div>
<div class="line">    feElasticEnergy.<a name="a30"></a><a class="code" href="structMoFEM_1_1SnesMethod.html#ac5ebf128ee5d19e718d081d218dba15d">snes_ctx</a> = <a name="a31"></a><a class="code" href="structMoFEM_1_1SnesMethod.html#a271bba1f52a84d1a813117473339911aaa417c651761e8128f92dac64bd35c887">SnesMethod::CTX_SNESNONE</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code" href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">loop_finite_elements</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;ELASTIC&quot;</span>, feElasticEnergy);</div>
<div class="line"> </div>
<div class="line">    feKineticEnergy.ts_ctx = <a class="code" href="structMoFEM_1_1TSMethod.html#a0c125a07b85ceceb72d9f3afea241dfeae17f6c302dca802c8f2e6d45f53bf3da">TSMethod::CTX_TSNONE</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code" href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">loop_finite_elements</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>,</div>
<div class="line">                                       feKineticEnergy);</div>
<div class="line">    <span class="keywordtype">double</span> <a name="_a32"></a><a class="code" href="classE.html">E</a> = feElasticEnergy.<a name="a33"></a><a class="code" href="structNonlinearElasticElement_1_1MyVolumeFE.html#a41ee4daa88dbd60276defbe4843b9f77">eNergy</a>;</div>
<div class="line">    <span class="keywordtype">double</span> <a name="_a34"></a><a class="code" href="classT.html">T</a> = feKineticEnergy.<a name="a35"></a><a class="code" href="structConvectiveMassElement_1_1MyVolumeFE.html#ae97a8968a6b5709018f25f6c3c42255e">eNergy</a>;</div>
<div class="line">    <a name="a36"></a><a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(</div>
<div class="line">        <span class="stringliteral">&quot;DYNAMIC&quot;</span>, Sev::inform,</div>
<div class="line">        <span class="stringliteral">&quot;%d Time %3.2e Elastic energy %3.2e Kinetic Energy %3.2e Total %3.2e\n&quot;</span>,</div>
<div class="line">        ts_step, ts_t, <a class="code" href="classE.html">E</a>, <a class="code" href="classT.html">T</a>, <a class="code" href="classE.html">E</a> + <a class="code" href="classT.html">T</a>);</div>
<div class="line"> </div>
<div class="line">    <a name="a37"></a><a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> operator()() {</div>
<div class="line">    <a name="a38"></a><a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">    <a name="a39"></a><a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> postProcess() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a name="_a40"></a><a class="code" href="structMonitorRestart.html">MonitorRestart</a> : <span class="keyword">public</span> <a class="code" href="structMoFEM_1_1FEMethod.html">FEMethod</a> {</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> *time;</div>
<div class="line">  <span class="keywordtype">int</span> *step;</div>
<div class="line">  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;mField;</div>
<div class="line">  <span class="keywordtype">int</span> pRT;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structMonitorRestart.html">MonitorRestart</a>(<a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, TS ts) : mField(m_field) {</div>
<div class="line">    <span class="keywordtype">double</span> def_t_val = 0;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> root_meshset = mField.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_root_set();</div>
<div class="line"> </div>
<div class="line">    Tag th_time;</div>
<div class="line">    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(</div>
<div class="line">        <span class="stringliteral">&quot;_TsTime_&quot;</span>, 1, MB_TYPE_DOUBLE, th_time,</div>
<div class="line">        MB_TAG_CREAT | MB_TAG_EXCL | MB_TAG_MESH, &amp;def_t_val);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_ALREADY_ALLOCATED) {</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_by_ptr(th_time, &amp;root_meshset, 1,</div>
<div class="line">                                               (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;time);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line">      <a name="a41"></a><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = TSSetTime(ts, *time);</div>
<div class="line">      CHKERRABORT(PETSC_COMM_WORLD, <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(th_time, &amp;root_meshset, 1,</div>
<div class="line">                                             &amp;def_t_val);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_by_ptr(th_time, &amp;root_meshset, 1,</div>
<div class="line">                                               (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;time);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line">    }</div>
<div class="line">    Tag th_step;</div>
<div class="line">    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(</div>
<div class="line">        <span class="stringliteral">&quot;_TsStep_&quot;</span>, 1, MB_TYPE_INTEGER, th_step,</div>
<div class="line">        MB_TAG_CREAT | MB_TAG_EXCL | MB_TAG_MESH, &amp;def_t_val);</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_ALREADY_ALLOCATED) {</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_by_ptr(th_step, &amp;root_meshset, 1,</div>
<div class="line">                                               (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;step);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(th_step, &amp;root_meshset, 1,</div>
<div class="line">                                             &amp;def_t_val);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_by_ptr(th_step, &amp;root_meshset, 1,</div>
<div class="line">                                               (<span class="keyword">const</span> <span class="keywordtype">void</span> **)&amp;step);</div>
<div class="line">      <a class="code" href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    PetscBool flg = PETSC_TRUE;</div>
<div class="line">    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-my_output_prt&quot;</span>, &amp;pRT,</div>
<div class="line">                              &amp;flg);</div>
<div class="line">    CHKERRABORT(PETSC_COMM_WORLD, <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (flg != PETSC_TRUE) {</div>
<div class="line">      pRT = 10;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> preProcess() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"> </div>
<div class="line">    (*time) = ts_t;</div>
<div class="line">    <span class="comment">// if(pRT&gt;0) {</span></div>
<div class="line">    <span class="comment">//   if((*step)%pRT==0) {</span></div>
<div class="line">    <span class="comment">//     std::ostringstream ss;</span></div>
<div class="line">    <span class="comment">//     ss &lt;&lt; &quot;restart_&quot; &lt;&lt; (*step) &lt;&lt; &quot;.h5m&quot;;</span></div>
<div class="line">    <span class="comment">//     CHKERR</span></div>
<div class="line">    <span class="comment">//     mField.get_moab().write_file(ss.str().c_str()/*,&quot;MOAB&quot;,&quot;PARALLEL=WRITE_PART&quot;*/);</span></div>
<div class="line">    <span class="comment">//</span></div>
<div class="line">    <span class="comment">//   }</span></div>
<div class="line">    <span class="comment">// }</span></div>
<div class="line">    (*step)++;</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> operator()() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> postProcess() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// See file users_modules/elasticity/TimeForceScale.hpp</span></div>
<div class="line"><span class="preprocessor">#include &lt;TimeForceScale.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a name="a42"></a><a class="code" href="nonlinear__dynamics_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">string</span> default_options = <span class="stringliteral">&quot;-ksp_type fgmres \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-pc_type lu \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-pc_factor_mat_solver_type mumps \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-mat_mumps_icntl_20 0 \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-ksp_atol 1e-10 \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-ksp_rtol 1e-10 \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-snes_monitor \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-snes_type newtonls \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-snes_linesearch_type basic \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-snes_max_it 100 \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-snes_atol 1e-7 \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-snes_rtol 1e-7 \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-ts_monitor \n&quot;</span></div>
<div class="line">                                 <span class="stringliteral">&quot;-ts_type alpha \n&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">string</span> param_file = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (!<span class="keyword">static_cast&lt;</span><span class="keywordtype">bool</span><span class="keyword">&gt;</span>(ifstream(param_file))) {</div>
<div class="line">    std::ofstream file(param_file.c_str(), std::ios::ate);</div>
<div class="line">    <span class="keywordflow">if</span> (file.is_open()) {</div>
<div class="line">      file &lt;&lt; default_options;</div>
<div class="line">      file.close();</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a name="a43"></a><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file.c_str(), <a class="code" href="nonlinear__dynamics_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add logging channel for example</span></div>
<div class="line">  <span class="keyword">auto</span> core_log = logging::core::get();</div>
<div class="line">  core_log-&gt;add_sink(</div>
<div class="line">      <a name="a44"></a><a class="code" href="structMoFEM_1_1LogManager.html#a1eb7382ca81a927c24b76ffd20134cfd">LogManager::createSink</a>(<a name="a45"></a><a class="code" href="structMoFEM_1_1LogManager.html#a745c3e2cfb9fdea08ecd2e85316e8639">LogManager::getStrmWorld</a>(), <span class="stringliteral">&quot;DYNAMIC&quot;</span>));</div>
<div class="line">  <a name="a46"></a><a class="code" href="group__mofem__log__manager.html#ga037d7b63954d2ec6d367a5c959f16068">LogManager::setLog</a>(<span class="stringliteral">&quot;DYNAMIC&quot;</span>);</div>
<div class="line">  <a name="a47"></a><a class="code" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;DYNAMIC&quot;</span>, <span class="stringliteral">&quot;dynamic&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    <a name="a48"></a><a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> mb_instance;</div>
<div class="line">    <a name="a49"></a><a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = mb_instance;</div>
<div class="line"> </div>
<div class="line">    ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a name="a50"></a><a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <span class="keyword">auto</span> moab_comm_wrap =</div>
<div class="line">        boost::make_shared&lt;WrapMPIComm&gt;(PETSC_COMM_WORLD, <span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (pcomm == NULL)</div>
<div class="line">      pcomm = <span class="keyword">new</span> ParallelComm(&amp;moab, moab_comm_wrap-&gt;get_comm());</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a> base = <a name="a51"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>;</div>
<div class="line">    <span class="keywordtype">char</span> <a name="a52"></a><a class="code" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>[255];</div>
<div class="line">    PetscBool is_partitioned = PETSC_FALSE;</div>
<div class="line">    PetscBool linear = PETSC_TRUE;</div>
<div class="line">    PetscInt disp_order = 1;</div>
<div class="line">    PetscInt vel_order = 1;</div>
<div class="line">    PetscBool is_solve_at_time_zero = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> read_command_line_parameters = [&amp;]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      PetscBool flg = PETSC_TRUE;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a53"></a><a class="code" href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">PetscOptionsGetString</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-my_file&quot;</span>,</div>
<div class="line">                                   <a class="code" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 255, &amp;flg);</div>
<div class="line">      <span class="keywordflow">if</span> (flg != PETSC_TRUE)</div>
<div class="line">        SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;Error -my_file (mesh file needed)&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// use this if your mesh is partitioned and you run code on parts,</span></div>
<div class="line">      <span class="comment">// you can solve very big problems</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a54"></a><a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-my_is_partitioned&quot;</span>,</div>
<div class="line">                                 &amp;is_partitioned, &amp;flg);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-is_linear&quot;</span>, &amp;linear,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">enum</span> bases { LEGENDRE, LOBATTO, BERNSTEIN_BEZIER, LASBASETOP };</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">char</span> *list_bases[] = {<span class="stringliteral">&quot;legendre&quot;</span>, <span class="stringliteral">&quot;lobatto&quot;</span>, <span class="stringliteral">&quot;bernstein_bezier&quot;</span>};</div>
<div class="line">      PetscInt choice_base_value = BERNSTEIN_BEZIER;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a55"></a><a class="code" href="namespaceMoFEM.html#abee82d436d03244c6886fc99f71116f0">PetscOptionsGetEList</a>(PETSC_NULL, NULL, <span class="stringliteral">&quot;-base&quot;</span>, list_bases,</div>
<div class="line">                                  LASBASETOP, &amp;choice_base_value, PETSC_NULL);</div>
<div class="line">      <span class="keywordflow">if</span> (choice_base_value == LEGENDRE)</div>
<div class="line">        base = <a name="a56"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>;</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (choice_base_value == LOBATTO)</div>
<div class="line">        base = <a name="a57"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a6949a4bcc0920ad35e91d7a2d3312988">AINSWORTH_LOBATTO_BASE</a>;</div>
<div class="line">      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (choice_base_value == BERNSTEIN_BEZIER)</div>
<div class="line">        base = <a name="a58"></a><a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-my_disp_order&quot;</span>,</div>
<div class="line">                                &amp;disp_order, &amp;flg);</div>
<div class="line">      <span class="keywordflow">if</span> (flg != PETSC_TRUE)</div>
<div class="line">        disp_order = 1;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-my_vel_order&quot;</span>,</div>
<div class="line">                                &amp;vel_order, &amp;flg);</div>
<div class="line">      <span class="keywordflow">if</span> (flg != PETSC_TRUE)</div>
<div class="line">        vel_order = disp_order;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, PETSC_NULL,</div>
<div class="line">                                 <span class="stringliteral">&quot;-my_solve_at_time_zero&quot;</span>,</div>
<div class="line">                                 &amp;is_solve_at_time_zero, &amp;flg);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> read_mesh = [&amp;]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (is_partitioned == PETSC_TRUE) {</div>
<div class="line">        <span class="comment">// Read mesh to MOAB</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">        option = <span class="stringliteral">&quot;PARALLEL=BCAST_DELETE;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;PARALLEL_RESOLVE_SHARED_ENTS;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;PARTITION=PARALLEL_PARTITION;&quot;</span>;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.load_file(<a class="code" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">        option = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.load_file(<a class="code" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> read_command_line_parameters();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> read_mesh();</div>
<div class="line"> </div>
<div class="line">    <a name="_a59"></a><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line">    <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ref meshset ref level 0</span></div>
<div class="line">    <a name="a60"></a><a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_level0;</div>
<div class="line">    bit_level0.set(0);</div>
<div class="line">    <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_level0;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_level0);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a61"></a><a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a62"></a><a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line">        0, 3, bit_level0);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;getEntitiesByRefLevel(</div>
<div class="line">        bit_level0, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), meshset_level0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Fields</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a63"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <a name="a64"></a><a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,</div>
<div class="line">                             3, MB_TAG_SPARSE, <a name="a65"></a><a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a66"></a><a class="code" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a67"></a><a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 2);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">bool</span> check_if_spatial_field_exist = m_field.<a class="code" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, 3, MB_TAG_SPARSE,</div>
<div class="line">                             <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// add entities (by tets) to the field</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set app. order</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <span class="keywordflow">if</span> (base == <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add nodal force element</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a68"></a><a class="code" href="structMetaNeumannForces.html#ace9c5266987cd42a1d2350e4962e6f1b">MetaNeumannForces::addNeumannBCElements</a>(m_field, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a69"></a><a class="code" href="structMetaEdgeForces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a>(m_field, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a70"></a><a class="code" href="structMetaNodalForces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a>(m_field, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <span class="comment">// Add fluid pressure finite elements</span></div>
<div class="line">    <a name="_a71"></a><a class="code" href="structFluidPressure.html">FluidPressure</a> fluid_pressure_fe(m_field);</div>
<div class="line">    fluid_pressure_fe.addNeumannFluidPressureBCElements(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a name="a72"></a><a class="code" href="namespaceMoFEM.html#a62169d7a96ad4c3a3c421d5e6681c257">addHOOpsFace3D</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, fluid_pressure_fe.getLoopFe(),</div>
<div class="line">                          <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">    fluid_pressure_fe.setNeumannFluidPressureFiniteElementOperators(</div>
<div class="line">        <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, PETSC_NULL, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Velocity</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, 3, MB_TAG_SPARSE, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <span class="keywordflow">if</span> (base == <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;VELOCITY&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, 3, MB_TAG_SPARSE,</div>
<div class="line">                             <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>, disp_order);</div>
<div class="line">    <span class="keywordflow">if</span> (base == <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>,</div>
<div class="line">                                     disp_order);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, base, 3, MB_TAG_SPARSE,</div>
<div class="line">                             <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(0, MBTET, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTET, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBTRI, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBEDGE, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>, vel_order);</div>
<div class="line">    <span class="keywordflow">if</span> (base == <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>, disp_order);</div>
<div class="line">    <span class="keywordflow">else</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(0, MBVERTEX, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set material model and mass element</span></div>
<div class="line">    <a name="_a73"></a><a class="code" href="structNonlinearElasticElement.html">NonlinearElasticElement</a> elastic(m_field, 2);</div>
<div class="line">    <a name="_a74"></a><a class="code" href="structElasticMaterials.html">ElasticMaterials</a> elastic_materials(m_field);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic_materials.setBlocks(elastic.setOfBlocks);</div>
<div class="line">    <span class="comment">// NonlinearElasticElement::FunctionsToCalculatePiolaKirchhoffI&lt;adouble&gt;</span></div>
<div class="line">    <span class="comment">// st_venant_kirchhoff_material_adouble;</span></div>
<div class="line">    <span class="comment">// NonlinearElasticElement::FunctionsToCalculatePiolaKirchhoffI&lt;double&gt;</span></div>
<div class="line">    <span class="comment">// st_venant_kirchhoff_material_double;  CHKERR</span></div>
<div class="line">    <span class="comment">// elastic.setBlocks(&amp;st_venant_kirchhoff_material_double,&amp;st_venant_kirchhoff_material_adouble);</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic.addElement(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, elastic.getLoopFeRhs(), <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line">                    <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, elastic.getLoopFeLhs(), <span class="keyword">true</span>, <span class="keyword">false</span>,</div>
<div class="line">                    <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, elastic.getLoopFeEnergy(), <span class="keyword">true</span>,</div>
<div class="line">                    <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic.setOperators(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, <span class="keyword">false</span>,</div>
<div class="line">                                <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set mass element</span></div>
<div class="line">    <a name="_a75"></a><a class="code" href="structConvectiveMassElement.html">ConvectiveMassElement</a> inertia(m_field, 1);</div>
<div class="line">    <span class="comment">// CHKERR inertia.setBlocks();</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic_materials.setBlocks(inertia.setOfBlocks);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> inertia.addConvectiveMassElement(<span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>,</div>
<div class="line">                                            <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> inertia.addVelocityElement(<span class="stringliteral">&quot;VELOCITY_ELEMENT&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>,</div>
<div class="line">                                      <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add possibility to load accelerogram</span></div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">string</span> name = <span class="stringliteral">&quot;-my_accelerogram&quot;</span>;</div>
<div class="line">      <span class="keywordtype">char</span> time_file_name[255];</div>
<div class="line">      PetscBool flg;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">PetscOptionsGetString</a>(PETSC_NULL, PETSC_NULL, name.c_str(),</div>
<div class="line">                                   time_file_name, 255, &amp;flg);</div>
<div class="line">      <span class="keywordflow">if</span> (flg == PETSC_TRUE) {</div>
<div class="line">        inertia.methodsOp.push_back(<span class="keyword">new</span> <a name="_a76"></a><a class="code" href="structTimeAccelerogram.html">TimeAccelerogram</a>(name));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// damper element</span></div>
<div class="line">    <a name="_a77"></a><a class="code" href="structKelvinVoigtDamper.html">KelvinVoigtDamper</a> damper(m_field);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> elastic_materials.setBlocks(damper.blockMaterialDataMap);</div>
<div class="line">    {</div>
<div class="line">      <a name="_a78"></a><a class="code" href="structKelvinVoigtDamper_1_1CommonData.html">KelvinVoigtDamper::CommonData</a> &amp;common_data = damper.commonData;</div>
<div class="line">      common_data.<a name="a79"></a><a class="code" href="structKelvinVoigtDamper_1_1CommonData.html#aa243fcd6f0be6637140b9bc7eea92366">spatialPositionName</a> = <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>;</div>
<div class="line">      common_data.<a name="a80"></a><a class="code" href="structKelvinVoigtDamper_1_1CommonData.html#a6c62c8053fc3bd956a677d1a7f1d47b9">spatialPositionNameDot</a> = <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a81"></a><a class="code" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;DAMPER&quot;</span>, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a82"></a><a class="code" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;DAMPER&quot;</span>,</div>
<div class="line">                                                         <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a83"></a><a class="code" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;DAMPER&quot;</span>,</div>
<div class="line">                                                         <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a84"></a><a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;DAMPER&quot;</span>,</div>
<div class="line">                                                          <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (m_field.<a class="code" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>)) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(</div>
<div class="line">            <span class="stringliteral">&quot;DAMPER&quot;</span>, <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      std::map&lt;int, KelvinVoigtDamper::BlockMaterialData&gt;::iterator <a name="a85"></a><a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> =</div>
<div class="line">          damper.blockMaterialDataMap.begin();</div>
<div class="line">      <span class="keywordflow">for</span> (; <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> != damper.blockMaterialDataMap.end(); <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>++) {</div>
<div class="line">        <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;second.lInear = linear;</div>
<div class="line">        <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;first;</div>
<div class="line">        <a name="_a86"></a><a class="code" href="structKelvinVoigtDamper_1_1BlockMaterialData.html">KelvinVoigtDamper::BlockMaterialData</a> &amp;material_data = <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;second;</div>
<div class="line">        damper.constitutiveEquationMap.insert(</div>
<div class="line">            <span class="keywordtype">id</span>, <span class="keyword">new</span> <a name="_a87"></a><a class="code" href="structKelvinVoigtDamper_1_1ConstitutiveEquation.html">KelvinVoigtDamper::ConstitutiveEquation&lt;adouble&gt;</a>(</div>
<div class="line">                    material_data));</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a88"></a><a class="code" href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">add_ents_to_finite_element_by_type</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>-&gt;second.tEts,</div>
<div class="line">                                                          MBTET, <span class="stringliteral">&quot;DAMPER&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> damper.setOperators(3);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structMonitorPostProc.html">MonitorPostProc</a> post_proc(m_field, elastic.setOfBlocks,</div>
<div class="line">                              elastic.getLoopFeEnergy(),</div>
<div class="line">                              inertia.getLoopFeEnergy());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// elastic and mass element calculated in Kuu shell matrix problem. To</span></div>
<div class="line">    <span class="comment">// calculate Mass element, velocity field is needed.</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;ELASTIC&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;ELASTIC&quot;</span>,</div>
<div class="line">                                                        <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build field</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a89"></a><a class="code" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line">    <span class="comment">// CHKERR m_field.list_dofs_by_field_name(&quot;DISPLACEMENT&quot;);</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// 10 node tets</span></div>
<div class="line">    <span class="keywordflow">if</span> (!check_if_spatial_field_exist) {</div>
<div class="line">      <a name="_a90"></a><a class="code" href="structMoFEM_1_1Projection10NodeCoordsOnField.html">Projection10NodeCoordsOnField</a> ent_method_material(m_field,</div>
<div class="line">                                                        <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a91"></a><a class="code" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, ent_method_material);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build finite elements</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a92"></a><a class="code" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>();</div>
<div class="line">    <span class="comment">// build adjacencies</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a93"></a><a class="code" href="structMoFEM_1_1CoreInterface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(bit_level0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// define problems</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a94"></a><a class="code" href="group__mofem__problems.html#ga6afc6820fa64d4ceb733bd778adb925a">add_problem</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a95"></a><a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <span class="stringliteral">&quot;PRESSURE_FE&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <span class="stringliteral">&quot;FORCE_FE&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;Kuu&quot;</span>,</div>
<div class="line">                                                       <span class="stringliteral">&quot;FLUID_PRESSURE_FE&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a96"></a><a class="code" href="group__mofem__problems.html#gab02fceb7ce0b4be564ff8b2c7144ba12">modify_problem_ref_level_add_bit</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, bit_level0);</div>
<div class="line"> </div>
<div class="line">      <a name="_a97"></a><a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a> *prb_mng_ptr;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(prb_mng_ptr);</div>
<div class="line">      <span class="keywordflow">if</span> (is_partitioned) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a name="a98"></a><a class="code" href="group__mofem__problems__manager.html#ga0eed1a1aa1677044038c562cdd1aeb0f">buildProblemOnDistributedMesh</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a name="a99"></a><a class="code" href="group__mofem__problems__manager.html#gabfd48a196686d30eeacb978b81d1a656">partitionFiniteElements</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <span class="keyword">true</span>, 0,</div>
<div class="line">                                                    pcomm-&gt;size());</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a name="a100"></a><a class="code" href="group__mofem__problems__manager.html#ga98070af58a9cd97f9202c6488698ba96">buildProblem</a>(<span class="stringliteral">&quot;Kuu&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a name="a101"></a><a class="code" href="group__mofem__problems__manager.html#gaa0e280c88443b6240bf3255c0dce0ef2">partitionProblem</a>(<span class="stringliteral">&quot;Kuu&quot;</span>);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#gabfd48a196686d30eeacb978b81d1a656">partitionFiniteElements</a>(<span class="stringliteral">&quot;Kuu&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a name="a102"></a><a class="code" href="group__mofem__problems__manager.html#ga20ecb1883ad47d08f22a66d871a48114">partitionGhostDofs</a>(<span class="stringliteral">&quot;Kuu&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#ga6afc6820fa64d4ceb733bd778adb925a">add_problem</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// set finite elements for problems</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;ELASTIC&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;DAMPER&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;PRESSURE_FE&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;FORCE_FE&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;FLUID_PRESSURE_FE&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">modify_problem_add_finite_element</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>,</div>
<div class="line">                                                     <span class="stringliteral">&quot;VELOCITY_ELEMENT&quot;</span>);</div>
<div class="line">    <span class="comment">// set refinement level for problem</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="group__mofem__problems.html#gab02fceb7ce0b4be564ff8b2c7144ba12">modify_problem_ref_level_add_bit</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, bit_level0);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a> *prb_mng_ptr;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(prb_mng_ptr);</div>
<div class="line">    <span class="keywordflow">if</span> (is_partitioned) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#ga0eed1a1aa1677044038c562cdd1aeb0f">buildProblemOnDistributedMesh</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#gabfd48a196686d30eeacb978b81d1a656">partitionFiniteElements</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="keyword">true</span>, 0,</div>
<div class="line">                                                  pcomm-&gt;size());</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#ga98070af58a9cd97f9202c6488698ba96">buildProblem</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="keyword">true</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#gaa0e280c88443b6240bf3255c0dce0ef2">partitionProblem</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#gabfd48a196686d30eeacb978b81d1a656">partitionFiniteElements</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng_ptr-&gt;<a class="code" href="group__mofem__problems__manager.html#ga20ecb1883ad47d08f22a66d871a48114">partitionGhostDofs</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a name="a103"></a><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a name="a104"></a><a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a105"></a><a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;vecCreateGhost(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, <a name="a106"></a><a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>,</div>
<div class="line">                                                              &amp;<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">    <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a name="a107"></a><a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, &amp;<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// create tS</span></div>
<div class="line">    TS ts;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSCreate(PETSC_COMM_WORLD, &amp;ts);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetType(ts, TSBEULER);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// shell matrix</span></div>
<div class="line">    <a name="_a108"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html">ConvectiveMassElement::MatShellCtx</a> *shellAij_ctx =</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html">ConvectiveMassElement::MatShellCtx</a>();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a109"></a><a class="code" href="structMoFEM_1_1MatrixManager.html">MatrixManager</a>&gt;()</div>
<div class="line">        -&gt;createMPIAIJWithArrays&lt;PetscGlobalIdx_mi_tag&gt;(<span class="stringliteral">&quot;Kuu&quot;</span>,</div>
<div class="line">                                                        &amp;shellAij_ctx-&gt;<a name="a110"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a5e6a1ed717a76551ba1c4af75ef483f1">K</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDuplicate(shellAij_ctx-&gt;<a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a5e6a1ed717a76551ba1c4af75ef483f1">K</a>, MAT_DO_NOT_COPY_VALUES,</div>
<div class="line">                        &amp;shellAij_ctx-&gt;<a name="a111"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#aa00dbfa4fd7901bce7909d8bbaa706e4">M</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> shellAij_ctx-&gt;<a name="a112"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a7839553ba4c17aea2b155c2bfde5185b">iNit</a>();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;vecScatterCreate(</div>
<div class="line">        <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, <span class="stringliteral">&quot;DYNAMICS&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, shellAij_ctx-&gt;<a name="a113"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a51af5eaec4d239d0312608d067e47e93">u</a>, <span class="stringliteral">&quot;Kuu&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>,</div>
<div class="line">        &amp;shellAij_ctx-&gt;<a name="a114"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a893cd2415fae91d745a194be0e381671">scatterU</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;vecScatterCreate(</div>
<div class="line">        <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, <span class="stringliteral">&quot;DYNAMICS&quot;</span>, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, shellAij_ctx-&gt;<a name="a115"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a3f2e0faf3ff6159d97f666ba54f24c82">v</a>, <span class="stringliteral">&quot;Kuu&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>,</div>
<div class="line">        <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, &amp;shellAij_ctx-&gt;<a name="a116"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a2f574060431d44b1d1fc43efb0bbf1c4">scatterV</a>);</div>
<div class="line">    Mat shell_Aij;</div>
<div class="line">    <span class="keyword">const</span> <a name="_a117"></a><a class="code" href="structMoFEM_1_1Problem.html">Problem</a> *problem_ptr;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a name="a118"></a><a class="code" href="group__mofem__access.html#gae2f23388a21a25d68e4f62a5e5259e06">get_problem</a>(<span class="stringliteral">&quot;DYNAMICS&quot;</span>, &amp;problem_ptr);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatCreateShell(</div>
<div class="line">        PETSC_COMM_WORLD, problem_ptr-&gt;<a name="a119"></a><a class="code" href="structMoFEM_1_1Problem.html#a1c7d8024651ef955a03d2e2e4753c1c9">getNbLocalDofsRow</a>(),</div>
<div class="line">        problem_ptr-&gt;<a name="a120"></a><a class="code" href="structMoFEM_1_1Problem.html#ab0d05db502892988fb713aa6dcb3e7d9">getNbLocalDofsCol</a>(), problem_ptr-&gt;<a name="a121"></a><a class="code" href="structMoFEM_1_1Problem.html#a271a2096c19f1b94383edc0b4e2e2060">getNbDofsRow</a>(),</div>
<div class="line">        problem_ptr-&gt;<a class="code" href="structMoFEM_1_1Problem.html#a271a2096c19f1b94383edc0b4e2e2060">getNbDofsRow</a>(), (<span class="keywordtype">void</span> *)shellAij_ctx, &amp;shell_Aij);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatShellSetOperation(shell_Aij, MATOP_MULT,</div>
<div class="line">                                (<span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span>))<a name="a122"></a><a class="code" href="structConvectiveMassElement.html#a02a281fd26fffbe425b3fbb7824c5c6d">ConvectiveMassElement::MultOpA</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatShellSetOperation(</div>
<div class="line">        shell_Aij, MATOP_ZERO_ENTRIES,</div>
<div class="line">        (<span class="keywordtype">void</span> (*)(<span class="keywordtype">void</span>))<a name="a123"></a><a class="code" href="structConvectiveMassElement.html#a0f04337aa08c66032a696c5961504726">ConvectiveMassElement::ZeroEntriesOp</a>);</div>
<div class="line">    <span class="comment">// blocked problem</span></div>
<div class="line">    ConvectiveMassElement::ShellMatrixElement shell_matrix_element(m_field);</div>
<div class="line">    <a name="_a124"></a><a class="code" href="structDirichletDisplacementBc.html">DirichletDisplacementBc</a> shell_dirichlet_bc(</div>
<div class="line">        m_field, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, shellAij_ctx-&gt;<a name="a125"></a><a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#ae66e41f5f48f2972cb66ac835356c8c5">barK</a>, PETSC_NULL, PETSC_NULL);</div>
<div class="line">    <a class="code" href="structDirichletDisplacementBc.html">DirichletDisplacementBc</a> my_dirichlet_bc(m_field, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, PETSC_NULL,</div>
<div class="line">                                            <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">    shell_matrix_element.problemName = <span class="stringliteral">&quot;Kuu&quot;</span>;</div>
<div class="line">    shell_matrix_element.shellMatCtx = shellAij_ctx;</div>
<div class="line">    shell_matrix_element.DirichletBcPtr = &amp;shell_dirichlet_bc;</div>
<div class="line">    shell_matrix_element.loopK.push_back(</div>
<div class="line">        ConvectiveMassElement::ShellMatrixElement::PairNameFEMethodPtr(</div>
<div class="line">            <span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;elastic.getLoopFeLhs()));</div>
<div class="line">    <span class="comment">// damper</span></div>
<div class="line">    shell_matrix_element.loopK.push_back(</div>
<div class="line">        ConvectiveMassElement::ShellMatrixElement::PairNameFEMethodPtr(</div>
<div class="line">            <span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;damper.feLhs));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> inertia.addHOOpsVol();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> inertia.setShellMatrixMassOperators(<span class="stringliteral">&quot;VELOCITY&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>,</div>
<div class="line">                                               <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, linear);</div>
<div class="line">    <span class="comment">// element name &quot;ELASTIC&quot; is used, therefore M matrix is assembled as K</span></div>
<div class="line">    <span class="comment">// matrix. This is added to M is shell matrix. M matrix is a derivative of</span></div>
<div class="line">    <span class="comment">// inertia forces over spatial velocities</span></div>
<div class="line">    shell_matrix_element.loopM.push_back(</div>
<div class="line">        ConvectiveMassElement::ShellMatrixElement::PairNameFEMethodPtr(</div>
<div class="line">            <span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;inertia.getLoopFeMassLhs()));</div>
<div class="line">    <span class="comment">// this calculate derivatives of inertia forces over spatial positions and</span></div>
<div class="line">    <span class="comment">// add this to shell K matrix</span></div>
<div class="line">    shell_matrix_element.loopAuxM.push_back(</div>
<div class="line">        ConvectiveMassElement::ShellMatrixElement::PairNameFEMethodPtr(</div>
<div class="line">            <span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;inertia.getLoopFeMassAuxLhs()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Element to calculate shell matrix residual</span></div>
<div class="line">    <a name="_a126"></a><a class="code" href="structConvectiveMassElement_1_1ShellResidualElement.html">ConvectiveMassElement::ShellResidualElement</a> shell_matrix_residual(m_field);</div>
<div class="line">    shell_matrix_residual.shellMatCtx = shellAij_ctx;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// surface pressure</span></div>
<div class="line">    boost::ptr_map&lt;std::string, NeumannForcesSurface&gt; surface_forces;</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">string</span> fe_name_str = <span class="stringliteral">&quot;FORCE_FE&quot;</span>;</div>
<div class="line">      surface_forces.insert(fe_name_str, <span class="keyword">new</span> <a name="_a127"></a><a class="code" href="structNeumannForcesSurface.html">NeumannForcesSurface</a>(m_field));</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a62169d7a96ad4c3a3c421d5e6681c257">addHOOpsFace3D</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,</div>
<div class="line">                            surface_forces.at(fe_name_str).getLoopFe(), <span class="keyword">false</span>,</div>
<div class="line">                            <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (<a name="a128"></a><a class="code" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(m_field,</div>
<div class="line">                                                      <a name="a129"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a> | <a name="a130"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca4ab4a7e6c2c0f87be80aa8ccc963c6f6">FORCESET</a>, it)) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> surface_forces.at(fe_name_str)</div>
<div class="line">            .addForce(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, PETSC_NULL, it-&gt;getMeshsetId(), <span class="keyword">true</span>);</div>
<div class="line">        surface_forces.at(fe_name_str)</div>
<div class="line">            .methodsOp.push_back(<span class="keyword">new</span> <a name="_a131"></a><a class="code" href="structTimeForceScale.html">TimeForceScale</a>());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    boost::ptr_map&lt;std::string, NeumannForcesSurface&gt; surface_pressure;</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">string</span> fe_name_str = <span class="stringliteral">&quot;PRESSURE_FE&quot;</span>;</div>
<div class="line">      surface_pressure.insert(fe_name_str, <span class="keyword">new</span> <a class="code" href="structNeumannForcesSurface.html">NeumannForcesSurface</a>(m_field));</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a62169d7a96ad4c3a3c421d5e6681c257">addHOOpsFace3D</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>,</div>
<div class="line">                            surface_pressure.at(fe_name_str).getLoopFe(), <span class="keyword">false</span>,</div>
<div class="line">                            <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(</div>
<div class="line">               m_field, <a name="a132"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a> | <a name="a133"></a><a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca1aacb952ebfd7b0ad16085a9bf1fcf0a">PRESSURESET</a>, it)) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> surface_pressure.at(fe_name_str)</div>
<div class="line">            .addPressure(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, PETSC_NULL, it-&gt;getMeshsetId(), <span class="keyword">true</span>);</div>
<div class="line">        surface_pressure.at(fe_name_str)</div>
<div class="line">            .methodsOp.push_back(<span class="keyword">new</span> <a class="code" href="structTimeForceScale.html">TimeForceScale</a>());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// edge forces</span></div>
<div class="line">    boost::ptr_map&lt;std::string, EdgeForce&gt; edge_forces;</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">string</span> fe_name_str = <span class="stringliteral">&quot;FORCE_FE&quot;</span>;</div>
<div class="line">      edge_forces.insert(fe_name_str, <span class="keyword">new</span> <a name="_a134"></a><a class="code" href="structEdgeForce.html">EdgeForce</a>(m_field));</div>
<div class="line">      <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(m_field,</div>
<div class="line">                                                      <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a> | <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca4ab4a7e6c2c0f87be80aa8ccc963c6f6">FORCESET</a>, it)) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> edge_forces.at(fe_name_str)</div>
<div class="line">            .addForce(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, PETSC_NULL, it-&gt;getMeshsetId(), <span class="keyword">true</span>);</div>
<div class="line">        edge_forces.at(fe_name_str).methodsOp.push_back(<span class="keyword">new</span> <a class="code" href="structTimeForceScale.html">TimeForceScale</a>());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// nodal forces</span></div>
<div class="line">    boost::ptr_map&lt;std::string, NodalForce&gt; nodal_forces;</div>
<div class="line">    {</div>
<div class="line">      <span class="keywordtype">string</span> fe_name_str = <span class="stringliteral">&quot;FORCE_FE&quot;</span>;</div>
<div class="line">      nodal_forces.insert(fe_name_str, <span class="keyword">new</span> <a name="_a135"></a><a class="code" href="structNodalForce.html">NodalForce</a>(m_field));</div>
<div class="line">      <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(m_field,</div>
<div class="line">                                                      <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a> | <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca4ab4a7e6c2c0f87be80aa8ccc963c6f6">FORCESET</a>, it)) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> nodal_forces.at(fe_name_str)</div>
<div class="line">            .addForce(<span class="stringliteral">&quot;DISPLACEMENT&quot;</span>, <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, it-&gt;getMeshsetId(), <span class="keyword">true</span>);</div>
<div class="line">        nodal_forces.at(fe_name_str).methodsOp.push_back(<span class="keyword">new</span> <a class="code" href="structTimeForceScale.html">TimeForceScale</a>());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structMonitorRestart.html">MonitorRestart</a> monitor_restart(m_field, ts);</div>
<div class="line">    <a name="_a136"></a><a class="code" href="structConvectiveMassElement_1_1UpdateAndControl.html">ConvectiveMassElement::UpdateAndControl</a> update_and_control(</div>
<div class="line">        m_field, ts, <span class="stringliteral">&quot;VELOCITY&quot;</span>, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// TS</span></div>
<div class="line">    <a name="_a137"></a><a class="code" href="structMoFEM_1_1TsCtx.html">TsCtx</a> <a name="a138"></a><a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>(m_field, <span class="stringliteral">&quot;DYNAMICS&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// right hand side</span></div>
<div class="line">    <span class="comment">// preprocess</span></div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a name="a139"></a><a class="code" href="structMoFEM_1_1TsCtx.html#a881d04eb27d8ab3ced76bc98b6fd26b3">getPreProcessIFunction</a>().push_back(&amp;update_and_control);</div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a class="code" href="structMoFEM_1_1TsCtx.html#a881d04eb27d8ab3ced76bc98b6fd26b3">getPreProcessIFunction</a>().push_back(&amp;my_dirichlet_bc);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// fe looops</span></div>
<div class="line">    <span class="keyword">auto</span> &amp;loops_to_do_Rhs = <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a name="a140"></a><a class="code" href="structMoFEM_1_1TsCtx.html#a22909ce009e78fa1db0615ed913dc5e4">getLoopsIFunction</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> add_static_rhs = [&amp;](<span class="keyword">auto</span> &amp;loops_to_do_Rhs) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      loops_to_do_Rhs.push_back(</div>
<div class="line">          <a name="_a141"></a><a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(<span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;elastic.getLoopFeRhs()));</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> fit = surface_forces.begin(); fit != surface_forces.end();</div>
<div class="line">           fit++) {</div>
<div class="line">        loops_to_do_Rhs.push_back(</div>
<div class="line">            <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(fit-&gt;first, &amp;fit-&gt;second-&gt;getLoopFe()));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> fit = surface_pressure.begin(); fit != surface_pressure.end();</div>
<div class="line">           fit++) {</div>
<div class="line">        loops_to_do_Rhs.push_back(</div>
<div class="line">            <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(fit-&gt;first, &amp;fit-&gt;second-&gt;getLoopFe()));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> fit = edge_forces.begin(); fit != edge_forces.end(); fit++) {</div>
<div class="line">        loops_to_do_Rhs.push_back(</div>
<div class="line">            <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(fit-&gt;first, &amp;fit-&gt;second-&gt;getLoopFe()));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> fit = nodal_forces.begin(); fit != nodal_forces.end(); fit++) {</div>
<div class="line">        loops_to_do_Rhs.push_back(</div>
<div class="line">            <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(fit-&gt;first, &amp;fit-&gt;second-&gt;getLoopFe()));</div>
<div class="line">      }</div>
<div class="line">      loops_to_do_Rhs.push_back(<a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(</div>
<div class="line">          <span class="stringliteral">&quot;FLUID_PRESSURE_FE&quot;</span>, &amp;fluid_pressure_fe.getLoopFe()));</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_static_rhs(loops_to_do_Rhs);</div>
<div class="line"> </div>
<div class="line">    loops_to_do_Rhs.push_back(<a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(<span class="stringliteral">&quot;DAMPER&quot;</span>, &amp;damper.feRhs));</div>
<div class="line">    loops_to_do_Rhs.push_back(</div>
<div class="line">        <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">PairNameFEMethodPtr</a>(<span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>, &amp;inertia.getLoopFeMassRhs()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// preporcess</span></div>
<div class="line">    <span class="comment">// calculate residual for velocities</span></div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a class="code" href="structMoFEM_1_1TsCtx.html#a881d04eb27d8ab3ced76bc98b6fd26b3">getPreProcessIFunction</a>().push_back(&amp;shell_matrix_residual); </div>
<div class="line">    <span class="comment">// postprocess</span></div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a name="a142"></a><a class="code" href="structMoFEM_1_1TsCtx.html#a602e2873e82737d021991fb9eca1fbb3">getPostProcessIFunction</a>().push_back(&amp;my_dirichlet_bc);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// left hand side</span></div>
<div class="line">    <span class="comment">// preprocess</span></div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a name="a143"></a><a class="code" href="structMoFEM_1_1TsCtx.html#aef7269f120efd788539812c2f9934984">getPreProcessIJacobian</a>().push_back(&amp;update_and_control);</div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a class="code" href="structMoFEM_1_1TsCtx.html#aef7269f120efd788539812c2f9934984">getPreProcessIJacobian</a>().push_back(&amp;shell_matrix_element);</div>
<div class="line">    <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a name="a144"></a><a class="code" href="structMoFEM_1_1TsCtx.html#aadaf54ad0202b4d7f31376bf7f3fdc91">getPostProcessIJacobian</a>().push_back(&amp;update_and_control);</div>
<div class="line">    <span class="comment">// monitor</span></div>
<div class="line">    <a class="code" href="structMoFEM_1_1TsCtx.html#a24e74c25004733c09e0dbcc0d90eb3af">TsCtx::FEMethodsSequence</a> &amp;loopsMonitor =</div>
<div class="line">        <a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.<a name="a145"></a><a class="code" href="structMoFEM_1_1TsCtx.html#a4128e8771499a7dcaf4b224a2d3d2a14">getLoopsMonitor</a>();</div>
<div class="line">    loopsMonitor.push_back(</div>
<div class="line">        <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">TsCtx::PairNameFEMethodPtr</a>(<span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>, &amp;post_proc));</div>
<div class="line">    loopsMonitor.push_back(</div>
<div class="line">        <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">TsCtx::PairNameFEMethodPtr</a>(<span class="stringliteral">&quot;MASS_ELEMENT&quot;</span>, &amp;monitor_restart));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIFunction(ts, <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a name="a146"></a><a class="code" href="namespaceMoFEM.html#a65f22030e64fd429012bf8f0f025d9a1">TsSetIFunction</a>, &amp;<a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIJacobian(ts, shell_Aij, shell_Aij, <a name="a147"></a><a class="code" href="namespaceMoFEM.html#a12477157e716aece7dd7b3e316fef7a3">TsSetIJacobian</a>, &amp;<a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, <a name="a148"></a><a class="code" href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">TsMonitorSet</a>, &amp;<a class="code" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDuration(ts, PETSC_DEFAULT, ftime);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line">    <span class="comment">// shell matrix pre-conditioner</span></div>
<div class="line">    SNES snes;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">    <span class="comment">// CHKERR SNESSetFromOptions(snes);</span></div>
<div class="line">    KSP ksp;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetKSP(snes, &amp;ksp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(ksp);</div>
<div class="line">    PC pc;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(ksp, &amp;pc);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetType(pc, PCSHELL);</div>
<div class="line">    <a name="_a149"></a><a class="code" href="structConvectiveMassElement_1_1PCShellCtx.html">ConvectiveMassElement::PCShellCtx</a> pc_shell_ctx(shell_Aij);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCShellSetContext(pc, (<span class="keywordtype">void</span> *)&amp;pc_shell_ctx);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCShellSetApply(pc, <a name="a150"></a><a class="code" href="structConvectiveMassElement.html#a449bff5aa621647935c184cef1e29c61">ConvectiveMassElement::PCShellApplyOp</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCShellSetSetUp(pc, <a name="a151"></a><a class="code" href="structConvectiveMassElement.html#ab0ea7a73d99beba1d4b4097baebe1484">ConvectiveMassElement::PCShellSetUpOp</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCShellSetDestroy(pc, <a name="a152"></a><a class="code" href="structConvectiveMassElement.html#a2abdfa353006f481e79a932b3af1a602">ConvectiveMassElement::PCShellDestroy</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;setGlobalGhostVector(</div>
<div class="line">        <span class="stringliteral">&quot;DYNAMICS&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve problem at time Zero</span></div>
<div class="line">    <span class="keywordflow">if</span> (is_solve_at_time_zero) {</div>
<div class="line"> </div>
<div class="line">      Mat Aij = shellAij_ctx-&gt;<a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a5e6a1ed717a76551ba1c4af75ef483f1">K</a>;</div>
<div class="line">      <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;vecCreateGhost(<span class="stringliteral">&quot;Kuu&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, &amp;<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, &amp;<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">      </div>
<div class="line">      <span class="comment">// Set vector for Kuu problem from the mesh data</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;setLocalGhostVector(</div>
<div class="line">          <span class="stringliteral">&quot;Kuu&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">      <a name="_a153"></a><a class="code" href="structMoFEM_1_1SnesCtx.html">SnesCtx</a> snes_ctx(m_field, <span class="stringliteral">&quot;Kuu&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      SNES snes;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESCreate(PETSC_COMM_WORLD, &amp;snes);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetApplicationContext(snes, &amp;snes_ctx);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFunction(snes, <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a name="a154"></a><a class="code" href="namespaceMoFEM.html#a50531f1fc6bfb68b4756a88126df316e">SnesRhs</a>, &amp;snes_ctx);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetJacobian(snes, Aij, Aij, <a name="a155"></a><a class="code" href="namespaceMoFEM.html#a2427b40a8745afeb2073f72d9d51584e">SnesMat</a>, &amp;snes_ctx);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFromOptions(snes);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structDirichletDisplacementBc.html">DirichletDisplacementBc</a> my_dirichlet_bc(m_field, <span class="stringliteral">&quot;DISPLACEMENT&quot;</span>,</div>
<div class="line">                                              PETSC_NULL, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structMoFEM_1_1SnesCtx.html#a7073c85ff8833f808af680f72616cb2f">SnesCtx::FEMethodsSequence</a> &amp;loops_to_do_Rhs =</div>
<div class="line">          snes_ctx.getComputeRhs();</div>
<div class="line">      snes_ctx.getPreProcComputeRhs().push_back(&amp;my_dirichlet_bc);</div>
<div class="line">      fluid_pressure_fe.getLoopFe().ts_t = 0;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_static_rhs(loops_to_do_Rhs);</div>
<div class="line">      snes_ctx.getPostProcComputeRhs().push_back(&amp;my_dirichlet_bc);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structMoFEM_1_1SnesCtx.html#a7073c85ff8833f808af680f72616cb2f">SnesCtx::FEMethodsSequence</a> &amp;loops_to_do_Mat =</div>
<div class="line">          snes_ctx.getSetOperators();</div>
<div class="line">      snes_ctx.getPreProcSetOperators().push_back(&amp;my_dirichlet_bc);</div>
<div class="line">      loops_to_do_Mat.push_back(</div>
<div class="line">          <a class="code" href="structMoFEM_1_1PairNameFEMethodPtr.html">SnesCtx::PairNameFEMethodPtr</a>(<span class="stringliteral">&quot;ELASTIC&quot;</span>, &amp;elastic.getLoopFeLhs()));</div>
<div class="line">      snes_ctx.getPostProcSetOperators().push_back(&amp;my_dirichlet_bc);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a name="_a156"></a><a class="code" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;fieldScale(0, <span class="stringliteral">&quot;VELOCITY&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;fieldScale(0,</div>
<div class="line">                                                           <span class="stringliteral">&quot;DOT_DISPLACEMENT&quot;</span>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;fieldScale(0, <span class="stringliteral">&quot;DOT_VELOCITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;setLocalGhostVector(</div>
<div class="line">          <span class="stringliteral">&quot;Kuu&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSolve(snes, PETSC_NULL, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">      <span class="keywordtype">int</span> its;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetIterationNumber(snes, &amp;its);</div>
<div class="line">      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;DYNAMIC&quot;</span>, Sev::inform, <span class="stringliteral">&quot;number of Newton iterations = %d\n&quot;</span>,</div>
<div class="line">                  its);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Set data on the mesh</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;setGlobalGhostVector(</div>
<div class="line">          <span class="stringliteral">&quot;Kuu&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESDestroy(&amp;snes);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (is_solve_at_time_zero) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1VecManager.html">VecManager</a>&gt;()-&gt;setLocalGhostVector(</div>
<div class="line">          <span class="stringliteral">&quot;DYNAMICS&quot;</span>, <a class="code" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#if PETSC_VERSION_GE(3, 7, 0)</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetExactFinalTime(ts, TS_EXACTFINALTIME_STEPOVER);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTime(ts, &amp;ftime);</div>
<div class="line"> </div>
<div class="line">    PetscInt steps, snesfails, rejects, nonlinits, linits;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStepNumber(ts, &amp;steps);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESFailures(ts, &amp;snesfails);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepRejections(ts, &amp;rejects);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESIterations(ts, &amp;nonlinits);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetKSPIterations(ts, &amp;linits);</div>
<div class="line">    <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;DYNAMIC&quot;</span>, Sev::inform,</div>
<div class="line">                <span class="stringliteral">&quot;steps %d (%d rejected, %D SNES fails), ftime %g, nonlinits &quot;</span></div>
<div class="line">                <span class="stringliteral">&quot;%d, linits %D\n&quot;</span>,</div>
<div class="line">                steps, rejects, snesfails, ftime, nonlinits, linits);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSDestroy(&amp;ts);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;shellAij_ctx-&gt;<a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a5e6a1ed717a76551ba1c4af75ef483f1">K</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;shellAij_ctx-&gt;<a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#aa00dbfa4fd7901bce7909d8bbaa706e4">M</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterDestroy(&amp;shellAij_ctx-&gt;<a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a893cd2415fae91d745a194be0e381671">scatterU</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterDestroy(&amp;shellAij_ctx-&gt;<a class="code" href="structConvectiveMassElement_1_1MatShellCtx.html#a2f574060431d44b1d1fc43efb0bbf1c4">scatterV</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;shell_Aij);</div>
<div class="line">    <span class="keyword">delete</span> shellAij_ctx;</div>
<div class="line">  }</div>
<div class="line">  <a name="a157"></a><a class="code" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a name="a158"></a><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a62169d7a96ad4c3a3c421d5e6681c257"><div class="ttname"><a href="namespaceMoFEM.html#a62169d7a96ad4c3a3c421d5e6681c257">MoFEM::addHOOpsFace3D</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsFace3D(const std::string field, E &amp;e, bool hcurl, bool hdiv)</div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00699">HODataOperators.hpp:699</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a></div><div class="ttdeci">@ SIDESET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00160">definitions.h:160</a></div></div>
<div class="ttc" id="agroup__mofem__loops_html_gab3dc3302de79f29b26605579d77797c9"><div class="ttname"><a href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">MoFEM::CoreInterface::loop_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_finite_elements(const std::string problem_name, const std::string &amp;fe_name, FEMethod &amp;method, boost::shared_ptr&lt; NumeredEntFiniteElement_multiIndex &gt; fe_ptr=nullptr, MoFEMTypes bh=MF_EXIST, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr(), int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over finite elements.</div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="astructMetaNeumannForces_html_ace9c5266987cd42a1d2350e4962e6f1b"><div class="ttname"><a href="structMetaNeumannForces.html#ace9c5266987cd42a1d2350e4962e6f1b">MetaNeumannForces::addNeumannBCElements</a></div><div class="ttdeci">static MoFEMErrorCode addNeumannBCElements(MoFEM::Interface &amp;m_field, const std::string field_name, const std::string mesh_nodals_positions=&quot;MESH_NODE_POSITIONS&quot;, Range *intersect_ptr=NULL)</div><div class="ttdoc">Declare finite element.</div><div class="ttdef"><b>Definition:</b> <a href="SurfacePressure_8cpp_source.html#l01974">SurfacePressure.cpp:1974</a></div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_ga98070af58a9cd97f9202c6488698ba96"><div class="ttname"><a href="group__mofem__problems__manager.html#ga98070af58a9cd97f9202c6488698ba96">MoFEM::ProblemsManager::buildProblem</a></div><div class="ttdeci">MoFEMErrorCode buildProblem(const std::string name, const bool square_matrix, int verb=VERBOSE)</div><div class="ttdoc">build problem data structures</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8cpp_source.html#l00087">ProblemsManager.cpp:87</a></div></div>
<div class="ttc" id="astructKelvinVoigtDamper_1_1CommonData_html_a6c62c8053fc3bd956a677d1a7f1d47b9"><div class="ttname"><a href="structKelvinVoigtDamper_1_1CommonData.html#a6c62c8053fc3bd956a677d1a7f1d47b9">KelvinVoigtDamper::CommonData::spatialPositionNameDot</a></div><div class="ttdeci">string spatialPositionNameDot</div><div class="ttdef"><b>Definition:</b> <a href="KelvinVoigtDamper_8hpp_source.html#l00172">KelvinVoigtDamper.hpp:172</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="astructEdgeForce_html"><div class="ttname"><a href="structEdgeForce.html">EdgeForce</a></div><div class="ttdoc">Force on edges and lines.</div><div class="ttdef"><b>Definition:</b> <a href="EdgeForce_8hpp_source.html#l00013">EdgeForce.hpp:13</a></div></div>
<div class="ttc" id="aclassT_html"><div class="ttname"><a href="classT.html">T</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_a7839553ba4c17aea2b155c2bfde5185b"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#a7839553ba4c17aea2b155c2bfde5185b">ConvectiveMassElement::MatShellCtx::iNit</a></div><div class="ttdeci">MoFEMErrorCode iNit()</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8cpp_source.html#l02352">ConvectiveMassElement.cpp:2352</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMetaNodalForces_html_a8e0b96853208e8320b7268f96f4fd8ee"><div class="ttname"><a href="structMetaNodalForces.html#a8e0b96853208e8320b7268f96f4fd8ee">MetaNodalForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition:</b> <a href="NodalForce_8hpp_source.html#l00092">NodalForce.hpp:92</a></div></div>
<div class="ttc" id="astructPostProcTemplateOnRefineMesh_html_acd29730f88cf549ab0e5deb0b76476ee"><div class="ttname"><a href="structPostProcTemplateOnRefineMesh.html#acd29730f88cf549ab0e5deb0b76476ee">PostProcTemplateOnRefineMesh::postProcMesh</a></div><div class="ttdeci">moab::Interface &amp; postProcMesh</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00122">PostProcOnRefMesh.hpp:122</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FEMethod_html"><div class="ttname"><a href="structMoFEM_1_1FEMethod.html">MoFEM::FEMethod</a></div><div class="ttdoc">structure for User Loop Methods on finite elements</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00369">LoopMethods.hpp:369</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespaceMoFEM.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00674">HODataOperators.hpp:674</a></div></div>
<div class="ttc" id="astructNonlinearElasticElement_1_1MyVolumeFE_html_a41ee4daa88dbd60276defbe4843b9f77"><div class="ttname"><a href="structNonlinearElasticElement_1_1MyVolumeFE.html#a41ee4daa88dbd60276defbe4843b9f77">NonlinearElasticElement::MyVolumeFE::eNergy</a></div><div class="ttdeci">double eNergy</div><div class="ttdef"><b>Definition:</b> <a href="NonLinearElasticElement_8hpp_source.html#l00059">NonLinearElasticElement.hpp:59</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca1aacb952ebfd7b0ad16085a9bf1fcf0a"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca1aacb952ebfd7b0ad16085a9bf1fcf0a">PRESSURESET</a></div><div class="ttdeci">@ PRESSURESET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00165">definitions.h:165</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a65f22030e64fd429012bf8f0f025d9a1"><div class="ttname"><a href="namespaceMoFEM.html#a65f22030e64fd429012bf8f0f025d9a1">MoFEM::TsSetIFunction</a></div><div class="ttdeci">PetscErrorCode TsSetIFunction(TS ts, PetscReal t, Vec u, Vec u_t, Vec F, void *ctx)</div><div class="ttdoc">Set IFunction for TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8cpp_source.html#l00056">TsCtx.cpp:56</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a></div><div class="ttdeci">@ NOBASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00059">definitions.h:59</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00609">definitions.h:609</a></div></div>
<div class="ttc" id="astructNonlinearElasticElement_html"><div class="ttname"><a href="structNonlinearElasticElement.html">NonlinearElasticElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of nonlinear elastic element</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00027">HookeElement.hpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a4128e8771499a7dcaf4b224a2d3d2a14"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a4128e8771499a7dcaf4b224a2d3d2a14">MoFEM::TsCtx::getLoopsMonitor</a></div><div class="ttdeci">FEMethodsSequence &amp; getLoopsMonitor()</div><div class="ttdoc">Get the loops to do Monitor object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00098">TsCtx.hpp:98</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SnesMethod_html_ac5ebf128ee5d19e718d081d218dba15d"><div class="ttname"><a href="structMoFEM_1_1SnesMethod.html#ac5ebf128ee5d19e718d081d218dba15d">MoFEM::SnesMethod::snes_ctx</a></div><div class="ttdeci">SNESContext snes_ctx</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00118">LoopMethods.hpp:118</a></div></div>
<div class="ttc" id="astructKelvinVoigtDamper_html"><div class="ttname"><a href="structKelvinVoigtDamper.html">KelvinVoigtDamper</a></div><div class="ttdoc">Implementation of Kelvin Voigt Damper.</div><div class="ttdef"><b>Definition:</b> <a href="KelvinVoigtDamper_8hpp_source.html#l00020">KelvinVoigtDamper.hpp:20</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MyVolumeFE_html_ae97a8968a6b5709018f25f6c3c42255e"><div class="ttname"><a href="structConvectiveMassElement_1_1MyVolumeFE.html#ae97a8968a6b5709018f25f6c3c42255e">ConvectiveMassElement::MyVolumeFE::eNergy</a></div><div class="ttdeci">double eNergy</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00056">ConvectiveMassElement.hpp:56</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a22909ce009e78fa1db0615ed913dc5e4"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a22909ce009e78fa1db0615ed913dc5e4">MoFEM::TsCtx::getLoopsIFunction</a></div><div class="ttdeci">FEMethodsSequence &amp; getLoopsIFunction()</div><div class="ttdoc">Get the loops to do IFunction object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00059">TsCtx.hpp:59</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="aclassE_html"><div class="ttname"><a href="classE.html">E</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga6bd6335f024a22cde370ee807d9185ce"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00049">MeshsetsManager.hpp:49</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_gae2f23388a21a25d68e4f62a5e5259e06"><div class="ttname"><a href="group__mofem__access.html#gae2f23388a21a25d68e4f62a5e5259e06">MoFEM::CoreInterface::get_problem</a></div><div class="ttdeci">virtual const Problem * get_problem(const std::string problem_name) const =0</div><div class="ttdoc">Get the problem object.</div></div>
<div class="ttc" id="astructNodalForce_html"><div class="ttname"><a href="structNodalForce.html">NodalForce</a></div><div class="ttdoc">Force applied to nodes.</div><div class="ttdef"><b>Definition:</b> <a href="NodalForce_8hpp_source.html#l00013">NodalForce.hpp:13</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_a893cd2415fae91d745a194be0e381671"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#a893cd2415fae91d745a194be0e381671">ConvectiveMassElement::MatShellCtx::scatterU</a></div><div class="ttdeci">VecScatter scatterU</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00505">ConvectiveMassElement.hpp:505</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_aadaf54ad0202b4d7f31376bf7f3fdc91"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#aadaf54ad0202b4d7f31376bf7f3fdc91">MoFEM::TsCtx::getPostProcessIJacobian</a></div><div class="ttdeci">BasicMethodsSequence &amp; getPostProcessIJacobian()</div><div class="ttdoc">Get the postProcess to do IJacobian object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00128">TsCtx.hpp:128</a></div></div>
<div class="ttc" id="aBasicFiniteElements_8hpp_html"><div class="ttname"><a href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Projection10NodeCoordsOnField_html"><div class="ttname"><a href="structMoFEM_1_1Projection10NodeCoordsOnField.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a493fcd6f5f4b7e36007a9020980bb819"><div class="ttname"><a href="definitions_8h.html#a493fcd6f5f4b7e36007a9020980bb819">MOAB_THROW</a></div><div class="ttdeci">#define MOAB_THROW(err)</div><div class="ttdoc">Check error code of MoAB function and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00554">definitions.h:554</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astructElasticMaterials_html"><div class="ttname"><a href="structElasticMaterials.html">ElasticMaterials</a></div><div class="ttdoc">Manage setting parameters and constitutive equations for nonlinear/linear elastic materials.</div><div class="ttdef"><b>Definition:</b> <a href="ElasticMaterials_8hpp_source.html#l00024">ElasticMaterials.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a24e74c25004733c09e0dbcc0d90eb3af"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a24e74c25004733c09e0dbcc0d90eb3af">MoFEM::TsCtx::FEMethodsSequence</a></div><div class="ttdeci">MoFEM::FEMethodsSequence FEMethodsSequence</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00026">TsCtx.hpp:26</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SnesCtx_html_a7073c85ff8833f808af680f72616cb2f"><div class="ttname"><a href="structMoFEM_1_1SnesCtx.html#a7073c85ff8833f808af680f72616cb2f">MoFEM::SnesCtx::FEMethodsSequence</a></div><div class="ttdeci">MoFEM::FEMethodsSequence FEMethodsSequence</div><div class="ttdef"><b>Definition:</b> <a href="SnesCtx_8hpp_source.html#l00027">SnesCtx.hpp:27</a></div></div>
<div class="ttc" id="astructKelvinVoigtDamper_1_1ConstitutiveEquation_html"><div class="ttname"><a href="structKelvinVoigtDamper_1_1ConstitutiveEquation.html">KelvinVoigtDamper::ConstitutiveEquation&lt; adouble &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1LogManager_html_a1eb7382ca81a927c24b76ffd20134cfd"><div class="ttname"><a href="structMoFEM_1_1LogManager.html#a1eb7382ca81a927c24b76ffd20134cfd">MoFEM::LogManager::createSink</a></div><div class="ttdeci">static boost::shared_ptr&lt; SinkType &gt; createSink(boost::shared_ptr&lt; std::ostream &gt; stream_ptr, std::string comm_filter)</div><div class="ttdoc">Create a sink object.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8cpp_source.html#l00298">LogManager.cpp:298</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition:</b> <a href="level__set_8cpp_source.html#l01932">level_set.cpp:1932</a></div></div>
<div class="ttc" id="astructDirichletDisplacementBc_html"><div class="ttname"><a href="structDirichletDisplacementBc.html">DirichletDisplacementBc</a></div><div class="ttdoc">Set Dirichlet boundary conditions on displacements.</div><div class="ttdef"><b>Definition:</b> <a href="DirichletBC_8hpp_source.html#l00057">DirichletBC.hpp:57</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_gaa584a5c9cc28f5ae0a7088d130683be8"><div class="ttname"><a href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">MoFEM::CoreInterface::add_ents_to_field_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_type(const Range &amp;ents, const EntityType type, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1654dd29ff9af437332ec55af104ff48"><div class="ttname"><a href="namespaceMoFEM.html#a1654dd29ff9af437332ec55af104ff48">MoFEM::TsMonitorSet</a></div><div class="ttdeci">PetscErrorCode TsMonitorSet(TS ts, PetscInt step, PetscReal t, Vec u, void *ctx)</div><div class="ttdoc">Set monitor for TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8cpp_source.html#l00259">TsCtx.cpp:259</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_html"><div class="ttname"><a href="structConvectiveMassElement.html">ConvectiveMassElement</a></div><div class="ttdoc">structure grouping operators and data used for calculation of mass (convective) element</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00028">ConvectiveMassElement.hpp:28</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a></div><div class="ttdeci">@ NODESET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00159">definitions.h:159</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8b068eced1fd720631edcaea59289a15"><div class="ttname"><a href="group__mofem__fe.html#ga8b068eced1fd720631edcaea59289a15">MoFEM::CoreInterface::add_ents_to_finite_element_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_type(const EntityHandle entities, const EntityType type, const std::string &amp;name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a6ffd47b9e0afb9f78ad9e88ca71e65a7"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">MoFEM::Exceptions::rval</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; moab::ErrorCode &gt; rval</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00074">Exceptions.hpp:74</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_a51af5eaec4d239d0312608d067e47e93"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#a51af5eaec4d239d0312608d067e47e93">ConvectiveMassElement::MatShellCtx::u</a></div><div class="ttdeci">Vec u</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00513">ConvectiveMassElement.hpp:513</a></div></div>
<div class="ttc" id="aSurfacePressureComplexForLazy_8hpp_html"><div class="ttname"><a href="SurfacePressureComplexForLazy_8hpp.html">SurfacePressureComplexForLazy.hpp</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MyVolumeFE_html"><div class="ttname"><a href="structConvectiveMassElement_1_1MyVolumeFE.html">ConvectiveMassElement::MyVolumeFE</a></div><div class="ttdoc">definition of volume element</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00031">ConvectiveMassElement.hpp:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_html_ab0ea7a73d99beba1d4b4097baebe1484"><div class="ttname"><a href="structConvectiveMassElement.html#ab0ea7a73d99beba1d4b4097baebe1484">ConvectiveMassElement::PCShellSetUpOp</a></div><div class="ttdeci">static MoFEMErrorCode PCShellSetUpOp(PC pc)</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00618">ConvectiveMassElement.hpp:618</a></div></div>
<div class="ttc" id="astructPostProcStress_html"><div class="ttname"><a href="structPostProcStress.html">PostProcStress</a></div><div class="ttdef"><b>Definition:</b> <a href="PostProcStresses_8hpp_source.html#l00017">PostProcStresses.hpp:17</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca4ab4a7e6c2c0f87be80aa8ccc963c6f6"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca4ab4a7e6c2c0f87be80aa8ccc963c6f6">FORCESET</a></div><div class="ttdeci">@ FORCESET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00164">definitions.h:164</a></div></div>
<div class="ttc" id="astructTimeForceScale_html"><div class="ttname"><a href="structTimeForceScale.html">TimeForceScale</a></div><div class="ttdoc">Force scale operator for reading two columns.</div><div class="ttdef"><b>Definition:</b> <a href="tutorials_2src_2TimeForceScale_8hpp_source.html#l00018">TimeForceScale.hpp:18</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="aLogManager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_aef7269f120efd788539812c2f9934984"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#aef7269f120efd788539812c2f9934984">MoFEM::TsCtx::getPreProcessIJacobian</a></div><div class="ttdeci">BasicMethodsSequence &amp; getPreProcessIJacobian()</div><div class="ttdoc">Get the preProcess to do IJacobian object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00121">TsCtx.hpp:121</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_html_a2abdfa353006f481e79a932b3af1a602"><div class="ttname"><a href="structConvectiveMassElement.html#a2abdfa353006f481e79a932b3af1a602">ConvectiveMassElement::PCShellDestroy</a></div><div class="ttdeci">static MoFEMErrorCode PCShellDestroy(PC pc)</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00633">ConvectiveMassElement.hpp:633</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SnesMethod_html_a271bba1f52a84d1a813117473339911aaa417c651761e8128f92dac64bd35c887"><div class="ttname"><a href="structMoFEM_1_1SnesMethod.html#a271bba1f52a84d1a813117473339911aaa417c651761e8128f92dac64bd35c887">MoFEM::SnesMethod::CTX_SNESNONE</a></div><div class="ttdeci">@ CTX_SNESNONE</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00107">LoopMethods.hpp:107</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition:</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html_a271a2096c19f1b94383edc0b4e2e2060"><div class="ttname"><a href="structMoFEM_1_1Problem.html#a271a2096c19f1b94383edc0b4e2e2060">MoFEM::Problem::getNbDofsRow</a></div><div class="ttdeci">DofIdx getNbDofsRow() const</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00376">ProblemsMultiIndices.hpp:376</a></div></div>
<div class="ttc" id="astructPostProcTemplateVolumeOnRefinedMesh_html_a829053948cb06f10651b18a9adcac873"><div class="ttname"><a href="structPostProcTemplateVolumeOnRefinedMesh.html#a829053948cb06f10651b18a9adcac873">PostProcTemplateVolumeOnRefinedMesh::commonData</a></div><div class="ttdeci">CommonData commonData</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00287">PostProcOnRefMesh.hpp:287</a></div></div>
<div class="ttc" id="astructFluidPressure_html"><div class="ttname"><a href="structFluidPressure.html">FluidPressure</a></div><div class="ttdoc">Fluid pressure forces.</div><div class="ttdef"><b>Definition:</b> <a href="FluidPressure_8hpp_source.html#l00020">FluidPressure.hpp:20</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PairNameFEMethodPtr_html"><div class="ttname"><a href="structMoFEM_1_1PairNameFEMethodPtr.html">MoFEM::PairNameFEMethodPtr</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxPETSc_8hpp_source.html#l00012">AuxPETSc.hpp:12</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a></div><div class="ttdeci">@ COL</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="astructMoFEM_1_1LogManager_html_a745c3e2cfb9fdea08ecd2e85316e8639"><div class="ttname"><a href="structMoFEM_1_1LogManager.html#a745c3e2cfb9fdea08ecd2e85316e8639">MoFEM::LogManager::getStrmWorld</a></div><div class="ttdeci">static boost::shared_ptr&lt; std::ostream &gt; getStrmWorld()</div><div class="ttdoc">Get the strm world object.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8cpp_source.html#l00344">LogManager.cpp:344</a></div></div>
<div class="ttc" id="agroup__mofem__fs__post__proc_html_gac9592cc8071671f2363846c1aa049923"><div class="ttname"><a href="group__mofem__fs__post__proc.html#gac9592cc8071671f2363846c1aa049923">PostProcTemplateOnRefineMesh::writeFile</a></div><div class="ttdeci">MoFEMErrorCode writeFile(const std::string file_name, const char *file_type=&quot;MOAB&quot;, const char *file_options=&quot;PARALLEL=WRITE_PART&quot;)</div><div class="ttdoc">wrote results in (MOAB) format, use &quot;file_name.h5m&quot;</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00253">PostProcOnRefMesh.hpp:253</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html">MoFEM::TsCtx</a></div><div class="ttdoc">Interface for Time Stepping (TS) solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00017">TsCtx.hpp:17</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a602e2873e82737d021991fb9eca1fbb3"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a602e2873e82737d021991fb9eca1fbb3">MoFEM::TsCtx::getPostProcessIFunction</a></div><div class="ttdeci">BasicMethodsSequence &amp; getPostProcessIFunction()</div><div class="ttdoc">Get the postProcess to do IFunction object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00112">TsCtx.hpp:112</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1PCShellCtx_html"><div class="ttname"><a href="structConvectiveMassElement_1_1PCShellCtx.html">ConvectiveMassElement::PCShellCtx</a></div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00600">ConvectiveMassElement.hpp:600</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TSMethod_html_a0c125a07b85ceceb72d9f3afea241dfeae17f6c302dca802c8f2e6d45f53bf3da"><div class="ttname"><a href="structMoFEM_1_1TSMethod.html#a0c125a07b85ceceb72d9f3afea241dfeae17f6c302dca802c8f2e6d45f53bf3da">MoFEM::TSMethod::CTX_TSNONE</a></div><div class="ttdeci">@ CTX_TSNONE</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00145">LoopMethods.hpp:145</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_aa00dbfa4fd7901bce7909d8bbaa706e4"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#aa00dbfa4fd7901bce7909d8bbaa706e4">ConvectiveMassElement::MatShellCtx::M</a></div><div class="ttdeci">Mat M</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00504">ConvectiveMassElement.hpp:504</a></div></div>
<div class="ttc" id="anonlinear__dynamics_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="nonlinear__dynamics_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00226">nonlinear_dynamics.cpp:226</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TSMethod_html_ab83e4a69396dd343422809f7f4b57d41"><div class="ttname"><a href="structMoFEM_1_1TSMethod.html#ab83e4a69396dd343422809f7f4b57d41">MoFEM::TSMethod::ts_ctx</a></div><div class="ttdeci">TSContext ts_ctx</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00157">LoopMethods.hpp:157</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_a3f2e0faf3ff6159d97f666ba54f24c82"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#a3f2e0faf3ff6159d97f666ba54f24c82">ConvectiveMassElement::MatShellCtx::v</a></div><div class="ttdeci">Vec v</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00513">ConvectiveMassElement.hpp:513</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a12477157e716aece7dd7b3e316fef7a3"><div class="ttname"><a href="namespaceMoFEM.html#a12477157e716aece7dd7b3e316fef7a3">MoFEM::TsSetIJacobian</a></div><div class="ttdeci">PetscErrorCode TsSetIJacobian(TS ts, PetscReal t, Vec u, Vec u_t, PetscReal a, Mat A, Mat B, void *ctx)</div><div class="ttdoc">Set function evaluating jacobian in TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8cpp_source.html#l00165">TsCtx.cpp:165</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a6949a4bcc0920ad35e91d7a2d3312988"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a6949a4bcc0920ad35e91d7a2d3312988">AINSWORTH_LOBATTO_BASE</a></div><div class="ttdeci">@ AINSWORTH_LOBATTO_BASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00062">definitions.h:62</a></div></div>
<div class="ttc" id="astructPostProcTemplateVolumeOnRefinedMesh_html_a093f5ac63678cfad18c87cd36c6962be"><div class="ttname"><a href="structPostProcTemplateVolumeOnRefinedMesh.html#a093f5ac63678cfad18c87cd36c6962be">PostProcTemplateVolumeOnRefinedMesh::generateReferenceElementMesh</a></div><div class="ttdeci">MoFEMErrorCode generateReferenceElementMesh()</div><div class="ttdoc">Generate reference mesh on single element.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00301">PostProcOnRefMesh.hpp:301</a></div></div>
<div class="ttc" id="agroup__mofem__fs__post__proc_html_ga5b5f38d5d91d2f4e03c51dbeadbb8130"><div class="ttname"><a href="group__mofem__fs__post__proc.html#ga5b5f38d5d91d2f4e03c51dbeadbb8130">PostProcTemplateOnRefineMesh::addFieldValuesGradientPostProc</a></div><div class="ttdeci">MoFEMErrorCode addFieldValuesGradientPostProc(const std::string field_name, Vec v=PETSC_NULL)</div><div class="ttdoc">Add operator to post-process L2 or H1 field gradient.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00195">PostProcOnRefMesh.hpp:195</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_gad43a6631f7d465ad31403cbb1d1896ba"><div class="ttname"><a href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">MoFEM::CoreInterface::check_field</a></div><div class="ttdeci">virtual bool check_field(const std::string &amp;name) const =0</div><div class="ttdoc">check if field is in database</div></div>
<div class="ttc" id="astructConvectiveMassElement_html_a0f04337aa08c66032a696c5961504726"><div class="ttname"><a href="structConvectiveMassElement.html#a0f04337aa08c66032a696c5961504726">ConvectiveMassElement::ZeroEntriesOp</a></div><div class="ttdeci">static MoFEMErrorCode ZeroEntriesOp(Mat A)</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00589">ConvectiveMassElement.hpp:589</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_a5e6a1ed717a76551ba1c4af75ef483f1"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#a5e6a1ed717a76551ba1c4af75ef483f1">ConvectiveMassElement::MatShellCtx::K</a></div><div class="ttdeci">Mat K</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00504">ConvectiveMassElement.hpp:504</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_html_a449bff5aa621647935c184cef1e29c61"><div class="ttname"><a href="structConvectiveMassElement.html#a449bff5aa621647935c184cef1e29c61">ConvectiveMassElement::PCShellApplyOp</a></div><div class="ttdeci">static MoFEMErrorCode PCShellApplyOp(PC pc, Vec f, Vec x)</div><div class="ttdoc">apply pre-conditioner for shell matrix</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00671">ConvectiveMassElement.hpp:671</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga202c2d0258d78f4c0d60ecac64bf2252"><div class="ttname"><a href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a></div><div class="ttdeci">#define MOFEM_LOG_TAG(channel, tag)</div><div class="ttdoc">Tag channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00339">LogManager.hpp:339</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html_a1c7d8024651ef955a03d2e2e4753c1c9"><div class="ttname"><a href="structMoFEM_1_1Problem.html#a1c7d8024651ef955a03d2e2e4753c1c9">MoFEM::Problem::getNbLocalDofsRow</a></div><div class="ttdeci">DofIdx getNbLocalDofsRow() const</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00378">ProblemsMultiIndices.hpp:378</a></div></div>
<div class="ttc" id="aElasticMaterials_8hpp_html"><div class="ttname"><a href="ElasticMaterials_8hpp.html">ElasticMaterials.hpp</a></div><div class="ttdoc">Elastic materials.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_gabfd48a196686d30eeacb978b81d1a656"><div class="ttname"><a href="group__mofem__problems__manager.html#gabfd48a196686d30eeacb978b81d1a656">MoFEM::ProblemsManager::partitionFiniteElements</a></div><div class="ttdeci">MoFEMErrorCode partitionFiniteElements(const std::string name, bool part_from_moab=false, int low_proc=-1, int hi_proc=-1, int verb=VERBOSE)</div><div class="ttdoc">partition finite elements</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8cpp_source.html#l02167">ProblemsManager.cpp:2167</a></div></div>
<div class="ttc" id="agroup__mofem__problems_html_gab02fceb7ce0b4be564ff8b2c7144ba12"><div class="ttname"><a href="group__mofem__problems.html#gab02fceb7ce0b4be564ff8b2c7144ba12">MoFEM::CoreInterface::modify_problem_ref_level_add_bit</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_problem_ref_level_add_bit(const std::string &amp;name_problem, const BitRefLevel &amp;bit)=0</div><div class="ttdoc">add ref level to problem</div></div>
<div class="ttc" id="astructMoFEM_1_1VecManager_html"><div class="ttname"><a href="structMoFEM_1_1VecManager.html">MoFEM::VecManager</a></div><div class="ttdoc">Vector manager is used to create vectors \mofem_vectors.</div><div class="ttdef"><b>Definition:</b> <a href="VecManager_8hpp_source.html#l00023">VecManager.hpp:23</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a></div><div class="ttdeci">@ AINSWORTH_BERNSTEIN_BEZIER_BASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00064">definitions.h:64</a></div></div>
<div class="ttc" id="amesh__smoothing_8cpp_html_ae20b66af13b03d8e8a4593186c23cd07"><div class="ttname"><a href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a></div><div class="ttdeci">char mesh_file_name[255]</div><div class="ttdef"><b>Definition:</b> <a href="mesh__smoothing_8cpp_source.html#l00022">mesh_smoothing.cpp:22</a></div></div>
<div class="ttc" id="astructMoFEM_1_1TsCtx_html_a881d04eb27d8ab3ced76bc98b6fd26b3"><div class="ttname"><a href="structMoFEM_1_1TsCtx.html#a881d04eb27d8ab3ced76bc98b6fd26b3">MoFEM::TsCtx::getPreProcessIFunction</a></div><div class="ttdeci">BasicMethodsSequence &amp; getPreProcessIFunction()</div><div class="ttdoc">Get the preProcess to do IFunction object.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00105">TsCtx.hpp:105</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MatrixManager_html"><div class="ttname"><a href="structMoFEM_1_1MatrixManager.html">MoFEM::MatrixManager</a></div><div class="ttdoc">Matrix manager is used to build and partition problems.</div><div class="ttdef"><b>Definition:</b> <a href="MatrixManager_8hpp_source.html#l00021">MatrixManager.hpp:21</a></div></div>
<div class="ttc" id="astructMetaEdgeForces_html_ad4ba172a5f79e0c41430c6dcecdd95f8"><div class="ttname"><a href="structMetaEdgeForces.html#ad4ba172a5f79e0c41430c6dcecdd95f8">MetaEdgeForces::addElement</a></div><div class="ttdeci">static MoFEMErrorCode addElement(MoFEM::Interface &amp;m_field, const std::string field_name, Range *intersect_ptr=NULL)</div><div class="ttdoc">Add element taking information from NODESET.</div><div class="ttdef"><b>Definition:</b> <a href="EdgeForce_8hpp_source.html#l00062">EdgeForce.hpp:62</a></div></div>
<div class="ttc" id="astructNonlinearElasticElement_1_1MyVolumeFE_html"><div class="ttname"><a href="structNonlinearElasticElement_1_1MyVolumeFE.html">NonlinearElasticElement::MyVolumeFE</a></div><div class="ttdoc">definition of volume element</div><div class="ttdef"><b>Definition:</b> <a href="NonLinearElasticElement_8hpp_source.html#l00031">NonLinearElasticElement.hpp:31</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html">ConvectiveMassElement::MatShellCtx</a></div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00502">ConvectiveMassElement.hpp:502</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a50531f1fc6bfb68b4756a88126df316e"><div class="ttname"><a href="namespaceMoFEM.html#a50531f1fc6bfb68b4756a88126df316e">MoFEM::SnesRhs</a></div><div class="ttdeci">PetscErrorCode SnesRhs(SNES snes, Vec x, Vec f, void *ctx)</div><div class="ttdoc">This is MoFEM implementation for the right hand side (residual vector) evaluation in SNES solver.</div><div class="ttdef"><b>Definition:</b> <a href="SnesCtx_8cpp_source.html#l00027">SnesCtx.cpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="astructPostProcVolumeOnRefinedMesh_html"><div class="ttname"><a href="structPostProcVolumeOnRefinedMesh.html">PostProcVolumeOnRefinedMesh</a></div><div class="ttdoc">Post processing.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00955">PostProcOnRefMesh.hpp:955</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="astructPostProcTemplateOnRefineMesh_html_a47d46ec67f3f7c3e82a846f3f3887830"><div class="ttname"><a href="structPostProcTemplateOnRefineMesh.html#a47d46ec67f3f7c3e82a846f3f3887830">PostProcTemplateOnRefineMesh::mapGaussPts</a></div><div class="ttdeci">std::vector&lt; EntityHandle &gt; mapGaussPts</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00125">PostProcOnRefMesh.hpp:125</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1UpdateAndControl_html"><div class="ttname"><a href="structConvectiveMassElement_1_1UpdateAndControl.html">ConvectiveMassElement::UpdateAndControl</a></div><div class="ttdoc">Set fields DOT_.</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00434">ConvectiveMassElement.hpp:434</a></div></div>
<div class="ttc" id="astructMonitorRestart_html"><div class="ttname"><a href="structMonitorRestart.html">MonitorRestart</a></div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00139">nonlinear_dynamics.cpp:139</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_html_a02a281fd26fffbe425b3fbb7824c5c6d"><div class="ttname"><a href="structConvectiveMassElement.html#a02a281fd26fffbe425b3fbb7824c5c6d">ConvectiveMassElement::MultOpA</a></div><div class="ttdeci">static MoFEMErrorCode MultOpA(Mat A, Vec x, Vec f)</div><div class="ttdoc">Mult operator for shell matrix.</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00546">ConvectiveMassElement.hpp:546</a></div></div>
<div class="ttc" id="astructKelvinVoigtDamper_1_1CommonData_html"><div class="ttname"><a href="structKelvinVoigtDamper_1_1CommonData.html">KelvinVoigtDamper::CommonData</a></div><div class="ttdoc">Common data for nonlinear_elastic_elem model.</div><div class="ttdef"><b>Definition:</b> <a href="KelvinVoigtDamper_8hpp_source.html#l00169">KelvinVoigtDamper.hpp:169</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_ad27ed878e829d18291a9a6d869546c47"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#ad27ed878e829d18291a9a6d869546c47">MoFEM::ForcesAndSourcesCore::getOpPtrVector</a></div><div class="ttdeci">boost::ptr_deque&lt; UserDataOperator &gt; &amp; getOpPtrVector()</div><div class="ttdoc">Use to push back operator for row operator.</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00083">ForcesAndSourcesCore.hpp:83</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1ShellResidualElement_html"><div class="ttname"><a href="structConvectiveMassElement_1_1ShellResidualElement.html">ConvectiveMassElement::ShellResidualElement</a></div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00715">ConvectiveMassElement.hpp:715</a></div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_ga0eed1a1aa1677044038c562cdd1aeb0f"><div class="ttname"><a href="group__mofem__problems__manager.html#ga0eed1a1aa1677044038c562cdd1aeb0f">MoFEM::ProblemsManager::buildProblemOnDistributedMesh</a></div><div class="ttdeci">MoFEMErrorCode buildProblemOnDistributedMesh(const std::string name, const bool square_matrix, int verb=VERBOSE)</div><div class="ttdoc">build problem data structures, assuming that mesh is distributed (collective)</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8cpp_source.html#l00290">ProblemsManager.cpp:290</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_acd15202cb7502a684f8276aae2b4ed70"><div class="ttname"><a href="namespaceMoFEM.html#acd15202cb7502a684f8276aae2b4ed70">MoFEM::PetscOptionsGetString</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetString(PetscOptions *, const char pre[], const char name[], char str[], size_t size, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00172">DeprecatedPetsc.hpp:172</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_abee82d436d03244c6886fc99f71116f0"><div class="ttname"><a href="namespaceMoFEM.html#abee82d436d03244c6886fc99f71116f0">MoFEM::PetscOptionsGetEList</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetEList(PetscOptions *, const char pre[], const char name[], const char *const *list, PetscInt next, PetscInt *value, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00203">DeprecatedPetsc.hpp:203</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_ae66e41f5f48f2972cb66ac835356c8c5"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#ae66e41f5f48f2972cb66ac835356c8c5">ConvectiveMassElement::MatShellCtx::barK</a></div><div class="ttdeci">Mat barK</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00512">ConvectiveMassElement.hpp:512</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a></div><div class="ttdeci">FieldApproximationBase</div><div class="ttdoc">approximation base</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00058">definitions.h:58</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html_ab0d05db502892988fb713aa6dcb3e7d9"><div class="ttname"><a href="structMoFEM_1_1Problem.html#ab0d05db502892988fb713aa6dcb3e7d9">MoFEM::Problem::getNbLocalDofsCol</a></div><div class="ttdeci">DofIdx getNbLocalDofsCol() const</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00379">ProblemsMultiIndices.hpp:379</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html_a6078a7f940fe823a1c1ccb4cc277e03e"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">ReactionDiffusionEquation::D</a></div><div class="ttdeci">const double D</div><div class="ttdoc">diffusivity</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00020">reaction_diffusion.cpp:20</a></div></div>
<div class="ttc" id="anonlinear__dynamics_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="nonlinear__dynamics_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00028">nonlinear_dynamics.cpp:28</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="agroup__mofem__problems_html_gaf165948ec92b5fcfbe5ec19ea1918ba1"><div class="ttname"><a href="group__mofem__problems.html#gaf165948ec92b5fcfbe5ec19ea1918ba1">MoFEM::CoreInterface::modify_problem_add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_problem_add_finite_element(const std::string name_problem, const std::string &amp;fe_name)=0</div><div class="ttdoc">add finite element to problem, this add entities assigned to finite element to a particular problem</div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SnesCtx_html"><div class="ttname"><a href="structMoFEM_1_1SnesCtx.html">MoFEM::SnesCtx</a></div><div class="ttdoc">Interface for nonlinear (SNES) solver.</div><div class="ttdef"><b>Definition:</b> <a href="SnesCtx_8hpp_source.html#l00013">SnesCtx.hpp:13</a></div></div>
<div class="ttc" id="astructConvectiveMassElement_1_1MatShellCtx_html_a2f574060431d44b1d1fc43efb0bbf1c4"><div class="ttname"><a href="structConvectiveMassElement_1_1MatShellCtx.html#a2f574060431d44b1d1fc43efb0bbf1c4">ConvectiveMassElement::MatShellCtx::scatterV</a></div><div class="ttdeci">VecScatter scatterV</div><div class="ttdef"><b>Definition:</b> <a href="ConvectiveMassElement_8hpp_source.html#l00505">ConvectiveMassElement.hpp:505</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Problem_html"><div class="ttname"><a href="structMoFEM_1_1Problem.html">MoFEM::Problem</a></div><div class="ttdoc">keeps basic data about problem</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsMultiIndices_8hpp_source.html#l00054">ProblemsMultiIndices.hpp:54</a></div></div>
<div class="ttc" id="astructKelvinVoigtDamper_1_1CommonData_html_aa243fcd6f0be6637140b9bc7eea92366"><div class="ttname"><a href="structKelvinVoigtDamper_1_1CommonData.html#aa243fcd6f0be6637140b9bc7eea92366">KelvinVoigtDamper::CommonData::spatialPositionName</a></div><div class="ttdeci">string spatialPositionName</div><div class="ttdef"><b>Definition:</b> <a href="KelvinVoigtDamper_8hpp_source.html#l00171">KelvinVoigtDamper.hpp:171</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga037d7b63954d2ec6d367a5c959f16068"><div class="ttname"><a href="group__mofem__log__manager.html#ga037d7b63954d2ec6d367a5c959f16068">MoFEM::LogManager::setLog</a></div><div class="ttdeci">static LoggerType &amp; setLog(const std::string channel)</div><div class="ttdoc">Set ans resset chanel logger.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8cpp_source.html#l00389">LogManager.cpp:389</a></div></div>
<div class="ttc" id="astructNeumannForcesSurface_html"><div class="ttname"><a href="structNeumannForcesSurface.html">NeumannForcesSurface</a></div><div class="ttdoc">Finite element and operators to apply force/pressures applied to surfaces.</div><div class="ttdef"><b>Definition:</b> <a href="SurfacePressure_8hpp_source.html#l00014">SurfacePressure.hpp:14</a></div></div>
<div class="ttc" id="astructMonitorPostProc_html"><div class="ttname"><a href="structMonitorPostProc.html">MonitorPostProc</a></div><div class="ttdef"><b>Definition:</b> <a href="nonlinear__dynamics_8cpp_source.html#l00030">nonlinear_dynamics.cpp:30</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2427b40a8745afeb2073f72d9d51584e"><div class="ttname"><a href="namespaceMoFEM.html#a2427b40a8745afeb2073f72d9d51584e">MoFEM::SnesMat</a></div><div class="ttdeci">PetscErrorCode SnesMat(SNES snes, Vec x, Mat A, Mat B, void *ctx)</div><div class="ttdoc">This is MoFEM implementation for the left hand side (tangent matrix) evaluation in SNES solver.</div><div class="ttdef"><b>Definition:</b> <a href="SnesCtx_8cpp_source.html#l00139">SnesCtx.cpp:139</a></div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_ga20ecb1883ad47d08f22a66d871a48114"><div class="ttname"><a href="group__mofem__problems__manager.html#ga20ecb1883ad47d08f22a66d871a48114">MoFEM::ProblemsManager::partitionGhostDofs</a></div><div class="ttdeci">MoFEMErrorCode partitionGhostDofs(const std::string name, int verb=VERBOSE)</div><div class="ttdoc">determine ghost nodes</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8cpp_source.html#l02339">ProblemsManager.cpp:2339</a></div></div>
<div class="ttc" id="agroup__mofem__problems_html_ga6afc6820fa64d4ceb733bd778adb925a"><div class="ttname"><a href="group__mofem__problems.html#ga6afc6820fa64d4ceb733bd778adb925a">MoFEM::CoreInterface::add_problem</a></div><div class="ttdeci">virtual MoFEMErrorCode add_problem(const std::string &amp;name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add problem.</div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="astructTimeAccelerogram_html"><div class="ttname"><a href="structTimeAccelerogram.html">TimeAccelerogram</a></div><div class="ttdef"><b>Definition:</b> <a href="tutorials_2src_2TimeForceScale_8hpp_source.html#l00133">TimeForceScale.hpp:133</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FieldBlas_html"><div class="ttname"><a href="structMoFEM_1_1FieldBlas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition:</b> <a href="FieldBlas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a8008ad16315eb609dcb0fd88746b991a"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a8008ad16315eb609dcb0fd88746b991a">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_gaa0e280c88443b6240bf3255c0dce0ef2"><div class="ttname"><a href="group__mofem__problems__manager.html#gaa0e280c88443b6240bf3255c0dce0ef2">MoFEM::ProblemsManager::partitionProblem</a></div><div class="ttdeci">MoFEMErrorCode partitionProblem(const std::string name, int verb=VERBOSE)</div><div class="ttdoc">partition problem dofs (collective)</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8cpp_source.html#l01683">ProblemsManager.cpp:1683</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<div class="ttc" id="agroup__mofem__fs__post__proc_html_ga69f5c71346638cb62c87f70ef1062b91"><div class="ttname"><a href="group__mofem__fs__post__proc.html#ga69f5c71346638cb62c87f70ef1062b91">PostProcTemplateOnRefineMesh::addFieldValuesPostProc</a></div><div class="ttdeci">MoFEMErrorCode addFieldValuesPostProc(const std::string field_name, Vec v=PETSC_NULL)</div><div class="ttdoc">Add operator to post-process L2, H1, Hdiv, Hcurl field value.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcOnRefMesh_8hpp_source.html#l00153">PostProcOnRefMesh.hpp:153</a></div></div>
<div class="ttc" id="astructKelvinVoigtDamper_1_1BlockMaterialData_html"><div class="ttname"><a href="structKelvinVoigtDamper_1_1BlockMaterialData.html">KelvinVoigtDamper::BlockMaterialData</a></div><div class="ttdoc">Dumper material parameters.</div><div class="ttdef"><b>Definition:</b> <a href="KelvinVoigtDamper_8hpp_source.html#l00029">KelvinVoigtDamper.hpp:29</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>