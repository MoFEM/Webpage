<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: COR-2: Solving the Poisson equation</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">COR-2: Solving the Poisson equation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#poisson_tut1_matematical_formulation">Mathematical formulation</a></li>
<li class="level1"><a href="#poisson_tut1_variational_formulation">Finite element variational formulation</a></li>
<li class="level1"><a href="#poisson_tut1_variational_verification">Exact solution</a></li>
<li class="level1"><a href="#poisson_tut1_code_disection">Code dissection</a><ul><li class="level2"><a href="#poisson_tut1_code_disection_ss0">Header files</a></li>
<li class="level2"><a href="#poisson_tut1_code_disection_ss1">Exact solution functions</a></li>
<li class="level2"><a href="#poisson_tut1_code_disection_ss2">Initialization</a></li>
<li class="level2"><a href="#poisson_tut1_code_disection_ss3">Creating Finite element instances</a></li>
<li class="level2"><a href="#poisson_tut1_code_disection_ss4">Simple interface</a></li>
<li class="level2"><a href="#poisson_tut1_code_disection_ss5">Solution of the problem</a></li>
<li class="level2"><a href="#poisson_tut1_code_disection_ss6">Post-processing</a></li>
</ul>
</li>
<li class="level1"><a href="#poisson_tut1_running_program">Running the program</a><ul><li class="level2"><a href="#poisson_tut1_running_program_output">Output dissection</a></li>
<li class="level2"><a href="#poisson_tut1_running_program_visualisation">Visualization</a></li>
<li class="level2"><a href="#poisson_tut1_running_genrating_mesh">Mesh formats</a></li>
</ul>
</li>
<li class="level1"><a href="#poisson_tut1_excercise">Exercises</a></li>
<li class="level1"><a href="#poisson_tut1_notes">Notes</a></li>
</ul>
</div>
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>The purpose of this tutorial is to show in detail how the most basic PDE, the Poisson equation, can be solved using <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. If the reader would prefer, instead, to start from an application to a solid mechanics problem, he/she might leave this tutorial for later and proceed directly to <a class="el" href="simple_elasticity_1.html">COR-6: Solid elasticity</a> and <a class="el" href="elasticity_mixed_formulation.html">COR-7: Mixed formulation for incompressible elasticity</a>.</dd></dl>
<p>This tutorial shows how to solve the Poisson equation. We introduce the basic concepts in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and exploit the <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a> interface to set-up the problem. A procedure is applied to the Poisson problem but can easily be modified to other problems from elasticity, fluid mechanics, thermo-elasticity, electromagnetics, etc. Methodology from this tutorial can also be applied to mix-problems, discontinuous Galerkin method or coupled problems.</p>
<p>We introduce fundamentals of <a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> and <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a> interfaces and show how to link <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> data structures with PETSc discrete manager. We also show how to describe fields and how to loop/iterate finite elements. This example is restricted to linear problems and the body is subjected to inhomogeneous Dirichlet boundary conditions only. We do not explain how to implement finite element data operator in this tutorial; this is part of tutorial <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a>.</p>
<p>While writing this tutorial we don't know what type of person you are. Do you like to see examples first, before seeing the big picture? Or do you prefer to see big picture first and then look for the details after? If you are second kind, its suggested you look at <a class="el" href="general_data_structure.html">MoFEM Architecture</a> first before you start with implementation. If you like to begin with examples, skip the general details and go straight to the code.</p>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> has a bottom-up design, with several levels of abstraction, yet enables users at any level to hack levels below. This is intended to give freedom to create new methods and solve problems in new ways.</p>
<ul>
<li><b>level</b> <b>0</b>: Database level, users access structures of the database directly using the functionality of hierarchy of multi-indexes. Core developers working on very generic low-level functionality will most likely use this level.</li>
<li><b>level</b> <b>1</b>: Database is accessed by <a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> allowing a user to add fields, elements and problems. Interface delivers functionality to iterate over elements, however on the finite element level the user operates on the database accessing multi-indexes directly. It is a level of core library developers, most likely you are not interested what happens at this level, at least at the beginning.</li>
<li><b>level</b> <b>2</b>: User accesses database by interfaces, e.g. <a class="el" href="structMoFEM_1_1MeshsetsManager.html" title="Interface for managing meshsets containing materials and boundary conditions.">MoFEM::MeshsetsManager</a>, <a class="el" href="structMoFEM_1_1NodeMergerInterface.html" title="Merge node by collapsing edge between them.">MoFEM::NodeMergerInterface</a>, <a class="el" href="structMoFEM_1_1MeshRefinement.html" title="Mesh refinement interface.">MoFEM::MeshRefinement</a> and other interfaces. Each interface provides new functionality and uses MoFEM/MoAB database to store and exchange data. Problems are managed by <a class="el" href="structMoFEM_1_1ProblemsManager.html" title="Problem manager is used to build and partition problems.">MoFEM::ProblemsManager</a>, which indexes degrees of freedom (DOFs) on distributed meshes, and does all the bookkeeping needed to construct matrices and vectors. Other low-level interfaces are provided managing "bit levels" or filed algebra. From time to time you would use those interfaces, but not in this tutorial.</li>
<li><b>level</b> <b>3</b>: Level at which simplified interfaces are provided, e.g. <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a>. Simple interface does not provide new functionality but simplifies use of <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> by wrapping complex operations. A solution of the problem is managed by Discrete Manager (DM) interface.</li>
<li><b>level</b> <b>4</b>: Mathematical model level. At that level complexity related to a problem, discretization is hidden from a user. User states differential operators for PDE given in a weak form. This is implemented by specialization of User Data Operators (UDO) and overloaded operators on fields (not yet implemented).</li>
</ul>
<p>Each level up simplifies implementation, making the code shorter and easier to follow, whilst sacrificing flexibility. In this tutorial, we focus attention on functions from <b>level</b> <b>3</b>, we are not going to describe here how the finite element is implemented, this is part of the next tutorial, <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a>. In this tutorial, we focus on generic steps presented in <a class="el" href="poisson_tut1.html#figure_1_level_3_interfaces">Figure 1</a> below in yellow boxes.</p>
<p>We designed code to give you a freedom to create code which does what you want and does not force you to follow the beaten path. The implementation shown here is similar for other types of PDEs, even for nonlinear or time-dependent problems. You don't have to understand every detail of the code here, sometimes we are using advanced C++. That understanding will come later. For example, if you like to change a form of your PDE, then you need to look only how to modify differential operator to solve anisotropic the Darcy equation for flow, and that is easily done by modification of one of the operators. So, relax and look what you have below and when you are intrigued, always ask questions on our <a href="https://groups.google.com/forum/#!categories/mofem-group">Q&amp;A forum</a>.</p>
<p><a class="anchor" id="figure_1_level_3_interfaces"></a></p><div class="image">
<img src="poisson_tut1_fig1.png" alt="" width="800px"/>
<div class="caption">
Figure 1. Level 3 interfaces</div></div>
<h1><a class="anchor" id="poisson_tut1_matematical_formulation"></a>
Mathematical formulation</h1>
<p>We solve the most basic of all PDEs, i.e. the Poisson equation, </p><p class="formulaDsp">
\[ -\nabla^2 u(\mathbf{x}) = f(\mathbf{x}),\quad \textrm{in}\,\Omega\\ \]
</p>
<p> where \(u=u(\mathbf{x})\) is an unknown function, \(f(\mathbf{x})\) is a given source term. The Poisson equation is in the so-called <em>strong</em> form, it has to be satisfied at every point of the body without boundary. To solve this PDE we need to describe the problem on the boundary, in this simple case for the purpose of the tutorial we are self-restricted to Dirichlet boundary condition where functions values are given by </p><p class="formulaDsp">
\[ u(\mathbf{x})=\overline{u}(\mathbf{x}),\quad \textrm{on}\,\partial\Omega \]
</p>
<p> where \(\overline{u}\) is prescribed function on the boundary.</p>
<div class="image">
<img src="poisson_tut1_fig2.png" alt="" width="800px"/>
<div class="caption">
Figure 2. Poisson Problem</div></div>
<p>The Laplacian \(\nabla^2\) in 3d space with Cartesian coordinates is </p><p class="formulaDsp">
\[ \nabla^2 u(x,y,z) = \nabla \cdot \nabla u = \frac{\partial^2 u}{\partial x^2}+ \frac{\partial^2 u}{\partial y^2}+ \frac{\partial^2 u}{\partial z^2} \]
</p>
<p>The Poisson equation arises in many physical contexts, including heat conduction, electrostatics, diffusion of substances, twisting of elastic rods, and describes many other physical problems. In general, PDE equations emerge from conservation laws, e.g. conservation of mass, electric charge or energy, i.e. one of the fundamental laws of the universe.</p>
<h1><a class="anchor" id="poisson_tut1_variational_formulation"></a>
Finite element variational formulation</h1>
<p>It is a well-established recipe how to change the equation in the form convenient for finite element calculations. The Poisson equation is multiplied by function \(u\) and integrated by parts. Without going into mathematical details, applying this procedure and enforcing constraints with Lagrange multiplier method, we get </p><p class="formulaDsp">
\[ \mathcal{L}(u,\lambda) = \frac{1}{2}\int_\Omega \left( \nabla u \right)^2 \textrm{d}\Omega - \int_\Omega uf \textrm{d}\Omega + \int_{\partial\Omega} \lambda (u-\overline{u}) \textrm{d}\partial\Omega \]
</p>
<p> where \(\lambda=\lambda(\mathbf{x})\) is Lagrange multiplier function on body boundary \(\partial\Omega\). Unknown functions can be expressed in finite dimension approximation space, as follows </p><p class="formulaDsp">
\[ u^h = \sum_i^{n_u} \phi^i(\mathbf{x}) U_i = \boldsymbol\phi\cdot\mathbf{U} , \quad \mathbf{x} \in \Omega,\\ \lambda^h = \sum_i^{n_\lambda} \psi^i(\mathbf{x}) L_i = \boldsymbol\psi\cdot\mathbf{L} , \quad \mathbf{x} \in \partial\Omega \]
</p>
<p> where \(U_i\) and \(L_i\) are unknown coefficients, called degrees of freedom. The \(\phi^i\) and \(\psi^i\) are base functions for \(u^h\) and \(\lambda^h\), respectively. The stationary point of \(\mathcal{L}(u^h,\lambda^h)\), obtained by minimalisation of Lagrangian gives Euler-Lagrange equations for discretised problem </p><p class="formulaDsp">
\[ \left[ \begin{array}{cc} \mathbf{K} &amp; \mathbf{C}^\textrm{T}\\ \mathbf{C} &amp; \mathbf{0} \end{array} \right] \left\{ \begin{array}{c} \mathbf{U}\\ \mathbf{L} \end{array} \right\} = \left[ \begin{array}{c} \mathbf{F}\\ \mathbf{g} \end{array} \right],\\ \mathbf{K}= \int_\Omega (\nabla \boldsymbol\phi)^\textrm{T} \nabla \boldsymbol\phi \textrm{d}\Omega,\quad \mathbf{C} = \int_{\partial\Omega} \boldsymbol\psi^\textrm{T} \boldsymbol\phi \textrm{d}\partial\Omega,\\ \mathbf{F} = \int_\Omega \boldsymbol\phi^\textrm{T} f \textrm{d}\Omega,\quad \mathbf{g} = \int_{\partial\Omega} \boldsymbol\psi^\textrm{T} \overline{u} \textrm{d}\partial\Omega. \]
</p>
<p> Applying this procedure, we transformed essential boundary conditions (in this case Dirichlet boundary conditions) into problems with only natural boundary conditions. Essential boundary conditions need to be satisfied by the approximation base. Natural conditions are satisfied while the problem is solved. Note that Lagrange multiplier has interpretation of flux here, which is in \(H^{-\frac{1}{2}}(\partial\Omega)\) space. However, in this case, the approximation of the Lagrange multiplier by a discontinuous piecewise results in a singular system of equations, since values are not bounded for natural (Neumann) boundary conditions when prescribed on all \(\partial\Omega\). For such a case, the solution is defined up to an additive constant. To remove that difficulty, we will use subspace of trace space, i.e. \(H^{-1}(\partial\Omega)\), that will generate as many constraints as many degrees of freedom for \(u^h\) on the body boundary, and thus enforce the boundary conditions exactly. For more information about spaces and deeper insight into the Poisson equation see <a class="el" href="citelist.html#CITEREF_demkowicz2006computing">[24]</a>, <a class="el" href="citelist.html#CITEREF_brezzi2008mixed">[16]</a> and <a class="el" href="citelist.html#CITEREF_reddy2013introductory">[61]</a>.</p>
<p>Matrices and vectors are implemented using user data operators (UDO);</p>
<ul>
<li>\(\mathbf{K}\) is implemented in <a class="el" href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3" title="Integrate grad-grad operator.">PoissonExample::OpK::iNtegrate</a></li>
<li>\(\mathbf{F}\) is implemented in <a class="el" href="structPoissonExample_1_1OpF.html#a935925a0321aa4e03a740d1f5056de0d" title="Integrate local entity vector.">PoissonExample::OpF::iNtegrate</a></li>
<li>\(\mathbf{C}\) is implemented in <a class="el" href="structPoissonExample_1_1OpC.html#a4e14f1cba17ed0174a5548bae8d592c9" title="Integrate local constrains matrix.">PoissonExample::OpC::iNtegrate</a></li>
<li>\(\mathbf{g}\) is implemented in <a class="el" href="structPoissonExample_1_1Op__g.html#a3d420c78551d8957da4e600ffc0ad59a" title="Integrate local constrains vector.">PoissonExample::Op_g::iNtegrate</a></li>
</ul>
<p>We put light on the implementation of those functions in the next tutorial <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a>. Here, in the following sections, we focus on the generic problem and solver setup. Complete implementation of UDO for this example is here <a class="el" href="PoissonOperators_8hpp-example.html">PoissonOperators.hpp</a>.</p>
<h1><a class="anchor" id="poisson_tut1_variational_verification"></a>
Exact solution</h1>
<p>This example is designed to validate the basic implementation of finite element operators. In this particular case, we assume exact solution. We will focus attention on particular case for which analytical solution is given by polynomial, for example </p><p class="formulaDsp">
\[ \overline{u}(\mathbf{x}) = 1+x^2+y^2+z^3 \quad \textrm{in}\Omega \]
</p>
<p> then applying Laplacian to analytical solution we can obtain source term </p><p class="formulaDsp">
\[ f(\mathbf{x}) = -4-6z. \]
</p>
<p> If finite element approximation using 3rd order polynomials or higher, a solution of the Poisson problem is exact. In <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> you could easily increase the order of the polynomial, as it is shown below.</p>
<h1><a class="anchor" id="poisson_tut1_code_disection"></a>
Code dissection</h1>
<p>The program with comments can be accessed here <a class="el" href="analytical_poisson_8cpp-example.html">analytical_poisson.cpp</a>. In this section, we will go step-by-step through the code.</p>
<h2><a class="anchor" id="poisson_tut1_code_disection_ss0"></a>
Header files</h2>
<p>We include three header files, first with <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library files and basic finite elements, second with the implementation of operators for finite elements and third with some auxiliary functions which will share tutorials about the Poisson equation. </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;<a class="code" href="PoissonOperators_8hpp.html">PoissonOperators.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="AuxPoissonFunctions_8hpp.html">AuxPoissonFunctions.hpp</a>&gt;</span></div>
</div><!-- fragment --><h2><a class="anchor" id="poisson_tut1_code_disection_ss1"></a>
Exact solution functions</h2>
<p>We choose an arbitrary 3rd polynomial function, we add a function for the gradient to evaluate error on the element and a function for Laplacian to apply it as a source term in the Poisson equation. </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structExactFunction.html">ExactFunction</a> {</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structExactFunction.html#a624aa0f96fa6b76dffb91979376510f0">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x,<span class="keyword">const</span> <span class="keywordtype">double</span> y,<span class="keyword">const</span> <span class="keywordtype">double</span> z)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 1+x*x+y*y+z*z*z;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structExactFunctionGrad.html">ExactFunctionGrad</a> {</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double,3&gt;</a> <a class="code" href="structExactFunctionGrad.html#af810f655402a112ff533dc360dabf202">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x,<span class="keyword">const</span> <span class="keywordtype">double</span> y,<span class="keyword">const</span> <span class="keywordtype">double</span> z)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double,3&gt;</a> grad;</div>
<div class="line">    grad(0) = 2*x;</div>
<div class="line">    grad(1) = 2*y;</div>
<div class="line">    grad(2) = 3*z*z;</div>
<div class="line">    <span class="keywordflow">return</span> grad;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structExactLaplacianFunction.html">ExactLaplacianFunction</a> {</div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structExactLaplacianFunction.html#a6b9269124ee9aebddf08ea9249a4b949">operator()</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x,<span class="keyword">const</span> <span class="keywordtype">double</span> y,<span class="keyword">const</span> <span class="keywordtype">double</span> z)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 4+6*z;</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><h2><a class="anchor" id="poisson_tut1_code_disection_ss2"></a>
Initialization</h2>
<p>In the following section, we initialize PETSc and construct MoAB and <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> databases. Starting with PETSc and MoAB </p><div class="fragment"><div class="line"><span class="comment">// Initialize PETSc</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc,&amp;argv,(<span class="keywordtype">char</span> *)0,<a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"><span class="comment">// Create MoAB database</span></div>
<div class="line"><a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> moab_core;                   <span class="comment">// create database</span></div>
<div class="line"><a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a>&amp; moab = moab_core;      <span class="comment">// create interface to database</span></div>
</div><!-- fragment --><p> and read data from a command line argument </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 3;  <span class="comment">// default approximation order</span></div>
<div class="line">PetscBool flg_test = PETSC_FALSE; <span class="comment">// true check if error is numerical error</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD,<span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Poisson&#39;s problem options&quot;</span>,<span class="stringliteral">&quot;none&quot;</span>); </div>
<div class="line"><span class="comment">// Set approximation order</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-order&quot;</span>,<span class="stringliteral">&quot;approximation order&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,&amp;<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>,PETSC_NULL); </div>
<div class="line"><span class="comment">// Set testing (used by CTest)</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-test&quot;</span>,<span class="stringliteral">&quot;if true is ctest&quot;</span>,<span class="stringliteral">&quot;&quot;</span>,flg_test,&amp;flg_test,PETSC_NULL); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEnd(); </div>
</div><!-- fragment --><p> In this test, for simplicity, we apply approximation order uniformly. However, <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> in principle is designed to manage heterogeneous approximation bases.</p>
<p>Once we have initialized PETSc and MoAB, we create <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database instance and link to it MoAB. <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database is accessed by <a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a>. </p><div class="fragment"><div class="line"><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> mofem_core(moab);                      <span class="comment">// create database</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a>&amp; m_field = mofem_core;            <span class="comment">// create interface to database</span></div>
</div><!-- fragment --><p> Also, we need to register in PETSc implementation of <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> Discrete Manager. </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(<span class="stringliteral">&quot;DMMOFEM&quot;</span>);  <span class="comment">// register MoFEM DM in PETSc</span></div>
</div><!-- fragment --><h2><a class="anchor" id="poisson_tut1_code_disection_ss3"></a>
Creating Finite element instances</h2>
<p>We start with declaring smart pointers to finite element objects. A smart pointer is like a "raw" pointer, but you do not have to remember to delete allocated memory to which it points. More about shared pointers you find <a href="https://www.boost.org/doc/libs/1_68_0/libs/smart_ptr/doc/html/smart_ptr.html#shared_ptr">here</a>, if you don't know what a pointer is, look <a href="https://en.wikipedia.org/wiki/Pointer_(computer_programming)">here</a>. You do not have to look at the details now, you can start working with code by making modifications of solutions which are already there. </p><div class="fragment"><div class="line">boost::shared_ptr&lt;ForcesAndSourcesCore&gt; domain_lhs_fe;     <span class="comment">///&lt; Volume element for the matrix</span></div>
<div class="line"><span class="comment"></span>boost::shared_ptr&lt;ForcesAndSourcesCore&gt; boundary_lhs_fe;   <span class="comment">///&lt; Boundary element for the matrix</span></div>
<div class="line"><span class="comment"></span>boost::shared_ptr&lt;ForcesAndSourcesCore&gt; domain_rhs_fe;     <span class="comment">///&lt; Volume element to assemble vector</span></div>
<div class="line"><span class="comment"></span>boost::shared_ptr&lt;ForcesAndSourcesCore&gt; boundary_rhs_fe;   <span class="comment">///&lt; Boundary element to assemble vector</span></div>
<div class="line"><span class="comment"></span>boost::shared_ptr&lt;ForcesAndSourcesCore&gt; domain_error;      <span class="comment">///&lt; Volume element to evaluate error</span></div>
<div class="line"><span class="comment"></span>boost::shared_ptr&lt;ForcesAndSourcesCore&gt; post_proc_volume;  <span class="comment">///&lt; Volume element to Post-process results</span></div>
<div class="line"><span class="comment"></span>boost::shared_ptr&lt;ForcesAndSourcesCore&gt; <span class="keyword">null</span>;              <span class="comment">///&lt; Null element do nothing</span></div>
</div><!-- fragment --><p>Now we have to allocate memory for the finite elements and add data operators to them. We do not cover details here, this is realised by three functions, which we will use in the following tutorials </p><div class="fragment"><div class="line"><span class="comment">// Add problem specific operators the generic finite elements to calculate matrices and vectors.</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1CreateFiniteElements.html">PoissonExample::CreateFiniteElements</a>(m_field).<a class="code" href="structPoissonExample_1_1CreateFiniteElements.html#ae7e856976912e3f952c8c5b96b674978">createFEToAssembleMatrixAndVector</a>(</div>
<div class="line">  <a class="code" href="structExactFunction.html">ExactFunction</a>(),<a class="code" href="structExactLaplacianFunction.html">ExactLaplacianFunction</a>(),</div>
<div class="line">  domain_lhs_fe,boundary_lhs_fe,domain_rhs_fe,boundary_rhs_fe</div>
<div class="line">); </div>
<div class="line"><span class="comment">// Add problem specific operators the generic finite elements to calculate error on elements and global error</span></div>
<div class="line"><span class="comment">// in H1 norm</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1CreateFiniteElements.html">PoissonExample::CreateFiniteElements</a>(m_field).<a class="code" href="structPoissonExample_1_1CreateFiniteElements.html#ae250a14f45127e19c97e17df96252329">createFEToEvaluateError</a>(</div>
<div class="line">  <a class="code" href="structExactFunction.html">ExactFunction</a>(),<a class="code" href="structExactFunctionGrad.html">ExactFunctionGrad</a>(),global_error,domain_error</div>
<div class="line">); </div>
<div class="line"><span class="comment">// Post-process results</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1CreateFiniteElements.html">PoissonExample::CreateFiniteElements</a>(m_field).<a class="code" href="structPoissonExample_1_1CreateFiniteElements.html#a63d3da59aa561779e9e56bf4284ceeea">creatFEToPostProcessResults</a>(post_proc_volume); </div>
</div><!-- fragment --><p> Note that those implementations are problem independent, we could use them in a different problems context. To make that more visible, we create those elements before fields and problem are defined and built. The purpose of finite elements is shown in Figure 3 and Figure 4, by users data operators added to a finite element. Finite element "domain_lhs_fe" is used to calculate the matrix by using <a class="el" href="structPoissonExample_1_1OpK.html" title="Calculate the grad-grad operator and assemble matrix.">PoissonExample::OpK</a>, finite element "domain_rhs_fe" is used with <a class="el" href="structPoissonExample_1_1OpF.html" title="Operator calculate source term,.">PoissonExample::OpF</a>. Similarly for a boundary, operators <a class="el" href="structPoissonExample_1_1OpC.html" title="Calculate constrains matrix.">PoissonExample::OpC</a> and <a class="el" href="structPoissonExample_1_1Op__g.html" title="Assemble constrains vector.">PoissonExample::Op_g</a> are used to integrate matrices and right vector for Lagrange multipliers, with finite elements "boundary_lhs_fe" and "boundary_rhs_fe", respectively. The operators <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldValues.html" title="Get value at integration points for scalar field.">MoFEM::OpCalculateScalarFieldValues</a>, <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> and <a class="el" href="structPoissonExample_1_1OpError.html" title="Evaluate error.">PoissonExample::OpError</a> are used to integrate error in H1 norm in domain. Finite element "post_proc_volume" is used to post-process results for <a href="https://www.paraview.org">ParaView</a> (or another visualization tool), it has a set of specialised operators saving results on nodes and allows to refine mesh when ho-approximation is used. The result can be stored for example on 10-node tetrahedra if needed. More details about implementation of <a class="el" href="structPoissonExample_1_1CreateFiniteElements.html" title="Create finite elements instances.">PoissonExample::CreateFiniteElements</a> and operators is in <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a>. Basic of user data operators are explained here <a class="el" href="general_data_structure.html">MoFEM Architecture</a>.</p>
<div class="image">
<img src="poisson_tut1_fig3.png" alt="" width="700px"/>
<div class="caption">
Figure 3. Operators of volume finite element</div></div>
 <div class="image">
<img src="poisson_tut1_fig4.png" alt="" width="400px"/>
<div class="caption">
Figure 4. Operators of boundary finite element</div></div>
<h2><a class="anchor" id="poisson_tut1_code_disection_ss4"></a>
Simple interface</h2>
<ul>
<li>First, we ask <a class="el" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a> for access to <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a> interface. Creation and deletion of the interface are managed internally and are returned as a pointer <div class="fragment"><div class="line">Simple *simple_interface;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(simple_interface); </div>
</div><!-- fragment --></li>
<li>Now we load a mesh file and get additional options related to simple interface <div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;getOptions(); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;loadFile(); </div>
</div><!-- fragment --></li>
<li>Next, we add fields and set approximation orders to each of them <div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;addDomainField(<span class="stringliteral">&quot;U&quot;</span>,<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,1); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;addBoundaryField(<span class="stringliteral">&quot;L&quot;</span>,<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,1); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;addDataField(<span class="stringliteral">&quot;ERROR&quot;</span>,<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>,<a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,1); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setFieldOrder(<span class="stringliteral">&quot;U&quot;</span>,<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);  <span class="comment">// to approximate function</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setFieldOrder(<span class="stringliteral">&quot;L&quot;</span>,<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);  <span class="comment">// to Lagrange multipliers</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setFieldOrder(<span class="stringliteral">&quot;ERROR&quot;</span>,0);  <span class="comment">// approximation order for error</span></div>
</div><!-- fragment --> Note that fields of "U" and Lagrange multipliers "L" are in space H1, error field is in L2 space to store error on each element.</li>
<li>Finally, problem is built by triggering the set-up procedure <div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setUp(); </div>
</div><!-- fragment --></li>
</ul>
<h2><a class="anchor" id="poisson_tut1_code_disection_ss5"></a>
Solution of the problem</h2>
<p>Before we start running PETSc solver, we need to get access to DM manager, it can be simply done by </p><div class="fragment"><div class="line">DM dm;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;getDM(&amp;dm); </div>
</div><!-- fragment --><p> Note that user takes responsibility for deleting DM object.</p>
<p>Once we have DM, we add instances of previously created finite elements with their operators to DM manager, appropriately to calculate matrix and the right-hand side </p><div class="fragment"><div class="line"><span class="comment">// Set operators for KSP solver</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gadf1d5425969ed88f332549c5b4ba5291">DMMoFEMKSPSetComputeOperators</a>(</div>
<div class="line">  dm,simple_interface-&gt;getDomainFEName(),domain_lhs_fe,<span class="keyword">null</span>,<span class="keyword">null</span></div>
<div class="line">); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gadf1d5425969ed88f332549c5b4ba5291">DMMoFEMKSPSetComputeOperators</a>(</div>
<div class="line">  dm,simple_interface-&gt;getBoundaryFEName(),boundary_lhs_fe,<span class="keyword">null</span>,<span class="keyword">null</span></div>
<div class="line">); </div>
<div class="line"><span class="comment">// Set calculation of the right hand side vetor for KSP solver</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga96ba475206db6215c72937e77047415c">DMMoFEMKSPSetComputeRHS</a>(</div>
<div class="line">  dm,simple_interface-&gt;getDomainFEName(),domain_rhs_fe,<span class="keyword">null</span>,<span class="keyword">null</span></div>
<div class="line">); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga96ba475206db6215c72937e77047415c">DMMoFEMKSPSetComputeRHS</a>(</div>
<div class="line">  dm,simple_interface-&gt;getBoundaryFEName(),boundary_rhs_fe,<span class="keyword">null</span>,<span class="keyword">null</span></div>
<div class="line">); </div>
</div><!-- fragment --><p>At that point, we can solve the problem, applying functions exclusively from native PETSc interface </p><div class="fragment"><div class="line"><span class="comment">// Create the right hand side vector and vector of unknowns</span></div>
<div class="line"><a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm,&amp;<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>); </div>
<div class="line"><span class="comment">// Create unknown vector by creating duplicate copy of F vector. only</span></div>
<div class="line"><span class="comment">// structure is duplicated no values.</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,&amp;<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>); </div>
<div class="line"><span class="comment">// Create solver and link it to DM</span></div>
<div class="line">KSP solver;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPCreate(PETSC_COMM_WORLD,&amp;solver); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(solver); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetDM(solver,dm); </div>
<div class="line"><span class="comment">// Set-up solver, is type of solver and pre-conditioners</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(solver); </div>
<div class="line"><span class="comment">// At solution process, KSP solver using DM creates matrices, Calculate</span></div>
<div class="line"><span class="comment">// values of the left hand side and the right hand side vector. then</span></div>
<div class="line"><span class="comment">// solves system of equations. Results are stored in vector D.</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(solver,<a class="code" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>); </div>
</div><!-- fragment --><p> In the above code, KSP solver takes control. The KSP solver is using DM creates matrix and calls DM functions to iterate over finite elements and assembles matrix and vectors. KSP solver knows how to do it since it is using <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> DM which we registered at the very beginning, and get an instance of particular DM from <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a> interface. While DM is iterating over finite elements, finite elements instance executes user data operators.</p>
<p>Once we have the solution, DOFs values in solution vector are scattered on the mesh </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gad94692d0472b346672a25c63e91fb930">DMoFEMMeshToGlobalVector</a>(dm,<a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>,INSERT_VALUES,SCATTER_REVERSE); </div>
</div><!-- fragment --><p>The role of <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is evident here, having topology (mesh) in MoAB database, <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is used to manage complexities related to problem discretization and construction of algebraic systems of equations (linear in this case). Meanwhile, PETSc manages complexities related to algebra and solution of the problem. For more details about the interaction of MoAB, <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and PETSc, see <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> software ecosystem in <a class="el" href="general_data_structure.html">MoFEM Architecture</a>.</p>
<p>Finally, we can evaluate error and verify correctness of the solution </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm,simple_interface-&gt;getDomainFEName(),domain_error); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1AuxFunctions.html">PoissonExample::AuxFunctions</a>(m_field).<a class="code" href="structPoissonExample_1_1AuxFunctions.html#aa46eb103d077a4900ab68dec1c553ce0">assembleGhostVector</a>(global_error); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1AuxFunctions.html">PoissonExample::AuxFunctions</a>(m_field).<a class="code" href="structPoissonExample_1_1AuxFunctions.html#ac14c3f26684ae673c003e7f990186073">printError</a>(global_error); </div>
<div class="line"><span class="keywordflow">if</span>(flg_test == PETSC_TRUE) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1AuxFunctions.html">PoissonExample::AuxFunctions</a>(m_field).<a class="code" href="structPoissonExample_1_1AuxFunctions.html#a6bc4cd5c9f9ee29f123a6f67fadf35f5">testError</a>(global_error); </div>
<div class="line">}</div>
</div><!-- fragment --><p> Note that function DMoFEMLoopFiniteElements takes finite element instance "domain_error" and applies it to finite element entities in the problem. For each finite element entity, finite element instance is called, and sequence of user data operators are executed on that element.</p>
<h2><a class="anchor" id="poisson_tut1_code_disection_ss6"></a>
Post-processing</h2>
<p>Finally, we will create a mesh for post-processing. Note that, in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>, we work with spaces that not necessarily have physical DOFs at the nodes, i.e. higher order polynomials or spaces like H-div, H-curl or L2. Discontinuities on elements edges have to be shown in post-processing accurately. To resolve this issue, a set of user data operators has been created to manage those problems, see <a class="el" href="structPostProcCommonOnRefMesh.html" title="Set of operators and data structures used for post-processing.">PostProcCommonOnRefMesh</a> for details. Here, we directly run the code </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm,simple_interface-&gt;getDomainFEName(),post_proc_volume); </div>
<div class="line"><span class="comment">// Write results</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> boost::static_pointer_cast&lt;PostProcVolumeOnRefinedMesh&gt;(post_proc_volume)-&gt;writeFile(<span class="stringliteral">&quot;out_vol.h5m&quot;</span>); </div>
</div><!-- fragment --><h1><a class="anchor" id="poisson_tut1_running_program"></a>
Running the program</h1>
<p>In order to run the program, one should first go to the directory where the problem is located, compile the code and then run the executable file. Typically, this can be done as follows</p>
<div class="fragment"><div class="line">cd mofem_install/um/build/basic_finite_elements/poisson</div>
<div class="line">make -j2</div>
<div class="line">mpirun -np 2  ./analytical_poisson -file_name cube_2part.h5m -<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> 3</div>
</div><!-- fragment --><p>The options are explained as follows</p><ul>
<li>We are running parallel code, <em>mpirun</em> <em>-np</em> <em>2</em> indicates that you will use two processors to run analysis</li>
<li><em></em>./analytical_poisson is the name and location of the executable file, dot means current directory</li>
<li><em>-file_name</em> cube_2part.h5m is the name of the mesh file, here partitioned for two processors</li>
<li><em>-order</em> 3 is approximation order. Since exact function is polynomial of order 3, solution from finite element method would be exact.</li>
</ul>
<h2><a class="anchor" id="poisson_tut1_running_program_output"></a>
Output dissection</h2>
<p><b>Initialization</b> </p>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> version and commit ID </p><pre class="fragment">MoFEM version 0.8.13 (MOAB 5.0.2 Petsc Release Version 3.9.3, Jul, 02, 2018 ) 
git commit id 549c206e489d605e1c9d531f5d463b99ec2adc32
</pre><p><b>Declarations</b> </p>
<ul>
<li>Three fields added to the database <pre class="fragment">add: name U BitFieldId 1 bit number 1 space H1 approximation base AINSWORTH_LEGENDRE_BASE rank 1 meshset 12682136550675316760
add: name L BitFieldId 2 bit number 2 space H1 approximation base AINSWORTH_LEGENDRE_BASE rank 1 meshset 12682136550675316761
add: name ERROR BitFieldId 4 bit number 3 space L2 approximation base AINSWORTH_LEGENDRE_BASE rank 1 meshset 12682136550675316762
</pre></li>
<li>Two elements, domain element and boundary element, added to the database <pre class="fragment">add finite element: dFE
add finite element: bFE
</pre></li>
<li>Add problem <pre class="fragment">add problem: SimpleProblem
</pre></li>
</ul>
<p><b>Set-up</b> </p>
<ul>
<li>Build fields. For each field, the number of active DOFs on entities are listed. For example, for "U" field, since it is 3rd approximation order for space H1, DOFs are on vertices, edges and faces (here triangles). If the 4th order of approximation is applied, DOFs would be located on volumes. <pre class="fragment">Build Field U (rank 0)
nb added dofs (vertices) 180 (inactive 0)
nb added dofs (edges) 1852 (inactive 0)
nb added dofs (triangles) 1368 (inactive 0)
nb added dofs 3400 (number of inactive dofs 0)
Build Field L (rank 0)
nb added dofs (vertices) 96 (inactive 0)
nb added dofs (edges) 528 (inactive 0)
nb added dofs (triangles) 169 (inactive 0)
nb added dofs 793 (number of inactive dofs 0)
Build Field ERROR (rank 0)
nb added dofs (tets) 621 (inactive 0)
nb added dofs 621 (number of inactive dofs 0)
Nb. dofs 4814
Build Field U (rank 1)
nb added dofs (vertices) 177 (inactive 0)
nb added dofs (edges) 1814 (inactive 0)
nb added dofs (triangles) 1333 (inactive 0)
nb added dofs 3324 (number of inactive dofs 0)
Build Field L (rank 1)
nb added dofs (vertices) 99 (inactive 0)
nb added dofs (edges) 546 (inactive 0)
nb added dofs (triangles) 175 (inactive 0)
nb added dofs 820 (number of inactive dofs 0)
Build Field ERROR (rank 1)
nb added dofs (tets) 602 (inactive 0)
nb added dofs 602 (number of inactive dofs 0)
Nb. dofs 4746
</pre></li>
<li>Build finite elements (note output is listed twice for each process). Numbers at the end shows how many finite elements is on each processor. Distribution of finite elements depends on used graph partitioning method, here ParMetis has been used to partition mesh <pre class="fragment">Build Finite Elements dFE
id 00000000000000000000000000000001 name dFE f_id_row 00000000000000000000000000000001 f_id_col 00000000000000000000000000000001 BitFEId_data 00000000000000000000000000000101 Nb. FEs 621
id 00000000000000000000000000000001 name dFE f_id_row 00000000000000000000000000000001 f_id_col 00000000000000000000000000000001 BitFEId_data 00000000000000000000000000000101 Nb. FEs 602
Build Finite Elements bFE
id 00000000000000000000000000000010 name bFE f_id_row 00000000000000000000000000000011 f_id_col 00000000000000000000000000000011 BitFEId_data 00000000000000000000000000000011 Nb. FEs 169
id 00000000000000000000000000000010 name bFE f_id_row 00000000000000000000000000000011 f_id_col 00000000000000000000000000000011 BitFEId_data 00000000000000000000000000000011 Nb. FEs 175
Nb. entFEAdjacencies 11681
Nb. entFEAdjacencies 11480
</pre></li>
<li>Build problem. Note that problem set-up should scale very well since little communication is needed to index DOFs and finite elements <pre class="fragment">partition_problem: rank = 0 FEs row ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. local dof 4193 nb global row dofs 7868
partition_problem: rank = 0 FEs col ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. local dof 4193 nb global col dofs 7868
partition_problem: rank = 1 FEs row ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. local dof 3675 nb global row dofs 7868
partition_problem: rank = 1 FEs col ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. local dof 3675 nb global col dofs 7868
problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. elems 790 on proc 0
problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. elems 777 on proc 1
partition_ghost_col_dofs: rank = 0 FEs col ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. col ghost dof 0 Nb. local dof 4193
partition_ghost_row_dofs: rank = 0 FEs row ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. row ghost dof 0 Nb. local dof 4193
partition_ghost_col_dofs: rank = 1 FEs col ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. col ghost dof 469 Nb. local dof 3675
partition_ghost_row_dofs: rank = 1 FEs row ghost dofs problem id 00000000000000000000000000000001 FiniteElement id 00000000000000000000000000000011 name SimpleProblem Nb. row ghost dof 469 Nb. local dof 3675
</pre></li>
</ul>
<p><b>Solution</b> </p>
<ul>
<li>KSP solver output. Here MUMPS is applied as a pre-conditioner to solve the problem with GMRES solver. <pre class="fragment">0 KSP Residual norm 6.649855786390e-01
1 KSP Residual norm 6.776852388524e-14
</pre></li>
<li>Errors <pre class="fragment">Approximation error 2.335e-15
</pre></li>
</ul>
<h2><a class="anchor" id="poisson_tut1_running_program_visualisation"></a>
Visualization</h2>
<p>Once we have the solution, you can convert the file to VTK and open it in ParaView as shown in Figure 4 </p><div class="fragment"><div class="line">mbconvert out_vol.h5m out_vol.vtk</div>
<div class="line">open out_vol.vtk</div>
</div><!-- fragment --><div class="image">
<img src="poisson_tut1_fig5.png" alt="" width="800px"/>
<div class="caption">
Figure 5. ParaView and result</div></div>
<h2><a class="anchor" id="poisson_tut1_running_genrating_mesh"></a>
Mesh formats</h2>
<p>Since we are using a polynomial of 3rd order to approximate solution, results will not change if you would use coarser or finer mesh. You can generate mesh in <a href="http://gmsh.info">gMesh</a>, <a href="http://www.salome-platform.org">Salome</a> or generate mesh in any format on the list </p><pre class="fragment">Format        Name                            Read    Write   File name description
-----------------------------------------------------------------------------------
MOAB          MOAB native (HDF5)              yes    yes     h5m mhdf
EXODUS        Exodus II                       yes    yes     exo exoII exo2 g gen
NC            Climate NC                      yes    yes     nc
UNV           IDEAS format                    yes     no     unv
MESHTAL       MCNP5 format                    yes     no     meshtal
NAS           NASTRAN format                  yes     no     nas bdf
Abaqus        mesh  ABAQUS INP mesh format    yes     no     abq
Atilla        RTT Mesh  RTT Mesh Format       yes     no     rtt
VTK           Kitware VTK                     yes    yes     vtk
OBJ mesh      OBJ mesh format                 yes     no     obj
SMS           RPI SMS                         yes     no     sms
CUBIT         Cubit                           yes     no     cub
SMF           QSlim format                    yes    yes     smf
SLAC          SLAC                             no    yes     slac
GMV           GMV                              no    yes     gmv
ANSYS         Ansys                            no    yes     ans
GMSH          Gmsh mesh file                  yes    yes     msh gmsh
STL           Stereo Lithography File (STL)   yes    yes     stl
TETGEN        TetGen output files             yes     no     node ele face edge
TEMPLATE      Template input files            yes    yes
</pre><p> You can obtain that list executing from the command line </p><div class="fragment"><div class="line">mbconvert -<a class="code" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div>
</div><!-- fragment --><h1><a class="anchor" id="poisson_tut1_excercise"></a>
Exercises</h1>
<ul>
<li>Exercise 1: Change approximation order. Make it smaller than 3rd order or make it larger, what happens? Can you explain this?</li>
<li>Exercise 2: Change exact displacement function, for example to trigonometric function. Can you reproduce the exact solution in such this case? Can you explain your results? Try <p class="formulaDsp">
\[ u = sin(kx) \]
</p>
 where \(k\) is a small number.</li>
<li>Exercise 3: Change code to calculate L2 error norm or semi norm for H1 space, see <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a></li>
<li>Exercise 4: Calculate norm of the solution and exact function.</li>
<li>Exercise 5: Make convergence plots for polynomial and trigonometric exact functions.</li>
</ul>
<p>Please feel free to ask any questions on our Q&amp;A forum, see <a href="https://groups.google.com/forum/#!forum/mofem-group">link</a>.</p>
<h1><a class="anchor" id="poisson_tut1_notes"></a>
Notes</h1>
<dl class="section note"><dt>Note</dt><dd>This is similar test to one from <a href="https://fenicsproject.org/pub/tutorial/html/._ftut1004.html#ch:fundamentals">https://fenicsproject.org/pub/tutorial/html/._ftut1004.html#ch:fundamentals</a>. </dd></dl>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astructPoissonExample_1_1AuxFunctions_html"><div class="ttname"><a href="structPoissonExample_1_1AuxFunctions.html">PoissonExample::AuxFunctions</a></div><div class="ttdef"><b>Definition:</b> <a href="AuxPoissonFunctions_8hpp_source.html#l00014">AuxPoissonFunctions.hpp:14</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="agroup__dm_html_ga96ba475206db6215c72937e77047415c"><div class="ttname"><a href="group__dm.html#ga96ba475206db6215c72937e77047415c">MoFEM::DMMoFEMKSPSetComputeRHS</a></div><div class="ttdeci">PetscErrorCode DMMoFEMKSPSetComputeRHS(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set KSP right hand side evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00637">DMMoFEM.cpp:637</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt; double, 3 &gt;</a></div></div>
<div class="ttc" id="aAuxPoissonFunctions_8hpp_html"><div class="ttname"><a href="AuxPoissonFunctions_8hpp.html">AuxPoissonFunctions.hpp</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html">PoissonExample::CreateFiniteElements</a></div><div class="ttdoc">Create finite elements instances.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00861">PoissonOperators.hpp:861</a></div></div>
<div class="ttc" id="agroup__dm_html_gadf1d5425969ed88f332549c5b4ba5291"><div class="ttname"><a href="group__dm.html#gadf1d5425969ed88f332549c5b4ba5291">MoFEM::DMMoFEMKSPSetComputeOperators</a></div><div class="ttdeci">PetscErrorCode DMMoFEMKSPSetComputeOperators(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">Set KSP operators and push mofem finite element methods.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00678">DMMoFEM.cpp:678</a></div></div>
<div class="ttc" id="astructExactFunctionGrad_html"><div class="ttname"><a href="structExactFunctionGrad.html">ExactFunctionGrad</a></div><div class="ttdoc">Exact gradient.</div><div class="ttdef"><b>Definition:</b> <a href="analytical__nonlinear__poisson_8cpp_source.html#l00043">analytical_nonlinear_poisson.cpp:43</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="astructExactLaplacianFunction_html_a6b9269124ee9aebddf08ea9249a4b949"><div class="ttname"><a href="structExactLaplacianFunction.html#a6b9269124ee9aebddf08ea9249a4b949">ExactLaplacianFunction::operator()</a></div><div class="ttdeci">double operator()(const double x, const double y, const double z) const</div><div class="ttdef"><b>Definition:</b> <a href="analytical__nonlinear__poisson_8cpp_source.html#l00059">analytical_nonlinear_poisson.cpp:59</a></div></div>
<div class="ttc" id="astructExactFunction_html_a624aa0f96fa6b76dffb91979376510f0"><div class="ttname"><a href="structExactFunction.html#a624aa0f96fa6b76dffb91979376510f0">ExactFunction::operator()</a></div><div class="ttdeci">double operator()(const double x, const double y, const double z) const</div><div class="ttdef"><b>Definition:</b> <a href="analytical__nonlinear__poisson_8cpp_source.html#l00035">analytical_nonlinear_poisson.cpp:35</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_a63d3da59aa561779e9e56bf4284ceeea"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#a63d3da59aa561779e9e56bf4284ceeea">PoissonExample::CreateFiniteElements::creatFEToPostProcessResults</a></div><div class="ttdeci">MoFEMErrorCode creatFEToPostProcessResults(boost::shared_ptr&lt; PostProcFE &gt; &amp;post_proc_volume) const</div><div class="ttdoc">Create finite element to post-process results.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00947">PoissonOperators.hpp:947</a></div></div>
<div class="ttc" id="astructExactLaplacianFunction_html"><div class="ttname"><a href="structExactLaplacianFunction.html">ExactLaplacianFunction</a></div><div class="ttdoc">Laplacian of function.</div><div class="ttdef"><b>Definition:</b> <a href="analytical__nonlinear__poisson_8cpp_source.html#l00058">analytical_nonlinear_poisson.cpp:58</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1AuxFunctions_html_a6bc4cd5c9f9ee29f123a6f67fadf35f5"><div class="ttname"><a href="structPoissonExample_1_1AuxFunctions.html#a6bc4cd5c9f9ee29f123a6f67fadf35f5">PoissonExample::AuxFunctions::testError</a></div><div class="ttdeci">MoFEMErrorCode testError(Vec ghost_vec)</div><div class="ttdoc">Test error.</div><div class="ttdef"><b>Definition:</b> <a href="AuxPoissonFunctions_8hpp_source.html#l00073">AuxPoissonFunctions.hpp:73</a></div></div>
<div class="ttc" id="agroup__dm_html_gad94692d0472b346672a25c63e91fb930"><div class="ttname"><a href="group__dm.html#gad94692d0472b346672a25c63e91fb930">MoFEM::DMoFEMMeshToGlobalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToGlobalVector(DM dm, Vec g, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set ghosted vector values on all existing mesh entities</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00535">DMMoFEM.cpp:535</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1AuxFunctions_html_ac14c3f26684ae673c003e7f990186073"><div class="ttname"><a href="structPoissonExample_1_1AuxFunctions.html#ac14c3f26684ae673c003e7f990186073">PoissonExample::AuxFunctions::printError</a></div><div class="ttdeci">MoFEMErrorCode printError(Vec ghost_vec)</div><div class="ttdoc">Print error.</div><div class="ttdef"><b>Definition:</b> <a href="AuxPoissonFunctions_8hpp_source.html#l00060">AuxPoissonFunctions.hpp:60</a></div></div>
<div class="ttc" id="astructExactFunction_html"><div class="ttname"><a href="structExactFunction.html">ExactFunction</a></div><div class="ttdoc">Function.</div><div class="ttdef"><b>Definition:</b> <a href="analytical__nonlinear__poisson_8cpp_source.html#l00034">analytical_nonlinear_poisson.cpp:34</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="aPoissonOperators_8hpp_html"><div class="ttname"><a href="PoissonOperators_8hpp.html">PoissonOperators.hpp</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_ae250a14f45127e19c97e17df96252329"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#ae250a14f45127e19c97e17df96252329">PoissonExample::CreateFiniteElements::createFEToEvaluateError</a></div><div class="ttdeci">MoFEMErrorCode createFEToEvaluateError(boost::function&lt; double(const double, const double, const double)&gt; f_u, boost::function&lt; FTensor::Tensor1&lt; double, 3 &gt;(const double, const double, const double)&gt; g_u, Vec global_error, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;domain_error) const</div><div class="ttdoc">Create finite element to calculate error.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00911">PoissonOperators.hpp:911</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html_a6078a7f940fe823a1c1ccb4cc277e03e"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">ReactionDiffusionEquation::D</a></div><div class="ttdeci">const double D</div><div class="ttdoc">diffusivity</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00020">reaction_diffusion.cpp:20</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_ae7e856976912e3f952c8c5b96b674978"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#ae7e856976912e3f952c8c5b96b674978">PoissonExample::CreateFiniteElements::createFEToAssembleMatrixAndVector</a></div><div class="ttdeci">MoFEMErrorCode createFEToAssembleMatrixAndVector(boost::function&lt; double(const double, const double, const double)&gt; f_u, boost::function&lt; double(const double, const double, const double)&gt; f_source, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;domain_lhs_fe, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;boundary_lhs_fe, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;domain_rhs_fe, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;boundary_rhs_fe, bool trans=true) const</div><div class="ttdoc">Create finite element to calculate matrix and vectors.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00868">PoissonOperators.hpp:868</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1AuxFunctions_html_aa46eb103d077a4900ab68dec1c553ce0"><div class="ttname"><a href="structPoissonExample_1_1AuxFunctions.html#aa46eb103d077a4900ab68dec1c553ce0">PoissonExample::AuxFunctions::assembleGhostVector</a></div><div class="ttdeci">MoFEMErrorCode assembleGhostVector(Vec ghost_vec) const</div><div class="ttdoc">Assemble error vector.</div><div class="ttdef"><b>Definition:</b> <a href="AuxPoissonFunctions_8hpp_source.html#l00043">AuxPoissonFunctions.hpp:43</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="astructExactFunctionGrad_html_af810f655402a112ff533dc360dabf202"><div class="ttname"><a href="structExactFunctionGrad.html#af810f655402a112ff533dc360dabf202">ExactFunctionGrad::operator()</a></div><div class="ttdeci">FTensor::Tensor1&lt; double, 3 &gt; operator()(const double x, const double y, const double z) const</div><div class="ttdef"><b>Definition:</b> <a href="analytical__nonlinear__poisson_8cpp_source.html#l00044">analytical_nonlinear_poisson.cpp:44</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>