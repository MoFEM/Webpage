<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: users_modules/fracture_mechanics/src/impl/CPMeshCut.cpp Source File</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_4fdd23f46654bee42f0ef7ae5010b806.html">users_modules</a></li><li class="navelem"><a class="el" href="dir_7626fbc05232202d1d8bfa59989e6f33.html">fracture_mechanics</a></li><li class="navelem"><a class="el" href="dir_07077e7f1516256a5d6d7071e8df818e.html">src</a></li><li class="navelem"><a class="el" href="dir_2330faccad92f32be9236dbecc1648e3.html">impl</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">CPMeshCut.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="CPMeshCut_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/** \file CPSolvers.cpp</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> */</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160; </div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment">/* This file is part of MoFEM.</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> * MoFEM is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * the terms of the GNU Lesser General Public License as published by the</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> * Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> * option) any later version.</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * MoFEM is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> * License for more details.</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * License along with MoFEM. If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160; </div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#ifdef WITH_TETGEN</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="preprocessor">#include &lt;tetgen.h&gt;</span></div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="preprocessor">#ifdef REAL</span></div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="preprocessor">#undef REAL</span></div>
<div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="preprocessor">#endif</span></div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160; </div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Mortar_8hpp.html">Mortar.hpp</a>&gt;</span></div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="NeoHookean_8hpp.html">NeoHookean.hpp</a>&gt;</span></div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="Hooke_8hpp.html">Hooke.hpp</a>&gt;</span></div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160; </div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="CrackFrontElement_8hpp.html">CrackFrontElement.hpp</a>&gt;</span></div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="ComplexConstArea_8hpp.html">ComplexConstArea.hpp</a>&gt;</span></div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="MWLS_8hpp.html">MWLS.hpp</a>&gt;</span></div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="GriffithForceElement_8hpp.html">GriffithForceElement.hpp</a>&gt;</span></div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160; </div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="preprocessor">#include &lt;VolumeLengthQuality.hpp&gt;</span></div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="CrackPropagation_8hpp.html">CrackPropagation.hpp</a>&gt;</span></div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="preprocessor">#include &lt;<a class="code" href="CPMeshCut_8hpp.html">CPMeshCut.hpp</a>&gt;</span></div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160; </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">namespace </span><a class="code" href="namespaceFractureMechanics.html">FractureMechanics</a> {</div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160; </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a name="l00045"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a035106e51ac3d931a68d52df374f8e84">   45</a></span>&#160;CPMeshCut::query_interface(boost::typeindex::type_index type_index,</div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;                           <a class="code" href="structMoFEM_1_1UnknownInterface.html">UnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00047"></a><span class="lineno">   47</span>&#160;  *iface = <span class="keyword">const_cast&lt;</span><a class="code" href="structFractureMechanics_1_1CPMeshCut.html">CPMeshCut</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;}</div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160; </div>
<div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a60da5d0a79906a1ee01dcc46862d8de6">   51</a></span>&#160;CPMeshCut::CPMeshCut(<a class="code" href="structFractureMechanics_1_1CrackPropagation.html">CrackPropagation</a> &amp;cp) : cP(cp) {</div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">getInterfacesPtr</a>();</div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;  CHKERRABORT(PETSC_COMM_SELF, <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160; </div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">try</span> {</div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;    <a class="code" href="group__mofem__log__manager.html#gab5e77a98a6ecc9e134bd34fdb161f80a">MoFEM::LogManager::getLog</a>(<span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>);</div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;  } <span class="keywordflow">catch</span> (...) {</div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;    <span class="keyword">auto</span> core_log = logging::core::get();</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    core_log-&gt;add_sink(</div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;        LogManager::createSink(LogManager::getStrmSelf(), <span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>));</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;    LogManager::setLog(<span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>);</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    core_log-&gt;add_sink(</div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;        LogManager::createSink(LogManager::getStrmWorld(), <span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>));</div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    LogManager::setLog(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>);</div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    core_log-&gt;add_sink(</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;        LogManager::createSink(LogManager::getStrmSync(), <span class="stringliteral">&quot;CPMeshCutSync&quot;</span>));</div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    LogManager::setLog(<span class="stringliteral">&quot;CPMeshCutSync&quot;</span>);</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <a class="code" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CPMeshCutSelf&quot;</span>, <span class="stringliteral">&quot;CPMeshCut&quot;</span>);</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;    <a class="code" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, <span class="stringliteral">&quot;CPMeshCut&quot;</span>);</div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;    <a class="code" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CPMeshCutSync&quot;</span>, <span class="stringliteral">&quot;CPMeshCut&quot;</span>);</div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;  }</div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160; </div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;  <a class="code" href="group__mofem__log__manager.html#gafa1c3eb219cdb812ccdb6bad1a7a1454">MOFEM_LOG_FUNCTION</a>();</div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;CPMeshCutSelf interface created&quot;</span>;</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;}</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160; </div>
<div class="line"><a name="l00077"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">   77</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">CPMeshCut::getInterfacesPtr</a>() {</div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>);</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>);</div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>);</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;}</div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160; </div>
<div class="line"><a name="l00085"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#aa00fad9f771a0e8338dcaec2e29e724f">   85</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa00fad9f771a0e8338dcaec2e29e724f">CPMeshCut::getOptions</a>() {</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160; </div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;  PetscBool shift_flg;</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordtype">int</span> nmax_shift = 3;</div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160; </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Mesh cut options&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160; </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a> = 100;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-edges_block_set&quot;</span>, <span class="stringliteral">&quot;edges side set&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a09cc55b947e434358857d740bdd1c99d">edgesBlockSetFlg</a>);</div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a> = 101;</div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-vertex_block_set&quot;</span>, <span class="stringliteral">&quot;vertex block set&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, PETSC_NULL);</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;  <span class="comment">//to resolve issues with newer cubit</span></div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a> = 102;</div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-vertex_node_set&quot;</span>, <span class="stringliteral">&quot;vertex node set&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, PETSC_NULL);</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a> = 2;</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-fraction_level&quot;</span>, <span class="stringliteral">&quot;fraction of merges merged&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>, PETSC_NULL);</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a> = 1e-2;</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-tol_cut&quot;</span>, <span class="stringliteral">&quot;get tolerance for cut edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;                            <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>, PETSC_NULL);</div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a> = 2e-1;</div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-tol_cut_close&quot;</span>, <span class="stringliteral">&quot;get tolerance for cut edges&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                            <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>, PETSC_NULL);</div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a> = 2e-1;</div>
<div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-tol_trim_close&quot;</span>, <span class="stringliteral">&quot;get tolerance for trim edges&quot;</span>,</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;                            <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>, PETSC_NULL);</div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160; </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-cut_debug_cut&quot;</span>, <span class="stringliteral">&quot;debug mesh cutting&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>,</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;                          &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>, NULL);</div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160; </div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a> = PETSC_FALSE;</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;      <span class="stringliteral">&quot;-remove_pathological_front_tris&quot;</span>,</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;      <span class="stringliteral">&quot;remove triangles which have three nodes on crack front&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a>, NULL);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160; </div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -fraction_level %d&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -tol_cut %6.4e&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>);</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -tol_cut_close %6.4e&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>);</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -tol_trim_close %6.4e&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>);</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160; </div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;  PetscBool crack_surf_mesh_flg;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordtype">char</span> crack_surf_mesh_name[255];</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(</div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;      <span class="stringliteral">&quot;-my_cut_surface_file&quot;</span>, <span class="stringliteral">&quot;file with crack surface for initial cut&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;      crack_surf_mesh_name, crack_surf_mesh_name, 255, &amp;crack_surf_mesh_flg);</div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;  <span class="keywordflow">if</span> (crack_surf_mesh_flg)</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a> = std::string(crack_surf_mesh_name);</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160; </div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>[0] = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>[1] = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>[2] = 0;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsRealArray(<span class="stringliteral">&quot;-crack_shift&quot;</span>, <span class="stringliteral">&quot;shift surface by vector&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>, &amp;nmax_shift, &amp;shift_flg);</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a> = 400;</div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;      <span class="stringliteral">&quot;-cut_surface_side_set&quot;</span>, <span class="stringliteral">&quot;sideset id with cutting surface&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, PETSC_NULL);</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a> = 102;</div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-body_skin&quot;</span>, <span class="stringliteral">&quot;body skin sideset id&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, PETSC_NULL);</div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a> = 200;</div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-crack_side_set&quot;</span>, <span class="stringliteral">&quot;sideset id with crack surface&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, PETSC_NULL);</div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a> = 201;</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-front_side_set&quot;</span>, <span class="stringliteral">&quot;sideset id with crack front&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, PETSC_NULL);</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160; </div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> = 0;</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-ref_before_cut&quot;</span>, <span class="stringliteral">&quot;number of refinements before cut&quot;</span>,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                         <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>, PETSC_NULL);</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -ref_before_cut %d&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>);</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160; </div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a> = 0;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  PetscBool flg = PETSC_FALSE;</div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-ref_before_tim&quot;</span>, <span class="stringliteral">&quot;number of refinements before trim&quot;</span>,</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;                         <span class="stringliteral">&quot;&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;flg);</div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;  <span class="keywordflow">if</span> (flg == PETSC_TRUE) {</div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform)</div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        &lt;&lt; <span class="stringliteral">&quot;### Input parameter: -ref_before_tim is still valid but will be &quot;</span></div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;           <span class="stringliteral">&quot;made obsolete in the next release, please use -ref_before_trim &quot;</span></div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;           <span class="stringliteral">&quot;instead.&quot;</span>;</div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;  }</div>
<div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160; </div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-ref_before_trim&quot;</span>,</div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;                         <span class="stringliteral">&quot;number of refinements before trim&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;                         <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, PETSC_NULL);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -ref_before_trim %d&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>);</div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160; </div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> = -1;</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;      <span class="stringliteral">&quot;-my_cracked_body_block_set&quot;</span>, <span class="stringliteral">&quot;blockset id of the cracked body&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, PETSC_NULL);</div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160; </div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;              <span class="stringliteral">&quot;### Input parameter: -my_cracked_body_block_set %d&quot;</span>,</div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;              <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>);</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160; </div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a> = 10000;</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(</div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      <span class="stringliteral">&quot;-my_contact_prisms_block_set&quot;</span>, <span class="stringliteral">&quot;blockset id of contact prisms&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, PETSC_NULL);</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160; </div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <a class="code" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <span class="keywordflow">if</span> (shift_flg &amp;&amp; nmax_shift != 3) {</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;three values expected&quot;</span>);</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;  }</div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160; </div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;}</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160; </div>
<div class="line"><a name="l00209"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#ae0315c5240da22b778d5dbed90e6d01a">  209</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae0315c5240da22b778d5dbed90e6d01a">CPMeshCut::setVolume</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;  <a class="code" href="classRange.html">Range</a> bit_tets;</div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                                                 MBTET, bit_tets);</div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ac49c841036ab310c3ade79eff45ddc1f">setVolume</a>(bit_tets);</div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;}</div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160; </div>
<div class="line"><a name="l00218"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#aac80b6de09e6f065a25a8b2a8f30f9bd">  218</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aac80b6de09e6f065a25a8b2a8f30f9bd">CPMeshCut::refineMesh</a>(<span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> *vol, <span class="keyword">const</span> <span class="keywordtype">bool</span> make_front,</div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;                                     <span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160; </div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;  <span class="keywordflow">if</span> (vol) {</div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga57f6316b2f1061a314f40eb794d733ab">setBitRefLevel</a>(</div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        *vol, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - 1), <span class="keyword">true</span>, verb);</div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ac49c841036ab310c3ade79eff45ddc1f">setVolume</a>(*vol);</div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;  } <span class="keywordflow">else</span></div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="comment">// Set cutted front</span></div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae0315c5240da22b778d5dbed90e6d01a">setVolume</a>(<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - 1));</div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160; </div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a557a1b16f8c7516726e4a1e85cc8ff17">setMeshOrgCoords</a>();</div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160; </div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;  <span class="keywordflow">if</span> (make_front)</div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    <span class="comment">// make crack front from mesh skin</span></div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ad76d17c62d4f9337953222d2092697ab">makeFront</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160; </div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;  <span class="keyword">auto</span> save_entities = [&amp;](<span class="keyword">const</span> std::string name, <a class="code" href="classRange.html">Range</a> ents) {</div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (!ents.empty()) {</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().add_entities(meshset, ents);</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                             1);</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    }</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;  };</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160; </div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  <span class="comment">// build tree</span></div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#a67d0cdac80f09af5b4d821c671600ae9">buildTree</a>();</div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// refine and calculate level sets</span></div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  std::size_t idx = 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.test(idx))</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;    ++idx;</div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ae6cdd41a72a83c1e08ff57742b85da95">refineMesh</a>(idx, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, &amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>,</div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160; </div>
<div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;  <span class="keyword">auto</span> set_last_bit_ref = [&amp;]() {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>) {</div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bits;</div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 1; ll &lt;= <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a> + 2; ++ll)</div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        bits.set(ll);</div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask = bits;</div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#a42896dd46513db84c3a4c8e49af197e6">delete_ents_by_bit_ref</a>(<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(20),</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                                              <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(20), <span class="keyword">true</span>,</div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                                              <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;      <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gae0020f4f7cf7b27b8562f77fe5f21cab">getEntitiesByRefLevel</a>(bits, mask, ents, verb);</div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;      ents = subtract(ents, ents.subset_by_type(MBENTITYSET));</div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga486c46f5509f4e3e1d2f92b474ca781a">addBitRefLevel</a>(ents, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(20));</div>
<div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;    }</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;  };</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_last_bit_ref();</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160; </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="keyword">auto</span> shift_after_ref = [&amp;]() {</div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>) {</div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll &lt;= <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a> + 2; ++ll)</div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;        mask.set(ll);</div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">nbRefBeforCut</a> + <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">nbRefBeforTrim</a>, mask,</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                         verb, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  };</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> shift_after_ref();</div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160; </div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <span class="comment">// save coordinates to be later restored</span></div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a58d5922a7275bd9cc350d7678de4c909">getMeshOrgCoords</a>();</div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#aa269940e9fc185fb230e2b34f62641d8">writeEntitiesAllBitLevelsByType</a>(</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, <span class="stringliteral">&quot;all_after_ref_bits.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160; </div>
<div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a93023984d8c5a456c1e70090fda992c9">  301</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a93023984d8c5a456c1e70090fda992c9">CPMeshCut::setCutSurfaceFromFile</a>() {</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a>.empty()) {</div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_from_file;</div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                     meshset_from_file);</div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="comment">// FIXME:</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="comment">// if its cubit file (.cub) it will show the error :</span></div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;    <span class="comment">// [0]MOAB ERROR: -m-------------------- Error Message</span></div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;    <span class="comment">// ------------------------------------ [0]MOAB ERROR: Non-geometric entity</span></div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="comment">// provided! [0]MOAB ERROR: set_sense() line 741 in src/GeomTopoTool.cpp</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;    <span class="comment">// Failed to restore topology</span></div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="comment">//</span></div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="comment">// but the program will continue</span></div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().load_file(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a>.c_str(),</div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                                          &amp;meshset_from_file, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab5697439e436dae4f87c36567f05107a">cutSurfMeshName</a>.clear();</div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  }</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;}</div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160; </div>
<div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a1f749459397b97eed48150fa01167a2b">  322</a></span>&#160;PetscErrorCode <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1f749459397b97eed48150fa01167a2b">CPMeshCut::copySurface</a>(<span class="keyword">const</span> std::string save_mesh) {</div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; </div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>.clear();</div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>.clear();</div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160; </div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                <span class="stringliteral">&quot;Sideset %d with cutting crack surface not found\n&quot;</span>,</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;  }</div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                                               2, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160; </div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;  <span class="comment">// Copy surface</span></div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keyword">const_cast&lt;</span><a class="code" href="classRange.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>()).clear();</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#a08b8bbab5b73482ebe67655c8211e77b">copySurface</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, NULL, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a9d28e04e4051a19811351a0d38f012a0">sHift</a>, NULL, NULL, save_mesh);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160; </div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;}</div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a5d2fc244f49e0b52a81e52b9b9bb32ee">  344</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5d2fc244f49e0b52a81e52b9b9bb32ee">CPMeshCut::rebuildCrackSurface</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> factor,</div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                              <span class="keyword">const</span> std::string save_mesh,</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  Skinner skin(&amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>)</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160; </div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>];</div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160; </div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5edebe082848c57745b69722a9d173bc">setFixEdgesAndCorners</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;  <a class="code" href="classRange.html">Range</a> bit_edges;</div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160; </div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;  Tag th_griffith_force;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  Tag th_griffith_force_projected;</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  Tag th_w;</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;  Tag th_front_positions;</div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;  Tag th_area_change;</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  Tag th_material_force;</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160; </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  boost::shared_ptr&lt;OrientedBoxTreeTool&gt; tree_body_skin_ptr;</div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;  tree_body_skin_ptr = boost::shared_ptr&lt;OrientedBoxTreeTool&gt;(</div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keyword">new</span> OrientedBoxTreeTool(&amp;<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>(), <span class="stringliteral">&quot;ROOTSETSURF&quot;</span>, <span class="keyword">true</span>));</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> rootset_tree_body_skin;</div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="comment">  /// Maps nodes on old crack surface and new crack surface</span></div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;<span class="comment"></span>  std::map&lt;EntityHandle, EntityHandle&gt; verts_map;</div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160; </div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  <span class="comment">// Seed pseudo-random generator with step. Algorithm is deterministic.</span></div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  srand(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a06c3eddabfef8d0db78348fb8605842e">startStep</a>);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160; </div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  <span class="keyword">struct </span>SetFrontPositionsParameters {</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    <span class="keywordtype">double</span> tolRelSnapToFixedEdges; <span class="comment">///&lt; Relative tolerance to snap edges to</span></div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;<span class="comment"></span><span class="comment">                                   ///&lt; fixed edges</span></div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> tolAbsSnapToFixedEdges; <span class="comment">///&lt; Relative tolerance to snap edges to</span></div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;<span class="comment"></span><span class="comment">                                   ///&lt; fixed edges</span></div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> cornerFactor; <span class="comment">///&lt; extension of the edge beyond corner when node on</span></div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;<span class="comment"></span><span class="comment">                         ///&lt; corner edge</span></div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> skinFactor;   <span class="comment">///&lt; extension of cutting surface when node on the skin</span></div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;<span class="comment"></span>    <span class="keywordtype">double</span> endNodeEdgeDeltaFactor; <span class="comment">///&lt; End node edge extension</span></div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    SetFrontPositionsParameters() {</div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      tolRelSnapToFixedEdges = 0.1;</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      tolAbsSnapToFixedEdges = 0.;</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      cornerFactor = 0.2;</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      skinFactor = 0.2;</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      endNodeEdgeDeltaFactor = 0.2;</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa00fad9f771a0e8338dcaec2e29e724f">getOptions</a>();</div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      CHKERRABORT(PETSC_COMM_WORLD, <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    }</div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160; </div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa00fad9f771a0e8338dcaec2e29e724f">getOptions</a>() {</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160; </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;cutting_&quot;</span>,</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                               <span class="stringliteral">&quot;Set front positions&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160; </div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;          <span class="stringliteral">&quot;-surf_corner_factor&quot;</span>,</div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;          <span class="stringliteral">&quot;extension of the edge beyond corner when node on corer edge&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;          cornerFactor, &amp;cornerFactor, PETSC_NULL);</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;          <span class="stringliteral">&quot;-surf_skin_factor&quot;</span>,</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;          <span class="stringliteral">&quot;extension of cutting surface when node on the skin&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, skinFactor,</div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;          &amp;skinFactor, PETSC_NULL);</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;          <span class="stringliteral">&quot;-end_node_edge_delta_factor&quot;</span>,</div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;          <span class="stringliteral">&quot;extension of the front edge at the node on the surface&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;          endNodeEdgeDeltaFactor, &amp;endNodeEdgeDeltaFactor, PETSC_NULL);</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-snap_to_fixed_edge_rtol&quot;</span>,</div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;                                <span class="stringliteral">&quot;snap to fixed edges (relative tolerances)&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;                                tolRelSnapToFixedEdges, &amp;tolRelSnapToFixedEdges,</div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;                                PETSC_NULL);</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-snap_to_fixed_edge_atol&quot;</span>,</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;                                <span class="stringliteral">&quot;snap to fixed edges (absolute tolerances)&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;                                tolAbsSnapToFixedEdges, &amp;tolAbsSnapToFixedEdges,</div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;                                PETSC_NULL);</div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160; </div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                  <span class="stringliteral">&quot;### Input parameter: -cutting_surf_corner_factor %6.4e&quot;</span>,</div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;                  cornerFactor);</div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;                  <span class="stringliteral">&quot;### Input parameter: -cutting_surf_skin_factor %6.4e&quot;</span>,</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;                  skinFactor);</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          <span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;          <span class="stringliteral">&quot;### Input parameter: -cutting_end_node_edge_delta_factor %6.4e&quot;</span>,</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;          endNodeEdgeDeltaFactor);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                  <span class="stringliteral">&quot;### Input parameter: -cutting_snap_to_fixed_edge_rtol %6.4e&quot;</span>,</div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;                  tolRelSnapToFixedEdges);</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::inform,</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;                  <span class="stringliteral">&quot;### Input parameter: -cutting_snap_to_fixed_edge_atol %6.4e&quot;</span>,</div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                  tolAbsSnapToFixedEdges);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160; </div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a> = PetscOptionsEnd();</div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      <a class="code" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">ierr</a>);</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160; </div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    }</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;  };</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160; </div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;  <span class="keyword">auto</span> save_entities = [&amp;](<span class="keyword">const</span> std::string name, <a class="code" href="classRange.html">Range</a> ents) {</div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;    <span class="keywordflow">if</span> (!ents.empty()) {</div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().add_entities(meshset, ents);</div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;                                             1);</div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    }</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;  };</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160; </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;  <span class="keyword">auto</span> get_tags = [&amp;]() {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;GRIFFITH_FORCE&quot;</span>,</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;                                               th_griffith_force);</div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;GRIFFITH_FORCE_PROJECTED&quot;</span>,</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;                                               th_griffith_force_projected);</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;W&quot;</span>, th_w);</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;MATERIAL_FORCE&quot;</span>,</div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;                                               th_material_force);</div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160; </div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;FRONT_POSITIONS&quot;</span>,</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;                                               th_front_positions);</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_delete(th_front_positions);</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160; </div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="keywordtype">double</span> def_val[] = {0, 0, 0};</div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(</div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        <span class="stringliteral">&quot;FRONT_POSITIONS&quot;</span>, 3, MB_TYPE_DOUBLE, th_front_positions,</div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160; </div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;AREA_CHANGE&quot;</span>, th_area_change);</div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_delete(th_area_change);</div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160; </div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(</div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <span class="stringliteral">&quot;AREA_CHANGE&quot;</span>, 3, MB_TYPE_DOUBLE, th_area_change,</div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;        MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  };</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160; </div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;  <span class="keyword">auto</span> get_surface = [<span class="keyword">this</span>, &amp;<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>]() {</div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <a class="code" href="classRange.html">Range</a> <a class="code" href="namespacesurface.html#ac5b6e387c2c24e86299c80489d6838c0">surface</a>;</div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;                                                 <a class="code" href="namespacesurface.html">surface</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <a class="code" href="classRange.html">Range</a> bit_faces;</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;                                                   MBTRI, bit_faces);</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="keywordflow">return</span> intersect(<a class="code" href="namespacesurface.html">surface</a>, bit_faces);</div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  };</div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160; </div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;  <span class="keyword">auto</span> get_crack_front = [&amp;]() {</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_front;</div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;                                                 crack_front, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;    <a class="code" href="classRange.html">Range</a> bit_edges;</div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                                   MBEDGE, bit_edges);</div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;    <span class="keywordflow">return</span> intersect(crack_front, bit_edges);</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;  };</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160; </div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;  <span class="comment">// blockset where crack propagation takes place</span></div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;  <span class="keyword">auto</span> get_cracked_body_blockset = [&amp;]() {</div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    <a class="code" href="classRange.html">Range</a> cracked_body_tets;</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, cracked_body_tets, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;    <span class="keywordflow">return</span> cracked_body_tets;</div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  };</div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;  <span class="comment">// build tree to search distances to body surface</span></div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  <span class="keyword">auto</span> build_body_skin_tree =</div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;      [&amp;](boost::shared_ptr&lt;OrientedBoxTreeTool&gt; &amp;tree_body_skin_ptr,</div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;          <a class="code" href="classEntityHandle.html">EntityHandle</a> &amp;rootset_tree_body_skin) {</div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;        <a class="code" href="classRange.html">Range</a> last_bit_tets;</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;            <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - 1), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;            last_bit_tets);</div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;        <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> &gt; 0)</div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;          last_bit_tets = intersect(last_bit_tets, get_cracked_body_blockset());</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;        <a class="code" href="classRange.html">Range</a> last_bit_tets_skin;</div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, last_bit_tets, <span class="keyword">false</span>, last_bit_tets_skin);</div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tree_body_skin_ptr-&gt;build(last_bit_tets_skin,</div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;                                         rootset_tree_body_skin);</div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      };</div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160; </div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;  <span class="comment">// Set coords</span></div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;  <span class="keyword">auto</span> set_positions = [&amp;](<span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> nodes, Tag *<a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a> = <span class="keyword">nullptr</span>) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> coords(3 * nodes.size());</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>)</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(*<a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, nodes, &amp;*coords.begin());</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(nodes, &amp;*coords.begin());</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(th_front_positions, nodes,</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;                                             &amp;*coords.begin());</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;  };</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160; </div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;  <span class="keyword">auto</span> get_nodes = [<span class="keyword">this</span>](<a class="code" href="classRange.html">Range</a> edges) {</div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <a class="code" href="classRange.html">Range</a> verts;</div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(edges, verts, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    <span class="keywordflow">return</span> verts;</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;  };</div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160; </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;  <span class="keyword">auto</span> get_surface_skin = [<span class="keyword">this</span>, &amp;skin](<span class="keyword">auto</span> &amp;<a class="code" href="namespacesurface.html#ac5b6e387c2c24e86299c80489d6838c0">surface</a>) {</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;    <a class="code" href="classRange.html">Range</a> surface_skin;</div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>, surface_skin);</div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;    <span class="keywordflow">return</span> surface_skin;</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;  };</div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  <span class="keyword">auto</span> get_crack_front_ends = [<span class="keyword">this</span>, &amp;skin](<a class="code" href="classRange.html">Range</a> crack_front) {</div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <a class="code" href="classRange.html">Range</a> end_nodes;</div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, crack_front, <span class="keyword">false</span>, end_nodes);</div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="keywordflow">return</span> end_nodes;</div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;  };</div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;  <span class="keyword">auto</span> get_edge_delta = [&amp;](<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> edge, <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> node,</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;                            <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> &amp;<a class="code" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a>) {</div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(edge, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> n0(3), n1(3);</div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    <span class="keywordflow">if</span> (conn[1] == node) {</div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(&amp;conn[0], 1, &amp;n0[0]);</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(&amp;conn[1], 1, &amp;n1[0]);</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(&amp;conn[1], 1, &amp;n0[0]);</div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(&amp;conn[0], 1, &amp;n1[0]);</div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    }</div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;    <a class="code" href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a> = n1 - n0;</div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;  };</div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  <span class="keyword">auto</span> get_node_vec = [](std::vector&lt;double&gt; &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> nn) {</div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="namespaceMoFEM.html#a00ca24984a29be87bd99504af7f6ebee">getVectorAdaptor</a>(&amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>[3 * nn], 3);</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;  };</div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;  <span class="keyword">auto</span> check_if_node_is_in_range = [](<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> node,</div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;                                      <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;ents) {</div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;    <span class="keywordflow">return</span> (ents.find(node) != ents.end());</div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;  };</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160; </div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;  <span class="keyword">auto</span> check_for_nan = [&amp;](<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, std::string msg = <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> : <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>)</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordflow">if</span> (std::isnan(<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>) || std::isinf(<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>))</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="keywordflow">if</span> (msg.size()) {</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;          SETERRQ2(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                   <span class="stringliteral">&quot;(%s) Not number %3.4e&quot;</span>, msg.c_str(), <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>);</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;          SETERRQ1(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;                   <span class="stringliteral">&quot;Not number %3.4e&quot;</span>, <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>);</div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        }</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160; </div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;  };</div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160; </div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;  <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> node, <span class="keyword">auto</span> coords) {</div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;set_tag&quot;</span>);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(th_front_positions, &amp;node, 1,</div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;                                             &amp;coords[0]);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;  };</div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160; </div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  <span class="keyword">auto</span> get_str = [](<span class="keyword">auto</span> <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) { <span class="keywordflow">return</span> boost::lexical_cast&lt;std::string&gt;(<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>); };</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  <span class="keyword">auto</span> get_tag_data = [<span class="keyword">this</span>](Tag <a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;ents) {</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    std::vector&lt;double&gt; <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(3 * ents.size());</div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(<a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, ents, &amp;*<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.begin());</div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;  };</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160; </div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;  <span class="keyword">auto</span> get_coords_vec = [<span class="keyword">this</span>](<span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> &amp;ents) {</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    std::vector&lt;double&gt; <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(3 * ents.size());</div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(ents, &amp;*<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.begin());</div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;  };</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160; </div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;  <span class="keyword">auto</span> get_prisms = [&amp;]() {</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;    <a class="code" href="classRange.html">Range</a> prisms;</div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(get_surface(), 3, <span class="keyword">false</span>, prisms,</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;                                                moab::Interface::UNION);</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    prisms = prisms.subset_by_type(MBPRISM);</div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;    <span class="keywordflow">return</span> prisms;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  };</div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="keyword">auto</span> get_prims_surface = [&amp;](<a class="code" href="classRange.html">Range</a> prisms) {</div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;    <a class="code" href="classRange.html">Range</a> prisms_surface;</div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> prism : prisms) {</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> face;</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().side_element(prism, 2, 4, face);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      prisms_surface.insert(face);</div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    }</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    <span class="keywordflow">return</span> prisms_surface;</div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  };</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160; </div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;  <span class="keyword">auto</span> get_random_double = []() {</div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(rand()) / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(RAND_MAX);</div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  };</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="comment">// Check if point is outside or inside of body</span></div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  <span class="keyword">auto</span> is_point_is_outside = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;coords) {</div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> random_ray(3);</div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;    random_ray[0] =</div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;        get_random_double() + std::numeric_limits&lt;double&gt;::epsilon();</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;    random_ray[1] = get_random_double();</div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    random_ray[2] = get_random_double();</div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;    random_ray /= norm_2(random_ray);</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    std::vector&lt;double&gt; distances_out;</div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;    std::vector&lt;EntityHandle&gt; facets_out;</div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tree_body_skin_ptr-&gt;ray_intersect_triangles(</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;        distances_out, facets_out, rootset_tree_body_skin, 1e-12, &amp;coords[0],</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;        &amp;random_ray[0]);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <span class="keywordflow">return</span> ((facets_out.size() % 2) == 0);</div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  };</div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160; </div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  <span class="comment">// Check until results is consistent</span></div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;  <span class="keyword">auto</span> is_point_is_outside_with_check = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> &amp;coords) {</div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;    <span class="keywordtype">bool</span> is_out = is_point_is_outside(coords);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordtype">bool</span> test_out;</div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;    <span class="keywordflow">do</span> {</div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;      test_out = is_out;</div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      is_out = is_point_is_outside(coords);</div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;    } <span class="keywordflow">while</span> (test_out != is_out);</div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">return</span> is_out;</div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  };</div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160; </div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;  <span class="keyword">auto</span> get_proj_front_disp = [&amp;](<span class="keyword">auto</span> front_disp,</div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                                 <span class="keyword">auto</span> griffith_force_projected) {</div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> mgn_force_projected = norm_2(griffith_force_projected);</div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> disp(3);</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160; </div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    <span class="keywordflow">if</span> (mgn_force_projected &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;      griffith_force_projected /= mgn_force_projected;</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;      noalias(disp) = factor * griffith_force_projected *</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                      fmax(0, inner_prod(front_disp, griffith_force_projected));</div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;    } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;      disp.clear();</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;    }</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;    <span class="keywordflow">return</span> disp;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;  };</div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160; </div>
<div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;  <span class="comment">// get average area increment</span></div>
<div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;  <span class="keyword">auto</span> get_ave_a_change = [&amp;](<a class="code" href="classRange.html">Range</a> &amp;crack_front_nodes,</div>
<div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;                              std::vector&lt;double&gt; &amp;area_change) {</div>
<div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;    <span class="keywordtype">double</span> ave_a_change = 0;</div>
<div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : crack_front_nodes) {</div>
<div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;      <span class="keyword">auto</span> a_change = get_node_vec(area_change, nn);</div>
<div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;      ave_a_change += norm_2(a_change);</div>
<div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    }</div>
<div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    ave_a_change /= crack_front_nodes.size();</div>
<div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="keywordflow">return</span> ave_a_change;</div>
<div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;  };</div>
<div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160; </div>
<div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;  <span class="keyword">auto</span> get_ray_pout = [&amp;](<span class="keyword">const</span> <span class="keyword">auto</span> coords, <span class="keyword">const</span> <span class="keyword">auto</span> ray) {</div>
<div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    std::vector&lt;double&gt; distances_out;</div>
<div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;    std::vector&lt;EntityHandle&gt; facets_out;</div>
<div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordtype">double</span> ray_length = norm_2(ray);</div>
<div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> unit_ray = ray / ray_length;</div>
<div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    <span class="comment">// send the ray in the direction of the edge</span></div>
<div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> tree_body_skin_ptr-&gt;ray_intersect_triangles(</div>
<div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;        distances_out, facets_out, rootset_tree_body_skin, 1e-12, &amp;coords[0],</div>
<div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;        &amp;unit_ray[0], &amp;ray_length);</div>
<div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    <span class="keywordflow">if</span> (distances_out.empty())</div>
<div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;      <span class="keywordflow">return</span> -1.;</div>
<div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;    <span class="keywordflow">else</span></div>
<div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      <span class="keywordflow">return</span> *std::min_element(distances_out.begin(), distances_out.end());</div>
<div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;  };</div>
<div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160; </div>
<div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE, bit_edges);</div>
<div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160; </div>
<div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;  SetFrontPositionsParameters front_params;</div>
<div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160; </div>
<div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_tags();</div>
<div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a> = get_prims_surface(get_prisms());</div>
<div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160; </div>
<div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;  <a class="code" href="classRange.html">Range</a> surface_skin = get_surface_skin(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>);</div>
<div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;  <a class="code" href="classRange.html">Range</a> crack_front = intersect(get_crack_front(), surface_skin);</div>
<div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  <a class="code" href="classRange.html">Range</a> crack_front_nodes = get_nodes(crack_front);</div>
<div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;  <a class="code" href="classRange.html">Range</a> end_nodes = get_crack_front_ends(crack_front);</div>
<div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;  <a class="code" href="classRange.html">Range</a> surface_skin_nodes =</div>
<div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;      subtract(subtract(get_nodes(surface_skin), crack_front_nodes),</div>
<div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;               get_nodes(intersect(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, surface_skin)));</div>
<div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;  surface_skin_nodes.merge(intersect(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, get_nodes(surface_skin)));</div>
<div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160; </div>
<div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1GriffithForceElement_1_1SaveGriffithForceOnTags.html">GriffithForceElement::SaveGriffithForceOnTags</a>(</div>
<div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>, th_area_change, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">nullptr</span>)();</div>
<div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_positions(get_nodes(get_prisms()), <span class="keyword">nullptr</span>);</div>
<div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> build_body_skin_tree(tree_body_skin_ptr, rootset_tree_body_skin);</div>
<div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160; </div>
<div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;prisms_surface.vtk&quot;</span>, get_prims_surface(get_prisms()));</div>
<div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;surface_skin.vtk&quot;</span>, surface_skin);</div>
<div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;crack_front.vtk&quot;</span>, crack_front);</div>
<div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;crack_front_nodes.vtk&quot;</span>, crack_front_nodes);</div>
<div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;end_nodes.vtk&quot;</span>, end_nodes);</div>
<div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160; </div>
<div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;  <span class="keyword">auto</span> surface_snap = [&amp;]() {</div>
<div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#aedb15b073b44bdf2cd4d20fbc19a8060">snapSurfaceToEdges</a>(</div>
<div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;        surface_skin, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, front_params.tolRelSnapToFixedEdges,</div>
<div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        front_params.tolAbsSnapToFixedEdges, <span class="keyword">nullptr</span>, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  };</div>
<div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160; </div>
<div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;  <span class="keyword">auto</span> move_front_nodes = [&amp;]() {</div>
<div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160; </div>
<div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;    <span class="keyword">auto</span> <a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = get_tag_data(th_w, crack_front_nodes);</div>
<div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;    <span class="keyword">auto</span> griffith_forces_projected =</div>
<div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;        get_tag_data(th_griffith_force_projected, crack_front_nodes);</div>
<div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keyword">auto</span> area_change = get_tag_data(th_area_change, crack_front_nodes);</div>
<div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;    <span class="keyword">auto</span> mesh_node_positions = get_coords_vec(crack_front_nodes);</div>
<div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160; </div>
<div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> ave_a_change =</div>
<div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;        get_ave_a_change(crack_front_nodes, area_change);</div>
<div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160; </div>
<div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : crack_front_nodes) {</div>
<div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160; </div>
<div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      <span class="keyword">auto</span> front_disp = get_node_vec(<a class="code" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a>, nn);</div>
<div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;      <span class="keyword">auto</span> force_projected = get_node_vec(griffith_forces_projected, nn);</div>
<div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keyword">auto</span> a_change = get_node_vec(area_change, nn);</div>
<div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;      <span class="keyword">auto</span> position = get_node_vec(mesh_node_positions, nn);</div>
<div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160; </div>
<div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(front_disp, <span class="stringliteral">&quot;front_disp&quot;</span>);</div>
<div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(force_projected, <span class="stringliteral">&quot;force_projected&quot;</span>);</div>
<div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(a_change, <span class="stringliteral">&quot;a_change&quot;</span>);</div>
<div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160; </div>
<div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> disp = get_proj_front_disp(front_disp, force_projected);</div>
<div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160; </div>
<div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(position);</div>
<div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(disp);</div>
<div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      }</div>
<div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160; </div>
<div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> coords = position + disp;</div>
<div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160; </div>
<div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      <span class="comment">// check if nodes on fixed edges</span></div>
<div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;      <a class="code" href="classRange.html">Range</a> adj_crack_front_nodes_edges;</div>
<div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(&amp;node, 1, 1, <span class="keyword">false</span>,</div>
<div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                  adj_crack_front_nodes_edges,</div>
<div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                  moab::Interface::UNION);</div>
<div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;      <a class="code" href="classRange.html">Range</a> adj_crack_front_nodes_on_fixed_edges;</div>
<div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;      adj_crack_front_nodes_on_fixed_edges =</div>
<div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;          intersect(adj_crack_front_nodes_edges, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>);</div>
<div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      adj_crack_front_nodes_on_fixed_edges =</div>
<div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;          intersect(adj_crack_front_nodes_on_fixed_edges, bit_edges);</div>
<div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160; </div>
<div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(front_disp, <span class="stringliteral">&quot;front_disp&quot;</span>);</div>
<div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;coords&quot;</span>);</div>
<div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(disp, <span class="stringliteral">&quot;disp&quot;</span>);</div>
<div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160; </div>
<div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;      <span class="keyword">enum</span> Classifier {</div>
<div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;        FREE = 0,</div>
<div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;        FIXED_EDGE = 1 &lt;&lt; 0,</div>
<div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;        END_NODE = 1 &lt;&lt; 1,</div>
<div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;        FIXED_EDGE_KIND0 = 1 &lt;&lt; 2,</div>
<div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;        FIXED_EDGE_KIND1 = 1 &lt;&lt; 3</div>
<div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;      };</div>
<div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160; </div>
<div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> kind = FREE;</div>
<div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;      <span class="keywordflow">if</span> (check_if_node_is_in_range(node, get_nodes(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>)))</div>
<div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;        kind |= FIXED_EDGE;</div>
<div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;      <span class="keywordflow">if</span> (check_if_node_is_in_range(node, end_nodes))</div>
<div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;        kind |= END_NODE;</div>
<div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160; </div>
<div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;      <span class="keywordflow">if</span> (kind == FREE) {</div>
<div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160; </div>
<div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;        <span class="comment">// check pushing other nodes, which are not end nodes</span></div>
<div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;        <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> scaled_a_change =</div>
<div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            ave_a_change * a_change /</div>
<div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            (norm_2(a_change) + std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;        <span class="keywordflow">if</span> (is_point_is_outside_with_check(coords)) {</div>
<div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160; </div>
<div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;          coords += front_params.skinFactor * scaled_a_change;</div>
<div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords,</div>
<div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;                               <span class="stringliteral">&quot;Pushed through surface (out by factor)&quot;</span>);</div>
<div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160; </div>
<div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;Pushed through surface (out by factor): &quot;</span>;</div>
<div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160; </div>
<div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160; </div>
<div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;          <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> tmp_coords =</div>
<div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;              coords + front_params.skinFactor * scaled_a_change;</div>
<div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;          <span class="keywordflow">if</span> (is_point_is_outside_with_check(tmp_coords)) {</div>
<div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;            <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray =</div>
<div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;                scaled_a_change / (norm_2(scaled_a_change) +</div>
<div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;                                   std::numeric_limits&lt;double&gt;::epsilon());</div>
<div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacecreate__mesh__links.html#a1b132712b3e44cc2ea2257678b2d4a12">dist</a> = get_ray_pout(coords, scaled_a_change);</div>
<div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;            <span class="keywordflow">if</span> (<a class="code" href="namespacecreate__mesh__links.html#a1b132712b3e44cc2ea2257678b2d4a12">dist</a> &gt; -0)</div>
<div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;              coords += <a class="code" href="namespacecreate__mesh__links.html#a1b132712b3e44cc2ea2257678b2d4a12">dist</a> * ray;</div>
<div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160; </div>
<div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;            coords += front_params.skinFactor * scaled_a_change;</div>
<div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;                coords, <span class="stringliteral">&quot;Pushing through surface (out by skin factor)&quot;</span>);</div>
<div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160; </div>
<div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;            <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Pushing through surface (out by skin factor): &quot;</span>;</div>
<div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;          }</div>
<div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;        }</div>
<div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      }</div>
<div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160; </div>
<div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;      <span class="keywordflow">if</span> (kind &amp; END_NODE) {</div>
<div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160; </div>
<div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        <span class="keywordtype">double</span> min_dist = front_params.skinFactor * ave_a_change;</div>
<div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160; </div>
<div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">if</span> (kind &amp; FIXED_EDGE) {</div>
<div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160; </div>
<div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;          <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> pt_out(3);</div>
<div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;              &amp;coords[0], 1, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, &amp;min_dist, &amp;pt_out[0]);</div>
<div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;          <span class="keywordflow">if</span> (min_dist &lt; front_params.skinFactor * ave_a_change)</div>
<div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;            coords = pt_out;</div>
<div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160; </div>
<div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;End node on the fixed edge&quot;</span>);</div>
<div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160; </div>
<div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;              &lt;&lt; <span class="stringliteral">&quot;End node on the fixed edge: &quot;</span>;</div>
<div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160; </div>
<div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          <span class="comment">// Find corner edge and check if crack can go through it</span></div>
<div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160; </div>
<div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;          <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> pt_out(3);</div>
<div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Tools.html">Tools</a>&gt;()-&gt;findMinDistanceFromTheEdges(</div>
<div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;              &amp;coords[0], 1, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, &amp;min_dist, &amp;pt_out[0]);</div>
<div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;          <span class="keywordflow">if</span> (min_dist &lt; front_params.skinFactor * ave_a_change) {</div>
<div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;            <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> ray = pt_out - coords;</div>
<div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;            <span class="keywordflow">if</span> (inner_prod(a_change, ray) &gt; 0) {</div>
<div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;              <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> scaled_ray =</div>
<div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;                  front_params.skinFactor * ave_a_change * ray / norm_2(ray);</div>
<div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;              coords += ray + scaled_ray;</div>
<div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;                  coords, <span class="stringliteral">&quot;Pushing through surface dist (close to edge)&quot;</span>);</div>
<div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;              <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;                  &lt;&lt; <span class="stringliteral">&quot;Pushing through surface dist (close to edge): &quot;</span>;</div>
<div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;            }</div>
<div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;          }</div>
<div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        }</div>
<div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div>
<div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160; </div>
<div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;      <span class="keywordflow">if</span> (!adj_crack_front_nodes_on_fixed_edges.empty()) {</div>
<div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160; </div>
<div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> nb_edges_on_fix_edges =</div>
<div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;            adj_crack_front_nodes_on_fixed_edges.size() - 1;</div>
<div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        adj_crack_front_nodes_on_fixed_edges =</div>
<div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;            intersect(adj_crack_front_nodes_on_fixed_edges, surface_skin);</div>
<div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160; </div>
<div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <span class="comment">// adj node edge is on fixed edge and on the skin</span></div>
<div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;        <span class="keywordflow">if</span> (!adj_crack_front_nodes_on_fixed_edges.empty()) {</div>
<div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160; </div>
<div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> nb_edges_on_fix_edges_and_surface_skin =</div>
<div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;              adj_crack_front_nodes_on_fixed_edges.size();</div>
<div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;          <span class="keyword">const</span> <span class="keywordtype">int</span> diff_nb_edges =</div>
<div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;              nb_edges_on_fix_edges - nb_edges_on_fix_edges_and_surface_skin;</div>
<div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160; </div>
<div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;          <span class="comment">// If is  &gt;- in that case diff_nb_edges = 1</span></div>
<div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;          <span class="comment">// If is  &gt;| in that case diff_nb_edges &gt; 1</span></div>
<div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160; </div>
<div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;          <span class="keywordflow">if</span> (diff_nb_edges &gt; 1) {</div>
<div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160; </div>
<div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;            <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> edge_delta;</div>
<div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_edge_delta(adj_crack_front_nodes_on_fixed_edges[0], node,</div>
<div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;                                  edge_delta);</div>
<div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;            coords += front_params.cornerFactor * edge_delta;</div>
<div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;            <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Node on fixed edge (crack meeting fixed edge &gt;|): &quot;</span>;</div>
<div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;                coords, <span class="stringliteral">&quot;Node on fixed edge (crack meeting fixed edge &gt;|)&quot;</span>);</div>
<div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160; </div>
<div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;            kind |= FIXED_EDGE_KIND0;</div>
<div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;          }</div>
<div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160; </div>
<div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((kind &amp; END_NODE) &amp;&amp; (kind &amp; FIXED_EDGE)) {</div>
<div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160; </div>
<div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;          <span class="comment">// It s =|&gt;</span></div>
<div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160; </div>
<div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;          <span class="comment">// adj edge is on fixed edge but that edge is not on the skin</span></div>
<div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;          <a class="code" href="classRange.html">Range</a> adj_edges_on_skin =</div>
<div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;              intersect(adj_crack_front_nodes_edges, surface_skin);</div>
<div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;          <span class="keywordflow">if</span> (!adj_edges_on_skin.empty()) {</div>
<div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160; </div>
<div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;            <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> edge_delta;</div>
<div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_edge_delta(adj_edges_on_skin[0], node, edge_delta);</div>
<div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;            coords += front_params.cornerFactor * edge_delta;</div>
<div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(</div>
<div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;                coords, <span class="stringliteral">&quot;Node on fixed edge (crack crossing fixed edge =|&gt;)&quot;</span>);</div>
<div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160; </div>
<div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;            <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose)</div>
<div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;                &lt;&lt; <span class="stringliteral">&quot;Node on fixed edge (crack crossing fixed edge =|&gt;): &quot;</span>;</div>
<div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160; </div>
<div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;            kind |= FIXED_EDGE_KIND1;</div>
<div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;          }</div>
<div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;        }</div>
<div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;      }</div>
<div class="line"><a name="l00958"></a><span class="lineno">  958</span>&#160; </div>
<div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;      <span class="keywordflow">if</span> (</div>
<div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160; </div>
<div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;          (kind &amp; END_NODE) &amp;&amp;</div>
<div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160; </div>
<div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;          !(kind &amp; FIXED_EDGE_KIND0) &amp;&amp;</div>
<div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160; </div>
<div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;          !(kind &amp; FIXED_EDGE_KIND1)) {</div>
<div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160; </div>
<div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;        <span class="comment">// is a end node on the skin, just go outside, in the direction</span></div>
<div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;        <span class="comment">// of crack front edged</span></div>
<div class="line"><a name="l00969"></a><span class="lineno">  969</span>&#160;        <a class="code" href="classRange.html">Range</a> adj_edges = intersect(adj_crack_front_nodes_edges, crack_front);</div>
<div class="line"><a name="l00970"></a><span class="lineno">  970</span>&#160;        <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> edge_delta;</div>
<div class="line"><a name="l00971"></a><span class="lineno">  971</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_edge_delta(adj_edges[0], node, edge_delta);</div>
<div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;        coords += edge_delta * front_params.endNodeEdgeDeltaFactor;</div>
<div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords, <span class="stringliteral">&quot;End node on the skin&quot;</span>);</div>
<div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160; </div>
<div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;        <span class="comment">// front_params.skinFactor;</span></div>
<div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;        <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;End node on the skin: &quot;</span>;</div>
<div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;      }</div>
<div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160; </div>
<div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;      <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CPMeshCutWorld&quot;</span>, Sev::verbose, <span class="stringliteral">&quot;Disp front %s at node %lu&quot;</span>,</div>
<div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;                  get_str(front_disp).c_str(), node);</div>
<div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160; </div>
<div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag(node, coords);</div>
<div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160; </div>
<div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;      ++nn;</div>
<div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;    }</div>
<div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160; </div>
<div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;  };</div>
<div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160; </div>
<div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;  <span class="keyword">auto</span> smooth_front = [&amp;]() {</div>
<div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;    <a class="code" href="classRange.html">Range</a> smoothed_nodes = subtract(crack_front_nodes, end_nodes);</div>
<div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;    std::vector&lt;double&gt; new_positions(3 * smoothed_nodes.size());</div>
<div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;    <span class="keywordtype">int</span> nn = 0;</div>
<div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> node : smoothed_nodes) {</div>
<div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;      <a class="code" href="classRange.html">Range</a> edges;</div>
<div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(&amp;node, 1, 1, <span class="keyword">false</span>, edges);</div>
<div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;      edges = intersect(edges, crack_front);</div>
<div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;      <a class="code" href="classRange.html">Range</a> edges_nodes;</div>
<div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(edges, edges_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;      edges_nodes.erase(node);</div>
<div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;      <span class="keywordflow">if</span> (edges_nodes.size() != 2)</div>
<div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;        SETERRQ1(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;                 <span class="stringliteral">&quot;Expected two nodes but have %d&quot;</span>, edges_nodes.size());</div>
<div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> node0(3), node1(3), node2(3);</div>
<div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> n0 = edges_nodes[0];</div>
<div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> n2 = edges_nodes[1];</div>
<div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(th_front_positions, &amp;n0, 1,</div>
<div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;                                               &amp;node0[0]);</div>
<div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(th_front_positions, &amp;node, 1,</div>
<div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;                                               &amp;node1[0]);</div>
<div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(th_front_positions, &amp;n2, 1,</div>
<div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;                                               &amp;node2[0]);</div>
<div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> delta0 = node0 - node1;</div>
<div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">VectorDouble3</a> delta2 = node2 - node1;</div>
<div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> l0 = norm_2(delta0);</div>
<div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keyword">const</span> <span class="keywordtype">double</span> l2 = norm_2(delta2);</div>
<div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160; </div>
<div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;      <span class="keywordflow">if</span> ((l0 / (l0 + l2)) &lt; 0.5)</div>
<div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;        node1 += 2 * (0.5 - (l0 / (l0 + l2))) * (delta2 / l2) * l0;</div>
<div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      <span class="keywordflow">else</span></div>
<div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;        node1 += 2 * (0.5 - (l2 / (l0 + l2))) * (delta0 / l0) * l2;</div>
<div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160; </div>
<div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#a5dfc306af1addb8e8a14a1428e966654">VectorAdaptor</a> new_coords = get_node_vec(new_positions, nn);</div>
<div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      new_coords = node1;</div>
<div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      ++nn;</div>
<div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    }</div>
<div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(th_front_positions, smoothed_nodes,</div>
<div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;                                             &amp;*new_positions.begin());</div>
<div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160; </div>
<div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;  };</div>
<div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160; </div>
<div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;  <span class="keyword">auto</span> delete_mofem_meshsets = [&amp;]() {</div>
<div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;        <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa73d6d4d08509b996a63604173694d8a">getSkinOfTheBodyId</a>(), <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;        <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a001491969a5bbeea6147ce9d8ce0416b">getCrackSurfaceId</a>(), <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;        <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5d19b596dfc352e6f25afb67a6be6eeb">getCrackFrontId</a>(), <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;  };</div>
<div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160; </div>
<div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;  <span class="keyword">auto</span> build_surface = [&amp;]() {</div>
<div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="comment">// Create cutting surface from existing crack</span></div>
<div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    Tag th_interface_side;</div>
<div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>,</div>
<div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;                                               th_interface_side);</div>
<div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;    <a class="code" href="classRange.html">Range</a> new_surface;</div>
<div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;    <span class="comment">// Take nodes from top of the prims</span></div>
<div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> face : <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>) {</div>
<div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160; </div>
<div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;      <span class="keywordtype">int</span> side;</div>
<div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(th_interface_side, &amp;face, 1,</div>
<div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;                                               &amp;side);</div>
<div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(face, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160; </div>
<div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;        <span class="keywordflow">if</span> (!(conn[0] != conn[1] &amp;&amp; conn[0] != conn[2] &amp;&amp; conn[1] != conn[2]))</div>
<div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;          SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;                  <span class="stringliteral">&quot;Imposible trinagle&quot;</span>);</div>
<div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160; </div>
<div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MatrixDouble3by3</a> coords(3, 3);</div>
<div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(th_front_positions, conn, 3,</div>
<div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;                                               &amp;coords(0, 0));</div>
<div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> check_for_nan(coords.data());</div>
<div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160; </div>
<div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> new_verts[3] = {0, 0, 0};</div>
<div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn : {0, 1, 2}) {</div>
<div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;        <span class="keyword">auto</span> node_map = verts_map.find(conn[nn]);</div>
<div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;        <span class="keywordflow">if</span> (node_map == verts_map.end()) {</div>
<div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;          <a class="code" href="classEntityHandle.html">EntityHandle</a> new_node;</div>
<div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_vertex(&amp;coords(nn, 0), new_node);</div>
<div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;          verts_map[conn[nn]] = new_node;</div>
<div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;        }</div>
<div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;        new_verts[nn] = verts_map[conn[nn]];</div>
<div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;      }</div>
<div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;      <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn : {0, 1, 2})</div>
<div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;        <span class="keywordflow">if</span> (new_verts[nn] == 0)</div>
<div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;          SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;                  <span class="stringliteral">&quot;Imposible trinagle&quot;</span>);</div>
<div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      <span class="keywordflow">if</span> (side == 1) {</div>
<div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;        <a class="code" href="classEntityHandle.html">EntityHandle</a> n0 = new_verts[0];</div>
<div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;        new_verts[0] = new_verts[1];</div>
<div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;        new_verts[1] = n0;</div>
<div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;      }</div>
<div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> ele;</div>
<div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_element(MBTRI, new_verts, 3, ele);</div>
<div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      new_surface.insert(ele);</div>
<div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;    }</div>
<div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>.swap(new_surface);</div>
<div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;  };</div>
<div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160; </div>
<div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;  <span class="keyword">auto</span> build_front = [&amp;]() {</div>
<div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;    <a class="code" href="classRange.html">Range</a> new_surface_skin;</div>
<div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">false</span>, new_surface_skin);</div>
<div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;    <a class="code" href="classRange.html">Range</a> new_front;</div>
<div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;    <span class="comment">// Creating crack front from existing crack</span></div>
<div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> : crack_front) {</div>
<div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;      <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> *conn;</div>
<div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> new_verts[num_nodes];</div>
<div class="line"><a name="l01111"></a><span class="lineno"> 1111</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 2; nn++) {</div>
<div class="line"><a name="l01112"></a><span class="lineno"> 1112</span>&#160;        <span class="keyword">auto</span> node_map = verts_map.find(conn[nn]);</div>
<div class="line"><a name="l01113"></a><span class="lineno"> 1113</span>&#160;        <span class="keywordflow">if</span> (node_map != verts_map.end())</div>
<div class="line"><a name="l01114"></a><span class="lineno"> 1114</span>&#160;          new_verts[nn] = node_map-&gt;second;</div>
<div class="line"><a name="l01115"></a><span class="lineno"> 1115</span>&#160;        <span class="keywordflow">else</span></div>
<div class="line"><a name="l01116"></a><span class="lineno"> 1116</span>&#160;          SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;                  <span class="stringliteral">&quot;Expected that vertex should be already created&quot;</span>);</div>
<div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;      }</div>
<div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;      <a class="code" href="classRange.html">Range</a> edges;</div>
<div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(new_verts, 2, 1, <span class="keyword">true</span>, edges,</div>
<div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;                                                  moab::Interface::INTERSECT);</div>
<div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;      edges = intersect(edges, new_surface_skin);</div>
<div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;      new_front.merge(edges);</div>
<div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    }</div>
<div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>.swap(new_front);</div>
<div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;  };</div>
<div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160; </div>
<div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;  <span class="keyword">auto</span> edges_snap = [&amp;]() {</div>
<div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <a class="code" href="classRange.html">Range</a> new_surface_skin;</div>
<div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <span class="keyword">false</span>, new_surface_skin);</div>
<div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#aedb15b073b44bdf2cd4d20fbc19a8060">snapSurfaceToEdges</a>(</div>
<div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;        new_surface_skin, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, front_params.tolRelSnapToFixedEdges,</div>
<div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;        front_params.tolAbsSnapToFixedEdges, <span class="keyword">nullptr</span>, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;  };</div>
<div class="line"><a name="l01138"></a><span class="lineno"> 1138</span>&#160; </div>
<div class="line"><a name="l01139"></a><span class="lineno"> 1139</span>&#160;  <span class="keyword">auto</span> delete_meshsets_with_crack_surfaces = [&amp;]() {</div>
<div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 19; ++ll)</div>
<div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      mask.set(ll);</div>
<div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(19, mask, verb, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;  };</div>
<div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160; </div>
<div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> surface_snap();</div>
<div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> move_front_nodes();</div>
<div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> smooth_front();</div>
<div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> build_surface();</div>
<div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;set_new_crack_surface.vtk&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>);</div>
<div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> build_front();</div>
<div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> edges_snap();</div>
<div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(<span class="stringliteral">&quot;set_new_front.vtk&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>);</div>
<div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_meshsets_with_crack_surfaces();</div>
<div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160; </div>
<div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;  <span class="comment">// Set cutting inteface</span></div>
<div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;  <span class="keyword">const_cast&lt;</span><a class="code" href="classRange.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>()).clear();</div>
<div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;  <span class="keyword">const_cast&lt;</span><a class="code" href="classRange.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#a80b3d9675ca762af0df6bc7a1ed5cc24">getFront</a>()).clear();</div>
<div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#a5691afdb9be3879de243aeea26c934c9">setSurface</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>);</div>
<div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#a0c7c582d842a5540d10cc8d84c0c3486">setFront</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>);</div>
<div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160; </div>
<div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;  <span class="keywordflow">if</span> (!save_mesh.empty())</div>
<div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_entities(save_mesh, unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>));</div>
<div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160; </div>
<div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;}</div>
<div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160; </div>
<div class="line"><a name="l01173"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a5edebe082848c57745b69722a9d173bc"> 1173</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5edebe082848c57745b69722a9d173bc">CPMeshCut::setFixEdgesAndCorners</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>.clear();</div>
<div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>.clear();</div>
<div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160; </div>
<div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a031605821bd53219746550d0c0cc55b3">edgesBlockSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 1,</div>
<div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;                                                 <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160; </div>
<div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a>) &amp;&amp;</div>
<div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;    SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a>,</div>
<div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;            <span class="stringliteral">&quot;There are both BLOCKSET and NODESET with ID equal to input &quot;</span></div>
<div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;            <span class="stringliteral">&quot;parameter -vertex_block_set&quot;</span>);</div>
<div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160; </div>
<div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>))</div>
<div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">vertexBlockSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 0,</div>
<div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;                                                 <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160; </div>
<div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a>))</div>
<div class="line"><a name="l01193"></a><span class="lineno"> 1193</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">vertexNodeSet</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a>, 0,</div>
<div class="line"><a name="l01194"></a><span class="lineno"> 1194</span>&#160;                                                 <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01195"></a><span class="lineno"> 1195</span>&#160; </div>
<div class="line"><a name="l01196"></a><span class="lineno"> 1196</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01197"></a><span class="lineno"> 1197</span>&#160;                                             <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>);</div>
<div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                             <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>);</div>
<div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160; </div>
<div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;}</div>
<div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160; </div>
<div class="line"><a name="l01204"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a1bbfb030bcbd86228047ec8c352128ba"> 1204</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1bbfb030bcbd86228047ec8c352128ba">CPMeshCut::cutMesh</a>(<span class="keywordtype">int</span> &amp;first_bit, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160; </div>
<div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> ents) {</div>
<div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;      <span class="keywordflow">if</span> (!ents.empty()) {</div>
<div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;        <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().add_entities(meshset, ents);</div>
<div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;                                             1);</div>
<div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      }</div>
<div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;    }</div>
<div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;  };</div>
<div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160; </div>
<div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;  <span class="keyword">auto</span> get_entities_from_contact_meshset = [&amp;](<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>.clear();</div>
<div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;    <a class="code" href="classRange.html">Range</a> tris;</div>
<div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, cit)) {</div>
<div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">if</span> (cit-&gt;getName().compare(0, 11, <span class="stringliteral">&quot;INT_CONTACT&quot;</span>) == 0) {</div>
<div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        tris.clear();</div>
<div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(cit-&gt;getMeshsetId(),</div>
<div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;                                                     <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 2, tris, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>.merge(tris);</div>
<div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      }</div>
<div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div>
<div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;                                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>);</div>
<div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01238"></a><span class="lineno"> 1238</span>&#160;  };</div>
<div class="line"><a name="l01239"></a><span class="lineno"> 1239</span>&#160; </div>
<div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;  <span class="keyword">auto</span> get_entities_from_constrained_interface = [&amp;](<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>.clear();</div>
<div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <a class="code" href="classRange.html">Range</a> tris;</div>
<div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, cit)) {</div>
<div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;      <span class="keywordflow">if</span> (cit-&gt;getName().compare(0, 15, <span class="stringliteral">&quot;INT_CONSTRAINED&quot;</span>) == 0) {</div>
<div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;        tris.clear();</div>
<div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(cit-&gt;getMeshsetId(),</div>
<div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;                                                     <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 2, tris, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01249"></a><span class="lineno"> 1249</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>.merge(tris);</div>
<div class="line"><a name="l01250"></a><span class="lineno"> 1250</span>&#160;      }</div>
<div class="line"><a name="l01251"></a><span class="lineno"> 1251</span>&#160;    }</div>
<div class="line"><a name="l01252"></a><span class="lineno"> 1252</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01253"></a><span class="lineno"> 1253</span>&#160;                                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>);</div>
<div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;  };</div>
<div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160; </div>
<div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;  <a class="code" href="classRange.html">Range</a> all_constrained_faces;</div>
<div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;  <span class="keyword">auto</span> get_all_constrained_faces = [&amp;](<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> &amp;<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;    all_constrained_faces.clear();</div>
<div class="line"><a name="l01261"></a><span class="lineno"> 1261</span>&#160; </div>
<div class="line"><a name="l01262"></a><span class="lineno"> 1262</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a name="l01263"></a><span class="lineno"> 1263</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_entities_from_contact_meshset(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a name="l01264"></a><span class="lineno"> 1264</span>&#160;      all_constrained_faces.merge(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>);</div>
<div class="line"><a name="l01265"></a><span class="lineno"> 1265</span>&#160;    }</div>
<div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160; </div>
<div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_entities_from_constrained_interface(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>);</div>
<div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    all_constrained_faces.merge(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>);</div>
<div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160; </div>
<div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  };</div>
<div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160; </div>
<div class="line"><a name="l01273"></a><span class="lineno"> 1273</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01274"></a><span class="lineno"> 1274</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;crack_surface_before_merge.vtk&quot;</span>,</div>
<div class="line"><a name="l01275"></a><span class="lineno"> 1275</span>&#160;                     <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>());</div>
<div class="line"><a name="l01276"></a><span class="lineno"> 1276</span>&#160; </div>
<div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBVERTEX,</div>
<div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;        <span class="stringliteral">&quot;verts_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBEDGE,</div>
<div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;        <span class="stringliteral">&quot;edges_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTRI,</div>
<div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        <span class="stringliteral">&quot;triangles_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;writeBitLevelByType(</div>
<div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;        <span class="stringliteral">&quot;tets_on_mesh_cut_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="keyword">false</span>);</div>
<div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;  }</div>
<div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160; </div>
<div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_all_constrained_faces(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>]);</div>
<div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;  <span class="keywordflow">if</span> (!all_constrained_faces.empty()) {</div>
<div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#aad2bf7c3c4320b94832923df44d30e45">setConstrainSurface</a>(all_constrained_faces);</div>
<div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;constrained_surface_before_merge.vtk&quot;</span>,</div>
<div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;                       all_constrained_faces);</div>
<div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;  }</div>
<div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160; </div>
<div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;  <span class="comment">// Cut mesh, trim surface and merge bad edges</span></div>
<div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5edebe082848c57745b69722a9d173bc">setFixEdgesAndCorners</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>]);</div>
<div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160; </div>
<div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ad1ef5dac44a93d2934fabd08e35c72a9">cutTrimAndMerge</a>(first_bit, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">fractionLevel</a>, <span class="keyword">nullptr</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa928c18e5413b3b03461c589f076833c">tolCut</a>,</div>
<div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;                                     <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac675bad4a5faadf2211e0742feb1a02f">tolCutClose</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ab0c50ac037fc28c233cde4facd580d52">tolTrimClose</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>,</div>
<div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;                                     <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>, <span class="keyword">true</span>, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160; </div>
<div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_after_merge = <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(first_bit);</div>
<div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1e38d7c612661e0476cd6142c5e3a333">removePathologicalFrontTris</a>)</div>
<div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#aacc6ac8832948e067b7b7dadf50c53d1">removePathologicalFrontTris</a>(</div>
<div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        bit_after_merge, <span class="keyword">const_cast&lt;</span><a class="code" href="classRange.html">Range</a> &amp;<span class="keyword">&gt;</span>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ae17cb59577233873a12d990b46c49dd2">getMergedSurfaces</a>()));</div>
<div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160; </div>
<div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;crack_surface_after_merge.vtk&quot;</span>,</div>
<div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;                     <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ae17cb59577233873a12d990b46c49dd2">getMergedSurfaces</a>());</div>
<div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160; </div>
<div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_all_constrained_faces(bit_after_merge);</div>
<div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;  <span class="keywordflow">if</span> (!all_constrained_faces.empty() &amp;&amp; <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;constrained_surface_after_merge.vtk&quot;</span>,</div>
<div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;                     all_constrained_faces);</div>
<div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  }</div>
<div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160; </div>
<div class="line"><a name="l01322"></a><span class="lineno"> 1322</span>&#160;  <span class="keyword">auto</span> add_entities_to_crack_meshset = [&amp;]() {</div>
<div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>))</div>
<div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_faces = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#ae17cb59577233873a12d990b46c49dd2">getMergedSurfaces</a>();</div>
<div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160; </div>
<div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;    <span class="keywordflow">if</span> (!all_constrained_faces.empty() &amp;&amp; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> &lt; 0) {</div>
<div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;      SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea2ed69dd8a1568d1e9b634b9fb37df873">MOFEM_NOT_FOUND</a>,</div>
<div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;              <span class="stringliteral">&quot;Block set id of the cracked body is required for a simulation &quot;</span></div>
<div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;              <span class="stringliteral">&quot;with contact and/or constrained interface, use &quot;</span></div>
<div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;              <span class="stringliteral">&quot;&#39;-my_cracked_body_block_set&#39; parameter&quot;</span>);</div>
<div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;    }</div>
<div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a> &gt; 0) {</div>
<div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <a class="code" href="classRange.html">Range</a> cracked_body_tets, cracked_body_tris;</div>
<div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;          <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, cracked_body_tets, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(cracked_body_tets, 2, <span class="keyword">false</span>,</div>
<div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;                                                cracked_body_tris,</div>
<div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;                                                moab::Interface::UNION);</div>
<div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;      crack_faces = intersect(crack_faces, cracked_body_tris);</div>
<div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;crack_faces_intersected_with_body_block.vtk&quot;</span>,</div>
<div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;                         crack_faces);</div>
<div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;    }</div>
<div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160; </div>
<div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>,</div>
<div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;                                               crack_faces);</div>
<div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;  };</div>
<div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160; </div>
<div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;  <span class="keyword">auto</span> clean_copied_cutting_surface_entities = [&amp;]() {</div>
<div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;    <a class="code" href="classRange.html">Range</a> surface_verts;</div>
<div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>(),</div>
<div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;                                               surface_verts);</div>
<div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;    <a class="code" href="classRange.html">Range</a> surface_edges;</div>
<div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>(), 1,</div>
<div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;                                              <span class="keyword">false</span>, surface_edges,</div>
<div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;                                              moab::Interface::UNION);</div>
<div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;    <span class="comment">// Remove entities from meshsets</span></div>
<div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;    <a class="code" href="classRange.html">Range</a> meshsets;</div>
<div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_type(0, MBENTITYSET, meshsets,</div>
<div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;                                                   <span class="keyword">false</span>);</div>
<div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;    <span class="keywordflow">for</span> (Range::iterator mit = meshsets.begin(); mit != meshsets.end(); mit++) {</div>
<div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().remove_entities(*mit, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>());</div>
<div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().remove_entities(*mit, surface_edges);</div>
<div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().remove_entities(*mit, surface_verts);</div>
<div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;    }</div>
<div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160; </div>
<div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">cutMeshPtr</a>-&gt;<a class="code" href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">getSurface</a>());</div>
<div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(surface_edges);</div>
<div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(surface_verts);</div>
<div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;  };</div>
<div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160; </div>
<div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_entities_to_crack_meshset();</div>
<div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> clean_copied_cutting_surface_entities();</div>
<div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160; </div>
<div class="line"><a name="l01380"></a><span class="lineno"> 1380</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01381"></a><span class="lineno"> 1381</span>&#160;}</div>
<div class="line"><a name="l01382"></a><span class="lineno"> 1382</span>&#160; </div>
<div class="line"><a name="l01383"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a0016012d2fdfbaa3dea1c7de67159175"> 1383</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0016012d2fdfbaa3dea1c7de67159175">CPMeshCut::findBodySkin</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;                                       <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>,</div>
<div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;                                       std::string file_name) {</div>
<div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160; </div>
<div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> ents) {</div>
<div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    }</div>
<div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;  };</div>
<div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160; </div>
<div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;  <span class="comment">// Find body skin, take it from meshset if is found, if not create meshest,</span></div>
<div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;  <span class="comment">// and add skin entities</span></div>
<div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>.clear();</div>
<div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;    <a class="code" href="classRange.html">Range</a> tets, prisms;</div>
<div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;                                                   MBTET, tets);</div>
<div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;                                                   MBPRISM, prisms);</div>
<div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;    prisms = subtract(prisms, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>);</div>
<div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;    prisms = subtract(prisms, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;    <a class="code" href="classRange.html">Range</a> prisms_faces;</div>
<div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : prisms) {</div>
<div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>;</div>
<div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 3, <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>);</div>
<div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;      prisms_faces.insert(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>);</div>
<div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 4, <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>);</div>
<div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;      prisms_faces.insert(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>);</div>
<div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    }</div>
<div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    <a class="code" href="classRange.html">Range</a> skin_faces;</div>
<div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;    Skinner skin(&amp;m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, skin_faces);</div>
<div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;    skin_faces = subtract(skin_faces, prisms_faces);</div>
<div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>);</div>
<div class="line"><a name="l01426"></a><span class="lineno"> 1426</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l01427"></a><span class="lineno"> 1427</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, meshset);</div>
<div class="line"><a name="l01428"></a><span class="lineno"> 1428</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, skin_faces);</div>
<div class="line"><a name="l01429"></a><span class="lineno"> 1429</span>&#160;  }</div>
<div class="line"><a name="l01430"></a><span class="lineno"> 1430</span>&#160; </div>
<div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;  <span class="comment">// take skin entities from meshset</span></div>
<div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">skinOfTheBodyId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;                                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;                                             <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>);</div>
<div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160; </div>
<div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849">VERY_VERBOSE</a>)</div>
<div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160; </div>
<div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;    save_mesh(file_name, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>);</div>
<div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160; </div>
<div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;}</div>
<div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160; </div>
<div class="line"><a name="l01447"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a90e33252d4b7e57d9c2a7596db8ab906"> 1447</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a90e33252d4b7e57d9c2a7596db8ab906">CPMeshCut::findCrack</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;                                    <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01449"></a><span class="lineno"> 1449</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01450"></a><span class="lineno"> 1450</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01451"></a><span class="lineno"> 1451</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01452"></a><span class="lineno"> 1452</span>&#160; </div>
<div class="line"><a name="l01453"></a><span class="lineno"> 1453</span>&#160;  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> ents) {</div>
<div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;    }</div>
<div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;  };</div>
<div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160; </div>
<div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>.clear();</div>
<div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Sideset %d with crack surface not found\n&quot;</span>,</div>
<div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;                <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;  }</div>
<div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;                                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;                                             <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>);</div>
<div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160; </div>
<div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;  <span class="comment">// Find crack front</span></div>
<div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.clear();</div>
<div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160; </div>
<div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;    <a class="code" href="classRange.html">Range</a> skin_faces_edges;</div>
<div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;    <a class="code" href="classRange.html">Range</a> constrained_faces =</div>
<div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;        unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a50d250b3d989ea7abcba684e97cbd55b">contactMeshsetFaces</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>);</div>
<div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>, constrained_faces), 1, <span class="keyword">false</span>,</div>
<div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;                                skin_faces_edges, moab::Interface::UNION);</div>
<div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_front;</div>
<div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    Skinner skin(&amp;m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>, <span class="keyword">false</span>, crack_front);</div>
<div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    crack_front = subtract(crack_front, skin_faces_edges);</div>
<div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>);</div>
<div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, meshset);</div>
<div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, crack_front);</div>
<div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;  }</div>
<div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160; </div>
<div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a name="l01496"></a><span class="lineno"> 1496</span>&#160;                                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160; </div>
<div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;  <a class="code" href="classRange.html">Range</a> crack_faces_edges;</div>
<div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>, 1, <span class="keyword">false</span>, crack_faces_edges,</div>
<div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;                              moab::Interface::UNION);</div>
<div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> = intersect(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, crack_faces_edges);</div>
<div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160; </div>
<div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>)</div>
<div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a name="l01505"></a><span class="lineno"> 1505</span>&#160;      cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01506"></a><span class="lineno"> 1506</span>&#160; </div>
<div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;    save_mesh(<span class="stringliteral">&quot;out_crack_and_front.vtk&quot;</span>, unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>));</div>
<div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160; </div>
<div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;}</div>
<div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160; </div>
<div class="line"><a name="l01513"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a014e0fb69b4ef71920cc16ba3a7a6447"> 1513</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a014e0fb69b4ef71920cc16ba3a7a6447">CPMeshCut::findCrackFromPrisms</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;                                              <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160; </div>
<div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;  <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code" href="classRange.html">Range</a> ents) {</div>
<div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset, ents);</div>
<div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    }</div>
<div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;  };</div>
<div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160; </div>
<div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;  <a class="code" href="classRange.html">Range</a> prisms_level;</div>
<div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;                                                 MBPRISM, prisms_level);</div>
<div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;  prisms_level = subtract(prisms_level, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>);</div>
<div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  prisms_level = subtract(prisms_level, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160; </div>
<div class="line"><a name="l01538"></a><span class="lineno"> 1538</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.clear();</div>
<div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.clear();</div>
<div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : prisms_level) {</div>
<div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> face3, face4;</div>
<div class="line"><a name="l01542"></a><span class="lineno"> 1542</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().side_element(p, 2, 3, face3);</div>
<div class="line"><a name="l01543"></a><span class="lineno"> 1543</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().side_element(p, 2, 4, face4);</div>
<div class="line"><a name="l01544"></a><span class="lineno"> 1544</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.insert(face3);</div>
<div class="line"><a name="l01545"></a><span class="lineno"> 1545</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.insert(face4);</div>
<div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  }</div>
<div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a> = unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>);</div>
<div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a41119eae52ef09ee41400233e1da8d78">deleteMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>,</div>
<div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;                                             <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>);</div>
<div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160; </div>
<div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aeead6e0c0f5b67f3aee1062f4668248e">otherSideConstrains</a> == PETSC_TRUE)</div>
<div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.swap(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>);</div>
<div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160; </div>
<div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;out_one_side.vtk&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>);</div>
<div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.empty())</div>
<div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> save_mesh(<span class="stringliteral">&quot;out_other_side.vtk&quot;</span>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>);</div>
<div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;    }</div>
<div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160; </div>
<div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.empty()) {</div>
<div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.size() != <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.size())</div>
<div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;      SETERRQ2(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;               <span class="stringliteral">&quot;Wrong number of faces on both sides of crack %d != %d&quot;</span>,</div>
<div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.size(), <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.size());</div>
<div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;  }</div>
<div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160; </div>
<div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;  <span class="comment">// Find crack front</span></div>
<div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.clear();</div>
<div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160; </div>
<div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a41119eae52ef09ee41400233e1da8d78">deleteMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;  <span class="keyword">auto</span> create_front_meshset = [&amp;]() {</div>
<div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;    <a class="code" href="classRange.html">Range</a> skin_faces_edges;</div>
<div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">bodySkin</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">constrainedInterface</a>), 1,</div>
<div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;                                <span class="keyword">false</span>, skin_faces_edges,</div>
<div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;                                moab::Interface::UNION);</div>
<div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_front;</div>
<div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    Skinner skin(&amp;m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>, <span class="keyword">false</span>, crack_front);</div>
<div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;    crack_front = subtract(crack_front, skin_faces_edges);</div>
<div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>);</div>
<div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>,</div>
<div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;                                               crack_front);</div>
<div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;  };</div>
<div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> create_front_meshset();</div>
<div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;                                               <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160; </div>
<div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>)</div>
<div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;      cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> &lt;&lt; endl;</div>
<div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160; </div>
<div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>) {</div>
<div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(),</div>
<div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;                       <span class="stringliteral">&quot;number of Crack Surfaces Faces = %d\n&quot;</span>,</div>
<div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;                       <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>.size());</div>
<div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(),</div>
<div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;                       <span class="stringliteral">&quot;number of Crack Surfaces Faces On One Side = %d\n&quot;</span>,</div>
<div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;                       <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">oneSideCrackFaces</a>.size());</div>
<div class="line"><a name="l01604"></a><span class="lineno"> 1604</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(),</div>
<div class="line"><a name="l01605"></a><span class="lineno"> 1605</span>&#160;                       <span class="stringliteral">&quot;number of Crack Surfaces Faces On Other Side = %d\n&quot;</span>,</div>
<div class="line"><a name="l01606"></a><span class="lineno"> 1606</span>&#160;                       <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">otherSideCrackFaces</a>.size());</div>
<div class="line"><a name="l01607"></a><span class="lineno"> 1607</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <span class="stringliteral">&quot;number of Crack Front Edges = %d\n&quot;</span>,</div>
<div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;                       <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.size());</div>
<div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <a class="code" href="classRange.html">Range</a> prisms_level;</div>
<div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;                                                   MBPRISM, prisms_level);</div>
<div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <span class="stringliteral">&quot;number of Prisms = %d\n&quot;</span>,</div>
<div class="line"><a name="l01613"></a><span class="lineno"> 1613</span>&#160;                       prisms_level.size());</div>
<div class="line"><a name="l01614"></a><span class="lineno"> 1614</span>&#160;  }</div>
<div class="line"><a name="l01615"></a><span class="lineno"> 1615</span>&#160; </div>
<div class="line"><a name="l01616"></a><span class="lineno"> 1616</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;    save_mesh(<span class="stringliteral">&quot;out_crack_and_front.vtk&quot;</span>, unite(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">crackFaces</a>));</div>
<div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160; </div>
<div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;}</div>
<div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160; </div>
<div class="line"><a name="l01622"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#ad9414d2adc14b121e7f705819054458d"> 1622</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad9414d2adc14b121e7f705819054458d">CPMeshCut::splitFaces</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;  <a class="code" href="structMoFEM_1_1PrismInterface.html">PrismInterface</a> *prism_interface;</div>
<div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(prism_interface);</div>
<div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160; </div>
<div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_split = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>];</div>
<div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160; </div>
<div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;  <span class="comment">// split sides</span></div>
<div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_interface;</div>
<div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;    PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Sideset %d with crack surface not found\n&quot;</span>,</div>
<div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;                <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>);</div>
<div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;    <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gae0020f4f7cf7b27b8562f77fe5f21cab">getEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), ents);</div>
<div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga486c46f5509f4e3e1d2f92b474ca781a">addBitRefLevel</a>(ents, bit_split);</div>
<div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l01641"></a><span class="lineno"> 1641</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l01642"></a><span class="lineno"> 1642</span>&#160; </div>
<div class="line"><a name="l01643"></a><span class="lineno"> 1643</span>&#160;    <span class="comment">// clear tags data created by previous use of prism interface</span></div>
<div class="line"><a name="l01644"></a><span class="lineno"> 1644</span>&#160;    Tag th_interface_side;</div>
<div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> =</div>
<div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;        m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>, th_interface_side);</div>
<div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_delete(th_interface_side);</div>
<div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160; </div>
<div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    <span class="comment">// create meshset and insert entities from bit level to it</span></div>
<div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> bit_meshset;</div>
<div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_meshset(MESHSET_SET, bit_meshset);</div>
<div class="line"><a name="l01653"></a><span class="lineno"> 1653</span>&#160; </div>
<div class="line"><a name="l01654"></a><span class="lineno"> 1654</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01655"></a><span class="lineno"> 1655</span>&#160;                                                   MBTET, bit_meshset);</div>
<div class="line"><a name="l01656"></a><span class="lineno"> 1656</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;                                                   MBPRISM, bit_meshset);</div>
<div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160; </div>
<div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="keyword">auto</span> save_mesh = [&amp;](<span class="keyword">const</span> std::string file, <span class="keyword">const</span> <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset) {</div>
<div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;      <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0)</div>
<div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(file.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset, 1);</div>
<div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    };</div>
<div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160; </div>
<div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;                                     meshset_interface);</div>
<div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      save_mesh(<span class="stringliteral">&quot;crack_surface_before_split.vtk&quot;</span>, meshset_interface);</div>
<div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160; </div>
<div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code" href="structMoFEM_1_1PrismInterface.html#a647ba4accc02b9b9c863af097045bb42">getSides</a>(meshset_interface, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">true</span>, <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code" href="structMoFEM_1_1PrismInterface.html#ada01f8c0c3d86a8ae0e5cc2abdf59ceb">splitSides</a>(bit_meshset, bit_split,</div>
<div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;                                       meshset_interface, <span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="comment">// add refined ent to cubit meshsets</span></div>
<div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(m_field, cubit_it)) {</div>
<div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> update_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;          update_meshset, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_split, bit_split,</div>
<div class="line"><a name="l01679"></a><span class="lineno"> 1679</span>&#160;          update_meshset, MBMAXTYPE, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01680"></a><span class="lineno"> 1680</span>&#160;    }</div>
<div class="line"><a name="l01681"></a><span class="lineno"> 1681</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;bit_meshset, 1);</div>
<div class="line"><a name="l01682"></a><span class="lineno"> 1682</span>&#160; </div>
<div class="line"><a name="l01683"></a><span class="lineno"> 1683</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a65aee45b2a3a458fd753a730a81509bb">isPartitioned</a>) {</div>
<div class="line"><a name="l01684"></a><span class="lineno"> 1684</span>&#160;      ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a name="l01685"></a><span class="lineno"> 1685</span>&#160;      Tag part_tag = pcomm-&gt;part_tag();</div>
<div class="line"><a name="l01686"></a><span class="lineno"> 1686</span>&#160;      <a class="code" href="classRange.html">Range</a> tagged_sets;</div>
<div class="line"><a name="l01687"></a><span class="lineno"> 1687</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_type_and_tag(</div>
<div class="line"><a name="l01688"></a><span class="lineno"> 1688</span>&#160;          0, MBENTITYSET, &amp;part_tag, NULL, 1, tagged_sets,</div>
<div class="line"><a name="l01689"></a><span class="lineno"> 1689</span>&#160;          moab::Interface::UNION);</div>
<div class="line"><a name="l01690"></a><span class="lineno"> 1690</span>&#160;      <span class="keywordflow">for</span> (Range::iterator mit = tagged_sets.begin(); mit != tagged_sets.end();</div>
<div class="line"><a name="l01691"></a><span class="lineno"> 1691</span>&#160;           mit++) {</div>
<div class="line"><a name="l01692"></a><span class="lineno"> 1692</span>&#160;        <span class="keywordtype">int</span> part;</div>
<div class="line"><a name="l01693"></a><span class="lineno"> 1693</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(part_tag, &amp;*mit, 1, &amp;part);</div>
<div class="line"><a name="l01694"></a><span class="lineno"> 1694</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a name="l01695"></a><span class="lineno"> 1695</span>&#160;            *mit, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_split, bit_split, *mit, MBTET,</div>
<div class="line"><a name="l01696"></a><span class="lineno"> 1696</span>&#160;            <span class="keyword">true</span>);</div>
<div class="line"><a name="l01697"></a><span class="lineno"> 1697</span>&#160;        <a class="code" href="classRange.html">Range</a> ents3d;</div>
<div class="line"><a name="l01698"></a><span class="lineno"> 1698</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(*mit, 3, ents3d, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01699"></a><span class="lineno"> 1699</span>&#160;        <span class="keywordflow">for</span> (Range::iterator eit = ents3d.begin(); eit != ents3d.end(); eit++) {</div>
<div class="line"><a name="l01700"></a><span class="lineno"> 1700</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a name="l01701"></a><span class="lineno"> 1701</span>&#160;        }</div>
<div class="line"><a name="l01702"></a><span class="lineno"> 1702</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>++) {</div>
<div class="line"><a name="l01703"></a><span class="lineno"> 1703</span>&#160;          <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l01704"></a><span class="lineno"> 1704</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>, <span class="keyword">false</span>, ents,</div>
<div class="line"><a name="l01705"></a><span class="lineno"> 1705</span>&#160;                                      moab::Interface::UNION);</div>
<div class="line"><a name="l01706"></a><span class="lineno"> 1706</span>&#160;          <span class="keywordflow">for</span> (Range::iterator eit = ents.begin(); eit != ents.end(); eit++) {</div>
<div class="line"><a name="l01707"></a><span class="lineno"> 1707</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a name="l01708"></a><span class="lineno"> 1708</span>&#160;          }</div>
<div class="line"><a name="l01709"></a><span class="lineno"> 1709</span>&#160;        }</div>
<div class="line"><a name="l01710"></a><span class="lineno"> 1710</span>&#160;      }</div>
<div class="line"><a name="l01711"></a><span class="lineno"> 1711</span>&#160;    }</div>
<div class="line"><a name="l01712"></a><span class="lineno"> 1712</span>&#160; </div>
<div class="line"><a name="l01713"></a><span class="lineno"> 1713</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01714"></a><span class="lineno"> 1714</span>&#160;      <a class="code" href="classRange.html">Range</a> tets_level;</div>
<div class="line"><a name="l01715"></a><span class="lineno"> 1715</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l01716"></a><span class="lineno"> 1716</span>&#160;          bit_split, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, tets_level);</div>
<div class="line"><a name="l01717"></a><span class="lineno"> 1717</span>&#160;      <a class="code" href="classRange.html">Range</a> prisms_level;</div>
<div class="line"><a name="l01718"></a><span class="lineno"> 1718</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l01719"></a><span class="lineno"> 1719</span>&#160;          bit_split, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, prisms_level);</div>
<div class="line"><a name="l01720"></a><span class="lineno"> 1720</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_level;</div>
<div class="line"><a name="l01721"></a><span class="lineno"> 1721</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_level);</div>
<div class="line"><a name="l01722"></a><span class="lineno"> 1722</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_level, tets_level);</div>
<div class="line"><a name="l01723"></a><span class="lineno"> 1723</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_tets_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset_level,</div>
<div class="line"><a name="l01724"></a><span class="lineno"> 1724</span>&#160;                             1);</div>
<div class="line"><a name="l01725"></a><span class="lineno"> 1725</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_level, 1);</div>
<div class="line"><a name="l01726"></a><span class="lineno"> 1726</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_prims_level;</div>
<div class="line"><a name="l01727"></a><span class="lineno"> 1727</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_prims_level);</div>
<div class="line"><a name="l01728"></a><span class="lineno"> 1728</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_prims_level, prisms_level);</div>
<div class="line"><a name="l01729"></a><span class="lineno"> 1729</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_prisms_level.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l01730"></a><span class="lineno"> 1730</span>&#160;                             &amp;meshset_prims_level, 1);</div>
<div class="line"><a name="l01731"></a><span class="lineno"> 1731</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_prims_level, 1);</div>
<div class="line"><a name="l01732"></a><span class="lineno"> 1732</span>&#160;    }</div>
<div class="line"><a name="l01733"></a><span class="lineno"> 1733</span>&#160;  }</div>
<div class="line"><a name="l01734"></a><span class="lineno"> 1734</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01735"></a><span class="lineno"> 1735</span>&#160;    <a class="code" href="classRange.html">Range</a> tets_level;</div>
<div class="line"><a name="l01736"></a><span class="lineno"> 1736</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(bit_split, bit_split, MBTET,</div>
<div class="line"><a name="l01737"></a><span class="lineno"> 1737</span>&#160;                                                   tets_level);</div>
<div class="line"><a name="l01738"></a><span class="lineno"> 1738</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_level;</div>
<div class="line"><a name="l01739"></a><span class="lineno"> 1739</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_level);</div>
<div class="line"><a name="l01740"></a><span class="lineno"> 1740</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(meshset_level, tets_level);</div>
<div class="line"><a name="l01741"></a><span class="lineno"> 1741</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(<span class="stringliteral">&quot;out_tets_level_only.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset_level,</div>
<div class="line"><a name="l01742"></a><span class="lineno"> 1742</span>&#160;                           1);</div>
<div class="line"><a name="l01743"></a><span class="lineno"> 1743</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_level, 1);</div>
<div class="line"><a name="l01744"></a><span class="lineno"> 1744</span>&#160;  }</div>
<div class="line"><a name="l01745"></a><span class="lineno"> 1745</span>&#160; </div>
<div class="line"><a name="l01746"></a><span class="lineno"> 1746</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01747"></a><span class="lineno"> 1747</span>&#160;}</div>
<div class="line"><a name="l01748"></a><span class="lineno"> 1748</span>&#160; </div>
<div class="line"><a name="l01749"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#ac03fb84b9a137a9a8572682605040928"> 1749</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac03fb84b9a137a9a8572682605040928">CPMeshCut::addMortarContactPrisms</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l01750"></a><span class="lineno"> 1750</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01751"></a><span class="lineno"> 1751</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01752"></a><span class="lineno"> 1752</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01753"></a><span class="lineno"> 1753</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01754"></a><span class="lineno"> 1754</span>&#160; </div>
<div class="line"><a name="l01755"></a><span class="lineno"> 1755</span>&#160;  <a class="code" href="classRange.html">Range</a> integration_triangles;</div>
<div class="line"><a name="l01756"></a><span class="lineno"> 1756</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2496119aca48db18ce9f7b07361b6918">mortarContactMasterFaces</a>.clear();</div>
<div class="line"><a name="l01757"></a><span class="lineno"> 1757</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2c41e0bae191cf557046c75f7f69fc29">mortarContactSlaveFaces</a>.clear();</div>
<div class="line"><a name="l01758"></a><span class="lineno"> 1758</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.clear();</div>
<div class="line"><a name="l01759"></a><span class="lineno"> 1759</span>&#160; </div>
<div class="line"><a name="l01760"></a><span class="lineno"> 1760</span>&#160;  <a class="code" href="classRange.html">Range</a> all_masters, all_slaves;</div>
<div class="line"><a name="l01761"></a><span class="lineno"> 1761</span>&#160; </div>
<div class="line"><a name="l01762"></a><span class="lineno"> 1762</span>&#160;  std::vector&lt;std::pair&lt;Range, Range&gt;&gt; contact_surface_pairs; <span class="comment">// &lt;Slave, Master&gt;</span></div>
<div class="line"><a name="l01763"></a><span class="lineno"> 1763</span>&#160; </div>
<div class="line"><a name="l01764"></a><span class="lineno"> 1764</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMortarContactStructures.html#a02e23615d8b38cf6805185e1c306025e">MortarContactStructures::findContactSurfacePairs</a>(</div>
<div class="line"><a name="l01765"></a><span class="lineno"> 1765</span>&#160;      m_field, contact_surface_pairs);</div>
<div class="line"><a name="l01766"></a><span class="lineno"> 1766</span>&#160; </div>
<div class="line"><a name="l01767"></a><span class="lineno"> 1767</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ada5dc07850715aa99eeec5ccbe219b22">contactSearchMultiIndexPtr</a> =</div>
<div class="line"><a name="l01768"></a><span class="lineno"> 1768</span>&#160;      boost::shared_ptr&lt;ContactSearchKdTree::ContactCommonData_multiIndex&gt;(</div>
<div class="line"><a name="l01769"></a><span class="lineno"> 1769</span>&#160;          <span class="keyword">new</span> <a class="code" href="structContactSearchKdTree.html#aa524bf476b41d855570186c22c92d989">ContactSearchKdTree::ContactCommonData_multiIndex</a>());</div>
<div class="line"><a name="l01770"></a><span class="lineno"> 1770</span>&#160; </div>
<div class="line"><a name="l01771"></a><span class="lineno"> 1771</span>&#160;  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;contact_surface_pair : contact_surface_pairs) {</div>
<div class="line"><a name="l01772"></a><span class="lineno"> 1772</span>&#160; </div>
<div class="line"><a name="l01773"></a><span class="lineno"> 1773</span>&#160;    <a class="code" href="classRange.html">Range</a> slave_tris = contact_surface_pair.first;</div>
<div class="line"><a name="l01774"></a><span class="lineno"> 1774</span>&#160;    <a class="code" href="classRange.html">Range</a> master_tris = contact_surface_pair.second;</div>
<div class="line"><a name="l01775"></a><span class="lineno"> 1775</span>&#160; </div>
<div class="line"><a name="l01776"></a><span class="lineno"> 1776</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>],</div>
<div class="line"><a name="l01777"></a><span class="lineno"> 1777</span>&#160;                                               <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), slave_tris);</div>
<div class="line"><a name="l01778"></a><span class="lineno"> 1778</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(</div>
<div class="line"><a name="l01779"></a><span class="lineno"> 1779</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), master_tris);</div>
<div class="line"><a name="l01780"></a><span class="lineno"> 1780</span>&#160; </div>
<div class="line"><a name="l01781"></a><span class="lineno"> 1781</span>&#160;    all_slaves.merge(slave_tris);</div>
<div class="line"><a name="l01782"></a><span class="lineno"> 1782</span>&#160;    all_masters.merge(master_tris);</div>
<div class="line"><a name="l01783"></a><span class="lineno"> 1783</span>&#160; </div>
<div class="line"><a name="l01784"></a><span class="lineno"> 1784</span>&#160;    <span class="keywordflow">if</span> (slave_tris.empty() || master_tris.empty())</div>
<div class="line"><a name="l01785"></a><span class="lineno"> 1785</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l01786"></a><span class="lineno"> 1786</span>&#160; </div>
<div class="line"><a name="l01787"></a><span class="lineno"> 1787</span>&#160;    <a class="code" href="structContactSearchKdTree.html">ContactSearchKdTree</a> contact_search_kd_tree(m_field);</div>
<div class="line"><a name="l01788"></a><span class="lineno"> 1788</span>&#160; </div>
<div class="line"><a name="l01789"></a><span class="lineno"> 1789</span>&#160;    <span class="comment">// create kd_tree with master_surface only</span></div>
<div class="line"><a name="l01790"></a><span class="lineno"> 1790</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> contact_search_kd_tree.<a class="code" href="structContactSearchKdTree.html#a8eeb01dfbd0d967160fb1c8f8f0bfe76">buildTree</a>(master_tris);</div>
<div class="line"><a name="l01791"></a><span class="lineno"> 1791</span>&#160; </div>
<div class="line"><a name="l01792"></a><span class="lineno"> 1792</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> contact_search_kd_tree.<a class="code" href="structContactSearchKdTree.html#a88532ad59785dacf8a672f95b46d02b5">contactSearchAlgorithm</a>(</div>
<div class="line"><a name="l01793"></a><span class="lineno"> 1793</span>&#160;        master_tris, slave_tris, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ada5dc07850715aa99eeec5ccbe219b22">contactSearchMultiIndexPtr</a>,</div>
<div class="line"><a name="l01794"></a><span class="lineno"> 1794</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a name="l01795"></a><span class="lineno"> 1795</span>&#160;  }</div>
<div class="line"><a name="l01796"></a><span class="lineno"> 1796</span>&#160; </div>
<div class="line"><a name="l01797"></a><span class="lineno"> 1797</span>&#160;  <span class="keywordflow">if</span> (all_slaves.empty() || all_masters.empty())</div>
<div class="line"><a name="l01798"></a><span class="lineno"> 1798</span>&#160;    <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l01799"></a><span class="lineno"> 1799</span>&#160; </div>
<div class="line"><a name="l01800"></a><span class="lineno"> 1800</span>&#160;  <a class="code" href="classRange.html">Range</a> tris_from_prism;</div>
<div class="line"><a name="l01801"></a><span class="lineno"> 1801</span>&#160;  <span class="comment">// find actual masters and slave used</span></div>
<div class="line"><a name="l01802"></a><span class="lineno"> 1802</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>, 2, <span class="keyword">true</span>,</div>
<div class="line"><a name="l01803"></a><span class="lineno"> 1803</span>&#160;                                            tris_from_prism,</div>
<div class="line"><a name="l01804"></a><span class="lineno"> 1804</span>&#160;                                            moab::Interface::UNION);</div>
<div class="line"><a name="l01805"></a><span class="lineno"> 1805</span>&#160; </div>
<div class="line"><a name="l01806"></a><span class="lineno"> 1806</span>&#160;  tris_from_prism = tris_from_prism.subset_by_type(MBTRI);</div>
<div class="line"><a name="l01807"></a><span class="lineno"> 1807</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2496119aca48db18ce9f7b07361b6918">mortarContactMasterFaces</a> = intersect(tris_from_prism, all_masters);</div>
<div class="line"><a name="l01808"></a><span class="lineno"> 1808</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2c41e0bae191cf557046c75f7f69fc29">mortarContactSlaveFaces</a> = intersect(tris_from_prism, all_slaves);</div>
<div class="line"><a name="l01809"></a><span class="lineno"> 1809</span>&#160; </div>
<div class="line"><a name="l01810"></a><span class="lineno"> 1810</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_slave_master_prisms;</div>
<div class="line"><a name="l01811"></a><span class="lineno"> 1811</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, meshset_slave_master_prisms);</div>
<div class="line"><a name="l01812"></a><span class="lineno"> 1812</span>&#160; </div>
<div class="line"><a name="l01813"></a><span class="lineno"> 1813</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line"><a name="l01814"></a><span class="lineno"> 1814</span>&#160;  moab.add_entities(meshset_slave_master_prisms, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a name="l01815"></a><span class="lineno"> 1815</span>&#160; </div>
<div class="line"><a name="l01816"></a><span class="lineno"> 1816</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a name="l01817"></a><span class="lineno"> 1817</span>&#160;      meshset_slave_master_prisms, 3, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a name="l01818"></a><span class="lineno"> 1818</span>&#160; </div>
<div class="line"><a name="l01819"></a><span class="lineno"> 1819</span>&#160;  <span class="keyword">typedef</span> ContactSearchKdTree::ContactCommonData_multiIndex::index&lt;</div>
<div class="line"><a name="l01820"></a><span class="lineno"> 1820</span>&#160;      <a class="code" href="structContactSearchKdTree_1_1Prism__tag.html">ContactSearchKdTree::Prism_tag</a>&gt;::type::iterator ItMultIndexPrism;</div>
<div class="line"><a name="l01821"></a><span class="lineno"> 1821</span>&#160; </div>
<div class="line"><a name="l01822"></a><span class="lineno"> 1822</span>&#160;  <span class="keywordflow">for</span> (Range::iterator it_tri = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.begin();</div>
<div class="line"><a name="l01823"></a><span class="lineno"> 1823</span>&#160;       it_tri != <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.end(); ++it_tri) {</div>
<div class="line"><a name="l01824"></a><span class="lineno"> 1824</span>&#160; </div>
<div class="line"><a name="l01825"></a><span class="lineno"> 1825</span>&#160;    ItMultIndexPrism it_mult_index_prism =</div>
<div class="line"><a name="l01826"></a><span class="lineno"> 1826</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ada5dc07850715aa99eeec5ccbe219b22">contactSearchMultiIndexPtr</a>-&gt;get&lt;<a class="code" href="structContactSearchKdTree_1_1Prism__tag.html">ContactSearchKdTree::Prism_tag</a>&gt;()</div>
<div class="line"><a name="l01827"></a><span class="lineno"> 1827</span>&#160;            .find(*it_tri);</div>
<div class="line"><a name="l01828"></a><span class="lineno"> 1828</span>&#160; </div>
<div class="line"><a name="l01829"></a><span class="lineno"> 1829</span>&#160;    <a class="code" href="classRange.html">Range</a> range_poly_tris;</div>
<div class="line"><a name="l01830"></a><span class="lineno"> 1830</span>&#160;    range_poly_tris.clear();</div>
<div class="line"><a name="l01831"></a><span class="lineno"> 1831</span>&#160;    range_poly_tris = it_mult_index_prism-&gt;get()-&gt;commonIntegratedTriangle;</div>
<div class="line"><a name="l01832"></a><span class="lineno"> 1832</span>&#160;    integration_triangles.insert(range_poly_tris.begin(),</div>
<div class="line"><a name="l01833"></a><span class="lineno"> 1833</span>&#160;                                 range_poly_tris.end());</div>
<div class="line"><a name="l01834"></a><span class="lineno"> 1834</span>&#160;  }</div>
<div class="line"><a name="l01835"></a><span class="lineno"> 1835</span>&#160; </div>
<div class="line"><a name="l01836"></a><span class="lineno"> 1836</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> ent_integration_vertex;</div>
<div class="line"><a name="l01837"></a><span class="lineno"> 1837</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ent_integration_vertex);</div>
<div class="line"><a name="l01838"></a><span class="lineno"> 1838</span>&#160; </div>
<div class="line"><a name="l01839"></a><span class="lineno"> 1839</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> ent_integration_edge;</div>
<div class="line"><a name="l01840"></a><span class="lineno"> 1840</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ent_integration_edge);</div>
<div class="line"><a name="l01841"></a><span class="lineno"> 1841</span>&#160; </div>
<div class="line"><a name="l01842"></a><span class="lineno"> 1842</span>&#160;  <a class="code" href="classRange.html">Range</a> edges, verts;</div>
<div class="line"><a name="l01843"></a><span class="lineno"> 1843</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(integration_triangles, 1, <span class="keyword">true</span>,</div>
<div class="line"><a name="l01844"></a><span class="lineno"> 1844</span>&#160;                                            edges, moab::Interface::UNION);</div>
<div class="line"><a name="l01845"></a><span class="lineno"> 1845</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(ent_integration_edge, edges);</div>
<div class="line"><a name="l01846"></a><span class="lineno"> 1846</span>&#160; </div>
<div class="line"><a name="l01847"></a><span class="lineno"> 1847</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_connectivity(integration_triangles, verts,</div>
<div class="line"><a name="l01848"></a><span class="lineno"> 1848</span>&#160;                                             <span class="keyword">true</span>);</div>
<div class="line"><a name="l01849"></a><span class="lineno"> 1849</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(ent_integration_vertex, verts);</div>
<div class="line"><a name="l01850"></a><span class="lineno"> 1850</span>&#160; </div>
<div class="line"><a name="l01851"></a><span class="lineno"> 1851</span>&#160;  <a class="code" href="classEntityHandle.html">EntityHandle</a> ent_integration_tris;</div>
<div class="line"><a name="l01852"></a><span class="lineno"> 1852</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ent_integration_tris);</div>
<div class="line"><a name="l01853"></a><span class="lineno"> 1853</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(ent_integration_tris, integration_triangles);</div>
<div class="line"><a name="l01854"></a><span class="lineno"> 1854</span>&#160; </div>
<div class="line"><a name="l01855"></a><span class="lineno"> 1855</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a name="l01856"></a><span class="lineno"> 1856</span>&#160;      ent_integration_vertex, 0, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a name="l01857"></a><span class="lineno"> 1857</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a name="l01858"></a><span class="lineno"> 1858</span>&#160;      ent_integration_edge, 1, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a name="l01859"></a><span class="lineno"> 1859</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line"><a name="l01860"></a><span class="lineno"> 1860</span>&#160;      ent_integration_tris, 2, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>]);</div>
<div class="line"><a name="l01861"></a><span class="lineno"> 1861</span>&#160; </div>
<div class="line"><a name="l01862"></a><span class="lineno"> 1862</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;ent_integration_tris, 1);</div>
<div class="line"><a name="l01863"></a><span class="lineno"> 1863</span>&#160; </div>
<div class="line"><a name="l01864"></a><span class="lineno"> 1864</span>&#160;  <span class="keyword">const</span> std::string output_name = <span class="stringliteral">&quot;slave_master_prisms.vtk&quot;</span>;</div>
<div class="line"><a name="l01865"></a><span class="lineno"> 1865</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_mesh(output_name.c_str(), &amp;meshset_slave_master_prisms, 1);</div>
<div class="line"><a name="l01866"></a><span class="lineno"> 1866</span>&#160; </div>
<div class="line"><a name="l01867"></a><span class="lineno"> 1867</span>&#160;  <span class="comment">// get integration tris of each prism</span></div>
<div class="line"><a name="l01868"></a><span class="lineno"> 1868</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;meshset_slave_master_prisms, 1);</div>
<div class="line"><a name="l01869"></a><span class="lineno"> 1869</span>&#160; </div>
<div class="line"><a name="l01870"></a><span class="lineno"> 1870</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01871"></a><span class="lineno"> 1871</span>&#160;}</div>
<div class="line"><a name="l01872"></a><span class="lineno"> 1872</span>&#160; </div>
<div class="line"><a name="l01873"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a41a144d57c8ca97574d6b5714b2be697"> 1873</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a41a144d57c8ca97574d6b5714b2be697">CPMeshCut::insertContactInterface</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l01874"></a><span class="lineno"> 1874</span>&#160;                                                 <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l01875"></a><span class="lineno"> 1875</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l01876"></a><span class="lineno"> 1876</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l01877"></a><span class="lineno"> 1877</span>&#160;  <a class="code" href="structMoFEM_1_1PrismInterface.html">PrismInterface</a> *prism_interface;</div>
<div class="line"><a name="l01878"></a><span class="lineno"> 1878</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l01879"></a><span class="lineno"> 1879</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(prism_interface);</div>
<div class="line"><a name="l01880"></a><span class="lineno"> 1880</span>&#160; </div>
<div class="line"><a name="l01881"></a><span class="lineno"> 1881</span>&#160;  std::vector&lt;BitRefLevel&gt; bit_levels;</div>
<div class="line"><a name="l01882"></a><span class="lineno"> 1882</span>&#160;  bit_levels.push_back(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>]);</div>
<div class="line"><a name="l01883"></a><span class="lineno"> 1883</span>&#160; </div>
<div class="line"><a name="l01884"></a><span class="lineno"> 1884</span>&#160;  <span class="keyword">auto</span> get_cracked_not_in_body_blockset = [&amp;](<span class="keyword">auto</span> ref_level_meshset) {</div>
<div class="line"><a name="l01885"></a><span class="lineno"> 1885</span>&#160;    <a class="code" href="classRange.html">Range</a> ref_level_tet;</div>
<div class="line"><a name="l01886"></a><span class="lineno"> 1886</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(ref_level_meshset, MBTET, ref_level_tet,</div>
<div class="line"><a name="l01887"></a><span class="lineno"> 1887</span>&#160;                                     0);</div>
<div class="line"><a name="l01888"></a><span class="lineno"> 1888</span>&#160;    <a class="code" href="classRange.html">Range</a> cracked_body_tets;</div>
<div class="line"><a name="l01889"></a><span class="lineno"> 1889</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a name="l01890"></a><span class="lineno"> 1890</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">crackedBodyBlockSetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, cracked_body_tets, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01891"></a><span class="lineno"> 1891</span>&#160;    <span class="keywordflow">return</span> subtract(ref_level_tet, cracked_body_tets);</div>
<div class="line"><a name="l01892"></a><span class="lineno"> 1892</span>&#160;  };</div>
<div class="line"><a name="l01893"></a><span class="lineno"> 1893</span>&#160; </div>
<div class="line"><a name="l01894"></a><span class="lineno"> 1894</span>&#160;  std::size_t idx = 0;</div>
<div class="line"><a name="l01895"></a><span class="lineno"> 1895</span>&#160;  <span class="keywordflow">while</span> (!bit_levels.back().test(idx))</div>
<div class="line"><a name="l01896"></a><span class="lineno"> 1896</span>&#160;    ++idx;</div>
<div class="line"><a name="l01897"></a><span class="lineno"> 1897</span>&#160;  <span class="keywordtype">int</span> contact_lvl = idx + 1;</div>
<div class="line"><a name="l01898"></a><span class="lineno"> 1898</span>&#160; </div>
<div class="line"><a name="l01899"></a><span class="lineno"> 1899</span>&#160;  <span class="comment">// Remove parents, that should be no use anymore</span></div>
<div class="line"><a name="l01900"></a><span class="lineno"> 1900</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a315359c2e34aac52f9fa976960b1a46d">reconstructMultiIndex</a>(*m_field.<a class="code" href="group__mofem__access.html#gab328f27a131d4ae6e89a6eebaa9f9cc9">get_ref_ents</a>(),</div>
<div class="line"><a name="l01901"></a><span class="lineno"> 1901</span>&#160;                               <a class="code" href="structMoFEM_1_1RefEntity__change__parent.html">RefEntity_change_parent</a>(0));</div>
<div class="line"><a name="l01902"></a><span class="lineno"> 1902</span>&#160; </div>
<div class="line"><a name="l01903"></a><span class="lineno"> 1903</span>&#160;  <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a>(m_field, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, cit)) {</div>
<div class="line"><a name="l01904"></a><span class="lineno"> 1904</span>&#160;    <span class="keywordflow">if</span> (cit-&gt;getName().compare(0, 11, <span class="stringliteral">&quot;INT_CONTACT&quot;</span>) == 0) {</div>
<div class="line"><a name="l01905"></a><span class="lineno"> 1905</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Insert %s (id: %d)\n&quot;</span>,</div>
<div class="line"><a name="l01906"></a><span class="lineno"> 1906</span>&#160;                         cit-&gt;getName().c_str(), cit-&gt;getMeshsetId());</div>
<div class="line"><a name="l01907"></a><span class="lineno"> 1907</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> cubit_meshset = cit-&gt;getMeshset();</div>
<div class="line"><a name="l01908"></a><span class="lineno"> 1908</span>&#160; </div>
<div class="line"><a name="l01909"></a><span class="lineno"> 1909</span>&#160;      <span class="comment">// get tet entities form back bit_level</span></div>
<div class="line"><a name="l01910"></a><span class="lineno"> 1910</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> ref_level_meshset;</div>
<div class="line"><a name="l01911"></a><span class="lineno"> 1911</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.create_meshset(MESHSET_SET, ref_level_meshset);</div>
<div class="line"><a name="l01912"></a><span class="lineno"> 1912</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l01913"></a><span class="lineno"> 1913</span>&#160;          bit_levels.back(), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET, ref_level_meshset);</div>
<div class="line"><a name="l01914"></a><span class="lineno"> 1914</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l01915"></a><span class="lineno"> 1915</span>&#160;          bit_levels.back(), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, ref_level_meshset);</div>
<div class="line"><a name="l01916"></a><span class="lineno"> 1916</span>&#160; </div>
<div class="line"><a name="l01917"></a><span class="lineno"> 1917</span>&#160;      <span class="comment">// get faces and tets to split</span></div>
<div class="line"><a name="l01918"></a><span class="lineno"> 1918</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code" href="structMoFEM_1_1PrismInterface.html#a647ba4accc02b9b9c863af097045bb42">getSides</a>(</div>
<div class="line"><a name="l01919"></a><span class="lineno"> 1919</span>&#160;          cubit_meshset, bit_levels.back(),</div>
<div class="line"><a name="l01920"></a><span class="lineno"> 1920</span>&#160;          get_cracked_not_in_body_blockset(ref_level_meshset), <span class="keyword">true</span>, verb);</div>
<div class="line"><a name="l01921"></a><span class="lineno"> 1921</span>&#160;      <span class="comment">// set new bit level</span></div>
<div class="line"><a name="l01922"></a><span class="lineno"> 1922</span>&#160;      bit_levels.push_back(<a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(contact_lvl));</div>
<div class="line"><a name="l01923"></a><span class="lineno"> 1923</span>&#160;      <span class="comment">// split faces and tets</span></div>
<div class="line"><a name="l01924"></a><span class="lineno"> 1924</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prism_interface-&gt;<a class="code" href="structMoFEM_1_1PrismInterface.html#ada01f8c0c3d86a8ae0e5cc2abdf59ceb">splitSides</a>(ref_level_meshset, bit_levels.back(),</div>
<div class="line"><a name="l01925"></a><span class="lineno"> 1925</span>&#160;                                         cubit_meshset, <span class="keyword">true</span>, <span class="keyword">true</span>, verb);</div>
<div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160; </div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;      <span class="comment">// clean meshsets</span></div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(&amp;ref_level_meshset, 1);</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160; </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;      <span class="comment">// update cubit meshsets</span></div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160;      <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(m_field, cubit_it)) {</div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;        <a class="code" href="classEntityHandle.html">EntityHandle</a> updated_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            updated_meshset, bit_levels.front(), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            bit_levels.back(), bit_levels.back(), updated_meshset, MBMAXTYPE,</div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            <span class="keyword">true</span>);</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;      }</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160; </div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a65aee45b2a3a458fd753a730a81509bb">isPartitioned</a>) {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;        <span class="comment">// FIXME check partitioned case</span></div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;        ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;        Tag part_tag = pcomm-&gt;part_tag();</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160;        <a class="code" href="classRange.html">Range</a> tagged_sets;</div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_type_and_tag(</div>
<div class="line"><a name="l01945"></a><span class="lineno"> 1945</span>&#160;            0, MBENTITYSET, &amp;part_tag, NULL, 1, tagged_sets,</div>
<div class="line"><a name="l01946"></a><span class="lineno"> 1946</span>&#160;            moab::Interface::UNION);</div>
<div class="line"><a name="l01947"></a><span class="lineno"> 1947</span>&#160;        <span class="keywordflow">for</span> (Range::iterator mit = tagged_sets.begin();</div>
<div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;             mit != tagged_sets.end(); mit++) {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;          <span class="keywordtype">int</span> part;</div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(part_tag, &amp;*mit, 1, &amp;part);</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;              *mit, bit_levels.front(), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_levels.back(),</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;              bit_levels.back(), *mit, MBTET, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;          <a class="code" href="classRange.html">Range</a> ents3d;</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(*mit, 3, ents3d, <span class="keyword">true</span>);</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;          <span class="keywordflow">for</span> (Range::iterator eit = ents3d.begin(); eit != ents3d.end();</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;               eit++) {</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;          }</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>++) {</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;            <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>, <span class="keyword">false</span>, ents,</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                                        moab::Interface::UNION);</div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;            <span class="keywordflow">for</span> (Range::iterator eit = ents.begin(); eit != ents.end(); eit++) {</div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;              <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            }</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;          }</div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;        }</div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;      }</div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160; </div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;      <span class="keywordflow">if</span> (contact_lvl &gt; 1) {</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#a42896dd46513db84c3a4c8e49af197e6">delete_ents_by_bit_ref</a>(bit_levels.front(),</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                                              bit_levels.front(), <span class="keyword">true</span>);</div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;      }</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;      <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> shift_mask;</div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = contact_lvl - 1; ll != 19; ++ll) {</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;        shift_mask.set(ll);</div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;      }</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BitRefManager.html">BitRefManager</a>&gt;()-&gt;shiftRightBitRef(</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;          1, shift_mask, verb);</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;      bit_levels.pop_back();</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160;    }</div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160;  }</div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160; </div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>)) {</div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a41119eae52ef09ee41400233e1da8d78">deleteMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>);</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;  }</div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">addMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>);</div>
<div class="line"><a name="l01989"></a><span class="lineno"> 1989</span>&#160; </div>
<div class="line"><a name="l01990"></a><span class="lineno"> 1990</span>&#160;  <a class="code" href="classRange.html">Range</a> prisms_level;</div>
<div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;      bit_levels.back(), <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM, prisms_level);</div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html#a5367f1a046921a007dc217ac04e50964">addEntitiesToMeshset</a>(<a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>,</div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;                                             prisms_level);</div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160; </div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;}</div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a0de9d9a2e911031c8e9086441450a89d"> 2000</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0de9d9a2e911031c8e9086441450a89d">CPMeshCut::findContactFromPrisms</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;                                                <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160; </div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>.clear();</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>.clear();</div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>.clear();</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160; </div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">contactPrismsBlockSetId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 3, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">filterEntitiesByRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;                                             <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>);</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>.empty())</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a> = subtract(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">mortarContactElements</a>);</div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160; </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>.empty()) {</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> tri;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p : <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">contactElements</a>) {</div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 3, tri);</div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>.insert(tri);</div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.side_element(p, 2, 4, tri);</div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;      <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>.insert(tri);</div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;    }</div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;  }</div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;  <a class="code" href="classRange.html">Range</a> slave_nodes, master_nodes;</div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>, slave_nodes, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>, master_nodes, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160; </div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;  <span class="keywordflow">if</span> (slave_nodes.size() &lt; master_nodes.size()) {</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ad82f7651bfa9bdd97923bafe67507970">contactBothSidesSlaveFaces</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>;</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6f5533e767c5bbc98475098a32ae331d">contactBothSidesMasterFaces</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>;</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160;  } <span class="keywordflow">else</span> {</div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ad82f7651bfa9bdd97923bafe67507970">contactBothSidesSlaveFaces</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">contactMasterFaces</a>;</div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a6f5533e767c5bbc98475098a32ae331d">contactBothSidesMasterFaces</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab6024a39e3da574d0222508ec9098be3">contactSlaveFaces</a>;</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160;  }</div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;}</div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160; </div>
<div class="line"><a name="l02044"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a399c5f3e1a6af3220b14ea3720f542cf"> 2044</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a399c5f3e1a6af3220b14ea3720f542cf">CPMeshCut::refineCrackTip</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> front_id, <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;                                         <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160;  <a class="code" href="structMoFEM_1_1MeshRefinement.html">MeshRefinement</a> *mesh_refiner_ptr;</div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(mesh_refiner_ptr);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160; </div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160; </div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160;  std::size_t idx = 0;</div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.test(idx))</div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    ++idx;</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit_ref = <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(idx + 1);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;  <span class="comment">// loop to refine at crack tip</span></div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a47f76009627efe1034647a0582c73794">refAtCrackTip</a>; ll++) {</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160; </div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    <span class="comment">// get tets at bit level</span></div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160;    <a class="code" href="classRange.html">Range</a> tets_level; <span class="comment">// test at level</span></div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;                                                   MBTET, tets_level);</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    <a class="code" href="classRange.html">Range</a> edges_level; <span class="comment">// edges at level</span></div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;                                                   MBEDGE, edges_level);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(front_id, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>)) {</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;      PetscPrintf(PETSC_COMM_WORLD, <span class="stringliteral">&quot;Sideset %d with crack front not found\n&quot;</span>,</div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;                  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">cuttingSurfaceSidesetId</a>);</div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    }</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_front; <span class="comment">// crack front edges at level</span></div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(front_id, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 1,</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;                                                 crack_front, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    crack_front = intersect(crack_front, edges_level);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_front_nodes; <span class="comment">// nodes at crack front</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(crack_front, crack_front_nodes, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160; </div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <a class="code" href="classRange.html">Range</a> crack_front_nodes_tets; <span class="comment">// tets adjacent to crack front nodes</span></div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(crack_front_nodes, 3, <span class="keyword">false</span>,</div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;                                              crack_front_nodes_tets,</div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;                                              moab::Interface::UNION);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160;    crack_front_nodes_tets = intersect(crack_front_nodes_tets, tets_level);</div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;    <a class="code" href="classRange.html">Range</a> edges_to_refine; <span class="comment">// edges which going to be refined</span></div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_adjacencies(crack_front_nodes_tets, 1, <span class="keyword">false</span>,</div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160;                                              edges_to_refine,</div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160;                                              moab::Interface::UNION);</div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    edges_to_refine = intersect(edges_to_refine, edges_level);</div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;    <span class="keywordflow">if</span> (edges_to_refine.empty())</div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;      <span class="keywordflow">continue</span>;</div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160; </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;    <span class="comment">// create vertices in middle of refined edges</span></div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mesh_refiner_ptr-&gt;<a class="code" href="structMoFEM_1_1MeshRefinement.html#aaed88f73c43b3030907ce108217c39e7">addVerticesInTheMiddleOfEdges</a>(</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;        edges_to_refine, bit_ref, <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;    <span class="comment">// refine tets</span></div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mesh_refiner_ptr-&gt;<a class="code" href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">refineTets</a>(tets_level, bit_ref, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160; </div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;    <span class="comment">// update meshsets by new entities</span></div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="comment">// Meshsets are updated such that: if parent is in the meshset then its</span></div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="comment">// chiled is in the meshset to.</span></div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="keywordflow">for</span> (<a class="code" href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a>(m_field, cubit_it)) {</div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> cubit_meshset = cubit_it-&gt;meshset;</div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;          cubit_meshset, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_ref, bit_ref,</div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;          cubit_meshset, MBMAXTYPE, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    }</div>
<div class="line"><a name="l02109"></a><span class="lineno"> 2109</span>&#160; </div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;    <span class="comment">// update meshsets with partition mesh</span></div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a65aee45b2a3a458fd753a730a81509bb">isPartitioned</a>) {</div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;      ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;      Tag part_tag = pcomm-&gt;part_tag();</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;      <a class="code" href="classRange.html">Range</a> tagged_sets;</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_type_and_tag(</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;          0, MBENTITYSET, &amp;part_tag, NULL, 1, tagged_sets,</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;          moab::Interface::UNION);</div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160;      <span class="keywordflow">for</span> (Range::iterator mit = tagged_sets.begin(); mit != tagged_sets.end();</div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160;           mit++) {</div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160;        <span class="keywordtype">int</span> part;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_data(part_tag, &amp;*mit, 1, &amp;part);</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">updateMeshsetByEntitiesChildren</a>(</div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;            *mit, <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), bit_ref, bit_ref, *mit, MBTET,</div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;            <span class="keyword">true</span>);</div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;        <a class="code" href="classRange.html">Range</a> ents3d;</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(*mit, 3, ents3d, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;        <span class="keywordflow">for</span> (Range::iterator eit = ents3d.begin(); eit != ents3d.end(); eit++) {</div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;        }</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> = 0; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a> != 3; <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>++) {</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;          <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(ents3d, <a class="code" href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">dd</a>, <span class="keyword">false</span>, ents,</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;                                      moab::Interface::UNION);</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160;          <span class="keywordflow">for</span> (Range::iterator eit = ents.begin(); eit != ents.end(); eit++) {</div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160;            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_set_data(part_tag, &amp;*eit, 1, &amp;part);</div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;          }</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;        }</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;      }</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    }</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160; </div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    <span class="comment">// shift bits, if ents in on bit level 0, and only on that bit it is deleted</span></div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160;    <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> shift_mask;</div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 19; ++ll)</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;      shift_mask.set(ll);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(1, shift_mask);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;      <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        std::string name;</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        name = <span class="stringliteral">&quot;out_crack_surface_level_&quot;</span> +</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;               boost::lexical_cast&lt;std::string&gt;(ll) + <span class="stringliteral">&quot;.vtk&quot;</span>;</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;        <a class="code" href="classRange.html">Range</a> crack_faces;</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">getEntitiesByDimension</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, 2,</div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;                                                     crack_faces, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160;        <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset;</div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_meshset(MESHSET_SET, meshset);</div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().add_entities(meshset, crack_faces);</div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, &amp;meshset,</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;                                             1);</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(&amp;meshset, 1);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;      }</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;    }</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;  }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160; </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;}</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160; </div>
<div class="line"><a name="l02168"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a2bc35f903e155d4912ec603711c86f24"> 2168</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a2bc35f903e155d4912ec603711c86f24">CPMeshCut::refineAndSplit</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160; </div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160;  <span class="comment">// clear tags data created by previous use of prism interface</span></div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;  Tag th_interface_side;</div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;INTERFACE_SIDE&quot;</span>, th_interface_side);</div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS)</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_delete(th_interface_side);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;  <span class="keyword">auto</span> delete_mofem_meshsets = [&amp;]() {</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa73d6d4d08509b996a63604173694d8a">getSkinOfTheBodyId</a>(), <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;deleteMeshset(</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160;        <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5d19b596dfc352e6f25afb67a6be6eeb">getCrackFrontId</a>(), <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;  };</div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160; </div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit0 = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> bit1 = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>];</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160; </div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;  <span class="comment">// find body skin</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0016012d2fdfbaa3dea1c7de67159175">findBodySkin</a>(bit0, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;out_body_skin_bit0.vtk&quot;</span>);</div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160;  <span class="comment">// find/get crack surface</span></div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a90e33252d4b7e57d9c2a7596db8ab906">findCrack</a>(bit0, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160; </div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160;  <span class="comment">// refine at crack trip</span></div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a47f76009627efe1034647a0582c73794">refAtCrackTip</a> &gt; 0) {</div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#ab5e9945e34978dce73ab7556f12fff63">doCutMesh</a>) {</div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;      SETERRQ(</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160;          <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a>,</div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;          <span class="stringliteral">&quot;Refinement at the crack front after the crack insertion (&#39;my_ref&#39;) &quot;</span></div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;          <span class="stringliteral">&quot;should not be used when the mesh cutting is on, use &quot;</span></div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;          <span class="stringliteral">&quot;&#39;ref_before_cut&#39; or &#39;ref_before_trim&#39; instead&quot;</span>);</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160;    }</div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a399c5f3e1a6af3220b14ea3720f542cf">refineCrackTip</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">crackFrontId</a>, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0016012d2fdfbaa3dea1c7de67159175">findBodySkin</a>(bit0, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;out_body_skin_bit0_ref.vtk&quot;</span>);</div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a90e33252d4b7e57d9c2a7596db8ab906">findCrack</a>(bit0, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160;  }</div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160; </div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(bit0, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;                                          <span class="stringliteral">&quot;out_mesh_after_refine.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>,</div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;                                          <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160; </div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160; </div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_interface;</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160;                                       meshset_interface);</div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(</div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;          <span class="stringliteral">&quot;crack_surface_before_contact_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;          &amp;meshset_interface, 1);</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;    }</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160; </div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;    <span class="comment">// split faces to insert contact elements</span></div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a41a144d57c8ca97574d6b5714b2be697">insertContactInterface</a>(verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160; </div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;      <a class="code" href="classEntityHandle.html">EntityHandle</a> meshset_interface;</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">meshsetMngPtr</a>-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">getMeshset</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">crackSurfaceId</a>, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a>,</div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;                                       meshset_interface);</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;          <span class="stringliteral">&quot;crack_surface_after_contact_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;          &amp;meshset_interface, 1);</div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(</div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;          <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;          <span class="stringliteral">&quot;out_mesh_after_contact_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(</div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160;          <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM,</div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;          <span class="stringliteral">&quot;out_mesh_contact_prisms.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;    }</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;  }</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160; </div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;  <span class="comment">// split faces to create crack</span></div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad9414d2adc14b121e7f705819054458d">splitFaces</a>(verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160; </div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0de9d9a2e911031c8e9086441450a89d">findContactFromPrisms</a>(bit1, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;  }</div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160; </div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;  <span class="keywordflow">if</span> (!<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af340f907630e7bea7327c538dde8fc7c">ignoreContact</a>) {</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ac03fb84b9a137a9a8572682605040928">addMortarContactPrisms</a>(verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160;  }</div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160; </div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(bit1, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;                                          <span class="stringliteral">&quot;out_mesh_after_split.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>,</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;                                          <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(bit1, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBPRISM,</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;                                          <span class="stringliteral">&quot;out_mesh_after_split_prisms.vtk&quot;</span>,</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;                                          <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;  }</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160;  <span class="comment">// get information about topology</span></div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> delete_mofem_meshsets();</div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160; </div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a5edebe082848c57745b69722a9d173bc">setFixEdgesAndCorners</a>(bit1);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0016012d2fdfbaa3dea1c7de67159175">findBodySkin</a>(bit1, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>, <span class="stringliteral">&quot;out_body_skin_bit1.vtk&quot;</span>);</div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a014e0fb69b4ef71920cc16ba3a7a6447">findCrackFromPrisms</a>(bit1, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad4e135789ce6279536022842795a9305">getFrontEdgesAndElements</a>(bit1, verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160; </div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;}</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a0c8f8b6d829f5bbedc3e31536eb6fce4"> 2278</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a0c8f8b6d829f5bbedc3e31536eb6fce4">CPMeshCut::cutRefineAndSplit</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> verb, <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a71d0f1c883305b8e5376c4406342f57f">debugCut</a>)</div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;    <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160; </div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;  <span class="comment">// FIXME: If will be needed in future one can cut, and split and then put</span></div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;  <span class="comment">// meshes on the right bit ref level.</span></div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160; </div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160;  <span class="comment">// Get entities not in database</span></div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;  <a class="code" href="classRange.html">Range</a> all_free_ents;</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a1646c70292128dbf98b8dca46d7ef10e">getAllEntitiesNotInDatabase</a>(all_free_ents);</div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160; </div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160;  <span class="comment">// Cut mesh</span></div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>];</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160;  std::size_t idx = 0;</div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;  <span class="keywordflow">while</span> (!<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>.test(idx))</div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;    ++idx;</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;  <span class="keywordtype">int</span> first_bit = idx + 1;</div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160; </div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a1bbfb030bcbd86228047ec8c352128ba">cutMesh</a>(first_bit, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160; </div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;  <span class="comment">// Squash bits</span></div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> shift_mask;</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != first_bit + 1; ++ll)</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;    shift_mask.set(ll);</div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">shiftRightBitRef</a>(first_bit, shift_mask, <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>,</div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;                                     <a class="code" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a>);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160; </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;mesh_cut&quot;</span>],</div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;                                          <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;                                          <span class="stringliteral">&quot;out_mesh_after_cut.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160; </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a2bc35f903e155d4912ec603711c86f24">refineAndSplit</a>(verb, <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>);</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>)</div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">writeBitLevelByType</a>(</div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;        <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">mapBitLevel</a>[<span class="stringliteral">&quot;spatial_domain&quot;</span>], <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBTET,</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160;        <span class="stringliteral">&quot;out_mesh_after_split_and_refine.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160; </div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;  <span class="comment">// Delete left obsolete entities</span></div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160; </div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;  <span class="keyword">auto</span> get_entities_to_delete = [&amp;]() {</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;    <a class="code" href="classRange.html">Range</a> ents_not_in_database;</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_handle(0, ents_not_in_database, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;    ents_not_in_database = subtract(</div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;        ents_not_in_database, ents_not_in_database.subset_by_type(MBENTITYSET));</div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="structMoFEM_1_1BitRefManager.html#a87ae77f924ed23ba3ce0f0889e34e093">filterEntitiesNotInDatabase</a>(ents_not_in_database);</div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keywordflow">return</span> subtract(ents_not_in_database, all_free_ents);</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160;  };</div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;  <a class="code" href="classRange.html">Range</a> ents_to_remove = get_entities_to_delete();</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160; </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;  <span class="keyword">auto</span> remove_entities_from_meshsets = [&amp;]() {</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;    <span class="comment">// Remove entities from meshsets</span></div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160;    <a class="code" href="classRange.html">Range</a> meshsets;</div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(0, MBENTITYSET, meshsets, <span class="keyword">false</span>);</div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : meshsets)</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.remove_entities(<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, ents_to_remove);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;  };</div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160; </div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_entities_from_meshsets();</div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.delete_entities(ents_to_remove);</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160; </div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;}</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160; </div>
<div class="line"><a name="l02348"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#ad4e135789ce6279536022842795a9305"> 2348</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad4e135789ce6279536022842795a9305">CPMeshCut::getFrontEdgesAndElements</a>(<span class="keyword">const</span> <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> <a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">int</span> verb,</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160;                                                   <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>;</div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;  <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>();</div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160; </div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;  <a class="code" href="classRange.html">Range</a> level_edges;</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                                                 MBEDGE, level_edges);</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160; </div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>.clear();</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>, <span class="keyword">true</span>);</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>.clear();</div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>, 1, <span class="keyword">false</span>,</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                              <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>, moab::Interface::UNION);</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a> = subtract(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>);</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a> = intersect(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>, level_edges);</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160; </div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160;  <a class="code" href="classRange.html">Range</a> level_tets;</div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(<a class="code" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;                                                 MBTET, level_tets);</div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160; </div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>.clear();</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>, 3, <span class="keyword">false</span>,</div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                              <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>, moab::Interface::UNION);</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a> = intersect(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>, level_tets);</div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160; </div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160;    <a class="code" href="classEntityHandle.html">EntityHandle</a> out_meshset;</div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().create_meshset(MESHSET_SET, out_meshset);</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().add_entities(out_meshset, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>);</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().add_entities(out_meshset, <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>);</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().write_file(<span class="stringliteral">&quot;crack_front_nodes.vtk&quot;</span>, <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;                                           &amp;out_meshset, 1);</div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().delete_entities(&amp;out_meshset, 1);</div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160;  }</div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160; </div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849">VERY_VERBOSE</a>) {</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;getFrontEdgesAndElements &quot;</span>;</div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;crackFront\n&quot;</span> &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160;    cerr &lt;&lt; <span class="stringliteral">&quot;crackFrontNodes\n&quot;</span> &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">crackFront</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a>.size() &lt;&lt; <span class="stringliteral">&quot; &quot;</span>;</div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a>.size() &lt;&lt; endl;</div>
<div class="line"><a name="l02394"></a><span class="lineno"> 2394</span>&#160;  }</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160; </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;  <span class="keywordflow">if</span> (verb &gt;= <a class="code" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a>) {</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">crackFrontNodes</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">crackFrontNodesEdges</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;    cerr &lt;&lt; <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">crackFrontElements</a> &lt;&lt; endl;</div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;  }</div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160; </div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;}</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160; </div>
<div class="line"><a name="l02405"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a557a1b16f8c7516726e4a1e85cc8ff17"> 2405</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a557a1b16f8c7516726e4a1e85cc8ff17">CPMeshCut::setMeshOrgCoords</a>() {</div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160; </div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 20; ll != <a class="code" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a>; ++ll)</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160;    mask.set(ll);</div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160; </div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;  <span class="comment">// Get original mesh</span></div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;  <a class="code" href="classRange.html">Range</a> org_verts;</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(mask, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                                                 MBVERTEX, org_verts);</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160; </div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160;  <span class="comment">// Get original positions from tag</span></div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;  Tag <a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> = <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;ORG_POSITION&quot;</span>, <a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>);</div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160;  <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> == MB_SUCCESS) {</div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;    <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.resize(org_verts.size() * 3);</div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_data(<a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, org_verts,</div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                                             &amp;*<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160;    <span class="comment">// Set cords</span></div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().set_coords(org_verts, &amp;*<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">rval</a> != MB_TAG_NOT_FOUND)</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;    SETERRQ(<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(), <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;            <span class="stringliteral">&quot;Can not get tag handle&quot;</span>);</div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160; </div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160;}</div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160; </div>
<div class="line"><a name="l02433"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a58d5922a7275bd9cc350d7678de4c909"> 2433</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a58d5922a7275bd9cc350d7678de4c909">CPMeshCut::getMeshOrgCoords</a>() {</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160; </div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;  <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a> mask;</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 20; ll != <a class="code" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a>; ++ll)</div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160;    mask.set(ll);</div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160; </div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;  <span class="comment">// Get node coordinates on original mesh</span></div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;  <a class="code" href="classRange.html">Range</a> org_verts;</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">bitRefPtr</a>-&gt;<a class="code" href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">getEntitiesByTypeAndRefLevel</a>(mask, <a class="code" href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                                                 MBVERTEX, org_verts);</div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.resize(org_verts.size() * 3);</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_coords(org_verts, &amp;*<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160; </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160;  <span class="comment">// Save positions on tag</span></div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;  <span class="keywordtype">double</span> def_position[] = {0, 0, 0};</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;  Tag <a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;ORG_POSITION&quot;</span>, 3, MB_TYPE_DOUBLE,</div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160;                                             <a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, MB_TAG_CREAT | MB_TAG_SPARSE,</div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                                             def_position);</div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">cP</a>.<a class="code" href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().tag_set_data(<a class="code" href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>, org_verts,</div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160;                                           &amp;*<a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.begin());</div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160; </div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;}</div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02459"></a><span class="lineno"><a class="line" href="structFractureMechanics_1_1CPMeshCut.html#a6ede3c2430549e561eb5af09519cafa0"> 2459</a></span>&#160;<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6ede3c2430549e561eb5af09519cafa0">CPMeshCut::clearData</a>() {</div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">fixedEdges</a>.clear();</div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">cornerNodes</a>.clear();</div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">fRont</a>.clear();</div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">sUrface</a>.clear();</div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;  <a class="code" href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">originalCoords</a>.clear();</div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160; </div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;};</div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160; </div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;} <span class="comment">// namespace FractureMechanics</span></div>
</div><!-- fragment --></div><!-- contents -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca86c05035d6a2fbc5762f39215d6a8a22">SIDESET</a></div><div class="ttdeci">@ SIDESET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00160">definitions.h:160</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a9d28e04e4051a19811351a0d38f012a0"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a9d28e04e4051a19811351a0d38f012a0">FractureMechanics::CPMeshCut::sHift</a></div><div class="ttdeci">double sHift[3]</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00204">CPMeshCut.hpp:204</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a47f76009627efe1034647a0582c73794"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a47f76009627efe1034647a0582c73794">FractureMechanics::CrackPropagation::refAtCrackTip</a></div><div class="ttdeci">int refAtCrackTip</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00120">CrackPropagation.hpp:120</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_gae0020f4f7cf7b27b8562f77fe5f21cab"><div class="ttname"><a href="group__mofem__bit__ref.html#gae0020f4f7cf7b27b8562f77fe5f21cab">MoFEM::BitRefManager::getEntitiesByRefLevel</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByRefLevel(const BitRefLevel bit, const BitRefLevel mask, const EntityHandle meshset, const int verb=QUIET) const</div><div class="ttdoc">add all ents from ref level given by bit to meshset</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00845">BitRefManager.cpp:845</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_afec7637243fb9ff0c5ccb0c7d91d155c"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#afec7637243fb9ff0c5ccb0c7d91d155c">FractureMechanics::CPMeshCut::cornerNodes</a></div><div class="ttdeci">Range cornerNodes</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00190">CPMeshCut.hpp:190</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html_a5367f1a046921a007dc217ac04e50964"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html#a5367f1a046921a007dc217ac04e50964">MoFEM::MeshsetsManager::addEntitiesToMeshset</a></div><div class="ttdeci">MoFEMErrorCode addEntitiesToMeshset(const CubitBCType cubit_bc_type, const int ms_id, const Range &amp;ents)</div><div class="ttdoc">add entities to cubit meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00418">MeshsetsManager.cpp:418</a></div></div>
<div class="ttc" id="anamespacesurface_html"><div class="ttname"><a href="namespacesurface.html">surface</a></div><div class="ttdef"><b>Definition:</b> <a href="surface_8py_source.html#l00001">surface.py:1</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a2a1a0695ea7feb3a1e73a8707ef9f083"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a2a1a0695ea7feb3a1e73a8707ef9f083">MoFEM::Types::VectorDouble3</a></div><div class="ttdeci">VectorBoundedArray&lt; double, 3 &gt; VectorDouble3</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00092">Types.hpp:92</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a56c4f6d3f19a74f63cf63926ecd3e24a"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a56c4f6d3f19a74f63cf63926ecd3e24a">FractureMechanics::CPMeshCut::getInterfacesPtr</a></div><div class="ttdeci">MoFEMErrorCode getInterfacesPtr()</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00077">CPMeshCut.cpp:77</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a368e8d4d0b459f4e8397f63023ccb9df"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a368e8d4d0b459f4e8397f63023ccb9df">FractureMechanics::CrackPropagation::crackFrontElements</a></div><div class="ttdeci">Range crackFrontElements</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01167">CrackPropagation.hpp:1167</a></div></div>
<div class="ttc" id="aclassEntityHandle_html"><div class="ttname"><a href="classEntityHandle.html">EntityHandle</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_a0c7c582d842a5540d10cc8d84c0c3486"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#a0c7c582d842a5540d10cc8d84c0c3486">MoFEM::CutMeshInterface::setFront</a></div><div class="ttdeci">MoFEMErrorCode setFront(const Range surface)</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00036">CutMeshInterface.cpp:36</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_aaed88f73c43b3030907ce108217c39e7"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#aaed88f73c43b3030907ce108217c39e7">MoFEM::MeshRefinement::addVerticesInTheMiddleOfEdges</a></div><div class="ttdeci">MoFEMErrorCode addVerticesInTheMiddleOfEdges(const EntityHandle meshset, const BitRefLevel &amp;bit, const bool recursive=false, int verb=QUIET, EntityHandle start_v=0)</div><div class="ttdoc">make vertices in the middle of edges in meshset and add them to refinement levels defined by bit</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00042">MeshRefinement.cpp:42</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_gab5e77a98a6ecc9e134bd34fdb161f80a"><div class="ttname"><a href="group__mofem__log__manager.html#gab5e77a98a6ecc9e134bd34fdb161f80a">MoFEM::LogManager::getLog</a></div><div class="ttdeci">static LoggerType &amp; getLog(const std::string channel)</div><div class="ttdoc">Get logger by channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8cpp_source.html#l00395">LogManager.cpp:395</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2caa4fc5b9204f57a31e594e32c02d071e9">NOISY</a></div><div class="ttdeci">@ NOISY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00224">definitions.h:224</a></div></div>
<div class="ttc" id="astructContactSearchKdTree_html_aa524bf476b41d855570186c22c92d989"><div class="ttname"><a href="structContactSearchKdTree.html#aa524bf476b41d855570186c22c92d989">ContactSearchKdTree::ContactCommonData_multiIndex</a></div><div class="ttdeci">multi_index_container&lt; boost::shared_ptr&lt; ContactCommonData &gt;, indexed_by&lt; ordered_unique&lt; tag&lt; Prism_tag &gt;, member&lt; ContactCommonData, EntityHandle, &amp;ContactCommonData::pRism &gt; &gt; &gt; &gt; ContactCommonData_multiIndex</div><div class="ttdef"><b>Definition:</b> <a href="ContactSearchKdTree_8hpp_source.html#l00051">ContactSearchKdTree.hpp:51</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_ab97641158e60e745a8c5f53d0c4b4376"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#ab97641158e60e745a8c5f53d0c4b4376">FractureMechanics::CrackPropagation::crackFaces</a></div><div class="ttdeci">Range crackFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01160">CrackPropagation.hpp:1160</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a399c5f3e1a6af3220b14ea3720f542cf"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a399c5f3e1a6af3220b14ea3720f542cf">FractureMechanics::CPMeshCut::refineCrackTip</a></div><div class="ttdeci">MoFEMErrorCode refineCrackTip(const int front_id, const int verb=1, const bool debug=false)</div><div class="ttdoc">refine elements at crack tip</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02044">CPMeshCut.cpp:2044</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a014e0fb69b4ef71920cc16ba3a7a6447"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a014e0fb69b4ef71920cc16ba3a7a6447">FractureMechanics::CPMeshCut::findCrackFromPrisms</a></div><div class="ttdeci">MoFEMErrorCode findCrackFromPrisms(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get crack front</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01513">CPMeshCut.cpp:1513</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_ac49c841036ab310c3ade79eff45ddc1f"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#ac49c841036ab310c3ade79eff45ddc1f">MoFEM::CutMeshInterface::setVolume</a></div><div class="ttdeci">MoFEMErrorCode setVolume(const Range volume)</div><div class="ttdoc">set volume entities</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00108">CutMeshInterface.cpp:108</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Tools_html"><div class="ttname"><a href="structMoFEM_1_1Tools.html">MoFEM::Tools</a></div><div class="ttdoc">Auxiliary tools.</div><div class="ttdef"><b>Definition:</b> <a href="Tools_8hpp_source.html#l00019">Tools.hpp:19</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a5d2fc244f49e0b52a81e52b9b9bb32ee"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a5d2fc244f49e0b52a81e52b9b9bb32ee">FractureMechanics::CPMeshCut::rebuildCrackSurface</a></div><div class="ttdeci">MoFEMErrorCode rebuildCrackSurface(const double factor, const std::string save_mesh=&quot;&quot;, const int verb=QUIET, bool debug=false)</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00344">CPMeshCut.cpp:344</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PrismInterface_html"><div class="ttname"><a href="structMoFEM_1_1PrismInterface.html">MoFEM::PrismInterface</a></div><div class="ttdoc">Create interface from given surface and insert flat prisms in-between.</div><div class="ttdef"><b>Definition:</b> <a href="PrismInterface_8hpp_source.html#l00023">PrismInterface.hpp:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adecbcd03d7be8763b60a827f434fe726"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a227cd11a1687f2a979a16e5747104990"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a227cd11a1687f2a979a16e5747104990">FractureMechanics::CrackPropagation::mapBitLevel</a></div><div class="ttdeci">std::map&lt; std::string, BitRefLevel &gt; mapBitLevel</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00180">CrackPropagation.hpp:180</a></div></div>
<div class="ttc" id="aMWLS_8hpp_html"><div class="ttname"><a href="MWLS_8hpp.html">MWLS.hpp</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_ad76d17c62d4f9337953222d2092697ab"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#ad76d17c62d4f9337953222d2092697ab">MoFEM::CutMeshInterface::makeFront</a></div><div class="ttdeci">MoFEMErrorCode makeFront(const bool debug=false)</div><div class="ttdoc">Create front from the surface.</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00450">CutMeshInterface.cpp:450</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html_a87ae77f924ed23ba3ce0f0889e34e093"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html#a87ae77f924ed23ba3ce0f0889e34e093">MoFEM::BitRefManager::filterEntitiesNotInDatabase</a></div><div class="ttdeci">MoFEMErrorCode filterEntitiesNotInDatabase(Range &amp;ents) const</div><div class="ttdoc">Get entities not in database.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00908">BitRefManager.cpp:908</a></div></div>
<div class="ttc" id="aMortar_8hpp_html"><div class="ttname"><a href="Mortar_8hpp.html">Mortar.hpp</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a1bbfb030bcbd86228047ec8c352128ba"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a1bbfb030bcbd86228047ec8c352128ba">FractureMechanics::CPMeshCut::cutMesh</a></div><div class="ttdeci">MoFEMErrorCode cutMesh(int &amp;first_bit, const bool debug=false)</div><div class="ttdoc">Ref, cut and trim, merge and do TetGen, if option is on.</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01204">CPMeshCut.cpp:1204</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aac80b6de09e6f065a25a8b2a8f30f9bd"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aac80b6de09e6f065a25a8b2a8f30f9bd">FractureMechanics::CPMeshCut::refineMesh</a></div><div class="ttdeci">MoFEMErrorCode refineMesh(const Range *vol, const bool make_front, const int verb=QUIET, const bool debug=false)</div><div class="ttdoc">Refine mesh close to crack surface and crack front.</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00218">CPMeshCut.cpp:218</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_a80b3d9675ca762af0df6bc7a1ed5cc24"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#a80b3d9675ca762af0df6bc7a1ed5cc24">MoFEM::CutMeshInterface::getFront</a></div><div class="ttdeci">const Range &amp; getFront() const</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8hpp_source.html#l00467">CutMeshInterface.hpp:467</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_adcfbe67054ee9bccd0972e7828760c3f"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#adcfbe67054ee9bccd0972e7828760c3f">FractureMechanics::CPMeshCut::vertexBlockSet</a></div><div class="ttdeci">int vertexBlockSet</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00180">CPMeshCut.hpp:180</a></div></div>
<div class="ttc" id="astructContactSearchKdTree_html"><div class="ttname"><a href="structContactSearchKdTree.html">ContactSearchKdTree</a></div><div class="ttdef"><b>Definition:</b> <a href="ContactSearchKdTree_8hpp_source.html#l00018">ContactSearchKdTree.hpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="anamespacecreate__mesh__links_html_a1b132712b3e44cc2ea2257678b2d4a12"><div class="ttname"><a href="namespacecreate__mesh__links.html#a1b132712b3e44cc2ea2257678b2d4a12">create_mesh_links.dist</a></div><div class="ttdeci">dist</div><div class="ttdef"><b>Definition:</b> <a href="create__mesh__links_8py_source.html#l00063">create_mesh_links.py:63</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespaceMoFEM.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_a08b8bbab5b73482ebe67655c8211e77b"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#a08b8bbab5b73482ebe67655c8211e77b">MoFEM::CutMeshInterface::copySurface</a></div><div class="ttdeci">MoFEMErrorCode copySurface(const Range surface, Tag th=NULL, double *shift=NULL, double *origin=NULL, double *transform=NULL, const std::string save_mesh=&quot;&quot;)</div><div class="ttdoc">copy surface entities</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00048">CutMeshInterface.cpp:48</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a0c8f8b6d829f5bbedc3e31536eb6fce4"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a0c8f8b6d829f5bbedc3e31536eb6fce4">FractureMechanics::CPMeshCut::cutRefineAndSplit</a></div><div class="ttdeci">MoFEMErrorCode cutRefineAndSplit(const int verb=VERBOSE, bool debug=false)</div><div class="ttdoc">Refine, cut, trim, merge and ref front and split.</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02278">CPMeshCut.cpp:2278</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a1f749459397b97eed48150fa01167a2b"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a1f749459397b97eed48150fa01167a2b">FractureMechanics::CPMeshCut::copySurface</a></div><div class="ttdeci">MoFEMErrorCode copySurface(const std::string save_mesh=&quot;&quot;)</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00322">CPMeshCut.cpp:322</a></div></div>
<div class="ttc" id="aBasicFiniteElements_8hpp_html"><div class="ttname"><a href="BasicFiniteElements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a785e26f896311a92e090947a57a965f5"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a785e26f896311a92e090947a57a965f5">FractureMechanics::CPMeshCut::nbRefBeforTrim</a></div><div class="ttdeci">int nbRefBeforTrim</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00199">CPMeshCut.hpp:199</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a60328079c70ac649884b270b60a2187c"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a60328079c70ac649884b270b60a2187c">FractureMechanics::CPMeshCut::crackFrontId</a></div><div class="ttdeci">int crackFrontId</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00208">CPMeshCut.hpp:208</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a50d250b3d989ea7abcba684e97cbd55b"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a50d250b3d989ea7abcba684e97cbd55b">FractureMechanics::CrackPropagation::contactMeshsetFaces</a></div><div class="ttdeci">Range contactMeshsetFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01239">CrackPropagation.hpp:1239</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ad9414d2adc14b121e7f705819054458d"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ad9414d2adc14b121e7f705819054458d">FractureMechanics::CPMeshCut::splitFaces</a></div><div class="ttdeci">MoFEMErrorCode splitFaces(const int verb=1, const bool debug=false)</div><div class="ttdoc">split crack faces</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01622">CPMeshCut.cpp:1622</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea75f611e0673e99085edc1b5ac5343023">MOFEM_IMPOSSIBLE_CASE</a></div><div class="ttdeci">@ MOFEM_IMPOSSIBLE_CASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00035">definitions.h:35</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html">FractureMechanics::CPMeshCut</a></div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00024">CPMeshCut.hpp:24</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a703d0a4dc13004e67d384af219007aaf"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a703d0a4dc13004e67d384af219007aaf">FractureMechanics::CPMeshCut::vertexNodeSet</a></div><div class="ttdeci">int vertexNodeSet</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00181">CPMeshCut.hpp:181</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html_a788c9bc05dc1c1e2967a3764da80e1c1"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html#a788c9bc05dc1c1e2967a3764da80e1c1">MoFEM::BitRefManager::filterEntitiesByRefLevel</a></div><div class="ttdeci">MoFEMErrorCode filterEntitiesByRefLevel(const BitRefLevel bit, const BitRefLevel mask, Range &amp;ents, int verb=QUIET) const</div><div class="ttdoc">filter entities by bit ref level</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00746">BitRefManager.cpp:746</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a315359c2e34aac52f9fa976960b1a46d"><div class="ttname"><a href="namespaceMoFEM.html#a315359c2e34aac52f9fa976960b1a46d">MoFEM::reconstructMultiIndex</a></div><div class="ttdeci">MoFEMErrorCode reconstructMultiIndex(const MI &amp;mi, MO &amp;&amp;mo=Modify_change_nothing())</div><div class="ttdoc">Template used to reconstruct multi-index.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01853">Templates.hpp:1853</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_ada5dc07850715aa99eeec5ccbe219b22"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#ada5dc07850715aa99eeec5ccbe219b22">FractureMechanics::CrackPropagation::contactSearchMultiIndexPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; ContactSearchKdTree::ContactCommonData_multiIndex &gt; contactSearchMultiIndexPtr</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01250">CrackPropagation.hpp:1250</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aae4a494e6840ae724fbe9476aa8537e0"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aae4a494e6840ae724fbe9476aa8537e0">FractureMechanics::CPMeshCut::originalCoords</a></div><div class="ttdeci">std::vector&lt; double &gt; originalCoords</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00210">CPMeshCut.hpp:210</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a5f7f7f5c9c615dffd79e5fd0f207ddf3"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a5f7f7f5c9c615dffd79e5fd0f207ddf3">FractureMechanics::CrackPropagation::mortarContactElements</a></div><div class="ttdeci">Range mortarContactElements</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01245">CrackPropagation.hpp:1245</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aa00fad9f771a0e8338dcaec2e29e724f"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aa00fad9f771a0e8338dcaec2e29e724f">FractureMechanics::CPMeshCut::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div><div class="ttdoc">Get options from command line.</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00085">CPMeshCut.cpp:85</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a93023984d8c5a456c1e70090fda992c9"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a93023984d8c5a456c1e70090fda992c9">FractureMechanics::CPMeshCut::setCutSurfaceFromFile</a></div><div class="ttdeci">MoFEMErrorCode setCutSurfaceFromFile()</div><div class="ttdoc">Set the cut surface from file.</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00301">CPMeshCut.cpp:301</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a41a144d57c8ca97574d6b5714b2be697"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a41a144d57c8ca97574d6b5714b2be697">FractureMechanics::CPMeshCut::insertContactInterface</a></div><div class="ttdeci">MoFEMErrorCode insertContactInterface(const int verb=1, const bool debug=false)</div><div class="ttdoc">insert contact interface</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01873">CPMeshCut.cpp:1873</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga1ca1b58c9fb5abc1be1e62729577daa8"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga1ca1b58c9fb5abc1be1e62729577daa8">MoFEM::MeshsetsManager::getMeshset</a></div><div class="ttdeci">MoFEMErrorCode getMeshset(const int ms_id, const unsigned int cubit_bc_type, EntityHandle &amp;meshset) const</div><div class="ttdoc">get meshset from CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00708">MeshsetsManager.cpp:708</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a26c1a33e8640aaa1467b6b854d0813e3"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a26c1a33e8640aaa1467b6b854d0813e3">FractureMechanics::CrackPropagation::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00106">CrackPropagation.hpp:106</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a5d19b596dfc352e6f25afb67a6be6eeb"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a5d19b596dfc352e6f25afb67a6be6eeb">FractureMechanics::CPMeshCut::getCrackFrontId</a></div><div class="ttdeci">int getCrackFrontId() const</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00169">CPMeshCut.hpp:169</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_gafa1c3eb219cdb812ccdb6bad1a7a1454"><div class="ttname"><a href="group__mofem__log__manager.html#gafa1c3eb219cdb812ccdb6bad1a7a1454">MOFEM_LOG_FUNCTION</a></div><div class="ttdeci">#define MOFEM_LOG_FUNCTION()</div><div class="ttdoc">Set scope.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00325">LogManager.hpp:325</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html_a7f731867b68b721d54096ceced3b9947"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html#a7f731867b68b721d54096ceced3b9947">MoFEM::MeshRefinement::refineTets</a></div><div class="ttdeci">MoFEMErrorCode refineTets(const EntityHandle meshset, const BitRefLevel &amp;bit, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">refine TET in the meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8cpp_source.html#l00197">MeshRefinement.cpp:197</a></div></div>
<div class="ttc" id="aCPMeshCut_8hpp_html"><div class="ttname"><a href="CPMeshCut_8hpp.html">CPMeshCut.hpp</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca7b4c0e5ae1385e1224a6e59abf47ecc0">NODESET</a></div><div class="ttdeci">@ NODESET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00159">definitions.h:159</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a6ffd47b9e0afb9f78ad9e88ca71e65a7"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a6ffd47b9e0afb9f78ad9e88ca71e65a7">MoFEM::Exceptions::rval</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; moab::ErrorCode &gt; rval</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00074">Exceptions.hpp:74</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a></div><div class="ttdeci">@ VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00222">definitions.h:222</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_ad1ef5dac44a93d2934fabd08e35c72a9"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#ad1ef5dac44a93d2934fabd08e35c72a9">MoFEM::CutMeshInterface::cutTrimAndMerge</a></div><div class="ttdeci">MoFEMErrorCode cutTrimAndMerge(int &amp;first_bit, const int fraction_level, Tag th, const double tol_geometry, const double tol_cut_close, const double tol_trim_close, Range &amp;fixed_edges, Range &amp;corner_nodes, const bool update_meshsets=false, const bool debug=false)</div><div class="ttdoc">Cut, trim and merge.</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00379">CutMeshInterface.cpp:379</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ac675bad4a5faadf2211e0742feb1a02f"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ac675bad4a5faadf2211e0742feb1a02f">FractureMechanics::CPMeshCut::tolCutClose</a></div><div class="ttdeci">double tolCutClose</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00196">CPMeshCut.hpp:196</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga57f6316b2f1061a314f40eb794d733ab"><div class="ttname"><a href="group__mofem__bit__ref.html#ga57f6316b2f1061a314f40eb794d733ab">MoFEM::BitRefManager::setBitRefLevel</a></div><div class="ttdeci">MoFEMErrorCode setBitRefLevel(const Range &amp;ents, const BitRefLevel bit, const bool only_tets=true, int verb=0, Range *adj_ents_ptr=nullptr) const</div><div class="ttdoc">add entities to database and set bit ref level</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00279">BitRefManager.cpp:279</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a557a1b16f8c7516726e4a1e85cc8ff17"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a557a1b16f8c7516726e4a1e85cc8ff17">FractureMechanics::CPMeshCut::setMeshOrgCoords</a></div><div class="ttdeci">MoFEMErrorCode setMeshOrgCoords()</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02405">CPMeshCut.cpp:2405</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a4649af251914e6e03223ccb8a01827d2"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a4649af251914e6e03223ccb8a01827d2">FractureMechanics::CPMeshCut::contactPrismsBlockSetId</a></div><div class="ttdeci">int contactPrismsBlockSetId</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00183">CPMeshCut.hpp:183</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_aa4f64c0160ed1545739d6abaca7d0d0e"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#aa4f64c0160ed1545739d6abaca7d0d0e">FractureMechanics::CrackPropagation::contactMasterFaces</a></div><div class="ttdeci">Range contactMasterFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01242">CrackPropagation.hpp:1242</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_ae17cb59577233873a12d990b46c49dd2"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#ae17cb59577233873a12d990b46c49dd2">MoFEM::CutMeshInterface::getMergedSurfaces</a></div><div class="ttdeci">const Range &amp; getMergedSurfaces() const</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8hpp_source.html#l00483">CutMeshInterface.hpp:483</a></div></div>
<div class="ttc" id="aprism__elements__from__surface_8cpp_html_a9eb248cd425bb908c67fa311945029cc"><div class="ttname"><a href="prism__elements__from__surface_8cpp.html#a9eb248cd425bb908c67fa311945029cc">delta</a></div><div class="ttdeci">static constexpr double delta</div><div class="ttdef"><b>Definition:</b> <a href="prism__elements__from__surface_8cpp_source.html#l00018">prism_elements_from_surface.cpp:18</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a00ca24984a29be87bd99504af7f6ebee"><div class="ttname"><a href="namespaceMoFEM.html#a00ca24984a29be87bd99504af7f6ebee">MoFEM::getVectorAdaptor</a></div><div class="ttdeci">auto getVectorAdaptor(T1 ptr, const size_t n)</div><div class="ttdoc">Get Vector adaptor.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l00031">Templates.hpp:31</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gab0614ec3ab18ec96717149423946ced7"><div class="ttname"><a href="group__mofem__meshset__mng.html#gab0614ec3ab18ec96717149423946ced7">MoFEM::MeshsetsManager::getEntitiesByDimension</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByDimension(const int ms_id, const unsigned int cubit_bc_type, const int dimension, Range &amp;entities, const bool recursive=true) const</div><div class="ttdoc">get entities from CUBIT/meshset of a particular entity dimension</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00669">MeshsetsManager.cpp:669</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshRefinement_html"><div class="ttname"><a href="structMoFEM_1_1MeshRefinement.html">MoFEM::MeshRefinement</a></div><div class="ttdoc">Mesh refinement interface.</div><div class="ttdef"><b>Definition:</b> <a href="MeshRefinement_8hpp_source.html#l00026">MeshRefinement.hpp:26</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a5edebe082848c57745b69722a9d173bc"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a5edebe082848c57745b69722a9d173bc">FractureMechanics::CPMeshCut::setFixEdgesAndCorners</a></div><div class="ttdeci">MoFEMErrorCode setFixEdgesAndCorners(const BitRefLevel bit)</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01173">CPMeshCut.cpp:1173</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_ad82f7651bfa9bdd97923bafe67507970"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#ad82f7651bfa9bdd97923bafe67507970">FractureMechanics::CrackPropagation::contactBothSidesSlaveFaces</a></div><div class="ttdeci">Range contactBothSidesSlaveFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01252">CrackPropagation.hpp:1252</a></div></div>
<div class="ttc" id="aHooke_8hpp_html"><div class="ttname"><a href="Hooke_8hpp.html">Hooke.hpp</a></div><div class="ttdoc">Implementation of linear elastic material.</div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a1e38d7c612661e0476cd6142c5e3a333"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a1e38d7c612661e0476cd6142c5e3a333">FractureMechanics::CPMeshCut::removePathologicalFrontTris</a></div><div class="ttdeci">PetscBool removePathologicalFrontTris</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00202">CPMeshCut.hpp:202</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition:</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aa4258ec6b03d917fdbb22c404a138dde"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aa4258ec6b03d917fdbb22c404a138dde">FractureMechanics::CPMeshCut::cP</a></div><div class="ttdeci">CrackPropagation &amp; cP</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00035">CPMeshCut.hpp:35</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga9fbf1b71bc44b8a83c7f69f1cfba8125"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga9fbf1b71bc44b8a83c7f69f1cfba8125">MoFEM::MeshsetsManager::addMeshset</a></div><div class="ttdeci">MoFEMErrorCode addMeshset(const CubitBCType cubit_bc_type, const int ms_id, const std::string name=&quot;&quot;)</div><div class="ttdoc">add cubit meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00385">MeshsetsManager.cpp:385</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aec25a0b55a958cabc641d2ea1b9cda96"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aec25a0b55a958cabc641d2ea1b9cda96">FractureMechanics::CPMeshCut::crackSurfaceId</a></div><div class="ttdeci">int crackSurfaceId</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00207">CPMeshCut.hpp:207</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PrismInterface_html_ada01f8c0c3d86a8ae0e5cc2abdf59ceb"><div class="ttname"><a href="structMoFEM_1_1PrismInterface.html#ada01f8c0c3d86a8ae0e5cc2abdf59ceb">MoFEM::PrismInterface::splitSides</a></div><div class="ttdeci">MoFEMErrorCode splitSides(const EntityHandle meshset, const BitRefLevel &amp;bit, const int msId, const CubitBCType cubit_bc_type, const bool add_interface_entities, const bool recursive=false, int verb=QUIET)</div><div class="ttdoc">Split nodes and other entities of tetrahedra on both sides of the interface and insert flat prisms in...</div><div class="ttdef"><b>Definition:</b> <a href="PrismInterface_8cpp_source.html#l00519">PrismInterface.cpp:519</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a0016012d2fdfbaa3dea1c7de67159175"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a0016012d2fdfbaa3dea1c7de67159175">FractureMechanics::CPMeshCut::findBodySkin</a></div><div class="ttdeci">MoFEMErrorCode findBodySkin(const BitRefLevel bit, const int verb=1, const bool debug=false, std::string file_name=&quot;out_body_skin.vtk&quot;)</div><div class="ttdoc">find body skin</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01383">CPMeshCut.cpp:1383</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a6f5533e767c5bbc98475098a32ae331d"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a6f5533e767c5bbc98475098a32ae331d">FractureMechanics::CrackPropagation::contactBothSidesMasterFaces</a></div><div class="ttdeci">Range contactBothSidesMasterFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01251">CrackPropagation.hpp:1251</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a5637028ffe9c96152a02c4865244d379"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a5637028ffe9c96152a02c4865244d379">FractureMechanics::CPMeshCut::cuttingSurfaceSidesetId</a></div><div class="ttdeci">int cuttingSurfaceSidesetId</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00205">CPMeshCut.hpp:205</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga1e0b681fb93ac73542a68a0cf875cef3"><div class="ttname"><a href="group__mofem__bit__ref.html#ga1e0b681fb93ac73542a68a0cf875cef3">MoFEM::BitRefManager::updateMeshsetByEntitiesChildren</a></div><div class="ttdeci">MoFEMErrorCode updateMeshsetByEntitiesChildren(const EntityHandle parent, const BitRefLevel &amp;parent_bit, const BitRefLevel &amp;parent_mask, const BitRefLevel &amp;child_bit, const BitRefLevel &amp;child_mask, const EntityHandle child, EntityType child_type, const bool recursive=false, int verb=0)</div><div class="ttdoc">Get child entities form meshset containing parent entities.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l01029">BitRefManager.cpp:1029</a></div></div>
<div class="ttc" id="anamespacesurface_html_ac5b6e387c2c24e86299c80489d6838c0"><div class="ttname"><a href="namespacesurface.html#ac5b6e387c2c24e86299c80489d6838c0">surface.surface</a></div><div class="ttdeci">def surface(x, y, z, eta)</div><div class="ttdef"><b>Definition:</b> <a href="surface_8py_source.html#l00003">surface.py:3</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_aacc6ac8832948e067b7b7dadf50c53d1"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#aacc6ac8832948e067b7b7dadf50c53d1">MoFEM::CutMeshInterface::removePathologicalFrontTris</a></div><div class="ttdeci">MoFEMErrorCode removePathologicalFrontTris(const BitRefLevel split_bit, Range &amp;ents)</div><div class="ttdoc">Remove pathological elements on surface internal front.</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l02235">CutMeshInterface.cpp:2235</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_ab5e9945e34978dce73ab7556f12fff63"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#ab5e9945e34978dce73ab7556f12fff63">FractureMechanics::CrackPropagation::doCutMesh</a></div><div class="ttdeci">PetscBool doCutMesh</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01327">CrackPropagation.hpp:1327</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga486c46f5509f4e3e1d2f92b474ca781a"><div class="ttname"><a href="group__mofem__bit__ref.html#ga486c46f5509f4e3e1d2f92b474ca781a">MoFEM::BitRefManager::addBitRefLevel</a></div><div class="ttdeci">MoFEMErrorCode addBitRefLevel(const Range &amp;ents, const BitRefLevel &amp;bit, int verb=QUIET) const</div><div class="ttdoc">add bit ref level to ref entity</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00554">BitRefManager.cpp:554</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_aad2bf7c3c4320b94832923df44d30e45"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#aad2bf7c3c4320b94832923df44d30e45">MoFEM::CutMeshInterface::setConstrainSurface</a></div><div class="ttdeci">MoFEMErrorCode setConstrainSurface(const Range surf)</div><div class="ttdoc">Set the constrain surface object.</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00114">CutMeshInterface.cpp:114</a></div></div>
<div class="ttc" id="astructContactSearchKdTree_1_1Prism__tag_html"><div class="ttname"><a href="structContactSearchKdTree_1_1Prism__tag.html">ContactSearchKdTree::Prism_tag</a></div><div class="ttdef"><b>Definition:</b> <a href="ContactSearchKdTree_8hpp_source.html#l00044">ContactSearchKdTree.hpp:44</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_af24921bfa7f0d8a39f9889bd868a5b75"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#af24921bfa7f0d8a39f9889bd868a5b75">FractureMechanics::CrackPropagation::crackFront</a></div><div class="ttdeci">Range crackFront</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01163">CrackPropagation.hpp:1163</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_af340f907630e7bea7327c538dde8fc7c"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#af340f907630e7bea7327c538dde8fc7c">FractureMechanics::CrackPropagation::ignoreContact</a></div><div class="ttdeci">PetscBool ignoreContact</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01233">CrackPropagation.hpp:1233</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a90e33252d4b7e57d9c2a7596db8ab906"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a90e33252d4b7e57d9c2a7596db8ab906">FractureMechanics::CPMeshCut::findCrack</a></div><div class="ttdeci">MoFEMErrorCode findCrack(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get crack front</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01447">CPMeshCut.cpp:1447</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_aedb15b073b44bdf2cd4d20fbc19a8060"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#aedb15b073b44bdf2cd4d20fbc19a8060">MoFEM::CutMeshInterface::snapSurfaceToEdges</a></div><div class="ttdeci">MoFEMErrorCode snapSurfaceToEdges(const Range surface_edges, const Range fixed_edges, const double rel_tol, const double abs_tol, Tag th=nullptr, const bool debug=false)</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00152">CutMeshInterface.cpp:152</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a71d0f1c883305b8e5376c4406342f57f"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a71d0f1c883305b8e5376c4406342f57f">FractureMechanics::CPMeshCut::debugCut</a></div><div class="ttdeci">PetscBool debugCut</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00201">CPMeshCut.hpp:201</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a6ceba1bae8209220e1d2381ca2f2895e"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a6ceba1bae8209220e1d2381ca2f2895e">FractureMechanics::CPMeshCut::meshsetMngPtr</a></div><div class="ttdeci">MeshsetsManager * meshsetMngPtr</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00187">CPMeshCut.hpp:187</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a899008482c9bcbfdd18d65af79204765"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a899008482c9bcbfdd18d65af79204765">FractureMechanics::CrackPropagation::constrainedInterface</a></div><div class="ttdeci">Range constrainedInterface</div><div class="ttdoc">Range of faces on the constrained interface.</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01301">CrackPropagation.hpp:1301</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_a42896dd46513db84c3a4c8e49af197e6"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#a42896dd46513db84c3a4c8e49af197e6">MoFEM::CoreInterface::delete_ents_by_bit_ref</a></div><div class="ttdeci">virtual MoFEMErrorCode delete_ents_by_bit_ref(const BitRefLevel bit, const BitRefLevel mask, const bool remove_parent=false, int verb=DEFAULT_VERBOSITY, MoFEMTypes mf=MF_ZERO)=0</div><div class="ttdoc">delete entities form mofem and moab database</div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_a5691afdb9be3879de243aeea26c934c9"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#a5691afdb9be3879de243aeea26c934c9">MoFEM::CutMeshInterface::setSurface</a></div><div class="ttdeci">MoFEMErrorCode setSurface(const Range surface)</div><div class="ttdoc">set surface entities</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00042">CutMeshInterface.cpp:42</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga202c2d0258d78f4c0d60ecac64bf2252"><div class="ttname"><a href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a></div><div class="ttdeci">#define MOFEM_LOG_TAG(channel, tag)</div><div class="ttdoc">Tag channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00339">LogManager.hpp:339</a></div></div>
<div class="ttc" id="aCrackFrontElement_8hpp_html"><div class="ttname"><a href="CrackFrontElement_8hpp.html">CrackFrontElement.hpp</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a5dfc306af1addb8e8a14a1428e966654"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a5dfc306af1addb8e8a14a1428e966654">MoFEM::Types::VectorAdaptor</a></div><div class="ttdeci">VectorShallowArrayAdaptor&lt; double &gt; VectorAdaptor</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00115">Types.hpp:115</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition:</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_acc83f38b27d6f471473ad4f7abdeb471"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#acc83f38b27d6f471473ad4f7abdeb471">FractureMechanics::CPMeshCut::nbRefBeforCut</a></div><div class="ttdeci">int nbRefBeforCut</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00198">CPMeshCut.hpp:198</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a2bc35f903e155d4912ec603711c86f24"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a2bc35f903e155d4912ec603711c86f24">FractureMechanics::CPMeshCut::refineAndSplit</a></div><div class="ttdeci">MoFEMErrorCode refineAndSplit(const int verb=1, const bool debug=false)</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02168">CPMeshCut.cpp:2168</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aa73d6d4d08509b996a63604173694d8a"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aa73d6d4d08509b996a63604173694d8a">FractureMechanics::CPMeshCut::getSkinOfTheBodyId</a></div><div class="ttdeci">int getSkinOfTheBodyId() const</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00167">CPMeshCut.hpp:167</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a6b500d8c0d533494caf9b972bc3734bf"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a6b500d8c0d533494caf9b972bc3734bf">FractureMechanics::CrackPropagation::oneSideCrackFaces</a></div><div class="ttdeci">Range oneSideCrackFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01161">CrackPropagation.hpp:1161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2ea2ed69dd8a1568d1e9b634b9fb37df873"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2ea2ed69dd8a1568d1e9b634b9fb37df873">MOFEM_NOT_FOUND</a></div><div class="ttdeci">@ MOFEM_NOT_FOUND</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00033">definitions.h:33</a></div></div>
<div class="ttc" id="astructContactSearchKdTree_html_a88532ad59785dacf8a672f95b46d02b5"><div class="ttname"><a href="structContactSearchKdTree.html#a88532ad59785dacf8a672f95b46d02b5">ContactSearchKdTree::contactSearchAlgorithm</a></div><div class="ttdeci">PetscErrorCode contactSearchAlgorithm(Range &amp;range_surf_master, Range &amp;range_surf_slave, boost::shared_ptr&lt; ContactCommonData_multiIndex &gt; contact_commondata_multi_index, Range &amp;range_slave_master_prisms)</div><div class="ttdef"><b>Definition:</b> <a href="ContactSearchKdTree_8hpp_source.html#l00114">ContactSearchKdTree.hpp:114</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a58d5922a7275bd9cc350d7678de4c909"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a58d5922a7275bd9cc350d7678de4c909">FractureMechanics::CPMeshCut::getMeshOrgCoords</a></div><div class="ttdeci">MoFEMErrorCode getMeshOrgCoords()</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02433">CPMeshCut.cpp:2433</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_a67d0cdac80f09af5b4d821c671600ae9"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#a67d0cdac80f09af5b4d821c671600ae9">MoFEM::CutMeshInterface::buildTree</a></div><div class="ttdeci">MoFEMErrorCode buildTree()</div><div class="ttdoc">build tree</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00215">CutMeshInterface.cpp:215</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ae3e244a0c2d2cfb8989d1e41cddae404"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ae3e244a0c2d2cfb8989d1e41cddae404">FractureMechanics::CPMeshCut::cutMeshPtr</a></div><div class="ttdeci">CutMeshInterface * cutMeshPtr</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00185">CPMeshCut.hpp:185</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a077eaab9fb4261bc6634d9fc6ed310c3"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a077eaab9fb4261bc6634d9fc6ed310c3">FractureMechanics::CPMeshCut::crackedBodyBlockSetId</a></div><div class="ttdeci">int crackedBodyBlockSetId</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00182">CPMeshCut.hpp:182</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ab0c50ac037fc28c233cde4facd580d52"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ab0c50ac037fc28c233cde4facd580d52">FractureMechanics::CPMeshCut::tolTrimClose</a></div><div class="ttdeci">double tolTrimClose</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00197">CPMeshCut.hpp:197</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a92c1aa239a4f20103ba309452c530f74"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a92c1aa239a4f20103ba309452c530f74">FractureMechanics::CrackPropagation::bodySkin</a></div><div class="ttdeci">Range bodySkin</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01159">CrackPropagation.hpp:1159</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ad5c8916b0ba5234628e7681985590014"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ad5c8916b0ba5234628e7681985590014">FractureMechanics::CPMeshCut::skinOfTheBodyId</a></div><div class="ttdeci">int skinOfTheBodyId</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00206">CPMeshCut.hpp:206</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1GriffithForceElement_1_1SaveGriffithForceOnTags_html"><div class="ttname"><a href="structFractureMechanics_1_1GriffithForceElement_1_1SaveGriffithForceOnTags.html">FractureMechanics::GriffithForceElement::SaveGriffithForceOnTags</a></div><div class="ttdef"><b>Definition:</b> <a href="GriffithForceElement_8hpp_source.html#l00532">GriffithForceElement.hpp:532</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html_a41119eae52ef09ee41400233e1da8d78"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html#a41119eae52ef09ee41400233e1da8d78">MoFEM::MeshsetsManager::deleteMeshset</a></div><div class="ttdeci">MoFEMErrorCode deleteMeshset(const CubitBCType cubit_bc_type, const int ms_id, const MoFEMTypes bh=MF_EXIST)</div><div class="ttdoc">delete cubit meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00553">MeshsetsManager.cpp:553</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html">MoFEM::UnknownInterface</a></div><div class="ttdoc">base class for all interface classes</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00034">UnknownInterface.hpp:34</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_aeead6e0c0f5b67f3aee1062f4668248e"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#aeead6e0c0f5b67f3aee1062f4668248e">FractureMechanics::CrackPropagation::otherSideConstrains</a></div><div class="ttdeci">PetscBool otherSideConstrains</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00123">CrackPropagation.hpp:123</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_ab6024a39e3da574d0222508ec9098be3"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#ab6024a39e3da574d0222508ec9098be3">FractureMechanics::CrackPropagation::contactSlaveFaces</a></div><div class="ttdeci">Range contactSlaveFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01243">CrackPropagation.hpp:1243</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a702b24eb98806e8da55b7094d1fca832"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a702b24eb98806e8da55b7094d1fca832">FractureMechanics::CPMeshCut::fRont</a></div><div class="ttdeci">Range fRont</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00191">CPMeshCut.hpp:191</a></div></div>
<div class="ttc" id="anamespaceFTensor_html_a47f888f031614523ed436d61044e757c"><div class="ttname"><a href="namespaceFTensor.html#a47f888f031614523ed436d61044e757c">FTensor::dd</a></div><div class="ttdeci">const Tensor2_symmetric_Expr&lt; const ddTensor0&lt; T, Dim, i, j &gt;, typename promote&lt; T, double &gt;::V, Dim, i, j &gt; dd(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index1, const Index&lt; j, Dim &gt; index2, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition:</b> <a href="ddTensor0_8hpp_source.html#l00033">ddTensor0.hpp:33</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ab5697439e436dae4f87c36567f05107a"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ab5697439e436dae4f87c36567f05107a">FractureMechanics::CPMeshCut::cutSurfMeshName</a></div><div class="ttdeci">std::string cutSurfMeshName</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00211">CPMeshCut.hpp:211</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ad4e135789ce6279536022842795a9305"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ad4e135789ce6279536022842795a9305">FractureMechanics::CPMeshCut::getFrontEdgesAndElements</a></div><div class="ttdeci">MoFEMErrorCode getFrontEdgesAndElements(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get crack front edges and finite elements</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02348">CPMeshCut.cpp:2348</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a6ab2e568fe41e5c93bc6897a3b1c7928"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a6ab2e568fe41e5c93bc6897a3b1c7928">FractureMechanics::CrackPropagation::otherSideCrackFaces</a></div><div class="ttdeci">Range otherSideCrackFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01162">CrackPropagation.hpp:1162</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaff36ed0367e6b0a57541419546aa1323"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaff36ed0367e6b0a57541419546aa1323">_IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_SET_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet having a particular BC meshset in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00071">MeshsetsManager.hpp:71</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a0de9d9a2e911031c8e9086441450a89d"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a0de9d9a2e911031c8e9086441450a89d">FractureMechanics::CPMeshCut::findContactFromPrisms</a></div><div class="ttdeci">MoFEMErrorCode findContactFromPrisms(const BitRefLevel bit, const int verb=1, const bool debug=false)</div><div class="ttdoc">get contact elements</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02000">CPMeshCut.cpp:2000</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PrismInterface_html_a647ba4accc02b9b9c863af097045bb42"><div class="ttname"><a href="structMoFEM_1_1PrismInterface.html#a647ba4accc02b9b9c863af097045bb42">MoFEM::PrismInterface::getSides</a></div><div class="ttdeci">MoFEMErrorCode getSides(const int msId, const CubitBCType cubit_bc_type, const BitRefLevel mesh_bit_level, const bool recursive, int verb=QUIET)</div><div class="ttdoc">Store tetrahedra from each side of the interface separately in two child meshsets of the parent meshs...</div><div class="ttdef"><b>Definition:</b> <a href="PrismInterface_8cpp_source.html#l00056">PrismInterface.cpp:56</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a8abf9b06d3a7bc6de647451bc0822d51"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a8abf9b06d3a7bc6de647451bc0822d51">FractureMechanics::CPMeshCut::bitRefPtr</a></div><div class="ttdeci">BitRefManager * bitRefPtr</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00186">CPMeshCut.hpp:186</a></div></div>
<div class="ttc" id="astructContactSearchKdTree_html_a8eeb01dfbd0d967160fb1c8f8f0bfe76"><div class="ttname"><a href="structContactSearchKdTree.html#a8eeb01dfbd0d967160fb1c8f8f0bfe76">ContactSearchKdTree::buildTree</a></div><div class="ttdeci">MoFEMErrorCode buildTree(Range &amp;range_surf_master)</div><div class="ttdef"><b>Definition:</b> <a href="ContactSearchKdTree_8hpp_source.html#l00028">ContactSearchKdTree.hpp:28</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_ae6cdd41a72a83c1e08ff57742b85da95"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#ae6cdd41a72a83c1e08ff57742b85da95">MoFEM::CutMeshInterface::refineMesh</a></div><div class="ttdeci">MoFEMErrorCode refineMesh(const int init_bit_level, const int surf_levels, const int front_levels, Range *fixed_edges=nullptr, int verb=QUIET, const bool debug=false)</div><div class="ttdoc">Refine and set level sets.</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8cpp_source.html#l00809">CutMeshInterface.cpp:809</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a3b43531d53059927f420c79cf954561a"><div class="ttname"><a href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a></div><div class="ttdeci">#define BITREFLEVEL_SIZE</div><div class="ttdoc">max number of refinements</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00232">definitions.h:232</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html_a5d2eaccfec5512b7e5ef17fbe1e987b5"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html#a5d2eaccfec5512b7e5ef17fbe1e987b5">MoFEM::BitRefManager::writeBitLevelByType</a></div><div class="ttdeci">MoFEMErrorCode writeBitLevelByType(const BitRefLevel bit, const BitRefLevel mask, const EntityType type, const char *file_name, const char *file_type, const char *options, const bool check_for_empty=true) const</div><div class="ttdoc">Write bit ref level to file.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00682">BitRefManager.cpp:682</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html">FractureMechanics::CrackPropagation</a></div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00077">CrackPropagation.hpp:77</a></div></div>
<div class="ttc" id="astructMoFEM_1_1RefEntity__change__parent_html"><div class="ttname"><a href="structMoFEM_1_1RefEntity__change__parent.html">MoFEM::RefEntity_change_parent</a></div><div class="ttdoc">change parent</div><div class="ttdef"><b>Definition:</b> <a href="RefEntsMultiIndices_8hpp_source.html#l00812">RefEntsMultiIndices.hpp:812</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_gab328f27a131d4ae6e89a6eebaa9f9cc9"><div class="ttname"><a href="group__mofem__access.html#gab328f27a131d4ae6e89a6eebaa9f9cc9">MoFEM::CoreInterface::get_ref_ents</a></div><div class="ttdeci">virtual const RefEntity_multiIndex * get_ref_ents() const =0</div><div class="ttdoc">Get the ref ents object.</div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a6014f2074d9b8ec7320e7a6809855ab4"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a6014f2074d9b8ec7320e7a6809855ab4">FractureMechanics::CPMeshCut::fixedEdges</a></div><div class="ttdeci">Range fixedEdges</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00189">CPMeshCut.hpp:189</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a4e27e82eaf63e387dd653941d6245b49"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a4e27e82eaf63e387dd653941d6245b49">MoFEM::Exceptions::ierr</a></div><div class="ttdeci">static MoFEMErrorCodeGeneric&lt; PetscErrorCode &gt; ierr</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00076">Exceptions.hpp:76</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a001491969a5bbeea6147ce9d8ce0416b"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a001491969a5bbeea6147ce9d8ce0416b">FractureMechanics::CPMeshCut::getCrackSurfaceId</a></div><div class="ttdeci">int getCrackSurfaceId() const</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00168">CPMeshCut.hpp:168</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a65aee45b2a3a458fd753a730a81509bb"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a65aee45b2a3a458fd753a730a81509bb">FractureMechanics::CrackPropagation::isPartitioned</a></div><div class="ttdeci">PetscBool isPartitioned</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00118">CrackPropagation.hpp:118</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="aComplexConstArea_8hpp_html"><div class="ttname"><a href="ComplexConstArea_8hpp.html">ComplexConstArea.hpp</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a2496119aca48db18ce9f7b07361b6918"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a2496119aca48db18ce9f7b07361b6918">FractureMechanics::CrackPropagation::mortarContactMasterFaces</a></div><div class="ttdeci">Range mortarContactMasterFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01246">CrackPropagation.hpp:1246</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astructMortarContactStructures_html_a02e23615d8b38cf6805185e1c306025e"><div class="ttname"><a href="structMortarContactStructures.html#a02e23615d8b38cf6805185e1c306025e">MortarContactStructures::findContactSurfacePairs</a></div><div class="ttdeci">static MoFEMErrorCode findContactSurfacePairs(MoFEM::Interface &amp;m_field, std::vector&lt; std::pair&lt; Range, Range &gt;&gt; &amp;contact_surface_pairs)</div><div class="ttdef"><b>Definition:</b> <a href="MakeStructures_8hpp_source.html#l00043">MakeStructures.hpp:43</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ac03fb84b9a137a9a8572682605040928"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ac03fb84b9a137a9a8572682605040928">FractureMechanics::CPMeshCut::addMortarContactPrisms</a></div><div class="ttdeci">MoFEMErrorCode addMortarContactPrisms(const int verb=1, const bool debug=false)</div><div class="ttdoc">insert contact interface</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l01749">CPMeshCut.cpp:1749</a></div></div>
<div class="ttc" id="anamespacesdf__hertz__2d__axisymm__plane_html_a8204f26163e5d184298bc6fa855b88ea"><div class="ttname"><a href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">sdf_hertz_2d_axisymm_plane.d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition:</b> <a href="sdf__hertz__2d__axisymm__plane_8py_source.html#l00004">sdf_hertz_2d_axisymm_plane.py:4</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a09cc55b947e434358857d740bdd1c99d"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a09cc55b947e434358857d740bdd1c99d">FractureMechanics::CPMeshCut::edgesBlockSetFlg</a></div><div class="ttdeci">PetscBool edgesBlockSetFlg</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00178">CPMeshCut.hpp:178</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_ac1d820a203fd9a7f34f3a3257b2d38b7"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#ac1d820a203fd9a7f34f3a3257b2d38b7">MoFEM::Types::MatrixDouble3by3</a></div><div class="ttdeci">MatrixBoundedArray&lt; double, 9 &gt; MatrixDouble3by3</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00105">Types.hpp:105</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition:</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa7fc3e87cd6f5fcd5770d87260ea8c1a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa7fc3e87cd6f5fcd5770d87260ea8c1a">_IT_CUBITMESHSETS_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_FOR_LOOP_(MESHSET_MANAGER, IT)</div><div class="ttdoc">Iterator that loops over all the Cubit MeshSets in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00034">MeshsetsManager.hpp:34</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="aCrackPropagation_8hpp_html"><div class="ttname"><a href="CrackPropagation_8hpp.html">CrackPropagation.hpp</a></div><div class="ttdoc">Main class for crack propagation.</div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ae0315c5240da22b778d5dbed90e6d01a"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ae0315c5240da22b778d5dbed90e6d01a">FractureMechanics::CPMeshCut::setVolume</a></div><div class="ttdeci">MoFEMErrorCode setVolume(const BitRefLevel &amp;bit)</div><div class="ttdoc">Set cutting volume from bit ref level.</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l00209">CPMeshCut.cpp:209</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_aebebb7a3a5d13b03cdef07c3d9528d47"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#aebebb7a3a5d13b03cdef07c3d9528d47">FractureMechanics::CrackPropagation::contactElements</a></div><div class="ttdeci">Range contactElements</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01241">CrackPropagation.hpp:1241</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0786c7c3727f612bdcc32b91008754fa">MF_NOT_THROW</a></div><div class="ttdeci">@ MF_NOT_THROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00114">definitions.h:114</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_af6b25533cc1fdfb87bc95f4f23db8378"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#af6b25533cc1fdfb87bc95f4f23db8378">FractureMechanics::CrackPropagation::crackFrontNodes</a></div><div class="ttdeci">Range crackFrontNodes</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01164">CrackPropagation.hpp:1164</a></div></div>
<div class="ttc" id="aNeoHookean_8hpp_html"><div class="ttname"><a href="NeoHookean_8hpp.html">NeoHookean.hpp</a></div><div class="ttdoc">Implementation of Neo-Hookean elastic material.</div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html_aa269940e9fc185fb230e2b34f62641d8"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html#aa269940e9fc185fb230e2b34f62641d8">MoFEM::BitRefManager::writeEntitiesAllBitLevelsByType</a></div><div class="ttdeci">MoFEMErrorCode writeEntitiesAllBitLevelsByType(const BitRefLevel mask, const EntityType type, const char *file_name, const char *file_type, const char *options)</div><div class="ttdoc">Write all entities by bit levels and type.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00722">BitRefManager.cpp:722</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a2d0efd2c622ed086c6a111f2f887c97a"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a2d0efd2c622ed086c6a111f2f887c97a">FractureMechanics::CrackPropagation::crackFrontNodesEdges</a></div><div class="ttdeci">Range crackFrontNodesEdges</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01165">CrackPropagation.hpp:1165</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_gaa84c211844221f1df66c2ab032fc5b7d"><div class="ttname"><a href="group__mofem__bit__ref.html#gaa84c211844221f1df66c2ab032fc5b7d">MoFEM::BitRefManager::getEntitiesByTypeAndRefLevel</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByTypeAndRefLevel(const BitRefLevel bit, const BitRefLevel mask, const EntityType type, const EntityHandle meshset, int verb=0) const</div><div class="ttdoc">add all ents from ref level given by bit to meshset</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00734">BitRefManager.cpp:734</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga59a61820bca209651d9a1886848ebc25"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">MoFEM::MeshsetsManager::checkMeshset</a></div><div class="ttdeci">bool checkMeshset(const int ms_id, const CubitBCType cubit_bc_type) const</div><div class="ttdoc">check for CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00360">MeshsetsManager.cpp:360</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_abc0e9a6b267f4059a2ba4c8eb41a2db8"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#abc0e9a6b267f4059a2ba4c8eb41a2db8">FractureMechanics::CPMeshCut::fractionLevel</a></div><div class="ttdeci">int fractionLevel</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00194">CPMeshCut.hpp:194</a></div></div>
<div class="ttc" id="aGriffithForceElement_8hpp_html"><div class="ttname"><a href="GriffithForceElement_8hpp.html">GriffithForceElement.hpp</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BitRefManager_html_a1646c70292128dbf98b8dca46d7ef10e"><div class="ttname"><a href="structMoFEM_1_1BitRefManager.html#a1646c70292128dbf98b8dca46d7ef10e">MoFEM::BitRefManager::getAllEntitiesNotInDatabase</a></div><div class="ttdeci">MoFEMErrorCode getAllEntitiesNotInDatabase(Range &amp;ents) const</div><div class="ttdoc">Get all entities not in database.</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00898">BitRefManager.cpp:898</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_ad6905b29523af39338c36a72819105aa"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#ad6905b29523af39338c36a72819105aa">FractureMechanics::CPMeshCut::sUrface</a></div><div class="ttdeci">Range sUrface</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00192">CPMeshCut.hpp:192</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a031605821bd53219746550d0c0cc55b3"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a031605821bd53219746550d0c0cc55b3">FractureMechanics::CPMeshCut::edgesBlockSet</a></div><div class="ttdeci">int edgesBlockSet</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00179">CPMeshCut.hpp:179</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00496">definitions.h:496</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_aa928c18e5413b3b03461c589f076833c"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#aa928c18e5413b3b03461c589f076833c">FractureMechanics::CPMeshCut::tolCut</a></div><div class="ttdeci">double tolCut</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8hpp_source.html#l00195">CPMeshCut.hpp:195</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a2c41e0bae191cf557046c75f7f69fc29"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a2c41e0bae191cf557046c75f7f69fc29">FractureMechanics::CrackPropagation::mortarContactSlaveFaces</a></div><div class="ttdeci">Range mortarContactSlaveFaces</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l01247">CrackPropagation.hpp:1247</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca05ac9ca266f9e1731e2832c50fc14849">VERY_VERBOSE</a></div><div class="ttdeci">@ VERY_VERBOSE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00223">definitions.h:223</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a></div><div class="ttdeci">@ MOFEM_INVALID_DATA</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00036">definitions.h:36</a></div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga2d955cc69ad392f69bc93fc037866772"><div class="ttname"><a href="group__mofem__bit__ref.html#ga2d955cc69ad392f69bc93fc037866772">MoFEM::BitRefManager::shiftRightBitRef</a></div><div class="ttdeci">MoFEMErrorCode shiftRightBitRef(const int shift, const BitRefLevel mask=BitRefLevel().set(), int verb=DEFAULT_VERBOSITY, MoFEMTypes mf=MF_ZERO) const</div><div class="ttdoc">right shift bit ref level</div><div class="ttdef"><b>Definition:</b> <a href="BitRefManager_8cpp_source.html#l00603">BitRefManager.cpp:603</a></div></div>
<div class="ttc" id="anamespaceFractureMechanics_html"><div class="ttname"><a href="namespaceFractureMechanics.html">FractureMechanics</a></div><div class="ttdef"><b>Definition:</b> <a href="AnalyticalFun_8hpp_source.html#l00015">AnalyticalFun.hpp:15</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CutMeshInterface_html_abbd4eb88942349846a3e832f9aa37504"><div class="ttname"><a href="structMoFEM_1_1CutMeshInterface.html#abbd4eb88942349846a3e832f9aa37504">MoFEM::CutMeshInterface::getSurface</a></div><div class="ttdeci">const Range &amp; getSurface() const</div><div class="ttdef"><b>Definition:</b> <a href="CutMeshInterface_8hpp_source.html#l00466">CutMeshInterface.hpp:466</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CrackPropagation_html_a06c3eddabfef8d0db78348fb8605842e"><div class="ttname"><a href="structFractureMechanics_1_1CrackPropagation.html#a06c3eddabfef8d0db78348fb8605842e">FractureMechanics::CrackPropagation::startStep</a></div><div class="ttdeci">int startStep</div><div class="ttdef"><b>Definition:</b> <a href="CrackPropagation_8hpp_source.html#l00168">CrackPropagation.hpp:168</a></div></div>
<div class="ttc" id="astructFractureMechanics_1_1CPMeshCut_html_a6ede3c2430549e561eb5af09519cafa0"><div class="ttname"><a href="structFractureMechanics_1_1CPMeshCut.html#a6ede3c2430549e561eb5af09519cafa0">FractureMechanics::CPMeshCut::clearData</a></div><div class="ttdeci">MoFEMErrorCode clearData()</div><div class="ttdef"><b>Definition:</b> <a href="CPMeshCut_8cpp_source.html#l02459">CPMeshCut.cpp:2459</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>