<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Gel Model (Usage example)</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="runningprograms.html">Programs</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Gel Model (Usage example) </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#gel_brick">Analysis of simple gel brick</a><ul><li class="level2"><a href="#gel_input_file">Input files</a><ul><li class="level3"><a href="#gel_material_file">Defining material properties</a></li>
</ul>
</li>
<li class="level2"><a href="#execution_gel">Executing code</a></li>
<li class="level2"><a href="#paraview_gel">VTK files for paraview</a></li>
<li class="level2"><a href="#user_gel_constitutive_equation">User (hackable) constitutive equation</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><p>This is example how to run a simple problem for gel model with visocus-relaxation. Is is dedicated for beginners starting work with <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>.</p>
<p>In this model mechanical and solvent concentration field is modeled. In addition viscous relaxation is taken into account by considering model with two springs and dashpot, with additional internal state variable. Detail about implementation and equations can be found in structure <a class="el" href="structGelModule_1_1Gel.html">GelModule::Gel</a></p>
<h1><a class="anchor" id="gel_brick"></a>
Analysis of simple gel brick</h1>
<h2><a class="anchor" id="gel_input_file"></a>
Input files</h2>
<p>It is assumed that user parent working directory is <em>users_modules/gel</em> in build directory.</p>
<h3><a class="anchor" id="journal"></a>
Journal file</h3>
<p>Mesh file with boundary conditions is created in Cubit journal file with prismatic bar (<a class="el" href="brick__of__gel_8jou.html">brick_of_gel.jou</a>), </p><div class="fragment"><div class="line">reset</div>
<div class="line">set duplicate block elements on</div>
<div class="line"> </div>
<div class="line">brick x 10 y 1 z 1</div>
<div class="line">webcut volume 1 with plane yplane imprint merge</div>
<div class="line"> </div>
<div class="line"># Sete block with volume with gel material</div>
<div class="line">block 1 volume 1</div>
<div class="line">block 1 name &#39;GEL_1&#39;</div>
<div class="line">block 2 volume 2</div>
<div class="line">block 2 name &#39;GEL_2&#39;</div>
<div class="line"> </div>
<div class="line"># Set Dirichelt boundary condition for solvent concentration </div>
<div class="line">block 6 surface 11 13 </div>
<div class="line">block 6 name &#39;CHEMICAL_LOAD_1&#39;  </div>
<div class="line">block 6 attribute count 1  </div>
<div class="line">block 6 attribute index 1 1 </div>
<div class="line"> </div>
<div class="line"># Set solvent flux, i.e. Neumann boundary condition </div>
<div class="line">block 5 surface 8 15 5 14 10 3 </div>
<div class="line">block 5 name &#39;FLUX_CHEMICAL_LOAD&#39;  </div>
<div class="line">block 5 attribute count 1  </div>
<div class="line">block 5 attribute index 1 0  </div>
<div class="line"> </div>
<div class="line"># Kinematic boundary condition for mechanical field </div>
<div class="line">create displacement on surface 9 16  dof 1 fix 0 </div>
<div class="line">create displacement on vertex 7 dof 1 dof 2 dof 3 fix 0 </div>
<div class="line">create displacement on vertex 4 dof 2 fix 0 </div>
<div class="line">create displacement on vertex 8 dof 3 fix 0 </div>
<div class="line"> </div>
<div class="line"># Static boundary condition, i.e. pressure </div>
<div class="line">create pressure  on surface 6 magnitude 1 </div>
<div class="line"> </div>
<div class="line"># Make a mesh </div>
<div class="line">volume all scheme Tetmesh </div>
<div class="line">volume all size auto factor 8 </div>
<div class="line">mesh volume all </div>
<div class="line"> </div>
<div class="line"># Set block 3 and set 10 node tetrahedrons in that block </div>
<div class="line">block 3 tet all </div>
<div class="line">block 3 element type TETRA10 </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
</div><!-- fragment --><h3><a class="anchor" id="gel_material_file"></a>
Defining material properties</h3>
<p>Material properties file (gel_config.in). </p><div class="fragment"><div class="line"># Material parameters for Gel material model</div>
<div class="line"> </div>
<div class="line">[block_1]</div>
<div class="line"> </div>
<div class="line"># Spring Alpha</div>
<div class="line">gAlpha = 1</div>
<div class="line">vAlpha = 0</div>
<div class="line"> </div>
<div class="line"># Spring Beta</div>
<div class="line">gBeta = 1</div>
<div class="line">vBeta = 0</div>
<div class="line"> </div>
<div class="line"># Daspot</div>
<div class="line">gBetaHat = 1</div>
<div class="line">vBetaHat = 0</div>
<div class="line"> </div>
<div class="line"># Volume per solvent molecule</div>
<div class="line">oMega = 10</div>
<div class="line"> </div>
<div class="line"># Initial chemical potential</div>
<div class="line">mU0 = 0.5</div>
<div class="line"> </div>
<div class="line"># Solvent transport material parameters</div>
<div class="line">vIscosity = 1</div>
<div class="line">pErmeability = 1</div>
<div class="line"> </div>
<div class="line"># User can set approximation order for each blocks independently</div>
<div class="line"># Set approximation order of block 1 as quadratic function.</div>
<div class="line"> </div>
<div class="line">oRder = 2</div>
<div class="line"> </div>
<div class="line">[block_2]</div>
<div class="line"> </div>
<div class="line"># Spring Alpha</div>
<div class="line">gAlpha = 1</div>
<div class="line">vAlpha = 0</div>
<div class="line"> </div>
<div class="line"># Spring Beta</div>
<div class="line">gBeta = 1</div>
<div class="line">vBeta = 0</div>
<div class="line"> </div>
<div class="line"># Daspot</div>
<div class="line">gBetaHat = 1</div>
<div class="line">vBetaHat = 0</div>
<div class="line"> </div>
<div class="line"># Volume per solvent molecule</div>
<div class="line">oMega = 5</div>
<div class="line"> </div>
<div class="line"># Initial chemical potential</div>
<div class="line">mU0 = 0.5</div>
<div class="line"> </div>
<div class="line"># Solvent transport material parameters</div>
<div class="line">vIscosity = 1</div>
<div class="line">pErmeability = 1</div>
<div class="line"> </div>
<div class="line"># User can set approximation order for each blocks independently</div>
<div class="line"># Set approximation order of block 1 as quadratic function.</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">oRder = 2</div>
</div><!-- fragment --><p>Native constitutive model is implemented after Yuhang Hu and Zhigang Suo <a class="el" href="citelist.html#CITEREF_hu2012viscoelasticity">[32]</a>. </p><div class="image">
<img src="gel_spring_daspot_model.png" alt="" width="700px"/>
<div class="caption">
Gel model</div></div>
<p>In basic implementations all springs and dashpot are implemented using Hook'e equation. However generalization to large deformations and displacements is straightforward, code uses automatic differentiation (ADOL-C), and user need only implement stress-strain physical equation and all tangent matrices are calculated automatically.</p>
<p>For more details about model implementation, equations and physical constants look here <a class="el" href="structGelModule_1_1Gel_1_1ConstitutiveEquation.html">GelModule::Gel::ConstitutiveEquation</a></p>
<h2><a class="anchor" id="execution_gel"></a>
Executing code</h2>
<p><a class="el" href="structExample.html" title="[Example]">Example</a> how to execute example problem:</p>
<div class="fragment"><div class="line">mpirun -np 4 ./gel_analysis \</div>
<div class="line">  -my_file brick_of_gel.cub \</div>
<div class="line">  -my_gel_config gel_config.in \</div>
<div class="line">  -ksp_type fgmres -ksp_final_residual \</div>
<div class="line">  -ksp_atol 1e-10 -ksp_rtol 1e-10 \</div>
<div class="line">  -ksp_monitor -ksp_converged_reason \</div>
<div class="line">  -pc_type lu -pc_factor_mat_solver_package mumps \</div>
<div class="line">  -snes_atol 1e-8 -snes_rtol 1e-8 \</div>
<div class="line">  -snes_type newtonls -snes_linesearch_type basic \</div>
<div class="line">  -snes_linesearch_monitor -snes_monitor \</div>
<div class="line">  -ts_type beuler -ts_dt 0.1 -ts_final_time 10  \</div>
<div class="line">  -ts_monitor</div>
</div><!-- fragment --><p>Notes:</p>
<ul>
<li>Option <em>-my_file</em> gives name of mesh file</li>
<li>Option <em>-my_gel_config</em> give name of material config file</li>
<li>Time integration scheme is controlled by <em>-ts_type</em>, look to PETSc manual for more details.</li>
<li>Resolution of post-processing mesh is set by <em>-my_max_post_proc_ref_level</em> 0. If more than 0, i.e. 1,2,... a denser post-processing mesh is generated. This results in biger size of post processing files and compromise overall efficiency.</li>
<li>Option <em>-snes_atol</em> control absolute tolerance of nonlinear solver, should be bigger than ksp_atol 1e-10</li>
<li>Option <em>-snes_rtol</em> control relative tolerance of nonlinear solver</li>
<li>Using <em>-my_output_prt</em> 1, each time step is post-processed.</li>
</ul>
<p>Result:</p>
<p><a class="el" href="structExample.html" title="[Example]">Example</a> of animation obtained from this example for approximation order 4</p>
<div class="image">
<img src="gel_simple_anim.gif" alt="" width="700px"/>
<div class="caption">
Gel brick</div></div>
<h2><a class="anchor" id="paraview_gel"></a>
VTK files for paraview</h2>
<p>Running dynamic analysis out_values_1.h5m, out_values_2.h5m, ... are created for each time step. Post-processing mesh in output fails is stored in native MoAB data format using standard h5m.</p>
<p>VTK files can be generated using script located in <em>users_modules/nonlinear_elasticity/do_vtk.sh</em>. For example </p><div class="fragment"><div class="line">../nonlinear_elasticity/do_vtk.sh out_*h5m</div>
</div><!-- fragment --><h2><a class="anchor" id="user_gel_constitutive_equation"></a>
User (hackable) constitutive equation</h2>
<p>In file <a class="el" href="UserGelModel_8hpp.html">UserGelModel.hpp</a> user can implement own constitutive equation, for details see UserGelConstitutiveEquation. Any change in <a class="el" href="UserGelModel_8hpp.html">UserGelModel.hpp</a> have to follow rebuilding the code </p><div class="fragment"><div class="line">$um_debug/gels make</div>
</div><!-- fragment --><p>Similiar (not exact) method is used to implement general nonlinear elastic materials, see for example <a class="el" href="NeoHookean_8hpp-example.html">NeoHookean.hpp</a> or <a class="el" href="Hooke_8hpp.html">Hooke.hpp</a> </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>