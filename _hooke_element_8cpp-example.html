<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: HookeElement.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">HookeElement.cpp</div></div>
</div><!--header-->
<div class="contents">
<p >Operators and data structures for linear elastic analysis.</p>
<p >Operators and data structures for linear elastic analysis</p>
<p >See as well header file <a class="el" href="_hooke_element_8hpp.html">HookeElement.hpp</a></p>
<p >Implemention of operators for <a class="el" href="struct_hooke.html" title="Hook equation.">Hooke</a> material. Implementation is extended to the case when the mesh is moving as results of topological changes, also the calculation of material forces and associated tangent matrices are added to implementation.</p>
<p >In other words spatial deformation is small but topological changes large.</p>
<div class="fragment"><div class="line"><span class="comment">/** \file HookeElement.cpp</span></div>
<div class="line"><span class="comment"> * \example HookeElement.cpp</span></div>
<div class="line"><span class="comment"> * \brief Operators and data structures for linear elastic analysis</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * See as well header file HookeElement.hpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Implemention of operators for Hooke material. Implementation is extended to</span></div>
<div class="line"><span class="comment"> * the case when the mesh is moving as results of topological changes, also the</span></div>
<div class="line"><span class="comment"> * calculation of material forces and associated tangent matrices are added to</span></div>
<div class="line"><span class="comment"> * implementation.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * In other words spatial deformation is small but topological changes large.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_hooke_element_8hpp.html">HookeElement.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateStrainAle::OpCalculateStrainAle(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a id="_a0" name="_a0"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, false),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStrainAle::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                          <a id="_a1" name="_a1"></a><a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                                                          <a id="_a2" name="_a2"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a id="a3" name="a3"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a id="_a4" name="_a4"></a><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a id="a5" name="a5"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a id="a6" name="a6"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a id="a7" name="a7"></a><a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</div>
<div class="line">  <span class="keyword">auto</span> t_H = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;HMat);</div>
<div class="line"> </div>
<div class="line">  dataAtPts-&gt;detHVec-&gt;resize(nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  dataAtPts-&gt;invHMat-&gt;resize(9, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  dataAtPts-&gt;FMat-&gt;resize(9, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  dataAtPts-&gt;smallStrainMat-&gt;resize(6, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_detH = getFTensor0FromVec(*dataAtPts-&gt;detHVec);</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;FMat);</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*dataAtPts-&gt;smallStrainMat);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    <a id="a8" name="a8"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> determinantTensor3by3(t_H, t_detH);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> invertTensor3by3(t_H, t_detH, t_invH);</div>
<div class="line">    t_F(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_h(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    t_strain(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_F(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2.;</div>
<div class="line"> </div>
<div class="line">    t_strain(0, 0) -= 1;</div>
<div class="line">    t_strain(1, 1) -= 1;</div>
<div class="line">    t_strain(2, 2) -= 1;</div>
<div class="line"> </div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_h;</div>
<div class="line">    ++t_H;</div>
<div class="line">    ++t_detH;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_F;</div>
<div class="line">  }</div>
<div class="line">  <a id="a9" name="a9"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateEnergy::OpCalculateEnergy(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">    <a id="_a10" name="_a10"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> ghost_vec)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts), ghostVec(ghost_vec, true) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateEnergy::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                       <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                                                       <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_strain = getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;smallStrainMat));</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  dataAtPts-&gt;energyVec-&gt;resize(nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> t_energy = <a id="_a11" name="_a11"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt;(</div>
<div class="line">      &amp;*(dataAtPts-&gt;energyVec-&gt;data().begin()));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    t_energy = (t_strain(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>)) / 2.;</div>
<div class="line">    ++t_strain;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_energy;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ghostVec.get()) {</div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get intergrayion weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">    <span class="keyword">auto</span> t_energy = <a class="code hl_class" href="class_f_tensor_1_1_tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt;(</div>
<div class="line">        &amp;*(dataAtPts-&gt;energyVec-&gt;data().begin()));</div>
<div class="line">    <span class="keywordtype">double</span> energy = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">      <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">      <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line">      <span class="keywordflow">if</span> (det_H.size()) {</div>
<div class="line">        <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> *= det_H[gg];</div>
<div class="line">      }</div>
<div class="line">      energy += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_energy;</div>
<div class="line">      ++t_energy;</div>
<div class="line">      ++t_w;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(ghostVec, 0, energy, ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateEshelbyStress::OpCalculateEshelbyStress(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      dataAtPts(data_at_pts) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateEshelbyStress::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_energy = <a class="code hl_class" href="class_f_tensor_1_1_tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt;(</div>
<div class="line">      &amp;*(dataAtPts-&gt;energyVec-&gt;data().begin()));</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="keyword">auto</span> t_F = getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;FMat));</div>
<div class="line">  dataAtPts-&gt;eshelbyStressMat-&gt;resize(9, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*(dataAtPts-&gt;eshelbyStressMat));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">    t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = -t_F(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_cauchy_stress(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    t_eshelby_stress(0, 0) += t_energy;</div>
<div class="line">    t_eshelby_stress(1, 1) += t_energy;</div>
<div class="line">    t_eshelby_stress(2, 2) += t_energy;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_energy;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_F;</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAssemble::OpAssemble(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts, <span class="keyword">const</span> <span class="keywordtype">char</span> type,</div>
<div class="line">    <span class="keywordtype">bool</span> symm)</div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, <a class="code hl_variable" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, symm),</div>
<div class="line">      dataAtPts(data_at_pts) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side,</div>
<div class="line">                                                <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                                                <a class="code hl_class" href="class_entity_type.html">EntityType</a> col_type,</div>
<div class="line">                                                <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of dofs on row</span></div>
<div class="line">  nbRows = row_data.<a id="a12" name="a12"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">  <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">    <a id="a13" name="a13"></a><a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of dofs on column</span></div>
<div class="line">  nbCols = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">  <span class="comment">// if no dofs on Columbia, exit nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span> (!nbCols)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// K_ij matrix will have 3 times the number of degrees of freedom of the</span></div>
<div class="line">  <span class="comment">// i-th entity set (nbRows)</span></div>
<div class="line">  <span class="comment">// and 3 times the number of degrees of freedom of the j-th entity set</span></div>
<div class="line">  <span class="comment">// (nbCols)</span></div>
<div class="line">  <a id="a14" name="a14"></a><a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>.resize(nbRows, nbCols, <span class="keyword">false</span>);</div>
<div class="line">  <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  nbIntegrationPts = getGaussPts().size2();</div>
<div class="line">  <span class="comment">// check if entity block is on matrix diagonal</span></div>
<div class="line">  <span class="keywordflow">if</span> (row_side == col_side &amp;&amp; row_type == col_type) {</div>
<div class="line">    isDiag = <span class="keyword">true</span>;</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    isDiag = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data, col_data);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data, col_data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::doWork(<span class="keywordtype">int</span> row_side,</div>
<div class="line">                                                <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                                                <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of dofs on row</span></div>
<div class="line">  nbRows = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">  <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span> (!nbRows)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">  nF.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">  nF.clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  nbIntegrationPts = getGaussPts().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                   <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  SETERRQ(PETSC_COMM_SELF, <a id="a15" name="a15"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not implemented&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not implemented&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::aSsemble(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">  <span class="comment">// get pointer to first global index on column</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;data = *dataAtPts;</div>
<div class="line">  <span class="keywordflow">if</span> (!data.forcesOnlyOnEntitiesRow.empty()) {</div>
<div class="line">    rowIndices.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    noalias(rowIndices) = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>();</div>
<div class="line">    row_indices = &amp;rowIndices[0];</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m.html#afe24680af2bc8772d55bdf4ed5f9211a">VectorDofs</a> &amp;dofs = row_data.<a id="a16" name="a16"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ab762079df5a543d6e8cdcfc01fba148b">getFieldDofs</a>();</div>
<div class="line">    VectorDofs::iterator dit = dofs.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; dit != dofs.end(); dit++, ii++) {</div>
<div class="line">      <span class="keywordflow">if</span> (data.forcesOnlyOnEntitiesRow.find((*dit)-&gt;getEnt()) ==</div>
<div class="line">          data.forcesOnlyOnEntitiesRow.end()) {</div>
<div class="line">        rowIndices[ii] = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!data.forcesOnlyOnEntitiesCol.empty()) {</div>
<div class="line">    colIndices.resize(nbCols, <span class="keyword">false</span>);</div>
<div class="line">    noalias(colIndices) = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>();</div>
<div class="line">    col_indices = &amp;colIndices[0];</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m.html#afe24680af2bc8772d55bdf4ed5f9211a">VectorDofs</a> &amp;dofs = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ab762079df5a543d6e8cdcfc01fba148b">getFieldDofs</a>();</div>
<div class="line">    VectorDofs::iterator dit = dofs.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; dit != dofs.end(); dit++, ii++) {</div>
<div class="line">      <span class="keywordflow">if</span> (data.forcesOnlyOnEntitiesCol.find((*dit)-&gt;getEnt()) ==</div>
<div class="line">          data.forcesOnlyOnEntitiesCol.end()) {</div>
<div class="line">        colIndices[ii] = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  Mat <a id="_a17" name="_a17"></a><a class="code hl_class" href="class_b.html">B</a> = getFEMethod()-&gt;ksp_B != PETSC_NULL ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                             : getFEMethod()-&gt;snes_B;</div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(<a class="code hl_class" href="class_b.html">B</a>, nbRows, row_indices, nbCols, col_indices,</div>
<div class="line">                      &amp;*<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>.data().begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!isDiag &amp;&amp; sYmm) {</div>
<div class="line">    <span class="comment">// if not diagonal term and since global matrix is symmetric assemble</span></div>
<div class="line">    <span class="comment">// transpose term.</span></div>
<div class="line">    transK.resize(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>.size2(), <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>.size1(), <span class="keyword">false</span>);</div>
<div class="line">    noalias(transK) = trans(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(<a class="code hl_class" href="class_b.html">B</a>, nbCols, col_indices, nbRows, row_indices,</div>
<div class="line">                        &amp;*transK.data().begin(), ADD_VALUES);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAssemble::aSsemble(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;data = *dataAtPts;</div>
<div class="line">  <span class="keywordflow">if</span> (!data.forcesOnlyOnEntitiesRow.empty()) {</div>
<div class="line">    rowIndices.resize(nbRows, <span class="keyword">false</span>);</div>
<div class="line">    noalias(rowIndices) = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>();</div>
<div class="line">    row_indices = &amp;rowIndices[0];</div>
<div class="line">    <a class="code hl_typedef" href="namespace_mo_f_e_m.html#afe24680af2bc8772d55bdf4ed5f9211a">VectorDofs</a> &amp;dofs = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ab762079df5a543d6e8cdcfc01fba148b">getFieldDofs</a>();</div>
<div class="line">    VectorDofs::iterator dit = dofs.begin();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; dit != dofs.end(); dit++, ii++) {</div>
<div class="line">      <span class="keywordflow">if</span> (data.forcesOnlyOnEntitiesRow.find((*dit)-&gt;getEnt()) ==</div>
<div class="line">          data.forcesOnlyOnEntitiesRow.end()) {</div>
<div class="line">        rowIndices[ii] = -1;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_eigen_matrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> <a id="a18" name="a18"></a><a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = getFEMethod()-&gt;snes_f;</div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, nbRows, row_indices, &amp;*nF.data().begin(), ADD_VALUES);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpRhs_dx::OpRhs_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a id="_a19" name="_a19"></a><a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROW) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpRhs_dx::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> &amp;<a id="a20" name="a20"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a id="_a21" name="_a21"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'l', 3&gt;</a> <a id="a22" name="a22"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a id="a23" name="a23"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a id="a24" name="a24"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*dataAtPts-&gt;cauchyStressMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleRhs_dx::OpAleRhs_dx(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROW) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleRhs_dx::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*dataAtPts-&gt;cauchyStressMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleRhs_dX::OpAleRhs_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROW) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleRhs_dX::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tensor1 = [](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 0), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 1), &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>(r + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;eshelbyStressMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line">    <span class="keyword">auto</span> t_nf = get_tensor1(nF, 0);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_nf(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) += <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">      ++t_nf;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::setBlocks(</div>
<div class="line">    <a id="_a25" name="_a25"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!block_sets_ptr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a id="a26" name="a26"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Pointer to block of sets is null&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<a id="a27" name="a27"></a><a class="code hl_define" href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a>(</div>
<div class="line">           m_field, <a id="a28" name="a28"></a><a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a> | <a id="a29" name="a29"></a><a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca416c3e3070d3438afe45ae7359d0559e">MAT_ELASTICSET</a>, it)) {</div>
<div class="line">    <a id="_a30" name="_a30"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_mat___elastic.html">Mat_Elastic</a> mydata;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> it-&gt;getAttributeDataStructure(mydata);</div>
<div class="line">    <span class="keywordtype">int</span> <span class="keywordtype">id</span> = it-&gt;getMeshsetId();</div>
<div class="line">    <span class="keyword">auto</span> &amp;block_data = (*block_sets_ptr)[id];</div>
<div class="line">    <a id="_a31" name="_a31"></a><a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset = it-&gt;getMeshset();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a32" name="a32"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(meshset, 3,</div>
<div class="line">                                                        block_data.tEts, <span class="keyword">true</span>);</div>
<div class="line">    block_data.iD = id;</div>
<div class="line">    block_data.E = mydata.<a id="a33" name="a33"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_mat___elastic.html#a4b9235ca86996296e5242976d5a12d58">data</a>.Young;</div>
<div class="line">    block_data.PoissonRatio = mydata.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_mat___elastic.html#a4b9235ca86996296e5242976d5a12d58">data</a>.Poisson;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::addElasticElement(</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">    <span class="keyword">const</span> std::string element_name, <span class="keyword">const</span> std::string x_field,</div>
<div class="line">    <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!block_sets_ptr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Pointer to block of sets is null&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a34" name="a34"></a><a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(element_name, <a id="a35" name="a35"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a36" name="a36"></a><a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(element_name, x_field);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a37" name="a37"></a><a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(element_name, x_field);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a38" name="a38"></a><a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(element_name, x_field);</div>
<div class="line">  <span class="keywordflow">if</span> (m_field.<a id="a39" name="a39"></a><a class="code hl_function" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(X_field)) {</div>
<div class="line">    <span class="keywordflow">if</span> (ale) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(element_name, X_field);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(element_name, X_field);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">modify_finite_element_add_field_data</a>(element_name, X_field);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a id="a40" name="a40"></a><a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : (*block_sets_ptr)) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a41" name="a41"></a><a class="code hl_function" href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">add_ents_to_finite_element_by_dim</a>(<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.tEts, 3,</div>
<div class="line">                                                     element_name);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::setOperators(</div>
<div class="line">    boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_lhs_ptr,</div>
<div class="line">    boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_rhs_ptr,</div>
<div class="line">    boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line">    <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp, <span class="keyword">const</span> <a class="code hl_class" href="class_entity_type.html">EntityType</a> type,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!block_sets_ptr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Pointer to block of sets is null&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!data_at_pts)</div>
<div class="line">    data_at_pts = boost::make_shared&lt;DataAtIntegrationPts&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (fe_lhs_ptr) {</div>
<div class="line">    <span class="keywordflow">if</span> (ale == PETSC_FALSE) {</div>
<div class="line">      <span class="keywordflow">if</span> (type == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a42" name="_a42"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a43" name="_a43"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a44" name="_a44"></a><a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness&lt;true&gt;</a>(</div>
<div class="line">              x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a45" name="_a45"></a><a class="code hl_struct" href="struct_op_lhs__dx__dx.html">OpLhs_dx_dx&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (type == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a46" name="_a46"></a><a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(X_field, data_at_pts-&gt;HMat));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness&lt;true&gt;</a>(</div>
<div class="line">              x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a47" name="_a47"></a><a class="code hl_struct" href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a48" name="_a48"></a><a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a49" name="_a49"></a><a class="code hl_struct" href="struct_op_ale_lhs__dx__dx.html">OpAleLhs_dx_dx&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a50" name="_a50"></a><a class="code hl_struct" href="struct_op_ale_lhs__dx__d_x.html">OpAleLhs_dx_dX&lt;0&gt;</a>(x_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a51" name="_a51"></a><a class="code hl_struct" href="struct_op_calculate_energy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a52" name="_a52"></a><a class="code hl_struct" href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a53" name="_a53"></a><a class="code hl_struct" href="struct_op_ale_lhs__d_x__d_x.html">OpAleLhs_dX_dX&lt;0&gt;</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a54" name="_a54"></a><a class="code hl_struct" href="struct_op_ale_lhs_pre__d_x__dx.html">OpAleLhsPre_dX_dx&lt;0&gt;</a>(X_field, x_field, data_at_pts));</div>
<div class="line">      fe_lhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a55" name="_a55"></a><a class="code hl_struct" href="struct_op_ale_lhs__d_x__dx.html">OpAleLhs_dX_dx</a>(X_field, x_field, data_at_pts));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (fe_rhs_ptr) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (ale == PETSC_FALSE) {</div>
<div class="line">      <span class="keywordflow">if</span> (type == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(x_field, x_field,</div>
<div class="line">                                                 block_sets_ptr, data_at_pts));</div>
<div class="line">      <span class="keywordflow">if</span> (field_disp) {</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a56" name="_a56"></a><a class="code hl_struct" href="struct_op_calculate_strain.html">OpCalculateStrain&lt;true&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_strain.html">OpCalculateStrain&lt;false&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      }</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a57" name="_a57"></a><a class="code hl_struct" href="struct_op_rhs__dx.html">OpRhs_dx</a>(x_field, x_field, data_at_pts));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (type == MBPRISM) {</div>
<div class="line">        boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(X_field, data_at_pts-&gt;HMat));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(x_field, x_field,</div>
<div class="line">                                                 block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a58" name="_a58"></a><a class="code hl_struct" href="struct_op_ale_rhs__dx.html">OpAleRhs_dx</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_energy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a>(X_field, X_field, data_at_pts));</div>
<div class="line">      fe_rhs_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a59" name="_a59"></a><a class="code hl_struct" href="struct_op_ale_rhs__d_x.html">OpAleRhs_dX</a>(X_field, X_field, data_at_pts));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::calculateEnergy(</div>
<div class="line">    DM dm, boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; block_sets_ptr,</div>
<div class="line">    <span class="keyword">const</span> std::string x_field, <span class="keyword">const</span> std::string X_field, <span class="keyword">const</span> <span class="keywordtype">bool</span> ale,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> field_disp, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> &amp;v_energy) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dm, &amp;m_field_ptr);</div>
<div class="line"> </div>
<div class="line">  v_energy = <a class="code hl_function" href="namespace_mo_f_e_m.html#a77d94d2111c0c988bc3100b3910cc25c">createVectorMPI</a>(m_field_ptr-&gt;<a id="a60" name="a60"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), PETSC_DECIDE, 1);</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts(</div>
<div class="line">      <span class="keyword">new</span> <a id="_a61" name="_a61"></a><a class="code hl_struct" href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> fe_ptr =</div>
<div class="line">      boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(*m_field_ptr);</div>
<div class="line">  fe_ptr-&gt;getRuleHook = [](<span class="keyword">const</span> <a id="_a62" name="_a62"></a><a class="code hl_class" href="classdouble.html">double</a>, <span class="keyword">const</span> <a class="code hl_class" href="classdouble.html">double</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> <a id="a63" name="a63"></a><a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a5bb9bcfd1daa71ef015ad809cd06ea4f">o</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a5bb9bcfd1daa71ef015ad809cd06ea4f">o</a>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (m_field_ptr-&gt;<a class="code hl_function" href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">check_field</a>(<span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>)) <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#af01ee5c3bc1505a09c369d8d455bba1e">addHOOpsVol</a>(</div>
<div class="line">      <span class="stringliteral">&quot;MESH_NODE_POSITIONS&quot;</span>, *fe_ptr, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">struct </span><a id="_a64" name="_a64"></a><a class="code hl_struct" href="struct_prism_f_e.html">PrismFE</a> : <span class="keyword">public</span> <a id="_a65" name="_a65"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_fat_prism_element_forces_and_sources_core.html">FatPrismElementForcesAndSourcesCore</a> {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_fat_prism_element_forces_and_sources_core.html">FatPrismElementForcesAndSourcesCore</a>::</div>
<div class="line">        FatPrismElementForcesAndSourcesCore;</div>
<div class="line">    <span class="keywordtype">int</span> getRuleTrianglesOnly(<span class="keywordtype">int</span> <a id="a66" name="a66"></a><a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>; }</div>
<div class="line">    <span class="keywordtype">int</span> getRuleThroughThickness(<span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>; }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;ForcesAndSourcesCore&gt; prism_fe_ptr(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_prism_f_e.html">PrismFE</a>(*m_field_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> push_ops = [&amp;](boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_ptr,</div>
<div class="line">                      <a class="code hl_class" href="class_entity_type.html">EntityType</a> <a class="code hl_variable" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>) {</div>
<div class="line">    <a id="a67" name="a67"></a><a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; inv_jac_ptr(<span class="keyword">new</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (ale == PETSC_FALSE) {</div>
<div class="line">      <span class="keywordflow">if</span> (type == MBPRISM) {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(</div>
<div class="line">          x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      <span class="keywordflow">if</span> (field_disp) {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_strain.html">OpCalculateStrain&lt;true&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_strain.html">OpCalculateStrain&lt;false&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      }</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_energy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts, v_energy));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">if</span> (type == MBPRISM) {</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">OpCalculateInvJacForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">        fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">OpSetInvJacH1ForFatPrism</a>(inv_jac_ptr));</div>
<div class="line">      }</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(X_field, data_at_pts-&gt;HMat));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness&lt;0&gt;</a>(</div>
<div class="line">          x_field, x_field, block_sets_ptr, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(x_field, data_at_pts-&gt;hMat));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_stress.html">OpCalculateStress&lt;0&gt;</a>(x_field, x_field, data_at_pts));</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_energy.html">OpCalculateEnergy</a>(X_field, X_field, data_at_pts, v_energy));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> push_ops(fe_ptr, MBTET);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> push_ops(prism_fe_ptr, MBPRISM);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(v_energy);</div>
<div class="line"> </div>
<div class="line">  fe_ptr-&gt;snes_ctx = SnesMethod::CTX_SNESNONE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>, fe_ptr);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;ELASTIC&quot;</span>, prism_fe_ptr);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(v_energy);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(v_energy);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpAleLhs_dX_dx::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                       <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a id="a68" name="a68"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a id="_a69" name="_a69"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'m', 3&gt;</a> <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'n', 3&gt;</a> <a id="a70" name="a70"></a><a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_eshelby_stress_dx = [<span class="keyword">this</span>]() {</div>
<div class="line">    <a id="_a71" name="_a71"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3, 3, 3&gt;</div>
<div class="line">        t_eshelby_stress_dx;</div>
<div class="line">    <span class="keywordtype">int</span> mm = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jj = 0; jj != 3; ++jj)</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kk = 0; kk != 3; ++kk)</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != 3; ++ll)</div>
<div class="line">            t_eshelby_stress_dx.ptr(ii, jj, kk, ll) =</div>
<div class="line">                &amp;(*dataAtPts-&gt;eshelbyStress_dx)(mm++, 0);</div>
<div class="line">    <span class="keywordflow">return</span> t_eshelby_stress_dx;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress_dx = get_eshelby_stress_dx();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a id="_a72" name="_a72"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3&lt;double, 3, 3, 3&gt;</a> t_row_stress_dx;</div>
<div class="line">      t_row_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) =</div>
<div class="line">          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) += t_row_stress_dx(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) * t_col_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_diff_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++t_eshelby_stress_dx;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleLhsWithDensity_dX_dX::OpAleLhsWithDensity_dX_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false),</div>
<div class="line">      rhoAtGaussPtsPtr(rho_at_gauss_pts),</div>
<div class="line">      rhoGradAtGaussPtsPtr(rho_grad_at_gauss_pts), rhoN(rho_n), rHo0(rho_0) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">HookeElement::OpAleLhsWithDensity_dX_dX::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                   <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get intergrayion weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Elastic stiffness tensor (4th rank tensor with minor and major</span></div>
<div class="line">  <span class="comment">// symmetry)</span></div>
<div class="line">  <span class="keyword">auto</span> <a id="a73" name="a73"></a><a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = getFTensor0FromVec(*rhoAtGaussPtsPtr);</div>
<div class="line">  <span class="keyword">auto</span> t_grad_rho = getFTensor1FromMat&lt;3&gt;(*rhoGradAtGaussPtsPtr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> t_eshelby_stress =</div>
<div class="line">      getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;eshelbyStressMat);</div>
<div class="line">  <span class="comment">// auto t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</span></div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> stress_dho_coef = (rhoN / <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="comment">// (rhoN / rHo0) * pow(rho / rHo0, rhoN - 1.) * (1. / pow(rho / rHo0,</span></div>
<div class="line">    <span class="comment">// rhoN));</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line">      t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_eshelby_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="comment">// auto t_col_diff_base = col_data.getFTensor1DiffN&lt;3&gt;(gg, 0);</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_base = col_data.<a id="a74" name="a74"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) +=</div>
<div class="line">            t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * stress_dho_coef * t_grad_rho(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_base;</div>
<div class="line">        <span class="comment">// move to next column base function</span></div>
<div class="line">        ++t_col_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_eshelby_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++t_grad_rho;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpAleLhsWithDensity_dx_dX::OpAleLhsWithDensity_dx_dX(</div>
<div class="line">    <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">    boost::shared_ptr&lt;DataAtIntegrationPts&gt; &amp;data_at_pts,</div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts,</div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; rho_grad_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0)</div>
<div class="line">    : <a class="code hl_struct" href="struct_op_assemble.html">OpAssemble</a>(row_field, col_field, data_at_pts, OPROWCOL, false),</div>
<div class="line">      rhoAtGaussPtsPtr(rho_at_gauss_pts),</div>
<div class="line">      rhoGradAtGaussPtsPtr(rho_grad_at_gauss_pts), rhoN(rho_n), rHo0(rho_0) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">HookeElement::OpAleLhsWithDensity_dx_dX::iNtegrate(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                                                   <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get sub-block (3x3) of local stiffens matrix, here represented by</span></div>
<div class="line">  <span class="comment">// second order tensor</span></div>
<div class="line">  <span class="keyword">auto</span> get_tensor2 = [](<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 3&gt;</a>, 3, 3&gt;(</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 0, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0),</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 1, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 0), &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 1),</div>
<div class="line">        &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>(r + 2, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> + 2));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">  <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get integration weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get derivatives of base functions on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> row_nb_base_fun = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">getN</a>().size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = getFTensor0FromVec(*rhoAtGaussPtsPtr);</div>
<div class="line">  <span class="keyword">auto</span> t_grad_rho = getFTensor1FromMat&lt;3&gt;(*rhoGradAtGaussPtsPtr);</div>
<div class="line">  <span class="keyword">auto</span> t_cauchy_stress =</div>
<div class="line">      getFTensor2SymmetricFromMat&lt;3&gt;(*(dataAtPts-&gt;cauchyStressMat));</div>
<div class="line">  <span class="comment">// auto t_h = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;hMat);</span></div>
<div class="line">  <span class="keyword">auto</span> t_invH = getFTensor2FromMat&lt;3, 3&gt;(*dataAtPts-&gt;invHMat);</div>
<div class="line">  <span class="keyword">auto</span> &amp;det_H = *dataAtPts-&gt;detHVec;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// iterate over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nbIntegrationPts; ++gg) {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// calculate scalar weight times element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol * det_H[gg];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> stress_dho_coef = (rhoN / <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>);</div>
<div class="line">    <span class="comment">// (rhoN / rHo0) * pow(rho / rHo0, rhoN - 1.) * (1. / pow(rho / rHo0,</span></div>
<div class="line">    <span class="comment">// rhoN)); iterate over row base functions</span></div>
<div class="line">    <span class="keywordtype">int</span> rr = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (; rr != nbRows / 3; ++rr) {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get sub matrix for the row</span></div>
<div class="line">      <span class="keyword">auto</span> t_m = get_tensor2(<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a>, 3 * rr, 0);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_diff_base_pulled;</div>
<div class="line">      t_row_diff_base_pulled(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_row_diff_base(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_invH(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_row_stress;</div>
<div class="line">      t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_diff_base_pulled(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_cauchy_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions for columns</span></div>
<div class="line">      <span class="keyword">auto</span> t_col_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">      <span class="comment">// iterate column base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nbCols / 3; ++cc) {</div>
<div class="line"> </div>
<div class="line">        t_m(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) +=</div>
<div class="line">            t_row_stress(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * stress_dho_coef * t_grad_rho(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_col_base;</div>
<div class="line"> </div>
<div class="line">        ++t_col_base;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to next block of local stiffens matrix</span></div>
<div class="line">        ++t_m;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// move to next row base function</span></div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; rr != row_nb_base_fun; ++rr)</div>
<div class="line">      ++t_row_diff_base;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_w;</div>
<div class="line">    <span class="comment">// ++t_D;</span></div>
<div class="line">    ++t_cauchy_stress;</div>
<div class="line">    ++t_invH;</div>
<div class="line">    <span class="comment">// ++t_h;</span></div>
<div class="line">    ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    ++t_grad_rho;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">HookeElement::OpCalculateStiffnessScaledByDensityField::</div>
<div class="line">    OpCalculateStiffnessScaledByDensityField(</div>
<div class="line">        <span class="keyword">const</span> std::string row_field, <span class="keyword">const</span> std::string col_field,</div>
<div class="line">        boost::shared_ptr&lt;map&lt;int, BlockData&gt;&gt; &amp;block_sets_ptr,</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt; data_at_pts,</div>
<div class="line">        boost::shared_ptr&lt;VectorDouble&gt; rho_at_gauss_pts, <span class="keyword">const</span> <span class="keywordtype">double</span> rho_n,</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> rho_0)</div>
<div class="line"> </div>
<div class="line">    : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolUserDataOperator</a>(row_field, col_field, OPROW, true),</div>
<div class="line">      blockSetsPtr(block_sets_ptr), dataAtPts(data_at_pts),</div>
<div class="line">      rhoAtGaussPtsPtr(rho_at_gauss_pts), rhoN(rho_n), rHo0(rho_0) {</div>
<div class="line">  std::fill(&amp;doEntities[MBEDGE], &amp;doEntities[MBMAXTYPE], <span class="keyword">false</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> HookeElement::OpCalculateStiffnessScaledByDensityField::doWork(</div>
<div class="line">    <span class="keywordtype">int</span> row_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!rhoAtGaussPtsPtr)</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;Calculate density with MWLS first.&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a> : (*blockSetsPtr)) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.tEts.find(getNumeredEntFiniteElementPtr()-&gt;getEnt()) ==</div>
<div class="line">        <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.tEts.end()) {</div>
<div class="line">      <span class="keywordflow">continue</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">    dataAtPts-&gt;stiffnessMat-&gt;resize(36, nb_integration_pts, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">    <a id="_a75" name="_a75"></a><a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3, 3&gt; t_D(</div>
<div class="line">        <a id="a76" name="a76"></a><a class="code hl_define" href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a>(dataAtPts-&gt;stiffnessMat));</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> young = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.E;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> poisson = <a class="code hl_variable" href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a>.second.PoissonRatio;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> = getFTensor0FromVec(*rhoAtGaussPtsPtr);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// coefficient used in intermediate calculation</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> coefficient = young / ((1 + poisson) * (1 - 2 * poisson));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'k', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">    <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'l', 3&gt;</a> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line"> </div>
<div class="line">      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = 0.;</div>
<div class="line"> </div>
<div class="line">      t_D(0, 0, 0, 0) = 1 - poisson;</div>
<div class="line">      t_D(1, 1, 1, 1) = 1 - poisson;</div>
<div class="line">      t_D(2, 2, 2, 2) = 1 - poisson;</div>
<div class="line"> </div>
<div class="line">      t_D(0, 1, 0, 1) = 0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(0, 2, 0, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line">      t_D(1, 2, 1, 2) = 0.5 * (1 - 2 * poisson);</div>
<div class="line"> </div>
<div class="line">      t_D(0, 0, 1, 1) = poisson;</div>
<div class="line">      t_D(1, 1, 0, 0) = poisson;</div>
<div class="line">      t_D(0, 0, 2, 2) = poisson;</div>
<div class="line">      t_D(2, 2, 0, 0) = poisson;</div>
<div class="line">      t_D(1, 1, 2, 2) = poisson;</div>
<div class="line">      t_D(2, 2, 1, 1) = poisson;</div>
<div class="line">      <span class="comment">// here the coefficient is modified to take density into account for</span></div>
<div class="line">      <span class="comment">// porous materials: E(p) = E * (p / p_0)^n</span></div>
<div class="line">      t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) *= coefficient * pow(<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a> / rHo0, rhoN);</div>
<div class="line"> </div>
<div class="line">      ++t_D;</div>
<div class="line">      ++<a class="code hl_variable" href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="a_basic_fe_tools_8hpp_html_a5bb9bcfd1daa71ef015ad809cd06ea4f"><div class="ttname"><a href="_basic_fe_tools_8hpp.html#a5bb9bcfd1daa71ef015ad809cd06ea4f">o</a></div><div class="ttdeci">static Index&lt; 'o', 3 &gt; o</div><div class="ttdef"><b>Definition:</b> <a href="_basic_fe_tools_8hpp_source.html#l00089">BasicFeTools.hpp:89</a></div></div>
<div class="ttc" id="a_basic_fe_tools_8hpp_html_adc123f6289030c1cc143d1235fd18ec4"><div class="ttname"><a href="_basic_fe_tools_8hpp.html#adc123f6289030c1cc143d1235fd18ec4">K</a></div><div class="ttdeci">static Index&lt; 'K', 3 &gt; K</div><div class="ttdef"><b>Definition:</b> <a href="_basic_fe_tools_8hpp_source.html#l00094">BasicFeTools.hpp:94</a></div></div>
<div class="ttc" id="a_hooke_element_8hpp_html"><div class="ttname"><a href="_hooke_element_8hpp.html">HookeElement.hpp</a></div></div>
<div class="ttc" id="a_hooke_element_8hpp_html_ab02600da9e2ca129f6258b0e880c1e0e"><div class="ttname"><a href="_hooke_element_8hpp.html#ab02600da9e2ca129f6258b0e880c1e0e">MAT_TO_DDG</a></div><div class="ttdeci">#define MAT_TO_DDG(SM)</div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00142">HookeElement.hpp:142</a></div></div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclass_b_html"><div class="ttname"><a href="class_b.html">B</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_entity_type_html"><div class="ttname"><a href="class_entity_type.html">EntityType</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_ddg_html"><div class="ttname"><a href="class_f_tensor_1_1_ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition:</b> <a href="_ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:8</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition:</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor0_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor0.html">FTensor::Tensor0</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor0_8hpp_source.html#l00016">Tensor0.hpp:17</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor3_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor3.html">FTensor::Tensor3</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor3__value_8hpp_source.html#l00012">Tensor3_value.hpp:13</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor4_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor4.html">FTensor::Tensor4</a></div><div class="ttdef"><b>Definition:</b> <a href="_tensor4__value_8hpp_source.html#l00018">Tensor4_value.hpp:19</a></div></div>
<div class="ttc" id="aclass_op_calculate_vector_field_gradient_html"><div class="ttname"><a href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00098">definitions.h:98</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00447">definitions.h:447</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00346">definitions.h:346</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efca416c3e3070d3438afe45ae7359d0559e"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efca416c3e3070d3438afe45ae7359d0559e">MAT_ELASTICSET</a></div><div class="ttdeci">@ MAT_ELASTICSET</div><div class="ttdoc">block name is &quot;MAT_ELASTIC&quot;</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00159">definitions.h:159</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00148">definitions.h:148</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a></div><div class="ttdeci">@ MOFEM_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00032">definitions.h:32</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00416">definitions.h:416</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00535">definitions.h:535</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00440">definitions.h:440</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_a85adab6ee98bfcb82caccea618fde959"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#a85adab6ee98bfcb82caccea618fde959">n</a></div><div class="ttdeci">FTensor::Index&lt; 'n', SPACE_DIM &gt; n</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00066">fluid_structure_eigenproblem.cpp:66</a></div></div>
<div class="ttc" id="afluid__structure__eigenproblem_8cpp_html_aaeeb615e0d0b09b810b29ec6086e0112"><div class="ttname"><a href="fluid__structure__eigenproblem_8cpp.html#aaeeb615e0d0b09b810b29ec6086e0112">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', SPACE_DIM &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="fluid__structure__eigenproblem_8cpp_source.html#l00065">fluid_structure_eigenproblem.cpp:65</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00572">DMMoFEM.cpp:572</a></div></div>
<div class="ttc" id="agroup__dm_html_gac5ffe05a59f8ff6145029d62093f2e9b"><div class="ttname"><a href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">MoFEM::DMoFEMGetInterfacePtr</a></div><div class="ttdeci">PetscErrorCode DMoFEMGetInterfacePtr(DM dm, MoFEM::Interface **m_field_ptr)</div><div class="ttdoc">Get pointer to MoFEM::Interface.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00400">DMMoFEM.cpp:400</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga3a32fd9345258c23de8d1230795f8ff3"><div class="ttname"><a href="group__mofem__fe.html#ga3a32fd9345258c23de8d1230795f8ff3">MoFEM::CoreInterface::add_ents_to_finite_element_by_dim</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_dim(const EntityHandle entities, const int dim, const std::string &amp;name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaa2337ef6cebd2ecb83e4c3eb5e5e1090"><div class="ttname"><a href="group__mofem__fe.html#gaa2337ef6cebd2ecb83e4c3eb5e5e1090">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_filed)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="agroup__mofem__field_html_gad43a6631f7d465ad31403cbb1d1896ba"><div class="ttname"><a href="group__mofem__field.html#gad43a6631f7d465ad31403cbb1d1896ba">MoFEM::CoreInterface::check_field</a></div><div class="ttdeci">virtual bool check_field(const std::string &amp;name) const =0</div><div class="ttdoc">check if field is in database</div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga6bd6335f024a22cde370ee807d9185ce"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga6bd6335f024a22cde370ee807d9185ce">_IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_CUBITMESHSETS_BY_BCDATA_TYPE_FOR_LOOP_(MESHSET_MANAGER, CUBITBCTYPE, IT)</div><div class="ttdoc">Iterator that loops over a specific Cubit MeshSet in a moFEM field.</div><div class="ttdef"><b>Definition:</b> <a href="_meshsets_manager_8hpp_source.html#l00049">MeshsetsManager.hpp:49</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespace_eigen_matrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespace_eigen_matrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="_matrix_function_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a77d94d2111c0c988bc3100b3910cc25c"><div class="ttname"><a href="namespace_mo_f_e_m.html#a77d94d2111c0c988bc3100b3910cc25c">MoFEM::createVectorMPI</a></div><div class="ttdeci">auto createVectorMPI(MPI_Comm comm, PetscInt n, PetscInt N)</div><div class="ttdoc">Create MPI Vector.</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00198">PetscSmartObj.hpp:198</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01631">EntitiesFieldData.hpp:1631</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01576">EntitiesFieldData.hpp:1576</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_af01ee5c3bc1505a09c369d8d455bba1e"><div class="ttname"><a href="namespace_mo_f_e_m.html#af01ee5c3bc1505a09c369d8d455bba1e">MoFEM::addHOOpsVol</a></div><div class="ttdeci">MoFEMErrorCode addHOOpsVol(const std::string field, E &amp;e, bool h1, bool hcurl, bool hdiv, bool l2)</div><div class="ttdef"><b>Definition:</b> <a href="_h_o_data_operators_8hpp_source.html#l00754">HODataOperators.hpp:754</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_afe24680af2bc8772d55bdf4ed5f9211a"><div class="ttname"><a href="namespace_mo_f_e_m.html#afe24680af2bc8772d55bdf4ed5f9211a">MoFEM::VectorDofs</a></div><div class="ttdeci">ublas::vector&lt; FEDofEntity *, DofsAllocator &gt; VectorDofs</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l00023">EntitiesFieldData.hpp:23</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a3ed57096651b587c2bf716fa78048153"><div class="ttname"><a href="plastic_8cpp.html#a3ed57096651b587c2bf716fa78048153">rho</a></div><div class="ttdeci">double rho</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00187">plastic.cpp:187</a></div></div>
<div class="ttc" id="astruct_data_at_integration_pts_html"><div class="ttname"><a href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00079">HookeElement.hpp:79</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a9b2bc8c1b980f49d31a0b5f7fbe756f5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l00127">EntitiesFieldData.hpp:127</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8cpp_source.html#l00387">EntitiesFieldData.cpp:387</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01489">EntitiesFieldData.hpp:1489</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a6803bfc79169740e108bd5e2666de739"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6803bfc79169740e108bd5e2666de739">MoFEM::EntitiesFieldData::EntData::getN</a></div><div class="ttdeci">MatrixDouble &amp; getN(const FieldApproximationBase base)</div><div class="ttdoc">get base functions this return matrix (nb. of rows is equal to nb. of Gauss pts, nb....</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01305">EntitiesFieldData.hpp:1305</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_ab762079df5a543d6e8cdcfc01fba148b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ab762079df5a543d6e8cdcfc01fba148b">MoFEM::EntitiesFieldData::EntData::getFieldDofs</a></div><div class="ttdeci">const VectorDofs &amp; getFieldDofs() const</div><div class="ttdoc">get dofs data stature FEDofEntity</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01256">EntitiesFieldData.hpp:1256</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_ae5f8ff17de93c9dbb9701dc0bf067b2e"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01201">EntitiesFieldData.hpp:1201</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_fat_prism_element_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_fat_prism_element_forces_and_sources_core.html">MoFEM::FatPrismElementForcesAndSourcesCore</a></div><div class="ttdoc">FatPrism finite element.</div><div class="ttdef"><b>Definition:</b> <a href="_fat_prism_element_forces_and_sources_core_8hpp_source.html#l00031">FatPrismElementForcesAndSourcesCore.hpp:32</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_mat___elastic_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_mat___elastic.html">MoFEM::Mat_Elastic</a></div><div class="ttdoc">Elastic material data structure.</div><div class="ttdef"><b>Definition:</b> <a href="_material_blocks_8hpp_source.html#l00139">MaterialBlocks.hpp:139</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_mat___elastic_html_a4b9235ca86996296e5242976d5a12d58"><div class="ttname"><a href="struct_mo_f_e_m_1_1_mat___elastic.html#a4b9235ca86996296e5242976d5a12d58">MoFEM::Mat_Elastic::data</a></div><div class="ttdeci">_data_ data</div><div class="ttdef"><b>Definition:</b> <a href="_material_blocks_8hpp_source.html#l00157">MaterialBlocks.hpp:157</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_inv_jac_for_fat_prism.html">MoFEM::OpCalculateInvJacForFatPrism</a></div><div class="ttdoc">Calculate inverse of jacobian for face element.</div><div class="ttdef"><b>Definition:</b> <a href="_user_data_operators_8hpp_source.html#l03095">UserDataOperators.hpp:3096</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_fat_prism.html">MoFEM::OpSetInvJacH1ForFatPrism</a></div><div class="ttdoc">Transform local reference derivatives of shape functions to global derivatives.</div><div class="ttdef"><b>Definition:</b> <a href="_user_data_operators_8hpp_source.html#l03122">UserDataOperators.hpp:3123</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_smart_petsc_obj_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">MoFEM::SmartPetscObj</a></div><div class="ttdoc">intrusive_ptr for managing petsc objects</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00078">PetscSmartObj.hpp:79</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="_volume_element_forces_and_sources_core_8hpp_source.html#l00108">VolumeElementForcesAndSourcesCore.hpp:109</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__d_x__d_x_html"><div class="ttname"><a href="struct_op_ale_lhs__d_x__d_x.html">OpAleLhs_dX_dX</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00521">HookeElement.hpp:521</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__d_x__dx_html"><div class="ttname"><a href="struct_op_ale_lhs__d_x__dx.html">OpAleLhs_dX_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00547">HookeElement.hpp:547</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__dx__d_x_html"><div class="ttname"><a href="struct_op_ale_lhs__dx__d_x.html">OpAleLhs_dx_dX</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00449">HookeElement.hpp:449</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs__dx__dx_html"><div class="ttname"><a href="struct_op_ale_lhs__dx__dx.html">OpAleLhs_dx_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00434">HookeElement.hpp:434</a></div></div>
<div class="ttc" id="astruct_op_ale_lhs_pre__d_x__dx_html"><div class="ttname"><a href="struct_op_ale_lhs_pre__d_x__dx.html">OpAleLhsPre_dX_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00536">HookeElement.hpp:536</a></div></div>
<div class="ttc" id="astruct_op_ale_rhs__d_x_html"><div class="ttname"><a href="struct_op_ale_rhs__d_x.html">OpAleRhs_dX</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00512">HookeElement.hpp:512</a></div></div>
<div class="ttc" id="astruct_op_ale_rhs__dx_html"><div class="ttname"><a href="struct_op_ale_rhs__dx.html">OpAleRhs_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00425">HookeElement.hpp:425</a></div></div>
<div class="ttc" id="astruct_op_assemble_html"><div class="ttname"><a href="struct_op_assemble.html">OpAssemble</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00340">HookeElement.hpp:340</a></div></div>
<div class="ttc" id="astruct_op_calculate_energy_html"><div class="ttname"><a href="struct_op_calculate_energy.html">OpCalculateEnergy</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00164">HookeElement.hpp:164</a></div></div>
<div class="ttc" id="astruct_op_calculate_eshelby_stress_html"><div class="ttname"><a href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00177">HookeElement.hpp:177</a></div></div>
<div class="ttc" id="astruct_op_calculate_homogeneous_stiffness_html"><div class="ttname"><a href="struct_op_calculate_homogeneous_stiffness.html">OpCalculateHomogeneousStiffness</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00190">HookeElement.hpp:190</a></div></div>
<div class="ttc" id="astruct_op_calculate_strain_ale_html"><div class="ttname"><a href="struct_op_calculate_strain_ale.html">OpCalculateStrainAle</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00130">HookeElement.hpp:130</a></div></div>
<div class="ttc" id="astruct_op_calculate_strain_html"><div class="ttname"><a href="struct_op_calculate_strain.html">OpCalculateStrain</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00119">HookeElement.hpp:119</a></div></div>
<div class="ttc" id="astruct_op_calculate_stress_html"><div class="ttname"><a href="struct_op_calculate_stress.html">OpCalculateStress</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00153">HookeElement.hpp:153</a></div></div>
<div class="ttc" id="astruct_op_lhs__dx__dx_html"><div class="ttname"><a href="struct_op_lhs__dx__dx.html">OpLhs_dx_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00410">HookeElement.hpp:410</a></div></div>
<div class="ttc" id="astruct_op_rhs__dx_html"><div class="ttname"><a href="struct_op_rhs__dx.html">OpRhs_dx</a></div><div class="ttdef"><b>Definition:</b> <a href="_hooke_element_8hpp_source.html#l00401">HookeElement.hpp:401</a></div></div>
<div class="ttc" id="astruct_prism_f_e_html"><div class="ttname"><a href="struct_prism_f_e.html">PrismFE</a></div><div class="ttdef"><b>Definition:</b> <a href="prism__elements__from__surface_8cpp_source.html#l00062">prism_elements_from_surface.cpp:62</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>