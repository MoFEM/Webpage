<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: COR-3: Implementing operators for the Poisson equation</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">COR-3: Implementing operators for the Poisson equation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#poisson_tut2_op_volume">Operators on volume elements</a></li>
<li class="level1"><a href="#poisson_tut2_op_volume_op_face">Operators on face elements</a></li>
<li class="level1"><a href="#poisson_tut2_op_set_up">Setup of a finite element</a></li>
<li class="level1"><a href="#poisson_tut2_op_operators">Implementation of user data operators</a><ul><li class="level2"><a href="#poisson_tut2_op_operators_grad_grad">The grad-grad operator</a></li>
<li class="level2"><a href="#poisson_tut2_op_operators_vf">The right hand side</a></li>
<li class="level2"><a href="#poisson_tut2_op_operators_error">Error calculation</a></li>
</ul>
</li>
<li class="level1"><a href="#poisson_tut2_exercise">Exercise</a></li>
</ul>
</div>
<div class="textblock"><p>In this tutorial, we focus only on setting up finite element and implementation of user data operator for the Poisson equation. It is the next step after tutorial <a class="el" href="poisson_tut1.html">COR-2: Solving the Poisson equation</a>. Source for this tutorial is in <a class="el" href="PoissonOperators_8hpp-example.html">PoissonOperators.hpp</a>.</p>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is designed to work with various approximation spaces and is utilizing hierarchical and heterogenous approximation bases. <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> design is reflected in hierarchy of classes and implementation of finite elements. Here we introduce user data operators which provide core functionality for application developers.</p>
<p>We distinguish between finite element structure (FES), finite element entity (FEE), finite element class (FEC) and finite element object (FEO);</p>
<ul>
<li><b>FES:</b> Is a structure for declaring finite element, i.e. its name and on which fields it operates. It keeps information on meshset tag, meshset contains all entities on which given FES is defined. Structure of finite element is implemented in <a class="el" href="structMoFEM_1_1FiniteElement.html" title="Finite element definition.">MoFEM::FiniteElement</a>. This class is transparent for application developer and used directly by core library developers.</li>
<li><b>FEE:</b> Is a particular entity on which FES is defined. This is implemented in <a class="el" href="structMoFEM_1_1EntFiniteElement.html" title="Finite element data for entity.">MoFEM::EntFiniteElement</a> and derived classes. On that structure data about degrees of freedom (DOFs) on finite element are stored. This hierarchy of classes is transparent for application developer and used directly by core library developers.</li>
<li><b>FEC:</b> FEC class is used to create FEO. FEC is set of methods operating on FEE. In <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> we have hierarchy of FEC classes managing complexities associated with finite elements calculations.</li>
<li><b>FEO:</b> Is an instance of FEC.</li>
</ul>
<p>Implementation of finite element class (FEC) is generic, does not depend on problem or PDE which is solved. The most generic FEC is derived directly from <a class="el" href="structMoFEM_1_1FEMethod.html" title="structure for User Loop Methods on finite elements">MoFEM::FEMethod</a>. This element delivers raw access to multi-index structures on FEE, enabling to make various queries about DOFs, for example to iterate over DOFs on lower entity of specific type or DOFs associated with particular field and order, utilizing flexibility of multi-index containers. The <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a> finite element is derived form <a class="el" href="structMoFEM_1_1FEMethod.html" title="structure for User Loop Methods on finite elements">MoFEM::FEMethod</a>. From <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a> are derived range of elements associated with particular dimensions, <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html" title="Volume finite element base.">MoFEM::VolumeElementForcesAndSourcesCore</a>, <a class="el" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html" title="Face finite element.">MoFEM::FaceElementForcesAndSourcesCore</a> and more or special elements for particular type of entity, e.g. <a class="el" href="structMoFEM_1_1FatPrismElementForcesAndSourcesCore.html" title="FatPrism finite element.">MoFEM::FatPrismElementForcesAndSourcesCore</a>. The <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a> provides simplified interface to access DOFs indices, calculation of base functions and other methods specific to finite element entity dimension or finite element entity type. Above comments and insight are not needed to develop application in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. However, it could help to understand unique capabilities. If you feel confused by the number of names, don't worry, I would be confused on the first reading as well.</p>
<p>Using <a class="el" href="structMoFEM_1_1Simple.html" title="Simple interface for fast problem set-up.">MoFEM::Simple</a> interface to FES structures are created, for managing elements in domain and boundary. All FEOs are created using FEC derived from <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html" title="Volume finite element base.">MoFEM::VolumeElementForcesAndSourcesCore</a> and <a class="el" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html" title="Face finite element.">MoFEM::FaceElementForcesAndSourcesCore</a>, for domain elements and boundary elements, respectively.</p>
<p>The core functionality of domain finite element instances and boundary element instances are provided by <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a>. Application developer do not reimplement finite element, instead provides user data operators (UDO). While implementing finite element method, we can recognize outer loop over FEE, inner loop over lower dimension entities (LDE) on element, and finally most inner loop over base functions on entities and integration points. Application developer focusses his attention on most inner loops, where the physical equations of the problem are implemented. Whereas outer loops on FEE and LDE are managed internally by <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. For example, UDO can be used to integrate bilinear form (calculate elements of matrices) and linear form (elements of the right hand vector).</p>
<p>UDO can be understood as an operator which executes job executed on FEE. UDO are added/pushed to the FEO and called in sequence (order in which are pushed to finite element instance). For example, for vector or matrix assembly, finite elements entity (FEE) are iterated, then FEO is called for FEE. FEO gets data from the database about FEE, calculates base functions on integration points and other bookkeeping operations. FEO iterates over LDE and for each call sequence of UDO.</p>
<p>Hierarchy of UDO classes reflects hierarchy of FEC, where <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a> is derived from <a class="el" href="structMoFEM_1_1DataOperator.html" title="base operator to do operations at Gauss Pt. level">MoFEM::DataOperator</a>. <a class="el" href="structMoFEM_1_1DataOperator.html" title="base operator to do operations at Gauss Pt. level">MoFEM::DataOperator</a> is used by core library developers to do low level tasks on element, e.g. applying Piola Transform to base functions, etc. When application developer uses exclusively <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a> to implement his problem, then implementation is dimension independent. If dimension specific functionality, like recalculated volume of element, or normal of face is needed, then derived user operators can be used, e.g. <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a>, <a class="el" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html" title="default operator for TRI element">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a> and more, see <a class="el" href="group__mofem__forces__and__sources.html">Forces and sources</a>.</p>
<p>In this tutorial, we start with an example of creating finite element instances, i.e. FEO. This is a procedure which is repeated practically for every type of PDE in very similar way. We are using smart pointers to allocate FEO and UDO. If you are not familiar with this C++ technology, you can skip that part and jump into section about the implementation of UDO (see <a class="el" href="poisson_tut2.html#poisson_tut2_op_operators">Implementation of user data operators</a>), and come back to the following section later.</p>
<h1><a class="anchor" id="poisson_tut2_op_volume"></a>
Operators on volume elements</h1>
<p>In this example, we are using three finite element instances to integrate fields in domain, i.e. <em>domain_lhs_fe</em>, <em>domain_rhs_fe</em> and <em>domain_error</em>, to integrate matrix, the right-hand vector and error. Implementation of those finite elements is exactly the same, but different operators are added to those elements. For first two: <em>domain_lhs_fe</em> and <em>domain_rhs_fe</em>, only one operator is on the finite element. For <em>domain_error</em> three operators are run in sequence as shown in <a class="el" href="poisson_tut2.html#figure_1_operators_volume_element">Figure 1</a>.</p>
<p><a class="anchor" id="figure_1_operators_volume_element"></a></p><div class="image">
<img src="poisson_tut1_fig2.png" alt="" width="700px"/>
<div class="caption">
Figure 1. Operators of volume finite element</div></div>
<h1><a class="anchor" id="poisson_tut2_op_volume_op_face"></a>
Operators on face elements</h1>
<p>To integrate fields on body surface, we have two finite element instances, <em>boundary_lhs_fe</em> and <em>boundary_rhs_fe</em>, see <a class="el" href="poisson_tut2.html#figure_2_operators_boundary_element">Figure 2</a>.</p>
<p><a class="anchor" id="figure_2_operators_boundary_element"></a></p><div class="image">
<img src="poisson_tut1_fig3.png" alt="" width="700px"/>
<div class="caption">
Figure 2. Operators of boundary finite element</div></div>
<h1><a class="anchor" id="poisson_tut2_op_set_up"></a>
Setup of a finite element</h1>
<p>Setup of all elements used in the Poisson equation example is implemented in the class <a class="el" href="structPoissonExample_1_1CreateFiniteElements.html" title="Create finite elements instances.">PoissonExample::CreateFiniteElements</a>, here we focus attention on finite element setup for calculation of matrices and vectors, i.e. <a class="el" href="structPoissonExample_1_1CreateFiniteElements.html#ae7e856976912e3f952c8c5b96b674978" title="Create finite element to calculate matrix and vectors.">PoissonExample::CreateFiniteElements::createFEToAssembleMatrixAndVector</a>.</p>
<p>We will dissect code in <a class="el" href="structPoissonExample_1_1CreateFiniteElements.html#ae7e856976912e3f952c8c5b96b674978" title="Create finite element to calculate matrix and vectors.">PoissonExample::CreateFiniteElements::createFEToAssembleMatrixAndVector</a> </p><div class="fragment"><div class="line">domain_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(<span class="keyword">new</span> VolumeElementForcesAndSourcesCore(mField));</div>
<div class="line">boundary_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(<span class="keyword">new</span> <a class="code" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">domain_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(<span class="keyword">new</span> VolumeElementForcesAndSourcesCore(mField));</div>
<div class="line">boundary_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(<span class="keyword">new</span> <a class="code" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Set integration rule to elements instances</span></div>
<div class="line">domain_lhs_fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">domain_rhs_fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">boundary_lhs_fe-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line">boundary_rhs_fe-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Ass operators to element instances</span></div>
<div class="line"><span class="comment">// Add operator grad-grad for calualte matrix</span></div>
<div class="line">domain_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>());</div>
<div class="line"><span class="comment">// Add operator to calculate source terms</span></div>
<div class="line">domain_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpF(f_source));</div>
<div class="line"><span class="comment">// Add operator calculating constrains matrix</span></div>
<div class="line">boundary_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC(<span class="keyword">true</span>));</div>
<div class="line"><span class="comment">// Add operator calculating constrains vector</span></div>
<div class="line">boundary_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> Op_g(f_u));</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>While implementing <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> we try to avoid using "raw" pointers, and instead using "smart" pointers like boost::shared_ptr. The main reason for using smart pointers is that it makes code less prone to bugs and simplifies the implementation.</dd></dl>
<p>In the first line, we allocate finite element instances </p><div class="fragment"><div class="line">domain_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(<span class="keyword">new</span> VolumeElementForcesAndSourcesCore(mField));</div>
</div><!-- fragment --><p> and similarly for other elements. We have smart pointer of type <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a>, however allocated finite element instance is type of <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html" title="Volume finite element base.">MoFEM::VolumeElementForcesAndSourcesCore</a>. <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a> provides functionality to manage UDO. <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html" title="Volume finite element base.">MoFEM::VolumeElementForcesAndSourcesCore</a> in addition manages complexities associated with integration of volume elements. Using that class, developer is freed from the need of setting integration rule or calling functions to calculate approximation base on entities. Note for boundary elements, appropriately allocated instance is type of <a class="el" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html" title="Face finite element.">MoFEM::FaceElementForcesAndSourcesCore</a>.</p>
<p>Once we have instances of finite element created, we need to choose quadrature rule. For example to integrate term </p><p class="formulaDsp">
\[ \mathbf{K}=\int_\Omega \nabla \boldsymbol\phi \cdot \nabla \boldsymbol\phi \textrm{d}\Omega \]
</p>
<p> where \(\boldsymbol\phi\) is a base function of polynomial order \(p\), then the integrated term will be the order of \(2(p-1)\), for term in the integral above. To set integrate rule we implement function </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structVolRule.html">VolRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code" href="structVolRule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">operator()</a>(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span> p)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2*(p-1); }</div>
<div class="line">};</div>
</div><!-- fragment --><p> Function above for given polynomial order \(p\) return rank \(r=2(p-1)\) which can integrate exactly polynomial order \(p=2r+1\). Integration rule is set to finite element instances as follows </p><div class="fragment"><div class="line">domain_lhs_fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">domain_rhs_fe-&gt;getRuleHook = <a class="code" href="structVolRule.html">VolRule</a>();</div>
<div class="line">boundary_lhs_fe-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line">boundary_rhs_fe-&gt;getRuleHook = <a class="code" href="structFaceRule.html">FaceRule</a>();</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>Here we use a class with the overloaded operator to define an implicit function. This is done for convenience and future extensibility, equivalently you can do <div class="fragment"><div class="line"><span class="keywordtype">int</span> vol_rule(<span class="keywordtype">int</span>,<span class="keywordtype">int</span>,<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2*(p-1);  }</div>
</div><!-- fragment --> and then for example <div class="fragment"><div class="line">domain_lhs_fe-&gt;getRuleHook = vol_rule;</div>
</div><!-- fragment --></dd></dl>
<p>Now we add user data operators to finite element </p><div class="fragment"><div class="line">domain_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>());</div>
</div><!-- fragment --><p> Dissecting the line, first we start with explicit code </p><div class="fragment"><div class="line">boost::ptr_deque&lt;UserDataOperator&gt;&amp; sequence_of_operators = domain_lhs_fe-&gt;getOpPtrVector();</div>
</div><!-- fragment --><p> You can see now <em>getOpPtrVector</em> returns vector of pointers to operators acting on finite element lower dimension entities. Now, having vector of pointers, we are going to push operator at the end of it </p><div class="fragment"><div class="line">sequence_of_operators.push_back(<span class="keyword">new</span> <a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a>());</div>
</div><!-- fragment --><p>More interesting case is what happens in <a class="el" href="structPoissonExample_1_1CreateFiniteElements.html#ae250a14f45127e19c97e17df96252329" title="Create finite element to calculate error.">PoissonExample::CreateFiniteElements::createFEToEvaluateError</a>, we have, see <a class="el" href="poisson_tut2.html#figure_1_operators_volume_element">Figure 1</a>, <em>domain_error</em> finite element instance </p><div class="fragment"><div class="line">boost::shared_ptr&lt;VectorDouble&gt; values_at_integation_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">boost::shared_ptr&lt;MatrixDouble&gt; grad_at_integation_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">domain_error-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpCalculateScalarFieldValues(<span class="stringliteral">&quot;U&quot;</span>,values_at_integation_ptr));</div>
<div class="line">domain_error-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpCalculateScalarFieldGradient&lt;3&gt;(<span class="stringliteral">&quot;U&quot;</span>,grad_at_integation_ptr));</div>
<div class="line">domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code" href="structOpError.html">OpError</a>(f_u,g_u,values_at_integation_ptr,grad_at_integation_ptr,global_error)</div>
<div class="line">);</div>
</div><!-- fragment --><p> Dissecting above code, we start with creating matrix and vector and shared pointers to them so that passed to operators are not destroyed with the end of the scope of the function. Matrix and vector will be destroyed at the time when operators using them are destroyed. Smart pointer will do for us that job and we do not have to think about that any more. Next, we create operator <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldValues.html" title="Get value at integration points for scalar field.">MoFEM::OpCalculateScalarFieldValues</a>, it is one of the standard operators used in various implementations. It calculates field values at integration points and store those values in values_at_integation_ptr. The second operator, i.e. <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> is standard operator to calculate field gradients and store them in grad_at_integation_ptr. Classes <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldValues.html" title="Get value at integration points for scalar field.">MoFEM::OpCalculateScalarFieldValues</a> and <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> are derived from <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a> and can be used with volume and face elements. Once we have field values and field gradients, we create third operator <a class="el" href="structPoissonExample_1_1OpError.html" title="Evaluate error.">PoissonExample::OpError</a>, which takes arguments with pointers to exact function, exact function derivatives, and field gradients. With those data at hand, it calculates H1 error norm. Class <a class="el" href="structPoissonExample_1_1OpError.html" title="Evaluate error.">PoissonExample::OpError</a> is derived form <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a> and incense of it can be added only to object of <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html" title="Volume finite element base.">MoFEM::VolumeElementForcesAndSourcesCore</a>.</p>
<h1><a class="anchor" id="poisson_tut2_op_operators"></a>
Implementation of user data operators</h1>
<h2><a class="anchor" id="poisson_tut2_op_operators_grad_grad"></a>
The grad-grad operator</h2>
<p>Let's start with implementation grad-grad operator </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structPoissonExample_1_1OpK.html">PoissonExample::OpK</a>: <span class="keyword">public</span> <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">VolumeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpK.html#ac74f49cd0339b9c7a873e24edf61b129">OpK</a>(): VolumeElementForcesAndSourcesCore::<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">UserDataOperator</a>(<span class="stringliteral">&quot;U&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>,<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">OPROWCOL</a>,true);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Do calculations for give operator</span></div>
<div class="line"><span class="comment">   * @param  row_side row side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">   * @param  col_side column side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">   * @param  row_type type of row entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">   * @param  col_type type of column entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">   * @param  row_data data for row</span></div>
<div class="line"><span class="comment">   * @param  col_data data for column</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpK.html#a43ef1dd3ea49ba1a6dcd8d3f62f602b3">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> row_side,<span class="keywordtype">int</span> col_side,</div>
<div class="line">    EntityType row_type,EntityType col_type,</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data</div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    ///&lt; error code</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keywordtype">int</span> <a class="code" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>;           <span class="comment">///&lt; number of dofs on rows</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>;           <span class="comment">///&lt; number if dof on column</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> <a class="code" href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">nbIntegrationPts</a>; <span class="comment">///&lt; number of integration points</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">bool</span> <a class="code" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a>;          <span class="comment">///&lt; true if this block is on diagonal</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i',3&gt;</a> <a class="code" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>;  <span class="comment">///&lt; summit Index</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> <a class="code" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>;      <span class="comment">///&lt; local entity block matrix</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate grad-grad operator</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3">iNtegrate</a>(</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data</div>
<div class="line">  );</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Assemble local entity block matrix</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">aSsemble</a>(</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data</div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --><p> User data operator class <a class="el" href="structPoissonExample_1_1OpK.html" title="Calculate the grad-grad operator and assemble matrix.">PoissonExample::OpK</a> is derived from class <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a>, which is a generic class to work on 3d finite element entities. Class <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a> delivers methods to get the volume of finite element and give access to the data structure of the 3d element and to its quadrature points, etc.</p>
<p>Constructor of operator is </p><div class="fragment"><div class="line"><a class="code" href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">PoissonExample::OpK</a>(): <a class="code" href="namespaceMoFEM.html">MoFEM</a>::VolumeElementForcesAndSourcesCore::<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">UserDataOperator</a>(<span class="stringliteral">&quot;U&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>,OPROWCOL,true);</div>
</div><!-- fragment --><p>User data operator is used to calculate bilinear form, discrete version of it, i.e. matrix </p><p class="formulaDsp">
\[ \mathbf{K} = b(\boldsymbol\phi ,\boldsymbol\phi ) = (\nabla \boldsymbol\phi ,\nabla \boldsymbol\phi)_\Omega = \int_\Omega \nabla \boldsymbol\phi \cdot \nabla \boldsymbol\phi \textrm{d}\Omega \]
</p>
<p> The bilinear form takes two function arguments, which on discrete representation are reflected by the scalar product of base function on rows and columns, in this case. That is why we specify field name for row and column, which in this case is the same, i.e. "U". Moreover, since we integrate bilinear form, we set type of operator to OPROWCOL, which indicates that we iterate over unique combination of lower dimension entities on finite element. In our case field "U" is in the H1 space and for tetrahedra, we would iterate over entities </p><p class="formulaDsp">
\[ \mathcal{E}_\textrm{row},\mathcal{E}_\textrm{col} = \{VERTICES,EDGES \times 6,TRIAGLES \times 4,TETRAHEDRA \} \]
</p>
<p> and we have set of unique pairs, </p><p class="formulaDsp">
\[ \begin{array}{l} \mathcal{S} = \{ \left(VERTICES,VERTICES\right), \left(VERTICES,EDGE_0\right),\dots \left(VERTICES,TRIANGLE_0\right),\dots \left(VERTICES,TETRAHEDRA\right),\\ \left(EDGE_0,TRIANGLE_0\right),\dots \left(TRIANGLE_0,TETRAHEDRA\right),\dots \left(TETRAHEDRA,TETRAHEDRA\right) \} \end{array} \]
</p>
<p> The number of base functions on each of entities depends on approximation order and space, for example, see how it works for H-div and L2 space here <a class="el" href="mix_transport.html#mixtransport_assmble_matrix">Assembling matrix</a>. Since the last argument in the constructor is "true", it indicates that bilinear form is symmetric and iteration over entities is only for unique unordered pairs, i.e. pair is a set with two elements. The task of integration over entities is managed by <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a> finite element from which all entity finite elements are derived.</p>
<p>Now we can dissect overloaded function </p><div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Do calculations for give operator</span></div>
<div class="line"><span class="comment"> * @param  row_side row side number (local number) of entity on element</span></div>
<div class="line"><span class="comment"> * @param  col_side column side number (local number) of entity on element</span></div>
<div class="line"><span class="comment"> * @param  row_type type of row entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment"> * @param  col_type type of column entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment"> * @param  row_data data for row</span></div>
<div class="line"><span class="comment"> * @param  col_data data for column</span></div>
<div class="line"><span class="comment"> * @return          error code</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpK.html#a43ef1dd3ea49ba1a6dcd8d3f62f602b3">PoissonExample::OpK::doWork</a>(</div>
<div class="line">  <span class="keywordtype">int</span> row_side,<span class="keywordtype">int</span> col_side,</div>
<div class="line">  EntityType row_type,EntityType col_type,</div>
<div class="line">  <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data</div>
<div class="line">) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get number of dofs on row</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a> = row_data.getIndices().size();</div>
<div class="line">  <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span>(!<a class="code" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>) <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="comment">// get number of dofs on column</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a> = col_data.getIndices().size();</div>
<div class="line">  <span class="comment">// if no dofs on Columbia, exit nothing to do here</span></div>
<div class="line">  <span class="keywordflow">if</span>(!<a class="code" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>) <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">nbIntegrationPts</a> = <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ae3e25f06d5d182c6086de6fa449f5e76">getGaussPts</a>().size2();</div>
<div class="line">  <span class="comment">// chekk if entity block is on matrix diagonal</span></div>
<div class="line">  <span class="keywordflow">if</span>(</div>
<div class="line">    row_side==col_side&amp;&amp;</div>
<div class="line">    row_type==col_type</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a> = <span class="keyword">true</span>; <span class="comment">// yes, it os on diagonal</span></div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a> = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3">iNtegrate</a>(row_data,col_data); </div>
<div class="line">  <span class="comment">// asseble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">aSsemble</a>(row_data,col_data); </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> This is a virtual function from <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore.html" title="structure to get information form mofem into EntitiesFieldData">MoFEM::ForcesAndSourcesCore</a> is executed by finite element while iterating over lower dimension entities. As an argument passes a reference to data structures on rows and columns. Data structure <a class="el" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html" title="Data on single entity (This is passed as argument to DataOperator::doWork)">MoFEM::EntitiesFieldData::EntData</a> gives user access DOFs indices and base functions. First, we check if we have DOFs on given entity </p><div class="fragment"><div class="line">nbRows = row_data.getIndices().size();</div>
<div class="line"><span class="keywordflow">if</span>(!nbRows) <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">nbCols = col_data.getIndices().size();</div>
<div class="line"><span class="keywordflow">if</span>(!nbCols) <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
</div><!-- fragment --><p> if not, we exit the function. Next we get the number of integration points </p><div class="fragment"><div class="line">nbIntegrationPts = getGaussPts().size2();</div>
</div><!-- fragment --><p> and check if local entity matrix is on diagonal </p><div class="fragment"><div class="line"><span class="keywordflow">if</span>(</div>
<div class="line">  row_side==col_side&amp;&amp;</div>
<div class="line">  row_type==col_type</div>
<div class="line">) {</div>
<div class="line">  isDiag = <span class="keyword">true</span>;</div>
<div class="line">} <span class="keywordflow">else</span> {</div>
<div class="line">  isDiag = <span class="keyword">false</span>;</div>
</div><!-- fragment --><p> This is when a type of entity and its side number (local index of the entity on the finite element) are both the same. Once we have this generic information, we call function to integrate local entity matrix and assemble results to global matrix </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iNtegrate(row_data,col_data); </div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> aSsemble(row_data,col_data); </div>
</div><!-- fragment --><p>The <a class="el" href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3" title="Integrate grad-grad operator.">PoissonExample::OpK::iNtegrate</a> method </p><div class="fragment"><div class="line"><span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> iNtegrate(</div>
<div class="line">  <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data</div>
<div class="line">) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// set size of local entity bock</span></div>
<div class="line">  locMat.resize(nbRows,nbCols,<span class="keyword">false</span>);</div>
<div class="line">  <span class="comment">// clear matrux</span></div>
<div class="line">  locMat.clear();</div>
<div class="line">  <span class="comment">// get element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get integration weigths</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="comment">// get base function gradient on rows</span></div>
<div class="line">  <span class="keyword">auto</span> t_row_grad = row_data.getFTensor1DiffN&lt;3&gt;();</div>
<div class="line">  <span class="comment">// loop over integration points</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nbIntegrationPts;gg++) {</div>
<div class="line">    ...</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> We can note that first the size of a local matrix is set, then a volume of finite element obtained, next, we get integration weight and gradient of base functions. Finally, we iterate over integration points </p><div class="fragment"><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nbIntegrationPts;gg++) {</div>
<div class="line">  <span class="comment">// take into account Jacobian</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = t_w*vol;</div>
<div class="line">  <span class="comment">// take fist element to local matrix</span></div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;double*&gt;</a> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>(&amp;*locMat.data().begin());</div>
<div class="line">  <span class="comment">// loop over rows base functions</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rr = 0;rr!=nbRows;rr++) {</div>
<div class="line">    <span class="comment">// get column base functions gradient at gauss point gg</span></div>
<div class="line">    <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double*,3&gt;</a> t_col_grad = col_data.getFTensor1DiffN&lt;3&gt;(gg,0);</div>
<div class="line">    <span class="comment">// loop over columbs</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> cc = 0;cc!=nbCols;cc++) {</div>
<div class="line">      <span class="comment">// calculate element of local matrix</span></div>
<div class="line">      <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += alpha*(t_row_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)*t_col_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">      ++t_col_grad; <span class="comment">// move to another gradient of base function on column</span></div>
<div class="line">      ++<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;  <span class="comment">// move to another element of local matrix in column</span></div>
<div class="line">    }</div>
<div class="line">    ++t_row_grad; <span class="comment">// move to another element of gradient of base function on row</span></div>
<div class="line">  }</div>
<div class="line">  ++t_w; <span class="comment">// move to another integration weight</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> We are using <a class="el" href="group__ftensor.html">Tensor template library</a> here, to iterate over weights and base functions. The essential part of this function is </p><div class="fragment"><div class="line"><a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += alpha*(t_row_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)*t_col_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
</div><!-- fragment --><p> where the grad-grad term is added to the local matrix.</p>
<p>Finally, we assemble local matrix using <a class="el" href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a" title="Assemble local entity block matrix.">PoissonExample::OpK::aSsemble</a> </p><div class="fragment"><div class="line"><span class="keyword">inline</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">PoissonExample::OpK::aSsemble</a>(</div>
<div class="line">  <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;col_data</div>
<div class="line">) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span>* row_indices = &amp;*row_data.getIndices().data().begin();</div>
<div class="line">  <span class="comment">// get pointer to first global index on column</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span>* col_indices = &amp;*col_data.getIndices().data().begin();</div>
<div class="line">  <span class="comment">// assemble local matrix</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(</div>
<div class="line">    <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a102f04c38d06fcaaadd87a1ddbb6232d">getFEMethod</a>()-&gt;ksp_B,</div>
<div class="line">    <a class="code" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>,row_indices,</div>
<div class="line">    <a class="code" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>,col_indices,</div>
<div class="line">    &amp;*<a class="code" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.data().begin(),ADD_VALUES</div>
<div class="line">  ); </div>
<div class="line">  <span class="keywordflow">if</span>(!<a class="code" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a>) {</div>
<div class="line">    <span class="comment">// if not diagonal term and since global matrix is symmetric assemble</span></div>
<div class="line">    <span class="comment">// transpose term.</span></div>
<div class="line">    <a class="code" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a> = trans(<a class="code" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(</div>
<div class="line">      <a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a102f04c38d06fcaaadd87a1ddbb6232d">getFEMethod</a>()-&gt;ksp_B,</div>
<div class="line">      <a class="code" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>,col_indices,</div>
<div class="line">      <a class="code" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>,row_indices,</div>
<div class="line">      &amp;*<a class="code" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.data().begin(),ADD_VALUES</div>
<div class="line">    ); </div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> where the symmetry of the matrix is exploited.</p>
<h2><a class="anchor" id="poisson_tut2_op_operators_vf"></a>
The right hand side</h2>
<p>The right-hand operator is constructed first by making a generic class, see <a class="el" href="structPoissonExample_1_1OpBaseRhs.html" title="template class for integration oh the right hand side">PoissonExample::OpBaseRhs</a>. It is a template class with very exact structure to one shown for the grad-grad operator. However, is constructed differently </p><div class="fragment"><div class="line"><a class="code" href="structPoissonExample_1_1OpBaseRhs.html">PoissonExample::OpBaseRhs</a>(<span class="keyword">const</span> std::string <a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>):</div>
<div class="line"><a class="code" href="classOPBASE.html">OPBASE</a>(<a class="code" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code" href="classOPBASE.html">OPBASE</a>::OPROW) {</div>
<div class="line">}</div>
</div><!-- fragment --><p> where <a class="el" href="classOPBASE.html">OPBASE</a> is a template and is replaced by VolumeElementForcesAndSourcesCore::UserDataOperator or FaceElementForcesAndSourcesCore::UserDataOperator when we integrate source term or constraints, respectively. It takes only argument <em>field_name</em>, which can be "U" or "L" for integration over domain and boundary, respectively. This operator is type OPROW, that means its iterator is over entities </p><p class="formulaDsp">
\[ \mathcal{E}_\textrm{row},\mathcal{E}_\textrm{col} = \{VERTICES,EDGES \times 6,TRIAGLES \times 4,TETRAHEDRA \} \]
</p>
<p> Another element is an overloaded <a class="el" href="structPoissonExample_1_1OpBaseRhs.html#a7e0053c987e075cbcd68b4d567115630" title="This function is called by finite element.">PoissonExample::OpBaseRhs::doWork</a> function </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a7e0053c987e075cbcd68b4d567115630">PoissonExample::OpBaseRhs::doWork</a>(</div>
<div class="line">  <span class="keywordtype">int</span> row_side,EntityType row_type,<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;row_data</div>
<div class="line">) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get number of dofs on row</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a> = row_data.getIndices().size();</div>
<div class="line">  <span class="keywordflow">if</span>(!<a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>) <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  <span class="comment">// get number of integration points</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a> = OPBASE::getGaussPts().size2();</div>
<div class="line">  <span class="comment">// integrate local vector</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#afc2927f382c9aa8af5c414dc81d4becb">iNtegrate</a>(row_data); </div>
<div class="line">  <span class="comment">// assemble local vector</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a436705aa66999557e70e43853b4dc320">aSsemble</a>(row_data); </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> which has similar for loop to one shown for the grad-grad operator, however, this time base functions and indices are needed on rows only.</p>
<p>With generic operator <a class="el" href="structPoissonExample_1_1OpBaseRhs.html" title="template class for integration oh the right hand side">PoissonExample::OpBaseRhs</a>, we can construct operator for the integration of source term </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structPoissonExample_1_1OpF.html">PoissonExample::OpF</a>: <span class="keyword">public</span> <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#aa8b654e566308ad73100a9e7784faf73">OpBaseRhs</a>&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a class="code" href="classdouble.html">double</a> (<span class="keyword">const</span> <span class="keywordtype">double</span>,<span class="keyword">const</span> <span class="keywordtype">double</span>,<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpF.html#a56bfe0981be52cfc83f9d1b83334d9ee">OpF</a>(<a class="code" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a> f_source):</div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpBaseRhs.html#aa8b654e566308ad73100a9e7784faf73">OpBaseRhs</a>&lt;VolumeElementForcesAndSourcesCore::<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">UserDataOperator</a>&gt;(<span class="stringliteral">&quot;U&quot;</span>),</div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>(f_source) {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line"> </div>
<div class="line">  </div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> <a class="code" href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">NX</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> <a class="code" href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">NY</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> <a class="code" href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">NZ</a>;</div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a> <a class="code" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> <a class="code" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpF.html#a935925a0321aa4e03a740d1f5056de0d">iNtegrate</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpF.html#a303a9491f132ded9c0ffce846bd4bd59">aSsemble</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data);</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --><p>The constructor of this operator takes as an argument pointer to function where Laplacian is defined. Then the local right-hand side vector is integrated </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpF.html#a935925a0321aa4e03a740d1f5056de0d">PoissonExample::OpF::iNtegrate</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// set size of local vector</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.resize(<a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>,<span class="keyword">false</span>);</div>
<div class="line">  <span class="comment">// clear local entity vector</span></div>
<div class="line">  <a class="code" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.clear();</div>
<div class="line">  <span class="comment">// get finite element volume</span></div>
<div class="line">  <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get integration weights</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="comment">// get base functions on entity</span></div>
<div class="line">  <span class="keyword">auto</span> t_v = data.getFTensor0N();</div>
<div class="line">  <span class="comment">// get coordinates at integration points</span></div>
<div class="line">  <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">  <span class="comment">// loop over all integration points</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=<a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>;gg++) {</div>
<div class="line">    <span class="comment">// evaluate constant term</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = vol*t_w*<a class="code" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>(t_coords(<a class="code" href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">NX</a>),t_coords(<a class="code" href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">NY</a>),t_coords(<a class="code" href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">NZ</a>));</div>
<div class="line">    <span class="comment">// get element of local vector</span></div>
<div class="line">    <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;double*&gt;</a> t_a(&amp;*<a class="code" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.data().begin());</div>
<div class="line">    <span class="comment">// loop over base functions</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rr = 0;rr!=<a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>;rr++) {</div>
<div class="line">      <span class="comment">// add to local vector source term</span></div>
<div class="line">      t_a -= alpha*t_v;</div>
<div class="line">      ++t_a;  <span class="comment">// move to next element of local vector</span></div>
<div class="line">      ++t_v;  <span class="comment">// move to next base function</span></div>
<div class="line">    }</div>
<div class="line">    ++t_w;  <span class="comment">// move to next integration weight</span></div>
<div class="line">    ++t_coords; <span class="comment">// move to next physical coordinates at integration point</span></div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> and assembled </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpF.html#a303a9491f132ded9c0ffce846bd4bd59">PoissonExample::OpF::aSsemble</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// get global indices of local vector</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span>* indices = &amp;*data.getIndices().data().begin();</div>
<div class="line">  <span class="comment">// get values from local vector</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span>* vals = &amp;*<a class="code" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.data().begin();</div>
<div class="line">  <span class="comment">// assemble vector</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line">    getFEMethod()-&gt;ksp_f,<a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>,indices,vals,ADD_VALUES</div>
<div class="line">  ); </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> A similar approach is applied to integrate terms associated with Lagrange multipliers. The key advantage of the presented approach is that a difficult problem is broken into small parts, which can be tested and reused for different problems and contexts.</p>
<h2><a class="anchor" id="poisson_tut2_op_operators_error"></a>
Error calculation</h2>
<p>The error operator is derived from <a class="el" href="structPoissonExample_1_1OpBaseRhs.html" title="template class for integration oh the right hand side">PoissonExample::OpBaseRhs</a> class. Here we will focus on <a class="el" href="structPoissonExample_1_1OpError.html#a94c3d65735d75b6a15f4ce997b62fe26" title="Integrate error.">PoissonExample::OpError::iNtegrate</a> and <a class="el" href="structPoissonExample_1_1OpError.html#afefb3352b6edc0930da3fa9051eb55ea" title="Assemble error.">PoissonExample::OpError::aSsemble</a>. <a class="el" href="structPoissonExample_1_1OpError.html" title="Evaluate error.">PoissonExample::OpError</a> is third in sequence. First function values and function gradient are calculated for integration points using <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldValues.html" title="Get value at integration points for scalar field.">MoFEM::OpCalculateScalarFieldValues</a> and <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> respectively. <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldValues.html" title="Get value at integration points for scalar field.">MoFEM::OpCalculateScalarFieldValues</a> and <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> use operators which you find in other examples, and can be used in the context of volume, face, edge and vertex elements.</p>
<p>Constructor of <a class="el" href="structPoissonExample_1_1OpError.html" title="Evaluate error.">PoissonExample::OpError</a> is as follows </p><div class="fragment"><div class="line"><a class="code" href="structPoissonExample_1_1OpError.html">PoissonExample::OpError</a>(</div>
<div class="line">  UVal u_value,</div>
<div class="line">  GVal g_value,</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt;&amp; field_vals,</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt;&amp; grad_vals,</div>
<div class="line">  <a class="code" href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">Vec</a> global_error</div>
<div class="line">):</div>
<div class="line">OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::<a class="code" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">UserDataOperator</a>&gt;(<span class="stringliteral">&quot;ERROR&quot;</span>),</div>
<div class="line">globalError(global_error),</div>
<div class="line">uValue(u_value),</div>
<div class="line">gValue(g_value),</div>
<div class="line">fieldVals(field_vals),</div>
<div class="line">gradVals(grad_vals) {</div>
<div class="line">}</div>
</div><!-- fragment --><p> Note that it takes a function pointer to evaluate exact function values and function gradient at integration points. Next, approximate function values and gradients, in shared pointer to vector and matrix, respectively. At last, PETSc vector is taken to accumulate values from all processes.</p>
<p>This operator is type OPROW, and is evaluated for ERROR field which is in L2 space, as results this operator is executed only for set of entities </p><p class="formulaDsp">
\[ \mathcal{E}_\textrm{row} = \{ TETRAHEDRA \} \]
</p>
<p> with one element only, i.e. TETRAHEDRA.</p>
<p>To integrate error, we have the following code </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpError.html#a94c3d65735d75b6a15f4ce997b62fe26">PoissonExample::OpError::iNtegrate</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// clear field dofs</span></div>
<div class="line">  data.getFieldData().clear();</div>
<div class="line">  <span class="comment">// get volume of element</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">  <span class="comment">// get integration weight</span></div>
<div class="line">  <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="comment">// get solution at integration point</span></div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;double*&gt;</a> t_u = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*<a class="code" href="structPoissonExample_1_1OpError.html#a91a102c742d515db8819fa42ed70b843">fieldVals</a>);</div>
<div class="line">  <span class="comment">// get solution at integration point</span></div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double*,3&gt;</a> t_grad = getFTensor1FromMat&lt;3&gt;(*<a class="code" href="structPoissonExample_1_1OpError.html#a3f5e82da6a1ad7ffc7bd609558fc8c3e">gradVals</a>);</div>
<div class="line">  <span class="comment">// get coordinates at integration point</span></div>
<div class="line">  <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">  <span class="comment">// keep exact gradient and error or gradient</span></div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double,3&gt;</a> t_exact_grad,t_error_grad;</div>
<div class="line">  <span class="comment">// integrate over</span></div>
<div class="line">  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=<a class="code" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>;gg++) {</div>
<div class="line">    <span class="keywordtype">double</span> alpha = vol*t_w;</div>
<div class="line">    <span class="comment">// calculate exact value</span></div>
<div class="line">    <span class="keywordtype">double</span> exact_u = <a class="code" href="structPoissonExample_1_1OpError.html#a16bb56bc60331d302a0b3f6feb825671">uValue</a>(t_coords(<a class="code" href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">NX</a>),t_coords(<a class="code" href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">NY</a>),t_coords(<a class="code" href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">NZ</a>));</div>
<div class="line">    <span class="comment">// calculate exact gradient</span></div>
<div class="line">    t_exact_grad = <a class="code" href="structPoissonExample_1_1OpError.html#a8733815305e402bdb988460188f689a0">gValue</a>(t_coords(<a class="code" href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">NX</a>),t_coords(<a class="code" href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">NY</a>),t_coords(<a class="code" href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">NZ</a>));</div>
<div class="line">    <span class="comment">// calculate gradient error</span></div>
<div class="line">    t_error_grad(<a class="code" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>) = t_grad(<a class="code" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>)-t_exact_grad(<a class="code" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>);</div>
<div class="line">    <span class="comment">// error</span></div>
<div class="line">    <span class="keywordtype">double</span> error = pow(t_u-exact_u,2)+t_error_grad(<a class="code" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>)*t_error_grad(<a class="code" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>);</div>
<div class="line">    <span class="comment">// iterate over base functions</span></div>
<div class="line">    data.getFieldData()[0] += alpha*error;</div>
<div class="line">    ++t_w;      <span class="comment">// move to next integration point</span></div>
<div class="line">    ++t_u;      <span class="comment">// next value of function at integration point</span></div>
<div class="line">    ++t_grad;   <span class="comment">// next gradient at integration point</span></div>
<div class="line">    ++t_coords; <span class="comment">// next coordinate at integration point</span></div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note how we get approximate values at integration points. First, we get tensors of rank 0 and rank 1, for field values and gradients, respectively </p><div class="fragment"><div class="line"><span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"><span class="keyword">auto</span> t_u = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(*fieldVals);</div>
<div class="line"><span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*gradVals);</div>
<div class="line"><span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
</div><!-- fragment --><p> and then iterate over integration points </p><div class="fragment"><div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nbIntegrationPts;gg++) {</div>
<div class="line">  ...</div>
<div class="line">  ++t_w;      <span class="comment">// move to next integration point</span></div>
<div class="line">  ++t_u;      <span class="comment">// next value of function at integration point</span></div>
<div class="line">  ++t_grad;   <span class="comment">// next gradient at integration point</span></div>
<div class="line">  ++t_coords; <span class="comment">// next coordinate at integration point</span></div>
<div class="line">}</div>
</div><!-- fragment --><p> using ++t_u and ++t_grad to move tensors to the next integration point. In similar way, coordinates of integration points are iterated. Functions <a class="el" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d" title="Get tensor rank 0 (scalar) form data vector.">MoFEM::getFTensor0FromVec</a> and <a class="el" href="namespaceMoFEM.html#adeebc8966bfbcb1130d05967ca2a9c7b" title="Get tensor rank 1 (vector) form data matrix.">MoFEM::getFTensor1FromMat</a> take vector or matrix as an argument and express it using tensor data structure. Function <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a92c8fe110a8151058947b4a43803755f" title="Get integration weights.">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator::getFTensor0IntegrationWeight</a> and <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#afa626d11d7b5f118c976e995938464bb" title="Get coordinates at integration points assuming linear geometry.">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator::getFTensor1CoordsAtGaussPts</a> are overloaded function for volume operator, to get integration weight and coordinates respectively. See <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a> for available functions from volume operator.</p>
<p>Next, we accumulate error for all elements and processors </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPoissonExample_1_1OpError.html#afefb3352b6edc0930da3fa9051eb55ea">PoissonExample::OpError::aSsemble</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="comment">// set error on mesh</span></div>
<div class="line">  data.getFieldDofs()[0]-&gt;getFieldData() = sqrt(data.getFieldData()[0]);</div>
<div class="line">  <span class="comment">// assemble vector to global error</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(<a class="code" href="structPoissonExample_1_1OpError.html#a1351ee7b257e586ffcfc6e83194103cc">globalError</a>,0,data.getFieldData()[0],ADD_VALUES); </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> the line </p><div class="fragment"><div class="line">data.getFieldDofs()[0]-&gt;getFieldData() = sqrt(data.getFieldData()[0]);</div>
</div><!-- fragment --><p> set values to <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database on ERROR field dofs. Next we assemble contributor to global error vector </p><div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(globalError,0,data.getFieldData()[0],ADD_VALUES); </div>
</div><!-- fragment --><h1><a class="anchor" id="poisson_tut2_exercise"></a>
Exercise</h1>
<ul>
<li>Exercise 1: Change problem to the Darcy flow problem.</li>
<li>Exercise 2: Calculate error L2 and semi norm H1 of the error. </li>
</ul>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="aelastic_8cpp_html_aefa6a347aab3bc50a8c1b6b4aa0f1e60"><div class="ttname"><a href="elastic_8cpp.html#aefa6a347aab3bc50a8c1b6b4aa0f1e60">OpK</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpGradSymTensorGrad&lt; BASE_DIM, SPACE_DIM, SPACE_DIM, 0 &gt; OpK</div><div class="ttdoc">[Define entities]</div><div class="ttdef"><b>Definition:</b> <a href="elastic_8cpp_source.html#l00039">elastic.cpp:39</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html">PoissonExample::OpBaseRhs</a></div><div class="ttdoc">template class for integration oh the right hand side</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00164">PoissonOperators.hpp:164</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a1351ee7b257e586ffcfc6e83194103cc"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a1351ee7b257e586ffcfc6e83194103cc">PoissonExample::OpError::globalError</a></div><div class="ttdeci">Vec globalError</div><div class="ttdoc">ghost vector with global (integrated over volume) error</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00523">PoissonOperators.hpp:523</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="astructOpError_html"><div class="ttname"><a href="structOpError.html">OpError</a></div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00061">initial_diffusion.cpp:61</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a91a102c742d515db8819fa42ed70b843"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a91a102c742d515db8819fa42ed70b843">PoissonExample::OpError::fieldVals</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; fieldVals</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00532">PoissonOperators.hpp:532</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:8</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html"><div class="ttname"><a href="structPoissonExample_1_1OpK.html">PoissonExample::OpK</a></div><div class="ttdoc">Calculate the grad-grad operator and assemble matrix.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00028">PoissonOperators.hpp:28</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a8733815305e402bdb988460188f689a0"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a8733815305e402bdb988460188f689a0">PoissonExample::OpError::gValue</a></div><div class="ttdeci">GVal gValue</div><div class="ttdoc">function with exact solution for gradient</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00530">PoissonOperators.hpp:530</a></div></div>
<div class="ttc" id="astructVolRule_html"><div class="ttname"><a href="structVolRule.html">VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00088">simple_interface.cpp:88</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">MoFEM::ForcesAndSourcesCore::UserDataOperator::OPROWCOL</a></div><div class="ttdeci">@ OPROWCOL</div><div class="ttdoc">operator doWork is executed on FE rows &amp;columns</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00569">ForcesAndSourcesCore.hpp:569</a></div></div>
<div class="ttc" id="aclassOPBASE_html"><div class="ttname"><a href="classOPBASE.html">OPBASE</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a43c37be2c702f6c5a6e5db862abfd5fc"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">PoissonExample::OpF::NZ</a></div><div class="ttdeci">FTensor::Number&lt; 2 &gt; NZ</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00232">PoissonOperators.hpp:232</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_afc2927f382c9aa8af5c414dc81d4becb"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#afc2927f382c9aa8af5c414dc81d4becb">PoissonExample::OpBaseRhs::iNtegrate</a></div><div class="ttdeci">virtual MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)=0</div><div class="ttdoc">Class dedicated to integrate operator.</div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_ae3e25f06d5d182c6086de6fa449f5e76"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ae3e25f06d5d182c6086de6fa449f5e76">MoFEM::ForcesAndSourcesCore::UserDataOperator::getGaussPts</a></div><div class="ttdeci">MatrixDouble &amp; getGaussPts()</div><div class="ttdoc">matrix of integration (Gauss) points for Volume Element</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l01236">ForcesAndSourcesCore.hpp:1236</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a7e0053c987e075cbcd68b4d567115630"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a7e0053c987e075cbcd68b4d567115630">PoissonExample::OpBaseRhs::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntitiesFieldData::EntData &amp;row_data)</div><div class="ttdoc">This function is called by finite element.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00175">PoissonOperators.hpp:175</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a1748266c75e0908089cffccd3c694df6"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">PoissonExample::OpF::locVec</a></div><div class="ttdeci">VectorDouble locVec</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00235">PoissonOperators.hpp:235</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a8c40a8bd41503c9ee6bbaa5611918b0a"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">PoissonExample::OpK::nbIntegrationPts</a></div><div class="ttdeci">int nbIntegrationPts</div><div class="ttdoc">number of integration points</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00079">PoissonOperators.hpp:79</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Number_html"><div class="ttname"><a href="classFTensor_1_1Number.html">FTensor::Number&lt; 0 &gt;</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a935925a0321aa4e03a740d1f5056de0d"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a935925a0321aa4e03a740d1f5056de0d">PoissonExample::OpF::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate local entity vector.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00242">PoissonOperators.hpp:242</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_abb4794c73c5ee3f4f031613c0d79a27e"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">PoissonExample::OpF::NY</a></div><div class="ttdeci">FTensor::Number&lt; 1 &gt; NY</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00231">PoissonOperators.hpp:231</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_ade7157aa42faac4aa2a798ef169fcfb5"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">PoissonExample::OpError::NX</a></div><div class="ttdeci">FTensor::Number&lt; 0 &gt; NX</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00525">PoissonOperators.hpp:525</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a89da441abf8576f1a9f789d934258fbf"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">PoissonExample::OpK::locMat</a></div><div class="ttdeci">MatrixDouble locMat</div><div class="ttdoc">local entity block matrix</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00083">PoissonOperators.hpp:83</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a3b9ff6d399d5abc8e0edc7a8b55a6d7d"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">PoissonExample::OpK::nbCols</a></div><div class="ttdeci">int nbCols</div><div class="ttdoc">number if dof on column</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00078">PoissonOperators.hpp:78</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::ForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00549">ForcesAndSourcesCore.hpp:549</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aa464ad90a188180427136b22e078ec7d"><div class="ttname"><a href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">MoFEM::getFTensor0FromVec</a></div><div class="ttdeci">static auto getFTensor0FromVec(ublas::vector&lt; T, A &gt; &amp;data)</div><div class="ttdoc">Get tensor rank 0 (scalar) form data vector.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l00135">Templates.hpp:135</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a9f90a4a852c7cb1c66b67da66c292ada"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">PoissonExample::OpF::fSource</a></div><div class="ttdeci">FSource fSource</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00233">PoissonOperators.hpp:233</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_aaa779f6842211bf1a0b88d8b1712eece"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">PoissonExample::OpK::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 3 &gt; i</div><div class="ttdoc">summit Index</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00082">PoissonOperators.hpp:82</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_ac74f49cd0339b9c7a873e24edf61b129"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#ac74f49cd0339b9c7a873e24edf61b129">PoissonExample::OpK::OpK</a></div><div class="ttdeci">OpK(bool symm=true)</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00030">PoissonOperators.hpp:30</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a56bfe0981be52cfc83f9d1b83334d9ee"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a56bfe0981be52cfc83f9d1b83334d9ee">PoissonExample::OpF::OpF</a></div><div class="ttdeci">OpF(FSource f_source)</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00225">PoissonOperators.hpp:225</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_aa8b654e566308ad73100a9e7784faf73"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#aa8b654e566308ad73100a9e7784faf73">PoissonExample::OpBaseRhs&lt; VolumeElementForcesAndSourcesCore::UserDataOperator &gt;::OpBaseRhs</a></div><div class="ttdeci">OpBaseRhs(const std::string field_name)</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00166">PoissonOperators.hpp:166</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a75a3dd953a0e8765942f4e6052b5c91c"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">PoissonExample::OpError::NZ</a></div><div class="ttdeci">FTensor::Number&lt; 2 &gt; NZ</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00527">PoissonOperators.hpp:527</a></div></div>
<div class="ttc" id="astructFaceRule_html"><div class="ttname"><a href="structFaceRule.html">FaceRule</a></div><div class="ttdoc">Set integration rule to boundary elements.</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00091">simple_interface.cpp:91</a></div></div>
<div class="ttc" id="astructVolRule_html_a6d7b2f53d4d1a0251ea349cfc7f1f637"><div class="ttname"><a href="structVolRule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">VolRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition:</b> <a href="simple__interface_8cpp_source.html#l00089">simple_interface.cpp:89</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_aa3707c83acb519472473e7d121a7ecec"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">PoissonExample::OpError::NY</a></div><div class="ttdeci">FTensor::Number&lt; 1 &gt; NY</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00526">PoissonOperators.hpp:526</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a1058045ce8043b0c29196a52100e6959"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">PoissonExample::OpK::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">&lt; error code</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00077">PoissonOperators.hpp:77</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a7917a5778c46a3fb1d572d13972b7747"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">PoissonExample::OpError::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 3 &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00528">PoissonOperators.hpp:528</a></div></div>
<div class="ttc" id="aclassFaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a1342a5bb82a44eb578a7246723649d11"><div class="ttname"><a href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a></div><div class="ttdeci">EntitiesFieldData::EntData EntData</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00037">child_and_parent.cpp:37</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a16bb56bc60331d302a0b3f6feb825671"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a16bb56bc60331d302a0b3f6feb825671">PoissonExample::OpError::uValue</a></div><div class="ttdeci">UVal uValue</div><div class="ttdoc">function with exact solution</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00529">PoissonOperators.hpp:529</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', 3 &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator_html_a102f04c38d06fcaaadd87a1ddbb6232d"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#a102f04c38d06fcaaadd87a1ddbb6232d">MoFEM::ForcesAndSourcesCore::UserDataOperator::getFEMethod</a></div><div class="ttdeci">const FEMethod * getFEMethod() const</div><div class="ttdoc">Return raw pointer to Finite Element Method object.</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l01042">ForcesAndSourcesCore.hpp:1042</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html"><div class="ttname"><a href="structPoissonExample_1_1OpF.html">PoissonExample::OpF</a></div><div class="ttdoc">Operator calculate source term,.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00219">PoissonOperators.hpp:219</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a3f5e82da6a1ad7ffc7bd609558fc8c3e"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a3f5e82da6a1ad7ffc7bd609558fc8c3e">PoissonExample::OpError::gradVals</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; gradVals</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00533">PoissonOperators.hpp:533</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_ab78619ca7e4a303ac2313930dffecd7a"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">PoissonExample::OpK::aSsemble</a></div><div class="ttdeci">virtual MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Assemble local entity block matrix.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00137">PoissonOperators.hpp:137</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor0_html"><div class="ttname"><a href="classFTensor_1_1Tensor0.html">FTensor::Tensor0</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor0_8hpp_source.html#l00016">Tensor0.hpp:16</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="anamespaceEigenMatrix_html_a34cd82caee17a35f38d6df0cf87ee75b"><div class="ttname"><a href="namespaceEigenMatrix.html#a34cd82caee17a35f38d6df0cf87ee75b">EigenMatrix::Vec</a></div><div class="ttdeci">const FTensor::Tensor2&lt; T, Dim, Dim &gt; Vec</div><div class="ttdef"><b>Definition:</b> <a href="MatrixFunction_8hpp_source.html#l00066">MatrixFunction.hpp:66</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a870e8adc242ac26e7e7da47bbea995a2"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">PoissonExample::OpK::isDiag</a></div><div class="ttdeci">bool isDiag</div><div class="ttdoc">true if this block is on diagonal</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00080">PoissonOperators.hpp:80</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_ad9564a0f63832bb0069d064ffae44eee"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">PoissonExample::OpF::NX</a></div><div class="ttdeci">FTensor::Number&lt; 0 &gt; NX</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00230">PoissonOperators.hpp:230</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a0ab73b3e1778e7f0a4b71874411f7fb3"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3">PoissonExample::OpK::iNtegrate</a></div><div class="ttdeci">virtual MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Integrate grad-grad operator.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00091">PoissonOperators.hpp:91</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a436705aa66999557e70e43853b4dc320"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a436705aa66999557e70e43853b4dc320">PoissonExample::OpBaseRhs::aSsemble</a></div><div class="ttdeci">virtual MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)=0</div><div class="ttdoc">Class dedicated to assemble operator to global system vector.</div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a94c3d65735d75b6a15f4ce997b62fe26"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a94c3d65735d75b6a15f4ce997b62fe26">PoissonExample::OpError::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate error.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00538">PoissonOperators.hpp:538</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a303a9491f132ded9c0ffce846bd4bd59"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a303a9491f132ded9c0ffce846bd4bd59">PoissonExample::OpF::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">assemble local entity vector to the global right hand side</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00282">PoissonOperators.hpp:282</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a43ef1dd3ea49ba1a6dcd8d3f62f602b3"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a43ef1dd3ea49ba1a6dcd8d3f62f602b3">PoissonExample::OpK::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Do calculations for give operator.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00044">PoissonOperators.hpp:44</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_afefb3352b6edc0930da3fa9051eb55ea"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#afefb3352b6edc0930da3fa9051eb55ea">PoissonExample::OpError::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Assemble error.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00578">PoissonOperators.hpp:578</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html"><div class="ttname"><a href="structPoissonExample_1_1OpError.html">PoissonExample::OpError</a></div><div class="ttdoc">Evaluate error.</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00494">PoissonOperators.hpp:494</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a279399b0c2e4b596c33f6cdc344695be"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">PoissonExample::OpBaseRhs::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">&lt; error code</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00207">PoissonOperators.hpp:207</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a3147299c39a32de4e3efd0d05d2e381d"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">PoissonExample::OpBaseRhs::nbIntegrationPts</a></div><div class="ttdeci">int nbIntegrationPts</div><div class="ttdoc">number of integration points</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00208">PoissonOperators.hpp:208</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a9995d25be251f57ba72526331fc98f55"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">PoissonExample::OpF::FSource</a></div><div class="ttdeci">boost::function&lt; double(const double, const double, const double)&gt; FSource</div><div class="ttdef"><b>Definition:</b> <a href="PoissonOperators_8hpp_source.html#l00223">PoissonOperators.hpp:223</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>