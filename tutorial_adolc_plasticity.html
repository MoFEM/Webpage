<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: VEC-7: Automatic Differentiation for Plasticity</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">VEC-7: Automatic Differentiation for Plasticity </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#adolc_plasticity_installation">Installation</a></li>
<li class="level1"><a href="#adolc_plasticity_specification">Tutorial program specification</a></li>
<li class="level1"><a href="#adolc_plasticity_theory">Theory and problem formulation</a><ul><ul><li class="level3"><a href="#adolc_plasticity_introduction">Introduction</a></li>
</ul>
<li class="level2"><a href="#adolc_plasticity_cloaset_point_projection">Closet point projection algorithm</a><ul><li class="level3"><a href="#adolc_plasticity_elastic_strain">Additive strain decomposition</a></li>
<li class="level3"><a href="#adolc_plasticity_constitutive_equation">Constitutive relations</a></li>
<li class="level3"><a href="#adolc_plasticity_constraints">Constraints</a></li>
<li class="level3"><a href="#adolc_plasticity_evolution">Evolution functions</a></li>
<li class="level3"><a href="#adolc_plasticity_residual">Residual</a></li>
<li class="level3"><a href="#adolc_plasticity_algebraic_tangent">Algorithmic tangent matrix</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#adolc_bbar">B-bar method</a></li>
<li class="level1"><a href="#adolc_materoal_models">Material models</a><ul><li class="level2"><a href="#adolc_auxiliary_functions">Auxiliary functions</a></li>
<li class="level2"><a href="#adolc_plasticity_von_mises">J2 plasticity</a><ul><li class="level3"><a href="#adolc_plasticity_von_mises_free">Free energy density</a></li>
<li class="level3"><a href="#adolc_plasticity_von_mises_yield_function">Yield function and flow potential</a></li>
</ul>
</li>
<li class="level2"><a href="#adolc_plasticity_von_mises_plane_stress">J2 plasticity in plane stress</a></li>
<li class="level2"><a href="#adolc_plasticity_paraboloidal">Paraboloidal model</a><ul><li class="level3"><a href="#adolc_plasticity_paraboloidal_free">Free energy density</a></li>
<li class="level3"><a href="#adolc_plasticity_paraboloidal_yield_function">Yield function</a></li>
<li class="level3"><a href="#adolc_plasticity_paraboloidal_flow">Flow potential</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#adolc_plasticity_assembly">Assembly and integration</a><ul><li class="level2"><a href="#adolc_plasticity_assembly_assembly">Assembly</a></li>
<li class="level2"><a href="#adolc_plasticity_assembly_history">Updating history</a></li>
<li class="level2"><a href="#adolc_plasticity_assembly_postprocessing">Postprocessing</a></li>
</ul>
</li>
<li class="level1"><a href="#adolc_plasticity_example">Example</a></li>
<li class="level1"><a href="#adolc_how_to_cite">How to cite?</a></li>
<li class="level1"><a href="#adolc_plasticity_code">Code</a></li>
</ul>
</div>
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>Prerequisites of this tutorial include <a class="el" href="integration.html">FUN-1: Integration on finite element mesh</a>, following <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>, <a class="el" href="basic_tutorials_poisson_nonlinear.html">SCL-4: Nonlinear Poisson's equation</a>, <a class="el" href="tutorial_elastic_problem.html">VEC-0: Linear elasticity</a> and finally <a class="el" href="tutorial_nonlinear_elastic.html">VEC-2: Nonlinear elastic</a></dd></dl>
<p><br  />
</p>
<dl class="section note"><dt>Note</dt><dd>Intended learning outcome:<ul>
<li>nonlinear elasticity</li>
<li>automatic differentiation</li>
<li>linearisation</li>
<li>tangent operators</li>
<li>discountinuous Galerkin projection</li>
<li>users modules</li>
</ul>
</dd></dl>
<p>This code, after some refactoring and removing handling cohesive interferes and periodic boundary conditions to serve the purposes of the tutorial is based on code used in <a class="el" href="citelist.html#CITEREF_ullah2017three">[71]</a> (doi: <a href="https://doi.org/10.1016/j.compstruct.2016.11.059">https://doi.org/10.1016/j.compstruct.2016.11.059</a>), see Figure <a class="el" href="tutorial_adolc_plasticity.html#adolc_paper">Figure 1</a>.</p>
<p><a class="anchor" id="adolc_paper"></a></p><div class="image">
<img src="adoc_paper_fig.jpg" alt="" width="800px"/>
<div class="caption">
Figure 1: Three-dimensional nonlinear micro/meso-mechanical response of fiber-reinforced polymer composites. Note paraboloidal surface described bewlo.</div></div>
<p>However, some limitations of the original code are removed, i.e., the code can be used to solve complex practical problems, see <a class="el" href="tutorial_adolc_plasticity.html#adolc_plasticity_specification">tutorial code specification</a>. Note that MoFEM tutorials are dedicated to contributors and developers keen to extend functionality, rather than to end-users.</p>
<p>You can jump immediately into the details of implementation here <a class="el" href="group__adoc__plasticity.html">link</a>. You also might look at ADOL-C implementation (library used for automatic differentiation), see <a href="https://github.com/coin-or/ADOL-C/blob/master/ADOL-C/doc/adolc-manual.pdf">ADOL-C manual</a>.</p>
<dl class="section note"><dt>Note</dt><dd>This tutorial utilizes automatic differentiation which is a powerful tool, however, here using it we evaluate hessian which has significant efficiency drawbacks. Despite that code has educational, value. Moreover, enables testing some ideas about plasticity models. Some efficiency drawbacks can be mitigated by parallel processing, however, plasticity is often localized to small regions, which requires load balancing. However current implementation works in parallel, load balancing is not implemented, and this tutorial will benefit from such a feature.</dd></dl>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000060">Todo:</a></b></dt><dd>Fix notation, use bold for vectors and tensors. Commas and dots at the end of equations. Other issues.</dd></dl>
<h1><a class="anchor" id="adolc_plasticity_installation"></a>
Installation</h1>
<p>This tutorial is a separate module, located in an independent repository. Users who would like create bespoke solutions for some research or industrial problems would like to create independent repository which is their ownership, licensing and contribution policy. If necessary keep it private. This tutorial is an example of how it can be done. <br  />
</p>
<p>You can install a module using Spack.pm, which module is an extension to generic user modules. That simplifies use and installation for end users. However for development purposes, you can install the module as follows:</p>
<ul>
<li>Clone repository <div class="fragment"><div class="line">cd $HOME/mofem_install/mofem-cephas/mofem/users_modules</div>
<div class="line">git clone -b master https://bitbucket.org/mofem/adolc-plasticity.git</div>
</div><!-- fragment --></li>
<li>Build module <div class="fragment"><div class="line">cd $HOME/mofem_install/mofem-cephas/mofem/users_modules/um-build-Rel*</div>
<div class="line">make rebuild_cache</div>
<div class="line">make -j 4 install</div>
</div><!-- fragment --></li>
</ul>
<h1><a class="anchor" id="adolc_plasticity_specification"></a>
Tutorial program specification</h1>
<ul>
<li>We provide tutorials for elastoplasticity problems in 2D and 3D on the triangle, quadrilateral, tetrahedron and hexahedron elements. In the 2D case, the code can handle plane stress and plane strain. One source code serves all cases.</li>
<li>Implementation is generic, dimension agnostic, i.e. code is implemented that dimension of the problem is unknown while implementation, but is known at compile time. Thus we exploit static polymorphism, i.e. C++ templates and partial specialization.</li>
<li>The type elements, the order of approximate is not known at compile time, is decided at run time. Thus we exploit dynamic polymorphism, i.e. C++ virtual functions.</li>
<li>Code is assumed to be run in parallel, on distributed mesh. No load balancing if performed, thus we assume that the mesh is balanced.</li>
<li>Code can handle a "zoo" of different boundary conditions, i.e. Dirichlet, Neumann, and Robin, i.e. spring boundary conditions.</li>
<li>Code can handle multiple material blocks, and if necessary can be extended to handle material property fields.</li>
<li>Users can easily add new material models.</li>
<li>Some points are different approaches between 2D and 3D while post-processing. In the 2D case, we can plot stress and strain on the interior face element, while in the 3D case, we can plot stress and strain volume of the skin, i.e. skin faces. That is a point that we perform branching, i.e. consent expression if a statement is used, at compilation time.</li>
</ul>
<dl class="section note"><dt>Note</dt><dd>That can/should be code extended to large deformations by following the Mieche procedure <a class="el" href="citelist.html#CITEREF_miehe2002anisotropic">[55]</a>, which utilizes Lie algebra by applying the logarithmic mapping to the left Cauchy-Green deformation tense. This code is based on the additive decomposition of total strain into elastic and plastic parts. Logarithmic strains, also called Hencky strains, are additive, and that is why the Mieche procedure allows the use of the code below in essence in unchanged form. See <a class="el" href="tutorial_nonlinear_elastic.html">VEC-2: Nonlinear elastic</a> or <a class="el" href="tutorial_plastic_problem.html">ADV-0: Plastic problem</a> for details.</dd></dl>
<h1><a class="anchor" id="adolc_plasticity_theory"></a>
Theory and problem formulation</h1>
<h3><a class="anchor" id="adolc_plasticity_introduction"></a>
Introduction</h3>
<p>In the following document, we define functions \(\psi(\varepsilon^e,\alpha)\), \(f(\sigma,\overline{\alpha})\) and \(\Psi(\sigma,\overline{\alpha})\) which are free (Helmholtz) energy, yield function and flow potential, respectively. Note that free energy is defined by strains and kinematic internal state variables, whereas yield function and flow potential are defined by fluxes (stress tensor and fluxes work conjugated to internal kinematic state variables). In this formulation, we assume that all functions are convex. From the convexity of free energy emerges the ellipticity of the partial differential equation, which is solved to satisfy the conservation of the linear momentum, i.e. establish equilibrium. The convexity of the yield function guarantees the uniqueness of the return on the plastic surface, and the convexity of the flow potential guarantees positive dissipation, i.e. the second law of thermodynamics is satisfied. For details see <a class="el" href="citelist.html#CITEREF_simo2006computational">[66]</a>. Moreover, in the following implementation is assumed that all functions are smooth enough that appropriate derivatives can be calculated, in particular, we assume that plastic surfaces do not have corners or apexs.</p>
<p>In the following implementation, the implicit scheme is applied to solve a set nonlinear system of equations with unilateral constraints. The admissible stress state is enforced by the Lagrange multiplier method and (Kuhn-Tucker) loading/unloading conditions, see <a class="el" href="citelist.html#CITEREF_simo2006computational">[66]</a>.</p>
<p>Following <a class="el" href="citelist.html#CITEREF_simo2006computational">[66]</a> can be shown that plastic loading unloading conditions can be exclusively characterized in terms of trial state </p><p class="formulaDsp">
\[ \varepsilon^{e,\textrm{trial}}_{n+1} := \varepsilon_{n+1} - \varepsilon^p_n \]
</p>
 <p class="formulaDsp">
\[ \alpha^\textrm{trial}_{n+1} := \alpha_n \]
</p>
 <p class="formulaDsp">
\[ \sigma^\textrm{trial}_{n+1} := \frac{\partial \psi}{\partial \varepsilon^e} (\varepsilon^{e,\textrm{trial}}_{n+1},\alpha_n) \]
</p>
 <p class="formulaDsp">
\[ \mathbf{\overline{\alpha}}^\textrm{trial}_{n+1} := \frac{\partial \psi}{\partial \alpha} (\varepsilon^{e,\textrm{trial}}_{n+1},\alpha_n) \]
</p>
 <p class="formulaDsp">
\[ f^\textrm{trial}_{n+1} := f(\sigma^\textrm{trial}_{n+1},\overline{\alpha}_n) \]
</p>
<p> then loading/unloading conditions are given </p><p class="formulaDsp">
\[ \begin{split} f^\textrm{trial}_{n+1} &lt; 0,\quad\textrm{elastic step}\,\to\,\Delta\gamma_{n+1} = 0 \\ f^\textrm{trial}_{n+1} \geq 0,\quad\textrm{plastic step}\,\to\,\Delta\gamma_{n+1} &gt; 0 \end{split} \]
</p>
<p> If first condition is true \(f^\textrm{trial}_{n+1} &lt; 0\), trial stress is solution at integration point. If the second condition is true, plastic strains and values of the internal state variables are calculated using <em>Closet</em> <em>point</em> <em>projection</em> algorithm. For consistency, we also satisfy the condition \(\Delta\gamma_{n+1}f_{n+1}\), at all converged states.</p>
<h2><a class="anchor" id="adolc_plasticity_cloaset_point_projection"></a>
Closet point projection algorithm</h2>
<h3><a class="anchor" id="adolc_plasticity_elastic_strain"></a>
Additive strain decomposition</h3>
<p>We assume that the total strain is decomposed into elastic and plastic parts, as follows </p><p class="formulaDsp">
\[ \varepsilon_{n+1} = \varepsilon^e_{n+1} + \varepsilon^p_{n+1} \]
</p>
<p> where \(\varepsilon_{n+1} = \textrm{sym}[ \nabla \mathbf{u}_{n+1}]\) is the total strain, \(\varepsilon^e_{n+1}\) is elastic strain, and \(\varepsilon^p_{n+1}\) is the plastic strain. \(\mathbf{u}_{n+1}\) is displacement at time \(t_{n+1}\).</p>
<h3><a class="anchor" id="adolc_plasticity_constitutive_equation"></a>
Constitutive relations</h3>
<p>The constitutive relations are defined exclusively through the free energy potential as follows, for the stresses and internal fluxes, respectively </p><p class="formulaDsp">
\[ \sigma_{n+1} := \frac{\partial \psi}{\partial \varepsilon^e}\left(\varepsilon^e_{n+1},\alpha_{n+1}\right), \quad \mathbf{\overline{\alpha}}_{n+1} := \frac{\partial \psi}{\partial \alpha}\left(\varepsilon^e_{n+1},\alpha_{n+1}\right) \]
</p>
<p> Note that the stresses, i.e. fluxes of linear momentum, are work-conjugated to the strains and the internal fluxes \(\overline{\alpha}\) is work conjugated to the kinematic internal state variables \(\alpha\). <br  />
</p>
<h3><a class="anchor" id="adolc_plasticity_constraints"></a>
Constraints</h3>
<p>The admissible inelastic domain is defined by the yield function </p><p class="formulaDsp">
\[ f_{n+1}:=f(\sigma_{n+1},\mathbf{\overline{\alpha}}_{n+1}), \quad f_{n+1} \leq 0 \]
</p>
<p> The yield stress could be understood as functional, with zero value implicitly defines the yield surface. <br  />
</p>
<h3><a class="anchor" id="adolc_plasticity_evolution"></a>
Evolution functions</h3>
<p>The flow rule defines the evolution of plastic strains, such that </p><p class="formulaDsp">
\[ \mathbf{n}_{n+1}:=\frac{\partial \Psi} {\partial \sigma} \left(\sigma_{n+1},\mathbf{\overline{\alpha}}_{n+1}\right), \quad \Delta \varepsilon^p_{n+1} = \Delta \gamma_{n+1} \mathbf{n}_{n+1} \]
</p>
<p> where \(\Delta \gamma_{n+1}\) is the plastic multiplier, and has to be determined that for the plastic process, stress remains on the yield surface, i.e. \(f_{n+1} = 0\). The evolution of internal variables is <br  />
 also defined consistently by the flow potential, such that </p><p class="formulaDsp">
\[ \mathbf{h}_{n+1}:=-\frac{\partial \Psi}{\partial \mathbf{\overline{\alpha}}} \left(\sigma_{n+1},\mathbf{\overline{\alpha}}_{n+1}\right), \quad \Delta \alpha_{n+1} = \Delta \gamma_{n+1} \mathbf{h}_{n+1} \]
</p>
<h3><a class="anchor" id="adolc_plasticity_residual"></a>
Residual</h3>
<p>Notting that in computational setting loading increment is finite, If we load the body at some point we will exceed the yield stress, thus we reach an inadmissible state. As a consequence, we have to return to the yield surface and stay on it, while material plastically yields. That task leads to an optimization problem with unilateral constraints <a class="el" href="citelist.html#CITEREF_simo2006computational">[66]</a>.</p>
<p>Once we establish that the material plastically flows, by calculating the state for trial stress, which is done individually for each integration point, we solve the optimization problem. The standard procedure is the Lagrange method, which introduces an additional variable, i.e. the Lagrange multiplier, which in this context is called the plastic multiplier, i.e. \(\Delta\gamma\), mentioned above. In some cases, we can associate some physical interpretation to the plastic multiplier, however, in general, it is just a mathematical tool.</p>
<p>Finally, the problem at the integration point boils down to the problem of solving a system of nonlinear equations. We have a whole spectrum of possibilities, including the Newthon-Raphson method, trust region methods, and line searchers, available through the PETSc library and its <a href="https://petsc.org/release/manual/snes/#ch-snes">SNES solver</a>.</p>
<p>To use SNES solver, we need to define the residual and the tangent operator. Here residual is defined as follows </p><p class="formulaDsp">
\[ \mathbf{R}_{n+1}^{i}:= \left\{ \begin{array}{c} -\varepsilon^p_{n+1}+\varepsilon^p_n \\ -\alpha_{n+1}+\alpha_n \\ f_{n+1} \end{array} \right\}^i + \Delta\gamma_{n+1}^i \left\{ \begin{array}{c} \mathbf{n}_{n+1} \\ \mathbf{h}_{n+1} \\ 0 \end{array} \right\}^i \]
</p>
<p> where \(i\) is the iteration number. The last row of the residual vector has an interpretation of the distance to yield surface and in the process of the solution of the optimization problem, we reduce that distance to the surface, thus naming closes point projection. Residual can be defined in several alternative ways, here we choose the most straightforward naive way to define it, which works well, at least for the problems we tested. From residual, by applying chain derivatives we obtain the tangent matrix, i.e. second quantity required by SNES solver. Tangent matrix is derived as follows </p><p class="formulaDsp">
\[ \left[ \begin{array}{ccc} -1+\gamma \left( \frac{\partial\mathbf{n}}{\partial\sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \varepsilon^p} + \frac{\partial\mathbf{n}}{\partial\mathbf{q}}\frac{\partial^2 \psi}{\partial\alpha\varepsilon^p} \right) &amp; \gamma \left( \frac{\partial\mathbf{n}}{\partial\mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha^2} + \frac{\partial\mathbf{n}}{\partial\sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \alpha} \right) &amp; \mathbf{n} \\ \gamma \left( \frac{\partial\mathbf{h}}{\partial\sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \varepsilon^p} + \frac{\partial\mathbf{h}}{\partial\mathbf{q}}\frac{\partial^2 \psi}{\partial\alpha\partial\varepsilon^p} \right) &amp; -1+\gamma \left( \frac{\partial\mathbf{h}}{\partial\mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha^2} + \frac{\partial\mathbf{h}}{\partial\sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \alpha} \right) &amp; \mathbf{h}\\ \frac{\partial f}{\partial \sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \varepsilon^p} + \frac{\partial f}{\partial \mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha\partial\varepsilon^p} &amp; \frac{\partial f}{\partial \mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha^2} + \frac{\partial f}{\partial \sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial\alpha} &amp; 0 \end{array} \right]^i \left\{ \begin{array}{c} \delta \varepsilon^p \\ \delta \alpha \\ \delta \gamma \end{array} \right\} = \mathbf{R}^{i} \]
</p>
<p> where \(\left(\varepsilon^p_{n+1}\right)^{i+1}=(\varepsilon^p_{n+1})^i + \delta\varepsilon^p_{n+1}\), \(\left(\alpha^p_{n+1}\right)^{i+1}=(\alpha_n)^i + \delta\alpha_{n+1}\) and \(\left(\Delta\gamma_{n+1}\right)^{i+1} = (\Delta\gamma_n)^i+\delta\gamma_{n+1}\). The quantities proceeded by \(\delta\) are sub increments of the Newton-Raphson method, calculated at series of iterations. Usually, it is assumed free energy split, since is easier to construct a convex function, as follows </p><p class="formulaDsp">
\[ \psi(\varepsilon^e,\alpha) = \psi^{\varepsilon}(\varepsilon^e) + \psi^\alpha(\alpha) \]
</p>
<p> in that case, linearized residual takes the form </p><p class="formulaDsp">
\[ \left[ \begin{array}{ccc} -1+\Delta\gamma \frac{\partial\mathbf{n}}{\partial\sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \varepsilon^p} &amp; \Delta\gamma \frac{\partial\mathbf{n}}{\partial\mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha^2} &amp; \mathbf{n} \\ \Delta\gamma \frac{\partial\mathbf{h}}{\partial\sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \varepsilon^p} &amp; -1+\Delta\gamma \frac{\partial\mathbf{h}}{\partial\mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha^2} &amp; \mathbf{h}\\ \frac{\partial f}{\partial \sigma}\frac{\partial^2 \psi}{\partial \varepsilon^e \partial \varepsilon^p} &amp; \frac{\partial f}{\partial \mathbf{q}}\frac{\partial^2 \psi}{\partial \alpha^2} &amp; 0 \end{array} \right]^i \left\{ \begin{array}{c} \delta \varepsilon^p \\ \delta \alpha \\ \delta \gamma \end{array} \right\} = -\mathbf{R}_n^i \]
</p>
<p>Where sub increment of the Newton-Raphson method is calculated as follows </p><p class="formulaDsp">
\[ \delta \chi = \left\{ \begin{array}{c} \delta \varepsilon^p \\ \delta \alpha \\ \delta \gamma \end{array} \right\} = - \mathbf{A}^{-1} \mathbf{R}_n^i, \quad \chi^{i+1} = \chi^i + \delta \chi \]
</p>
<p> where \(\mathbf{A}\) is the tangent metrix defined above.</p>
<dl class="section note"><dt>Note</dt><dd>If would you like to improve residual definition, let us know, and we will be happy to guide you.</dd></dl>
<h3><a class="anchor" id="adolc_plasticity_algebraic_tangent"></a>
Algorithmic tangent matrix</h3>
<p>The classical approach to computational plasticity is based on a nested approach, we solve unilateral optimization-constrained problems at the integration point, and then we assemble the global tangent operator, which we use to solve the global problem, of emerging from the conservation of linear momentum.</p>
<p>The global problem is nonlinear, as a consequence of the nonlinear material model, i.e. elastoplasticity. The global problem is computationally expensive, and solving it efficiently using the Newton-Raphson. The Newton-Raphson method promises quadratic convergence, near the solution, however, it requires the calculation of the tangent operator, which is consistent with the residual. In our case, the residual depends on a nested solution, which is also solved by the Newton-Raphson method. To calculate a consistent tangent operator, at the global system level, we need to calculate the change of plastic strain as a function of of change of total strain, which implicitly depends on the change of internal material state variables. <br  />
</p>
<p>To derive the consistent tangent operator, start with the constitutive equation </p><p class="formulaDsp">
\[ \delta \sigma := \mathbf{C}^e(\delta \varepsilon - \delta \varepsilon^p) \]
</p>
<p> where \(\mathbf{C}^e = \frac{\partial^2 \psi^e}{\partial {\varepsilon^e}^2}\) and \(\delta \varepsilon = \textrm{sym}[ \nabla \delta \mathbf{u}]\) is change of total strain.</p>
<p>Then we introduce the three operators, for completeness, however, we need only first one for the derivation of system level tangent operator. Mentioned operators have form </p><p class="formulaDsp">
\[ \left\{ \begin{array}{c} \mathbf{E}^p \\ \mathbf{L}^p \\ \mathbf{Y}^p \end{array} \right\} \delta \varepsilon = - \mathbf{A}^{-1} \left\{ \begin{array}{c} \Delta\gamma \frac{\partial \mathbf{n}}{\partial \sigma}\mathbf{C}^e \\ \Delta\gamma \frac{\partial \mathbf{h}}{\partial \sigma}\mathbf{C}^e \\ \frac{\partial f}{\partial \sigma}\mathbf{C}^e \end{array} \right\} \delta \varepsilon. \]
</p>
<p> The operator \(\mathbf{E}^p\) provides us the infinitesimal increment of plastic strans, as a consequence of the infinitesimal increment of total strain strain. Note that through inverse of the tangent operator \(\mathbf{A}\), the increment of plastic strain is coupled with a change of Lagrange plastic multiplier, i.e. containing infinitesimal increment of stress such that it remains plastic surface. We note that consistent tangent operator is implicitly connected to algorithm, and our choice of definition of the residual. <br  />
</p>
<p>Taking the above, we can see that we can express an increment of the plastic stain internal fluxes, and plastic multiplier as follows </p><p class="formulaDsp">
\[ \delta \varepsilon^p = \mathbf{E}^p \delta \varepsilon,\quad \delta \alpha = \mathbf{L}^p \delta \varepsilon,\quad \delta \gamma = \mathbf{Y}^p \delta \varepsilon \]
</p>
<p> Plugin first equation from above into the constitutive equation we obtain </p><p class="formulaDsp">
\[ \delta \sigma = \mathbf{C}^e(\mathbf{1} - \mathbf{E}^p)\delta \varepsilon \]
</p>
<p> which directly gives us material consistent tangent operator </p><p class="formulaDsp">
\[ \delta \sigma = \mathbf{C}^{ep}\delta \varepsilon \]
</p>
<p> where \(\mathbf{C}^{ep} = \mathbf{C}^e-\mathbf{C}^e\mathbf{E}^p\). We use \(\mathbf{C}^{ep}\) to assemble the global tangent operator, i.e. the holy grail of computational plasticity.</p>
<h1><a class="anchor" id="adolc_bbar"></a>
B-bar method</h1>
<p>When material plastic flows, additional constraints are imposed on the finite element deformation, emerging from the flow rule, in particular for J2 plasticity where plastic flow is isochoric, i.e. volume-preserving. That is a case for 3D case and plane strain. In such cases, low-order elements are locking, i.e. elements do not converge fast to the exact solution, fast as <a href="https://en.wikipedia.org/wiki/Céa%27s_lemma">Céa's lemma</a> states for elliptic problems, i.e. that the solution error is the best approximation error.</p>
<p>For low-order quadrilateral elements, there are several methods to mitigate the problem. That is reduced integration with hourglass stabilization, selective integration, and the B-bar method. Here we use the B-bar method, whose name comes from the modification finite element differential operator, i.e. \(\mathbf{B}\) operator, in the finite element expression for the stiffness matric \(\int_{V^e} \mathbf{B}^\textrm{T} \mathbf{C} \mathbf{B} \textrm{d}V\). The B-bar added on the top of the \(\overline{\mathbf{B}}\) operator, indicates that the strain axiator of the deformation is averaged on the element, which is equivalent to selective integration. Since the evaluation of constitutive equations are computationally expensive, in particular with automatic differentiation, we use the B-bar method to be more attractive.</p>
<p>The principle of the B-bar method is expressed by the following formula for variation of strain work on stress, i.e. </p><p class="formulaDsp">
\[ \delta \mathcal{W} = \int_{V^e} \mathbf{B}^\textrm{T} \sigma \textrm{d}V = \int_{V^e} \delta \varepsilon \sigma \textrm{d}V \approx \int_{V^e} \left[ \delta \varepsilon + \frac{1}{3} \left( (\textrm{tr}[\delta\varepsilon])^\textrm{ave} - \textrm{tr}[\delta\varepsilon] \right)I \right] \sigma \textrm{d}V = \int_{V^e} \overline{\mathbf{B}}^\textrm{T} \sigma \textrm{d}V \]
</p>
<p>, where is an average of the trace of the strain tensor, i.e. </p><p class="formulaDsp">
\[ (\textrm{tr}[\delta\varepsilon])^\textrm{ave} = \frac{1}{V^e} \int_{V^e} \textrm{tr}[\delta\varepsilon] \textrm{d}V. \]
</p>
<p> where \(V^e\) is the volume of the element.</p>
<p>The above formula is implemented using tensorial notation, rather than matrix notation, typical for traditional nodal-based finite element codes. See file <a class="el" href="ADOLCPlasticity_8cpp.html" title="Operators and data structures for ADOL-C plasticity.">ADOLCPlasticity.cpp</a> and snippet below. </p><div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Calculate base for B-bar method</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * @tparam DIM Dimension of problem</span></div>
<div class="line"><span class="comment"> * @param data access to base functions</span></div>
<div class="line"><span class="comment"> * @param storage storage for base functions at integration points</span></div>
<div class="line"><span class="comment"> * @param b_bar flag to sith on B-bar method </span></div>
<div class="line"><span class="comment"> * @param nb_integration_pts number of integration points </span></div>
<div class="line"><span class="comment"> * @param w_ptr integration weights</span></div>
<div class="line"><span class="comment"> * @return FTensor::Tensor2_symmetric&lt;FTensor::PackPtr&lt;double *, 6&gt;, 3&gt; </span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt;</div>
<div class="line"><a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;FTensor::PackPtr&lt;double *, 6&gt;</a>, 3&gt;</div>
<div class="line"><a class="code" href="namespaceADOLCPlasticity.html#a620421dcdd5da3b54fd68df62abdb535">getFTensor2SymmetricDiffBaseImpl</a>(<a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">DataForcesAndSourcesCore::EntData</a> &amp;data,</div>
<div class="line">                                 <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> &amp;storage, <span class="keyword">const</span> <span class="keywordtype">bool</span> b_bar,</div>
<div class="line">                                 <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts, <span class="keywordtype">double</span> *w_ptr,</div>
<div class="line">                                 <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;DIM&gt;</a>) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> nb_dofs = data.getFieldData().size();</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> nb_bases = data.getN().size2();</div>
<div class="line"> </div>
<div class="line">  storage.resize(nb_integration_pts, 6 * nb_dofs, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'I', DIM&gt;</a> <a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'J', DIM&gt;</a> <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> N0;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> N1;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> N2;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get tensorial base</span></div>
<div class="line">  <span class="keyword">auto</span> get_ftensor2_symmetric = [&amp;](<span class="keyword">const</span> <span class="keywordtype">int</span> gg, <span class="keyword">const</span> <span class="keywordtype">int</span> rr) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code" href="namespaceMoFEM.html#ad6e54b3e1822ea9f7f255cf1f499e42d">getFTensor2SymmetricFromPtr&lt;3&gt;</a>(&amp;storage(gg, 6 * rr));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate base </span></div>
<div class="line">  <span class="keyword">auto</span> calc_base = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> t_t2_diff = get_ftensor2_symmetric(0, 0);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">      <span class="keyword">auto</span> t_diff = data.getFTensor1DiffN&lt;DIM&gt;(gg, 0);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> b = 0; b != nb_dofs / DIM; ++b) {</div>
<div class="line">        <a class="code" href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_grad;</div>
<div class="line"> </div>
<div class="line">        t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = 0;</div>
<div class="line"> </div>
<div class="line">        t_grad(N0, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = t_diff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">        t_t2_diff(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_grad(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2;</div>
<div class="line">        ++t_t2_diff;</div>
<div class="line"> </div>
<div class="line">        t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = 0;</div>
<div class="line">        t_grad(N1, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = t_diff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">        t_t2_diff(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_grad(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2;</div>
<div class="line">        ++t_t2_diff;</div>
<div class="line"> </div>
<div class="line">        t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = 0;</div>
<div class="line">        <span class="keywordflow">if</span> constexpr (DIM == 3) {</div>
<div class="line">          t_grad(N2, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) = t_diff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">          t_t2_diff(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = (t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) || t_grad(<a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2;</div>
<div class="line">          ++t_t2_diff;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        ++t_diff;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> get_ftensor2_symmetric(0, 0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate volume average of trace</span></div>
<div class="line">  <span class="keyword">auto</span> calc_vol = [&amp;](<span class="keyword">auto</span> &amp;&amp;t_t2_dff) {</div>
<div class="line">    std::vector&lt;double&gt; vol(nb_dofs, 0);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> b = 0; b != nb_dofs; ++b) {</div>
<div class="line">        vol[b] += w_ptr[gg] * t_t2_dff(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / DIM;</div>
<div class="line">        ++t_t2_dff;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">double</span> sum = 0;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">      sum += w_ptr[gg];</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : vol) {</div>
<div class="line">      <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> /= sum;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> vol;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// modify base for B-bar method</span></div>
<div class="line">  <span class="keyword">auto</span> make_b_bar = [&amp;](<span class="keyword">auto</span> &amp;&amp;vol) {</div>
<div class="line">    <span class="keyword">auto</span> t_t2_diff = get_ftensor2_symmetric(0, 0);</div>
<div class="line">    constexpr <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a class="code" href="classFTensor_1_1Kronecker__Delta__symmetric.html">FTensor::Kronecker_Delta_symmetric&lt;int&gt;</a>();</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> b = 0; b != nb_dofs; ++b) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="namespacePlasticOps.html#ad104160ccee829446f9f4701d5364629">trace</a> = t_t2_diff(<a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) / DIM;</div>
<div class="line">        t_t2_diff(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>) += (vol[b] - <a class="code" href="namespacePlasticOps.html#ad104160ccee829446f9f4701d5364629">trace</a>) * <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>, <a class="code" href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a>);</div>
<div class="line">        ++t_t2_diff;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> get_ftensor2_symmetric(0, 0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> b_bar ? make_b_bar(calc_vol(calc_base())) : calc_base();</div>
<div class="line">};</div>
</div><!-- fragment --><p> As a result of the above code, we obtain the tensorial base functions, which are used to evaluate the stiffness matrix and the right-hand side vector. For the latter case, code is shown in the snippet form <a class="el" href="ADOLCPlasticity_8hpp.html">ADOLCPlasticity.hpp</a> below </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM, <span class="keyword">typename</span> AssemblyDomainEleOp&gt;</div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> OpRhsImpl&lt;DIM, GAUSS, AssemblyDomainEleOp&gt;::iNtegrate(</div>
<div class="line">    <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="classOP.html">OP</a> = <a class="code" href="tensor__divergence__operator_8cpp.html#a614aff059c889b5343fba0aaadecebb4">AssemblyDomainEleOp</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <span class="keywordtype">double</span> *w_ptr = &amp;(OP::getGaussPts()(DIM, 0));</div>
<div class="line">  <span class="comment">// Calulate tensorial base functions. Apply bBar method when needed</span></div>
<div class="line">  <span class="keyword">auto</span> t_diff = MakeB::getFTensor2SymmetricDiffBase(</div>
<div class="line">      data, baseStorage, commonDataPtr-&gt;bBar, OP::getGaussPts().size2(), w_ptr,</div>
<div class="line">      <a class="code" href="classFTensor_1_1Number.html">FTensor::Number&lt;DIM&gt;</a>());</div>
<div class="line">  <span class="keyword">auto</span> t_stress = getFTensor2SymmetricFromMat&lt;3&gt;(commonDataPtr-&gt;stressMatrix);</div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> vol = OP::getMeasure();</div>
<div class="line">  <span class="keyword">auto</span> t_w = OP::getFTensor0IntegrationWeight();</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != OP::nbIntegrationPts; gg++) {</div>
<div class="line">    <span class="keywordtype">double</span> alpha = vol * t_w;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> bb = 0; bb != OP::nbRows; ++bb) {</div>
<div class="line">      OP::locF[bb] += alpha * (t_stress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_diff(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">      ++t_diff;</div>
<div class="line">    }</div>
<div class="line">    ++t_w;</div>
<div class="line">    ++t_stress;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>Another method for resolving the issue with locking would be adding a bubble function on the element, which is a natural way in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>, look to <a class="el" href="tutorial_plastic_problem.html">ADV-0: Plastic problem</a> to see how this can be done. You can also look at <a class="el" href="tutorial_elastic_problem.html">VEC-0: Linear elasticity</a> to learn how bubble could be efficiently by removing block diagonal entries from the stiffness matrix using the Schur complement and block solver.</dd></dl>
<h1><a class="anchor" id="adolc_materoal_models"></a>
Material models</h1>
<p>Each material model is a class derived from the base class <a class="el" href="structADOLCPlasticity_1_1ClosestPointProjection.html">ADOLCPlasticity::ClosestPointProjection</a>. Each class has three abstract methods, which must be implemented by the user. That is <a class="el" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ae0fb3f0128f5c280896f5495021a52da">ADOLCPlasticity::ClosestPointProjection::freeHemholtzEnergy</a>, <a class="el" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a3a15b6cb703466efe57853292bf59afa">ADOLCPlasticity::ClosestPointProjection::flowPotential</a> and <a class="el" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ab235d4130d0588ad22120db81af2ba1e">ADOLCPlasticity::ClosestPointProjection::yieldFunction</a>.</p>
<p>If a new model is implemented, it must be registered in the factory, see and follow the pattern below from <a class="el" href="adolc_plasticity_8cpp-example.html">adolc_plasticity.cpp</a> </p><div class="fragment"><div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * FIXME: Here only array of material models is initalized. Each model has</span></div>
<div class="line"><span class="comment">   * unique set of the ADOL-C tags. Pointer is attached based on block name to</span></div>
<div class="line"><span class="comment">   * which entity belongs. That will enable heterogeneity of the model, in</span></div>
<div class="line"><span class="comment">   * addition of heterogeneity of the material properties.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> MaterialModel {</div>
<div class="line">    VonMisses,</div>
<div class="line">    VonMissesPlaneStress,</div>
<div class="line">    Paraboloidal,</div>
<div class="line">    LastModel</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_materials[LastModel] = {<span class="stringliteral">&quot;VonMisses&quot;</span>, <span class="stringliteral">&quot;VonMissesPlaneStress&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;Paraboloidal&quot;</span>};</div>
<div class="line">  PetscInt choice_material = VonMisses;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#abee82d436d03244c6886fc99f71116f0">PetscOptionsGetEList</a>(PETSC_NULL, NULL, <span class="stringliteral">&quot;-material&quot;</span>, list_materials,</div>
<div class="line">                              LastModel, &amp;choice_material, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (choice_material) {</div>
<div class="line">  <span class="keywordflow">case</span> VonMisses:</div>
<div class="line">    cpPtr = createMaterial&lt;J2Plasticity&lt;3&gt;&gt;();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> VonMissesPlaneStress:</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> != 2)</div>
<div class="line">      SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">              <span class="stringliteral">&quot;VonMissesPlaneStrain is only for 2D case&quot;</span>);</div>
<div class="line">    cpPtr = createMaterial&lt;J2Plasticity&lt;2&gt;&gt;();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Paraboloidal:</div>
<div class="line">    cpPtr = createMaterial&lt;ParaboloidalPlasticity&gt;();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Wrong material model&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (approxBase == <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a> &amp;&amp; <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> == 2)</div>
<div class="line">    cpPtr-&gt;integrationRule = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2 * (p - 2); };</div>
<div class="line"> </div>
</div><!-- fragment --> <dl class="todo"><dt><b><a class="el" href="todo.html#_todo000061">Todo:</a></b></dt><dd>For simplicity we predefine one model to the mesh, however, using <a class="el" href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a> it is possible to assign different models to mesh blocks baes on the block name. We should implement this extension. Block names can be set in Cubit, gMesh, or Salome. In particular MED format can handle block names. </dd></dl>
<h2><a class="anchor" id="adolc_auxiliary_functions"></a>
Auxiliary functions</h2>
<p>The class has two auxiliary virtual functions, <a class="el" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a50cdc49dfb7544b644defb15ef293411">ADOLCPlasticity::ClosestPointProjection::addMatBlockOps</a>, and <a class="el" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a832002adb1749cb06cdf29a5b88796e0">ADOLCPlasticity::ClosestPointProjection::setParams</a>. Both are optional and can be used to read material properties from mesh blocks or to set material properties. Using this functionality more complex cases can be handled, for example, by reading material properties from a stochastic field. <br  />
</p>
<p>Reading of material properties from mesh blocks is implemented as an example for von Misses material model, see <a class="el" href="structADOLCPlasticity_1_1J2Plasticity_3_013_01_4.html#a300c797b12134429eef8a70aa98455a1" title="Get material parameters from block.">ADOLCPlasticity::J2Plasticity&lt;3&gt;::addMatBlockOps</a> and <a class="el" href="structADOLCPlasticity_1_1J2Plasticity_3_013_01_4.html#adeabcadf1e8835612f68daae3f7460f2" title="Set material parameters at integration point.">ADOLCPlasticity::J2Plasticity&lt;3&gt;::setParams</a>.</p>
<h2><a class="anchor" id="adolc_plasticity_von_mises"></a>
J2 plasticity</h2>
<p>Von Mises yield function, know also as J2 plasticity, also called HMH plasticity after Huber, Mises and Hencky, who invented pressure-independent strength criterion independently. This model is useful to describe the behavior of a large class of metals.</p>
<h3><a class="anchor" id="adolc_plasticity_von_mises_free"></a>
Free energy density</h3>
<p>Free energy density has form </p><p class="formulaDsp">
\[ \psi(\varepsilon^e, \alpha, \beta) = \frac{1}{2} \lambda \textrm{tr}[\varepsilon^e]^2 + \mu \varepsilon^e : \varepsilon^e + \sigma_y\alpha + \frac{1}{2} \phi H \alpha^2 + \frac{1}{2} (1-\phi)K \beta^2 \]
</p>
<p> where \(\lambda\) and \(\mu\) are Lame'e parameters, \(\sigma_y\) is yield stress, \(\varepsilon^e\) is elastic strain \(\alpha\) is the internal variable associated with isotropic hardening and \(\beta\) is the internal variable associated with kinematics hardening. \(\phi\) is the fraction controlling how the amount of kinematic and isotropic hardening is useful for studying the Bauchinger effect, i.e. plastic hysteresis under cyclic loading.</p>
<p>In general, such a function needs to be convex, which yields elasticity of the problem, and the uniqueness of the solution. Here we restricted implementation to polyconvex form, i.e. that each term separated by addition is convex. That separates in an additive way strains and internal variables, as stated in <a class="el" href="tutorial_adolc_plasticity.html#adolc_plasticity_introduction">Introduction</a>, and exploited while assembly the nested tangent operator. Models in small strains, since a symmetric gradient of displacements is used, are invariant to infinitesimal rotations, which provides objectivity to the problem in infinitesimal cases. Also, note that the model can be easily extended to anisotropic cases.</p>
<p>The code for which the above function is implemented is given below from <a class="el" href="ADOLCPlasticityMaterialModels_8hpp.html" title="Matetial models for plasticity.">ADOLCPlasticityMaterialModels.hpp</a> </p><div class="fragment"><div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> freeHemholtzEnergy() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ADOL-C register parameters (those can varied for integration points)</span></div>
<div class="line">    <span class="keyword">auto</span> p_lambda = mkparam(<a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>);  <span class="comment">// 0</span></div>
<div class="line">    <span class="keyword">auto</span> p_mu = mkparam(<a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>);          <span class="comment">// 1</span></div>
<div class="line">    <span class="keyword">auto</span> p_H = mkparam(<a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>);            <span class="comment">// 2</span></div>
<div class="line">    <span class="keyword">auto</span> p_K = mkparam(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>);            <span class="comment">// 3</span></div>
<div class="line">    <span class="keyword">auto</span> p_phi = mkparam(<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>);        <span class="comment">// 4</span></div>
<div class="line">    <span class="keyword">auto</span> p_sigma_y = mkparam(<a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>); <span class="comment">// 5</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Operator converting Voight and tensor notation</span></div>
<div class="line">    <span class="keyword">auto</span> t_voight_strain_op = <a class="code" href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">voight_to_strain_op</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Variable in voight notation</span></div>
<div class="line">    <span class="keyword">auto</span> t_voight_total_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_plastic_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_plasticStrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_internal_tensor =</div>
<div class="line">        getFTensor1FromPtr&lt;6&gt;(&amp;a_internalVariables[1]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert variables to tensor notation</span></div>
<div class="line">    tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_total_strain(Z);</div>
<div class="line">    tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_plastic_strain(Z);</div>
<div class="line">    tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_internal_tensor(Z);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Evaluate elastic strain</span></div>
<div class="line">    tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    tR = tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Strain energy</span></div>
<div class="line">    a_w = 0.5 * p_lambda * tR * tR +</div>
<div class="line">          p_mu * (tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">    <span class="comment">// Isotropic strain energy</span></div>
<div class="line">    a_w +=</div>
<div class="line">        a_internalVariables[0] * p_sigma_y +</div>
<div class="line">        0.5 * p_phi * p_H * (a_internalVariables[0] * a_internalVariables[0]);</div>
<div class="line">    <span class="comment">// Kinematic strain energy</span></div>
<div class="line">    a_w += (0.5 * (1 - p_phi) * p_K) *</div>
<div class="line">           (tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --> <h3><a class="anchor" id="adolc_plasticity_von_mises_yield_function"></a>
Yield function and flow potential</h3>
<p>The yield function has form </p><p class="formulaDsp">
\[ f(\sigma, \overline{\alpha}) = \sqrt{\frac{3}{2} \eta:\eta} - \overline{\alpha} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \eta=\textrm{dev}[\sigma]-\overline{\beta} \]
</p>
<p> where \(\sigma\) is the stress tensor and \(\overline{\alpha}\) is the scalar internal flux variable, and \(\overline{\beta}\) is tensorial internal flux.</p>
<p>Note that dissipation density can be expressed as </p><p class="formulaDsp">
\[ \mathcal{D} = \alpha \overline{\alpha} + \beta : \overline{\beta} \geq 0 \]
</p>
<p>The code for which the above function is implemented is given below from <a class="el" href="ADOLCPlasticityMaterialModels_8hpp.html" title="Matetial models for plasticity.">ADOLCPlasticityMaterialModels.hpp</a> </p><div class="fragment"><div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalF() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> t_voight_stress_op = <a class="code" href="namespaceADOLCPlasticity.html#ad5af676dc42ec1e2aaf35ea35171be83">voight_to_stress_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_vioght_stress = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTress[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_back_stress = getFTensor1FromPtr&lt;6&gt;(&amp;a_internalFluxes[1]);</div>
<div class="line">    tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_stress_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_vioght_stress(Z);</div>
<div class="line">    tBackStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_stress_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_back_stress(Z);</div>
<div class="line"> </div>
<div class="line">    constexpr <span class="keywordtype">double</span> <a class="code" href="EshelbianADOL-C_8cpp.html#a2942a742e89c8e16193e7aeca63c995c">third</a> = boost::math::constants::third&lt;double&gt;();</div>
<div class="line">    constexpr <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a class="code" href="classFTensor_1_1Kronecker__Delta__symmetric.html">FTensor::Kronecker_Delta_symmetric&lt;double&gt;</a>();</div>
<div class="line">    tR = tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / 3.;</div>
<div class="line">    tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tR * <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tBackStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Fix the constant to mach uniaxial test</span></div>
<div class="line">    constexpr <span class="keywordtype">double</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = 3. / 2.;</div>
<div class="line">    <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> = <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> yieldFunction() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evalF();</div>
<div class="line">    a_y = sqrt(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>) - a_internalFluxes[0];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --><p> Since for J2 plasticity, we assume the associated flow rule, the flow potential is the same as the yield function, i.e. \(\Psi(\sigma, \overline{\alpha}) = f(\sigma, \overline{\alpha})\). In such cases, we can show that the problem could be expressed as a constrained minimization problem of the Lagrangian function </p><p class="formulaDsp">
\[ \min_{\alpha, \beta} \max_{\dot{\lambda}} \mathcal{L}(\alpha, \beta,\overline{\alpha}, \overline{\beta}, \dot{\lambda}) := \alpha \overline{\alpha} + \beta : \overline{\beta} + \dot{\gamma} f(\sigma(\varepsilon^e), \overline{\alpha}) \]
</p>
<p> where implicit relations between elastic strain and stress, and internal kinematic variables and fluxes are defined by free energy potential. For such cases we dissipation of energy is maximal. If for such a case model prediction matches within reason experiments for curtain range of loading, it indicates that the model captures all fundamental physics of the problem and constitutive equations can not be expressed with a smaller number of parameters that need to be estimated experimentally by independent tests.</p>
<dl class="section note"><dt>Note</dt><dd>Any nonassociative flow rule requires additional parameters, and thus the model is less fundamental. For example, if we model granular material such as soil, their dissipation also takes place by friction grains sliding against each other or rotating. The letter part, associated with rotation is not captured by the kinematics of classical continuum description, and many experimental results with nonassociative flow rule are added, with the cost of additional parameters.</dd></dl>
<h2><a class="anchor" id="adolc_plasticity_von_mises_plane_stress"></a>
J2 plasticity in plane stress</h2>
<p>Here we use the classical implementation of finite elements, within displacements as a primary variable, we use the so-called strain-driven approach. For the plane strain case such an approach is natural, and simply emerges from type of use of finite elements, i.e. 2D elements or 3D, and the model presented above remains unchanged.</p>
<p>This is not the case for plane stress, where the constraint that the stress, let's say, in z-direction is zero, needs to be explicitly enforced. That typically leads to some implementation difficulties, i.e. plastic surface is no longer circular, it has an elliptical shape, and a radial return mapping algorithm no longer works. That is a direct result of constraints, which yield a change in the definition of deviatoric stress defined in the 2D word of the plane stress problem.</p>
<p>However, this implementation is straightforward. Since the model is based on potential functions, we choose to implement integration points always in 3D. Specialization between 2D and 3D cases is at the final step while the assembly and construction of finite element base/shape functions, in particular, when the b-bar method is used, to solve the problem of volumetric locking. Note that the plane stress problem is it is not an actual 2D problem, but the reduction of the 3D problem with additional static constrain.</p>
<p>Thus, the implementation of plane stress requires only a change in the definition of free energy, taking into account static constraints, see a snippet from <a class="el" href="ADOLCPlasticityMaterialModels_8hpp-example.html">ADOLCPlasticityMaterialModels.hpp</a> </p><div class="fragment"><div class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>J2Plasticity&lt;2&gt; : <span class="keyword">public</span> J2Plasticity&lt;3&gt; {</div>
<div class="line">  <span class="keyword">using</span> J2Plasticity&lt;3&gt;::J2Plasticity;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> freeHemholtzEnergy() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> p_lambda = mkparam(<a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>);  <span class="comment">// 0</span></div>
<div class="line">    <span class="keyword">auto</span> p_mu = mkparam(<a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>);          <span class="comment">// 1</span></div>
<div class="line">    <span class="keyword">auto</span> p_H = mkparam(<a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>);            <span class="comment">// 2</span></div>
<div class="line">    <span class="keyword">auto</span> p_K = mkparam(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>);            <span class="comment">// 3</span></div>
<div class="line">    <span class="keyword">auto</span> p_phi = mkparam(<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>);        <span class="comment">// 4</span></div>
<div class="line">    <span class="keyword">auto</span> p_sigma_y = mkparam(<a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>); <span class="comment">// 5</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_voight_strain_op = <a class="code" href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">voight_to_strain_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_voight_total_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_plastic_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_plasticStrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_internal_tensor =</div>
<div class="line">        getFTensor1FromPtr&lt;6&gt;(&amp;a_internalVariables[1]);</div>
<div class="line"> </div>
<div class="line">    tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_total_strain(Z);</div>
<div class="line">    tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_plastic_strain(Z);</div>
<div class="line">    tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_internal_tensor(Z);</div>
<div class="line"> </div>
<div class="line">    tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Plane stress]</span></div>
<div class="line"><span class="comment"></span>    <span class="comment">// Calculate st  rain at ezz enforcing plane strain case</span></div>
<div class="line">    tElasticStrain(2, 2) =</div>
<div class="line">        (-tElasticStrain(0, 0) * p_lambda - tElasticStrain(1, 1) * p_lambda) /</div>
<div class="line">        (p_lambda + 2 * p_mu);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Plane stress]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    tR = tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    a_w = 0.5 * p_lambda * tR * tR +</div>
<div class="line">          p_mu * (tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// plastic part</span></div>
<div class="line">    <span class="comment">// isotropic</span></div>
<div class="line">    a_w +=</div>
<div class="line">        a_internalVariables[0] * p_sigma_y +</div>
<div class="line">        0.5 * p_phi * p_H * (a_internalVariables[0] * a_internalVariables[0]);</div>
<div class="line">    <span class="comment">// kinematic</span></div>
<div class="line">    a_w += (0.5 * (1 - p_phi) * p_K) *</div>
<div class="line">           (tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
</div><!-- fragment --><p>in particular plane stress constrain is explicitly enforced in the lines </p><div class="fragment"><div class="line">    <span class="comment">// Calculate st  rain at ezz enforcing plane strain case</span></div>
<div class="line">    tElasticStrain(2, 2) =</div>
<div class="line">        (-tElasticStrain(0, 0) * p_lambda - tElasticStrain(1, 1) * p_lambda) /</div>
<div class="line">        (p_lambda + 2 * p_mu);</div>
</div><!-- fragment --><p>what is </p><p class="formulaDsp">
\[ \varepsilon_{zz} = \frac{-\lambda}{\lambda + 2\mu} \left(\varepsilon_{xx} + \varepsilon_{yy}\right) \]
</p>
<h2><a class="anchor" id="adolc_plasticity_paraboloidal"></a>
Paraboloidal model</h2>
<p>That is pressure dependent model, which non-associated flow rule. For some applications see papers for reference <a class="el" href="citelist.html#CITEREF_ullah2017three">[71]</a> and <a class="el" href="citelist.html#CITEREF_stier2015comparing">[68]</a>.</p>
<h3><a class="anchor" id="adolc_plasticity_paraboloidal_free"></a>
Free energy density</h3>
<p>Free energy density has form </p><p class="formulaDsp">
\[ \psi = \frac{1}{2} \lambda \textrm{tr}[\varepsilon]^2 + \mu \varepsilon : \varepsilon + \sigma_{yt}\alpha_0 + \frac{1}{2} H_t \alpha_0^2 + \sigma_{yc}\alpha_1 + \frac{1}{2} H_c \alpha_1^2 \]
</p>
<p> where \(\lambda\) and \(\mu\) are Lam\'e parameters, \(H_t\) is the hardening modulus in tension, \(H_c\) is the hardening modulus in compression.</p>
<p>The code for which the above function is implemented is given in snippet form <a class="el" href="ADOLCPlasticityMaterialModels_8hpp-example.html">ADOLCPlasticityMaterialModels.hpp</a> </p><div class="fragment"><div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> freeHemholtzEnergy() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_voight_strain_op = <a class="code" href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">voight_to_strain_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_voight_total_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_plastic_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_plasticStrain[0]);</div>
<div class="line"> </div>
<div class="line">    tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_total_strain(Z);</div>
<div class="line">    tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_plastic_strain(Z);</div>
<div class="line">    tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    tR = tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    a_w = 0.5 * <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> * tR * tR +</div>
<div class="line">          <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> * (tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    a_w += sigmaYt * a_internalVariables[0] +</div>
<div class="line">           0.5 * Ht * a_internalVariables[0] * a_internalVariables[0];</div>
<div class="line">    a_w += sigmaYc * a_internalVariables[1] +</div>
<div class="line">           0.5 * Hc * a_internalVariables[1] * a_internalVariables[1];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --> <h3><a class="anchor" id="adolc_plasticity_paraboloidal_yield_function"></a>
Yield function</h3>
<p>The yield function has form </p><p class="formulaDsp">
\[ y = 6J_2 + 2I_1\left(\overline{\alpha_1}-\overline{\alpha_0}\right) - 2\overline{\alpha_0} \,\overline{\alpha_1} \]
</p>
<p> where the internal fluxes are defined by free energy functional and have from, for compression and tension, respectively, as follows </p><p class="formulaDsp">
\[ \overline{\alpha_0}=\frac{\partial \psi}{\partial \alpha_0}=\sigma_{yt} + H_t \alpha_0, \quad \overline{\alpha_1}=\frac{\partial \psi}{\partial \alpha_1}=\sigma_{yc} + H_c \alpha_1 \]
</p>
<p> where \(\sigma_{yt}\) is the yield stress in tension, \(\sigma_{yc}\) is the yield stress in compression.</p>
<p>The J2 and I1 stress invariants are defined as follows </p><p class="formulaDsp">
\[ I_1 = \textrm{tr} (\boldsymbol{\sigma}), \quad J_2 = \frac{1}{2} \eta:\eta, \]
</p>
<p> where \(\eta\) is the deviatoric stress tensor, defined as follows </p><p class="formulaDsp">
\[ \eta=\textrm{dev}[\boldsymbol{\sigma}] = \sigma - \frac{1}{3} \textrm{tr} (\boldsymbol{\sigma}) I \]
</p>
<p>The implementation of the yield function is given snippet from <a class="el" href="ADOLCPlasticityMaterialModels_8hpp-example.html">ADOLCPlasticityMaterialModels.hpp</a> </p><div class="fragment"><div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalF() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> t_voight_stress_op = <a class="code" href="namespaceADOLCPlasticity.html#ad5af676dc42ec1e2aaf35ea35171be83">voight_to_stress_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_vioght_stress = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTress[0]);</div>
<div class="line">    tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_stress_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_vioght_stress(Z);</div>
<div class="line">    tR = tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">    I1 = tR;</div>
<div class="line">    constexpr <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a class="code" href="classFTensor_1_1Kronecker__Delta__symmetric.html">FTensor::Kronecker_Delta_symmetric&lt;double&gt;</a>();</div>
<div class="line">    tR /= 3.;</div>
<div class="line">    tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tR * <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    J2 = 0.5 * (tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> yieldFunction() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evalF();</div>
<div class="line">    a_y = 6 * J2 + 2 * I1 * (a_internalFluxes[1] - a_internalFluxes[0]) -</div>
<div class="line">          2 * a_internalFluxes[0] * a_internalFluxes[1];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --> <h3><a class="anchor" id="adolc_plasticity_paraboloidal_flow"></a>
Flow potential</h3>
<p>The flow potential has form </p><p class="formulaDsp">
\[ \Psi = 6J_2 + 2\alpha I_1 \left(\overline{\alpha_1}-\overline{\alpha_0}\right) - 2\overline{\alpha_0} \,\overline{\alpha_1} \]
</p>
 <p class="formulaDsp">
\[ \alpha= \frac{1-2\nu_p}{1+\nu_p} \]
</p>
<p> where \(\nu_p\) is the Poisson ratio of the plastic strain, which for \(\nu_p=0\) model reduces to the associated flow rule, for \(\nu_p=0.5\) the model reduces to the isochoric flow rule. The \(\nu_p\) is an extra material parameter, which has to be tuned to match experimental results. Note that for associated flow rule yield surface and flow potential are parameter-free.</p>
<p>The implementation of the flow potential is given snippet from <a class="el" href="ADOLCPlasticityMaterialModels_8hpp-example.html">ADOLCPlasticityMaterialModels.hpp</a> </p><div class="fragment"><div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> flowPotential() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evalF();</div>
<div class="line">    <span class="keywordtype">double</span> alpha =</div>
<div class="line">        (1 - 2 * nup) /</div>
<div class="line">        (1 + nup); <span class="comment">// relation between alpha and plastic poisson&#39;s ratio</span></div>
<div class="line">    a_h = 6 * J2 +</div>
<div class="line">          2 * alpha * I1 * (a_internalFluxes[1] - a_internalFluxes[0]) -</div>
<div class="line">          2 * a_internalFluxes[0] * a_internalFluxes[1];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
</div><!-- fragment --> <h1><a class="anchor" id="adolc_plasticity_assembly"></a>
Assembly and integration</h1>
<p>The integration of ADOL-C plasticity models with core <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> functionality involves three elements, pushing operators for assembly of the right-hand side, i.e. internal forces, and pushing operators to the left-hand side, i.e. tangent matrix. Users can do that using so-called <em>operators</em> <em>factory</em>, which encapsulates all necessary functionality.</p>
<p>The principle behind the operators and operators factory is to create resilient code, that each element of the finite element system is isolated, which interferes with other elements by strictly defined rules. That enforces the modularity of the code. That involves that data are local, and each operator is a kind of black box, which does not depend on the state of other operators. That simplicity of code development, testing, and allows the composition of many components, i.e. different phenomena together.</p>
<p>In the case of plasticity, beyond the assembly linear system of equations, by pushing operators to the left-hand side, and the right-hand side, we need to update history model internal variables, and plastic strains, since elastic-plastic material remembers load history,</p>
<p>Also, the postprocessing of the elastoplastic model requires special attention, while post-processing, since stresses can not be evaluated at post-processing mesh nodes, since the history of deformation is unknown at arbitrary material points, only at integration points used while assembly of the linear system of equations.</p>
<p>As you will see each element, i.e. assembly, updating history, and postprocessing is a black box, the only common data structure is the material model, in which all elements share. This tutorial with little effort can be integrated with <a class="el" href="tutorial_contact_problem.html">ADV-1: Contact problem</a>. Moreover, by evaluating dissipation and assuming that part of it is converted to heat, the user can integrate code with <a class="el" href="tutorial_thermo_elastic.html">ADV-2: Thermo-elastic example</a>. Another option is coupling with rates of change of the volume, rendering complex physics for hydromechanical problems, i.e. <a class="el" href="tutorial_seepage.html">ADV-5: Seepage in elsatic body example</a>.</p>
<p>Note that the tutorial has a general structure that resembles the tasks presented above, see the following code snippet for <a class="el" href="adolc_plasticity_8cpp-example.html">adolc_plasticity.cpp</a> </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#abb0809e4aa5ce3c9ed3527589a0e4700">PlasticProblem::runProblem</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#a31cf037a330e535948dac3d980124879">readMesh</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#a0b9a2881ee6be9f98852c9e1af165b35">setupProblem</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#a512e17945fff13f02e112034b56c595f">boundaryCondition</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#a9a0af54d9bcdc0ebab2aaa1aaa1b0585">assembleSystem</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#af28654edd552346301dbbd396730b9b2">solveSystem</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#ab6aeaf2b20f0755222d0124d2c7524c4">gettingNorms</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#a4248ee2b94d3ab2b979c273a4b131410">outputResults</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structPlasticProblem.html#a4fd802798873644e765120cc1a563370">checkResults</a>();</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --> <h2><a class="anchor" id="adolc_plasticity_assembly_assembly"></a>
Assembly</h2>
<p>The pushing of operators to the left-hand side and right-hand side is done by a snippet from <a class="el" href="adolc_plasticity_8cpp-example.html">adolc_plasticity.cpp</a> </p><div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a9a0af54d9bcdc0ebab2aaa1aaa1b0585">PlasticProblem::assembleSystem</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> *<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;Simple&gt;();</div>
<div class="line">  <span class="keyword">auto</span> *pipeline_mng = <a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;PipelineManager&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// assemble operator to the right hand side</span></div>
<div class="line">  <span class="keyword">auto</span> add_domain_ops_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// push forward finite element bases from reference to physical element</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(pip, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>},</div>
<div class="line">                                                          <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="comment">// create local common data</span></div>
<div class="line">    <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">    <span class="comment">// calculate displacement gradients at integration points</span></div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code" href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">    <span class="comment">// assemble tangent operator</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> opFactoryDomainLhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        <a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>, <span class="stringliteral">&quot;U&quot;</span>, pip, <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, <a class="code" href="structPlasticProblem.html#a48eee41fb40c3920544fb006daadc52e">cpPtr</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_domain_ops_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// push forward finite element bases from reference to physical element</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(pip, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>},</div>
<div class="line">                                                          <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="comment">// create local common data</span></div>
<div class="line">    <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">    <span class="comment">// calculate displacement gradients at integration points</span></div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code" href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">    <span class="comment">// assemble residual</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> opFactoryDomainRhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        <a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>, <span class="stringliteral">&quot;U&quot;</span>, pip, <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, <a class="code" href="structPlasticProblem.html#a48eee41fb40c3920544fb006daadc52e">cpPtr</a>, Sev::inform);</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ContactOps::opFactoryDomainRhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        pip, <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Push operators to the left hand side pipeline. Indicate that domain (i.e.</span></div>
<div class="line">  <span class="comment">// volume/interior) element is used.</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_ops_lhs(pipeline_mng-&gt;getOpDomainLhsPipeline());</div>
<div class="line">  <span class="comment">// Push operators to the right hand side pipeline.</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_ops_rhs(pipeline_mng-&gt;getOpDomainRhsPipeline());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p>Note "ADOLCMAT" is an arbitrary name of the mesh block, with carrying information about the material model parameters. <br  />
</p>
<p>Implementation is dimension agnostic, i.e. dimensions of the problem are specialized while code compilation and shape of the elements shape and approximation base orders are decided during the runtimes. However, the implementation of the physics, i.e. elastoplastic phenomena, is free from those considerations about dimensions, order base, or element type.</p>
<p>Have particular attention to <a class="el" href="group__adoc__plasticity.html#gaba91a9dc29139716cab378b362f9e35c">ADOLCPlasticity::opFactoryDomainRhs</a> and <a class="el" href="group__adoc__plasticity.html#ga65919294102b10f2f01b5aed898c54c2">ADOLCPlasticity::opFactoryDomainLhs</a>, which are directly responsible for pushing operators to the right-hand side and left-hand side, respectively. Those follow patterns that you will find in the other tutorials, i.e. templates specialized for the dimension of the problem, assembly type, integrate method, and operator type. The dimensions of the people are obvious, i.e. 1D, 2D, or 3D.</p>
<p>Assembly could be for example <em>PETSC</em> assembly, that uses simply PETSCc functionality and uses PETSC function <a href="https://petsc.org/release/manualpages/Mat/MatSetValues/">MatSetValues</a>. In principle, technically, MatSetValues is specialized in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>, see for example <a class="el" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a>&lt;AssemblyTypeSelector&lt;SCHUR&gt;&gt;. However, users can imagine more complex cases, for example, special assembly for block diagonal parts, i.e. bubbles functions, and prefer calculating Schur complement, see for example <a class="el" href="tutorial_elastic_problem.html">VEC-0: Linear elasticity</a>. Other types of assembly are to be written for matrix-free approach, or to GPU. This typically can be separate from the implementation of the physics, i.e. elastoplasticity, that why templatised and specialized if necessary.</p>
<p>Similar considerations are for the integration method, typically GAUSS integrate is used, however, users seeking efficiency can use other methods, i.e. Duffy integrate for fast integration for high-order elements.</p>
<p>Finally, the operator type is responsible for handling abstractions related to specific shapes, dimensions, and element types. We exploit here powerful C++ type checking, to validate that dimension, assembly type, integration method, and operator type are compatible.</p>
<h2><a class="anchor" id="adolc_plasticity_assembly_history"></a>
Updating history</h2>
<p>Setting up the update of history variables is related to the solver you use, i.e. if you would use SNES solver, and program load stepping by yourself, at the end of each step, you need to call a finite element with the right pipeline operators by yourself.</p>
<p>However, in most tutorials, we use PETSC time solver (TS) to carry out time-stepping and inform TS to perform an update of history variables. By doing that we utilize the functionality of PETSC, tested by many users around the world. TS has generic functionality to perform such tasks, i.e. to update history variables, see <a href="https://petsc.org/release/manualpages/TS/TSSetPostStep/">TSSetPostStep</a>. The only issue is that TSSetPostStep requires passing a pointer to pure "C" function so we have to take care by passing data about the material model <br  />
 through the same static global variable.</p>
<p>We start with a snippet from <a class="el" href="adolc_plasticity_8cpp-example.html">adolc_plasticity.cpp</a>, creating time solver </p><div class="fragment"><div class="line">  <span class="keyword">auto</span> ts = pipeline_mng-&gt;createTSIM();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set time solver</span></div>
<div class="line">  <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetMaxTime(ts, ftime);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetExactFinalTime(ts, TS_EXACTFINALTIME_MATCHSTEP);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a> = <a class="code" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <a class="code" href="structContactOps_1_1CommonData.html#acad361eff40ea5259c2d789789fdf8d6">ContactOps::CommonData::createTotalTraction</a>(mField);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section_monitor(ts);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set monitor, step adaptivity, and post-step to update history variables</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_up_monitor(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_up_post_step(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_up_adapt(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, NULL);</div>
</div><!-- fragment --><p> Next, we call function setting TS post-step function, </p><div class="fragment"><div class="line">  <span class="keyword">auto</span> set_up_post_step = [&amp;](<span class="keyword">auto</span> ts) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// create finite element (pipeline) and populate it with operators to</span></div>
<div class="line">    <span class="comment">// update history variables</span></div>
<div class="line">    <span class="keyword">auto</span> create_update_ptr = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> fe_ptr = boost::make_shared&lt;DomainEle&gt;(mField);</div>
<div class="line">      fe_ptr-&gt;getRuleHook = cpPtr-&gt;integrationRule;</div>
<div class="line">      AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(fe_ptr-&gt;getOpPtrVector(),</div>
<div class="line">                                                     {H1});</div>
<div class="line">      <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">      <a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">          opFactoryDomainUpdate&lt;SPACE_DIM&gt;(mField, fe_ptr-&gt;getOpPtrVector(),</div>
<div class="line">                                           <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, cpPtr),</div>
<div class="line">          <span class="stringliteral">&quot;push update ops&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ts_update_ptr is global static variable</span></div>
<div class="line">    <a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a> =</div>
<div class="line">        <a class="code" href="namespaceADOLCPlasticity.html#a9a948d7e017d090c9357e2f0fdd3decc">createTSUpdate</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), create_update_ptr());</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [TS post-step function]</span></div>
<div class="line"><span class="comment"></span>    <span class="comment">// This is pure &quot;C&quot; function which we can to the TS solver</span></div>
<div class="line">    <span class="keyword">auto</span> ts_step_post_proc = [](TS ts) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a>)</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a>-&gt;postProcess(ts);</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [TS post-step function]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    <span class="comment">// finally set up post-step</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, ts_step_post_proc);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
</div><!-- fragment --><p>Note that this involves creating finite elements, creating data structures used internally by TS post-step function, and finally registering the function with TS.</p>
<p>Finally, we have to implement the intervention on the elements and execute operators associated with the pipeline. See snippet in <a class="el" href="ADOLCPlasticity_8cpp.html" title="Operators and data structures for ADOL-C plasticity.">ADOLCPlasticity.cpp</a> </p><div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief TS update history variables</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>TSUpdateImpl : <span class="keyword">public</span> TSUpdate {</div>
<div class="line"> </div>
<div class="line">  TSUpdateImpl(std::string fe_name, boost::shared_ptr&lt;FEMethod&gt; fe_ptr);</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> postProcess(TS ts);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; fePtr;</div>
<div class="line">  <span class="keyword">const</span> std::string feName;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">TSUpdateImpl::TSUpdateImpl(std::string fe_name,</div>
<div class="line">                           boost::shared_ptr&lt;FEMethod&gt; fe_ptr)</div>
<div class="line">    : feName(fe_name), fePtr(fe_ptr) {}</div>
<div class="line"> </div>
<div class="line"><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> TSUpdateImpl::postProcess(TS ts) {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  DM dm;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetDM(ts, &amp;dm);</div>
<div class="line">  <span class="comment">// This is where update is preformed. Element list is iterated and on each</span></div>
<div class="line">  <span class="comment">// element pipeline accessed throng fePtr is executed.</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, feName, fePtr);</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Create test update object</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * @param fe_name </span></div>
<div class="line"><span class="comment"> * @param fe_ptr </span></div>
<div class="line"><span class="comment"> * @return boost::shared_ptr&lt;TSUpdate&gt; </span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line">boost::shared_ptr&lt;TSUpdate&gt; <a class="code" href="namespaceADOLCPlasticity.html#a9a948d7e017d090c9357e2f0fdd3decc">createTSUpdate</a>(std::string fe_name,</div>
<div class="line">                                           boost::shared_ptr&lt;FEMethod&gt; fe_ptr) {</div>
<div class="line">  <span class="keywordflow">return</span> boost::make_shared&lt;TSUpdateImpl&gt;(fe_name, fe_ptr);</div>
<div class="line">}</div>
</div><!-- fragment --><p> You can see again here several levels of code encapsulation, which is necessary for integrating the code with other modules. Note that the user in the future can have other models that also require some update of the state, then it will simply call several update functions inside this snippet in <a class="el" href="adolc_plasticity_8cpp-example.html">adolc_plasticity.cpp</a> </p><div class="fragment"><div class="line">    <span class="comment">// This is pure &quot;C&quot; function which we can to the TS solver</span></div>
<div class="line">    <span class="keyword">auto</span> ts_step_post_proc = [](TS ts) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a>)</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a>-&gt;postProcess(ts);</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
</div><!-- fragment --> <h2><a class="anchor" id="adolc_plasticity_assembly_postprocessing"></a>
Postprocessing</h2>
<p>Postprocessing is a bit more complicated than in the case of linear elasticity. We use Lagrangian formulation, also called material formulation, in which each integration point has an associated material point that does not change through the analysis. For each material point, i.e. integration point, we record history, since the current state, stress, and elastic strain, depend on it.</p>
<p>However, to post-process results, we need to know the current state, such as stress at the mesh nodes, to visualize results in post-processing software, for example Paraview.</p>
<p>To solve that issue we use Discontinuous Galerkin (DG) projection, see implementation in <a class="el" href="structMoFEM_1_1OpLoopThis.html">MoFEM::OpLoopThis</a> or see code in <a class="el" href="dg_projection_8cpp-example.html">dg_projection.cpp</a>. The idea is to build local L2 based on the element, then project the stress and plastic strain on the local base, and then extrapolate to the mesh nodes. DG projection provides general functionality for scalar, vectorial and tensorial quantities, in this tutorial, we use it for stress and plastic strain, which are second-order symmetric tensors. See a snippet from <a class="el" href="adolc_plasticity_8cpp-example.html">adolc_plasticity.cpp</a> which implements the above idea </p><div class="fragment"><div class="line">    <span class="comment">// Post-process domain, i.e. volume elements. If 3d case creates stresses</span></div>
<div class="line">    <span class="comment">// are evaluated at points which are trace of the volume element on boundary</span></div>
<div class="line">    <span class="keyword">auto</span> post_proc_ele_domain = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;pip_domain, <span class="keyword">auto</span> &amp;fe_name) {</div>
<div class="line">      <span class="comment">// Push bases on reference element to the phyiscal element</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">          pip_domain, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>}, <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// calculate displacement gradients at nodes of post processing mesh. For</span></div>
<div class="line">      <span class="comment">// gradient DG projection is obsolete, since displacements can be</span></div>
<div class="line">      <span class="comment">// evaluated at arbitrary points.</span></div>
<div class="line">      <span class="keyword">auto</span> grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      pip_domain.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                                                   grad_ptr));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Create operator to run (neted) pipeline in operator. InteriorElem</span></div>
<div class="line">      <span class="comment">// element will have iteration rule and bases as domain element used to</span></div>
<div class="line">      <span class="comment">// solve problem, and remember history variables.</span></div>
<div class="line">      <span class="keyword">using</span> InteriorElem = <a class="code" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a>;</div>
<div class="line">      <span class="keyword">auto</span> op_this = <span class="keyword">new</span> OpLoopThis&lt;InteriorElem&gt;(mField, fe_name, Sev::noisy);</div>
<div class="line">      <span class="comment">// add interior element to post-processing pipeline</span></div>
<div class="line">      pip_domain.push_back(op_this);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get pointer to interior element, which is in essence pipeline which</span></div>
<div class="line">      <span class="comment">// pipeline.</span></div>
<div class="line">      <span class="keyword">auto</span> fe_physics = op_this-&gt;getThisFEPtr();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> evaluate_stress_on_physical_element = [&amp;]() {</div>
<div class="line">        <span class="comment">// evaluate stress and plastic strain at Gauss points</span></div>
<div class="line">        fe_physics-&gt;getRuleHook = cpPtr-&gt;integrationRule;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">            fe_physics-&gt;getOpPtrVector(), {H1});</div>
<div class="line">        <span class="keyword">auto</span> common_data_ptr =</div>
<div class="line">            boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">        <span class="comment">// note that gradient of displacements is evaluate again, at</span></div>
<div class="line">        <span class="comment">// physical nodes</span></div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">                <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> cpPtr-&gt;addMatBlockOps(mField, fe_physics-&gt;getOpPtrVector(),</div>
<div class="line">                                     <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, Sev::noisy);</div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(</div>
<div class="line">            getRawPtrOpCalculateStress&lt;SPACE_DIM&gt;(mField, common_data_ptr,</div>
<div class="line">                                                  cpPtr, <span class="keyword">false</span>));</div>
<div class="line">        <span class="keywordflow">return</span> common_data_ptr;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> dg_projection_froward_and_back = [&amp;](<span class="keyword">auto</span> &amp;common_data_ptr) {</div>
<div class="line">        <span class="comment">// here we do actual projection of stress and plastic strain to DG space</span></div>
<div class="line">        <span class="keywordtype">int</span> dg_order = approxOrder - 1;</div>
<div class="line">        <span class="keyword">auto</span> entity_data_l2 =</div>
<div class="line">            boost::make_shared&lt;EntitiesFieldData&gt;(MBENTITYSET);</div>
<div class="line">        <span class="keyword">auto</span> mass_ptr =</div>
<div class="line">            boost::make_shared&lt;MatrixDouble&gt;(); <span class="comment">//&lt; projection operator (mass</span></div>
<div class="line">                                                <span class="comment">// matrix)</span></div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpDGProjectionMassMatrix(</div>
<div class="line">            dg_order, mass_ptr, entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> coeffs_ptr_stress = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        <span class="comment">// project stress on DG space on physical element</span></div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpDGProjectionCoefficients(</div>
<div class="line">            common_data_ptr-&gt;getStressMatrixPtr(), coeffs_ptr_stress, mass_ptr,</div>
<div class="line">            entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line">        <span class="comment">// project strains plastic strains DG space on physical element</span></div>
<div class="line">        <span class="keyword">auto</span> coeffs_ptr_plastic_strain = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpDGProjectionCoefficients(</div>
<div class="line">            common_data_ptr-&gt;getPlasticStrainMatrixPtr(),</div>
<div class="line">            coeffs_ptr_plastic_strain, mass_ptr, entity_data_l2, approxBase,</div>
<div class="line">            <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// project stress and plastic strain for DG space on post-process</span></div>
<div class="line">        <span class="comment">// element</span></div>
<div class="line">        pip_domain.push_back(<span class="keyword">new</span> OpDGProjectionEvaluation(</div>
<div class="line">            common_data_ptr-&gt;getStressMatrixPtr(), coeffs_ptr_stress,</div>
<div class="line">            entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line">        pip_domain.push_back(<span class="keyword">new</span> OpDGProjectionEvaluation(</div>
<div class="line">            common_data_ptr-&gt;getPlasticStrainMatrixPtr(),</div>
<div class="line">            coeffs_ptr_plastic_strain, entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> common_data_ptr = evaluate_stress_on_physical_element();</div>
<div class="line">      dg_projection_froward_and_back(common_data_ptr);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> boost::make_tuple(grad_ptr, common_data_ptr-&gt;getStressMatrixPtr(),</div>
<div class="line">                               common_data_ptr-&gt;getPlasticStrainMatrixPtr());</div>
<div class="line">    };</div>
</div><!-- fragment --> <dl class="section note"><dt>Note</dt><dd>For 3D code implementation have an additional abstraction layer, in which the post-processing element is boundary elements, i.e. face. Then post-processing points at which mesh is evaluated are projected from the face element (boundary) to the volume element (domain), and then the DG projection is run on the domain element. That is part of more general <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> functionality, which is used in <a class="el" href="tutorial_contact_problem.html">ADV-1: Contact problem</a>, and in evaluating integrals on mesh skeleton, for methods such as Discontinuous Galerkin, see <a class="el" href="tutorial_dg_poisson.html">SCL-11: Discontinuous Galerkin for Poisson problem</a>. The key operator in this case is <a class="el" href="structMoFEM_1_1OpLoopSide.html">MoFEM::OpLoopSide</a>.</dd></dl>
<h1><a class="anchor" id="adolc_plasticity_example"></a>
Example</h1>
<p>The best way to run and play with the code is to use the JupyterHub and MoFEM docker container. Follow the instructions in <a class="el" href="install_docker_jupyterhub.html">Installation with Docker - JupyterHub</a> Then install the release version for code development, you will find a notebook in the JupterHub folder to do that. If you install the module from scratch, i.e. clone repository, build and install the module, you have to recreate Spack symlink, you simply rerun the last section of the install_from_source_release.md. The outcome of this will be that in folder um_view_release you will find the directory <em>adolc_plasticity</em>, and in it adolc_plasticity.md notebook. Run it and play with the parameters.</p>
<p>You can upload a mesh file and set up the problem in Cubit or gMesh. Also notebook creates zipped VTK files which you can download and post-process in Paraview. Any questions please write to <a href="https://groups.google.com/g/mofem-group">Q&amp;A</a>.</p>
<p>The following figures show the results of the kind of simulation which you can do in Jupyter notebook, see <a class="el" href="tutorial_adolc_plasticity.html#adolc_plot">Figure 2</a> and <a class="el" href="tutorial_adolc_plasticity.html#adolc_anim">Figure 3</a>.</p>
<p><a class="anchor" id="adolc_plot"></a></p><div class="image">
<img src="adolc_plot.png" alt="" width="800px"/>
<div class="caption">
Figure 2: Load history and load vs displacement response for a plate with the hole. Red color is for J2 plasticity response, blue paraboloidal model</div></div>
<p><a class="anchor" id="adolc_anim"></a></p><div class="image">
<img src="adolc_anim_plate_with_hole.gif" alt="" width="800px"/>
<div class="caption">
Figure 3: On top is the solution for paraboloidal model and on the bottom solution for J2 plasticity.</div></div>
<h1><a class="anchor" id="adolc_how_to_cite"></a>
How to cite?</h1>
<p>If you find code, or this tutorial useful, and use it as a guide for your work, please cite the following paper <em>The</em> <em>Journal</em> <em>of</em> <em>Open</em> <em>Source</em> <em>Software</em>  
<a href="http://joss.theoj.org/papers/43d9625e5ed28d5c493bfc0fae6d8215">
<img src="https://joss.theoj.org/papers/10.21105/joss.01441/status.svg"></a>
 (follow the link on the badge).</p>
<h1><a class="anchor" id="adolc_plasticity_code"></a>
Code</h1>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file adolc_plasticity.cpp</span></div>
<div class="line"><span class="comment"> * \ingroup adoc_plasticity</span></div>
<div class="line"><span class="comment"> * \example adolc_plasticity.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brife Implementation of plasticity problem using ADOLC-C</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MatrixFunction_8hpp.html">MatrixFunction.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line">constexpr <span class="keywordtype">int</span> <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> =</div>
<div class="line">    <a class="code" href="plastic_8cpp.html#a49d2a41e935ccc68adc5a9268619cba1">EXECUTABLE_DIMENSION</a>; <span class="comment">//&lt; Space dimension of problem, mesh</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> = <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Select finite element type for integration on domain based on problem</span></div>
<div class="line"><span class="comment"> * dimension</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a> = <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::DomainEle</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Select finite element type for integrate on boundary based on problem</span></div>
<div class="line"><span class="comment"> * dimension</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;<span class="comment"></span></div>
<div class="line"><span class="comment">/** Operators used to assemble domain integrals</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classDomainEleOp.html">DomainEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">DomainEle::UserDataOperator</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Operators used to assemble boundary integrals</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="classBoundaryEleOp.html">BoundaryEleOp</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">BoundaryEle::UserDataOperator</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Linear forms used to integrate body forces</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1NaturalBC_1_1Assembly_1_1LinearForm.html">DomainNaturalBC</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1NaturalBC_1_1Assembly.html">NaturalBC&lt;DomainEleOp&gt;::Assembly</a>&lt;<a class="code" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181ba2243b0abb08ad80d05c47e734f3134bc">PETSC</a>&gt;::LinearForm&lt;GAUSS&gt;;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Select linear froms reading data from blockest (e.g. &quot;BODY_FORCE&quot;) and</span></div>
<div class="line"><span class="comment"> * applying body force.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1OpFluxRhsImpl.html">OpBodyForce</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1OpFluxRhsImpl.html">DomainNaturalBC::OpFlux&lt;NaturalMeshsetType&lt;BLOCKSET&gt;</a>, 1, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Select natural BC boundary condition</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use natural boundary conditions implemented with adv-1 example which includes</span></div>
<div class="line"><span class="comment">// spring BC</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ContactNaturalBC_8hpp.html">ContactNaturalBC.hpp</a>&gt;</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Use Gauss quadrature rule and PETSc assembly to integrate neural boundary</span></div>
<div class="line"><span class="comment"> * conditions. Select linear forms operators.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1NaturalBC_1_1Assembly_1_1LinearForm.html">BoundaryRhsBCs</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1NaturalBC_1_1Assembly.html">NaturalBC&lt;BoundaryEleOp&gt;::Assembly</a>&lt;<a class="code" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181ba2243b0abb08ad80d05c47e734f3134bc">PETSC</a>&gt;::LinearForm&lt;GAUSS&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">/* Use specialization from adv-1 integrating boundary conditions on forces and</span></div>
<div class="line"><span class="comment"> * with springs. OP is used to integrate the right hand side</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1OpFluxRhsImpl.html">OpBoundaryRhsBCs</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1OpFluxRhsImpl.html">BoundaryRhsBCs::OpFlux&lt;ContactOps::BoundaryBCs, 1, SPACE_DIM&gt;</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Use Gauss quadrature rule and PETSc assembly to integrate neural boundary</span></div>
<div class="line"><span class="comment"> * conditions. Select bi-linear forms operators.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1NaturalBC_1_1Assembly_1_1BiLinearForm.html">BoundaryLhsBCs</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1NaturalBC_1_1Assembly.html">NaturalBC&lt;BoundaryEleOp&gt;::Assembly</a>&lt;<a class="code" href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181ba2243b0abb08ad80d05c47e734f3134bc">PETSC</a>&gt;<a class="code" href="classBiLinearForm.html">::BiLinearForm&lt;GAUSS&gt;</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** Use specialization from adv-1 integrating boundary conditions on forces and</span></div>
<div class="line"><span class="comment"> * with springs</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1OpFluxLhsImpl.html">OpBoundaryLhsBCs</a> =</div>
<div class="line">    <a class="code" href="structMoFEM_1_1OpFluxLhsImpl.html">BoundaryLhsBCs::OpFlux&lt;ContactOps::BoundaryBCs, 1, SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Note: We create only skin post-processing mesh.</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt;</div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structElementsAndOps.html">ElementsAndOps</a>; <span class="comment">//&lt; Select finite elements and operators used for</span></div>
<div class="line">                       <span class="comment">// postprocessing and contact space</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structElementsAndOps.html">ElementsAndOps</a>&lt;2&gt; {</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#a06a735b6649ab72b1c55b0c3e4ace878">PostProcEleDomain</a> = <a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoabBase.html">PostProcBrokenMeshInMoabBase&lt;DomainEle&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#aa3a41bb6c8e21d9d5b1acfc97e34c178">PostProcEleBdy</a> = <a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoabBase.html">PostProcBrokenMeshInMoabBase&lt;BoundaryEle&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;2&gt;::FaceSideEle</a>;</div>
<div class="line">  <span class="keyword">static</span> constexpr <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a> = <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82">HCURL</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span><a class="code" href="structElementsAndOps.html">ElementsAndOps</a>&lt;3&gt; {</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#a06a735b6649ab72b1c55b0c3e4ace878">PostProcEleDomain</a> = <a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoabBase.html">PostProcBrokenMeshInMoabBase&lt;DomainEle&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#aa3a41bb6c8e21d9d5b1acfc97e34c178">PostProcEleBdy</a> = <a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoabBase.html">PostProcBrokenMeshInMoabBase&lt;BoundaryEle&gt;</a>;</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code" href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">PipelineManager::ElementsAndOpsByDim&lt;3&gt;::FaceSideEle</a>;</div>
<div class="line">  <span class="keyword">static</span> constexpr <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a> = <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>;</div>
<div class="line">};</div>
<div class="line"><span class="comment">// Define contact space by dimension</span></div>
<div class="line">constexpr <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code" href="structElementsAndOps.html">ElementsAndOps&lt;2&gt;::CONTACT_SPACE</a>;</div>
<div class="line">constexpr <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code" href="structElementsAndOps.html">ElementsAndOps&lt;3&gt;::CONTACT_SPACE</a>;</div>
<div class="line">constexpr <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a> <a class="code" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a> = <a class="code" href="structElementsAndOps.html">ElementsAndOps&lt;SPACE_DIM&gt;::CONTACT_SPACE</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#a06a735b6649ab72b1c55b0c3e4ace878">PostProcEleDomain</a> = <a class="code" href="structElementsAndOps.html">ElementsAndOps&lt;SPACE_DIM&gt;::PostProcEleDomain</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code" href="structElementsAndOps.html">ElementsAndOps&lt;SPACE_DIM&gt;::SideEle</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#aa3a41bb6c8e21d9d5b1acfc97e34c178">PostProcEleBdy</a> = <a class="code" href="structElementsAndOps.html">ElementsAndOps&lt;SPACE_DIM&gt;::PostProcEleBdy</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ADOLCPlasticity_8hpp.html">ADOLCPlasticity.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ADOLCPlasticityMaterialModels_8hpp.html">ADOLCPlasticityMaterialModels.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceADOLCPlasticity.html">ADOLCPlasticity</a>;</div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> = 1.;</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python/def.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python/numpy.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>bp = boost::python;</div>
<div class="line"><span class="keyword">namespace </span>np = boost::python::numpy;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceContactOps.html">ContactOps</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a class="code" href="namespaceContactOps.html#a3449dc094e02f6a72aa4c5ea32c55e2c">cn_contact</a> = 0.1;</div>
<div class="line"> </div>
<div class="line">}; <span class="comment">// namespace ContactOps</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="ContactOps_8hpp.html">ContactOps.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structPlasticProblem.html">PlasticProblem</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structPlasticProblem.html">PlasticProblem</a>(<a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : mField(m_field) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> runProblem();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;mField;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> readMesh();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> setupProblem();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> boundaryCondition();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> assembleSystem();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> solveSystem();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> gettingNorms();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> outputResults();</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> checkResults();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> approxOrder = 2;</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code" href="plastic_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a> = 2;</div>
<div class="line">  <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a> approxBase = <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>;</div>
<div class="line">  boost::shared_ptr&lt;ClosestPointProjection&gt; cpPtr; <span class="comment">///&lt; Closest point</span></div>
<div class="line"><span class="comment"></span><span class="comment">                                                   ///&lt; projection</span></div>
<div class="line"><span class="comment"></span><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line">  boost::shared_ptr&lt;ContactOps::SDFPython&gt; sdfPythonPtr;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Run problem]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#abb0809e4aa5ce3c9ed3527589a0e4700">PlasticProblem::runProblem</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> readMesh();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setupProblem();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> boundaryCondition();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> assembleSystem();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> solveSystem();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> gettingNorms();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> outputResults();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> checkResults();</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Run problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a31cf037a330e535948dac3d980124879">PlasticProblem::readMesh</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getOptions();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;loadFile();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDim() != <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>)</div>
<div class="line">    SETERRQ2(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">             <span class="stringliteral">&quot;Wrong dimension of mesh %d != %d&quot;</span>, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDim(), <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a0b9a2881ee6be9f98852c9e1af165b35">PlasticProblem::setupProblem</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code" href="structMoFEM_1_1Simple.html">Simple</a> *<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> bases { AINSWORTH, DEMKOWICZ, LASBASETOPT };</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_bases[LASBASETOPT] = {<span class="stringliteral">&quot;ainsworth&quot;</span>, <span class="stringliteral">&quot;demkowicz&quot;</span>};</div>
<div class="line">  PetscInt choice_base_value = AINSWORTH;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#abee82d436d03244c6886fc99f71116f0">PetscOptionsGetEList</a>(PETSC_NULL, NULL, <span class="stringliteral">&quot;-base&quot;</span>, list_bases,</div>
<div class="line">                              LASBASETOPT, &amp;choice_base_value, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;approxOrder, PETSC_NULL);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-geom_order&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a>,</div>
<div class="line">                            PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (choice_base_value) {</div>
<div class="line">  <span class="keywordflow">case</span> AINSWORTH:</div>
<div class="line">    approxBase = <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>;</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Set AINSWORTH_LEGENDRE_BASE for displacements&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> DEMKOWICZ:</div>
<div class="line">    approxBase = <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>;</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Set DEMKOWICZ_JACOBI_BASE for displacements&quot;</span>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    approxBase = <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a35e0a7e42f81919e776c310c509598da">LASTBASE</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add field</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, approxBase, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, approxBase, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDataField(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, approxBase, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;SIGMA&quot;</span>, <a class="code" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>,</div>
<div class="line">                                <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;SIGMA&quot;</span>, <a class="code" href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>,</div>
<div class="line">                                  <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <span class="keyword">auto</span> get_skin = [&amp;]() {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> body_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(0, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    Skinner skin(&amp;mField.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> skin_ents;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents);</div>
<div class="line">    <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> filter_blocks = [&amp;](<span class="keyword">auto</span> skin) {</div>
<div class="line">    <span class="keywordtype">bool</span> is_contact_block = <span class="keyword">false</span>;</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> contact_range;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> :</div>
<div class="line">         mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(std::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % <span class="stringliteral">&quot;CONTACT&quot;</span>).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      is_contact_block =</div>
<div class="line">          <span class="keyword">true</span>; <span class="comment">///&lt; bloks interation is collectibe, so that is set irrespective</span></div>
<div class="line"><span class="comment"></span><span class="comment">                ///&lt; if there are enerities in given rank or not in the block</span></div>
<div class="line"><span class="comment"></span>      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Find contact block set:  &quot;</span> &lt;&lt; <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;getName();</div>
<div class="line">      <span class="keyword">auto</span> meshset = <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;getMeshset();</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> contact_meshset_range;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_dimension(</div>
<div class="line">          meshset, <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, contact_meshset_range, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1CommInterface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">          contact_meshset_range);</div>
<div class="line">      contact_range.merge(contact_meshset_range);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (is_contact_block) {</div>
<div class="line">      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Nb entities in contact surface: &quot;</span> &lt;&lt; contact_range.size();</div>
<div class="line">      <a class="code" href="LogManager_8hpp.html#adacc7b9e7c4fa95cc0959ca359f999f5">MOFEM_LOG_SYNCHRONISE</a>(mField.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>());</div>
<div class="line">      skin = intersect(skin, contact_range);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> filter_true_skin = [&amp;](<span class="keyword">auto</span> skin) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> boundary_ents;</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;mField.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>(), <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;boundary_ents);</div>
<div class="line">    <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> boundary_ents = filter_true_skin(filter_blocks(get_skin()));</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;SIGMA&quot;</span>, 0);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;SIGMA&quot;</span>, approxOrder - 1, &amp;boundary_ents);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-cn_contact&quot;</span>,</div>
<div class="line">                               &amp;<a class="code" href="namespaceContactOps.html#a3449dc094e02f6a72aa4c5ea32c55e2c">ContactOps::cn_contact</a>, PETSC_NULL);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;cn_contact &quot;</span> &lt;&lt; <a class="code" href="namespaceContactOps.html#a3449dc094e02f6a72aa4c5ea32c55e2c">ContactOps::cn_contact</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line">  sdfPythonPtr = boost::make_shared&lt;ContactOps::SDFPython&gt;();</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sdfPythonPtr-&gt;sdfInit(<span class="stringliteral">&quot;sdf.py&quot;</span>);</div>
<div class="line">  ContactOps::sdfPythonWeakPtr = sdfPythonPtr;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;U&quot;</span>, approxOrder);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, <a class="code" href="plastic_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setUp();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> project_ho_geometry = [&amp;]() {</div>
<div class="line">    <a class="code" href="structMoFEM_1_1Projection10NodeCoordsOnField.html">Projection10NodeCoordsOnField</a> ent_method(mField, <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> mField.<a class="code" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, ent_method);</div>
<div class="line">  };</div>
<div class="line">  PetscBool project_geometry = PETSC_TRUE;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-project_geometry&quot;</span>,</div>
<div class="line">                             &amp;project_geometry, PETSC_NULL);</div>
<div class="line">  <span class="keywordflow">if</span> (project_geometry) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> project_ho_geometry();</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Material models selection]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * FIXME: Here only array of material models is initalized. Each model has</span></div>
<div class="line"><span class="comment">   * unique set of the ADOL-C tags. Pointer is attached based on block name to</span></div>
<div class="line"><span class="comment">   * which entity belongs. That will enable heterogeneity of the model, in</span></div>
<div class="line"><span class="comment">   * addition of heterogeneity of the material properties.</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> MaterialModel {</div>
<div class="line">    VonMisses,</div>
<div class="line">    VonMissesPlaneStress,</div>
<div class="line">    Paraboloidal,</div>
<div class="line">    LastModel</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_materials[LastModel] = {<span class="stringliteral">&quot;VonMisses&quot;</span>, <span class="stringliteral">&quot;VonMissesPlaneStress&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;Paraboloidal&quot;</span>};</div>
<div class="line">  PetscInt choice_material = VonMisses;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#abee82d436d03244c6886fc99f71116f0">PetscOptionsGetEList</a>(PETSC_NULL, NULL, <span class="stringliteral">&quot;-material&quot;</span>, list_materials,</div>
<div class="line">                              LastModel, &amp;choice_material, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (choice_material) {</div>
<div class="line">  <span class="keywordflow">case</span> VonMisses:</div>
<div class="line">    cpPtr = createMaterial&lt;J2Plasticity&lt;3&gt;&gt;();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> VonMissesPlaneStress:</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> != 2)</div>
<div class="line">      SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">              <span class="stringliteral">&quot;VonMissesPlaneStrain is only for 2D case&quot;</span>);</div>
<div class="line">    cpPtr = createMaterial&lt;J2Plasticity&lt;2&gt;&gt;();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> Paraboloidal:</div>
<div class="line">    cpPtr = createMaterial&lt;ParaboloidalPlasticity&gt;();</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Wrong material model&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (approxBase == <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a> &amp;&amp; <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> == 2)</div>
<div class="line">    cpPtr-&gt;integrationRule = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2 * (p - 2); };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Material models selection]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a512e17945fff13f02e112034b56c595f">PlasticProblem::boundaryCondition</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> *pipeline_mng = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bc_mng = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1BcManager.html">BcManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> time_scale = boost::make_shared&lt;TimeScale&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> rule = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 2 * p; };</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainRhsIntegrationRule(cpPtr-&gt;integrationRule);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainLhsIntegrationRule(cpPtr-&gt;integrationRule);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryRhsIntegrationRule(rule);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(rule);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      pipeline_mng-&gt;getOpBoundaryLhsPipeline(), {HDIV}, <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">  pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetHOWeightsOnSubDim.html">OpSetHOWeightsOnSubDim&lt;SPACE_DIM&gt;</a>());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      pipeline_mng-&gt;getOpBoundaryRhsPipeline(), {HDIV}, <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">  pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetHOWeightsOnSubDim.html">OpSetHOWeightsOnSubDim&lt;SPACE_DIM&gt;</a>());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add Natural BCs to RHS</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddFluxToRhsPipelineImpl.html">BoundaryRhsBCs::AddFluxToPipeline&lt;OpBoundaryRhsBCs&gt;::add</a>(</div>
<div class="line">      pipeline_mng-&gt;getOpBoundaryRhsPipeline(), mField, <span class="stringliteral">&quot;U&quot;</span>, {time_scale},</div>
<div class="line">      Sev::inform);</div>
<div class="line">  <span class="comment">// Add Natural BCs to LHS</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddFluxToLhsPipelineImpl.html">BoundaryLhsBCs::AddFluxToPipeline&lt;OpBoundaryLhsBCs&gt;::add</a>(</div>
<div class="line">      pipeline_mng-&gt;getOpBoundaryLhsPipeline(), mField, <span class="stringliteral">&quot;U&quot;</span>, Sev::inform);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  ContactOps::opFactoryBoundaryLhs&lt;SPACE_DIM, PETSC, GAUSS, BoundaryEleOp&gt;(</div>
<div class="line">      pipeline_mng-&gt;getOpBoundaryLhsPipeline(), <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  ContactOps::opFactoryBoundaryToDomainLhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEle&gt;(</div>
<div class="line">      mField, pipeline_mng-&gt;getOpBoundaryLhsPipeline(),</div>
<div class="line">      <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;GEOMETRY&quot;</span>,</div>
<div class="line">      cpPtr-&gt;integrationRule);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  ContactOps::opFactoryBoundaryRhs&lt;SPACE_DIM, PETSC, GAUSS, BoundaryEleOp&gt;(</div>
<div class="line">      pipeline_mng-&gt;getOpBoundaryRhsPipeline(), <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! Add body froces</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddFluxToRhsPipelineImpl.html">DomainNaturalBC::AddFluxToPipeline&lt;OpBodyForce&gt;::add</a>(</div>
<div class="line">      pipeline_mng-&gt;getOpDomainRhsPipeline(), mField, <span class="stringliteral">&quot;U&quot;</span>, {time_scale},</div>
<div class="line">      <span class="stringliteral">&quot;BODY_FORCE&quot;</span>, Sev::inform);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Essential BC</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;REMOVE_X&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;U&quot;</span>, 0, 0);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;REMOVE_Y&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;U&quot;</span>, 1, 1);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;REMOVE_Z&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;U&quot;</span>, 2, 2);</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> b : {<span class="stringliteral">&quot;FIX_X&quot;</span>, <span class="stringliteral">&quot;REMOVE_X&quot;</span>})</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), b,</div>
<div class="line">                                             <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, 0, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> b : {<span class="stringliteral">&quot;FIX_Y&quot;</span>, <span class="stringliteral">&quot;REMOVE_Y&quot;</span>})</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), b,</div>
<div class="line">                                             <span class="stringliteral">&quot;SIGMA&quot;</span>, 1, 1, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> b : {<span class="stringliteral">&quot;FIX_Z&quot;</span>, <span class="stringliteral">&quot;REMOVE_Z&quot;</span>})</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), b,</div>
<div class="line">                                             <span class="stringliteral">&quot;SIGMA&quot;</span>, 2, 2, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> b : {<span class="stringliteral">&quot;FIX_ALL&quot;</span>, <span class="stringliteral">&quot;REMOVE_ALL&quot;</span>})</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), b,</div>
<div class="line">                                             <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, 3, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(</div>
<div class="line">      <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;NO_CONTACT&quot;</span>, <span class="stringliteral">&quot;SIGMA&quot;</span>, 0, 3, <span class="keyword">false</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;pushMarkDOFsOnEntities&lt;<a class="code" href="structMoFEM_1_1DisplacementCubitBcData.html">DisplacementCubitBcData</a>&gt;(</div>
<div class="line">      <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Push operators to pipeline]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a9a0af54d9bcdc0ebab2aaa1aaa1b0585">PlasticProblem::assembleSystem</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> *<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> *pipeline_mng = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// assemble operator to the right hand side</span></div>
<div class="line">  <span class="keyword">auto</span> add_domain_ops_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// push forward finite element bases from reference to physical element</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>},</div>
<div class="line">                                                          <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="comment">// create local common data</span></div>
<div class="line">    <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">    <span class="comment">// calculate displacement gradients at integration points</span></div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">    <span class="comment">// assemble tangent operator</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> opFactoryDomainLhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        mField, <span class="stringliteral">&quot;U&quot;</span>, pip, <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, cpPtr);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_domain_ops_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// push forward finite element bases from reference to physical element</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>},</div>
<div class="line">                                                          <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line">    <span class="comment">// create local common data</span></div>
<div class="line">    <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">    <span class="comment">// calculate displacement gradients at integration points</span></div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">    <span class="comment">// assemble residual</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> opFactoryDomainRhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        mField, <span class="stringliteral">&quot;U&quot;</span>, pip, <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, cpPtr, Sev::inform);</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ContactOps::opFactoryDomainRhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        pip, <span class="stringliteral">&quot;SIGMA&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Push operators to the left hand side pipeline. Indicate that domain (i.e.</span></div>
<div class="line">  <span class="comment">// volume/interior) element is used.</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_ops_lhs(pipeline_mng-&gt;getOpDomainLhsPipeline());</div>
<div class="line">  <span class="comment">// Push operators to the right hand side pipeline.</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_domain_ops_rhs(pipeline_mng-&gt;getOpDomainRhsPipeline());</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Push operators to pipeline]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Monitor solution</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This functions is called by TS solver at the end of each step. It is used</span></div>
<div class="line"><span class="comment"> * to output results to the hard drive.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structPlasticOps_1_1Monitor.html">Monitor</a> : <span class="keyword">public</span> <a class="code" href="structMoFEM_1_1FEMethod.html">FEMethod</a> {</div>
<div class="line">  <a class="code" href="structPlasticOps_1_1Monitor.html">Monitor</a>(<a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;DM&gt;</a> dm,</div>
<div class="line">          std::pair&lt;boost::shared_ptr&lt;PostProcEleDomain&gt;,</div>
<div class="line">                    boost::shared_ptr&lt;PostProcEleBdy&gt;&gt;</div>
<div class="line">              pair_post_proc_fe,</div>
<div class="line">          boost::shared_ptr&lt;DomainEle&gt; reaction_fe,</div>
<div class="line">          std::vector&lt;boost::shared_ptr&lt;ScalingMethod&gt;&gt; smv)</div>
<div class="line">      : dM(dm), reactionFE(reaction_fe), vecOfTimeScalingMethods(smv) {</div>
<div class="line">    fRes = <a class="code" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dM);</div>
<div class="line">    domainPostProcFe = pair_post_proc_fe.first;</div>
<div class="line">    skinPostProcFe = pair_post_proc_fe.second;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dM, &amp;m_field_ptr);</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">    <span class="keyword">auto</span> get_integrate_traction = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> integrate_traction = boost::make_shared&lt;BoundaryEle&gt;(*m_field_ptr);</div>
<div class="line">      <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line">      <a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">          (<a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">              integrate_traction-&gt;getOpPtrVector(), {HDIV}, <span class="stringliteral">&quot;GEOMETRY&quot;</span>)),</div>
<div class="line">          <span class="stringliteral">&quot;Apply transform&quot;</span>);</div>
<div class="line">      <span class="comment">// We have to integrate on curved face geometry, thus integration weight</span></div>
<div class="line">      <span class="comment">// have to adjusted.</span></div>
<div class="line">      integrate_traction-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetHOWeightsOnSubDim.html">OpSetHOWeightsOnSubDim&lt;SPACE_DIM&gt;</a>());</div>
<div class="line">      integrate_traction-&gt;getRuleHook = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code" href="test__broken__space_8cpp.html#a190ff8a4b88c3f62a7da15f5a2b8c227">approx_order</a>) {</div>
<div class="line">        <span class="keywordflow">return</span> 2 * <a class="code" href="test__broken__space_8cpp.html#a190ff8a4b88c3f62a7da15f5a2b8c227">approx_order</a> + 2 - 1;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">          (<a class="code" href="namespaceContactOps.html#afa975b4e7296be3d38990611693a708b">ContactOps::opFactoryCalculateTraction</a>&lt;<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>,</div>
<div class="line">                                                  <a class="code" href="classBoundaryEleOp.html">BoundaryEleOp</a>&gt;(</div>
<div class="line">              integrate_traction-&gt;getOpPtrVector(), <span class="stringliteral">&quot;SIGMA&quot;</span>, 0)),</div>
<div class="line">          <span class="stringliteral">&quot;push operators to calculate traction&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> integrate_traction;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    integrateTraction = get_integrate_traction();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> postProcess() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a> = 1;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-save_every_nth_step&quot;</span>,</div>
<div class="line">                              &amp;<a class="code" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a>, PETSC_NULL);</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">    <span class="keyword">auto</span> print_traction = [&amp;](<span class="keyword">const</span> std::string msg) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dM, &amp;m_field_ptr);</div>
<div class="line">      <span class="keywordflow">if</span> (!m_field_ptr-&gt;<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> *t_ptr;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(<a class="code" href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>, &amp;t_ptr);</div>
<div class="line">        <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, Sev::inform, <span class="stringliteral">&quot;%s time %3.4e %3.4e %3.4e %3.4e&quot;</span>,</div>
<div class="line">                    msg.c_str(), ts_t, t_ptr[0], t_ptr[1], t_ptr[2]);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(<a class="code" href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>,</div>
<div class="line">                                   &amp;t_ptr);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> make_vtk = [&amp;]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (domainPostProcFe) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, <span class="stringliteral">&quot;dFE&quot;</span>, domainPostProcFe,</div>
<div class="line">                                        getCacheWeakPtr());</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> domainPostProcFe-&gt;writeFile(</div>
<div class="line">            <span class="stringliteral">&quot;out_plastic_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(ts_step) +</div>
<div class="line">            <span class="stringliteral">&quot;.h5m&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (skinPostProcFe) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, <span class="stringliteral">&quot;bFE&quot;</span>, skinPostProcFe,</div>
<div class="line">                                        getCacheWeakPtr());</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skinPostProcFe-&gt;writeFile(</div>
<div class="line">            <span class="stringliteral">&quot;out_skin_plastic_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(ts_step) +</div>
<div class="line">            <span class="stringliteral">&quot;.h5m&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!(ts_step % <a class="code" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a>)) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> make_vtk();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (reactionFE) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(fRes);</div>
<div class="line">      reactionFE-&gt;f = fRes;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, <span class="stringliteral">&quot;dFE&quot;</span>, reactionFE, getCacheWeakPtr());</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(fRes);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(fRes);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(fRes, ADD_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(fRes, ADD_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dM, &amp;m_field_ptr);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1EssentialPreProcReaction_3_01DisplacementCubitBcData_01_4.html">EssentialPreProcReaction&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          *m_field_ptr, reactionFE, fRes)();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> nrm;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(fRes, NORM_2, &amp;nrm);</div>
<div class="line">      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::verbose)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Residual norm &quot;</span> &lt;&lt; nrm &lt;&lt; <span class="stringliteral">&quot; at time step &quot;</span> &lt;&lt; ts_step;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">    <span class="keyword">auto</span> calculate_traction = [&amp;] {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code" href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, <span class="stringliteral">&quot;bFE&quot;</span>, integrateTraction);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(<a class="code" href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(<a class="code" href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>);</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_min_max_displacement = [&amp;]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dM, &amp;m_field_ptr);</div>
<div class="line"> </div>
<div class="line">      std::array&lt;double, 4&gt; a_min = {DBL_MAX, DBL_MAX, DBL_MAX, 0};</div>
<div class="line">      std::array&lt;double, 4&gt; a_max = {-DBL_MAX, -DBL_MAX, -DBL_MAX, 0};</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_min_max = [&amp;](boost::shared_ptr&lt;FieldEntity&gt; field_entity_ptr) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordtype">int</span> <a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : field_entity_ptr-&gt;getEntFieldData()) {</div>
<div class="line">          a_min[<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>] = std::min(a_min[<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line">          a_max[<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>] = std::max(a_max[<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>], <a class="code" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line">          ++<a class="code" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>;</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      a_min[<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>] = 0;</div>
<div class="line">      a_max[<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>] = 0;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="classRange.html">Range</a> verts;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ptr-&gt;<a class="code" href="group__mofem__field.html#gac40504ee45e0bdaddfdf1f7858b54a4a">get_field_entities_by_type</a>(<span class="stringliteral">&quot;U&quot;</span>, MBVERTEX, verts);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ptr-&gt;<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;fieldLambdaOnEntities(</div>
<div class="line">          get_min_max, <span class="stringliteral">&quot;U&quot;</span>, &amp;verts);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> mpi_reduce = [&amp;](<span class="keyword">auto</span> &amp;<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, <span class="keyword">auto</span> op) {</div>
<div class="line">        std::array&lt;double, 3&gt; a_mpi = {0, 0, 0};</div>
<div class="line">        MPI_Allreduce(<a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>.data(), a_mpi.data(), 3, MPI_DOUBLE, op,</div>
<div class="line">                      m_field_ptr-&gt;<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>());</div>
<div class="line">        <span class="keywordflow">return</span> a_mpi;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> a_min_mpi = mpi_reduce(a_min, MPI_MIN);</div>
<div class="line">      <span class="keyword">auto</span> a_max_mpi = mpi_reduce(a_max, MPI_MAX);</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Min displacement &quot;</span> &lt;&lt; a_min_mpi[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a_min_mpi[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">          &lt;&lt; a_min_mpi[2];</div>
<div class="line">      <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Max displacement &quot;</span> &lt;&lt; a_max_mpi[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; a_max_mpi[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">          &lt;&lt; a_max_mpi[2];</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> get_min_max_displacement();</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calculate_traction();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_traction(<span class="stringliteral">&quot;Contact force&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> = 1;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : vecOfTimeScalingMethods) {</div>
<div class="line">      <a class="code" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> *= s-&gt;getScale(this-&gt;ts_t);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Time: &quot;</span> &lt;&lt; this-&gt;ts_t &lt;&lt; <span class="stringliteral">&quot; scale: &quot;</span> &lt;&lt; <a class="code" href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;DM&gt;</a> dM;</div>
<div class="line">  boost::shared_ptr&lt;PostProcEleDomain&gt; domainPostProcFe;</div>
<div class="line">  boost::shared_ptr&lt;PostProcEleBdy&gt; skinPostProcFe;</div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; reactionFE;</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;BoundaryEle&gt; integrateTraction;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> fRes;</div>
<div class="line">  <a class="code" href="namespaceMoFEM.html#a4e9536ce1c9cadcb7f26d36a4e96d76e">VecOfTimeScalingMethods</a> vecOfTimeScalingMethods;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> boost::shared_ptr&lt;TSUpdate&gt; <a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#af28654edd552346301dbbd396730b9b2">PlasticProblem::solveSystem</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> *<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> *pipeline_mng = mField.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1PipelineManager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">  <span class="keyword">auto</span> time_scale = boost::make_shared&lt;TimeScale&gt;();</div>
<div class="line">  <span class="keyword">auto</span> snes_ctx_ptr = <a class="code" href="namespaceMoFEM.html#addce2077b77e610d248ae548a01e77e3">getDMSnesCtx</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Setup postprocessing</span></div>
<div class="line">  <span class="keyword">auto</span> create_post_proc_fe = [dm, <span class="keyword">this</span>, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>]() {<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [DG projection]</span></div>
<div class="line"><span class="comment"></span>    <span class="comment">// Post-process domain, i.e. volume elements. If 3d case creates stresses</span></div>
<div class="line">    <span class="comment">// are evaluated at points which are trace of the volume element on boundary</span></div>
<div class="line">    <span class="keyword">auto</span> post_proc_ele_domain = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;pip_domain, <span class="keyword">auto</span> &amp;fe_name) {</div>
<div class="line">      <span class="comment">// Push bases on reference element to the phyiscal element</span></div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          pip_domain, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>}, <span class="stringliteral">&quot;GEOMETRY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// calculate displacement gradients at nodes of post processing mesh. For</span></div>
<div class="line">      <span class="comment">// gradient DG projection is obsolete, since displacements can be</span></div>
<div class="line">      <span class="comment">// evaluated at arbitrary points.</span></div>
<div class="line">      <span class="keyword">auto</span> grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      pip_domain.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                                                   grad_ptr));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Create operator to run (neted) pipeline in operator. InteriorElem</span></div>
<div class="line">      <span class="comment">// element will have iteration rule and bases as domain element used to</span></div>
<div class="line">      <span class="comment">// solve problem, and remember history variables.</span></div>
<div class="line">      <span class="keyword">using</span> InteriorElem = <a class="code" href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a>;</div>
<div class="line">      <span class="keyword">auto</span> op_this = <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopThis.html">OpLoopThis&lt;InteriorElem&gt;</a>(mField, fe_name, Sev::noisy);</div>
<div class="line">      <span class="comment">// add interior element to post-processing pipeline</span></div>
<div class="line">      pip_domain.push_back(op_this);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get pointer to interior element, which is in essence pipeline which</span></div>
<div class="line">      <span class="comment">// pipeline.</span></div>
<div class="line">      <span class="keyword">auto</span> fe_physics = op_this-&gt;getThisFEPtr();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> evaluate_stress_on_physical_element = [&amp;]() {</div>
<div class="line">        <span class="comment">// evaluate stress and plastic strain at Gauss points</span></div>
<div class="line">        fe_physics-&gt;getRuleHook = cpPtr-&gt;integrationRule;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">            fe_physics-&gt;getOpPtrVector(), {H1});</div>
<div class="line">        <span class="keyword">auto</span> common_data_ptr =</div>
<div class="line">            boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">        <span class="comment">// note that gradient of displacements is evaluate again, at</span></div>
<div class="line">        <span class="comment">// physical nodes</span></div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">                <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> cpPtr-&gt;addMatBlockOps(mField, fe_physics-&gt;getOpPtrVector(),</div>
<div class="line">                                     <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, Sev::noisy);</div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(</div>
<div class="line">            getRawPtrOpCalculateStress&lt;SPACE_DIM&gt;(mField, common_data_ptr,</div>
<div class="line">                                                  cpPtr, <span class="keyword">false</span>));</div>
<div class="line">        <span class="keywordflow">return</span> common_data_ptr;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> dg_projection_froward_and_back = [&amp;](<span class="keyword">auto</span> &amp;common_data_ptr) {</div>
<div class="line">        <span class="comment">// here we do actual projection of stress and plastic strain to DG space</span></div>
<div class="line">        <span class="keywordtype">int</span> dg_order = approxOrder - 1;</div>
<div class="line">        <span class="keyword">auto</span> entity_data_l2 =</div>
<div class="line">            boost::make_shared&lt;EntitiesFieldData&gt;(MBENTITYSET);</div>
<div class="line">        <span class="keyword">auto</span> mass_ptr =</div>
<div class="line">            boost::make_shared&lt;MatrixDouble&gt;(); <span class="comment">//&lt; projection operator (mass</span></div>
<div class="line">                                                <span class="comment">// matrix)</span></div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpDGProjectionMassMatrix.html">OpDGProjectionMassMatrix</a>(</div>
<div class="line">            dg_order, mass_ptr, entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> coeffs_ptr_stress = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        <span class="comment">// project stress on DG space on physical element</span></div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpDGProjectionCoefficients.html">OpDGProjectionCoefficients</a>(</div>
<div class="line">            common_data_ptr-&gt;getStressMatrixPtr(), coeffs_ptr_stress, mass_ptr,</div>
<div class="line">            entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line">        <span class="comment">// project strains plastic strains DG space on physical element</span></div>
<div class="line">        <span class="keyword">auto</span> coeffs_ptr_plastic_strain = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe_physics-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpDGProjectionCoefficients.html">OpDGProjectionCoefficients</a>(</div>
<div class="line">            common_data_ptr-&gt;getPlasticStrainMatrixPtr(),</div>
<div class="line">            coeffs_ptr_plastic_strain, mass_ptr, entity_data_l2, approxBase,</div>
<div class="line">            <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// project stress and plastic strain for DG space on post-process</span></div>
<div class="line">        <span class="comment">// element</span></div>
<div class="line">        pip_domain.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpDGProjectionEvaluation.html">OpDGProjectionEvaluation</a>(</div>
<div class="line">            common_data_ptr-&gt;getStressMatrixPtr(), coeffs_ptr_stress,</div>
<div class="line">            entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line">        pip_domain.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpDGProjectionEvaluation.html">OpDGProjectionEvaluation</a>(</div>
<div class="line">            common_data_ptr-&gt;getPlasticStrainMatrixPtr(),</div>
<div class="line">            coeffs_ptr_plastic_strain, entity_data_l2, approxBase, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>));</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> common_data_ptr = evaluate_stress_on_physical_element();</div>
<div class="line">      dg_projection_froward_and_back(common_data_ptr);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> boost::make_tuple(grad_ptr, common_data_ptr-&gt;getStressMatrixPtr(),</div>
<div class="line">                               common_data_ptr-&gt;getPlasticStrainMatrixPtr());</div>
<div class="line">    };<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [DG projection]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    <span class="comment">// Create tags on post-processing mesh, i.e. those tags are visible in</span></div>
<div class="line">    <span class="comment">// Preview</span></div>
<div class="line">    <span class="keyword">auto</span> add_post_proc_map = [&amp;](<span class="keyword">auto</span> post_proc_fe, <span class="keyword">auto</span> u_ptr, <span class="keyword">auto</span> grad_ptr,</div>
<div class="line">                                 <span class="keyword">auto</span> stress_ptr, <span class="keyword">auto</span> plastic_strain_ptr,</div>
<div class="line">                                 <span class="keyword">auto</span> contact_stress_ptr, <span class="keyword">auto</span> X_ptr) {</div>
<div class="line">      <span class="keyword">using</span> OpPPMapSPACE_DIM = <a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">new</span> OpPPMapSPACE_DIM(</div>
<div class="line"> </div>
<div class="line">              post_proc_fe-&gt;getPostProcMesh(), post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              {{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}, {<span class="stringliteral">&quot;GEOMETRY&quot;</span>, X_ptr}},</div>
<div class="line"> </div>
<div class="line">              {{<span class="stringliteral">&quot;GRAD&quot;</span>, grad_ptr}, {<span class="stringliteral">&quot;SIGMA&quot;</span>, contact_stress_ptr}},</div>
<div class="line"> </div>
<div class="line">              {}</div>
<div class="line"> </div>
<div class="line">              )</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using</span> OpPPMap3D = <a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;3, 3&gt;</a>;</div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">new</span> OpPPMap3D(</div>
<div class="line"> </div>
<div class="line">              post_proc_fe-&gt;getPostProcMesh(), post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              {{<span class="stringliteral">&quot;STRESS&quot;</span>, stress_ptr}, {<span class="stringliteral">&quot;PLASTIC_STRAIN&quot;</span>, plastic_strain_ptr}}</div>
<div class="line"> </div>
<div class="line">              )</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> post_proc_fe;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> vol_post_proc = [<span class="keyword">this</span>, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>, post_proc_ele_domain,</div>
<div class="line">                          add_post_proc_map]() {</div>
<div class="line">      PetscBool post_proc_vol = PETSC_FALSE;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> == 2)</div>
<div class="line">        post_proc_vol = PETSC_TRUE;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-post_proc_vol&quot;</span>,</div>
<div class="line">                                 &amp;post_proc_vol, PETSC_NULL);</div>
<div class="line">      <span class="keywordflow">if</span> (post_proc_vol == PETSC_FALSE)</div>
<div class="line">        <span class="keywordflow">return</span> boost::shared_ptr&lt;PostProcEleDomain&gt;();</div>
<div class="line">      <span class="keyword">auto</span> post_proc_fe = boost::make_shared&lt;PostProcEleDomain&gt;(mField);</div>
<div class="line">      <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">      <span class="keyword">auto</span> X_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, X_ptr));</div>
<div class="line">      <span class="keyword">auto</span> contact_stress_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">              <span class="stringliteral">&quot;SIGMA&quot;</span>, contact_stress_ptr));</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">      contact_stress_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">      <span class="keyword">auto</span> [grad_ptr, stress_ptr, plastic_strain_ptr] = post_proc_ele_domain(</div>
<div class="line">          post_proc_fe-&gt;getOpPtrVector(), <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName());</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> add_post_proc_map(post_proc_fe, u_ptr, grad_ptr, stress_ptr,</div>
<div class="line">                               plastic_strain_ptr, contact_stress_ptr, X_ptr);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> skin_post_proc = [<span class="keyword">this</span>, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>, post_proc_ele_domain,</div>
<div class="line">                           add_post_proc_map]() {</div>
<div class="line">      <span class="comment">// create skin of the volume mesh for post-processing,</span></div>
<div class="line">      <span class="comment">// i.e. boundary of the volume mesh</span></div>
<div class="line">      PetscBool post_proc_skin = PETSC_TRUE;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> == 2)</div>
<div class="line">        post_proc_skin = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-post_proc_skin&quot;</span>,</div>
<div class="line">                                 &amp;post_proc_skin, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (post_proc_skin == PETSC_FALSE)</div>
<div class="line">        <span class="keywordflow">return</span> boost::shared_ptr&lt;PostProcEleBdy&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> post_proc_fe = boost::make_shared&lt;PostProcEleBdy&gt;(mField);</div>
<div class="line">      <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">      <span class="keyword">auto</span> X_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;GEOMETRY&quot;</span>, X_ptr));</div>
<div class="line">      <span class="keyword">auto</span> contact_stress_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> op_loop_side =</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpLoopSide.html">OpLoopSide&lt;SideEle&gt;</a>(mField, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">      <span class="keyword">auto</span> [grad_ptr, stress_ptr, plastic_strain_ptr] = post_proc_ele_domain(</div>
<div class="line">          op_loop_side-&gt;getOpPtrVector(), <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName());</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">      op_loop_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHVecTensorField.html">OpCalculateHVecTensorField&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">              <span class="stringliteral">&quot;SIGMA&quot;</span>, contact_stress_ptr));</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">      contact_stress_ptr = <span class="keyword">nullptr</span>;</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">      post_proc_fe-&gt;getOpPtrVector().push_back(op_loop_side);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> add_post_proc_map(post_proc_fe, u_ptr, grad_ptr, stress_ptr,</div>
<div class="line">                               plastic_strain_ptr, contact_stress_ptr, X_ptr);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(vol_post_proc(), skin_post_proc());</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> create_reaction_fe = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> fe_ptr = boost::make_shared&lt;DomainEle&gt;(mField);</div>
<div class="line">    fe_ptr-&gt;getRuleHook = cpPtr-&gt;integrationRule;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe_ptr-&gt;getOpPtrVector();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line">    <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> opFactoryDomainRhs&lt;SPACE_DIM, PETSC, GAUSS, DomainEleOp&gt;(</div>
<div class="line">        mField, <span class="stringliteral">&quot;U&quot;</span>, pip, <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, cpPtr, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> fe_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_extra_finite_elements_to_ksp_solver_pipelines = [&amp;]() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> pre_proc_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line">    <span class="keyword">auto</span> post_proc_rhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line">    <span class="keyword">auto</span> post_proc_lhs_ptr = boost::make_shared&lt;FEMethod&gt;();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_bc_hook_rhs = [<span class="keyword">this</span>, pre_proc_ptr, time_scale]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1EssentialPreProc_3_01DisplacementCubitBcData_01_4.html">EssentialPreProc&lt;DisplacementCubitBcData&gt;</a>(mField, pre_proc_ptr,</div>
<div class="line">                                                       {time_scale}, <span class="keyword">false</span>)();</div>
<div class="line">      <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    pre_proc_ptr-&gt;preProcessHook = get_bc_hook_rhs;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_post_proc_hook_rhs = [<span class="keyword">this</span>, post_proc_rhs_ptr]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1EssentialPreProcReaction_3_01DisplacementCubitBcData_01_4.html">EssentialPreProcReaction&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          mField, post_proc_rhs_ptr, <span class="keyword">nullptr</span>, Sev::verbose)();</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1EssentialPostProcRhs_3_01DisplacementCubitBcData_01_4.html">EssentialPostProcRhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          mField, post_proc_rhs_ptr, 1.)();</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> get_post_proc_hook_lhs = [<span class="keyword">this</span>, post_proc_lhs_ptr]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1EssentialPostProcLhs_3_01DisplacementCubitBcData_01_4.html">EssentialPostProcLhs&lt;DisplacementCubitBcData&gt;</a>(</div>
<div class="line">          mField, post_proc_lhs_ptr, 1.)();</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    post_proc_rhs_ptr-&gt;postProcessHook = get_post_proc_hook_rhs;</div>
<div class="line">    post_proc_lhs_ptr-&gt;postProcessHook = get_post_proc_hook_lhs;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This is low level pushing finite elements (pipelines) to solver</span></div>
<div class="line">    <span class="keyword">auto</span> ts_ctx_ptr = <a class="code" href="namespaceMoFEM.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">    ts_ctx_ptr-&gt;getPreProcessIFunction().push_front(pre_proc_ptr);</div>
<div class="line">    ts_ctx_ptr-&gt;getPreProcessIJacobian().push_front(pre_proc_ptr);</div>
<div class="line">    ts_ctx_ptr-&gt;getPostProcessIFunction().push_back(post_proc_rhs_ptr);</div>
<div class="line">    ts_ctx_ptr-&gt;getPostProcessIJacobian().push_back(post_proc_lhs_ptr);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add extra finite elements to SNES solver pipelines to resolve essential</span></div>
<div class="line">  <span class="comment">// boundary conditions</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_extra_finite_elements_to_ksp_solver_pipelines();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> create_monitor_fe = [dm, time_scale](<span class="keyword">auto</span> &amp;&amp;post_proc_fe,</div>
<div class="line">                                            <span class="keyword">auto</span> &amp;&amp;reaction_fe) {</div>
<div class="line">    <span class="keywordflow">return</span> boost::make_shared&lt;Monitor&gt;(</div>
<div class="line">        dm, post_proc_fe, reaction_fe,</div>
<div class="line">        std::vector&lt;boost::shared_ptr&lt;ScalingMethod&gt;&gt;{time_scale});</div>
<div class="line">  };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Set up post-step]</span></div>
<div class="line"><span class="comment"></span>  <span class="keyword">auto</span> set_up_post_step = [&amp;](<span class="keyword">auto</span> ts) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// create finite element (pipeline) and populate it with operators to</span></div>
<div class="line">    <span class="comment">// update history variables</span></div>
<div class="line">    <span class="keyword">auto</span> create_update_ptr = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> fe_ptr = boost::make_shared&lt;DomainEle&gt;(mField);</div>
<div class="line">      fe_ptr-&gt;getRuleHook = cpPtr-&gt;integrationRule;</div>
<div class="line">      <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(fe_ptr-&gt;getOpPtrVector(),</div>
<div class="line">                                                     {H1});</div>
<div class="line">      <span class="keyword">auto</span> common_data_ptr = boost::make_shared&lt;ADOLCPlasticity::CommonData&gt;();</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient&lt;SPACE_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, common_data_ptr-&gt;getGardAtGaussPtsPtr()));</div>
<div class="line">      <a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">          opFactoryDomainUpdate&lt;SPACE_DIM&gt;(mField, fe_ptr-&gt;getOpPtrVector(),</div>
<div class="line">                                           <span class="stringliteral">&quot;ADOLCMAT&quot;</span>, common_data_ptr, cpPtr),</div>
<div class="line">          <span class="stringliteral">&quot;push update ops&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ts_update_ptr is global static variable</span></div>
<div class="line">    <a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a> =</div>
<div class="line">        <a class="code" href="namespaceADOLCPlasticity.html#a9a948d7e017d090c9357e2f0fdd3decc">createTSUpdate</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), create_update_ptr());</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [TS post-step function]</span></div>
<div class="line"><span class="comment"></span>    <span class="comment">// This is pure &quot;C&quot; function which we can to the TS solver</span></div>
<div class="line">    <span class="keyword">auto</span> ts_step_post_proc = [](TS ts) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a>)</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a>-&gt;postProcess(ts);</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [TS post-step function]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    <span class="comment">// finally set up post-step</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, ts_step_post_proc);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };<span class="comment"></span></div>
<div class="line"><span class="comment">  //! [Set up post-step]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="comment">// Set monitor which postprocessing results and saves them to the hard drive</span></div>
<div class="line">  <span class="keyword">auto</span> set_up_monitor = [&amp;](<span class="keyword">auto</span> ts) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    boost::shared_ptr&lt;FEMethod&gt; null_fe;</div>
<div class="line">    <span class="keyword">auto</span> monitor_ptr =</div>
<div class="line">        create_monitor_fe(create_post_proc_fe(), create_reaction_fe());</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a112dfab22d28426fcd0ab2d61cf8f494">DMMoFEMTSSetMonitor</a>(dm, ts, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), null_fe,</div>
<div class="line">                               null_fe, monitor_ptr);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_section_monitor = [&amp;](<span class="keyword">auto</span> solver) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    SNES snes;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(solver, &amp;snes);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(snes,</div>
<div class="line">                          (<a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal,</div>
<div class="line">                                             <span class="keywordtype">void</span> *))<a class="code" href="namespaceMoFEM.html#a37c8aa74d57ef9fcf60e6c508b987113">MoFEMSNESMonitorFields</a>,</div>
<div class="line">                          (<span class="keywordtype">void</span> *)(snes_ctx_ptr.get()), <span class="keyword">nullptr</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_up_adapt = [&amp;](<span class="keyword">auto</span> ts) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSAdaptRegister(<a class="code" href="TsCtx_8hpp.html#a45f84933fa6a1de0b314d4d51c39bc71">TSADAPTMOFEM</a>, <a class="code" href="namespaceMoFEM.html#af77311a7eb91829fc0f10e00545888c3">TSAdaptCreateMoFEM</a>);</div>
<div class="line">    TSAdapt adapt;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetAdapt(ts, &amp;adapt);</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Create TS]</span></div>
<div class="line"><span class="comment"></span>  <span class="keyword">auto</span> ts = pipeline_mng-&gt;createTSIM();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set time solver</span></div>
<div class="line">  <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetMaxTime(ts, ftime);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetExactFinalTime(ts, TS_EXACTFINALTIME_MATCHSTEP);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a> = <a class="code" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <a class="code" href="structContactOps_1_1CommonData.html#acad361eff40ea5259c2d789789fdf8d6">ContactOps::CommonData::createTotalTraction</a>(mField);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a>);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section_monitor(ts);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set monitor, step adaptivity, and post-step to update history variables</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_up_monitor(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_up_post_step(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_up_adapt(ts);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, NULL);<span class="comment"></span></div>
<div class="line"><span class="comment">  //! [Create TS]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTime(ts, &amp;ftime);</div>
<div class="line"> </div>
<div class="line">  PetscInt steps, snesfails, rejects, nonlinits, linits;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepNumber(ts, &amp;steps);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESFailures(ts, &amp;snesfails);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetStepRejections(ts, &amp;rejects);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNESIterations(ts, &amp;nonlinits);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetKSPIterations(ts, &amp;linits);</div>
<div class="line">  <a class="code" href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::inform,</div>
<div class="line">              <span class="stringliteral">&quot;steps %d (%d rejected, %d SNES fails), ftime %g, nonlinits &quot;</span></div>
<div class="line">              <span class="stringliteral">&quot;%d, linits %d&quot;</span>,</div>
<div class="line">              steps, rejects, snesfails, ftime, nonlinits, linits);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#ab6aeaf2b20f0755222d0124d2c7524c4">PlasticProblem::gettingNorms</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> T = <a class="code" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), T, INSERT_VALUES,</div>
<div class="line">                                 SCATTER_FORWARD);</div>
<div class="line">  <span class="keywordtype">double</span> nrm2;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(T, NORM_2, &amp;nrm2);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Solution norm &quot;</span> &lt;&lt; nrm2;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_fe = boost::make_shared&lt;DomainEle&gt;(<a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>);</div>
<div class="line"> </div>
<div class="line">  post_proc_norm_fe-&gt;getRuleHook = <a class="code" href="structPlasticProblem.html#a48eee41fb40c3920544fb006daadc52e">cpPtr</a>-&gt;integrationRule;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1AddHOOps.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      post_proc_norm_fe-&gt;getOpPtrVector(), {H1});</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> NORMS { U_NORM_L2 = 0, PIOLA_NORM, LAST_NORM };</div>
<div class="line">  <span class="keyword">auto</span> norms_vec =</div>
<div class="line">      <a class="code" href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">createVectorMPI</a>(<a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>(),</div>
<div class="line">                      (<a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) ? LAST_NORM : 0, LAST_NORM);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(norms_vec);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateVectorFieldValues.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line"> </div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalcNormL2Tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_ptr, norms_vec, U_NORM_L2));</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(),</div>
<div class="line">                                  post_proc_norm_fe);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(norms_vec);</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(norms_vec);</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a>(<span class="stringliteral">&quot;SELF&quot;</span>); <span class="comment">// Clear channel from old tags</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> *norms;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(norms_vec, &amp;norms);</div>
<div class="line">    <a class="code" href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::inform, <span class="stringliteral">&quot;example&quot;</span>)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;norm_u: &quot;</span> &lt;&lt; std::scientific &lt;&lt; std::sqrt(norms[U_NORM_L2]);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(norms_vec, &amp;norms);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Postprocessing results]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a4248ee2b94d3ab2b979c273a4b131410">PlasticProblem::outputResults</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  PetscInt test_nb = 0;</div>
<div class="line">  PetscBool test_flg = PETSC_FALSE;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-test&quot;</span>, &amp;test_nb, &amp;test_flg);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (test_flg) {</div>
<div class="line">    <span class="keyword">auto</span> <a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code" href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">mField</a>.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1Simple.html">Simple</a>&gt;();</div>
<div class="line">    <span class="keyword">auto</span> T = <a class="code" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(<a class="code" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), T, INSERT_VALUES,</div>
<div class="line">                                   SCATTER_FORWARD);</div>
<div class="line">    <span class="keywordtype">double</span> nrm2;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(T, NORM_2, &amp;nrm2);</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Regression norm &quot;</span> &lt;&lt; nrm2;</div>
<div class="line">    <span class="keywordtype">double</span> regression_value = 0;</div>
<div class="line">    <span class="keywordflow">switch</span> (test_nb) {</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      SETERRQ(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;Wrong test number.&quot;</span>);</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (fabs(nrm2 - regression_value) &gt; 1e-2)</div>
<div class="line">      SETERRQ2(PETSC_COMM_WORLD, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">               <span class="stringliteral">&quot;Regression test field; wrong norm value. %6.4e != %6.4e&quot;</span>, nrm2,</div>
<div class="line">               regression_value);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Postprocessing results]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Check]</span></div>
<div class="line"><span class="comment"></span><a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structPlasticProblem.html#a4fd802798873644e765120cc1a563370">PlasticProblem::checkResults</a>() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  <a class="code" href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a>.reset();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Check]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="activate__deactivate__dofs_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line">  Py_Initialize();</div>
<div class="line">  np::initialize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialisation of MoFEM/PETSc and MOAB data structures</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> param_file[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file, <a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add logging channel for example</span></div>
<div class="line">  <span class="keyword">auto</span> core_log = logging::core::get();</div>
<div class="line">  core_log-&gt;add_sink(</div>
<div class="line">      LogManager::createSink(LogManager::getStrmWorld(), <span class="stringliteral">&quot;PlasticPrb&quot;</span>));</div>
<div class="line">  LogManager::setLog(<span class="stringliteral">&quot;PlasticPrb&quot;</span>);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, <span class="stringliteral">&quot;PlasticPrb&quot;</span>);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;PlasticPrb&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;SPACE_DIM &quot;</span> &lt;&lt; <a class="code" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>;</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line">  core_log-&gt;add_sink(</div>
<div class="line">      LogManager::createSink(LogManager::getStrmWorld(), <span class="stringliteral">&quot;CONTACT&quot;</span>));</div>
<div class="line">  LogManager::setLog(<span class="stringliteral">&quot;CONTACT&quot;</span>);</div>
<div class="line">  <a class="code" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;CONTACT&quot;</span>, <span class="stringliteral">&quot;Contact&quot;</span>);</div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc]</span></div>
<div class="line"><span class="comment"></span>    DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> mb_instance;              <span class="comment">///&lt; mesh database</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = mb_instance; <span class="comment">///&lt; mesh database interface</span></div>
<div class="line"><span class="comment"></span><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab);           <span class="comment">///&lt; finite element database</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core; <span class="comment">///&lt; finite element database interface</span></div>
<div class="line"><span class="comment"></span><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [PlasticProblem]</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="structPlasticProblem.html">PlasticProblem</a> ex(m_field);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ex.runProblem();<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [PlasticProblem]</span></div>
<div class="line"><span class="comment"></span>  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"><span class="preprocessor">#ifdef ADD_CONTACT</span></div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line">  <span class="keywordflow">if</span> (Py_FinalizeEx() &lt; 0) {</div>
<div class="line">    exit(120);</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"><span class="preprocessor">#endif // ADD_CONTACT</span></div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> <div class="fragment"><div class="line"><span class="comment">/** \file ADOLCPlasticityMaterialModels.hpp</span></div>
<div class="line"><span class="comment"> * \ingroup adoc_plasticity</span></div>
<div class="line"><span class="comment"> * \brief Matetial models for plasticity</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \example ADOLCPlasticityMaterialModels.hpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __ADOLC_MATERIAL_MODELS_HPP</span></div>
<div class="line"><span class="preprocessor">#define __ADOLC_MATERIAL_MODELS_HPP</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef WITH_ADOL_C</span></div>
<div class="line"><span class="preprocessor">#error &quot;MoFEM need to be compiled with ADOL-C&quot;</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceADOLCPlasticity.html">ADOLCPlasticity</a> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/** \brief J2 plasticity (Kinematic Isotropic (Linear) Hardening)</span></div>
<div class="line"><span class="comment"> * \ingroup adoc_plasticity</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief J2 plasticity (Kinematic Isotropic (Linear) Hardening)</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @tparam DIM model dimension (2 - is plane stress)</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt; <span class="keyword">struct </span>J2Plasticity;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief J2 (Von Misses) plasticity</span></div>
<div class="line"><span class="comment"> * @ingroup adoc_plasticity</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Free energy:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  \f[</span></div>
<div class="line"><span class="comment"> * \psi(\varepsilon^e, \alpha, \beta) =</span></div>
<div class="line"><span class="comment"> * \frac{1}{2} \lambda \textrm{tr}[\varepsilon^e]^2</span></div>
<div class="line"><span class="comment"> * + \mu \varepsilon^e : \varepsilon^e</span></div>
<div class="line"><span class="comment"> * +</span></div>
<div class="line"><span class="comment"> * \sigma_y\alpha</span></div>
<div class="line"><span class="comment"> * +</span></div>
<div class="line"><span class="comment"> * \frac{1}{2} \phi H \alpha^2</span></div>
<div class="line"><span class="comment"> * +</span></div>
<div class="line"><span class="comment"> * \frac{1}{2} (1-\phi)K \beta^2</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Isotropic hardening variable \f$\alpha\f$ is in first index of</span></div>
<div class="line"><span class="comment"> * internal variables vector. Kinematic hardening variable is in</span></div>
<div class="line"><span class="comment"> * the remaining indices of internal variables vector.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Yield function:</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Deviator of actual stress:</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \eta=\textrm{dev}[\sigma]-\overline{\beta}</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> * where \f$\overline{\beta}\f$ is back stress.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Square of the deviator norm</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * f = \frac{3}{2} \eta:\eta</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Yield function:</span></div>
<div class="line"><span class="comment"> *  \f[</span></div>
<div class="line"><span class="comment"> * y = \sqrt{f} - \overline{\alpha}</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> * where \f$f\f$ is defined in \ref eva</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This is associated potential model, so flow potential is equal to yield</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>J2Plasticity&lt;3&gt; : <span class="keyword">public</span> ClosestPointProjection {</div>
<div class="line"> </div>
<div class="line">  J2Plasticity() : ClosestPointProjection() {</div>
<div class="line">    nbInternalVariables = 7;</div>
<div class="line">    activeVariablesW.resize(12 + nbInternalVariables, <span class="keyword">false</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'Z', 6&gt;</a> Z;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tTotalStrain;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tPlasticStrain;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tElasticStrain;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tInternalTensor;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tStress;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tBackStress;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> tDeviator;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classadouble.html">adouble</a> tR;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;     <span class="comment">//&lt; Lamé parameter</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>; <span class="comment">//&lt; Lamé parameters</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>;      <span class="comment">//&lt; Isotropic hardening</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;      <span class="comment">//&lt; Kinematic hardening</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;    <span class="comment">//&lt; Combined isotropic/kinematic hardening</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>; <span class="comment">//&lt; Yield stress</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> ModelParams { <a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>, <a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>, ISOH, KINK, PHI, SIGMA_Y, LAST_PARAM };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> ParamsArray = std::array&lt;double, LAST_PARAM&gt;;</div>
<div class="line">  boost::shared_ptr&lt;ParamsArray&gt; defaultParamsArrayPtr = <span class="keyword">nullptr</span>;</div>
<div class="line">  boost::shared_ptr&lt;ParamsArray&gt; paramsArrayPtr = <span class="keyword">nullptr</span>;</div>
<div class="line">  boost::shared_ptr&lt;ParamsArray&gt; oldParamsArrayPtr = <span class="keyword">nullptr</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> getDefaultMaterialParameters() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a> = 1;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a> = 0.25;</div>
<div class="line">    <a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a> = 1;</div>
<div class="line">    <a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a> = 0.1;</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a> = 0;</div>
<div class="line">    <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = 1;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-young_modulus&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-poisson_ratio&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>,</div>
<div class="line">                                 0);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-sigma_y&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-H&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-K&quot;</span>, &amp;<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-phi&quot;</span>, &amp;<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Young modulus: &quot;</span> &lt;&lt; <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>;</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Poisson ratio: &quot;</span> &lt;&lt; <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a> = <a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line">    <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = <a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"> </div>
<div class="line">    defaultParamsArrayPtr = boost::make_shared&lt;ParamsArray&gt;();</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>] = <a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>] = <a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>] = <a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>] = <a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[PHI] = <a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[SIGMA_Y] = <a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;LAMBDA: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;MU: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;H: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[ISOH];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;K: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[KINK];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;PHI: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[PHI];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;SIGMA_Y: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[SIGMA_Y];</div>
<div class="line"> </div>
<div class="line">    paramsArrayPtr = boost::make_shared&lt;ParamsArray&gt;();</div>
<div class="line">    std::copy(defaultParamsArrayPtr-&gt;begin(), defaultParamsArrayPtr-&gt;end(),</div>
<div class="line">              paramsArrayPtr-&gt;begin());</div>
<div class="line">    oldParamsArrayPtr = boost::make_shared&lt;ParamsArray&gt;();</div>
<div class="line">    std::fill(oldParamsArrayPtr-&gt;begin(), oldParamsArrayPtr-&gt;end(), 0);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * @brief Get material parameters from block</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param m_field</span></div>
<div class="line"><span class="comment">   * @param pip</span></div>
<div class="line"><span class="comment">   * @param block_name</span></div>
<div class="line"><span class="comment">   * @param sev</span></div>
<div class="line"><span class="comment">   * @return MoFEMErrorCode</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">  <a class="code" href="namespacePlasticOps.html#a55995edc157f3bd05b55b6e86bf02b0f">addMatBlockOps</a>(<a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                 boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">                 std::string block_name, <a class="code" href="namespaceMoFEM.html#ab4d38dd36deb3c8334737f3526dfbf35">Sev</a> sev) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>OpMatBlocks : <span class="keyword">public</span> <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">ForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using</span> <a class="code" href="classOP.html">OP</a> = <a class="code" href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">ForcesAndSourcesCore::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line">      OpMatBlocks(boost::shared_ptr&lt;ParamsArray&gt; params_array_ptr,</div>
<div class="line">                  boost::shared_ptr&lt;ParamsArray&gt; def_params_array_otr,</div>
<div class="line">                  <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field, <a class="code" href="namespaceMoFEM.html#ab4d38dd36deb3c8334737f3526dfbf35">Sev</a> sev,</div>
<div class="line">                  std::vector&lt;const CubitMeshSets *&gt; meshset_vec_ptr)</div>
<div class="line">          : <a class="code" href="classOP.html">OP</a>(<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a>, <a class="code" href="classOP.html">OP</a>::OPSPACE), paramsArrayPtr(params_array_ptr),</div>
<div class="line">            defParamsArray(def_params_array_otr) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(extractBlockData(m_field, meshset_vec_ptr, sev),</div>
<div class="line">                          <span class="stringliteral">&quot;Can not get data from block&quot;</span>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                            <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;b : blockData) {</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (b.blockEnts.find(getFEEntityHandle()) != b.blockEnts.end()) {</div>
<div class="line">            std::copy(b.paramsArray.begin(), b.paramsArray.end(),</div>
<div class="line">                      paramsArrayPtr-&gt;begin());</div>
<div class="line">            <a class="code" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        std::copy(defParamsArray-&gt;begin(), defParamsArray-&gt;end(),</div>
<div class="line">                  paramsArrayPtr-&gt;begin());</div>
<div class="line"> </div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">private</span>:</div>
<div class="line">      boost::shared_ptr&lt;ParamsArray&gt; paramsArrayPtr;</div>
<div class="line">      boost::shared_ptr&lt;ParamsArray&gt; defParamsArray;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">struct </span><a class="code" href="structBlockData.html">BlockData</a> {</div>
<div class="line">        ParamsArray paramsArray;</div>
<div class="line">        <a class="code" href="classRange.html">Range</a> blockEnts;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;BlockData&gt; blockData;</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">      extractBlockData(<a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                       std::vector&lt;const CubitMeshSets *&gt; meshset_vec_ptr,</div>
<div class="line">                       <a class="code" href="namespaceMoFEM.html#ab4d38dd36deb3c8334737f3526dfbf35">Sev</a> sev) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : meshset_vec_ptr) {</div>
<div class="line">          <a class="code" href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev, <span class="stringliteral">&quot;JP2 parameters&quot;</span>) &lt;&lt; *<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>;</div>
<div class="line">          std::vector&lt;double&gt; block_data;</div>
<div class="line">          <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;getAttributes(block_data);</div>
<div class="line">          <span class="keywordflow">if</span> (block_data.size() != 6) {</div>
<div class="line">            SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                    <span class="stringliteral">&quot;Expected that block has two attribute&quot;</span>);</div>
<div class="line">          }</div>
<div class="line">          <span class="keyword">auto</span> get_block_ents = [&amp;]() {</div>
<div class="line">            <a class="code" href="classRange.html">Range</a> ents;</div>
<div class="line">            <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">            m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>().get_entities_by_handle(<a class="code" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;meshset, ents, <span class="keyword">true</span>);</div>
<div class="line">            <span class="keywordflow">return</span> ents;</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          blockData.push_back({*defParamsArray, get_block_ents()});</div>
<div class="line">          std::copy(block_data.begin(), block_data.end(),</div>
<div class="line">                    blockData.back().paramsArray.begin());</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a> = blockData.back().paramsArray[<a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>];</div>
<div class="line">          <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a> = blockData.back().paramsArray[<a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>];</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// Is assumed that uset provide young_modulus and poisson_ratio in</span></div>
<div class="line">          <span class="comment">// fist two argiumens of the block</span></div>
<div class="line"> </div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Young modulus: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[<a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>];</div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Poisson ratio: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[<a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>];</div>
<div class="line"> </div>
<div class="line">          blockData.back().paramsArray[<a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>] =</div>
<div class="line">              <a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line">          blockData.back().paramsArray[<a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>] = <a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"> </div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;LAMBDA: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[<a class="code" href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a>];</div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;MU: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[<a class="code" href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a>];</div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;H: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[ISOH];</div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;K: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[KINK];</div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;PHI: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[PHI];</div>
<div class="line">          <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;SIGMA_Y: &quot;</span> &lt;&lt; (blockData.back().paramsArray)[SIGMA_Y];</div>
<div class="line">        }</div>
<div class="line">        <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> cubit_meshsets_vec_ptr =</div>
<div class="line">        m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;MeshsetsManager&gt;()-&gt;getCubitMeshsetPtr(</div>
<div class="line">            std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % block_name).str()));</div>
<div class="line"> </div>
<div class="line">    pip.push_back(<span class="keyword">new</span> OpMatBlocks(paramsArrayPtr, defaultParamsArrayPtr,</div>
<div class="line">                                  m_field, sev, cubit_meshsets_vec_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * @brief Set material parameters at integration point</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param tag</span></div>
<div class="line"><span class="comment">   * @param recalculate_elastic_tangent</span></div>
<div class="line"><span class="comment">   * @return MoFEMErrorCode</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> setParams(<span class="keywordtype">short</span> tag, <span class="keywordtype">bool</span> &amp;recalculate_elastic_tangent) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">switch</span> (tag) {</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">TypesTags::W</a>: {</div>
<div class="line">      set_param_vec(tapesTags[tag], paramsArrayPtr-&gt;size(),</div>
<div class="line">                    paramsArrayPtr-&gt;data());</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = 0; p != LAST_PARAM; p++) {</div>
<div class="line">        <span class="keywordflow">if</span> ((*paramsArrayPtr)[p] != (*oldParamsArrayPtr)[p]) {</div>
<div class="line">          recalculate_elastic_tangent = <span class="keyword">true</span>;</div>
<div class="line">          std::copy(paramsArrayPtr-&gt;begin(), paramsArrayPtr-&gt;end(),</div>
<div class="line">                    oldParamsArrayPtr-&gt;begin());</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> TypesTags::Y:</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">TypesTags::H</a>:</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a class="code" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Unknown tag for setParams&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Free energy J2]</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> freeHemholtzEnergy() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// ADOL-C register parameters (those can varied for integration points)</span></div>
<div class="line">    <span class="keyword">auto</span> p_lambda = mkparam(<a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>);  <span class="comment">// 0</span></div>
<div class="line">    <span class="keyword">auto</span> p_mu = mkparam(<a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>);          <span class="comment">// 1</span></div>
<div class="line">    <span class="keyword">auto</span> p_H = mkparam(<a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>);            <span class="comment">// 2</span></div>
<div class="line">    <span class="keyword">auto</span> p_K = mkparam(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>);            <span class="comment">// 3</span></div>
<div class="line">    <span class="keyword">auto</span> p_phi = mkparam(<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>);        <span class="comment">// 4</span></div>
<div class="line">    <span class="keyword">auto</span> p_sigma_y = mkparam(<a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>); <span class="comment">// 5</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Operator converting Voight and tensor notation</span></div>
<div class="line">    <span class="keyword">auto</span> t_voight_strain_op = <a class="code" href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">voight_to_strain_op</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Variable in voight notation</span></div>
<div class="line">    <span class="keyword">auto</span> t_voight_total_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_plastic_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_plasticStrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_internal_tensor =</div>
<div class="line">        getFTensor1FromPtr&lt;6&gt;(&amp;a_internalVariables[1]);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Convert variables to tensor notation</span></div>
<div class="line">    tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_total_strain(Z);</div>
<div class="line">    tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_plastic_strain(Z);</div>
<div class="line">    tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_internal_tensor(Z);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Evaluate elastic strain</span></div>
<div class="line">    tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">    tR = tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Strain energy</span></div>
<div class="line">    a_w = 0.5 * p_lambda * tR * tR +</div>
<div class="line">          p_mu * (tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">    <span class="comment">// Isotropic strain energy</span></div>
<div class="line">    a_w +=</div>
<div class="line">        a_internalVariables[0] * p_sigma_y +</div>
<div class="line">        0.5 * p_phi * p_H * (a_internalVariables[0] * a_internalVariables[0]);</div>
<div class="line">    <span class="comment">// Kinematic strain energy</span></div>
<div class="line">    a_w += (0.5 * (1 - p_phi) * p_K) *</div>
<div class="line">           (tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }<span class="comment"></span></div>
<div class="line"><span class="comment">  //! [Free energy J2]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="classadouble.html">adouble</a> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Yield function J2]</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalF() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> t_voight_stress_op = <a class="code" href="namespaceADOLCPlasticity.html#ad5af676dc42ec1e2aaf35ea35171be83">voight_to_stress_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_vioght_stress = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTress[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_back_stress = getFTensor1FromPtr&lt;6&gt;(&amp;a_internalFluxes[1]);</div>
<div class="line">    tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_stress_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_vioght_stress(Z);</div>
<div class="line">    tBackStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_stress_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_back_stress(Z);</div>
<div class="line"> </div>
<div class="line">    constexpr <span class="keywordtype">double</span> <a class="code" href="EshelbianADOL-C_8cpp.html#a2942a742e89c8e16193e7aeca63c995c">third</a> = boost::math::constants::third&lt;double&gt;();</div>
<div class="line">    constexpr <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a class="code" href="classFTensor_1_1Kronecker__Delta__symmetric.html">FTensor::Kronecker_Delta_symmetric&lt;double&gt;</a>();</div>
<div class="line">    tR = tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) / 3.;</div>
<div class="line">    tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tR * <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tBackStress(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Fix the constant to mach uniaxial test</span></div>
<div class="line">    constexpr <span class="keywordtype">double</span> <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = 3. / 2.;</div>
<div class="line">    <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> = <a class="code" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> * tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tDeviator(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> yieldFunction() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evalF();</div>
<div class="line">    a_y = sqrt(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>) - a_internalFluxes[0];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }<span class="comment"></span></div>
<div class="line"><span class="comment">  //! [Yield function J2]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> flowPotential() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evalF();</div>
<div class="line">    a_h = sqrt(<a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>) - a_internalFluxes[0];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [J2 2D]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">template</span> &lt;&gt; <span class="keyword">struct </span>J2Plasticity&lt;2&gt; : <span class="keyword">public</span> J2Plasticity&lt;3&gt; {</div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="structADOLCPlasticity_1_1J2Plasticity_3_013_01_4.html#a9f461afd60eb0ed42c48838355bfae8d">J2Plasticity&lt;3&gt;::J2Plasticity</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> freeHemholtzEnergy() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> p_lambda = mkparam(<a class="code" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>);  <span class="comment">// 0</span></div>
<div class="line">    <span class="keyword">auto</span> p_mu = mkparam(<a class="code" href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a>);          <span class="comment">// 1</span></div>
<div class="line">    <span class="keyword">auto</span> p_H = mkparam(<a class="code" href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a>);            <span class="comment">// 2</span></div>
<div class="line">    <span class="keyword">auto</span> p_K = mkparam(<a class="code" href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">K</a>);            <span class="comment">// 3</span></div>
<div class="line">    <span class="keyword">auto</span> p_phi = mkparam(<a class="code" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>);        <span class="comment">// 4</span></div>
<div class="line">    <span class="keyword">auto</span> p_sigma_y = mkparam(<a class="code" href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a>); <span class="comment">// 5</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_voight_strain_op = <a class="code" href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">voight_to_strain_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_voight_total_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_sTrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_plastic_strain = getFTensor1FromPtr&lt;6&gt;(&amp;a_plasticStrain[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_internal_tensor =</div>
<div class="line">        getFTensor1FromPtr&lt;6&gt;(&amp;a_internalVariables[1]);</div>
<div class="line"> </div>
<div class="line">    tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_total_strain(Z);</div>
<div class="line">    tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_plastic_strain(Z);</div>
<div class="line">    tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, Z) * t_voight_internal_tensor(Z);</div>
<div class="line"> </div>
<div class="line">    tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) = tTotalStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) - tPlasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Plane stress]</span></div>
<div class="line"><span class="comment"></span>    <span class="comment">// Calculate st  rain at ezz enforcing plane strain case</span></div>
<div class="line">    tElasticStrain(2, 2) =</div>
<div class="line">        (-tElasticStrain(0, 0) * p_lambda - tElasticStrain(1, 1) * p_lambda) /</div>
<div class="line">        (p_lambda + 2 * p_mu);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Plane stress]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">    tR = tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">    a_w = 0.5 * p_lambda * tR * tR +</div>
<div class="line">          p_mu * (tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tElasticStrain(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// plastic part</span></div>
<div class="line">    <span class="comment">// isotropic</span></div>
<div class="line">    a_w +=</div>
<div class="line">        a_internalVariables[0] * p_sigma_y +</div>
<div class="line">        0.5 * p_phi * p_H * (a_internalVariables[0] * a_internalVariables[0]);</div>
<div class="line">    <span class="comment">// kinematic</span></div>
<div class="line">    a_w += (0.5 * (1 - p_phi) * p_K) *</div>
<div class="line">           (tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * tInternalTensor(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};<span class="comment"></span></div>
<div class="line"><span class="comment">//! [J2 2D]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">/** \brief Paraboloidal yield criterion</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  See paper for reference \cite ullah2017three and \cite stier2015comparing</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Linear hardening</span></div>
<div class="line"><span class="comment"> *  \f[</span></div>
<div class="line"><span class="comment"> *  \psi =</span></div>
<div class="line"><span class="comment"> *  \frac{1}{2} \lambda \textrm{tr}[\varepsilon]^2 + \mu \varepsilon :</span></div>
<div class="line"><span class="comment"> * \varepsilon</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  \sigma_{yt}\alpha_0</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  \frac{1}{2} H_t \alpha_0^2</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> * \sigma_{yc}\alpha_1</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  \frac{1}{2} H_c \alpha_1^2</span></div>
<div class="line"><span class="comment"> *  \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> *  Exponential hardening</span></div>
<div class="line"><span class="comment"> *  \f[</span></div>
<div class="line"><span class="comment"> *  \psi =</span></div>
<div class="line"><span class="comment"> *  \frac{1}{2} \lambda \textrm{tr}[\varepsilon]^2 + \mu \varepsilon :</span></div>
<div class="line"><span class="comment"> * \varepsilon\\</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  (\sigma_{yt}+H_t)\alpha_0</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  \frac{H_t}{n_t} \exp{(-n_t \alpha_0)}\\</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  (\sigma_{yc}+H_c)\alpha_0</span></div>
<div class="line"><span class="comment"> *  +</span></div>
<div class="line"><span class="comment"> *  \frac{H_c}{n_c} \exp{(-n_c \alpha_1)}</span></div>
<div class="line"><span class="comment"> *  \f]</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> *  \f[</span></div>
<div class="line"><span class="comment"> *  I_1 = \textrm{tr} (\boldsymbol{\sigma})</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \eta=\textrm{dev}[\boldsymbol{\sigma}]</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * J_2 = \frac{1}{2} \eta:\eta</span></div>
<div class="line"><span class="comment"> * \f] </span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * y = 6J_2 + 2I_1\left(\overline{\alpha_1}-\overline{\alpha_0}\right) -</span></div>
<div class="line"><span class="comment"> * 2\overline{\alpha_0} \,\overline{\alpha_1} \f] </span></div>
<div class="line"><span class="comment"> * where</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \overline{\alpha_0}=\frac{\partial \psi}{\partial \alpha_0}=\sigma_{yt} + H_t</span></div>
<div class="line"><span class="comment"> * \alpha_0 </span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \overline{\alpha_1}=\frac{\partial \psi}{\partial \alpha_1}=\sigma_{yc} + H_c</span></div>
<div class="line"><span class="comment"> * \alpha_1 </span></div>
<div class="line"><span class="comment"> * \f] </span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \Psi = 6J_2 + 2\alpha I_1 \left(\overline{\alpha_1}-\overline{\alpha_0}\right)</span></div>
<div class="line"><span class="comment"> * - 2\overline{\alpha_0} \,\overline{\alpha_1} \f] \f[ \alpha=</span></div>
<div class="line"><span class="comment"> * \frac{1-2\nu_p}{1+\nu_p} </span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> * </span></div>
<div class="line"><span class="comment"> * \ingroup adoc_plasticity</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>ParaboloidalPlasticity : <span class="keyword">public</span> ClosestPointProjection {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#abfd86e8a64c90454f24b88e5076ac668">ParaboloidalPlasticity</a>() : <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#adfd7aac94645622cd0f68f5ef00876c8">ClosestPointProjection</a>() {</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#affc25cefd7a04722a912b9ccdf25e38e">nbInternalVariables</a> = 2;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a064b37b0afa2e159438c85c337f3eb02">activeVariablesW</a>.resize(12 + <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#affc25cefd7a04722a912b9ccdf25e38e">nbInternalVariables</a>, <span class="keyword">false</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'j', 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'Z', 6&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aa6cf2750588f2eed7604f15995699b07">tTotalStrain</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5dd97785b70cb603ea04a4d79664e37b">tPlasticStrain</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aafa1023b9d441b3016e0c0641aa7b17a">tElasticStrain</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad99174e6023f5d36a2d89e9e2d741269">tStress</a>;</div>
<div class="line">  <a class="code" href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric&lt;adouble, 3&gt;</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a42f5232395453e37b4a58f3c25f562ff">tDeviator</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="classadouble.html">adouble</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a919fac8b7ae9694240f600a56d7c930d">lambda</a>;           <span class="comment">//&lt; Lamé parameters</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac4f2a9eddaa977f5c3383da6c9518ebd">mu</a>;               <span class="comment">//&lt; Lamé parameter</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">nup</a>;              <span class="comment">//&lt; Plastic Poisson’s ratio</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a492b70a671ee60eede289ac149d879d2">Ht</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aeb6740721615065309fb53f74145e0d6">Hc</a>;           <span class="comment">//&lt; Isotropic hardening for tension and compression</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d3128404d1146ae263998c3d7021bfa">sigmaYt</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a8501f08ab8f7016b8f611a573200de2e">sigmaYc</a>; <span class="comment">//&lt; Yield stress in tension and compression</span></div>
<div class="line">  <span class="keywordtype">double</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a83c7590a91f3ec73e12eb3d61fa731af">nt</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5ab18b33ea693175c569f41dd6e73068">nc</a>;           <span class="comment">//&lt; Hardening parameters for tension and compression</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9e">ModelParams</a> {</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac58a23d00454d202e36cba2c0001575e">LAMBDA</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea3915303bbda7d15ebe5e78cb086d9a03">MU</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6f9e06f8ff5a14257b944e9a95794547">NUP</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac4653b80160f0ef2d082f5b92134dc52">SIGMA_YT</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eae13800c6d87c4ad0774f7e7f4548b9e4">SIGMA_YC</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea7e9bf6babed544d3834c04cc4959bce7">HT</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6b1924cc123ac462d3a04b9dd32bccd5">HC</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea638427207011bf13608a024993a82c68">NT</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea151095d9f94c2ab932b27b200e65dec8">NC</a>,</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ead256ee90b223555e6e2a25d6f709e825">LAST_PARAM</a></div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using</span> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a9068f75bbf44102a6644a93302313eca">ParamsArray</a> = std::array&lt;double, LAST_PARAM&gt;;</div>
<div class="line">  boost::shared_ptr&lt;ParamsArray&gt; <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#abffc4450a489e35eb8416e1104a5e4c2">defaultParamsArrayPtr</a> = <span class="keyword">nullptr</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a414c5364d5cd180967a44cd35e644395">getDefaultMaterialParameters</a>() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a> = 1;</div>
<div class="line">    <span class="keywordtype">double</span> <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a> = 0.25;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d3128404d1146ae263998c3d7021bfa">sigmaYt</a> = 1;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a8501f08ab8f7016b8f611a573200de2e">sigmaYc</a> = 1;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a492b70a671ee60eede289ac149d879d2">Ht</a> = 0.1;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aeb6740721615065309fb53f74145e0d6">Hc</a> = 0.1;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5ab18b33ea693175c569f41dd6e73068">nc</a> = 1.;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a83c7590a91f3ec73e12eb3d61fa731af">nt</a> = 1.;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">nup</a> = 0.;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-young_modulus&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-poisson_ratio&quot;</span>, &amp;<a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>,</div>
<div class="line">                                 0);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-sigma_yt&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d3128404d1146ae263998c3d7021bfa">sigmaYt</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-sigma_yc&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a8501f08ab8f7016b8f611a573200de2e">sigmaYc</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-Ht&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a492b70a671ee60eede289ac149d879d2">Ht</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-Hc&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aeb6740721615065309fb53f74145e0d6">Hc</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-nt&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a83c7590a91f3ec73e12eb3d61fa731af">nt</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-nc&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5ab18b33ea693175c569f41dd6e73068">nc</a>, PETSC_NULL);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-nup&quot;</span>, &amp;<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">nup</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Young modulus: &quot;</span> &lt;&lt; <a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>;</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Poisson ratio: &quot;</span> &lt;&lt; <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac4f2a9eddaa977f5c3383da6c9518ebd">mu</a> = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea3915303bbda7d15ebe5e78cb086d9a03">MU</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a919fac8b7ae9694240f600a56d7c930d">lambda</a> = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac58a23d00454d202e36cba2c0001575e">LAMBDA</a>(<a class="code" href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a>, <a class="code" href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#abffc4450a489e35eb8416e1104a5e4c2">defaultParamsArrayPtr</a> = boost::make_shared&lt;ParamsArray&gt;();</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac58a23d00454d202e36cba2c0001575e">LAMBDA</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a919fac8b7ae9694240f600a56d7c930d">lambda</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea3915303bbda7d15ebe5e78cb086d9a03">MU</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac4f2a9eddaa977f5c3383da6c9518ebd">mu</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6f9e06f8ff5a14257b944e9a95794547">NUP</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">nup</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac4653b80160f0ef2d082f5b92134dc52">SIGMA_YT</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d3128404d1146ae263998c3d7021bfa">sigmaYt</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eae13800c6d87c4ad0774f7e7f4548b9e4">SIGMA_YC</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a8501f08ab8f7016b8f611a573200de2e">sigmaYc</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea7e9bf6babed544d3834c04cc4959bce7">HT</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a492b70a671ee60eede289ac149d879d2">Ht</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6b1924cc123ac462d3a04b9dd32bccd5">HC</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aeb6740721615065309fb53f74145e0d6">Hc</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea638427207011bf13608a024993a82c68">NT</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a83c7590a91f3ec73e12eb3d61fa731af">nt</a>;</div>
<div class="line">    (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea151095d9f94c2ab932b27b200e65dec8">NC</a>] = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5ab18b33ea693175c569f41dd6e73068">nc</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;LAMBDA: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac58a23d00454d202e36cba2c0001575e">LAMBDA</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;MU: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea3915303bbda7d15ebe5e78cb086d9a03">MU</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;NUP: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6f9e06f8ff5a14257b944e9a95794547">NUP</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;SIGMA_YT: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac4653b80160f0ef2d082f5b92134dc52">SIGMA_YT</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;SIGMA_YC: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eae13800c6d87c4ad0774f7e7f4548b9e4">SIGMA_YC</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;HT: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea7e9bf6babed544d3834c04cc4959bce7">HT</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;HC: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6b1924cc123ac462d3a04b9dd32bccd5">HC</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;NT: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea638427207011bf13608a024993a82c68">NT</a>];</div>
<div class="line">    <a class="code" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;ADOLCPlasticityWold&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;NC: &quot;</span> &lt;&lt; (*defaultParamsArrayPtr)[<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea151095d9f94c2ab932b27b200e65dec8">NC</a>];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">  <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a001c5eafd13862e1187e54fba7a73d34">addMatBlockOps</a>(<a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                 boost::ptr_deque&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;pip,</div>
<div class="line">                 std::string block_name, <a class="code" href="namespaceMoFEM.html#ab4d38dd36deb3c8334737f3526dfbf35">Sev</a> sev) {</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac038068e5bd9e7ebbda0fb995cadf18f">setParams</a>(<span class="keywordtype">short</span> tag, <span class="keywordtype">bool</span> &amp;recalculate_elastic_tangent) {</div>
<div class="line">    recalculate_elastic_tangent = <span class="keyword">true</span>;</div>
<div class="line">    <span class="keywordflow">return</span> 0;</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  //! [Paraboloidal free energy]</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac53a07e80ba12460e4bec474c1faaaa4">freeHemholtzEnergy</a>() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> t_voight_strain_op = <a class="code" href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">voight_to_strain_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_voight_total_strain = getFTensor1FromPtr&lt;6&gt;(&amp;<a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ad044ee6a464876e627f0d0fc38209659">a_sTrain</a>[0]);</div>
<div class="line">    <span class="keyword">auto</span> t_voight_plastic_strain = getFTensor1FromPtr&lt;6&gt;(&amp;<a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a14305a77033cf7b3f1912d48fa9821a0">a_plasticStrain</a>[0]);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aa6cf2750588f2eed7604f15995699b07">tTotalStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) = t_voight_strain_op(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>) * t_voight_total_strain(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5dd97785b70cb603ea04a4d79664e37b">tPlasticStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) =</div>
<div class="line">        t_voight_strain_op(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>) * t_voight_plastic_strain(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aafa1023b9d441b3016e0c0641aa7b17a">tElasticStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aa6cf2750588f2eed7604f15995699b07">tTotalStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) - <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5dd97785b70cb603ea04a4d79664e37b">tPlasticStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a> = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aafa1023b9d441b3016e0c0641aa7b17a">tElasticStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ac1a22dafe60797cbb80184777d501360">a_w</a> = 0.5 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a919fac8b7ae9694240f600a56d7c930d">lambda</a> * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a> * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a> +</div>
<div class="line">          <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac4f2a9eddaa977f5c3383da6c9518ebd">mu</a> * (<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aafa1023b9d441b3016e0c0641aa7b17a">tElasticStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aafa1023b9d441b3016e0c0641aa7b17a">tElasticStrain</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>));</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ac1a22dafe60797cbb80184777d501360">a_w</a> += <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d3128404d1146ae263998c3d7021bfa">sigmaYt</a> * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">a_internalVariables</a>[0] +</div>
<div class="line">           0.5 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a492b70a671ee60eede289ac149d879d2">Ht</a> * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">a_internalVariables</a>[0] * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">a_internalVariables</a>[0];</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ac1a22dafe60797cbb80184777d501360">a_w</a> += <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a8501f08ab8f7016b8f611a573200de2e">sigmaYc</a> * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">a_internalVariables</a>[1] +</div>
<div class="line">           0.5 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aeb6740721615065309fb53f74145e0d6">Hc</a> * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">a_internalVariables</a>[1] * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">a_internalVariables</a>[1];</div>
<div class="line"> </div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }<span class="comment"></span></div>
<div class="line"><span class="comment">  //! [Paraboloidal free energy]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="classadouble.html">adouble</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad2f2f17a4e35c8792cf030986c6b15c6">I1</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a23d722a00db561b3d35804b49cfe6c9d">J2</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Paraboloidal yield function]</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d93268f24d0a5a5615323744eae6b14">evalF</a>() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> t_voight_stress_op = <a class="code" href="namespaceADOLCPlasticity.html#ad5af676dc42ec1e2aaf35ea35171be83">voight_to_stress_op</a>();</div>
<div class="line">    <span class="keyword">auto</span> t_vioght_stress = getFTensor1FromPtr&lt;6&gt;(&amp;<a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ab582b984b6dbf62b58d4032258ab4a02">a_sTress</a>[0]);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad99174e6023f5d36a2d89e9e2d741269">tStress</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) = t_voight_stress_op(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>) * t_vioght_stress(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">Z</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a> = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad99174e6023f5d36a2d89e9e2d741269">tStress</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad2f2f17a4e35c8792cf030986c6b15c6">I1</a> = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a>;</div>
<div class="line">    constexpr <span class="keyword">auto</span> <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a class="code" href="classFTensor_1_1Kronecker__Delta__symmetric.html">FTensor::Kronecker_Delta_symmetric&lt;double&gt;</a>();</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a> /= 3.;</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a42f5232395453e37b4a58f3c25f562ff">tDeviator</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) = <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad99174e6023f5d36a2d89e9e2d741269">tStress</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) - <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">tR</a> * <a class="code" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>);</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a23d722a00db561b3d35804b49cfe6c9d">J2</a> = 0.5 * (<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a42f5232395453e37b4a58f3c25f562ff">tDeviator</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>) * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a42f5232395453e37b4a58f3c25f562ff">tDeviator</a>(<a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">i</a>, <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">j</a>));</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2752a121cff13f9038e5af27be40fda7">yieldFunction</a>() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d93268f24d0a5a5615323744eae6b14">evalF</a>();</div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#aeae5799e3d671a3121869a1c4b784d84">a_y</a> = 6 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a23d722a00db561b3d35804b49cfe6c9d">J2</a> + 2 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad2f2f17a4e35c8792cf030986c6b15c6">I1</a> * (<a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[1] - <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[0]) -</div>
<div class="line">          2 * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[0] * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[1];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Paraboloidal yield function]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Paraboloidal flow potential]</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#af19333a306356c5f7357cbbdca35b54a">flowPotential</a>() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d93268f24d0a5a5615323744eae6b14">evalF</a>();</div>
<div class="line">    <span class="keywordtype">double</span> alpha =</div>
<div class="line">        (1 - 2 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">nup</a>) /</div>
<div class="line">        (1 + <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">nup</a>); <span class="comment">// relation between alpha and plastic poisson&#39;s ratio</span></div>
<div class="line">    <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#ab86482291197e659d587dcd456273593">a_h</a> = 6 * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a23d722a00db561b3d35804b49cfe6c9d">J2</a> +</div>
<div class="line">          2 * alpha * <a class="code" href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad2f2f17a4e35c8792cf030986c6b15c6">I1</a> * (<a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[1] - <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[0]) -</div>
<div class="line">          2 * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[0] * <a class="code" href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">a_internalFluxes</a>[1];</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Paraboloidal flow potential]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> MODEL&gt;</div>
<div class="line"><span class="keyword">inline</span> <span class="keyword">auto</span> <a class="code" href="namespaceADOLCPlasticity.html#a9f40533bac3cebd45136268df42acfa1">createMaterial</a>(</div>
<div class="line">    std::array&lt;int, ClosestPointProjection::LAST_TAPE&gt; tapes_tags = {0, 1, 2}) {</div>
<div class="line">  <span class="keyword">auto</span> cp_ptr = boost::make_shared&lt;MODEL&gt;();</div>
<div class="line">  cp_ptr-&gt;getDefaultMaterialParameters();</div>
<div class="line">  cp_ptr-&gt;createMatAVecR();</div>
<div class="line">  cp_ptr-&gt;snesCreate();</div>
<div class="line">  cp_ptr-&gt;recordTapes();</div>
<div class="line">  cp_ptr-&gt;tapesTags = tapes_tags;</div>
<div class="line">  <span class="keywordflow">return</span> cp_ptr;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace ADOLCPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif //__ADOLC_MATERIAL_MODELS_HPP</span></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a></div><div class="ttdeci">@ NOSPACE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00083">definitions.h:83</a></div></div>
<div class="ttc" id="astructMoFEM_1_1NaturalBC_1_1Assembly_1_1LinearForm_html"><div class="ttname"><a href="structMoFEM_1_1NaturalBC_1_1Assembly_1_1LinearForm.html">MoFEM::NaturalBC::Assembly::LinearForm</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00067">Natural.hpp:67</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a0689d2a630ba3cee683b02982b467c77"><div class="ttname"><a href="namespaceMoFEM.html#a0689d2a630ba3cee683b02982b467c77">MoFEM::K</a></div><div class="ttdeci">VectorDouble K</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8cpp_source.html#l00125">Projection10NodeCoordsOnField.cpp:125</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a49d2a41e935ccc68adc5a9268619cba1"><div class="ttname"><a href="plastic_8cpp.html#a49d2a41e935ccc68adc5a9268619cba1">EXECUTABLE_DIMENSION</a></div><div class="ttdeci">#define EXECUTABLE_DIMENSION</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00013">plastic.cpp:13</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_abd1f0351e167546d82adc28b4dd0e681"><div class="ttname"><a href="child__and__parent_8cpp.html#abd1f0351e167546d82adc28b4dd0e681">BoundaryEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryEle BoundaryEle</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00039">child_and_parent.cpp:39</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_ab86482291197e659d587dcd456273593"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#ab86482291197e659d587dcd456273593">ADOLCPlasticity::ClosestPointProjection::a_h</a></div><div class="ttdeci">adouble a_h</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00330">ADOLCPlasticity.hpp:330</a></div></div>
<div class="ttc" id="anamespaceADOLCPlasticity_html_a620421dcdd5da3b54fd68df62abdb535"><div class="ttname"><a href="namespaceADOLCPlasticity.html#a620421dcdd5da3b54fd68df62abdb535">ADOLCPlasticity::getFTensor2SymmetricDiffBaseImpl</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; FTensor::PackPtr&lt; double *, 6 &gt;, 3 &gt; getFTensor2SymmetricDiffBaseImpl(DataForcesAndSourcesCore::EntData &amp;data, MatrixDouble &amp;storage, const bool b_bar, const int nb_integration_pts, double *w_ptr, FTensor::Number&lt; DIM &gt;)</div><div class="ttdoc">[BBar method]</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8cpp_source.html#l00085">ADOLCPlasticity.cpp:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="astructPlasticProblem_html_af28654edd552346301dbbd396730b9b2"><div class="ttname"><a href="structPlasticProblem.html#af28654edd552346301dbbd396730b9b2">PlasticProblem::solveSystem</a></div><div class="ttdeci">MoFEMErrorCode solveSystem()</div><div class="ttdoc">[Solve]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00693">adolc_plasticity.cpp:693</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EssentialPreProcReaction_3_01DisplacementCubitBcData_01_4_html"><div class="ttname"><a href="structMoFEM_1_1EssentialPreProcReaction_3_01DisplacementCubitBcData_01_4.html">MoFEM::EssentialPreProcReaction&lt; DisplacementCubitBcData &gt;</a></div><div class="ttdoc">Specialization for DisplacementCubitBcData.</div><div class="ttdef"><b>Definition:</b> <a href="EssentialDisplacementCubitBcData_8hpp_source.html#l00157">EssentialDisplacementCubitBcData.hpp:157</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_abffc4450a489e35eb8416e1104a5e4c2"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#abffc4450a489e35eb8416e1104a5e4c2">ADOLCPlasticity::ParaboloidalPlasticity::defaultParamsArrayPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; ParamsArray &gt; defaultParamsArrayPtr</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00571">ADOLCPlasticityMaterialModels.hpp:571</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a35e0a7e42f81919e776c310c509598da"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a35e0a7e42f81919e776c310c509598da">LASTBASE</a></div><div class="ttdeci">@ LASTBASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00069">definitions.h:69</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpLoopThis_html"><div class="ttname"><a href="structMoFEM_1_1OpLoopThis.html">MoFEM::OpLoopThis</a></div><div class="ttdoc">Execute &quot;this&quot; element in the operator.</div><div class="ttdef"><b>Definition:</b> <a href="DGProjection_8hpp_source.html#l00068">DGProjection.hpp:68</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga47d7053307c012af4b78f8a09e21fa83"><div class="ttname"><a href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a></div><div class="ttdeci">#define MOFEM_LOG_CHANNEL(channel)</div><div class="ttdoc">Set and reset channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00284">LogManager.hpp:284</a></div></div>
<div class="ttc" id="anamespaceADOLCPlasticity_html_a9a948d7e017d090c9357e2f0fdd3decc"><div class="ttname"><a href="namespaceADOLCPlasticity.html#a9a948d7e017d090c9357e2f0fdd3decc">ADOLCPlasticity::createTSUpdate</a></div><div class="ttdeci">boost::shared_ptr&lt; TSUpdate &gt; createTSUpdate(std::string fe_name, boost::shared_ptr&lt; FEMethod &gt; fe_ptr)</div></div>
<div class="ttc" id="aplastic_8cpp_html_a0447f1370e525557f8d7c6a1ed22be14"><div class="ttname"><a href="plastic_8cpp.html#a0447f1370e525557f8d7c6a1ed22be14">young_modulus</a></div><div class="ttdeci">double young_modulus</div><div class="ttdoc">Young modulus.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00121">plastic.cpp:121</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_aafa1023b9d441b3016e0c0641aa7b17a"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aafa1023b9d441b3016e0c0641aa7b17a">ADOLCPlasticity::ParaboloidalPlasticity::tElasticStrain</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; adouble, 3 &gt; tElasticStrain</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00544">ADOLCPlasticityMaterialModels.hpp:544</a></div></div>
<div class="ttc" id="anamespaceContactOps_html"><div class="ttname"><a href="namespaceContactOps.html">ContactOps</a></div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00099">contact.cpp:99</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9eae13800c6d87c4ad0774f7e7f4548b9e4"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eae13800c6d87c4ad0774f7e7f4548b9e4">ADOLCPlasticity::ParaboloidalPlasticity::SIGMA_YC</a></div><div class="ttdeci">@ SIGMA_YC</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00562">ADOLCPlasticityMaterialModels.hpp:562</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FEMethod_html"><div class="ttname"><a href="structMoFEM_1_1FEMethod.html">MoFEM::FEMethod</a></div><div class="ttdoc">structure for User Loop Methods on finite elements</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00369">LoopMethods.hpp:369</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_adfd7aac94645622cd0f68f5ef00876c8"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#adfd7aac94645622cd0f68f5ef00876c8">ADOLCPlasticity::ClosestPointProjection::ClosestPointProjection</a></div><div class="ttdeci">ClosestPointProjection()</div><div class="ttdef"><b>Definition:</b> <a href="ClosetPointProjection_8cpp_source.html#l00015">ClosetPointProjection.cpp:15</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ad24075b6d15f92c18d3709fd5575d00b"><div class="ttname"><a href="plastic_8cpp.html#ad24075b6d15f92c18d3709fd5575d00b">sigmaY</a></div><div class="ttdeci">double sigmaY</div><div class="ttdoc">Yield stress.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00123">plastic.cpp:123</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpFluxRhsImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpFluxRhsImpl.html">MoFEM::OpFluxRhsImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00039">Natural.hpp:39</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim_html"><div class="ttname"><a href="structMoFEM_1_1PipelineManager_1_1ElementsAndOpsByDim.html">MoFEM::PipelineManager::ElementsAndOpsByDim</a></div><div class="ttdef"><b>Definition:</b> <a href="PipelineManager_8hpp_source.html#l00038">PipelineManager.hpp:38</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EssentialPostProcLhs_3_01DisplacementCubitBcData_01_4_html"><div class="ttname"><a href="structMoFEM_1_1EssentialPostProcLhs_3_01DisplacementCubitBcData_01_4.html">MoFEM::EssentialPostProcLhs&lt; DisplacementCubitBcData &gt;</a></div><div class="ttdoc">Specialization for DisplacementCubitBcData.</div><div class="ttdef"><b>Definition:</b> <a href="EssentialDisplacementCubitBcData_8hpp_source.html#l00134">EssentialDisplacementCubitBcData.hpp:134</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adecbcd03d7be8763b60a827f434fe726"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astructMoFEM_1_1NaturalBC_1_1Assembly_1_1BiLinearForm_html"><div class="ttname"><a href="structMoFEM_1_1NaturalBC_1_1Assembly_1_1BiLinearForm.html">MoFEM::NaturalBC::Assembly::BiLinearForm</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00074">Natural.hpp:74</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00609">definitions.h:609</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_a14305a77033cf7b3f1912d48fa9821a0"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#a14305a77033cf7b3f1912d48fa9821a0">ADOLCPlasticity::ClosestPointProjection::a_plasticStrain</a></div><div class="ttdeci">ublas::vector&lt; adouble &gt; a_plasticStrain</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00325">ADOLCPlasticity.hpp:325</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ea7e9bf6babed544d3834c04cc4959bce7"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea7e9bf6babed544d3834c04cc4959bce7">ADOLCPlasticity::ParaboloidalPlasticity::HT</a></div><div class="ttdeci">@ HT</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00563">ADOLCPlasticityMaterialModels.hpp:563</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a83c7590a91f3ec73e12eb3d61fa731af"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a83c7590a91f3ec73e12eb3d61fa731af">ADOLCPlasticity::ParaboloidalPlasticity::nt</a></div><div class="ttdeci">double nt</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00555">ADOLCPlasticityMaterialModels.hpp:555</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_acc41d05266dbc9ca9a9cf7256cc12487"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#acc41d05266dbc9ca9a9cf7256cc12487">ADOLCPlasticity::ParaboloidalPlasticity::tR</a></div><div class="ttdeci">adouble tR</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00548">ADOLCPlasticityMaterialModels.hpp:548</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a2f7fbb0ea5637a1791ef88f731db0e84"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2f7fbb0ea5637a1791ef88f731db0e84">ADOLCPlasticity::ParaboloidalPlasticity::j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00539">ADOLCPlasticityMaterialModels.hpp:539</a></div></div>
<div class="ttc" id="apoisson__2d__dis__galerkin_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">static double phi</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__dis__galerkin_8cpp_source.html#l00030">poisson_2d_dis_galerkin.cpp:30</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldValues.html">MoFEM::OpCalculateVectorFieldValues</a></div><div class="ttdoc">Get values at integration pts for tensor filed rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00466">UserDataOperators.hpp:466</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a492b70a671ee60eede289ac149d879d2"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a492b70a671ee60eede289ac149d879d2">ADOLCPlasticity::ParaboloidalPlasticity::Ht</a></div><div class="ttdeci">double Ht</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00553">ADOLCPlasticityMaterialModels.hpp:553</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a4d3128404d1146ae263998c3d7021bfa"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d3128404d1146ae263998c3d7021bfa">ADOLCPlasticity::ParaboloidalPlasticity::sigmaYt</a></div><div class="ttdeci">double sigmaYt</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00554">ADOLCPlasticityMaterialModels.hpp:554</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_aeb6740721615065309fb53f74145e0d6"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aeb6740721615065309fb53f74145e0d6">ADOLCPlasticity::ParaboloidalPlasticity::Hc</a></div><div class="ttdeci">double Hc</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00553">ADOLCPlasticityMaterialModels.hpp:553</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_a06a735b6649ab72b1c55b0c3e4ace878"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#a06a735b6649ab72b1c55b0c3e4ace878">PostProcEleDomain</a></div><div class="ttdeci">PostProcEleByDim&lt; SPACE_DIM &gt;::PostProcEleDomain PostProcEleDomain</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00053">dynamic_first_order_con_law.cpp:53</a></div></div>
<div class="ttc" id="afem__tools_8h_html_ae1ddae80f6ff785f38a0c3bfb9259932"><div class="ttname"><a href="fem__tools_8h.html#ae1ddae80f6ff785f38a0c3bfb9259932">LAMBDA</a></div><div class="ttdeci">#define LAMBDA(E, NU)</div><div class="ttdef"><b>Definition:</b> <a href="fem__tools_8h_source.html#l00022">fem_tools.h:22</a></div></div>
<div class="ttc" id="aadolc__plasticity_8cpp_html_aa24fc4cb350e48a61a37e3ff464867c3"><div class="ttname"><a href="adolc__plasticity_8cpp.html#aa24fc4cb350e48a61a37e3ff464867c3">ts_update_ptr</a></div><div class="ttdeci">static boost::shared_ptr&lt; TSUpdate &gt; ts_update_ptr</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00690">adolc_plasticity.cpp:690</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_ad044ee6a464876e627f0d0fc38209659"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#ad044ee6a464876e627f0d0fc38209659">ADOLCPlasticity::ClosestPointProjection::a_sTrain</a></div><div class="ttdeci">ublas::vector&lt; adouble &gt; a_sTrain</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00324">ADOLCPlasticity.hpp:324</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EssentialPostProcRhs_3_01DisplacementCubitBcData_01_4_html"><div class="ttname"><a href="structMoFEM_1_1EssentialPostProcRhs_3_01DisplacementCubitBcData_01_4.html">MoFEM::EssentialPostProcRhs&lt; DisplacementCubitBcData &gt;</a></div><div class="ttdoc">Specialization for DisplacementCubitBcData.</div><div class="ttdef"><b>Definition:</b> <a href="EssentialDisplacementCubitBcData_8hpp_source.html#l00113">EssentialDisplacementCubitBcData.hpp:113</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_ggabb82cd10e89a1d4d25fa7756360b181ba2243b0abb08ad80d05c47e734f3134bc"><div class="ttname"><a href="group__mofem__forms.html#ggabb82cd10e89a1d4d25fa7756360b181ba2243b0abb08ad80d05c47e734f3134bc">MoFEM::PETSC</a></div><div class="ttdeci">@ PETSC</div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00105">FormsIntegrators.hpp:105</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PipelineManager_html"><div class="ttname"><a href="structMoFEM_1_1PipelineManager.html">MoFEM::PipelineManager</a></div><div class="ttdoc">PipelineManager interface.</div><div class="ttdef"><b>Definition:</b> <a href="PipelineManager_8hpp_source.html#l00024">PipelineManager.hpp:24</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6f9e06f8ff5a14257b944e9a95794547"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6f9e06f8ff5a14257b944e9a95794547">ADOLCPlasticity::ParaboloidalPlasticity::NUP</a></div><div class="ttdeci">@ NUP</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00560">ADOLCPlasticityMaterialModels.hpp:560</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpDGProjectionCoefficients_html"><div class="ttname"><a href="structMoFEM_1_1OpDGProjectionCoefficients.html">MoFEM::OpDGProjectionCoefficients</a></div><div class="ttdef"><b>Definition:</b> <a href="DGProjection_8hpp_source.html#l00119">DGProjection.hpp:119</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DisplacementCubitBcData_html"><div class="ttname"><a href="structMoFEM_1_1DisplacementCubitBcData.html">MoFEM::DisplacementCubitBcData</a></div><div class="ttdoc">Definition of the displacement bc data structure.</div><div class="ttdef"><b>Definition:</b> <a href="BCData_8hpp_source.html#l00076">BCData.hpp:76</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Projection10NodeCoordsOnField_html"><div class="ttname"><a href="structMoFEM_1_1Projection10NodeCoordsOnField.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition:</b> <a href="Projection10NodeCoordsOnField_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_a771a8d2443d7bec47aef196b5d23ade2"><div class="ttname"><a href="level__set_8cpp.html#a771a8d2443d7bec47aef196b5d23ade2">J</a></div><div class="ttdeci">FTensor::Index&lt; 'J', DIM1 &gt; J</div><div class="ttdef"><b>Definition:</b> <a href="level__set_8cpp_source.html#l00030">level_set.cpp:30</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5ec511930edd29ba1a84430964cf60cd"><div class="ttname"><a href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a></div><div class="ttdeci">double W</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00166">free_surface.cpp:166</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2__symmetric_html"><div class="ttname"><a href="classFTensor_1_1Tensor2__symmetric.html">FTensor::Tensor2_symmetric</a></div><div class="ttdef"><b>Definition:</b> <a href="Tensor2__symmetric__value_8hpp_source.html#l00013">Tensor2_symmetric_value.hpp:13</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a80d402d10e8341004c0caf10133b80ab"><div class="ttname"><a href="plastic_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00119">plastic.cpp:119</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html"><div class="ttname"><a href="structMoFEM_1_1Simple.html">MoFEM::Simple</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8hpp_source.html#l00027">Simple.hpp:27</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad6e54b3e1822ea9f7f255cf1f499e42d"><div class="ttname"><a href="namespaceMoFEM.html#ad6e54b3e1822ea9f7f255cf1f499e42d">MoFEM::getFTensor2SymmetricFromPtr&lt; 3 &gt;</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; FTensor::PackPtr&lt; double *, 6 &gt;, 3 &gt; getFTensor2SymmetricFromPtr&lt; 3 &gt;(double *ptr)</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l01027">Templates.hpp:1027</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_af19333a306356c5f7357cbbdca35b54a"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#af19333a306356c5f7357cbbdca35b54a">ADOLCPlasticity::ParaboloidalPlasticity::flowPotential</a></div><div class="ttdeci">MoFEMErrorCode flowPotential()</div><div class="ttdoc">[Paraboloidal yield function]</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00705">ADOLCPlasticityMaterialModels.hpp:705</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ad0d0f13c8ee6366de69b040e99c2c8bb"><div class="ttname"><a href="plastic_8cpp.html#ad0d0f13c8ee6366de69b040e99c2c8bb">geom_order</a></div><div class="ttdeci">int geom_order</div><div class="ttdoc">Order if fixed.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00137">plastic.cpp:137</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ac4f2a9eddaa977f5c3383da6c9518ebd"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac4f2a9eddaa977f5c3383da6c9518ebd">ADOLCPlasticity::ParaboloidalPlasticity::mu</a></div><div class="ttdeci">double mu</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00551">ADOLCPlasticityMaterialModels.hpp:551</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor2_html"><div class="ttname"><a href="classFTensor_1_1Tensor2.html">FTensor::Tensor2&lt; double, 3, 3 &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ea638427207011bf13608a024993a82c68"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea638427207011bf13608a024993a82c68">ADOLCPlasticity::ParaboloidalPlasticity::NT</a></div><div class="ttdeci">@ NT</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00565">ADOLCPlasticityMaterialModels.hpp:565</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpFluxLhsImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpFluxLhsImpl.html">MoFEM::OpFluxLhsImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00043">Natural.hpp:43</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a99b759dd71581f497626034776727d3d"><div class="ttname"><a href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a></div><div class="ttdeci">constexpr IntegrationType I</div><div class="ttdef"><b>Definition:</b> <a href="operators__tests_8cpp_source.html#l00031">operators_tests.cpp:31</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="astructPlasticProblem_html"><div class="ttname"><a href="structPlasticProblem.html">PlasticProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00127">adolc_plasticity.cpp:127</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9e"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9e">ADOLCPlasticity::ParaboloidalPlasticity::ModelParams</a></div><div class="ttdeci">ModelParams</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00557">ADOLCPlasticityMaterialModels.hpp:557</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a4248ee2b94d3ab2b979c273a4b131410"><div class="ttname"><a href="structPlasticProblem.html#a4248ee2b94d3ab2b979c273a4b131410">PlasticProblem::outputResults</a></div><div class="ttdeci">MoFEMErrorCode outputResults()</div><div class="ttdoc">[Getting norms]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l01148">adolc_plasticity.cpp:1148</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12">FieldSpace</a></div><div class="ttdeci">FieldSpace</div><div class="ttdoc">approximation spaces</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00082">definitions.h:82</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ab4d38dd36deb3c8334737f3526dfbf35"><div class="ttname"><a href="namespaceMoFEM.html#ab4d38dd36deb3c8334737f3526dfbf35">MoFEM::Sev</a></div><div class="ttdeci">MoFEM::LogManager::SeverityLevel Sev</div><div class="ttdef"><b>Definition:</b> <a href="CoreTemplates_8hpp_source.html#l00017">CoreTemplates.hpp:17</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a5ab18b33ea693175c569f41dd6e73068"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5ab18b33ea693175c569f41dd6e73068">ADOLCPlasticity::ParaboloidalPlasticity::nc</a></div><div class="ttdeci">double nc</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00555">ADOLCPlasticityMaterialModels.hpp:555</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_ab6aeaf2b20f0755222d0124d2c7524c4"><div class="ttname"><a href="structPlasticProblem.html#ab6aeaf2b20f0755222d0124d2c7524c4">PlasticProblem::gettingNorms</a></div><div class="ttdeci">MoFEMErrorCode gettingNorms()</div><div class="ttdoc">[Solve]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l01095">adolc_plasticity.cpp:1095</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_abded98f73756cdfa3293cc0b9fd50450"><div class="ttname"><a href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a></div><div class="ttdeci">int save_every_nth_step</div><div class="ttdef"><b>Definition:</b> <a href="photon__diffusion_8cpp_source.html#l00067">photon_diffusion.cpp:67</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Number_html"><div class="ttname"><a href="classFTensor_1_1Number.html">FTensor::Number</a></div><div class="ttdef"><b>Definition:</b> <a href="Number_8hpp_source.html#l00011">Number.hpp:11</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1J2Plasticity_3_013_01_4_html_a9f461afd60eb0ed42c48838355bfae8d"><div class="ttname"><a href="structADOLCPlasticity_1_1J2Plasticity_3_013_01_4.html#a9f461afd60eb0ed42c48838355bfae8d">ADOLCPlasticity::J2Plasticity&lt; 3 &gt;::J2Plasticity</a></div><div class="ttdeci">J2Plasticity()</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00075">ADOLCPlasticityMaterialModels.hpp:75</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8hpp_source.html#l01099">DMMoFEM.hpp:1099</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EssentialPreProc_3_01DisplacementCubitBcData_01_4_html"><div class="ttname"><a href="structMoFEM_1_1EssentialPreProc_3_01DisplacementCubitBcData_01_4.html">MoFEM::EssentialPreProc&lt; DisplacementCubitBcData &gt;</a></div><div class="ttdoc">Specialization for DisplacementCubitBcData.</div><div class="ttdef"><b>Definition:</b> <a href="EssentialDisplacementCubitBcData_8hpp_source.html#l00091">EssentialDisplacementCubitBcData.hpp:91</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a414c5364d5cd180967a44cd35e644395"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a414c5364d5cd180967a44cd35e644395">ADOLCPlasticity::ParaboloidalPlasticity::getDefaultMaterialParameters</a></div><div class="ttdeci">MoFEMErrorCode getDefaultMaterialParameters()</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00573">ADOLCPlasticityMaterialModels.hpp:573</a></div></div>
<div class="ttc" id="astructBlockData_html"><div class="ttname"><a href="structBlockData.html">BlockData</a></div><div class="ttdef"><b>Definition:</b> <a href="ElasticityMixedFormulation_8hpp_source.html#l00012">ElasticityMixedFormulation.hpp:12</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="astructMoFEM_1_1BcManager_html"><div class="ttname"><a href="structMoFEM_1_1BcManager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="BcManager_8hpp_source.html#l00025">BcManager.hpp:25</a></div></div>
<div class="ttc" id="aclassBoundaryEleOp_html"><div class="ttname"><a href="classBoundaryEleOp.html">BoundaryEleOp</a></div></div>
<div class="ttc" id="astructContactOps_1_1CommonData_html_aae635e19c3c8a2f55be1cc5a1285557f"><div class="ttname"><a href="structContactOps_1_1CommonData.html#aae635e19c3c8a2f55be1cc5a1285557f">ContactOps::CommonData::totalTraction</a></div><div class="ttdeci">static SmartPetscObj&lt; Vec &gt; totalTraction</div><div class="ttdef"><b>Definition:</b> <a href="ContactOps_8hpp_source.html#l00029">ContactOps.hpp:29</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="LogManager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a0b9a2881ee6be9f98852c9e1af165b35"><div class="ttname"><a href="structPlasticProblem.html#a0b9a2881ee6be9f98852c9e1af165b35">PlasticProblem::setupProblem</a></div><div class="ttdeci">MoFEMErrorCode setupProblem()</div><div class="ttdoc">[Read mesh]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00188">adolc_plasticity.cpp:188</a></div></div>
<div class="ttc" id="aacoustic_8cpp_html_ad68ed57e17c71816ecfad0ea6746c8d3"><div class="ttname"><a href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a></div><div class="ttdeci">void simple(double P1[], double P2[], double P3[], double c[], const int N)</div><div class="ttdef"><b>Definition:</b> <a href="acoustic_8cpp_source.html#l00069">acoustic.cpp:69</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a4d93268f24d0a5a5615323744eae6b14"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a4d93268f24d0a5a5615323744eae6b14">ADOLCPlasticity::ParaboloidalPlasticity::evalF</a></div><div class="ttdeci">MoFEMErrorCode evalF()</div><div class="ttdoc">[Paraboloidal yield function]</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00681">ADOLCPlasticityMaterialModels.hpp:681</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ad2f2f17a4e35c8792cf030986c6b15c6"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad2f2f17a4e35c8792cf030986c6b15c6">ADOLCPlasticity::ParaboloidalPlasticity::I1</a></div><div class="ttdeci">adouble I1</div><div class="ttdoc">[Paraboloidal free energy]</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00678">ADOLCPlasticityMaterialModels.hpp:678</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a0c542c138f0b06a7e830aed28e1c05f5"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a0c542c138f0b06a7e830aed28e1c05f5">ADOLCPlasticity::ParaboloidalPlasticity::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 3 &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00538">ADOLCPlasticityMaterialModels.hpp:538</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_adacc7b9e7c4fa95cc0959ca359f999f5"><div class="ttname"><a href="LogManager_8hpp.html#adacc7b9e7c4fa95cc0959ca359f999f5">MOFEM_LOG_SYNCHRONISE</a></div><div class="ttdeci">#define MOFEM_LOG_SYNCHRONISE(comm)</div><div class="ttdoc">Synchronise &quot;SYNC&quot; channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00345">LogManager.hpp:345</a></div></div>
<div class="ttc" id="astructPlasticOps_1_1Monitor_html"><div class="ttname"><a href="structPlasticOps_1_1Monitor.html">PlasticOps::Monitor</a></div><div class="ttdef"><b>Definition:</b> <a href="PlasticOpsMonitor_8hpp_source.html#l00009">PlasticOpsMonitor.hpp:9</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a571fc4d0022947a6d01a56a53d5668e6"><div class="ttname"><a href="plastic_8cpp.html#a571fc4d0022947a6d01a56a53d5668e6">poisson_ratio</a></div><div class="ttdeci">double poisson_ratio</div><div class="ttdoc">Poisson ratio.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00122">plastic.cpp:122</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ae9faec98b784e677f51cf7ede5a592b4"><div class="ttname"><a href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::SideEle SideEle</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00061">plastic.cpp:61</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHVecTensorField_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHVecTensorField.html">MoFEM::OpCalculateHVecTensorField</a></div><div class="ttdoc">Calculate tenor field using vectorial base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l02572">UserDataOperators.hpp:2572</a></div></div>
<div class="ttc" id="anamespaceADOLCPlasticity_html_a9f40533bac3cebd45136268df42acfa1"><div class="ttname"><a href="namespaceADOLCPlasticity.html#a9f40533bac3cebd45136268df42acfa1">ADOLCPlasticity::createMaterial</a></div><div class="ttdeci">auto createMaterial(std::array&lt; int, ClosestPointProjection::LAST_TAPE &gt; tapes_tags={0, 1, 2})</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00721">ADOLCPlasticityMaterialModels.hpp:721</a></div></div>
<div class="ttc" id="anamespaceADOLCPlasticity_html_a3179f77550ab148d8de079c82b01e4c7"><div class="ttname"><a href="namespaceADOLCPlasticity.html#a3179f77550ab148d8de079c82b01e4c7">ADOLCPlasticity::voight_to_strain_op</a></div><div class="ttdeci">FTensor::Dg&lt; double, 3, 6 &gt; voight_to_strain_op()</div><div class="ttdoc">Op convert Vight strain vector to strain tensor.</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00029">ADOLCPlasticity.hpp:29</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced"><div class="ttname"><a href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">MoFEM::GAUSS</a></div><div class="ttdeci">@ GAUSS</div><div class="ttdef"><b>Definition:</b> <a href="FormsIntegrators_8hpp_source.html#l00136">FormsIntegrators.hpp:136</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a5c168b591ba21156d7ba969b6838b6f2"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5c168b591ba21156d7ba969b6838b6f2">ADOLCPlasticity::ParaboloidalPlasticity::Z</a></div><div class="ttdeci">FTensor::Index&lt; 'Z', 6 &gt; Z</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00540">ADOLCPlasticityMaterialModels.hpp:540</a></div></div>
<div class="ttc" id="aMatrixFunction_8hpp_html"><div class="ttname"><a href="MatrixFunction_8hpp.html">MatrixFunction.hpp</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_abfd86e8a64c90454f24b88e5076ac668"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#abfd86e8a64c90454f24b88e5076ac668">ADOLCPlasticity::ParaboloidalPlasticity::ParaboloidalPlasticity</a></div><div class="ttdeci">ParaboloidalPlasticity()</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00533">ADOLCPlasticityMaterialModels.hpp:533</a></div></div>
<div class="ttc" id="astructMoFEM_1_1AddFluxToLhsPipelineImpl_html"><div class="ttname"><a href="structMoFEM_1_1AddFluxToLhsPipelineImpl.html">MoFEM::AddFluxToLhsPipelineImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00049">Natural.hpp:49</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a5dd97785b70cb603ea04a4d79664e37b"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a5dd97785b70cb603ea04a4d79664e37b">ADOLCPlasticity::ParaboloidalPlasticity::tPlasticStrain</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; adouble, 3 &gt; tPlasticStrain</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00543">ADOLCPlasticityMaterialModels.hpp:543</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalcNormL2Tensor1_html"><div class="ttname"><a href="structMoFEM_1_1OpCalcNormL2Tensor1.html">MoFEM::OpCalcNormL2Tensor1</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor1.</div><div class="ttdef"><b>Definition:</b> <a href="NormsOperators_8hpp_source.html#l00044">NormsOperators.hpp:44</a></div></div>
<div class="ttc" id="aTsCtx_8hpp_html_a45f84933fa6a1de0b314d4d51c39bc71"><div class="ttname"><a href="TsCtx_8hpp.html#a45f84933fa6a1de0b314d4d51c39bc71">TSADAPTMOFEM</a></div><div class="ttdeci">#define TSADAPTMOFEM</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8hpp_source.html#l00010">TsCtx.hpp:10</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a001c5eafd13862e1187e54fba7a73d34"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a001c5eafd13862e1187e54fba7a73d34">ADOLCPlasticity::ParaboloidalPlasticity::addMatBlockOps</a></div><div class="ttdeci">MoFEMErrorCode addMatBlockOps(MoFEM::Interface &amp;m_field, boost::ptr_deque&lt; ForcesAndSourcesCore::UserDataOperator &gt; &amp;pip, std::string block_name, Sev sev)</div><div class="ttdoc">Get model parameters from blocks.</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00641">ADOLCPlasticityMaterialModels.hpp:641</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_ac1a22dafe60797cbb80184777d501360"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#ac1a22dafe60797cbb80184777d501360">ADOLCPlasticity::ClosestPointProjection::a_w</a></div><div class="ttdeci">adouble a_w</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00328">ADOLCPlasticity.hpp:328</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga202c2d0258d78f4c0d60ecac64bf2252"><div class="ttname"><a href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a></div><div class="ttdeci">#define MOFEM_LOG_TAG(channel, tag)</div><div class="ttdoc">Tag channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00339">LogManager.hpp:339</a></div></div>
<div class="ttc" id="astructMoFEM_1_1AddFluxToRhsPipelineImpl_html"><div class="ttname"><a href="structMoFEM_1_1AddFluxToRhsPipelineImpl.html">MoFEM::AddFluxToRhsPipelineImpl</a></div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00046">Natural.hpp:46</a></div></div>
<div class="ttc" id="anamespaceADOLCPlasticity_html"><div class="ttname"><a href="namespaceADOLCPlasticity.html">ADOLCPlasticity</a></div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00024">ADOLCPlasticity.hpp:24</a></div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_aa3a41bb6c8e21d9d5b1acfc97e34c178"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#aa3a41bb6c8e21d9d5b1acfc97e34c178">PostProcEleBdy</a></div><div class="ttdeci">PostProcEleByDim&lt; SPACE_DIM &gt;::PostProcEleBdy PostProcEleBdy</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00055">dynamic_first_order_con_law.cpp:55</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a31cf037a330e535948dac3d980124879"><div class="ttname"><a href="structPlasticProblem.html#a31cf037a330e535948dac3d980124879">PlasticProblem::readMesh</a></div><div class="ttdeci">MoFEMErrorCode readMesh()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00173">adolc_plasticity.cpp:173</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a6fd6ccaf74ee7b9e3750aab7e154fbc9"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a6fd6ccaf74ee7b9e3750aab7e154fbc9">ADOLCPlasticity::ParaboloidalPlasticity::nup</a></div><div class="ttdeci">double nup</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00552">ADOLCPlasticityMaterialModels.hpp:552</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_a12cc80b79b100c3360b57279bb678130"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#a12cc80b79b100c3360b57279bb678130">ADOLCPlasticity::ClosestPointProjection::a_internalFluxes</a></div><div class="ttdeci">ublas::vector&lt; adouble &gt; a_internalFluxes</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00327">ADOLCPlasticity.hpp:327</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a52438586143ef05bfe922220a317c144"><div class="ttname"><a href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a></div><div class="ttdeci">constexpr auto t_kd</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00137">free_surface.cpp:137</a></div></div>
<div class="ttc" id="aclassBiLinearForm_html"><div class="ttname"><a href="classBiLinearForm.html">BiLinearForm</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetHOWeightsOnSubDim_html"><div class="ttname"><a href="structMoFEM_1_1OpSetHOWeightsOnSubDim.html">MoFEM::OpSetHOWeightsOnSubDim</a></div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00145">HODataOperators.hpp:145</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00015">activate_deactivate_dofs.cpp:15</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_affc25cefd7a04722a912b9ccdf25e38e"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#affc25cefd7a04722a912b9ccdf25e38e">ADOLCPlasticity::ClosestPointProjection::nbInternalVariables</a></div><div class="ttdeci">int nbInternalVariables</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00141">ADOLCPlasticity.hpp:141</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoabBase_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoabBase.html">MoFEM::PostProcBrokenMeshInMoabBase</a></div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00094">PostProcBrokenMeshInMoabBase.hpp:94</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_a064b37b0afa2e159438c85c337f3eb02"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#a064b37b0afa2e159438c85c337f3eb02">ADOLCPlasticity::ClosestPointProjection::activeVariablesW</a></div><div class="ttdeci">VectorAdaptor activeVariablesW</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00173">ADOLCPlasticity.hpp:173</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a1342a5bb82a44eb578a7246723649d11"><div class="ttname"><a href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a></div><div class="ttdeci">EntitiesFieldData::EntData EntData</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00037">child_and_parent.cpp:37</a></div></div>
<div class="ttc" id="aContactOps_8hpp_html"><div class="ttname"><a href="ContactOps_8hpp.html">ContactOps.hpp</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition:</b> <a href="Index_8hpp_source.html#l00023">Index.hpp:23</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a512e17945fff13f02e112034b56c595f"><div class="ttname"><a href="structPlasticProblem.html#a512e17945fff13f02e112034b56c595f">PlasticProblem::boundaryCondition</a></div><div class="ttdeci">MoFEMErrorCode boundaryCondition()</div><div class="ttdoc">[Set up problem]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00359">adolc_plasticity.cpp:359</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a9a0af54d9bcdc0ebab2aaa1aaa1b0585"><div class="ttname"><a href="structPlasticProblem.html#a9a0af54d9bcdc0ebab2aaa1aaa1b0585">PlasticProblem::assembleSystem</a></div><div class="ttdeci">MoFEMErrorCode assembleSystem()</div><div class="ttdoc">[Boundary condition]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00442">adolc_plasticity.cpp:442</a></div></div>
<div class="ttc" id="astructMoFEM_1_1AddHOOps_html"><div class="ttname"><a href="structMoFEM_1_1AddHOOps.html">MoFEM::AddHOOps</a></div><div class="ttdoc">Add operators pushing bases from local to physical configuration.</div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00413">HODataOperators.hpp:413</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateVectorFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateVectorFieldGradient.html">MoFEM::OpCalculateVectorFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01535">UserDataOperators.hpp:1535</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a42f5232395453e37b4a58f3c25f562ff"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a42f5232395453e37b4a58f3c25f562ff">ADOLCPlasticity::ParaboloidalPlasticity::tDeviator</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; adouble, 3 &gt; tDeviator</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00546">ADOLCPlasticityMaterialModels.hpp:546</a></div></div>
<div class="ttc" id="astructContactOps_1_1CommonData_html_acad361eff40ea5259c2d789789fdf8d6"><div class="ttname"><a href="structContactOps_1_1CommonData.html#acad361eff40ea5259c2d789789fdf8d6">ContactOps::CommonData::createTotalTraction</a></div><div class="ttdeci">static auto createTotalTraction(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition:</b> <a href="ContactOps_8hpp_source.html#l00031">ContactOps.hpp:31</a></div></div>
<div class="ttc" id="anamespaceContactOps_html_a3449dc094e02f6a72aa4c5ea32c55e2c"><div class="ttname"><a href="namespaceContactOps.html#a3449dc094e02f6a72aa4c5ea32c55e2c">ContactOps::cn_contact</a></div><div class="ttdeci">double cn_contact</div><div class="ttdef"><b>Definition:</b> <a href="contact_8cpp_source.html#l00100">contact.cpp:100</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ead256ee90b223555e6e2a25d6f709e825"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ead256ee90b223555e6e2a25d6f709e825">ADOLCPlasticity::ParaboloidalPlasticity::LAST_PARAM</a></div><div class="ttdeci">@ LAST_PARAM</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00567">ADOLCPlasticityMaterialModels.hpp:567</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a4fd802798873644e765120cc1a563370"><div class="ttname"><a href="structPlasticProblem.html#a4fd802798873644e765120cc1a563370">PlasticProblem::checkResults</a></div><div class="ttdeci">MoFEMErrorCode checkResults()</div><div class="ttdoc">[Postprocessing results]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l01178">adolc_plasticity.cpp:1178</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="astructElementsAndOps_html"><div class="ttname"><a href="structElementsAndOps.html">ElementsAndOps</a></div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00018">child_and_parent.cpp:18</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="aclassDomainEleOp_html"><div class="ttname"><a href="classDomainEleOp.html">DomainEleOp</a></div></div>
<div class="ttc" id="aclassadouble_html"><div class="ttname"><a href="classadouble.html">adouble</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="aLogManager_8hpp_html_afebc04c745581aa8f72c6ace26073f6c"><div class="ttname"><a href="LogManager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a></div><div class="ttdeci">#define MOFEM_TAG_AND_LOG(channel, severity, tag)</div><div class="ttdoc">Tag and log in channel.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00362">LogManager.hpp:362</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition:</b> <a href="LogManager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="astructMoFEM_1_1NaturalBC_1_1Assembly_html"><div class="ttname"><a href="structMoFEM_1_1NaturalBC_1_1Assembly.html">MoFEM::NaturalBC::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00065">Natural.hpp:65</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a></div><div class="ttdeci">@ DEMKOWICZ_JACOBI_BASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00066">definitions.h:66</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CommInterface_html"><div class="ttname"><a href="structMoFEM_1_1CommInterface.html">MoFEM::CommInterface</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition:</b> <a href="CommInterface_8hpp_source.html#l00021">CommInterface.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpDGProjectionEvaluation_html"><div class="ttname"><a href="structMoFEM_1_1OpDGProjectionEvaluation.html">MoFEM::OpDGProjectionEvaluation</a></div><div class="ttdef"><b>Definition:</b> <a href="DGProjection_8hpp_source.html#l00136">DGProjection.hpp:136</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_aa6cf2750588f2eed7604f15995699b07"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#aa6cf2750588f2eed7604f15995699b07">ADOLCPlasticity::ParaboloidalPlasticity::tTotalStrain</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; adouble, 3 &gt; tTotalStrain</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00542">ADOLCPlasticityMaterialModels.hpp:542</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_a76c4a7f8835e3e9157bd6f44f6e5c22e"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#a76c4a7f8835e3e9157bd6f44f6e5c22e">ADOLCPlasticity::ClosestPointProjection::a_internalVariables</a></div><div class="ttdeci">ublas::vector&lt; adouble &gt; a_internalVariables</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00326">ADOLCPlasticity.hpp:326</a></div></div>
<div class="ttc" id="agroup__dm_html_gac5ffe05a59f8ff6145029d62093f2e9b"><div class="ttname"><a href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">MoFEM::DMoFEMGetInterfacePtr</a></div><div class="ttdeci">PetscErrorCode DMoFEMGetInterfacePtr(DM dm, MoFEM::Interface **m_field_ptr)</div><div class="ttdoc">Get pointer to MoFEM::Interface.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00414">DMMoFEM.cpp:414</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="aADOLCPlasticityMaterialModels_8hpp_html"><div class="ttname"><a href="ADOLCPlasticityMaterialModels_8hpp.html">ADOLCPlasticityMaterialModels.hpp</a></div><div class="ttdoc">Matetial models for plasticity.</div></div>
<div class="ttc" id="aplastic_8cpp_html_afcb7aec2c7aac959ba87ce35ab9a1b87"><div class="ttname"><a href="plastic_8cpp.html#afcb7aec2c7aac959ba87ce35ab9a1b87">CONTACT_SPACE</a></div><div class="ttdeci">constexpr FieldSpace CONTACT_SPACE</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00052">plastic.cpp:52</a></div></div>
<div class="ttc" id="aHookeElement_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="HookeElement_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="HookeElement_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="aADOLCPlasticity_8hpp_html"><div class="ttname"><a href="ADOLCPlasticity_8hpp.html">ADOLCPlasticity.hpp</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_aeae5799e3d671a3121869a1c4b784d84"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#aeae5799e3d671a3121869a1c4b784d84">ADOLCPlasticity::ClosestPointProjection::a_y</a></div><div class="ttdeci">adouble a_y</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00329">ADOLCPlasticity.hpp:329</a></div></div>
<div class="ttc" id="atest__broken__space_8cpp_html_a190ff8a4b88c3f62a7da15f5a2b8c227"><div class="ttname"><a href="test__broken__space_8cpp.html#a190ff8a4b88c3f62a7da15f5a2b8c227">approx_order</a></div><div class="ttdeci">int approx_order</div><div class="ttdef"><b>Definition:</b> <a href="test__broken__space_8cpp_source.html#l00050">test_broken_space.cpp:50</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a4e9536ce1c9cadcb7f26d36a4e96d76e"><div class="ttname"><a href="namespaceMoFEM.html#a4e9536ce1c9cadcb7f26d36a4e96d76e">MoFEM::VecOfTimeScalingMethods</a></div><div class="ttdeci">std::vector&lt; boost::shared_ptr&lt; ScalingMethod &gt; &gt; VecOfTimeScalingMethods</div><div class="ttdoc">Vector of time scaling methods.</div><div class="ttdef"><b>Definition:</b> <a href="Natural_8hpp_source.html#l00020">Natural.hpp:20</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a112dfab22d28426fcd0ab2d61cf8f494"><div class="ttname"><a href="namespaceMoFEM.html#a112dfab22d28426fcd0ab2d61cf8f494">MoFEM::DMMoFEMTSSetMonitor</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetMonitor(DM dm, TS ts, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">Set Monitor To TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01056">DMMoFEM.cpp:1056</a></div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_a74577585cf12d1712ab9c57616d49205"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#a74577585cf12d1712ab9c57616d49205">mu</a></div><div class="ttdeci">double mu</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00098">dynamic_first_order_con_law.cpp:98</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition:</b> <a href="incompressible__elasticity_8cpp_source.html#l00199">incompressible_elasticity.cpp:199</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9eac58a23d00454d202e36cba2c0001575e"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac58a23d00454d202e36cba2c0001575e">ADOLCPlasticity::ParaboloidalPlasticity::LAMBDA</a></div><div class="ttdeci">@ LAMBDA</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00558">ADOLCPlasticityMaterialModels.hpp:558</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12aa30e505d5df1a8d715b9d175cd97ae82">HCURL</a></div><div class="ttdeci">@ HCURL</div><div class="ttdoc">field with continuous tangents</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00086">definitions.h:86</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="anamespaceADOLCPlasticity_html_ad5af676dc42ec1e2aaf35ea35171be83"><div class="ttname"><a href="namespaceADOLCPlasticity.html#ad5af676dc42ec1e2aaf35ea35171be83">ADOLCPlasticity::voight_to_stress_op</a></div><div class="ttdeci">FTensor::Dg&lt; double, 3, 6 &gt; voight_to_stress_op()</div><div class="ttdoc">Op convert Vight stress vector to stress tensor.</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00049">ADOLCPlasticity.hpp:49</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_abee82d436d03244c6886fc99f71116f0"><div class="ttname"><a href="namespaceMoFEM.html#abee82d436d03244c6886fc99f71116f0">MoFEM::PetscOptionsGetEList</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetEList(PetscOptions *, const char pre[], const char name[], const char *const *list, PetscInt next, PetscInt *value, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00203">DeprecatedPetsc.hpp:203</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a77d94d2111c0c988bc3100b3910cc25c"><div class="ttname"><a href="namespaceMoFEM.html#a77d94d2111c0c988bc3100b3910cc25c">MoFEM::createVectorMPI</a></div><div class="ttdeci">auto createVectorMPI(MPI_Comm comm, PetscInt n, PetscInt N)</div><div class="ttdoc">Create MPI Vector.</div><div class="ttdef"><b>Definition:</b> <a href="PetscSmartObj_8hpp_source.html#l00202">PetscSmartObj.hpp:202</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ClosestPointProjection_html_ab582b984b6dbf62b58d4032258ab4a02"><div class="ttname"><a href="structADOLCPlasticity_1_1ClosestPointProjection.html#ab582b984b6dbf62b58d4032258ab4a02">ADOLCPlasticity::ClosestPointProjection::a_sTress</a></div><div class="ttdeci">ublas::vector&lt; adouble &gt; a_sTress</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticity_8hpp_source.html#l00327">ADOLCPlasticity.hpp:327</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a9068f75bbf44102a6644a93302313eca"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a9068f75bbf44102a6644a93302313eca">ADOLCPlasticity::ParaboloidalPlasticity::ParamsArray</a></div><div class="ttdeci">std::array&lt; double, LAST_PARAM &gt; ParamsArray</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00570">ADOLCPlasticityMaterialModels.hpp:570</a></div></div>
<div class="ttc" id="anamespacesdf__hertz__2d__axisymm__plane_html_a8204f26163e5d184298bc6fa855b88ea"><div class="ttname"><a href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">sdf_hertz_2d_axisymm_plane.d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition:</b> <a href="sdf__hertz__2d__axisymm__plane_8py_source.html#l00004">sdf_hertz_2d_axisymm_plane.py:4</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a37c8aa74d57ef9fcf60e6c508b987113"><div class="ttname"><a href="namespaceMoFEM.html#a37c8aa74d57ef9fcf60e6c508b987113">MoFEM::MoFEMSNESMonitorFields</a></div><div class="ttdeci">MoFEMErrorCode MoFEMSNESMonitorFields(SNES snes, PetscInt its, PetscReal fgnorm, SnesCtx *snes_ctx)</div><div class="ttdoc">Sens monitor printing residual field by field.</div><div class="ttdef"><b>Definition:</b> <a href="SnesCtx_8cpp_source.html#l00232">SnesCtx.cpp:232</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a></div><div class="ttdeci">FieldApproximationBase</div><div class="ttdoc">approximation base</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00058">definitions.h:58</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ea3915303bbda7d15ebe5e78cb086d9a03"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea3915303bbda7d15ebe5e78cb086d9a03">ADOLCPlasticity::ParaboloidalPlasticity::MU</a></div><div class="ttdeci">@ MU</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00559">ADOLCPlasticityMaterialModels.hpp:559</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a48eee41fb40c3920544fb006daadc52e"><div class="ttname"><a href="structPlasticProblem.html#a48eee41fb40c3920544fb006daadc52e">PlasticProblem::cpPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; ClosestPointProjection &gt; cpPtr</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00148">adolc_plasticity.cpp:148</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a8501f08ab8f7016b8f611a573200de2e"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a8501f08ab8f7016b8f611a573200de2e">ADOLCPlasticity::ParaboloidalPlasticity::sigmaYc</a></div><div class="ttdeci">double sigmaYc</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00554">ADOLCPlasticityMaterialModels.hpp:554</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html_a6078a7f940fe823a1c1ccb4cc277e03e"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">ReactionDiffusionEquation::D</a></div><div class="ttdeci">const double D</div><div class="ttdoc">diffusivity</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00020">reaction_diffusion.cpp:20</a></div></div>
<div class="ttc" id="aContactNaturalBC_8hpp_html"><div class="ttname"><a href="ContactNaturalBC_8hpp.html">ContactNaturalBC.hpp</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition:</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ac038068e5bd9e7ebbda0fb995cadf18f"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac038068e5bd9e7ebbda0fb995cadf18f">ADOLCPlasticity::ParaboloidalPlasticity::setParams</a></div><div class="ttdeci">MoFEMErrorCode setParams(short tag, bool &amp;recalculate_elastic_tangent)</div><div class="ttdoc">Set parameters for ADOL-C of constitutive relations.</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00647">ADOLCPlasticityMaterialModels.hpp:647</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a2752a121cff13f9038e5af27be40fda7"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a2752a121cff13f9038e5af27be40fda7">ADOLCPlasticity::ParaboloidalPlasticity::yieldFunction</a></div><div class="ttdeci">MoFEMErrorCode yieldFunction()</div><div class="ttdoc">Set yield function.</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00695">ADOLCPlasticityMaterialModels.hpp:695</a></div></div>
<div class="ttc" id="anamespacePlasticOps_html_ad104160ccee829446f9f4701d5364629"><div class="ttname"><a href="namespacePlasticOps.html#ad104160ccee829446f9f4701d5364629">PlasticOps::trace</a></div><div class="ttdeci">double trace(FTensor::Tensor2_symmetric&lt; T, 2 &gt; &amp;t_stress)</div><div class="ttdef"><b>Definition:</b> <a href="PlasticOpsGeneric_8hpp_source.html#l00080">PlasticOpsGeneric.hpp:80</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Kronecker__Delta__symmetric_html"><div class="ttname"><a href="classFTensor_1_1Kronecker__Delta__symmetric.html">FTensor::Kronecker_Delta_symmetric</a></div><div class="ttdoc">Kronecker Delta class symmetric.</div><div class="ttdef"><b>Definition:</b> <a href="Kronecker__Delta_8hpp_source.html#l00049">Kronecker_Delta.hpp:49</a></div></div>
<div class="ttc" id="atensor__divergence__operator_8cpp_html_a614aff059c889b5343fba0aaadecebb4"><div class="ttname"><a href="tensor__divergence__operator_8cpp.html#a614aff059c889b5343fba0aaadecebb4">AssemblyDomainEleOp</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::OpBase AssemblyDomainEleOp</div><div class="ttdef"><b>Definition:</b> <a href="tensor__divergence__operator_8cpp_source.html#l00059">tensor_divergence_operator.cpp:59</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9eac4653b80160f0ef2d082f5b92134dc52"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9eac4653b80160f0ef2d082f5b92134dc52">ADOLCPlasticity::ParaboloidalPlasticity::SIGMA_YT</a></div><div class="ttdeci">@ SIGMA_YT</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00561">ADOLCPlasticityMaterialModels.hpp:561</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_addce2077b77e610d248ae548a01e77e3"><div class="ttname"><a href="namespaceMoFEM.html#addce2077b77e610d248ae548a01e77e3">MoFEM::getDMSnesCtx</a></div><div class="ttdeci">auto getDMSnesCtx(DM dm)</div><div class="ttdoc">Get SNES context data structure used by DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8hpp_source.html#l01127">DMMoFEM.hpp:1127</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespaceMoFEM.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="aEshelbianADOL-C_8cpp_html_a2942a742e89c8e16193e7aeca63c995c"><div class="ttname"><a href="EshelbianADOL-C_8cpp.html#a2942a742e89c8e16193e7aeca63c995c">third</a></div><div class="ttdeci">constexpr double third</div><div class="ttdef"><b>Definition:</b> <a href="EshelbianADOL-C_8cpp_source.html#l00017">EshelbianADOL-C.cpp:17</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ea151095d9f94c2ab932b27b200e65dec8"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea151095d9f94c2ab932b27b200e65dec8">ADOLCPlasticity::ParaboloidalPlasticity::NC</a></div><div class="ttdeci">@ NC</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00566">ADOLCPlasticityMaterialModels.hpp:566</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a80b637c04b8c449d54efa75ab73b67df"><div class="ttname"><a href="child__and__parent_8cpp.html#a80b637c04b8c449d54efa75ab73b67df">DomainEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::DomainEle DomainEle</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00034">child_and_parent.cpp:34</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa54e3cb5e57c57a8d03d9c4c7a21a80a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">MoFEM::MeshsetsManager::getCubitMeshsetPtr</a></div><div class="ttdeci">MoFEMErrorCode getCubitMeshsetPtr(const int ms_id, const CubitBCType cubit_bc_type, const CubitMeshSets **cubit_meshset_ptr) const</div><div class="ttdoc">get cubit meshset</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00578">MeshsetsManager.cpp:578</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SmartPetscObj_html"><div class="ttname"><a href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj&lt; DM &gt;</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6b1924cc123ac462d3a04b9dd32bccd5"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ae0740fe6fc3c9eb11f71cf6d5ab28a9ea6b1924cc123ac462d3a04b9dd32bccd5">ADOLCPlasticity::ParaboloidalPlasticity::HC</a></div><div class="ttdeci">@ HC</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00564">ADOLCPlasticityMaterialModels.hpp:564</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_abb0809e4aa5ce3c9ed3527589a0e4700"><div class="ttname"><a href="structPlasticProblem.html#abb0809e4aa5ce3c9ed3527589a0e4700">PlasticProblem::runProblem</a></div><div class="ttdeci">MoFEMErrorCode runProblem()</div><div class="ttdoc">[Run problem]</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00158">adolc_plasticity.cpp:158</a></div></div>
<div class="ttc" id="agroup__mofem__field_html_gac40504ee45e0bdaddfdf1f7858b54a4a"><div class="ttname"><a href="group__mofem__field.html#gac40504ee45e0bdaddfdf1f7858b54a4a">MoFEM::CoreInterface::get_field_entities_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode get_field_entities_by_type(const std::string name, EntityType type, Range &amp;ents) const =0</div><div class="ttdoc">get entities in the field by type</div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ad99174e6023f5d36a2d89e9e2d741269"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ad99174e6023f5d36a2d89e9e2d741269">ADOLCPlasticity::ParaboloidalPlasticity::tStress</a></div><div class="ttdeci">FTensor::Tensor2_symmetric&lt; adouble, 3 &gt; tStress</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00545">ADOLCPlasticityMaterialModels.hpp:545</a></div></div>
<div class="ttc" id="anamespaceContactOps_html_afa975b4e7296be3d38990611693a708b"><div class="ttname"><a href="namespaceContactOps.html#afa975b4e7296be3d38990611693a708b">ContactOps::opFactoryCalculateTraction</a></div><div class="ttdeci">MoFEMErrorCode opFactoryCalculateTraction(boost::ptr_deque&lt; ForcesAndSourcesCore::UserDataOperator &gt; &amp;pip, std::string sigma, bool is_axisymmetric=false)</div><div class="ttdef"><b>Definition:</b> <a href="ContactOps_8hpp_source.html#l01364">ContactOps.hpp:1364</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_ac53a07e80ba12460e4bec474c1faaaa4"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#ac53a07e80ba12460e4bec474c1faaaa4">ADOLCPlasticity::ParaboloidalPlasticity::freeHemholtzEnergy</a></div><div class="ttdeci">MoFEMErrorCode freeHemholtzEnergy()</div><div class="ttdoc">[Paraboloidal free energy]</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00653">ADOLCPlasticityMaterialModels.hpp:653</a></div></div>
<div class="ttc" id="aclassOP_html"><div class="ttname"><a href="classOP.html">OP</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a919fac8b7ae9694240f600a56d7c930d"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a919fac8b7ae9694240f600a56d7c930d">ADOLCPlasticity::ParaboloidalPlasticity::lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00550">ADOLCPlasticityMaterialModels.hpp:550</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a></div><div class="ttdeci">@ HDIV</div><div class="ttdoc">field with continuous normal traction</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00087">definitions.h:87</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FieldBlas_html"><div class="ttname"><a href="structMoFEM_1_1FieldBlas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition:</b> <a href="FieldBlas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a1808931312a0a80aad5a5e769aa9e536"><div class="ttname"><a href="namespaceMoFEM.html#a1808931312a0a80aad5a5e769aa9e536">MoFEM::getDMTsCtx</a></div><div class="ttdeci">auto getDMTsCtx(DM dm)</div><div class="ttdoc">Get TS context data structure used by DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8hpp_source.html#l01141">DMMoFEM.hpp:1141</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_a982cf43f120ff8978010e078bd49d9a3"><div class="ttname"><a href="plastic_8cpp.html#a982cf43f120ff8978010e078bd49d9a3">H</a></div><div class="ttdeci">double H</div><div class="ttdoc">Hardening.</div><div class="ttdef"><b>Definition:</b> <a href="plastic_8cpp_source.html#l00124">plastic.cpp:124</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpLoopSide_html"><div class="ttname"><a href="structMoFEM_1_1OpLoopSide.html">MoFEM::OpLoopSide</a></div><div class="ttdoc">Element used to execute operators on side of the element.</div><div class="ttdef"><b>Definition:</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l01290">ForcesAndSourcesCore.hpp:1290</a></div></div>
<div class="ttc" id="aclassOpCalculateVectorFieldGradient_html"><div class="ttname"><a href="classOpCalculateVectorFieldGradient.html">OpCalculateVectorFieldGradient</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="astructPlasticProblem_html_a78978ede1604c474e9e355653b9b0dbc"><div class="ttname"><a href="structPlasticProblem.html#a78978ede1604c474e9e355653b9b0dbc">PlasticProblem::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition:</b> <a href="adolc__plasticity_8cpp_source.html#l00134">adolc_plasticity.cpp:134</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a0cf798297f89cab062647ff3ac11632d"><div class="ttname"><a href="fem__tools_8h.html#a0cf798297f89cab062647ff3ac11632d">MU</a></div><div class="ttdeci">#define MU(E, NU)</div><div class="ttdef"><b>Definition:</b> <a href="fem__tools_8h_source.html#l00023">fem_tools.h:23</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00698">PostProcBrokenMeshInMoabBase.hpp:698</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespaceMoFEM.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_af77311a7eb91829fc0f10e00545888c3"><div class="ttname"><a href="namespaceMoFEM.html#af77311a7eb91829fc0f10e00545888c3">MoFEM::TSAdaptCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode TSAdaptCreateMoFEM(TSAdapt adapt)</div><div class="ttdoc">Craete MOFEM adapt.</div><div class="ttdef"><b>Definition:</b> <a href="TsCtx_8cpp_source.html#l00797">TsCtx.cpp:797</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpDGProjectionMassMatrix_html"><div class="ttname"><a href="structMoFEM_1_1OpDGProjectionMassMatrix.html">MoFEM::OpDGProjectionMassMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="DGProjection_8hpp_source.html#l00106">DGProjection.hpp:106</a></div></div>
<div class="ttc" id="astructADOLCPlasticity_1_1ParaboloidalPlasticity_html_a23d722a00db561b3d35804b49cfe6c9d"><div class="ttname"><a href="structADOLCPlasticity_1_1ParaboloidalPlasticity.html#a23d722a00db561b3d35804b49cfe6c9d">ADOLCPlasticity::ParaboloidalPlasticity::J2</a></div><div class="ttdeci">adouble J2</div><div class="ttdef"><b>Definition:</b> <a href="ADOLCPlasticityMaterialModels_8hpp_source.html#l00678">ADOLCPlasticityMaterialModels.hpp:678</a></div></div>
<div class="ttc" id="anamespacePlasticOps_html_a55995edc157f3bd05b55b6e86bf02b0f"><div class="ttname"><a href="namespacePlasticOps.html#a55995edc157f3bd05b55b6e86bf02b0f">PlasticOps::addMatBlockOps</a></div><div class="ttdeci">MoFEMErrorCode addMatBlockOps(MoFEM::Interface &amp;m_field, std::string block_name, Pip &amp;pip, boost::shared_ptr&lt; MatrixDouble &gt; mat_D_Ptr, boost::shared_ptr&lt; CommonData::BlockParams &gt; mat_params_ptr, double scale_value, Sev sev)</div><div class="ttdef"><b>Definition:</b> <a href="PlasticOps_8hpp_source.html#l00248">PlasticOps.hpp:248</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>