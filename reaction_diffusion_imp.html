<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.8.17"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: COR-9: Reaction-diffusion equation</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    extensions: ["tex2jax.js"],
    jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.8.17 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">COR-9: Reaction-diffusion equation </div>  </div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#reaction_diffusion_equation">Fisher&#39;s reaction-diffusion equation</a></li>
<li class="level1"><a href="#reaction_diffusion_running_code">Running code</a></li>
<li class="level1"><a href="#reaction_diffusion_discretisation">Discretisation</a><ul><li class="level2"><a href="#reaction_diffusion_weak_form">Semi-discrete form of the equation</a></li>
<li class="level2"><a href="#reaction_diffusion_time">Time discretisation</a></li>
</ul>
</li>
<li class="level1"><a href="#reaction_diffusion_implementation">Implementation</a><ul><li class="level2"><a href="#reaction_diffusion_mesh">Setup problem</a></li>
<li class="level2"><a href="#reaction_diffusion_telling_ts">Telling TS which elements should be used</a></li>
<li class="level2"><a href="#reaction_diffusion_telling_fe">Telling finite elements which operators should be used</a></li>
<li class="level2"><a href="#reaction_diffusion_common_data">Common data</a></li>
<li class="level2"><a href="#reaction_diffusion_pushing_fe">Pushing operators to finite element</a></li>
<li class="level2"><a href="#reaction_diffusion_g">Problem with IMAX method in TS</a></li>
</ul>
</li>
<li class="level1"><a href="#reaction_diffusion_initial">Initial and boundary conditions</a><ul><li class="level2"><a href="#reaction_diffusion_init">Initial conditions</a></li>
<li class="level2"><a href="#reaction_diffusion_bc">Dirichlet boundary conditions</a></li>
</ul>
</li>
<li class="level1"><a href="#reaction_diffusion_code">The plain program.</a></li>
</ul>
</div>
<div class="textblock"><h1><a class="anchor" id="reaction_diffusion_equation"></a>
Fisher's reaction-diffusion equation</h1>
<p>Fisher's equation <a class="el" href="citelist.html#CITEREF_fisher1937wave">[26]</a> describes the population dynamics, transformation of species into "mutant" species in space and time. Its predictive capabilities include modelling of fire propagation, virile mutant propagation, evolution of a neutron population in a nuclear reactor, spreading of Alzheimer's disease in human brain, and many more phenomena.</p>
<p>In this tutorial, we consider the equation in its original form presented by Fisher in 1937 <a class="el" href="citelist.html#CITEREF_fisher1937wave">[26]</a></p>
<p class="formulaDsp">
\[ \frac{\partial u}{\partial t} - D \nabla^2 u = ru\left(1-\frac{u}{k}\right) \]
</p>
<p>where \(D\) is diffusivity, \(r\) is rate factor and \(k\) is carrying capacity. This equation can be interpreted that advancing wave with a speed no greater than \(\sqrt{Dr}\) will transform abandoned species into another "mutant" form, switching state variable \(u\) from the equilibrium state of \(u=0\) to another equilibrium state of \(u=k\).</p>
<p>To understand the equation better, we can focus our attention on the spreading of fire on a plane of dry grass which is isolated from the rest of the domain by a closed trench of water. Fire will spread over the whole area, whereby all grass over time will be consumed by fire and transformed into ash, i.e. mutant, where virgin (unburned) grass is indicated by \(u=0\), and grass consumed by fire, i.e. ash is \(u=k\). The front of the fire will move with the velocity not greater than \(\sqrt{Dr}\). In the case with the grass is mixed with a plant having some resistance to fire, that would be controlled by parameter \(k\), i.e. carrying capacity. Also, if there is no wind or no surface inclination, the diffusivity parameter \(D\) is scalar. On the contrary, if the ground has some inclination or wind is present, the fire will have a tendency to go up the hill or follow the direction of the wind, that would be accounted for by tensorial representation of diffusivity. If the grass is of uniform height, \(D\) is equal everywhere, i.e. homogenous. If, for example, the height of the grass varies from one place to another, diffusivity and rate factor is heterogeneous, i.e. \(D=D(\mathbf{x})\) and \(r=r(\mathbf{x})\).</p>
<p>In this example, to keep the problem as simple as possible, we implement a homogenous case, with isotropic diffusivity. Moreover, we assume that fire is initiated at two places, as shown in <a class="el" href="reaction_diffusion_imp.html#Figure1">Figure 1</a> below.</p>
<p><a class="anchor" id="Figure1"></a></p><div class="image">
<img src="reaction_diffusion_bc.png" alt="" width="500p"/>
<div class="caption">
Figure 1: Two yellow spots are placed where the fire is initiated. On boundary, Dirichlet boundary condition u = 0 is applied.</div></div>
<dl class="section note"><dt>Note</dt><dd>The estimated speed of the advancing wave can be used further to choose the duration of analysis and length of the time step.</dd></dl>
<h1><a class="anchor" id="reaction_diffusion_running_code"></a>
Running code</h1>
<p>The code can run in parallel, so before starting the analysis, we have to do mesh partitioning, such that, from very beginning, each processor stores in the memory only one part of the mesh. In order to partition mesh, execute the script in build directory in directory <em>basic_finite_elements/reaction_diffusion_equation</em> </p><div class="fragment"><div class="line">NBPROC=6 &amp;&amp; ../../tools/mofem_part \</div>
<div class="line">-my_file mesh.cub -output_file mesh.h5m -my_nparts $NBPROC -dim 2 -adj_dim 1</div>
</div><!-- fragment --><p> where variable <em>NBPROC</em> represents the number of processors. The mesh file <em>mesh.cub</em> is the initial mesh which can be generated by a preprocessor, for example Cubit in this case. The partitioned mesh is saved to file <em>mesh.h5m</em>. Having that mesh at hand, we can solve the problem by running the command line below</p>
<div class="fragment"><div class="line">time mpirun -np $NBPROC ./reaction_diffusion_equation 2&gt;&amp;1 | tee log</div>
</div><!-- fragment --><p>with the necessary parameters to run calculations found in the file <em>param_file.petsc</em> which is stored in the working directory</p>
<div class="fragment"></div><!-- fragment --><p>The key parameters are</p><ul>
<li><em>-ts_max_time:</em> time duration</li>
<li><em>-ts_dt:</em> time step size</li>
<li><em>-ts_arkimex_type:</em> ARKIMEX time integration type</li>
<li><em>-ts_adapt_type:</em> time step adaptation (if the stiff part is not updated, it has to be set to <em>node</em>)</li>
<li><em>-snes_lag_jacobian:</em> determines how often jacobian (stiff part) is updated. If set to -2 jacobian is calculated only once at the beginning of the analysis</li>
</ul>
<p><a class="anchor" id="Figure2"></a></p><div class="image">
<img src="reaction_diffusion.gif" alt="" width="800p"/>
<div class="caption">
Figure 2: Solution of the problem.</div></div>
<h1><a class="anchor" id="reaction_diffusion_discretisation"></a>
Discretisation</h1>
<h2><a class="anchor" id="reaction_diffusion_weak_form"></a>
Semi-discrete form of the equation</h2>
<p>To solve the equation, we apply standard Galerkin method, used in finite element approximation, i.e. multiplying both sides by a test function and integrating by parts to reduce the demand for the regularity of the tested and testing functions, we get </p><p class="formulaDsp">
\[ \int_\Omega v \frac{\partial u}{\partial t} \textrm{d}\Omega + \int_\Omega \nabla v \cdot D \nabla u \textrm{d}\Omega = \int_\Omega v r u \left(1-\frac{u}{k}\right) \textrm{d}\Omega \]
</p>
<p> where \(\Omega\) is the solution Domain. To have a unique solution, we have to a priori enforce essential boundary conditions, such that the test functions \(v\) and tested function \(u\) disappear on the boundary \(\partial\Omega\). Also, the approximation and tested functions are in Hilbert space \(H^1_0(\Omega)\), such that the integral of the first derivative and function value over the domain is bounded. That will make the solution for our weak equation stable and equal to the solution of the strong equation, if smooth enough initial and boundary conditions are provided. Moreover, the solution to the problem can be approximated by a finite-dimensional and complete set of the piecewise mesh conforming polynomials, which are dense in \(H^1(\Omega)\), thus we will have convergence of the approximate solution to the exact solution with mesh refinement or increasing polynomial approximation order. The approximation of test and tested functions is given as follows</p>
<p class="formulaDsp">
\[ v^h = \pmb\Phi \overline{\mathbf{v}}^\textrm{T} \quad\textrm{and}\quad u^h = \pmb\Phi \overline{\mathbf{u}}^\textrm{T} \]
</p>
<p>where \(\pmb\Phi\) is the vector of hierarchical base functions, and \(\overline{\mathbf{v}}\), \(\overline{\mathbf{u}}\) are vectors of coefficients at degrees of freedom. Utilising finite element approximation functions we finally get semi-discrete form of the Fisher's equation</p>
<p class="formulaDsp">
\[ \mathbf{M} \frac{\partial \overline{\mathbf{u}}}{\partial t} + \mathbf{K} \overline{\mathbf{u}} = \mathbf{G} \]
</p>
<p>where</p>
<p class="formulaDsp">
\[ \mathbf{M} := \int_\Omega \pmb\Phi^\textrm{T} \pmb\Phi\, \textrm{d}\Omega,\quad \mathbf{K} := \int_\Omega \nabla \pmb\Phi^\textrm{T} \nabla \pmb\Phi \, \textrm{d}\Omega\quad\textrm{and}\quad \mathbf{G} := \int_\Omega \pmb\Phi^\textrm{T} \left\{ r u^h \left(1-\frac{u^h}{k}\right) \right\} \, \textrm{d}\Omega \]
</p>
<p>where \(\mathbf{M}\) is so called mass matrix, \(\mathbf{K}\) stiffness matrix and \(\mathbf{G}\) is source vector.</p>
<h2><a class="anchor" id="reaction_diffusion_time"></a>
Time discretisation</h2>
<p>In this section, we fully rely on time stepping algorithms briefly described in <a href="https://www.mcs.anl.gov/petsc/petsc-current/docs/manual.pdf">PETSc documentation</a> in section 6. Moreover, we focus attention on IMEX method, i.e. implicit-explicit time integration. The IMEX method is particularly useful whereby two time scales are separated and present in the solution, i.e. one fast scale, associated with <em>stiff</em> part of a differential equation, and <em>slow</em> scale usually associated with the strongly nonlinear part of the equation. In our particular case, <em>stiff</em> part of the equation is assisted with the diffusion process, and slow is associated with the reaction part of the equation. Focusing attention on our example of fire propagation, in the plane of dry grass, <em>stiff</em> part controls the speed of advancing fire, and <em>slow</em> part is related to the length of the burning process itself, which takes a bit longer time. Using formalism presented in PETSc documentation, we have</p>
<p class="formulaDsp">
\[ \mathbf{F} \left( t,\overline{\mathbf{u}^n}, \dot{\overline{\mathbf{u}^n}} \right) = \mathbf{G} \left( t,\overline{\mathbf{u}^n} \right) \]
</p>
<p> where </p><p class="formulaDsp">
\[ \left. \frac{\textrm{d}\mathbf{F}}{\textrm{d}\overline{\mathbf{u}}} \right|_{\overline{\mathbf{u}^n}} = \sigma \mathbf{F}_{\dot{\overline{\mathbf{u}^n}}} \left( t,\overline{\mathbf{u}^n}, \dot{\overline{\mathbf{u}^n}} \right) + \mathbf{F}_{\overline{\mathbf{u}^n}} \left( t,\overline{\mathbf{u}^n}, \dot{\overline{\mathbf{u}^n}} \right) = \sigma \mathbf{M} + \mathbf{K} \]
</p>
<p> where </p><p class="formulaDsp">
\[ \sigma = \left. \frac{\partial \dot{u}}{\partial u} \right|_{u^n} \]
</p>
<p> is the parameter provided by the algorithm of time integration, implemented in PETSc. The key advantage of the presented algorithm is that implementation of the equation is independent on time integration algorithm, and user can freely and quickly change time integration method without need of changing a line of the code. The change of time integration scheme is accounted by \(\sigma\).</p>
<h1><a class="anchor" id="reaction_diffusion_implementation"></a>
Implementation</h1>
<p>Total control of the solution process including calling functions to calculate matrices and vectors in the right order is handled by PETSc time solver (TS). TS calls <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> methods iterating over finite element entities, which are provided by Discrete Manager (DM). <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is responsible for managing degrees of freedom, finite elements, and iterating over entities on the mesh. MOAB is the mesh database where all data is stored on mesh tags at any point of the analysis.</p>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and MOAB databases provide low-level functions, however in this case flexibility of <a class="el" href="structMoFEM_1_1Simple.html">MoFEM::Simple</a> interface is adequate. <a class="el" href="structMoFEM_1_1Simple.html">MoFEM::Simple</a> interface creates approximation fields and finite elements on the whole mesh, and it creates problem data structures accessed by DM. DM is a bridge between PETSc and <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> data structures and functions, in this particular case TS.</p>
<p>The programmer responsibility is to initialise data structures, methods and provide users operators, called by finite elements, to evaluate matrices and vectors when called by time solver (TS). The relation between TS functions, DM in <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and finite elements are shown in <a class="el" href="reaction_diffusion_imp.html#Figure3">Figure 3</a>.</p>
<p><a class="anchor" id="Figure3"></a></p><div class="image">
<img src="reaction_diffusion_operators.png" alt="" width="800p"/>
<div class="caption">
Figure 3: Finite elements and operators. Yellow colour indicates functions related to TS. Red colour indicates functions managed by DM. Blue colour indicates finite element instances. Green colour indicates user data operators, where dark green represents standard user data operators, and light green represents user data operators implemented for this tutorial</div></div>
<p> Implementation of the problem is for PDE in 2D, however, with minimal effort changing the type of element, it can be extended to 3D. Moreover is independent on time integration method, exploiting how PETSc time solver is implemented. width=800p</p>
<h2><a class="anchor" id="reaction_diffusion_mesh"></a>
Setup problem</h2>
<p><a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> always has to start with initialisation and the main function has the followwing format </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> <a class="code" href="activate__deactivate__dofs_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line">  <span class="comment">// initialize petsc</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> param_file[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file, <a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Implementation</span></div>
<div class="line"> </div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line">  <span class="comment">// finish work cleaning memory, getting statistics, etc.</span></div>
<div class="line">  <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --><p> It is worth noting that almost all <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>, PETSc and MOAB functions should be checked by CHKERR which is essential for safe code development and error detection.</p>
<p>In this tutorial, the initialisation of the database contains following steps</p>
<ol type="1">
<li>Main code starts with creating MOAB database and <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database instances and intefaces to each of them <div class="fragment"><div class="line"><a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> mb_instance;</div>
<div class="line"><a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = mb_instance;</div>
<div class="line"><a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line"><a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
</div><!-- fragment --></li>
<li>Registration of <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> Discrete Manager in PETSc <div class="fragment"><div class="line">DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);</div>
</div><!-- fragment --></li>
<li>Loading mesh, adding fields and setting-up DM manager <div class="fragment"><div class="line"><span class="comment">// Simple interface</span></div>
<div class="line">Simple *simple_interface;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(simple_interface);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;getOptions();</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;loadFile();</div>
<div class="line"><span class="comment">// add fields</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;addDomainField(<span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,</div>
<div class="line">                                        1);</div>
<div class="line"><span class="comment">// set fields order</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setFieldOrder(<span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line"><span class="comment">// setup problem</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;setUp();</div>
</div><!-- fragment --> Note that here we add only one field <em>u</em>, in \(H^1(\Omega)\) space, approximation base is constructed following AINSWORTH_LEGENDRE_BASE recipe, and field is scalar, i.e. number of coefficients for base function is 1. Simple interface presumes that the field is spanned over the whole domain, and integration in domain will be performed over the highest dimension entities on the mesh, in this particular example, all triangles. The finite element name is accessed through <div class="fragment"><div class="line">std::string fe_name = simple_interface-&gt;getDomainFEName();</div>
</div><!-- fragment --> On that element, finite element instances will be executed, described below, and on each element, the user pushes a set of operators to execute. On the other hand, finite element instances will be called through DM manager by TS solver.</li>
<li>Getting access to the database from this point can be done exclusively through DM <div class="fragment"><div class="line"><a class="code" href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj&lt;DM&gt;</a> dm = simple_interface-&gt;getDM();</div>
</div><!-- fragment --> Note that <a class="el" href="structMoFEM_1_1SmartPetscObj.html" title="intrusive_ptr for managing petsc objects">MoFEM::SmartPetscObj</a> wraps PETSc object so that they can be used as a regular PETSc object but the user is relieved from the need of calling the destructor for it. Having access to DM, one can push finite element instances which can be used by TS to calculate matrices and vectors at subsequent time steps.</li>
</ol>
<h2><a class="anchor" id="reaction_diffusion_telling_ts"></a>
Telling TS which elements should be used</h2>
<p>In <a class="el" href="reaction_diffusion_imp.html#Figure3">Figure 3</a>, yellows are PETSc functions and those on red background are part of DM, interfacing TS with <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. In this tutorial TS is set to use IMEX (implicit/explicit) method, <a href="https://www.mcs.anl.gov/petsc/petsc-current/docs/manual.pdf">see details</a> in section 6. Methods calculating vector and matrices needed by TS solver to proceed set by DM functions, are as follows</p>
<ol type="1">
<li><a class="el" href="namespaceMoFEM.html#a22cbb40b656b2ce3ea9c58841d9e3463">MoFEM::DMMoFEMTSSetRHSFunction</a> to calculate \(\mathbf{G}\)</li>
<li><a class="el" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">MoFEM::DMMoFEMTSSetIFunction</a> to calculate \(\mathbf{F}\)</li>
<li><a class="el" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">MoFEM::DMMoFEMTSSetIJacobian</a> to calculate \(\left. \frac{\textrm{d}\mathbf{F}}{\textrm{d}\overline{\mathbf{u}}} \right|_{\overline{\mathbf{u}^n}}\)</li>
<li><a class="el" href="namespaceMoFEM.html#a112dfab22d28426fcd0ab2d61cf8f494">MoFEM::DMMoFEMTSSetMonitor</a> to set monitor run at the end of each load step</li>
</ol>
<p>Those functions provide sequences of finite elements (or just one element for each term in this particular case) to calculate entries of vectors and matrices at specific time steps.</p>
<p>Blue boxes mark finite elements in <a class="el" href="reaction_diffusion_imp.html#Figure3">Figure 3</a> are created by the following code</p>
<div class="fragment"><div class="line"><span class="comment">// Create finite element instances to integrate the right-hand side of slow</span></div>
<div class="line"><span class="comment">// and stiff vector, and the tangent left-hand side for stiff part.</span></div>
<div class="line">boost::shared_ptr&lt;Ele&gt; vol_ele_slow_rhs(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line">boost::shared_ptr&lt;Ele&gt; vol_ele_stiff_rhs(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line">boost::shared_ptr&lt;Ele&gt; vol_ele_stiff_lhs(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
</div><!-- fragment --><p>where integration rule, controlling number of integration points on each element are set by </p><div class="fragment"><div class="line"><span class="keyword">auto</span> vol_rule = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * p; };</div>
<div class="line">vol_ele_slow_rhs-&gt;getRuleHook = vol_rule;</div>
<div class="line">vol_ele_stiff_rhs-&gt;getRuleHook = vol_rule;</div>
<div class="line">vol_ele_stiff_lhs-&gt;getRuleHook = vol_rule;</div>
</div><!-- fragment --><p> The integration rule depends on the type of operator evaluated on the element, in our case, we evaluate mass matrices, thus we need to calculate integrals exactly with polynomial order \(2p\).</p>
<p>Note that finite element instances implementation is generic. Elements do problem specific calculations by providing to them user data operators which will be described in the following sections. Three elements <em>vol_ele_slow_rhs</em>, <em>vol_ele_stiff_rhs</em> and <em>vol_ele_stiff_lhs</em> are provided to Discrete Manager (DM) to calculate slow and stiff vectors and Jacobian matrix. Those three elements are instances of the class <a class="el" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html" title="Face finite element.">MoFEM::FaceElementForcesAndSourcesCore</a>. Once elements are created, we can add them to the TS manager through the DM interface</p>
<div class="fragment"><div class="line"><span class="comment">// Add element to calculate lhs of stiff part</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm, simple_interface-&gt;getDomainFEName(),</div>
<div class="line">vol_ele_stiff_lhs, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
<div class="line"><span class="comment">// Add element to calculate rhs of stiff part</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, simple_interface-&gt;getDomainFEName(),</div>
<div class="line">vol_ele_stiff_rhs, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
<div class="line"><span class="comment">// Add element to calculate rhs of slow (nonlinear) part</span></div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a22cbb40b656b2ce3ea9c58841d9e3463">DMMoFEMTSSetRHSFunction</a>(dm, simple_interface-&gt;getDomainFEName(),</div>
<div class="line">vol_ele_slow_rhs, <span class="keyword">null</span>, <span class="keyword">null</span>); </div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>In case of 3D problem, user has to switch to <a class="el" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html" title="Volume finite element base.">MoFEM::VolumeElementForcesAndSourcesCore</a> to integrate over volume entities. Note that all users operators implemented in the example are templates, where the template variable is the dimension of the element. That makes implementation dimension independent.</dd></dl>
<h2><a class="anchor" id="reaction_diffusion_telling_fe"></a>
Telling finite elements which operators should be used</h2>
<p>The problem specific matrices and vectors are implemented in namespace <a class="el" href="namespaceReactionDiffusionEquation.html">ReactionDiffusionEquation</a>, by users data operators <a class="el" href="namespaceReactionDiffusionEquation.html#a0aa689de68c1cabf5793ae9a5e8b4a79">ReactionDiffusionEquation::OpEle</a>. In this tutorial, following operators are implemented</p>
<ol type="1">
<li><a class="el" href="structReactionDiffusionEquation_1_1OpAssembleMass.html" title="Assemble mass matrix.">ReactionDiffusionEquation::OpAssembleMass</a> used to calculate mass matrix \(\mathbf{M}\)</li>
<li><a class="el" href="structReactionDiffusionEquation_1_1OpAssembleSlowRhs.html" title="Assemble slow part.">ReactionDiffusionEquation::OpAssembleSlowRhs</a> used to calculate the <em>slow</em> right-hand side vector \(\mathbf{G}\)</li>
<li><a class="el" href="structReactionDiffusionEquation_1_1OpAssembleStiffRhs.html" title="Assemble stiff part.">ReactionDiffusionEquation::OpAssembleStiffRhs</a> used to calculate the <em>stiff</em> vector \(\mathbf{F}\)</li>
<li><a class="el" href="structReactionDiffusionEquation_1_1OpAssembleStiffLhs.html" title="Assemble stiff part tangent.">ReactionDiffusionEquation::OpAssembleStiffLhs</a> used to calculate the <em>stiff</em> matrix \(\frac{\textrm{d}\mathbf{F}}{\textrm{d} \overline{\mathbf{u}^n}}\)</li>
<li><a class="el" href="structReactionDiffusionEquation_1_1Monitor.html" title="Monitor solution.">ReactionDiffusionEquation::Monitor</a> used to post-process results at the end of each time step</li>
</ol>
<p>Implementation of each operator follows a similar pattern,</p>
<ol type="1">
<li>The class is inherited from <a class="el" href="namespaceReactionDiffusionEquation.html#a0aa689de68c1cabf5793ae9a5e8b4a79">ReactionDiffusionEquation::OpEle</a></li>
<li>Two types of operators are implemented <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1" title="operator doWork function is executed on FE rows">ReactionDiffusionEquation::OpEle::OPROW</a> to calculate vectors, and <a class="el" href="structMoFEM_1_1ForcesAndSourcesCore_1_1UserDataOperator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a" title="operator doWork is executed on FE rows &amp;columns">ReactionDiffusionEquation::OpEle::OPROWCOL</a> to calculate matrices.</li>
<li>Implementation of user operator overload <em>doWork</em> member function</li>
<li>In each <em>doWork</em> method, user iterates over integration points, and then over base functions. In case of a matrix, over base functions on rows and columns.</li>
<li>Once local element vector is assembled, <em>doWork</em> function is finalised with assembling to global vector or global matrix.</li>
</ol>
<dl class="section note"><dt>Note</dt><dd>More detail description on how to implement user data operator can be found in other tutorials, for example, <a class="el" href="poisson_tut2.html">COR-3: Implementing operators for the Poisson equation</a>.</dd></dl>
<h2><a class="anchor" id="reaction_diffusion_common_data"></a>
Common data</h2>
<p>The data between the operator and finite elements are passed through <a class="el" href="structReactionDiffusionEquation_1_1CommonData.html" title="Common data.">ReactionDiffusionEquation::CommonData</a> </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code" href="structCommonData.html">CommonData</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> grad;    <span class="comment">///&lt; Gradients of field &quot;u&quot; at integration points</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> val;     <span class="comment">///&lt; Values of field &quot;u&quot; at integration points</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> dot_val; <span class="comment">///&lt; Rate of values of field &quot;u&quot; at integration points</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  SmartPetscObj&lt;Mat&gt; <a class="code" href="structCommonData.html#a6a123f52adcbb6b7722579eab15d08f5">M</a>;   <span class="comment">///&lt; Mass matrix</span></div>
<div class="line"><span class="comment"></span>  SmartPetscObj&lt;KSP&gt; <a class="code" href="structCommonData.html#ae883bdc65f92362725d3e730302f3671">ksp</a>; <span class="comment">///&lt; Linear solver</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">};</div>
</div><!-- fragment --><p> which is dynamically allocated and kept by shared pointer </p><div class="fragment"><div class="line">boost::shared_ptr&lt;CommonData&gt; data(<span class="keyword">new</span> <a class="code" href="structCommonData.html">CommonData</a>());</div>
</div><!-- fragment --><p> in addition some other operators need direct access to data, it can be safely done by so called aliased shared pointers (<a href="https://stackoverflow.com/questions/27109379/what-is-shared-ptrs-aliasing-constructor-for">see here</a>) </p><div class="fragment"><div class="line"><span class="keyword">auto</span> val_ptr = boost::shared_ptr&lt;VectorDouble&gt;(data, &amp;data-&gt;val);</div>
<div class="line"><span class="keyword">auto</span> dot_val_ptr = boost::shared_ptr&lt;VectorDouble&gt;(data, &amp;data-&gt;dot_val);</div>
<div class="line"><span class="keyword">auto</span> grad_ptr = boost::shared_ptr&lt;MatrixDouble&gt;(data, &amp;data-&gt;grad);</div>
</div><!-- fragment --><h2><a class="anchor" id="reaction_diffusion_pushing_fe"></a>
Pushing operators to finite element</h2>
<p>Each of those user data operators are added to finite element, for example to <em>vol_ele_stiff_rhs</em> we add operators as following </p><div class="fragment"><div class="line"><span class="keyword">auto</span> det_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"><span class="keyword">auto</span> jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"><span class="keyword">auto</span> inv_jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpCalculateHOJac&lt;2&gt;(jac_ptr));</div>
<div class="line">vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpInvertMatrix&lt;2&gt;(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1OpSetHOInvJacToScalarBases_3_012_01_4.html">MoFEM::OpSetHOInvJacToScalarBases&lt;2&gt;</a>(<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, inv_jac_ptr));</div>
<div class="line">vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValuesFromPetscVecImpl.html">MoFEM::OpCalculateScalarFieldValuesDot</a>(<span class="stringliteral">&quot;u&quot;</span>, dot_val_ptr));</div>
<div class="line">vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span></div>
<div class="line"><a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">MoFEM::OpCalculateScalarFieldGradient&lt;2&gt;</a>(<span class="stringliteral">&quot;u&quot;</span>, grad_ptr));</div>
<div class="line">vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span></div>
<div class="line"><a class="code" href="structReactionDiffusionEquation_1_1OpAssembleStiffRhs.html">ReactionDiffusionEquation::OpAssembleStiffRhs&lt;2&gt;</a>(data)); </div>
</div><!-- fragment --><p> where MoFEM::OpCalculateJacForFace, and <a class="el" href="structMoFEM_1_1OpSetHOInvJacToScalarBases_3_012_01_4.html">MoFEM::OpSetHOInvJacToScalarBases&lt;2&gt;</a> are standard operators to calculate element inverse of jacobian, and pull derivatives of base functions to element reference configuration </p><p class="formulaDsp">
\[ \frac{\partial \pmb\Phi}{\partial \mathbf{x}} = \frac{\partial \pmb\Phi}{\partial \pmb\xi}\mathbf{J}^{-\textrm{T}} \quad\textrm{where}\quad \mathbf{J} = \frac{\partial \mathbf{x}}{\partial \pmb\xi},\; \mathbf{x} = \pmb\Phi(\pmb \xi) \overline{\mathbf{x}} \]
</p>
<p> where \(\pmb \xi\) are coordinates in local element configuration, \(\overline{\mathbf{x}}\) are nodal positions or higher order coefficients in edges and faces if necessary to describe higher order geometry. Operators <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> and <a class="el" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html" title="Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.">MoFEM::OpCalculateScalarFieldGradient</a> are standard operators and are used to calculate field values, and gradients of field values at integration points, respectively. All operators in <a class="el" href="reaction_diffusion_imp.html#Figure3">Figure 3</a> marked by dark green color are standard operators and are implemented in basic user modules.</p>
<h2><a class="anchor" id="reaction_diffusion_g"></a>
Problem with IMAX method in TS</h2>
<p>The implementation of IMAX method in TS solver requires the user to provide</p>
<p class="formulaDsp">
\[ \mathbf{g}(t,\overline{\mathbf{u}}) = \mathbf{M}^{-1}\mathbf{G}(t,\overline{\mathbf{u}}) \]
</p>
<p>whereas user data operators provide vector \(\mathbf{G}(t,\overline{\mathbf{u}})\). This issue can be resolved by exploiting finite element functionality. Each finite element class is derived from <a class="el" href="structMoFEM_1_1BasicMethod.html" title="Data structure to exchange data between mofem and User Loop Methods.">MoFEM::BasicMethod</a></p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>BasicMethod : <span class="keyword">public</span> KspMethod, SnesMethod, TSMethod {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> preProcess() {</div>
<div class="line">    <span class="keywordflow">if</span>(preProcessHook)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> preProcessHook()</div>
<div class="line">  }</div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> operator()();</div>
<div class="line">  <span class="keyword">virtual</span> <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> postProcess() {</div>
<div class="line">    <span class="keywordflow">if</span>(preProcessHook)</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProcessHook()</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">};</div>
</div><!-- fragment --><p>Every element is run in three stages</p>
<ol type="1">
<li><em>preProcess()</em> is executed before the code iterates over all given entity finite elements on the mesh</li>
<li><em>operator()</em> is executed for each entity of finite element on the mesh</li>
<li><em>postProcess()</em> is executed after the code iterates over all given entity finite elements on the mesh</li>
</ol>
<p>If user provides hook to postProcess stage, after vector \(\mathbf{G}(t,\overline{\mathbf{u}})\) is calculated, can solve on place for \(\mathbf{g}(t,\overline{\mathbf{u}})\). This is done by following lambda function</p>
<div class="fragment"><div class="line"><span class="keyword">auto</span> solve_for_g = [&amp;]() {</div>
<div class="line">  <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (*(vol_ele_slow_rhs-&gt;vecAssembleSwitch)) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(vol_ele_slow_rhs-&gt;ts_F, ADD_VALUES, SCATTER_REVERSE); </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(vol_ele_slow_rhs-&gt;ts_F, ADD_VALUES, SCATTER_REVERSE); </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(vol_ele_slow_rhs-&gt;ts_F); </div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(vol_ele_slow_rhs-&gt;ts_F); </div>
<div class="line">    *vol_ele_slow_rhs-&gt;vecAssembleSwitch = <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(data-&gt;ksp, vol_ele_slow_rhs-&gt;ts_F, vol_ele_slow_rhs-&gt;ts_F);</div>
<div class="line">  <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
</div><!-- fragment --><p>The lambda function is set as a hook to the <em>slow</em> finite element, i.e. <em>vol_ele_slow_rhs</em> as follows</p><div class="fragment"><div class="line"> vol_ele_slow_rhs-&gt;postProcessHook =</div>
<div class="line">solve_for_g; </div>
</div><!-- fragment --><p>Note, that is also indicated on <a class="el" href="reaction_diffusion_imp.html#Figure3">Figure 3</a>. In <em>solve_for_g</em> the KSP (linear) solver is used to solve linear equation</p>
<p class="formulaDsp">
\[ \mathbf{M}\mathbf{g}(t,\overline{\mathbf{u}}) = \mathbf{G}(t,\overline{\mathbf{u}}) \]
</p>
<p> where mass matrix \(\mathbf{M}\) is calculated as follows</p>
<div class="fragment"><div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(data-&gt;M);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga7ceaaf7c6121bf86a998297a44647afe">DMCreateMatrix_MoFEM</a>(dm, data-&gt;M);</div>
<div class="line">boost::shared_ptr&lt;Ele&gt; vol_mass_ele(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line">vol_mass_ele-&gt;getOpPtrVector().push_back(<span class="keyword">new</span></div>
<div class="line"><a class="code" href="structReactionDiffusionEquation_1_1OpAssembleMass.html">ReactionDiffusionEquation::OpAssembleMass</a>(data)); <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line"><a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, simple_interface-&gt;getDomainFEName(), vol_mass_ele);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(data-&gt;M, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(data-&gt;M, MAT_FINAL_ASSEMBLY);</div>
</div><!-- fragment --><p>with the use on the fly created finite element <em>vol_mass_ele</em> with pushed one operator <a class="el" href="structReactionDiffusionEquation_1_1OpAssembleMass.html" title="Assemble mass matrix.">ReactionDiffusionEquation::OpAssembleMass</a>. The linear KSP solver is created and set up as follows</p>
<div class="fragment"><div class="line">data-&gt;ksp = <a class="code" href="namespaceMoFEM.html#a10bae3a5a92d97274ffdd4b5d3ed5c0e">createKSP</a>(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>());</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(data-&gt;ksp, data-&gt;M, data-&gt;M);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(data-&gt;ksp); <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(data-&gt;ksp);</div>
</div><!-- fragment --><h1><a class="anchor" id="reaction_diffusion_initial"></a>
Initial and boundary conditions</h1>
<h2><a class="anchor" id="reaction_diffusion_init"></a>
Initial conditions</h2>
<p>To set initial conditions, we use <a class="el" href="structMoFEM_1_1MeshsetsManager.html" title="Interface for managing meshsets containing materials and boundary conditions.">MoFEM::MeshsetsManager</a> to get entities on the blockset, which are set by mesh generators, for example, Cubit, Salome or gMEsh. We assume that entities on which we set boundary conditions are set on a subset of entities, which are listed in <em>BLOCKSET</em> 1 in the following code</p>
<div class="fragment"><div class="line"><span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a>&gt;()-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(1, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>)) {</div>
<div class="line">  <a class="code" href="classRange.html">Range</a> inner_surface;</div>
<div class="line">  <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;MeshsetsManager&gt;()-&gt;getEntitiesByDimension(</div>
<div class="line">      1, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 2, inner_surface, <span class="keyword">true</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!inner_surface.empty()) {</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> inner_surface_verts;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(inner_surface, inner_surface_verts, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;FieldBlas&gt;()-&gt;setField(</div>
<div class="line">        <a class="code" href="namespaceReactionDiffusionEquation.html#afb003ba712ed758a736a934ae3c16764">u0</a>, MBVERTEX, inner_surface_verts, <span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --><ol type="1">
<li>We check if BLOCKSET 1 exist. Since the problem is solved in parallel, each the processor keeps only part of the mesh, BLOCKSET 1 exists only on some processors with the right set of the entities</li>
<li>If the blockset exists, we ask <a class="el" href="structMoFEM_1_1MeshsetsManager.html" title="Interface for managing meshsets containing materials and boundary conditions.">MoFEM::MeshsetsManager</a> to give entities dimension 2, i.e. faces, i.e. triangles in the blockset</li>
<li>We get all the vertices on faces, and using <a class="el" href="structMoFEM_1_1FieldBlas.html" title="Basic algebra on fields.">MoFEM::FieldBlas</a> interface we set values to the nodes on vertices. The value which is set is constant \(u_0\).</li>
</ol>
<h2><a class="anchor" id="reaction_diffusion_bc"></a>
Dirichlet boundary conditions</h2>
<p>To keep initial assumption, given in the beginning paragraphs about fire propagation, that around the plain of dry grass we have a closed trench filled with water, we will apply homogenous Dirichlet boundary conditions on the boundary of the domain. To do that we follow the code</p>
<div class="fragment"><div class="line"><a class="code" href="classRange.html">Range</a> <a class="code" href="namespacesurface.html#ac5b6e387c2c24e86299c80489d6838c0">surface</a>;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(0, MBTRI, <a class="code" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>);</div>
<div class="line">Skinner skin(&amp;m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line"><a class="code" href="classRange.html">Range</a> edges;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>, edges);</div>
<div class="line"><a class="code" href="classRange.html">Range</a> edges_part;</div>
<div class="line">ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(edges, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                             PSTATUS_NOT, -1, &amp;edges_part);</div>
<div class="line"><a class="code" href="classRange.html">Range</a> edges_verts;</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edges_part, edges_verts, <span class="keyword">false</span>);</div>
<div class="line"><a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;ProblemsManager&gt;()-&gt;removeDofsOnEntities(</div>
<div class="line">    simple_interface-&gt;getProblemName(), <span class="stringliteral">&quot;u&quot;</span>,</div>
<div class="line">    unite(edges_verts, edges_part));</div>
</div><!-- fragment --><ol type="1">
<li>Take all triangles on the mesh</li>
<li>Using Skinner implemented in MOAB, we take skin from the mesh. Consequently we have all edges bounding part of the mesh.</li>
<li>Since we work on the parallel partitioned mesh, not all edges are on true domain boundary. In order to filter out true boundary we use moab::ParallelComm::filter_pstatus which is provided with MOAB interface. Using moab::ParallelComm::filter_pstatus, we filter out all entities that are not shared with any other processors. Finally, we obtain entities on physical domain boundary.</li>
<li>In order to enforce homogenous essential boundary conditions in the finite element method, the simplest way is to remove degrees of freedom (DOFs) from the problem. That is done by <a class="el" href="structMoFEM_1_1ProblemsManager.html" title="Problem manager is used to build and partition problems.">MoFEM::ProblemsManager</a> interface using <a class="el" href="group__mofem__problems__manager.html#gaf0db6004cade0e29bef97f933834b61e" title="Remove DOFs from problem.">MoFEM::ProblemsManager::removeDofsOnEntities</a> function. <a class="el" href="structMoFEM_1_1ProblemsManager.html" title="Problem manager is used to build and partition problems.">MoFEM::ProblemsManager</a> is a <a class="el" href="namespaceMoFEM.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> interface to manage DOFs and finite elements on the problem.</li>
</ol>
<h1><a class="anchor" id="reaction_diffusion_code"></a>
The plain program.</h1>
<p>The plain program is located in basic_finite_elements/reaction_diffusion_equation/reaction_diffusion.cpp</p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file reaction_diffusion.cpp</span></div>
<div class="line"><span class="comment"> * \example reaction_diffusion.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> **/</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code" href="namespaceReactionDiffusionEquation.html">ReactionDiffusionEquation</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a> = <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a> = <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html#a9c0a9a269e2e1026ee94cedc069fd0cf">FaceElementForcesAndSourcesCore::UserDataOperator</a>;</div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> = <a class="code" href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntitiesFieldData::EntData</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using</span> <a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">PostProcEle</a> = <a class="code" href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">PostProcBrokenMeshInMoab&lt;Ele&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a> = 2e-3; <span class="comment">///&lt; diffusivity</span></div>
<div class="line"><span class="comment"></span><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = 1;    <span class="comment">///&lt; rate factor</span></div>
<div class="line"><span class="comment"></span><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a> = 1;    <span class="comment">///&lt; caring capacity</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceReactionDiffusionEquation.html#afb003ba712ed758a736a934ae3c16764">u0</a> = 0.1; <span class="comment">///&lt; inital vale on blocksets</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a> = 1;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Common data</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Common data are used to keep and pass data between elements</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structCommonData.html">CommonData</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> grad;    <span class="comment">///&lt; Gradients of field &quot;u&quot; at integration points</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> val;     <span class="comment">///&lt; Values of field &quot;u&quot; at integration points</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> dot_val; <span class="comment">///&lt; Rate of values of field &quot;u&quot; at integration points</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Mat&gt;</a> <a class="code" href="namespacePlasticOps.html#a4578443e6584bb3768a745dea5dc92aa">M</a>;   <span class="comment">///&lt; Mass matrix</span></div>
<div class="line"><span class="comment"></span>  <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;KSP&gt;</a> ksp; <span class="comment">///&lt; Linear solver</span></div>
<div class="line"><span class="comment"></span>};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Assemble mass matrix</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>OpAssembleMass : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a> {</div>
<div class="line">  OpAssembleMass(boost::shared_ptr&lt;CommonData&gt; &amp;data)</div>
<div class="line">      : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>(<span class="stringliteral">&quot;u&quot;</span>, <span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>::OPROWCOL), commonData(data) {</div>
<div class="line">    sYmm = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                        EntityType col_type, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_row_dofs = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col_dofs = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (nb_row_dofs &amp;&amp; nb_col_dofs) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">      mat.resize(nb_row_dofs, nb_col_dofs, <span class="keyword">false</span>);</div>
<div class="line">      mat.clear();</div>
<div class="line">      <span class="keyword">auto</span> t_row_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">      <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getMeasure();</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * vol;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_row_dofs; ++rr) {</div>
<div class="line">          <span class="keyword">auto</span> t_col_base = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nb_col_dofs; ++cc) {</div>
<div class="line">            mat(rr, cc) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * t_row_base * t_col_base;</div>
<div class="line">            ++t_col_base;</div>
<div class="line">          }</div>
<div class="line">          ++t_row_base;</div>
<div class="line">        }</div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(commonData-&gt;M, row_data, col_data, &amp;mat(0, 0),</div>
<div class="line">                          ADD_VALUES);</div>
<div class="line">      <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">        transMat.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(transMat) = trans(mat);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(commonData-&gt;M, col_data, row_data, &amp;transMat(0, 0),</div>
<div class="line">                            ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> mat, transMat;</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonData;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Assemble slow part</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Solve problem \f$ F(t,u,\dot{u}) = G(t,u) \f$ where here the right hand side</span></div>
<div class="line"><span class="comment"> * \f$ G(t,u) \f$ is implemented.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>OpAssembleSlowRhs : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a> {</div>
<div class="line">  OpAssembleSlowRhs(boost::shared_ptr&lt;CommonData&gt; &amp;data)</div>
<div class="line">      : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>(<span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>::OPROW), commonData(data) {}</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (nb_dofs) {</div>
<div class="line">      vecF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">      vecF.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">      <span class="keyword">auto</span> t_val = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData-&gt;val);</div>
<div class="line">      <span class="keyword">auto</span> t_base = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">      <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getMeasure();</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = vol * t_w;</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> = <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> * t_val * (1 - t_val / <a class="code" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; ++rr) {</div>
<div class="line">          <span class="keyword">const</span> <span class="keywordtype">double</span> b = <a class="code" href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> * t_base;</div>
<div class="line">          vecF[rr] += b;</div>
<div class="line">          ++t_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        ++t_val;</div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetOption(getFEMethod()-&gt;ts_F, VEC_IGNORE_NEGATIVE_INDICES,</div>
<div class="line">                          PETSC_TRUE);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(getFEMethod()-&gt;ts_F, data, &amp;*vecF.begin(),</div>
<div class="line">                          ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonData;</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> vecF;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Assemble stiff part</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Solve problem \f$ F(t,u,\dot{u}) = G(t,u) \f$ where here the right hand side</span></div>
<div class="line"><span class="comment"> * \f$ F(t,u,\dot{u}) \f$ is implemented.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt; <span class="keyword">struct </span>OpAssembleStiffRhs : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a> {</div>
<div class="line">  OpAssembleStiffRhs(boost::shared_ptr&lt;CommonData&gt; &amp;data)</div>
<div class="line">      : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>(<span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>::OPROW), commonData(data) {}</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType <a class="code" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (nb_dofs) {</div>
<div class="line">      vecF.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">      vecF.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">      <span class="keyword">auto</span> t_dot_val = <a class="code" href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">getFTensor0FromVec</a>(commonData-&gt;dot_val);</div>
<div class="line">      <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;DIM&gt;(commonData-&gt;grad);</div>
<div class="line">      <span class="keyword">auto</span> t_base = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">      <span class="keyword">auto</span> t_diff_base = data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;DIM&gt;();</div>
<div class="line">      <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">      <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getMeasure();</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = vol * t_w;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; ++rr) {</div>
<div class="line">          vecF[rr] += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (t_base * t_dot_val + <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a> * t_diff_base(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_grad(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">          ++t_diff_base;</div>
<div class="line">          ++t_base;</div>
<div class="line">        }</div>
<div class="line">        ++t_dot_val;</div>
<div class="line">        ++t_grad;</div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetOption(getFEMethod()-&gt;ts_F, VEC_IGNORE_NEGATIVE_INDICES,</div>
<div class="line">                          PETSC_TRUE);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(getFEMethod()-&gt;ts_F, data, &amp;*vecF.begin(),</div>
<div class="line">                          ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonData;</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> vecF;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Assemble stiff part tangent</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Solve problem \f$ F(t,u,\dot{u}) = G(t,u) \f$ where here the right hand side</span></div>
<div class="line"><span class="comment"> * \f$ \frac{\textrm{d} F}{\textrm{d} u^n} = a F_{\dot{u}}(t,u,\textrm{u}) +</span></div>
<div class="line"><span class="comment"> * F_{u}(t,u,\textrm{u}) \f$ is implemented.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt; <span class="keyword">struct </span>OpAssembleStiffLhs : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a> {</div>
<div class="line">  OpAssembleStiffLhs(boost::shared_ptr&lt;CommonData&gt; &amp;data)</div>
<div class="line">      : <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>(<span class="stringliteral">&quot;u&quot;</span>, <span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">OpEle</a>::OPROWCOL), commonData(data) {</div>
<div class="line">    sYmm = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                        EntityType col_type, <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_row_dofs = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col_dofs = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">getIndices</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (nb_row_dofs &amp;&amp; nb_col_dofs) {</div>
<div class="line">      mat.resize(nb_row_dofs, nb_col_dofs, <span class="keyword">false</span>);</div>
<div class="line">      mat.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_pts = getGaussPts().size2();</div>
<div class="line">      <span class="keyword">auto</span> t_row_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">      <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;DIM&gt;();</div>
<div class="line">      <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">      <a class="code" href="classFTensor_1_1Index.html">FTensor::Index&lt;'i', DIM&gt;</a> <a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> ts_a = getFEMethod()-&gt;ts_a;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getMeasure();</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_pts; ++gg) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = vol * t_w;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_row_dofs; ++rr) {</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> t_col_base = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">          <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;DIM&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nb_col_dofs; ++cc) {</div>
<div class="line">            mat(rr, cc) += <a class="code" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * (t_row_base * t_col_base * ts_a +</div>
<div class="line">                                <a class="code" href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">D</a> * t_row_diff_base(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_col_diff_base(<a class="code" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">            ++t_col_base;</div>
<div class="line">            ++t_col_diff_base;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          ++t_row_base;</div>
<div class="line">          ++t_row_diff_base;</div>
<div class="line">        }</div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, row_data, col_data, &amp;mat(0, 0),</div>
<div class="line">                          ADD_VALUES);</div>
<div class="line">      <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">        transMat.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(transMat) = trans(mat);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(getFEMethod()-&gt;ts_B, col_data, row_data,</div>
<div class="line">                            &amp;transMat(0, 0), ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;CommonData&gt; commonData;</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> mat, transMat;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Monitor solution</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This functions is called by TS solver at the end of each step. It is used</span></div>
<div class="line"><span class="comment"> * to output results to the hard drive.</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a class="code" href="structPlasticOps_1_1Monitor.html">Monitor</a> : <span class="keyword">public</span> <a class="code" href="structMoFEM_1_1FEMethod.html">FEMethod</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="structPlasticOps_1_1Monitor.html">Monitor</a>(<a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;DM&gt;</a> &amp;dm, boost::shared_ptr&lt;PostProcEle&gt; &amp;post_proc)</div>
<div class="line">      : dM(dm), postProc(post_proc){};</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> preProcess() { <span class="keywordflow">return</span> 0; }</div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> operator()() { <span class="keywordflow">return</span> 0; }</div>
<div class="line"> </div>
<div class="line">  <a class="code" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> postProcess() {</div>
<div class="line">    <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (ts_step % <a class="code" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a> == 0) {</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, <span class="stringliteral">&quot;dFE&quot;</span>, postProc);</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> postProc-&gt;writeFile(</div>
<div class="line">          <span class="stringliteral">&quot;out_level_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(ts_step) + <span class="stringliteral">&quot;.h5m&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;DM&gt;</a> dM;</div>
<div class="line">  boost::shared_ptr&lt;PostProcEle&gt; postProc;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">}; <span class="comment">// namespace ReactionDiffusionEquation</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code" href="namespaceReactionDiffusionEquation.html">ReactionDiffusionEquation</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code" href="activate__deactivate__dofs_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// initialize petsc</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> param_file[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file, <a class="code" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create moab and mofem instances</span></div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">moab::Core</a> mb_instance;</div>
<div class="line">    <a class="code" href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">moab::Interface</a> &amp;moab = mb_instance;</div>
<div class="line">    <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line">    <a class="code" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Register DM Manager</span></div>
<div class="line">    DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Simple interface</span></div>
<div class="line">    <a class="code" href="structMoFEM_1_1Simple.html">Simple</a> *simple_interface;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(simple_interface);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#a8325447a1773550852f04c1b600af703">getOptions</a>();</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#a3d65745e902af842b5c490eedbcd30d1">loadFile</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 4; <span class="comment">///&lt; approximation order</span></div>
<div class="line"><span class="comment"></span>    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// add fields</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#a5b3d613d37bec6e737f2db6dfdce0f7d">addDomainField</a>(<span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,</div>
<div class="line">                                            1);</div>
<div class="line">    <span class="comment">// set fields order</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">setFieldOrder</a>(<span class="stringliteral">&quot;u&quot;</span>, <a class="code" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <span class="comment">// setup problem</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#acf413f83e47d1e092a8d5fdb27996cbf">setUp</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create common data structure</span></div>
<div class="line">    boost::shared_ptr&lt;CommonData&gt; data(<span class="keyword">new</span> <a class="code" href="structCommonData.html">CommonData</a>());<span class="comment"></span></div>
<div class="line"><span class="comment">    /// Alias pointers to data in common data structure</span></div>
<div class="line"><span class="comment"></span>    <span class="keyword">auto</span> val_ptr = boost::shared_ptr&lt;VectorDouble&gt;(data, &amp;data-&gt;val);</div>
<div class="line">    <span class="keyword">auto</span> dot_val_ptr = boost::shared_ptr&lt;VectorDouble&gt;(data, &amp;data-&gt;dot_val);</div>
<div class="line">    <span class="keyword">auto</span> grad_ptr = boost::shared_ptr&lt;MatrixDouble&gt;(data, &amp;data-&gt;grad);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create finite element instances to integrate the right-hand side of slow</span></div>
<div class="line">    <span class="comment">// and stiff vector, and the tangent left-hand side for stiff part.</span></div>
<div class="line">    boost::shared_ptr&lt;Ele&gt; vol_ele_slow_rhs(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line">    boost::shared_ptr&lt;Ele&gt; vol_ele_stiff_rhs(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line">    boost::shared_ptr&lt;Ele&gt; vol_ele_stiff_lhs(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Push operators to integrate the slow right-hand side vector</span></div>
<div class="line">    vol_ele_slow_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;u&quot;</span>, val_ptr));</div>
<div class="line">    vol_ele_slow_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpAssembleSlowRhs(data));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// PETSc IMAX and Explicit solver demans that g = M^-1 G is provided. So</span></div>
<div class="line">    <span class="comment">// when the slow right-hand side vector (G) is assembled is solved for g</span></div>
<div class="line">    <span class="comment">// vector.</span></div>
<div class="line">    <span class="keyword">auto</span> solve_for_g = [&amp;]() {</div>
<div class="line">      <a class="code" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordflow">if</span> (*(vol_ele_slow_rhs-&gt;vecAssembleSwitch)) {</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(vol_ele_slow_rhs-&gt;ts_F, ADD_VALUES,</div>
<div class="line">                                   SCATTER_REVERSE);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(vol_ele_slow_rhs-&gt;ts_F, ADD_VALUES,</div>
<div class="line">                                 SCATTER_REVERSE);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(vol_ele_slow_rhs-&gt;ts_F);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(vol_ele_slow_rhs-&gt;ts_F);</div>
<div class="line">        *vol_ele_slow_rhs-&gt;vecAssembleSwitch = <span class="keyword">false</span>;</div>
<div class="line">      }</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(data-&gt;ksp, vol_ele_slow_rhs-&gt;ts_F,</div>
<div class="line">                      vol_ele_slow_rhs-&gt;ts_F);</div>
<div class="line">      <a class="code" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    <span class="comment">// Add hook to the element to calculate g.</span></div>
<div class="line">    vol_ele_slow_rhs-&gt;postProcessHook = solve_for_g;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> det_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> inv_jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// Add operators to calculate the stiff right-hand side</span></div>
<div class="line">    vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHOJac_3_012_01_4.html">OpCalculateHOJac&lt;2&gt;</a>(jac_ptr));</div>
<div class="line">    vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpInvertMatrix.html">OpInvertMatrix&lt;2&gt;</a>(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">    vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetHOInvJacToScalarBases_3_012_01_4.html">OpSetHOInvJacToScalarBases&lt;2&gt;</a>(<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, inv_jac_ptr));</div>
<div class="line">    vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="namespaceMoFEM.html#abacce9829252f33b5ca316aea0b3e090">OpCalculateScalarFieldValuesDot</a>(<span class="stringliteral">&quot;u&quot;</span>, dot_val_ptr));</div>
<div class="line">    vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;2&gt;</a>(<span class="stringliteral">&quot;u&quot;</span>, grad_ptr));</div>
<div class="line">    vol_ele_stiff_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpAssembleStiffRhs&lt;2&gt;(data));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operators to calculate the stiff left-hand side</span></div>
<div class="line">    vol_ele_stiff_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateHOJac_3_012_01_4.html">OpCalculateHOJac&lt;2&gt;</a>(jac_ptr));</div>
<div class="line">    vol_ele_stiff_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpInvertMatrix.html">OpInvertMatrix&lt;2&gt;</a>(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">    vol_ele_stiff_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpSetHOInvJacToScalarBases_3_012_01_4.html">OpSetHOInvJacToScalarBases&lt;2&gt;</a>(<a class="code" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, inv_jac_ptr));</div>
<div class="line">    vol_ele_stiff_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpAssembleStiffLhs&lt;2&gt;(data));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rules</span></div>
<div class="line">    <span class="keyword">auto</span> vol_rule = [](<a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> p) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * p; };</div>
<div class="line">    vol_ele_slow_rhs-&gt;getRuleHook = vol_rule;</div>
<div class="line">    vol_ele_stiff_rhs-&gt;getRuleHook = vol_rule;</div>
<div class="line">    vol_ele_stiff_lhs-&gt;getRuleHook = vol_rule;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Crate element for post-processing</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> post_proc = boost::make_shared&lt;PostProcEle&gt;(m_field);</div>
<div class="line">    boost::shared_ptr&lt;ForcesAndSourcesCore&gt; <span class="keyword">null</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using</span> <a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPPMap</a> = <a class="code" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;2, 2&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    post_proc-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;u&quot;</span>, u_ptr));</div>
<div class="line">    post_proc-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a class="code" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">            post_proc-&gt;getPostProcMesh(), post_proc-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;u&quot;</span>, u_ptr}},</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {}</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get PETSc discrete manager</span></div>
<div class="line">    <span class="keyword">auto</span> dm = simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#a9261d3ef9b39a00cb7d0acc612702275">getDM</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get surface entities form blockset, set initial values in those</span></div>
<div class="line">    <span class="comment">// blocksets. To keep it simple is assumed that inital values are on</span></div>
<div class="line">    <span class="comment">// blockset 1</span></div>
<div class="line">    <span class="keywordflow">if</span> (m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code" href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">checkMeshset</a>(1, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>)) {</div>
<div class="line">      <a class="code" href="classRange.html">Range</a> inner_surface;</div>
<div class="line">      <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1MeshsetsManager.html">MeshsetsManager</a>&gt;()-&gt;getEntitiesByDimension(</div>
<div class="line">          1, <a class="code" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, 2, inner_surface, <span class="keyword">true</span>);</div>
<div class="line">      <span class="keywordflow">if</span> (!inner_surface.empty()) {</div>
<div class="line">        <a class="code" href="classRange.html">Range</a> inner_surface_verts;</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(inner_surface, inner_surface_verts, <span class="keyword">false</span>);</div>
<div class="line">        <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1FieldBlas.html">FieldBlas</a>&gt;()-&gt;setField(</div>
<div class="line">            <a class="code" href="namespaceReactionDiffusionEquation.html#afb003ba712ed758a736a934ae3c16764">u0</a>, MBVERTEX, inner_surface_verts, <span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get skin on the body, i.e. body boundary, and apply homogenous Dirichlet</span></div>
<div class="line">    <span class="comment">// conditions on that boundary.</span></div>
<div class="line">    <a class="code" href="classRange.html">Range</a> <a class="code" href="namespacesurface.html#ac5b6e387c2c24e86299c80489d6838c0">surface</a>;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_dimension(0, 2, <a class="code" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>);</div>
<div class="line">    Skinner skin(&amp;m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">get_moab</a>());</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> edges;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code" href="namespacesurface.html">surface</a>, <span class="keyword">false</span>, edges);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> edges_part;</div>
<div class="line">    ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(edges, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;edges_part);</div>
<div class="line">    <a class="code" href="classRange.html">Range</a> edges_verts;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edges_part, edges_verts, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// Since Dirichlet b.c. are essential boundary conditions, remove DOFs from</span></div>
<div class="line">    <span class="comment">// the problem.</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code" href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code" href="structMoFEM_1_1ProblemsManager.html">ProblemsManager</a>&gt;()-&gt;removeDofsOnEntities(</div>
<div class="line">        simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">getProblemName</a>(), <span class="stringliteral">&quot;u&quot;</span>,</div>
<div class="line">        unite(edges_verts, edges_part));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create mass matrix, calculate and assemble</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga7ceaaf7c6121bf86a998297a44647afe">DMCreateMatrix_MoFEM</a>(dm, data-&gt;M);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatZeroEntries(data-&gt;M);</div>
<div class="line">    boost::shared_ptr&lt;Ele&gt; vol_mass_ele(<span class="keyword">new</span> <a class="code" href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a>(m_field));</div>
<div class="line">    vol_mass_ele-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpAssembleMass(data));</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ad7be306d6140fff96459dae0b5eddfcb">getDomainFEName</a>(),</div>
<div class="line">                                    vol_mass_ele);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(data-&gt;M, MAT_FINAL_ASSEMBLY);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(data-&gt;M, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create and septup KSP (linear solver), we need this to calculate g(t,u) =</span></div>
<div class="line">    <span class="comment">// M^-1G(t,u)</span></div>
<div class="line">    data-&gt;ksp = <a class="code" href="namespaceMoFEM.html#a10bae3a5a92d97274ffdd4b5d3ed5c0e">createKSP</a>(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>());</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(data-&gt;ksp, data-&gt;M, data-&gt;M);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(data-&gt;ksp);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(data-&gt;ksp);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create and setup TS solver</span></div>
<div class="line">    <span class="keyword">auto</span> ts = <a class="code" href="namespaceMoFEM.html#a89f535c8339c55c756485568be5559f7">createTS</a>(m_field.<a class="code" href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">get_comm</a>());</div>
<div class="line">    <span class="comment">// Use IMEX solver, i.e. implicit/explicit solver</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetType(ts, TSARKIMEX);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSARKIMEXSetType(ts, TSARKIMEXA2);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add element to calculate lhs of stiff part</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm, simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ad7be306d6140fff96459dae0b5eddfcb">getDomainFEName</a>(),</div>
<div class="line">                                 vol_ele_stiff_lhs, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
<div class="line">    <span class="comment">// Add element to calculate rhs of stiff part</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ad7be306d6140fff96459dae0b5eddfcb">getDomainFEName</a>(),</div>
<div class="line">                                 vol_ele_stiff_rhs, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
<div class="line">    <span class="comment">// Add element to calculate rhs of slow (nonlinear) part</span></div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a22cbb40b656b2ce3ea9c58841d9e3463">DMMoFEMTSSetRHSFunction</a>(dm, simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ad7be306d6140fff96459dae0b5eddfcb">getDomainFEName</a>(),</div>
<div class="line">                                   vol_ele_slow_rhs, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add monitor to time solver</span></div>
<div class="line">    boost::shared_ptr&lt;Monitor&gt; monitor_ptr(<span class="keyword">new</span> <a class="code" href="structPlasticOps_1_1Monitor.html">Monitor</a>(dm, post_proc));</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="namespaceMoFEM.html#a112dfab22d28426fcd0ab2d61cf8f494">DMMoFEMTSSetMonitor</a>(dm, ts, simple_interface-&gt;<a class="code" href="structMoFEM_1_1Simple.html#ad7be306d6140fff96459dae0b5eddfcb">getDomainFEName</a>(),</div>
<div class="line">                               monitor_ptr, <span class="keyword">null</span>, <span class="keyword">null</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create solution vector</span></div>
<div class="line">    <a class="code" href="structMoFEM_1_1SmartPetscObj.html">SmartPetscObj&lt;Vec&gt;</a> X;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#gad39405cdec4e369e9a14c330456cd541">DMCreateGlobalVector_MoFEM</a>(dm, X);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, X, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Solve problem</span></div>
<div class="line">    <span class="keywordtype">double</span> ftime = 1;</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, dm);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDuration(ts, PETSC_DEFAULT, ftime);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, X);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line">    <a class="code" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, X);</div>
<div class="line">  }</div>
<div class="line">  <a class="code" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// finish work cleaning memory, getting statistics, etc.</span></div>
<div class="line">  <a class="code" href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<div class="ttc" id="astructMoFEM_1_1UnknownInterface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="structMoFEM_1_1UnknownInterface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="UnknownInterface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespaceMoFEM.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="anamespacesurface_html"><div class="ttname"><a href="namespacesurface.html">surface</a></div><div class="ttdef"><b>Definition:</b> <a href="surface_8py_source.html#l00001">surface.py:1</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ProblemsManager_html"><div class="ttname"><a href="structMoFEM_1_1ProblemsManager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition:</b> <a href="ProblemsManager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FEMethod_html"><div class="ttname"><a href="structMoFEM_1_1FEMethod.html">MoFEM::FEMethod</a></div><div class="ttdoc">structure for User Loop Methods on finite elements</div><div class="ttdef"><b>Definition:</b> <a href="LoopMethods_8hpp_source.html#l00369">LoopMethods.hpp:369</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a89f535c8339c55c756485568be5559f7"><div class="ttname"><a href="namespaceMoFEM.html#a89f535c8339c55c756485568be5559f7">MoFEM::createTS</a></div><div class="ttdeci">auto createTS(MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="PetscSmartObj_8hpp_source.html#l00249">PetscSmartObj.hpp:249</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adecbcd03d7be8763b60a827f434fe726"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adecbcd03d7be8763b60a827f434fe726">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astructCommonData_html_ae883bdc65f92362725d3e730302f3671"><div class="ttname"><a href="structCommonData.html#ae883bdc65f92362725d3e730302f3671">CommonData::ksp</a></div><div class="ttdeci">SmartPetscObj&lt; KSP &gt; ksp</div><div class="ttdoc">Linear solver.</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00416">dynamic_first_order_con_law.cpp:416</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetHOInvJacToScalarBases_3_012_01_4_html"><div class="ttname"><a href="structMoFEM_1_1OpSetHOInvJacToScalarBases_3_012_01_4.html">MoFEM::OpSetHOInvJacToScalarBases&lt; 2 &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00078">HODataOperators.hpp:78</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_abacce9829252f33b5ca316aea0b3e090"><div class="ttname"><a href="namespaceMoFEM.html#abacce9829252f33b5ca316aea0b3e090">MoFEM::OpCalculateScalarFieldValuesDot</a></div><div class="ttdeci">OpCalculateScalarFieldValuesFromPetscVecImpl&lt; PetscData::CTX_SET_X_T &gt; OpCalculateScalarFieldValuesDot</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00273">UserDataOperators.hpp:273</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a3d65745e902af842b5c490eedbcd30d1"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a3d65745e902af842b5c490eedbcd30d1">MoFEM::Simple::loadFile</a></div><div class="ttdeci">MoFEMErrorCode loadFile(const std::string options, const std::string mesh_file_name, LoadFileFunc loadFunc=defaultLoadFileFunc)</div><div class="ttdoc">Load mesh file.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00194">Simple.cpp:194</a></div></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html">ReactionDiffusionEquation</a></div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00012">reaction_diffusion.cpp:12</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a10bae3a5a92d97274ffdd4b5d3ed5c0e"><div class="ttname"><a href="namespaceMoFEM.html#a10bae3a5a92d97274ffdd4b5d3ed5c0e">MoFEM::createKSP</a></div><div class="ttdeci">auto createKSP(MPI_Comm comm)</div><div class="ttdef"><b>Definition:</b> <a href="PetscSmartObj_8hpp_source.html#l00261">PetscSmartObj.hpp:261</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html"><div class="ttname"><a href="structMoFEM_1_1Simple.html">MoFEM::Simple</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8hpp_source.html#l00027">Simple.hpp:27</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespaceMoFEM.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition:</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition:</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHOJac_3_012_01_4_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHOJac_3_012_01_4.html">MoFEM::OpCalculateHOJac&lt; 2 &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="HODataOperators_8hpp_source.html#l00273">HODataOperators.hpp:273</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">MoFEM::OpCalculateScalarFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l01293">UserDataOperators.hpp:1293</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_ad9258a21a57783a3fe0e29a2cc18c856"><div class="ttname"><a href="namespaceMoFEM.html#ad9258a21a57783a3fe0e29a2cc18c856">MoFEM::Interface</a></div><div class="ttdeci">DeprecatedCoreInterface Interface</div><div class="ttdef"><b>Definition:</b> <a href="Interface_8hpp_source.html#l02010">Interface.hpp:2010</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01502">EntitiesFieldData.hpp:1502</a></div></div>
<div class="ttc" id="agroup__dm_html_gad39405cdec4e369e9a14c330456cd541"><div class="ttname"><a href="group__dm.html#gad39405cdec4e369e9a14c330456cd541">MoFEM::DMCreateGlobalVector_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMCreateGlobalVector_MoFEM(DM dm, Vec *g)</div><div class="ttdoc">DMShellSetCreateGlobalVector.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01167">DMMoFEM.cpp:1167</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a8325447a1773550852f04c1b600af703"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a8325447a1773550852f04c1b600af703">MoFEM::Simple::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div><div class="ttdoc">get options</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00180">Simple.cpp:180</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoab_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">MoFEM::PostProcBrokenMeshInMoab</a></div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00667">PostProcBrokenMeshInMoabBase.hpp:667</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a9261d3ef9b39a00cb7d0acc612702275"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a9261d3ef9b39a00cb7d0acc612702275">MoFEM::Simple::getDM</a></div><div class="ttdeci">MoFEMErrorCode getDM(DM *dm)</div><div class="ttdoc">Get DM.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00747">Simple.cpp:747</a></div></div>
<div class="ttc" id="anamespacePlasticOps_html_a4578443e6584bb3768a745dea5dc92aa"><div class="ttname"><a href="namespacePlasticOps.html#a4578443e6584bb3768a745dea5dc92aa">PlasticOps::M</a></div><div class="ttdeci">FTensor::Index&lt; 'M', 3 &gt; M</div><div class="ttdef"><b>Definition:</b> <a href="PlasticOps_8hpp_source.html#l00117">PlasticOps.hpp:117</a></div></div>
<div class="ttc" id="agroup__dm_html_ga7ceaaf7c6121bf86a998297a44647afe"><div class="ttname"><a href="group__dm.html#ga7ceaaf7c6121bf86a998297a44647afe">MoFEM::DMCreateMatrix_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMCreateMatrix_MoFEM(DM dm, Mat *M)</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01197">DMMoFEM.cpp:1197</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_abded98f73756cdfa3293cc0b9fd50450"><div class="ttname"><a href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a></div><div class="ttdeci">int save_every_nth_step</div><div class="ttdef"><b>Definition:</b> <a href="photon__diffusion_8cpp_source.html#l00067">photon_diffusion.cpp:67</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html_a9c0a9a269e2e1026ee94cedc069fd0cf"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html#a9c0a9a269e2e1026ee94cedc069fd0cf">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdeci">friend class UserDataOperator</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00086">FaceElementForcesAndSourcesCore.hpp:86</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreInterface_html_adb4b1c061d2348966a28e7425072f464"><div class="ttname"><a href="structMoFEM_1_1CoreInterface.html#adb4b1c061d2348966a28e7425072f464">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="agroup__dm_html_gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3"><div class="ttname"><a href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">MoFEM::DMMoFEMTSSetIJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIJacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00853">DMMoFEM.cpp:853</a></div></div>
<div class="ttc" id="astructReactionDiffusionEquation_1_1OpAssembleStiffRhs_html"><div class="ttname"><a href="structReactionDiffusionEquation_1_1OpAssembleStiffRhs.html">ReactionDiffusionEquation::OpAssembleStiffRhs</a></div><div class="ttdoc">Assemble stiff part.</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00151">reaction_diffusion.cpp:151</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html_afb003ba712ed758a736a934ae3c16764"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html#afb003ba712ed758a736a934ae3c16764">ReactionDiffusionEquation::u0</a></div><div class="ttdeci">const double u0</div><div class="ttdoc">inital vale on blocksets</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00024">reaction_diffusion.cpp:24</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00094">FaceElementForcesAndSourcesCore.hpp:94</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="astructCommonData_html_a6a123f52adcbb6b7722579eab15d08f5"><div class="ttname"><a href="structCommonData.html#a6a123f52adcbb6b7722579eab15d08f5">CommonData::M</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; M</div><div class="ttdoc">Mass matrix.</div><div class="ttdef"><b>Definition:</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00415">dynamic_first_order_con_law.cpp:415</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition:</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_aa464ad90a188180427136b22e078ec7d"><div class="ttname"><a href="namespaceMoFEM.html#aa464ad90a188180427136b22e078ec7d">MoFEM::getFTensor0FromVec</a></div><div class="ttdeci">static auto getFTensor0FromVec(ublas::vector&lt; T, A &gt; &amp;data)</div><div class="ttdoc">Get tensor rank 0 (scalar) form data vector.</div><div class="ttdef"><b>Definition:</b> <a href="Templates_8hpp_source.html#l00135">Templates.hpp:135</a></div></div>
<div class="ttc" id="astructPlasticOps_1_1Monitor_html"><div class="ttname"><a href="structPlasticOps_1_1Monitor.html">PlasticOps::Monitor</a></div><div class="ttdef"><b>Definition:</b> <a href="PlasticOpsMonitor_8hpp_source.html#l00009">PlasticOpsMonitor.hpp:9</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValues.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00082">UserDataOperators.hpp:82</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_a5b3d613d37bec6e737f2db6dfdce0f7d"><div class="ttname"><a href="structMoFEM_1_1Simple.html#a5b3d613d37bec6e737f2db6dfdce0f7d">MoFEM::Simple::addDomainField</a></div><div class="ttdeci">MoFEMErrorCode addDomainField(const std::string &amp;name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_ZERO, int verb=-1)</div><div class="ttdoc">Add field on domain.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00264">Simple.cpp:264</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a632d60524d4b1682a472437b9277e480"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a632d60524d4b1682a472437b9277e480">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8hpp_source.html#l01214">EntitiesFieldData.hpp:1214</a></div></div>
<div class="ttc" id="anamespacesurface_html_ac5b6e387c2c24e86299c80489d6838c0"><div class="ttname"><a href="namespacesurface.html#ac5b6e387c2c24e86299c80489d6838c0">surface.surface</a></div><div class="ttdeci">def surface(x, y, z, eta)</div><div class="ttdef"><b>Definition:</b> <a href="surface_8py_source.html#l00003">surface.py:3</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_ad7be306d6140fff96459dae0b5eddfcb"><div class="ttname"><a href="structMoFEM_1_1Simple.html#ad7be306d6140fff96459dae0b5eddfcb">MoFEM::Simple::getDomainFEName</a></div><div class="ttdeci">const std::string getDomainFEName() const</div><div class="ttdoc">Get the Domain FE Name.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8hpp_source.html#l00368">Simple.hpp:368</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition:</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValuesFromPetscVecImpl_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValuesFromPetscVecImpl.html">MoFEM::OpCalculateScalarFieldValuesFromPetscVecImpl</a></div><div class="ttdoc">Get rate of scalar field at integration points.</div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l00156">UserDataOperators.hpp:156</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a0ddf1224851353fc92bfbff6f499fa97"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a0ddf1224851353fc92bfbff6f499fa97">main</a></div><div class="ttdeci">int main(int argc, char *argv[])</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00015">activate_deactivate_dofs.cpp:15</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a1342a5bb82a44eb578a7246723649d11"><div class="ttname"><a href="child__and__parent_8cpp.html#a1342a5bb82a44eb578a7246723649d11">EntData</a></div><div class="ttdeci">EntitiesFieldData::EntData EntData</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00037">child_and_parent.cpp:37</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index&lt; 'i', DIM &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_ab233701869a6020eb4a2cb348bd7978d"><div class="ttname"><a href="structMoFEM_1_1Simple.html#ab233701869a6020eb4a2cb348bd7978d">MoFEM::Simple::setFieldOrder</a></div><div class="ttdeci">MoFEMErrorCode setFieldOrder(const std::string field_name, const int order, const Range *ents=NULL)</div><div class="ttdoc">Set field order.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00545">Simple.cpp:545</a></div></div>
<div class="ttc" id="aclassRange_html"><div class="ttname"><a href="classRange.html">Range</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a22cbb40b656b2ce3ea9c58841d9e3463"><div class="ttname"><a href="namespaceMoFEM.html#a22cbb40b656b2ce3ea9c58841d9e3463">MoFEM::DMMoFEMTSSetRHSFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetRHSFunction(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS the right hand side function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00882">DMMoFEM.cpp:882</a></div></div>
<div class="ttc" id="astructMoFEM_1_1CoreTmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="structMoFEM_1_1CoreTmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="Core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition:</b> <a href="EntitiesFieldData_8cpp_source.html#l00526">EntitiesFieldData.cpp:526</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a8bdfc7559ccb2b6d0021580b5c8a340b"><div class="ttname"><a href="namespaceMoFEM.html#a8bdfc7559ccb2b6d0021580b5c8a340b">MoFEM::Core</a></div><div class="ttdeci">CoreTmp&lt; 0 &gt; Core</div><div class="ttdef"><b>Definition:</b> <a href="Core_8hpp_source.html#l01148">Core.hpp:1148</a></div></div>
<div class="ttc" id="anamespaceHenckyOps_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespaceHenckyOps.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition:</b> <a href="HenckyOps_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="ahdiv__check__approx__in__3d_8cpp_html_aa8d6c82be2c35a4782aea868dc94f9cb"><div class="ttname"><a href="hdiv__check__approx__in__3d_8cpp.html#aa8d6c82be2c35a4782aea868dc94f9cb">Ele</a></div><div class="ttdeci">MoFEM::PipelineManager::ElementsAndOpsByDim&lt; SPACE_DIM &gt;::DomainEle Ele</div><div class="ttdef"><b>Definition:</b> <a href="hdiv__check__approx__in__3d_8cpp_source.html#l00018">hdiv_check_approx_in_3d.cpp:18</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="astructCommonData_html"><div class="ttname"><a href="structCommonData.html">CommonData</a></div><div class="ttdef"><b>Definition:</b> <a href="continuity__check__on__skeleton__with__simple__2d__for__h1_8cpp_source.html#l00022">continuity_check_on_skeleton_with_simple_2d_for_h1.cpp:22</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a112dfab22d28426fcd0ab2d61cf8f494"><div class="ttname"><a href="namespaceMoFEM.html#a112dfab22d28426fcd0ab2d61cf8f494">MoFEM::DMMoFEMTSSetMonitor</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetMonitor(DM dm, TS ts, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">Set Monitor To TS solver.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l01056">DMMoFEM.cpp:1056</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base .</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00060">definitions.h:60</a></div></div>
<div class="ttc" id="agroup__dm_html_ga286b3dbf0959ea028035e1d808a9403a"><div class="ttname"><a href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">MoFEM::DMMoFEMTSSetIFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00800">DMMoFEM.cpp:800</a></div></div>
<div class="ttc" id="astructMoFEM_1_1MeshsetsManager_html"><div class="ttname"><a href="structMoFEM_1_1MeshsetsManager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpInvertMatrix_html"><div class="ttname"><a href="structMoFEM_1_1OpInvertMatrix.html">MoFEM::OpInvertMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="UserDataOperators_8hpp_source.html#l03249">UserDataOperators.hpp:3249</a></div></div>
<div class="ttc" id="astructReactionDiffusionEquation_1_1OpAssembleMass_html"><div class="ttname"><a href="structReactionDiffusionEquation_1_1OpAssembleMass.html">ReactionDiffusionEquation::OpAssembleMass</a></div><div class="ttdoc">Assemble mass matrix.</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00047">reaction_diffusion.cpp:47</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespaceReactionDiffusionEquation_html_a6078a7f940fe823a1c1ccb4cc277e03e"><div class="ttname"><a href="namespaceReactionDiffusionEquation.html#a6078a7f940fe823a1c1ccb4cc277e03e">ReactionDiffusionEquation::D</a></div><div class="ttdeci">const double D</div><div class="ttdoc">diffusivity</div><div class="ttdef"><b>Definition:</b> <a href="reaction__diffusion_8cpp_source.html#l00020">reaction_diffusion.cpp:20</a></div></div>
<div class="ttc" id="astructMoFEM_1_1SmartPetscObj_html"><div class="ttname"><a href="structMoFEM_1_1SmartPetscObj.html">MoFEM::SmartPetscObj&lt; DM &gt;</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_acf413f83e47d1e092a8d5fdb27996cbf"><div class="ttname"><a href="structMoFEM_1_1Simple.html#acf413f83e47d1e092a8d5fdb27996cbf">MoFEM::Simple::setUp</a></div><div class="ttdeci">MoFEMErrorCode setUp(const PetscBool is_partitioned=PETSC_TRUE)</div><div class="ttdoc">Setup problem.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8cpp_source.html#l00683">Simple.cpp:683</a></div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_ga59a61820bca209651d9a1886848ebc25"><div class="ttname"><a href="group__mofem__meshset__mng.html#ga59a61820bca209651d9a1886848ebc25">MoFEM::MeshsetsManager::checkMeshset</a></div><div class="ttdeci">bool checkMeshset(const int ms_id, const CubitBCType cubit_bc_type) const</div><div class="ttdoc">check for CUBIT Id and CUBIT type</div><div class="ttdef"><b>Definition:</b> <a href="MeshsetsManager_8cpp_source.html#l00360">MeshsetsManager.cpp:360</a></div></div>
<div class="ttc" id="astructMoFEM_1_1Simple_html_ad7603558a61c32e29d2bc1d0210ddf88"><div class="ttname"><a href="structMoFEM_1_1Simple.html#ad7603558a61c32e29d2bc1d0210ddf88">MoFEM::Simple::getProblemName</a></div><div class="ttdeci">const std::string getProblemName() const</div><div class="ttdoc">Get the Problem Name.</div><div class="ttdef"><b>Definition:</b> <a href="Simple_8hpp_source.html#l00389">Simple.hpp:389</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition:</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition:</b> <a href="DMMoFEM_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespaceMoFEM.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="DeprecatedPetsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FieldBlas_html"><div class="ttname"><a href="structMoFEM_1_1FieldBlas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition:</b> <a href="FieldBlas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition:</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00698">PostProcBrokenMeshInMoabBase.hpp:698</a></div></div>
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.8.17
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>