<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.5"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: SCL-2: Poisson&#39;s equation (non-homogeneous BC)</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.5 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div><div class="header">
  <div class="headertitle"><div class="title">SCL-2: <a class="el" href="struct_poisson.html">Poisson</a>'s equation (non-homogeneous BC) </div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul><li class="level1"><a href="#basic_tutorials_poisson_nonhomogeneous_introduction">Introduction</a><ul><li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_problem_Statement">Problem Statement</a></li>
</ul>
</li>
<li class="level1"><a href="#basic_tutorials_poisson_nonhomogeneous_numercial_scheme">Numerical Scheme</a><ul><li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_approximation">Approximation</a></li>
<li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_problem_fomlation">Problem formulation</a></li>
</ul>
</li>
<li class="level1"><a href="#basic_tutorials_poisson_nonhomogeneous_code_strucrure">Code Structure</a><ul><li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_UDOs">User Defined Operators(UDO)</a><ul><li class="level3"><a href="#OpDomainLhs">OpDomainLhs()</a></li>
<li class="level3"><a href="#OpDomainRhs">OpDomainRhs()</a></li>
<li class="level3"><a href="#OpBoundaryLhs">OpBoundaryLhs()</a></li>
<li class="level3"><a href="#OpBoundaryRhs">OpBoundaryRhs()</a></li>
</ul>
</li>
<li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_source_code">Main program (*.cpp)</a><ul><li class="level3"><a href="#readMesh">readMesh()</a></li>
<li class="level3"><a href="#setupProblem">setupProblem()</a></li>
<li class="level3"><a href="#boundaryCondition">boundaryCondition()</a></li>
<li class="level3"><a href="#assembleSystem">assembleSystem()</a></li>
<li class="level3"><a href="#setIntegrationRules">setIntegrationRules()</a></li>
<li class="level3"><a href="#solveSystem">solveSystem()</a></li>
</ul>
</li>
</ul>
</li>
<li class="level1"><a href="#basic_tutorials_poisson_nonhomogeneous_result">Results</a></li>
<li class="level1"><a href="#basic_tutorials_poisson_nonhomogeneous_plain_program">Plain program</a><ul><li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_impl_udo">Implementation of User Data Operators (*.hpp)</a></li>
<li class="level2"><a href="#basic_tutorials_poisson_nonhomogeneous_impl_main">Implementation of the main program (*.cpp)</a></li>
</ul>
</li>
</ul>
</div>
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>Prerequisite of this tutorial is <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a></dd></dl>
<p><br  />
</p>
<dl class="section note"><dt>Note</dt><dd>Intended learning outcome:<ul>
<li>idea of Boundary element in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> and how to use it</li>
<li>handling of non-homogeneous boundary conditions using least square approximation in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a></li>
<li>process of implementing additional User Data Operators (UDOs) to calculate and assemble non-homogeneous boundary condition</li>
<li>practising on how to <b>push</b> the developed UDOs to the <em>Pipeline</em></li>
</ul>
</dd></dl>
<h1><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_introduction"></a>
Introduction</h1>
<p >The focus of our current tutorial is on solving Laplace-type partial differential equations (PDEs) <a class="el" href="struct_poisson.html">Poisson</a> Problem with non-homogenous Dirichlet boundary conditions. While the <a class="el" href="basic_tutorials_poisson_nonhomogeneous.html">SCL-2: Poisson's equation (non-homogeneous BC)</a> has designed for solving Dirichlet problems with homogeneous boundary conditions, this tutorial guides the methods to extend this to non-homogeneous cases and plot the solution.</p>
<p >We are also aiming to present <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> approaches for handling Dirichlet problems in addition to the least square approximation while establishing your necessary foundation in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> as well. Prior to that, we would like to suggest understanding the operators(i.e. OpDomainLhsMatrixK and OpDomainRhsVectorF) in <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a> before proceeding to this tutorial.</p>
<h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_problem_Statement"></a>
Problem Statement</h2>
<p >We are demonstrating an approach to solve a simple <a class="el" href="struct_poisson.html">Poisson</a>'s problem with nonhomogenous BC and help you grasp the approach better. For this problem, we denote the domain as Ω, and Γ represents the Dirichlet boundary, as illustrated in Figure 1.</p>
<p >Thus, we are solving a sample problem with nonhomogeneous BCs to find \(\mathbf{u}\). such that:</p>
<p ><code>Domain Equation:</code>  </p><p class="formulaDsp">
\[
  \begin{align}
  -\nabla \cdot\nabla u = f(\mathbf{x}) \,\,\, in \,\,\, \Omega 
  \end{align}
\]
</p>
<p> <code>Boundary condition:</code>  </p><p class="formulaDsp">
\[

\begin{align}
  u = g(\mathbf{x}) \,\,\, on \,\,\,\Gamma
  \end{align}
\]
</p>
<p >Where <em>f</em> is the source term of the body and <code>g</code> is denoted as boundary function. However, if <code>g</code> is a constant everywhere (i.e. 0), we speak of homogeneous boundary conditions but in this problem, we are considering a spatially varying function \(g(\mathbf{x})\). <a class="anchor" id="figure_poisson_nonhomogeneous_problem"></a></p><div class="image">
<img src="poisson_nonhomogeneous_problem.png" alt="" width="350px"/>
<div class="caption">
Figure 1: Nonhomogeneous problem Statement. </div></div>
<h1><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_numercial_scheme"></a>
Numerical Scheme</h1>
<p >In the context of solving this partial differential equation (PDE), Galerkin finite element methods with least square approximation have been executed to enforce nonhomogeneous boundary condition. We are also utilizing <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> libraries conforming finite element spaces with Least-Square approximation(LSA) for the boundary by minimizing the squared differences between the approximated values and the actual, similar to the following:  </p><p class="formulaDsp">
\[
\frac{1}{2}\int_{\Gamma} (u - g(\mathbf{x}))^2 \,d\Gamma 
\]
</p>
<p> Remember, previously we derived a weak form for homogeneous BC in <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>. Following that approch, we can write similar weak form for our current problem for domain (Ω) and boundary(Γ) which also exists for \( \forall \,\delta u \) as follows:</p>
<p class="formulaDsp">
\[
\begin{align}
\int_{\Omega} \nabla \delta u \cdot \nabla u \,d\Omega = \int_{\Omega} \delta u \,f(\mathbf{x})\,d\Omega \quad\text{and}
\end{align}
\]
</p>
  <p class="formulaDsp">
\[
  \begin{align}
   \int_{\Gamma} \delta u \, \,d\Gamma =  \int_{\Gamma} \delta u \,g(\mathbf{x})\,d\Gamma
   \end{align}
\]
</p>
 <h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_approximation"></a>
Approximation</h2>
<p >In the context of finite element method, the problem will be solved numerically by approximating the scalar space \( \mathbf{H^1} \) by the discrete counterparts associated with our FE mesh of the computational domain \(\Omega\). To do that, we are utilizing two key components to solve: (i) \(N_{\alpha} \) and \(N_{\beta} \) are the shape functions for the field variable and for test functions respectively, (ii) \(\bar{u}_{\alpha}\) and \(\delta\bar{u}_{\beta}\) represent for 'n' number of DoF within that element to obtain the solution 'u' as stated below:  </p><p class="formulaDsp">
\[
\begin{align}
 u &amp;= \sum_{\alpha=0}^{n-1} \mathbf{N}_{\alpha} \bar{u}_\alpha \,\,\text{and,}\\
{\delta u} &amp;= \sum_{\beta=0}^{n-1}\mathbf{{N}_{\beta}} \delta\bar{u}_{\beta}
\end{align}
\]
</p>
<p >Further, to assemble the element stiffness matrix we are indicating \(\alpha\) for the collums and \(\beta\) for rows. A typical approximation can be understood well in tutorial <a class="el" href="hierarchical_approximation_1.html">FUN-2: Hierarchical approximation</a>. So, to approximate the fields based on the weak forms in equation (5) and (6) can be written as follows:  </p><p class="formulaDsp">
\[
\begin{equation}
    \sum_{\alpha=0}^{n-1} \sum_{\beta=0}^{n-1} \delta\bar{u}_{\beta} \left[\int_{\Omega} \nabla \mathbf{N}_{\alpha} \cdot \nabla \mathbf{N}_{\beta} \,d\Omega\right] \bar{u}_{\alpha} \,\,= \,\, \sum_{\beta=0}^{n-1} \delta \bar{u}_{\beta} \left[\int_{\Omega} f(\mathbf{x})\,\, \mathbf{N}_{\beta} \,d\Omega\right] \quad ;\,\forall \,\delta \bar{u}_{\beta}
\end{equation}
\]
</p>
<p> and</p>
<p class="formulaDsp">
\[
\begin{equation}
    \sum_{\alpha=0}^{n-1} \sum_{\beta=0}^{n-1} \delta\bar{u}_{\beta} \left[\int_{\Gamma} \mathbf{N}_{\alpha} \,\,\mathbf{N}_{\beta} \,d\Gamma\right] \bar{u}_{\alpha} \,\,= \,\,\sum_{\beta=0}^{n-1} \delta \bar{u}_{\beta} \left[\int_{\Gamma} g(\mathbf{x})\,\, \mathbf{N}_{\beta} \,d\Gamma\right]\quad ;\forall \,\delta \bar{u}_{\beta}
\end{equation}
\]
</p>
<p> For a better understanding the implementation of the aboves in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>, we are explaining the forms in two parts: domain and boundary. Also, let's say, we are naming the individuals for respective UDOs as follows,  </p><p class="formulaDsp">
\[
\mathbf{A_k} =
\int_{\Omega} \nabla \mathbf{N}_{\alpha} \cdot \nabla \mathbf{N}_{\beta} \,d\Omega, \quad
\mathbf{B_f} = \int_{\Omega} f(\mathbf{x})\,\,\mathbf{N}_{\beta} \,d\Omega\,\,\ \text{ |\,For Domain},
\]
</p>
<p >and</p>
<p class="formulaDsp">
\[
\mathbf{C_k} = \int_{\Gamma} \mathbf{N}_{\alpha} \cdot \mathbf{N}_{\beta} \,d\Gamma, \quad
\mathbf{D_f} = \int_{\Gamma} g(\mathbf{x})\,\, \mathbf{N}_{\beta} \,d\Gamma \,\,\text{ |\,For Boundary}.
\]
</p>
<p >Additionally, a similar discretization and implementation approach was referred in tutorial <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>.</p>
<h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_problem_fomlation"></a>
Problem formulation</h2>
<p >Based on the above schemes, we are considering 4 operators in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>. Let's say, we are naming those as follows: </p><center> <b>  Table 1: Operators for Domain and Boundary for Relevant Expresions </b> <table class="doxtable">
<tr>
<th>Respective Operators </th></tr>
<tr>
<td>\(\mathbf{A_k} \text{is implemented in } \text{OpDomainLhs}\)  </td></tr>
<tr>
<td>\(\mathbf{B_f} \text{is implemented in } \text{OpDomainRhs}\)  </td></tr>
<tr>
<td>\(\mathbf{C_k} \text{is implemented in } \text{OpBoundaryLhs}\)  </td></tr>
<tr>
<td>\(\mathbf{D_f} \text{is implemented in } \text{OpBoundaryRhs}\)  </td></tr>
</table>
</center><center></center><p >The numerical scheme has several similarities with <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a> in terms of coding in MOFEM. Therefore, we are mostly going to discuss the critical parts of it in the next section comparing with the <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>.</p>
<h1><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_code_strucrure"></a>
Code Structure</h1>
<p >Before we explore the implementation details of the User-Defined Operators (UDOs) in "poisson_2d_nonhomogeneous.hpp", let's take a look at the initial lines of code in the file. It includes <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> libraries inclusions for finite element functionality and alias definitions for declaration and initialization as follows:</p>
<div class="fragment"><div class="line"><span class="comment">// Define file name if it has not been defined yet</span></div>
<div class="line"><span class="preprocessor">#ifndef __POISSON2DNONHOMOGENEOUS_HPP__</span></div>
<div class="line"><span class="preprocessor">#define __POISSON2DNONHOMOGENEOUS_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Include standard library and Header file for basic finite elements</span></div>
<div class="line"><span class="comment">// implementation</span></div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Use of alias for some specific functions</span></div>
<div class="line"><span class="comment">// We are solving Poisson&#39;s equation in 2D so Face element is used</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">FaceEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">MoFEM::FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core.html">EdgeEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core.html">MoFEM::EdgeElementForcesAndSourcesCore</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> = EntitiesFieldData::EntData;</div>
<div class="line"><span class="comment">// Namespace that contains necessary UDOs, will be included in the main program</span></div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_poisson2_d_nonhomogeneous_operators.html">Poisson2DNonhomogeneousOperators</a> {</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Declare FTensor index for 2D problem</span></div>
<div class="line"><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 2&gt;</a> <a class="code hl_variable" href="namespace_poisson2_d_nonhomogeneous_operators.html#aeef92563540fd05ef13a932c02c13a96">i</a>;</div>
<div class="line"><span class="comment">//declare a Lambda  function </span></div>
<div class="line"><span class="keyword">typedef</span> boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">    <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">//.. .. Implementation of the UDOs below this point .. ..</span></div>
<div class="ttc" id="a_basic_finite_elements_8hpp_html"><div class="ttname"><a href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition:</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="anamespace_poisson2_d_nonhomogeneous_operators_html"><div class="ttname"><a href="namespace_poisson2_d_nonhomogeneous_operators.html">Poisson2DNonhomogeneousOperators</a></div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00015">poisson_2d_nonhomogeneous.hpp:15</a></div></div>
<div class="ttc" id="anamespace_poisson2_d_nonhomogeneous_operators_html_ad9994064117952c0a0f59e9853fb568f"><div class="ttname"><a href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">Poisson2DNonhomogeneousOperators::ScalarFunc</a></div><div class="ttdeci">boost::function&lt; double(const double, const double, const double)&gt; ScalarFunc</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00020">poisson_2d_nonhomogeneous.hpp:20</a></div></div>
<div class="ttc" id="anamespace_poisson2_d_nonhomogeneous_operators_html_aeef92563540fd05ef13a932c02c13a96"><div class="ttname"><a href="namespace_poisson2_d_nonhomogeneous_operators.html#aeef92563540fd05ef13a932c02c13a96">Poisson2DNonhomogeneousOperators::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 2 &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00017">poisson_2d_nonhomogeneous.hpp:17</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for EDGE element</div><div class="ttdef"><b>Definition:</b> <a href="_edge_element_forces_and_sources_core_8hpp_source.html#l00068">EdgeElementForcesAndSourcesCore.hpp:69</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core.html">MoFEM::EdgeElementForcesAndSourcesCore</a></div><div class="ttdoc">Edge finite element.</div><div class="ttdef"><b>Definition:</b> <a href="_edge_element_forces_and_sources_core_8hpp_source.html#l00030">EdgeElementForcesAndSourcesCore.hpp:30</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l00127">EntitiesFieldData.hpp:127</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition:</b> <a href="_face_element_forces_and_sources_core_8hpp_source.html#l00095">FaceElementForcesAndSourcesCore.hpp:96</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_face_element_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition:</b> <a href="_face_element_forces_and_sources_core_8hpp_source.html#l00025">FaceElementForcesAndSourcesCore.hpp:25</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_UDOs"></a>
User Defined Operators(UDO)</h2>
<p ><a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> has an in-built extensive library consisting of operators and to implement those operators users need to create some new UDOs according to the problems and PDEs. First, let's look at the structure of a UDO so that users can also learn the general structure of any UDOs implemented in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a>.</p>
<h3><a class="anchor" id="OpDomainLhs"></a>
OpDomainLhs()</h3>
<p >For example, we can notice that our <code>OpDomainLhs</code> is similar to the <code>OpDomainLhsMatrixK</code> UDO in <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>. So, let's identify the differences bellow and then the further will be discussed: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>OpDomainLhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  OpDomainLhs(std::string row_field_name, std::string col_field_name)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>(row_field_name, col_field_name, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>::OPROWCOL) {</div>
<div class="line">    sYmm = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_mo_f_e_m_1_1_data_operator.html#a19219f04bba3938fd893898f128dcfb2">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                        <a class="code hl_class" href="class_entity_type.html">EntityType</a> col_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_row_dofs = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col_dofs = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_row_dofs &amp;&amp; nb_col_dofs) {</div>
<div class="line"> </div>
<div class="line">      locLhs.resize(nb_row_dofs, nb_col_dofs, <span class="keyword">false</span>);</div>
<div class="line">      locLhs.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get element area</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> area = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions on row</span></div>
<div class="line">      <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;2&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL MATRIX</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * area;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_row_dofs; ++rr) {</div>
<div class="line">          <span class="comment">// get derivatives of base functions on column</span></div>
<div class="line">          <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;2&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nb_col_dofs; cc++) {</div>
<div class="line"> </div>
<div class="line">            locLhs(rr, cc) += t_row_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_col_diff_base(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// move to the derivatives of the next base functions on column</span></div>
<div class="line">            ++t_col_diff_base;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to the derivatives of the next base functions on row</span></div>
<div class="line">          ++t_row_diff_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF LOCAL MATRIX ENTRIES TO THE GLOBAL MATRIX</span></div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Fill value to local stiffness matrix ignoring boundary DOFs</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), row_data, col_data, &amp;locLhs(0, 0), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Fill values of symmetric local stiffness matrix</span></div>
<div class="line">      <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">        transLocLhs.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(transLocLhs) = trans(locLhs);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">            <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), col_data, row_data, &amp;transLocLhs(0, 0), ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;std::vector&lt;unsigned char&gt;&gt; boundaryMarker;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> locLhs, transLocLhs;</div>
<div class="line">};</div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition:</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclass_entity_type_html"><div class="ttname"><a href="class_entity_type.html">EntityType</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00346">definitions.h:346</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00416">definitions.h:416</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00535">definitions.h:535</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition:</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_data_operator_html_a19219f04bba3938fd893898f128dcfb2"><div class="ttname"><a href="struct_mo_f_e_m_1_1_data_operator.html#a19219f04bba3938fd893898f128dcfb2">MoFEM::DataOperator::doWork</a></div><div class="ttdeci">virtual MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Operator for bi-linear form, usually to calculate values on left hand side.</div><div class="ttdef"><b>Definition:</b> <a href="_data_operators_8hpp_source.html#l00040">DataOperators.hpp:40</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8cpp_source.html#l00387">EntitiesFieldData.cpp:387</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_ae5f8ff17de93c9dbb9701dc0bf067b2e"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01201">EntitiesFieldData.hpp:1201</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_a8d917e73cbaa9f177cdea72e1e7500dd"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">MoFEM::ForcesAndSourcesCore::UserDataOperator::getFTensor0IntegrationWeight</a></div><div class="ttdeci">auto getFTensor0IntegrationWeight()</div><div class="ttdoc">Get integration weights.</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01236">ForcesAndSourcesCore.hpp:1236</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_aa0f5b68e1ab8bc7e79ea1b3d969eb400"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">MoFEM::ForcesAndSourcesCore::UserDataOperator::getMeasure</a></div><div class="ttdeci">double getMeasure() const</div><div class="ttdoc">get measure of element</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01271">ForcesAndSourcesCore.hpp:1271</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_ae6b967017977d2f79550627e2a6e89bd"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">MoFEM::ForcesAndSourcesCore::UserDataOperator::getKSPB</a></div><div class="ttdeci">Mat getKSPB() const</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01100">ForcesAndSourcesCore.hpp:1100</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_ae90a09d3c36b0a4ed9ab1d99fcce0c1d"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">MoFEM::ForcesAndSourcesCore::UserDataOperator::getGaussPts</a></div><div class="ttdeci">MatrixDouble &amp; getGaussPts()</div><div class="ttdoc">matrix of integration (Gauss) points for Volume Element</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01232">ForcesAndSourcesCore.hpp:1232</a></div></div>
</div><!-- fragment --><p >In the above, the class OpDomainLhs is inherited from OpFaceEle, which stands for the alias for the base class <a class="el" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html" title="default operator for TRI element">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a>. Within this class, there are two public functions: OpDomainLhs() and doWork(). Here, the doWork() does the same as iNtegrate as in <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>. However, the difference is that we are using a different Lambda function to calculate the body source term. Alongside, we have got two private members named locLhs and transLocLhs. This follows the concept of data encapsulation to hide values and objects inside the class as much as possible.</p>
<ul>
<li><code>locLhs</code> <br  />
 This private member object of type MatrixDouble is used to store the results of the calculation of the components of element stiffness matrix. Besides, this object is made private so that only member of the class has access to use this private object avoiding unpredictable consequences, i.e. errors.</li>
<li><code>transLocLhs</code> <br  />
 This private member object also of type MatrixDouble is used to assemble the transpose of locLhs. This object is used only in function doWork() so it is also declared as a private object of the class OpDomainLhs.</li>
<li><code>CHKERR MatSetValues</code> <br  />
 The code part is as follows: <div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">       getKSPB(), row_data, col_data, &amp;locLhs(0, 0), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// Fill values of symmetric local stiffness matrix</span></div>
<div class="line">   <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">     transLocLhs.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">     noalias(transLocLhs) = trans(locLhs);</div>
<div class="line">     <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">         getKSPB(), col_data, row_data, &amp;transLocLhs(0, 0), ADD_VALUES);</div>
</div><!-- fragment --> The function MatSetValues() is used to assemble into the global matrix. This function sets values for the global matrix using inputs like getKSPB(), row_data, col_data, and the memory address of the local stiffness matrix's and also address of the first component &amp;locLhs(0, 0). The ADD_VALUES flag is used to add values during the assembly. Transposing is performed for the symmetric global matrix which is then solved using the iterative linear solver KSP.</li>
</ul>
<h3><a class="anchor" id="OpDomainRhs"></a>
OpDomainRhs()</h3>
<p >The characterization of <code>OpDomainRhs</code> is straightforward and also aligns with <code>OpDomainRhsVectorF</code> in the context of SCL-1 for solving <a class="el" href="struct_poisson.html">Poisson</a>'s equation with homogeneous BC. However, there is a slight difference in the body source term. The accompanying code snippet illustrates in the following:</p>
<div class="fragment"><div class="line"><span class="keyword">struct </span>OpDomainRhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  OpDomainRhs(std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, ScalarFunc source_term_function)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>::OPROW),</div>
<div class="line">        sourceTermFunc(source_term_function) {}</div>
<div class="line"> </div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_mo_f_e_m_1_1_data_operator.html#a19219f04bba3938fd893898f128dcfb2">doWork</a>(<span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_dofs) {</div>
<div class="line"> </div>
<div class="line">      locRhs.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">      locRhs.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get element area</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> area = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line">      <span class="comment">// get coordinates of the integration point</span></div>
<div class="line">      <span class="keyword">auto</span> t_coords = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5022d618bbaf375d0a07588e50a297a5">getFTensor1CoordsAtGaussPts</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get base functions</span></div>
<div class="line">      <span class="keyword">auto</span> t_base = data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL VECTOR</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * area;</div>
<div class="line">        <span class="keywordtype">double</span> body_source =</div>
<div class="line">            sourceTermFunc(t_coords(0), t_coords(1), t_coords(2));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; rr++) {</div>
<div class="line"> </div>
<div class="line">          locRhs[rr] += t_base * body_source * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to the next base function</span></div>
<div class="line">          ++t_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">        <span class="comment">// move to the coordinates of the next integration point</span></div>
<div class="line">        ++t_coords;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF THE GLOBAL VECTOR ENTRIES FROM THE LOCAL ONES</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5776797a630374d6b06e3aea772cdc39">getKSPf</a>(), data, &amp;*locRhs.begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a> sourceTermFunc;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> locRhs;</div>
<div class="line">};</div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition:</b> <a href="_types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition:</b> <a href="_entities_field_data_8hpp_source.html#l01489">EntitiesFieldData.hpp:1489</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_a5022d618bbaf375d0a07588e50a297a5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5022d618bbaf375d0a07588e50a297a5">MoFEM::ForcesAndSourcesCore::UserDataOperator::getFTensor1CoordsAtGaussPts</a></div><div class="ttdeci">auto getFTensor1CoordsAtGaussPts()</div><div class="ttdoc">Get coordinates at integration points assuming linear geometry.</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01265">ForcesAndSourcesCore.hpp:1265</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_a5776797a630374d6b06e3aea772cdc39"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5776797a630374d6b06e3aea772cdc39">MoFEM::ForcesAndSourcesCore::UserDataOperator::getKSPf</a></div><div class="ttdeci">Vec getKSPf() const</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l01084">ForcesAndSourcesCore.hpp:1084</a></div></div>
</div><!-- fragment --><p >In the above snippet, we can find a different <code>body_source</code> term which is calculated by calling a Lambda function <code>sourceTermFunc()</code> with coordinate(x, y, z) i.e. t_coords(0), t_coords(1), and t_coords(2) as arguments as follows: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> body_source =</div>
<div class="line">            sourceTermFunc(t_coords(0), t_coords(1), t_coords(2));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; rr++) {</div>
<div class="line"> </div>
<div class="line">          locRhs[rr] += t_base * body_source * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to the next base function</span></div>
<div class="line">          ++t_base;</div>
<div class="line">        }</div>
</div><!-- fragment --><h3><a class="anchor" id="OpBoundaryLhs"></a>
OpBoundaryLhs()</h3>
<p ><code>OpBoundaryLhs</code> is focusing on the boundary( \( \Gamma\)) instead of the domain. So we're using OpEdgeEle instead of OpFaceEle. You can realize the fact easily that for 2D problems any boundary element type should be edge(1D) and for 3D problems it will be face(2D) type element.This operator is quite similar to our first operator, OpDomainLhs. Therefore we are not describing it again. Further, the code snippet is here: </p><div class="fragment"><div class="line"><span class="keyword">struct </span>OpBoundaryLhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  OpBoundaryLhs(std::string row_field_name, std::string col_field_name)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a>(row_field_name, col_field_name, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a>::OPROWCOL) {</div>
<div class="line">    sYmm = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_mo_f_e_m_1_1_data_operator.html#a19219f04bba3938fd893898f128dcfb2">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                        <a class="code hl_class" href="class_entity_type.html">EntityType</a> col_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_row_dofs = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col_dofs = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_row_dofs &amp;&amp; nb_col_dofs) {</div>
<div class="line"> </div>
<div class="line">      locBoundaryLhs.resize(nb_row_dofs, nb_col_dofs, <span class="keyword">false</span>);</div>
<div class="line">      locBoundaryLhs.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get (boundary) element length</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> edge = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get base functions on row</span></div>
<div class="line">      <span class="keyword">auto</span> t_row_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL MATRIX</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * edge;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_row_dofs; ++rr) {</div>
<div class="line">          <span class="comment">// get base functions on column</span></div>
<div class="line">          <span class="keyword">auto</span> t_col_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nb_col_dofs; cc++) {</div>
<div class="line"> </div>
<div class="line">            locBoundaryLhs(rr, cc) += t_row_base * t_col_base * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// move to the next base functions on column</span></div>
<div class="line">            ++t_col_base;</div>
<div class="line">          }</div>
<div class="line">          <span class="comment">// move to the next base functions on row</span></div>
<div class="line">          ++t_row_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF LOCAL MATRIX ENTRIES TO THE GLOBAL MATRIX</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), row_data, col_data, &amp;locBoundaryLhs(0, 0), ADD_VALUES);</div>
<div class="line">      <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">        transLocBoundaryLhs.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(transLocBoundaryLhs) = trans(locBoundaryLhs);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">            <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), col_data, row_data, &amp;transLocBoundaryLhs(0, 0),</div>
<div class="line">            ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> locBoundaryLhs, transLocBoundaryLhs;</div>
<div class="line">};</div>
</div><!-- fragment --><h3><a class="anchor" id="OpBoundaryRhs"></a>
OpBoundaryRhs()</h3>
<p >If we compare the OpBoundaryRhs operator, it also closely resembles the OpDomainRhsVectorF operator in its structure. Additionally, it is also similar to OpBoundaryRhs. However, we are now using boundary_term here instead of body_source as follows: </p><div class="fragment"><div class="line"><span class="keywordtype">double</span> boundary_term =</div>
<div class="line">     boundaryFunc(t_coords(0), t_coords(1), t_coords(2));</div>
<div class="line"> </div>
<div class="line"> <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; rr++) {</div>
<div class="line"> </div>
<div class="line">   locBoundaryRhs[rr] += t_base * boundary_term * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">   <span class="comment">// move to the next base function</span></div>
<div class="line">   ++t_base;</div>
<div class="line"> }</div>
</div><!-- fragment --><h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_source_code"></a>
Main program (*.cpp)</h2>
<p >This main class <a class="el" href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a> contains functions each of which is responsible for a certain task as described in SCL-1. However, in this case, we need to declare two functions as a global variable of <code>sourceTermFunction</code> and <code>boundaryFunction</code>. These functions are applicable for the operators OpDomainRhs and OpBoundaryRhs respectively. In addition to that, we have declared a vector type shared pointer 'boundaryMarker'. We will use and discuss while applying the boundary condition. The code snippet is as follows: </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Declaration of the main function to run analysis</span></div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a8fd4a5738ca3527b2c288e83f1018994">runProgram</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="comment">// Declaration of other main functions called in runProgram()</span></div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">readMesh</a>();</div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a4a01a670bbb2072de569c20f53d27e42">setupProblem</a>();</div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a5b1f7d6f2e4dadbacdb2357a9ede0244">boundaryCondition</a>();</div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ae28677eb3db87facbca9273b838801dd">assembleSystem</a>();</div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a3e2d0c8dc97457ffd8b5e8cdf64e822e">setIntegrationRules</a>();</div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a2bd9876fc2bfe8f82bfe478f75ac21e2">solveSystem</a>();</div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#aa39da8111ef21e494ba2859fd2553292">outputResults</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Function to calculate the Source term</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a452b4e71e7a3e6b7529220cb0795a0fb">sourceTermFunction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y,</div>
<div class="line">                                   <span class="keyword">const</span> <span class="keywordtype">double</span> z) {</div>
<div class="line">    <span class="keywordflow">return</span> 200 * sin(x * 10.) * cos(y * 10.);</div>
<div class="line">    <span class="comment">// return 1;</span></div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Function to calculate the Boundary term</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a0baa354c1d3bfdc7fae8e964cff3d39e">boundaryFunction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y,</div>
<div class="line">                                 <span class="keyword">const</span> <span class="keywordtype">double</span> z) {</div>
<div class="line">    <span class="keywordflow">return</span> sin(x * 10.) * cos(y * 10.);</div>
<div class="line">    <span class="comment">// return 0;</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Main interfaces</span></div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>;</div>
<div class="line">  Simple *<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Field name and approximation order</span></div>
<div class="line">  std::string <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>;</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Object to mark boundary entities for the assembling of domain elements</span></div>
<div class="line">  boost::shared_ptr&lt;std::vector&lt;unsigned char&gt;&gt; <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Boundary entities marked for fieldsplit (block) solver - optional</span></div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a88a21e50e82c2815fbef79717d487566">boundaryEntitiesForFieldsplit</a>;</div>
<div class="line">};</div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a></div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00012">poisson_2d_nonhomogeneous.cpp:12</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a0baa354c1d3bfdc7fae8e964cff3d39e"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a0baa354c1d3bfdc7fae8e964cff3d39e">Poisson2DNonhomogeneous::boundaryFunction</a></div><div class="ttdeci">static double boundaryFunction(const double x, const double y, const double z)</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00036">poisson_2d_nonhomogeneous.cpp:36</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a2bd9876fc2bfe8f82bfe478f75ac21e2"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a2bd9876fc2bfe8f82bfe478f75ac21e2">Poisson2DNonhomogeneous::solveSystem</a></div><div class="ttdeci">MoFEMErrorCode solveSystem()</div><div class="ttdoc">[Set integration rules]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00180">poisson_2d_nonhomogeneous.cpp:180</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a33496969fffb8d9232b918f3ccf8286d"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">Poisson2DNonhomogeneous::oRder</a></div><div class="ttdeci">int oRder</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00048">poisson_2d_nonhomogeneous.cpp:48</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a3e2d0c8dc97457ffd8b5e8cdf64e822e"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a3e2d0c8dc97457ffd8b5e8cdf64e822e">Poisson2DNonhomogeneous::setIntegrationRules</a></div><div class="ttdeci">MoFEMErrorCode setIntegrationRules()</div><div class="ttdoc">[Assemble system]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00160">poisson_2d_nonhomogeneous.cpp:160</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a452b4e71e7a3e6b7529220cb0795a0fb"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a452b4e71e7a3e6b7529220cb0795a0fb">Poisson2DNonhomogeneous::sourceTermFunction</a></div><div class="ttdeci">static double sourceTermFunction(const double x, const double y, const double z)</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00030">poisson_2d_nonhomogeneous.cpp:30</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a4a01a670bbb2072de569c20f53d27e42"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a4a01a670bbb2072de569c20f53d27e42">Poisson2DNonhomogeneous::setupProblem</a></div><div class="ttdeci">MoFEMErrorCode setupProblem()</div><div class="ttdoc">[Read mesh]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00072">poisson_2d_nonhomogeneous.cpp:72</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a5b1f7d6f2e4dadbacdb2357a9ede0244"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a5b1f7d6f2e4dadbacdb2357a9ede0244">Poisson2DNonhomogeneous::boundaryCondition</a></div><div class="ttdeci">MoFEMErrorCode boundaryCondition()</div><div class="ttdoc">[Setup problem]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00090">poisson_2d_nonhomogeneous.cpp:90</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a88a21e50e82c2815fbef79717d487566"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a88a21e50e82c2815fbef79717d487566">Poisson2DNonhomogeneous::boundaryEntitiesForFieldsplit</a></div><div class="ttdeci">Range boundaryEntitiesForFieldsplit</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00054">poisson_2d_nonhomogeneous.cpp:54</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a8ba327105b7e5fbe510c73a51fc98147"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">Poisson2DNonhomogeneous::boundaryMarker</a></div><div class="ttdeci">boost::shared_ptr&lt; std::vector&lt; unsigned char &gt; &gt; boundaryMarker</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00051">poisson_2d_nonhomogeneous.cpp:51</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a8fd4a5738ca3527b2c288e83f1018994"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a8fd4a5738ca3527b2c288e83f1018994">Poisson2DNonhomogeneous::runProgram</a></div><div class="ttdeci">MoFEMErrorCode runProgram()</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00260">poisson_2d_nonhomogeneous.cpp:260</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a9e3689ec8249b32acf7080dd0209aa4e"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">Poisson2DNonhomogeneous::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00043">poisson_2d_nonhomogeneous.cpp:43</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_aa39da8111ef21e494ba2859fd2553292"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#aa39da8111ef21e494ba2859fd2553292">Poisson2DNonhomogeneous::outputResults</a></div><div class="ttdeci">MoFEMErrorCode outputResults()</div><div class="ttdoc">[Solve system]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00231">poisson_2d_nonhomogeneous.cpp:231</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_ad363b70735aaefeab27e969f3a4ffe4f"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">Poisson2DNonhomogeneous::readMesh</a></div><div class="ttdeci">MoFEMErrorCode readMesh()</div><div class="ttdoc">[Read mesh]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00060">poisson_2d_nonhomogeneous.cpp:60</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_ae28677eb3db87facbca9273b838801dd"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#ae28677eb3db87facbca9273b838801dd">Poisson2DNonhomogeneous::assembleSystem</a></div><div class="ttdeci">MoFEMErrorCode assembleSystem()</div><div class="ttdoc">[Boundary condition]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00108">poisson_2d_nonhomogeneous.cpp:108</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_aea9139d458166ceb57b23e6f96c278ae"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">Poisson2DNonhomogeneous::domainField</a></div><div class="ttdeci">std::string domainField</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00047">poisson_2d_nonhomogeneous.cpp:47</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_af6a1da973cfc717028d17e8044ba3d3c"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">Poisson2DNonhomogeneous::simpleInterface</a></div><div class="ttdeci">Simple * simpleInterface</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00044">poisson_2d_nonhomogeneous.cpp:44</a></div></div>
</div><!-- fragment --> <h3><a class="anchor" id="readMesh"></a>
readMesh()</h3>
<p >Next, this code defines function in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> to loads and reads your mesh file. </p><div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">Poisson2DNonhomogeneous::readMesh</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;getOptions();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;loadFile();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface refernce to pointer of interface.</div><div class="ttdef"><b>Definition:</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="setupProblem"></a>
setupProblem()</h3>
<p >Since we are considering both domain and boundary, we need to add the domain and boundary field in the simpleInterface to setup the problem. Besides, we have selected the polynomial base function as <code>AINSWORTH_BERNSTEIN_BEZIER_BASE</code> and \( \mathbf{H^1}\) scalar space, where we are considering single(1) degree of freedom for each shape function has </p><div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a4a01a670bbb2072de569c20f53d27e42">Poisson2DNonhomogeneous::setupProblem</a>() {</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;addDomainField(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line"><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;addBoundaryField(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line"><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a> = 3;</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsGetInt(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a>, PETSC_NULL);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;setFieldOrder(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a>);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;setUp();</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a></div><div class="ttdeci">@ AINSWORTH_BERNSTEIN_BEZIER_BASE</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00065">definitions.h:64</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
</div><!-- fragment --><h3><a class="anchor" id="boundaryCondition"></a>
boundaryCondition()</h3>
<p >Next, we are proceeding to discuss the detail for setting up boundary condition. This code involves marking degrees of freedom on boundary entities, merging markers, and obtaining entities for field splitting in the following: </p><div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a5b1f7d6f2e4dadbacdb2357a9ede0244">Poisson2DNonhomogeneous::boundaryCondition</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;BcManager&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;pushMarkDOFsOnEntities(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;getProblemName(),</div>
<div class="line">                                        <span class="stringliteral">&quot;BOUNDARY_CONDITION&quot;</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, 0, 1,</div>
<div class="line">                                        <span class="keyword">true</span>);</div>
<div class="line">  <span class="comment">// merge markers from all blocksets &quot;BOUNDARY_CONDITION&quot;</span></div>
<div class="line">  <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a> = bc_mng-&gt;getMergedBlocksMarker({<span class="stringliteral">&quot;BOUNDARY_CONDITION&quot;</span>});</div>
<div class="line">  <span class="comment">// get entities on blocksets &quot;BOUNDARY_CONDITION&quot;</span></div>
<div class="line">  <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a88a21e50e82c2815fbef79717d487566">boundaryEntitiesForFieldsplit</a> =</div>
<div class="line">      bc_mng-&gt;getMergedBlocksRange({<span class="stringliteral">&quot;BOUNDARY_CONDITION&quot;</span>});</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p >The line <code>bc_mng-&gt;pushMarkDOFsOnEntities(...)</code> is used to collect the degrees of freedom (DOFs) of the entities only for marked block set <code>("BOUNDARY_CONDITION")</code>. Then, the block sets are accumulated as in container and assembled in boundaryMarker. In addition, the `<code>boundaryEntitiesForFieldsplit</code> is to get the range/IDs for the blocks including vertex, edges or faces. It has been done to indicate the difference between the domain and boundary entities.</p>
<h3><a class="anchor" id="assembleSystem"></a>
assembleSystem()</h3>
<p >At this stage, we are all set to focus on assembling all we did before to the pipeline. However, we find some changes that happens here in codes compared with <a class="el" href="basic_tutorials_poisson_nonhomogeneous.html">SCL-2: Poisson's equation (non-homogeneous BC)</a>. Before going to that, first we add operators to the OpDomainLhsPipeline using the <code>AddHOOps</code> function considering scalar space H1. Then we need to assemble to the pipeline for the domain using OpSetBc. Then push the main <code>OpDomainLhs</code> operator, and finally unset the assembly using OpUnSetBc. We will discuss it in detail after going through the code snippet in the following:</p>
<div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ae28677eb3db87facbca9273b838801dd">Poisson2DNonhomogeneous::assembleSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pipeline_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;PipelineManager&gt;();</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating LHS of</span></div>
<div class="line">    <span class="comment">// domain elements</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">        pipeline_mng-&gt;getOpDomainLhsPipeline(), {H1});</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">true</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpDomainLhs(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpUnSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating RHS of</span></div>
<div class="line">    <span class="comment">// domain elements</span></div>
<div class="line">    pipeline_mng-&gt;getOpDomainRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">true</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpDomainRhs(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a452b4e71e7a3e6b7529220cb0795a0fb">sourceTermFunction</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpUnSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating LHS of</span></div>
<div class="line">    <span class="comment">// boundary elements</span></div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">false</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpBoundaryLhs(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpUnSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating RHS of</span></div>
<div class="line">    <span class="comment">// boundary elements</span></div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">false</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpBoundaryRhs(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a0baa354c1d3bfdc7fae8e964cff3d39e">boundaryFunction</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpUnSetBc(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p >Here, the process involves using the <code>OpSetBc</code>, <code>OpUnSetBc</code>, and UDOs to push back to the RHS and LHS pipelines for assembling. Specifically, these operations are being carried out on the pipeline for the Domain and boundary in same way i.e. <code>getOpDomainLhsPipeline()</code>, <code>OpBoundaryLhsPipeline</code>. So we are only describing for only one set of assemble processes in the following:</p>
<p >The <code>OpSetBc()</code> object is responsible for assembling only for the boundary entities or everything except the boundary. In other words, when it is flagged 'true' it focuses exclusively on the domain entities and does not account for boundary entities tagged with the 'boundaryMarker. </p><div class="fragment"><div class="line">{ <span class="comment">// Push operators to the Pipeline that is responsible for calculating LHS of</span></div>
<div class="line">    <span class="comment">// domain elements</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">      pipeline_mng-&gt;getOpDomainLhsPipeline(), {H1});</div>
<div class="line"> </div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpSetBc(domainField, <span class="keyword">true</span>, boundaryMarker));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpDomainLhs(domainField, domainField));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpUnSetBc(domainField));</div>
<div class="line">  }</div>
</div><!-- fragment --><p >For example, when we assemble for the boundary, first we use <code>OpSetBc()</code>, then add <code>OpBoundaryLhs</code> and <code>OpUnSetBc</code> to the <code>getOpBoundaryLhsPipeline()</code> and <code>getOpBoundaryLhsPipeline</code>. To be noted that it's important to set the flag as <code>false</code> here.</p>
<blockquote class="doxtable">
<p >To recapitulate, when we are assembling for the domain, <code>OpSetBc()</code> works for skipping(marked'true' to skip boundary) the boundary entities. On the other hand, it considers only the boundaries (marked 'false' to consider) when assembling only for boundary. And then push the UDO. Then OpUnSetBc() is used to set the index to the entities as it was initially. </p>
</blockquote>
<h3><a class="anchor" id="setIntegrationRules"></a>
setIntegrationRules()</h3>
<p >Afterwards, the computation of LHS and RHS is defined in the setIntegrationRules. The instructions for the functions setIntegrationRules() is same as it was in <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>. </p><div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a3e2d0c8dc97457ffd8b5e8cdf64e822e">Poisson2DNonhomogeneous::setIntegrationRules</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pipeline_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;PipelineManager&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> domain_rule_lhs = [](int, int, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * (<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> - 1); };</div>
<div class="line">  <span class="keyword">auto</span> domain_rule_rhs = [](int, int, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * (<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> - 1); };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainLhsIntegrationRule(domain_rule_lhs);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainRhsIntegrationRule(domain_rule_rhs);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> boundary_rule_lhs = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>; };</div>
<div class="line">  <span class="keyword">auto</span> boundary_rule_rhs = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>; };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(boundary_rule_lhs);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(boundary_rule_rhs);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="a_basic_fe_tools_8hpp_html_a9af7d9ad959b4605c5f0bab2f104c2fb"><div class="ttname"><a href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a></div><div class="ttdeci">static Index&lt; 'p', 3 &gt; p</div><div class="ttdef"><b>Definition:</b> <a href="_basic_fe_tools_8hpp_source.html#l00090">BasicFeTools.hpp:90</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a4db4d50b047acc94e54fdf4df9f3077c"><div class="ttname"><a href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">convert.int</a></div><div class="ttdeci">int</div><div class="ttdef"><b>Definition:</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
</div><!-- fragment --> <h3><a class="anchor" id="solveSystem"></a>
solveSystem()</h3>
<p >To solve the problem, we remember that we made our assembling systems ready using the set/unseting process in boundaryCondition() for domain and boundaries as shown in Figure: 2 where we can consider the subscripts 'D' is for domain and 'B' for boundary. <a class="anchor" id="figure_poisson_nonhomogeneous_problem"></a></p><div class="image">
<img src="non-homogenous_poission_Matrix.png" alt="" width="400px"/>
<div class="caption">
Figure 2: Solving approach</div></div>
<p >At this stage, we are not solving the system of equations directly using KSP solver as we did in <a class="el" href="basic_tutorials_poisson_homogeneous.html">SCL-1: Poisson's equation (homogeneous BC)</a>. Instead of that, we are proceeding to deploy a preconditioner to the solver named <code>FIELDSPLIT</code>. It splits the fields for domain and boundary as an option - yes/no if needed. The part of the code is as follows: </p><div class="fragment"><div class="line"><span class="comment">// Setup fieldsplit (block) solver - optional: yes/no</span></div>
<div class="line"><span class="keywordflow">if</span> (1) {</div>
<div class="line">  PC pc;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(ksp_solver, &amp;pc);</div>
<div class="line">  PetscBool is_pcfs = PETSC_FALSE;</div>
<div class="line">  PetscObjectTypeCompare((PetscObject)pc, PCFIELDSPLIT, &amp;is_pcfs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Set up FIELDSPLIT, only when user set -pc_type fieldsplit</span></div>
<div class="line">  <span class="comment">// Identify the index for boundary entities, remaining will be for domain</span></div>
<div class="line">  <span class="comment">// Then split the fields for boundary and domain for solving</span></div>
<div class="line">  <span class="keywordflow">if</span> (is_pcfs == PETSC_TRUE) {</div>
<div class="line">    IS is_domain, is_boundary;</div>
<div class="line">    <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">MoFEM::Problem</a> *problem_ptr;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMGetProblemPtr(dm, &amp;problem_ptr);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.getInterface&lt;ISManager&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line">        problem_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, domainField, 0, 1, &amp;is_boundary,</div>
<div class="line">        &amp;boundaryEntitiesForFieldsplit);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is_boundary);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;is_boundary);</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00123">definitions.h:123</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html">MoFEM::Problem</a></div><div class="ttdoc">keeps basic data about problem</div><div class="ttdef"><b>Definition:</b> <a href="_problems_multi_indices_8hpp_source.html#l00054">ProblemsMultiIndices.hpp:54</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html_ac27123017bcc40cd4259e674a7318b3c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html#ac27123017bcc40cd4259e674a7318b3c">MoFEM::Problem::getName</a></div><div class="ttdeci">auto getName() const</div><div class="ttdef"><b>Definition:</b> <a href="_problems_multi_indices_8hpp_source.html#l00372">ProblemsMultiIndices.hpp:372</a></div></div>
</div><!-- fragment --><p >The algorithm for the above code is to check whether the indices in the field were marked for domain or boundary. It set up the field-split solver using PETSc libraries for boundary entities(<code>boundaryEntitiesForFieldsplit</code>) and the remaining will be for the domain. During the iteration process, <code>IS</code> considers solving the option for domain and boundary so that the index sets are then used to configure the <code>PCFIELDSPLIT</code> solver to solve the appropriate blockset. Finally, the code releases the memory associated with the boundary index set and goes for KSP to solve. And to accumulate all these we followed by <code>VecGhostUpdateBegin()</code>, <code>VecGhostUpdateEnd()</code> and <code>DMoFEMMeshToLocalVector</code> to make things ready before getting the results.</p>
<div class="fragment"><div class="line"> <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(ksp_solver);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Solve the system</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(ksp_solver, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Scatter result data on the mesh</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMMeshToLocalVector(dm, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition:</b> <a href="free__surface_8cpp_source.html#l00394">free_surface.cpp:394</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition:</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
</div><!-- fragment --><p >The rest of the code including <code>outputResults()</code> and main function does the same as <a class="el" href="basic_tutorials_poisson_nonhomogeneous.html">SCL-2: Poisson's equation (non-homogeneous BC)</a> </p><div class="fragment"><div class="line">MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">Poisson2DNonhomogeneous::readMesh</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;getOptions();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;loadFile();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
</div><!-- fragment --><p> Then, run the analysis and get the newly created output file, namely <code>out_result.h5m</code>. Convert it to <code>*.vtk</code> format. Then open it in Paraview and use the filter <code>WarpByScalar</code>, you will be able to see the deformation as bellow:</p>
<h1><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_result"></a>
Results</h1>
<p ><a class="anchor" id="figure_poisson_nonhomogeneous"></a></p><div class="image">
<img src="poisson_nonhomogeneous.png" alt="" width="600px"/>
<div class="caption">
Figure 3: Poisson nonhomogeneous visualisation. Source term: 200sin(10x)cos(10y), boundary function: sin(10x)cos(10y)</div></div>
<p >Further requisite: <a href="https://en.wikiversity.org/wiki/Partial_differential_equations/Poisson_Equation">https://en.wikiversity.org/wiki/Partial_differential_equations/Poisson_Equation</a>.</p>
<h1><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_plain_program"></a>
Plain program</h1>
<p >The plain program for both the implementation of the UDOs (<code>*</code>.hpp) and the main program (<code>*</code>.cpp) are as follows</p>
<h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_impl_udo"></a>
Implementation of User Data Operators (*.hpp)</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#ifndef __POISSON2DNONHOMOGENEOUS_HPP__</span></div>
<div class="line"><span class="preprocessor">#define __POISSON2DNONHOMOGENEOUS_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">FaceEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">MoFEM::FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core.html">EdgeEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core.html">MoFEM::EdgeElementForcesAndSourcesCore</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> = EntitiesFieldData::EntData;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_poisson2_d_nonhomogeneous_operators.html">Poisson2DNonhomogeneousOperators</a> {</div>
<div class="line"> </div>
<div class="line"><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index&lt;'i', 2&gt;</a> <a class="code hl_variable" href="namespace_poisson2_d_nonhomogeneous_operators.html#aeef92563540fd05ef13a932c02c13a96">i</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">typedef</span> boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">    <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a>;<span class="comment"></span></div>
<div class="line"><span class="comment">//! [OpDomainLhs]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">struct </span>OpDomainLhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  OpDomainLhs(std::string row_field_name, std::string col_field_name)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>(row_field_name, col_field_name, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>::<a class="code hl_enumvalue" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">OPROWCOL</a>) {</div>
<div class="line">    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_data_operator.html#a300b85aefcf2cf7203ada5d6d501f25f">sYmm</a> = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  MoFEMErrorCode <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#a7f84f33633150402ab3daea47579300a">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                        <a class="code hl_class" href="class_entity_type.html">EntityType</a> col_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_row_dofs = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col_dofs = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_row_dofs &amp;&amp; nb_col_dofs) {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">locLhs</a>.resize(nb_row_dofs, nb_col_dofs, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">locLhs</a>.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get element area</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> area = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get derivatives of base functions on row</span></div>
<div class="line">      <span class="keyword">auto</span> t_row_diff_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;2&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL MATRIX</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * area;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_row_dofs; ++rr) {</div>
<div class="line">          <span class="comment">// get derivatives of base functions on column</span></div>
<div class="line">          <span class="keyword">auto</span> t_col_diff_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;2&gt;(gg, 0);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nb_col_dofs; cc++) {</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">locLhs</a>(rr, cc) += t_row_diff_base(<a class="code hl_variable" href="namespace_poisson2_d_nonhomogeneous_operators.html#aeef92563540fd05ef13a932c02c13a96">i</a>) * t_col_diff_base(<a class="code hl_variable" href="namespace_poisson2_d_nonhomogeneous_operators.html#aeef92563540fd05ef13a932c02c13a96">i</a>) * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// move to the derivatives of the next base functions on column</span></div>
<div class="line">            ++t_col_diff_base;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to the derivatives of the next base functions on row</span></div>
<div class="line">          ++t_row_diff_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF LOCAL MATRIX ENTRIES TO THE GLOBAL MATRIX</span></div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Fill value to local stiffness matrix ignoring boundary DOFs</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), row_data, col_data, &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">locLhs</a>(0, 0), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Fill values of symmetric local stiffness matrix</span></div>
<div class="line">      <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">        <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#ac4ae0a0e6e14d3a8eb1df9686025f4b5">transLocLhs</a>.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#ac4ae0a0e6e14d3a8eb1df9686025f4b5">transLocLhs</a>) = trans(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">locLhs</a>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">            <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), col_data, row_data, &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#ac4ae0a0e6e14d3a8eb1df9686025f4b5">transLocLhs</a>(0, 0), ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  boost::shared_ptr&lt;std::vector&lt;unsigned char&gt;&gt; <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#a5b01530186e45e9693011c77123f5f53">boundaryMarker</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">locLhs</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#ac4ae0a0e6e14d3a8eb1df9686025f4b5">transLocLhs</a>;</div>
<div class="line">};<span class="comment"></span></div>
<div class="line"><span class="comment">//! [OpDomainLhs]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [OpDomainRhs]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">struct </span>OpDomainRhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a585b7b2873ee976a471df8c8e3bd72ab">OpDomainRhs</a>(std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a> source_term_function)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">OpFaceEle</a>::<a class="code hl_enumvalue" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">OPROW</a>),</div>
<div class="line">        <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a3fa746c4b0bb6e736df0b2407ac01bce">sourceTermFunc</a>(source_term_function) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#afde76f5aaa53e245908cec7789369617">doWork</a>(<span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_dofs) {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a2bee5328590f59af59006ccf39968986">locRhs</a>.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a2bee5328590f59af59006ccf39968986">locRhs</a>.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get element area</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> area = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line">      <span class="comment">// get coordinates of the integration point</span></div>
<div class="line">      <span class="keyword">auto</span> t_coords = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5022d618bbaf375d0a07588e50a297a5">getFTensor1CoordsAtGaussPts</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get base functions</span></div>
<div class="line">      <span class="keyword">auto</span> t_base = data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL VECTOR</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * area;</div>
<div class="line">        <span class="keywordtype">double</span> <a class="code hl_variable" href="namespace_poisson_ops.html#af5cb3ad1a859025d5c087de7861455f1">body_source</a> =</div>
<div class="line">            <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a3fa746c4b0bb6e736df0b2407ac01bce">sourceTermFunc</a>(t_coords(0), t_coords(1), t_coords(2));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; rr++) {</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a2bee5328590f59af59006ccf39968986">locRhs</a>[rr] += t_base * <a class="code hl_variable" href="namespace_poisson_ops.html#af5cb3ad1a859025d5c087de7861455f1">body_source</a> * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to the next base function</span></div>
<div class="line">          ++t_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">        <span class="comment">// move to the coordinates of the next integration point</span></div>
<div class="line">        ++t_coords;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF THE GLOBAL VECTOR ENTRIES FROM THE LOCAL ONES</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5776797a630374d6b06e3aea772cdc39">getKSPf</a>(), data, &amp;*<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a2bee5328590f59af59006ccf39968986">locRhs</a>.begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a3fa746c4b0bb6e736df0b2407ac01bce">sourceTermFunc</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a2bee5328590f59af59006ccf39968986">locRhs</a>;</div>
<div class="line">};<span class="comment"></span></div>
<div class="line"><span class="comment">//! [OpDomainRhs]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [OpBoundaryLhs]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">struct </span>OpBoundaryLhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#adff0fb71bcc294049a5d455239bbe059">OpBoundaryLhs</a>(std::string row_field_name, std::string col_field_name)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a>(row_field_name, col_field_name, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a>::<a class="code hl_enumvalue" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">OPROWCOL</a>) {</div>
<div class="line">    <a class="code hl_variable" href="struct_mo_f_e_m_1_1_data_operator.html#a300b85aefcf2cf7203ada5d6d501f25f">sYmm</a> = <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a96c6831aa87c6644eea6f88b1afecff2">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> row_type,</div>
<div class="line">                        <a class="code hl_class" href="class_entity_type.html">EntityType</a> col_type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_row_dofs = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_col_dofs = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_row_dofs &amp;&amp; nb_col_dofs) {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">locBoundaryLhs</a>.resize(nb_row_dofs, nb_col_dofs, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">locBoundaryLhs</a>.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get (boundary) element length</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> edge = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get base functions on row</span></div>
<div class="line">      <span class="keyword">auto</span> t_row_base = row_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL MATRIX</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * edge;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_row_dofs; ++rr) {</div>
<div class="line">          <span class="comment">// get base functions on column</span></div>
<div class="line">          <span class="keyword">auto</span> t_col_base = col_data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != nb_col_dofs; cc++) {</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">locBoundaryLhs</a>(rr, cc) += t_row_base * t_col_base * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// move to the next base functions on column</span></div>
<div class="line">            ++t_col_base;</div>
<div class="line">          }</div>
<div class="line">          <span class="comment">// move to the next base functions on row</span></div>
<div class="line">          ++t_row_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF LOCAL MATRIX ENTRIES TO THE GLOBAL MATRIX</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), row_data, col_data, &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">locBoundaryLhs</a>(0, 0), ADD_VALUES);</div>
<div class="line">      <span class="keywordflow">if</span> (row_side != col_side || row_type != col_type) {</div>
<div class="line">        <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a5c16c73cc53064d42320cb7d157a1c0e">transLocBoundaryLhs</a>.resize(nb_col_dofs, nb_row_dofs, <span class="keyword">false</span>);</div>
<div class="line">        noalias(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a5c16c73cc53064d42320cb7d157a1c0e">transLocBoundaryLhs</a>) = trans(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">locBoundaryLhs</a>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">            <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae6b967017977d2f79550627e2a6e89bd">getKSPB</a>(), col_data, row_data, &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a5c16c73cc53064d42320cb7d157a1c0e">transLocBoundaryLhs</a>(0, 0),</div>
<div class="line">            ADD_VALUES);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">locBoundaryLhs</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a5c16c73cc53064d42320cb7d157a1c0e">transLocBoundaryLhs</a>;</div>
<div class="line">};<span class="comment"></span></div>
<div class="line"><span class="comment">//! [OpBoundaryLhs]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [OpBoundaryRhs]</span></div>
<div class="line"><span class="comment"></span><span class="keyword">struct </span>OpBoundaryRhs : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#af1acecf5ce6ebe5a1c98235cc6858fb1">OpBoundaryRhs</a>(std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a> boundary_function)</div>
<div class="line">      : <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">OpEdgeEle</a>::<a class="code hl_enumvalue" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">OPROW</a>),</div>
<div class="line">        <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a28ac844ceeebe2e7db6f94a6329d6a75">boundaryFunc</a>(boundary_function) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a439a0b074ee4d436d32833ff57c544fa">doWork</a>(<span class="keywordtype">int</span> side, <a class="code hl_class" href="class_entity_type.html">EntityType</a> type, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_dofs = data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (nb_dofs) {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a799aa16b52bf68762e935e6c1e2ca920">locBoundaryRhs</a>.resize(nb_dofs, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a799aa16b52bf68762e935e6c1e2ca920">locBoundaryRhs</a>.clear();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get (boundary) element length</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> edge = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#aa0f5b68e1ab8bc7e79ea1b3d969eb400">getMeasure</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get number of integration points</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">int</span> nb_integration_points = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ae90a09d3c36b0a4ed9ab1d99fcce0c1d">getGaussPts</a>().size2();</div>
<div class="line">      <span class="comment">// get integration weights</span></div>
<div class="line">      <span class="keyword">auto</span> t_w = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a8d917e73cbaa9f177cdea72e1e7500dd">getFTensor0IntegrationWeight</a>();</div>
<div class="line">      <span class="comment">// get coordinates at integration point</span></div>
<div class="line">      <span class="keyword">auto</span> t_coords = <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5022d618bbaf375d0a07588e50a297a5">getFTensor1CoordsAtGaussPts</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get base function</span></div>
<div class="line">      <span class="keyword">auto</span> t_base = data.<a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// START THE LOOP OVER INTEGRATION POINTS TO CALCULATE LOCAL VECTOR</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != nb_integration_points; gg++) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = t_w * edge;</div>
<div class="line">        <span class="keywordtype">double</span> boundary_term =</div>
<div class="line">            <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a28ac844ceeebe2e7db6f94a6329d6a75">boundaryFunc</a>(t_coords(0), t_coords(1), t_coords(2));</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != nb_dofs; rr++) {</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a799aa16b52bf68762e935e6c1e2ca920">locBoundaryRhs</a>[rr] += t_base * boundary_term * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// move to the next base function</span></div>
<div class="line">          ++t_base;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// move to the weight of the next integration point</span></div>
<div class="line">        ++t_w;</div>
<div class="line">        <span class="comment">// move to the coordinates of the next integration point</span></div>
<div class="line">        ++t_coords;</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// FILL VALUES OF LOCAL VECTOR ENTRIES TO THE GLOBAL VECTOR</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValues&lt;MoFEM::EssentialBcStorage&gt;(</div>
<div class="line">          <a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#a5776797a630374d6b06e3aea772cdc39">getKSPf</a>(), data, &amp;*<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a799aa16b52bf68762e935e6c1e2ca920">locBoundaryRhs</a>.begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_poisson2_d_nonhomogeneous_operators.html#ad9994064117952c0a0f59e9853fb568f">ScalarFunc</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a28ac844ceeebe2e7db6f94a6329d6a75">boundaryFunc</a>;</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a799aa16b52bf68762e935e6c1e2ca920">locBoundaryRhs</a>;</div>
<div class="line">};<span class="comment"></span></div>
<div class="line"><span class="comment">//! [OpBoundaryRhs]</span></div>
<div class="line"><span class="comment"></span>}; <span class="comment">// namespace Poisson2DNonhomogeneousOperators</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//__POISSON2DNONHOMOGENEOUS_HPP__</span></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition:</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_poisson_ops_html_af5cb3ad1a859025d5c087de7861455f1"><div class="ttname"><a href="namespace_poisson_ops.html#af5cb3ad1a859025d5c087de7861455f1">PoissonOps::body_source</a></div><div class="ttdeci">const double body_source</div><div class="ttdef"><b>Definition:</b> <a href="softmech_2poisson__problem_2src_2_poisson_operators_8hpp_source.html#l00021">PoissonOperators.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_data_operator_html_a300b85aefcf2cf7203ada5d6d501f25f"><div class="ttname"><a href="struct_mo_f_e_m_1_1_data_operator.html#a300b85aefcf2cf7203ada5d6d501f25f">MoFEM::DataOperator::sYmm</a></div><div class="ttdeci">bool sYmm</div><div class="ttdoc">If true assume that matrix is symmetric structure.</div><div class="ttdef"><b>Definition:</b> <a href="_data_operators_8hpp_source.html#l00082">DataOperators.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a2d8d202342fada158e521ef00be491e1">MoFEM::ForcesAndSourcesCore::UserDataOperator::OPROW</a></div><div class="ttdeci">@ OPROW</div><div class="ttdoc">operator doWork function is executed on FE rows</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l00564">ForcesAndSourcesCore.hpp:564</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator_html_ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core_1_1_user_data_operator.html#ac99de5ec6fa9bad3ccc5c5d60bc48e40a3884917d2b4b602e2579971b6d56878a">MoFEM::ForcesAndSourcesCore::UserDataOperator::OPROWCOL</a></div><div class="ttdeci">@ OPROWCOL</div><div class="ttdoc">operator doWork is executed on FE rows &amp;columns</div><div class="ttdef"><b>Definition:</b> <a href="_forces_and_sources_core_8hpp_source.html#l00566">ForcesAndSourcesCore.hpp:566</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs_html_a5c16c73cc53064d42320cb7d157a1c0e"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a5c16c73cc53064d42320cb7d157a1c0e">Poisson2DNonhomogeneousOperators::OpBoundaryLhs::transLocBoundaryLhs</a></div><div class="ttdeci">MatrixDouble transLocBoundaryLhs</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00238">poisson_2d_nonhomogeneous.hpp:238</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs_html_a96c6831aa87c6644eea6f88b1afecff2"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#a96c6831aa87c6644eea6f88b1afecff2">Poisson2DNonhomogeneousOperators::OpBoundaryLhs::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Operator for bi-linear form, usually to calculate values on left hand side.</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00175">poisson_2d_nonhomogeneous.hpp:175</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs_html_abc3b76ed05854207648b36fca29af288"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#abc3b76ed05854207648b36fca29af288">Poisson2DNonhomogeneousOperators::OpBoundaryLhs::locBoundaryLhs</a></div><div class="ttdeci">MatrixDouble locBoundaryLhs</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00238">poisson_2d_nonhomogeneous.hpp:238</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs_html_adff0fb71bcc294049a5d455239bbe059"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html#adff0fb71bcc294049a5d455239bbe059">Poisson2DNonhomogeneousOperators::OpBoundaryLhs::OpBoundaryLhs</a></div><div class="ttdeci">OpBoundaryLhs(std::string row_field_name, std::string col_field_name)</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00170">poisson_2d_nonhomogeneous.hpp:170</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs_html_a28ac844ceeebe2e7db6f94a6329d6a75"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a28ac844ceeebe2e7db6f94a6329d6a75">Poisson2DNonhomogeneousOperators::OpBoundaryRhs::boundaryFunc</a></div><div class="ttdeci">ScalarFunc boundaryFunc</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00302">poisson_2d_nonhomogeneous.hpp:302</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs_html_a439a0b074ee4d436d32833ff57c544fa"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a439a0b074ee4d436d32833ff57c544fa">Poisson2DNonhomogeneousOperators::OpBoundaryRhs::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int side, EntityType type, EntData &amp;data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00249">poisson_2d_nonhomogeneous.hpp:249</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs_html_a799aa16b52bf68762e935e6c1e2ca920"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#a799aa16b52bf68762e935e6c1e2ca920">Poisson2DNonhomogeneousOperators::OpBoundaryRhs::locBoundaryRhs</a></div><div class="ttdeci">VectorDouble locBoundaryRhs</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00303">poisson_2d_nonhomogeneous.hpp:303</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs_html_af1acecf5ce6ebe5a1c98235cc6858fb1"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html#af1acecf5ce6ebe5a1c98235cc6858fb1">Poisson2DNonhomogeneousOperators::OpBoundaryRhs::OpBoundaryRhs</a></div><div class="ttdeci">OpBoundaryRhs(std::string field_name, ScalarFunc boundary_function)</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00245">poisson_2d_nonhomogeneous.hpp:245</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs_html_a5b01530186e45e9693011c77123f5f53"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#a5b01530186e45e9693011c77123f5f53">Poisson2DNonhomogeneousOperators::OpDomainLhs::boundaryMarker</a></div><div class="ttdeci">boost::shared_ptr&lt; std::vector&lt; unsigned char &gt; &gt; boundaryMarker</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00097">poisson_2d_nonhomogeneous.hpp:97</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs_html_a7f84f33633150402ab3daea47579300a"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#a7f84f33633150402ab3daea47579300a">Poisson2DNonhomogeneousOperators::OpDomainLhs::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntData &amp;row_data, EntData &amp;col_data)</div><div class="ttdoc">Operator for bi-linear form, usually to calculate values on left hand side.</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00029">poisson_2d_nonhomogeneous.hpp:29</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs_html_aa1676eb8d50f4fa102e154ea2ad11499"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#aa1676eb8d50f4fa102e154ea2ad11499">Poisson2DNonhomogeneousOperators::OpDomainLhs::locLhs</a></div><div class="ttdeci">MatrixDouble locLhs</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00098">poisson_2d_nonhomogeneous.hpp:98</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs_html_ac4ae0a0e6e14d3a8eb1df9686025f4b5"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html#ac4ae0a0e6e14d3a8eb1df9686025f4b5">Poisson2DNonhomogeneousOperators::OpDomainLhs::transLocLhs</a></div><div class="ttdeci">MatrixDouble transLocLhs</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00098">poisson_2d_nonhomogeneous.hpp:98</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs_html_a2bee5328590f59af59006ccf39968986"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a2bee5328590f59af59006ccf39968986">Poisson2DNonhomogeneousOperators::OpDomainRhs::locRhs</a></div><div class="ttdeci">VectorDouble locRhs</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00163">poisson_2d_nonhomogeneous.hpp:163</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs_html_a3fa746c4b0bb6e736df0b2407ac01bce"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a3fa746c4b0bb6e736df0b2407ac01bce">Poisson2DNonhomogeneousOperators::OpDomainRhs::sourceTermFunc</a></div><div class="ttdeci">ScalarFunc sourceTermFunc</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00162">poisson_2d_nonhomogeneous.hpp:162</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs_html_a585b7b2873ee976a471df8c8e3bd72ab"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#a585b7b2873ee976a471df8c8e3bd72ab">Poisson2DNonhomogeneousOperators::OpDomainRhs::OpDomainRhs</a></div><div class="ttdeci">OpDomainRhs(std::string field_name, ScalarFunc source_term_function)</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00105">poisson_2d_nonhomogeneous.hpp:105</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs_html_afde76f5aaa53e245908cec7789369617"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html#afde76f5aaa53e245908cec7789369617">Poisson2DNonhomogeneousOperators::OpDomainRhs::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int side, EntityType type, EntData &amp;data)</div><div class="ttdoc">Operator for linear form, usually to calculate values on right hand side.</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00109">poisson_2d_nonhomogeneous.hpp:109</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="basic_tutorials_poisson_nonhomogeneous_impl_main"></a>
Implementation of the main program (*.cpp)</h2>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdlib.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_basic_finite_elements_8hpp.html">BasicFiniteElements.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="poisson__2d__nonhomogeneous_8hpp.html">poisson_2d_nonhomogeneous.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_poisson2_d_nonhomogeneous_operators.html">Poisson2DNonhomogeneousOperators</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> = 2;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_3_01_face_element_forces_and_sources_core_01_4.html">PostProcFaceEle</a> =</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab.html">PostProcBrokenMeshInMoab&lt;FaceElementForcesAndSourcesCore&gt;</a>;</div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a> {</div>
<div class="line"><span class="keyword">public</span>:</div>
<div class="line">  <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Declaration of the main function to run analysis</span></div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a8fd4a5738ca3527b2c288e83f1018994">runProgram</a>();</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="comment">// Declaration of other main functions called in runProgram()</span></div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">readMesh</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a4a01a670bbb2072de569c20f53d27e42">setupProblem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a5b1f7d6f2e4dadbacdb2357a9ede0244">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ae28677eb3db87facbca9273b838801dd">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a3e2d0c8dc97457ffd8b5e8cdf64e822e">setIntegrationRules</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a2bd9876fc2bfe8f82bfe478f75ac21e2">solveSystem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#aa39da8111ef21e494ba2859fd2553292">outputResults</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Function to calculate the Source term</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a452b4e71e7a3e6b7529220cb0795a0fb">sourceTermFunction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y,</div>
<div class="line">                                   <span class="keyword">const</span> <span class="keywordtype">double</span> z) {</div>
<div class="line">    <span class="keywordflow">return</span> 200 * sin(x * 10.) * cos(y * 10.);</div>
<div class="line">    <span class="comment">// return 1;</span></div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// Function to calculate the Boundary term</span></div>
<div class="line">  <span class="keyword">static</span> <span class="keywordtype">double</span> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a0baa354c1d3bfdc7fae8e964cff3d39e">boundaryFunction</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> x, <span class="keyword">const</span> <span class="keywordtype">double</span> y,</div>
<div class="line">                                 <span class="keyword">const</span> <span class="keywordtype">double</span> z) {</div>
<div class="line">    <span class="keywordflow">return</span> sin(x * 10.) * cos(y * 10.);</div>
<div class="line">    <span class="comment">// return 0;</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Main interfaces</span></div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>;</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a> *<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Field name and approximation order</span></div>
<div class="line">  std::string <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>;</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Object to mark boundary entities for the assembling of domain elements</span></div>
<div class="line">  boost::shared_ptr&lt;std::vector&lt;unsigned char&gt;&gt; <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Boundary entities marked for fieldsplit (block) solver - optional</span></div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a88a21e50e82c2815fbef79717d487566">boundaryEntitiesForFieldsplit</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a2ad05abaeb3d9465b3c0c70bc9c6dbbf">Poisson2DNonhomogeneous::Poisson2DNonhomogeneous</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field)</div>
<div class="line">    : domainField(<span class="stringliteral">&quot;U&quot;</span>), mField(m_field) {}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">Poisson2DNonhomogeneous::readMesh</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;getOptions();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;loadFile();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Setup problem]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a4a01a670bbb2072de569c20f53d27e42">Poisson2DNonhomogeneous::setupProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;addDomainField(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                         <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;addBoundaryField(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,</div>
<div class="line">                                           <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5afd8fcce3bafc9c764ded9e392f2996c5">AINSWORTH_BERNSTEIN_BEZIER_BASE</a>, 1);</div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a> = 3;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;setFieldOrder(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a33496969fffb8d9232b918f3ccf8286d">oRder</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;setUp();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Setup problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a5b1f7d6f2e4dadbacdb2357a9ede0244">Poisson2DNonhomogeneous::boundaryCondition</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;pushMarkDOFsOnEntities(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;getProblemName(),</div>
<div class="line">                                        <span class="stringliteral">&quot;BOUNDARY_CONDITION&quot;</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, 0, 1,</div>
<div class="line">                                        <span class="keyword">true</span>);</div>
<div class="line">  <span class="comment">// merge markers from all blocksets &quot;BOUNDARY_CONDITION&quot;</span></div>
<div class="line">  <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a> = bc_mng-&gt;getMergedBlocksMarker({<span class="stringliteral">&quot;BOUNDARY_CONDITION&quot;</span>});</div>
<div class="line">  <span class="comment">// get entities on blocksets &quot;BOUNDARY_CONDITION&quot;</span></div>
<div class="line">  <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a88a21e50e82c2815fbef79717d487566">boundaryEntitiesForFieldsplit</a> =</div>
<div class="line">      bc_mng-&gt;getMergedBlocksRange({<span class="stringliteral">&quot;BOUNDARY_CONDITION&quot;</span>});</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Assemble system]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ae28677eb3db87facbca9273b838801dd">Poisson2DNonhomogeneous::assembleSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pipeline_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating LHS of</span></div>
<div class="line">    <span class="comment">// domain elements</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        pipeline_mng-&gt;getOpDomainLhsPipeline(), {H1});</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_bc.html">OpSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">true</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html">OpDomainLhs</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_un_set_bc.html">OpUnSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating RHS of</span></div>
<div class="line">    <span class="comment">// domain elements</span></div>
<div class="line">    pipeline_mng-&gt;getOpDomainRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_bc.html">OpSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">true</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html">OpDomainRhs</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a452b4e71e7a3e6b7529220cb0795a0fb">sourceTermFunction</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpDomainRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_un_set_bc.html">OpUnSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating LHS of</span></div>
<div class="line">    <span class="comment">// boundary elements</span></div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_bc.html">OpSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">false</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html">OpBoundaryLhs</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryLhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_un_set_bc.html">OpUnSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  { <span class="comment">// Push operators to the Pipeline that is responsible for calculating RHS of</span></div>
<div class="line">    <span class="comment">// boundary elements</span></div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_bc.html">OpSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <span class="keyword">false</span>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a8ba327105b7e5fbe510c73a51fc98147">boundaryMarker</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html">OpBoundaryRhs</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a0baa354c1d3bfdc7fae8e964cff3d39e">boundaryFunction</a>));</div>
<div class="line">    pipeline_mng-&gt;getOpBoundaryRhsPipeline().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_un_set_bc.html">OpUnSetBc</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Assemble system]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Set integration rules]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a3e2d0c8dc97457ffd8b5e8cdf64e822e">Poisson2DNonhomogeneous::setIntegrationRules</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pipeline_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> domain_rule_lhs = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * (<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> - 1); };</div>
<div class="line">  <span class="keyword">auto</span> domain_rule_rhs = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * (<a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a> - 1); };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainLhsIntegrationRule(domain_rule_lhs);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setDomainRhsIntegrationRule(domain_rule_rhs);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> boundary_rule_lhs = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>; };</div>
<div class="line">  <span class="keyword">auto</span> boundary_rule_rhs = [](<a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <a class="code hl_variable" href="namespaceconvert.html#a4db4d50b047acc94e54fdf4df9f3077c">int</a>, <span class="keywordtype">int</span> <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>) -&gt; <span class="keywordtype">int</span> { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="_basic_fe_tools_8hpp.html#a9af7d9ad959b4605c5f0bab2f104c2fb">p</a>; };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(boundary_rule_lhs);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;setBoundaryLhsIntegrationRule(boundary_rule_rhs);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Set integration rules]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Solve system]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a2bd9876fc2bfe8f82bfe478f75ac21e2">Poisson2DNonhomogeneous::solveSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pipeline_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ksp_solver = pipeline_mng-&gt;<a class="code hl_function" href="group__mofem__basic__interface.html#gaa983d7ca3e82c5a0711991a730bfbcbb">createKSP</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(ksp_solver);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create RHS and solution vectors</span></div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#af6a1da973cfc717028d17e8044ba3d3c">simpleInterface</a>-&gt;getDM();</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Setup fieldsplit (block) solver - optional: yes/no</span></div>
<div class="line">  <span class="keywordflow">if</span> (1) {</div>
<div class="line">    PC pc;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetPC(ksp_solver, &amp;pc);</div>
<div class="line">    PetscBool is_pcfs = PETSC_FALSE;</div>
<div class="line">    PetscObjectTypeCompare((PetscObject)pc, PCFIELDSPLIT, &amp;is_pcfs);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set up FIELDSPLIT, only when user set -pc_type fieldsplit</span></div>
<div class="line">    <span class="comment">// Identify the index for boundary entities, remaining will be for domain</span></div>
<div class="line">    <span class="comment">// Then split the fields for boundary and domain for solving</span></div>
<div class="line">    <span class="keywordflow">if</span> (is_pcfs == PETSC_TRUE) {</div>
<div class="line">      IS is_domain, is_boundary;</div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">MoFEM::Problem</a> *problem_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga4cafea643e191089b31207ebb16842c9">DMMoFEMGetProblemPtr</a>(dm, &amp;problem_ptr);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRank(</div>
<div class="line">          problem_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, 0, 1, &amp;is_boundary,</div>
<div class="line">          &amp;<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a88a21e50e82c2815fbef79717d487566">boundaryEntitiesForFieldsplit</a>);</div>
<div class="line">      <span class="comment">// CHKERR ISView(is_boundary, PETSC_VIEWER_STDOUT_SELF);</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCFieldSplitSetIS(pc, NULL, is_boundary);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISDestroy(&amp;is_boundary);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(ksp_solver);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Solve the system</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(ksp_solver, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Scatter result data on the mesh</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Solve system]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Output results]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#aa39da8111ef21e494ba2859fd2553292">Poisson2DNonhomogeneous::outputResults</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> pipeline_mng = <a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  pipeline_mng-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_pipeline_manager.html#a4daac802fcdd9c31639d1c1d4a2a608f">getDomainLhsFE</a>().reset();</div>
<div class="line">  pipeline_mng-&gt;getBoundaryLhsFE().reset();</div>
<div class="line">  pipeline_mng-&gt;getDomainRhsFE().reset();</div>
<div class="line">  pipeline_mng-&gt;getBoundaryRhsFE().reset();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> d_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> l_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPPMap</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_fe = boost::make_shared&lt;PostProcFaceEle&gt;(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#a9e3689ec8249b32acf7080dd0209aa4e">mField</a>);</div>
<div class="line"> </div>
<div class="line">  post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<a class="code hl_variable" href="struct_poisson2_d_nonhomogeneous.html#aea9139d458166ceb57b23e6f96c278ae">domainField</a>, d_ptr));</div>
<div class="line">  post_proc_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line">      post_proc_fe-&gt;getPostProcMesh(), post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line">      {{domainField, d_ptr}}, {}, {}, {}));</div>
<div class="line">  pipeline_mng-&gt;getDomainRhsFE() = post_proc_fe;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pipeline_mng-&gt;loopFiniteElements();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_fe-&gt;writeFile(<span class="stringliteral">&quot;out_result.h5m&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a8fd4a5738ca3527b2c288e83f1018994">Poisson2DNonhomogeneous::runProgram</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ad363b70735aaefeab27e969f3a4ffe4f">readMesh</a>();</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a4a01a670bbb2072de569c20f53d27e42">setupProblem</a>();</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a5b1f7d6f2e4dadbacdb2357a9ede0244">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#ae28677eb3db87facbca9273b838801dd">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a3e2d0c8dc97457ffd8b5e8cdf64e822e">setIntegrationRules</a>();</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#a2bd9876fc2bfe8f82bfe478f75ac21e2">solveSystem</a>();</div>
<div class="line">  <a class="code hl_function" href="struct_poisson2_d_nonhomogeneous.html#aa39da8111ef21e494ba2859fd2553292">outputResults</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialisation of MoFEM/PETSc and MOAB data structures</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="_default_params_8hpp.html#a3538d3053f6520cc492dbbc38480d626">param_file</a>[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, <a class="code hl_variable" href="_default_params_8hpp.html#a3538d3053f6520cc492dbbc38480d626">param_file</a>, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Error handling</span></div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line">    <span class="comment">// Register MoFEM discrete manager in PETSc</span></div>
<div class="line">    DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create MOAB instance</span></div>
<div class="line">    moab::Core mb_instance;              <span class="comment">// mesh database</span></div>
<div class="line">    moab::Interface &amp;moab = mb_instance; <span class="comment">// mesh database interface</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create MoFEM instance</span></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);           <span class="comment">// finite element database</span></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = core; <span class="comment">// finite element interface</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Run the main analysis</span></div>
<div class="line">    <a class="code hl_struct" href="struct_poisson2_d_nonhomogeneous.html">Poisson2DNonhomogeneous</a> poisson_problem(m_field);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> poisson_problem.runProgram();</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Finish work: cleaning memory, getting statistics, etc.</span></div>
<div class="line">  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="a_default_params_8hpp_html_a3538d3053f6520cc492dbbc38480d626"><div class="ttname"><a href="_default_params_8hpp.html#a3538d3053f6520cc492dbbc38480d626">param_file</a></div><div class="ttdeci">std::string param_file</div><div class="ttdef"><b>Definition:</b> <a href="_default_params_8hpp_source.html#l00113">DefaultParams.hpp:113</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition:</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition:</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition:</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition:</b> <a href="definitions_8h_source.html#l00372">definitions.h:372</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00509">DMMoFEM.cpp:509</a></div></div>
<div class="ttc" id="agroup__dm_html_ga4cafea643e191089b31207ebb16842c9"><div class="ttname"><a href="group__dm.html#ga4cafea643e191089b31207ebb16842c9">MoFEM::DMMoFEMGetProblemPtr</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetProblemPtr(DM dm, const MoFEM::Problem **problem_ptr)</div><div class="ttdoc">Get pointer to problem data structure.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00412">DMMoFEM.cpp:412</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00047">DMMoFEM.cpp:47</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition:</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01003">DMMoFEM.hpp:1003</a></div></div>
<div class="ttc" id="agroup__mofem__basic__interface_html_gaa983d7ca3e82c5a0711991a730bfbcbb"><div class="ttname"><a href="group__mofem__basic__interface.html#gaa983d7ca3e82c5a0711991a730bfbcbb">MoFEM::PipelineManager::createKSP</a></div><div class="ttdeci">SmartPetscObj&lt; KSP &gt; createKSP(SmartPetscObj&lt; DM &gt; dm=nullptr)</div><div class="ttdoc">Create KSP (linear) solver.</div><div class="ttdef"><b>Definition:</b> <a href="_pipeline_manager_8cpp_source.html#l00049">PipelineManager.cpp:49</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition:</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition:</b> <a href="_deprecated_petsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a681e912e2d0043503d2da810dc186d73"><div class="ttname"><a href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">MoFEM::vectorDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; vectorDuplicate(Vec vec)</div><div class="ttdoc">Create duplicate vector of smart vector.</div><div class="ttdef"><b>Definition:</b> <a href="_petsc_smart_obj_8hpp_source.html#l00217">PetscSmartObj.hpp:217</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition:</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="apoisson__2d__nonhomogeneous_8hpp_html"><div class="ttname"><a href="poisson__2d__nonhomogeneous_8hpp.html">poisson_2d_nonhomogeneous.hpp</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_add_h_o_ops_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_add_h_o_ops.html">MoFEM::AddHOOps</a></div><div class="ttdoc">Add operators pushing bases from local to physical configuration.</div><div class="ttdef"><b>Definition:</b> <a href="_h_o_data_operators_8hpp_source.html#l00503">HODataOperators.hpp:503</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bc_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bc_manager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="_bc_manager_8hpp_source.html#l00025">BcManager.hpp:25</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition:</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_i_s_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_i_s_manager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition:</b> <a href="_i_s_manager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_scalar_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition:</b> <a href="_user_data_operators_8hpp_source.html#l00082">UserDataOperators.hpp:83</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_post_proc_map_in_moab_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition:</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00700">PostProcBrokenMeshInMoabBase.hpp:700</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_bc_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_bc.html">MoFEM::OpSetBc</a></div><div class="ttdoc">Set indices on entities on finite element.</div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00038">FormsIntegrators.hpp:38</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_un_set_bc_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_un_set_bc.html">MoFEM::OpUnSetBc</a></div><div class="ttdef"><b>Definition:</b> <a href="_forms_integrators_8hpp_source.html#l00049">FormsIntegrators.hpp:49</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager.html">MoFEM::PipelineManager</a></div><div class="ttdoc">PipelineManager interface.</div><div class="ttdef"><b>Definition:</b> <a href="_pipeline_manager_8hpp_source.html#l00024">PipelineManager.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_html_a4daac802fcdd9c31639d1c1d4a2a608f"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager.html#a4daac802fcdd9c31639d1c1d4a2a608f">MoFEM::PipelineManager::getDomainLhsFE</a></div><div class="ttdeci">boost::shared_ptr&lt; FEMethod &gt; &amp; getDomainLhsFE()</div><div class="ttdef"><b>Definition:</b> <a href="_pipeline_manager_8hpp_source.html#l00401">PipelineManager.hpp:401</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_3_01_face_element_forces_and_sources_core_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_3_01_face_element_forces_and_sources_core_01_4.html">MoFEM::PostProcBrokenMeshInMoab&lt; FaceElementForcesAndSourcesCore &gt;</a></div><div class="ttdef"><b>Definition:</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00679">PostProcBrokenMeshInMoabBase.hpp:680</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab.html">MoFEM::PostProcBrokenMeshInMoab</a></div><div class="ttdef"><b>Definition:</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00669">PostProcBrokenMeshInMoabBase.hpp:669</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_simple_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_simple.html">MoFEM::Simple</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition:</b> <a href="_simple_8hpp_source.html#l00027">Simple.hpp:27</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_html_a2ad05abaeb3d9465b3c0c70bc9c6dbbf"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous.html#a2ad05abaeb3d9465b3c0c70bc9c6dbbf">Poisson2DNonhomogeneous::Poisson2DNonhomogeneous</a></div><div class="ttdeci">Poisson2DNonhomogeneous(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8cpp_source.html#l00057">poisson_2d_nonhomogeneous.cpp:57</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs_html"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_lhs.html">Poisson2DNonhomogeneousOperators::OpBoundaryLhs</a></div><div class="ttdoc">[OpDomainRhs]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00168">poisson_2d_nonhomogeneous.hpp:168</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs_html"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_boundary_rhs.html">Poisson2DNonhomogeneousOperators::OpBoundaryRhs</a></div><div class="ttdoc">[OpBoundaryLhs]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00243">poisson_2d_nonhomogeneous.hpp:243</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs_html"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_lhs.html">Poisson2DNonhomogeneousOperators::OpDomainLhs</a></div><div class="ttdoc">[OpDomainLhs]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00022">poisson_2d_nonhomogeneous.hpp:22</a></div></div>
<div class="ttc" id="astruct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs_html"><div class="ttname"><a href="struct_poisson2_d_nonhomogeneous_operators_1_1_op_domain_rhs.html">Poisson2DNonhomogeneousOperators::OpDomainRhs</a></div><div class="ttdoc">[OpDomainLhs]</div><div class="ttdef"><b>Definition:</b> <a href="poisson__2d__nonhomogeneous_8hpp_source.html#l00103">poisson_2d_nonhomogeneous.hpp:103</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.5
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>