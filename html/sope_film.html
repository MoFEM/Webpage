<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: Soap film spanned on wire</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="tutorials.html">Tutorials</a></li>  </ul>
</div>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Soap film spanned on wire</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1">
    <a href="#equations_minimal_surface_equation">Theory</a>
  </li>
  <li class="level1">
    <a href="#installation_minimal_surface_equation">Installation</a>
    <ul>
      <li class="level2">
        <a href="#update_minimal_surface_equation">Updating module</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#implementation_minimal_surface_equation">Definition and Declarations</a>
    <ul>
      <li class="level2">
        <a href="#declaration_minimal_surface_equation">Declarations &amp; definition</a>
        <ul>
          <li class="level3">
            <a href="#field_minimal_surface_equation">Declaring and definition of field</a>
          </li>
          <li class="level3">
            <a href="#fe_minimal_surface_equation">Declaring &amp; definition finite elements</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#prblem_minimal_surface_equation">Declaring and defining problem and registering discrete manager</a>
      </li>
      <li class="level2">
        <a href="#solvers_work_minimal_surface_equation">Solving problems</a>
        <ul>
          <li class="level3">
            <a href="#linear_sol_work_minimal_surface_equation">Solving linear boundary problem</a>
          </li>
          <li class="level3">
            <a href="#nl_sol_work_minimal_surface_equation">Solving nonlinear minimal area equation</a>
          </li>
        </ul>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#element_work_minimal_surface_equation">Implementing finite elements</a>
    <ul>
      <li class="level2">
        <a href="#bc_implementation_minimal_surface_equation">Finite element on boundary</a>
      </li>
      <li class="level2">
        <a href="#main_implementation_minimal_surface_equation">Finite element for minimal surface area problem</a>
      </li>
    </ul>
  </li>
  <li class="level1">
    <a href="#example_minimal_surface_equation">Example</a>
  </li>
  <li class="level1">
    <a href="#future_work_minimal_surface_equation">Future work and contribution</a>
  </li>
</ul>
</div>
<div class="textblock"><p><a class="el" href="struct_example.html" title="[Example]">Example</a> of implementation, step by step tutorial.</p>
<p>This documents assumes that reader is familiar with hierarchical approximation spaces, if not pleas look into paper <a class="el" href="citelist.html#CITEREF_nme:nme847">[1]</a>. In such approximation degrees of freedom are not only associated with vertices but edges and other two- and three- dimensional entities. <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> exploit that property and use it as a tool to make efficient and well structured code.</p>
<div class="image">
<img src="soap_rectangle.png" alt=""/>
<div class="caption">
Soap film on rectangular wire loop with g(x,y)=sin(Pi*x)</div></div>
<h1><a class="anchor" id="equations_minimal_surface_equation"></a>
Theory</h1>
<p>This problem formulation follows tutorial from <b>deal.II</b> <a href="https://www.dealii.org/developer/doxygen/deal.II/step_15.html">https://www.dealii.org/developer/doxygen/deal.II/step_15.html</a>. This problem describe the surface spanned by soap film enclosed between a rigid wire. For simplicity shape of a wire is given by curve \(z=g(x,y)\).</p>
<p>Problem equation in the strong form is given by       </p><p class="formulaDsp">
\[
-\nabla \cdot
\left(
\frac{1}{\sqrt{1+\|u\|^2}}\nabla u
\right) = 0 \; \textrm{in}\,\Omega,\\
u = g(x,y) \; \textrm{on}\,\partial\Omega
\]
</p>
<p> Above equation is linearized and applying standard procedure of integration by parts expressed finally in the week form                     </p><p class="formulaDsp">
\[
\int_\Omega
\nabla \phi \cdot
\left\{
a_i
\nabla \delta u_{i+1}
-
a_i^3 \nabla u_i \cdot \nabla \delta u_{i+1} \nabla u_i
\right\}
\textrm{d}\Omega
+
\int_\Omega
\nabla \phi \cdot
\left\{
a_i
\nabla u_{i+1}
\right\}
\textrm{d}\Omega
=
0
\]
</p>
<p> where   </p><p class="formulaDsp">
\[
a_i = \frac{1}{\sqrt{1+\|u_i\|^2}}
\]
</p>
<p> and \(i\) is iteration number where function values at step \(s\) are updated us follows    </p><p class="formulaDsp">
\[
u^{s+1} = u^s + \Delta u_{i+1},\\
\Delta u_{i+1} = \Delta u_i + \delta u_{i+1}.
\]
</p>
<h1><a class="anchor" id="installation_minimal_surface_equation"></a>
Installation</h1>
<p><a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> module (like MatLab toolkit) is independent implementation, which own repository, different owners and license. Adding module is straightforward, <em>CMake</em> search in subdirectories for a file <em>InstalledAddModule.cmake</em>, directory in which such file is placed become an <em>user</em> <em>module</em>. You can look to the <a class="el" href="faqs.html#adding_user_module">How to add user module?</a> for additional information about module installation and its directory structure.</p>
<p>It is good practice that each module has tests verifying correctness of the installation. Having tests is essential for code development and ensures compatibility of a module which <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library and other modules.</p>
<p>The minimal surface problem is implemented as a stand alone independent module which own repository and GNU Lesser General Public License. A module is installed from Bitbucket repository (<a href="https://bitbucket.org/likask/mofem_um_minimal_surface_equation">https://bitbucket.org/likask/mofem_um_minimal_surface_equation</a>) by command, </p><div class="fragment"><div class="line"><span class="keyword">export</span> MOFEM_INSTALL_DIR=$HOME/mofem_installation</div>
<div class="line">git clone https:<span class="comment">//bitbucket.org/likask/mofem_um_minimal_surface_equation \</span></div>
<div class="line"><span class="comment">$MOFEM_INSTALL_DIR/mofem-cephas/mofem/users_modules/minimal_surface_equation</span></div>
</div><!-- fragment --><p>Modules is compiled with commands </p><div class="fragment"><div class="line">cd $MOFEM_INSTALL_DIR/users_modules</div>
<div class="line">touch CMakeCache.txt &amp;&amp; make</div>
</div><!-- fragment --><p>Finally installation is tested with </p><div class="fragment"><div class="line">ctest -<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> minimal_surface_equation_test -VV</div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
</div><!-- fragment --><h2><a class="anchor" id="update_minimal_surface_equation"></a>
Updating module</h2>
<p>Since modules are located in different independent repositories, for connivence update of all installed modules is automatized. You can do that with line command; </p><div class="fragment"><div class="line">cd $MOFEM_INSTALL_DIR/users_modules</div>
<div class="line">make update_users_modules &amp;&amp; make</div>
</div><!-- fragment --><p> you can as well update individual module, for example </p><div class="fragment"><div class="line">cd $MOFEM_INSTALL_DIR/users_modules</div>
<div class="line">make update_minimal_surface_equation &amp;&amp; make</div>
</div><!-- fragment --><p> Alternatively to update this module you can simply do; </p><div class="fragment"><div class="line">cd $MOFEM_INSTALL_DIR/users_modules/minimal_surface_equation</div>
<div class="line">git pull &amp;&amp; make</div>
</div><!-- fragment --><h1><a class="anchor" id="implementation_minimal_surface_equation"></a>
Definition and Declarations</h1>
<p>In <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> like in programming languages like C++ we use <b>declarations</b>, <b>definitions</b> and <b>implementation</b>. A <b>definition</b> of finite element is what <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> needs to build data structures in order to make vectors, matrices and set up solvers. A <b>implementation</b> of finite element is what <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> needs to do calculations, i.e. calculate element matrices and vectors. Such approach allow to have the same declaration but several definitions (implementations) of the same element.</p>
<h2><a class="anchor" id="declaration_minimal_surface_equation"></a>
Declarations &amp; definition</h2>
<h3><a class="anchor" id="field_minimal_surface_equation"></a>
Declaring and definition of field</h3>
<p>In this problem we have only one scalar field of a soap surface displacements in \(z\) direction. To solve problem using week form shown above we demand that approximation field belongs to <em>H1</em> space (i.e. conforming approximation). Since problem is 2D, we span that field on triangles, edges and nodes; </p><div class="fragment"><div class="line"><span class="comment">// Add field</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.add_field(<span class="stringliteral">&quot;U&quot;</span>,<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>,<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,1); </div>
<div class="line"><span class="comment">// Add entities to field (root_mesh, i.e. on all mesh entities fields are approx.)</span></div>
<div class="line"><span class="comment">// On those entities and lower dimension entities approximation is spaned,</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.add_ents_to_field_by_type(root_set,MBTRI,<span class="stringliteral">&quot;U&quot;</span>); </div>
<div class="line"><span class="comment">// Set approximation oder</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.set_field_order(root_set,MBTRI,<span class="stringliteral">&quot;U&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.set_field_order(root_set,MBEDGE,<span class="stringliteral">&quot;U&quot;</span>,<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.set_field_order(root_set,MBVERTEX,<span class="stringliteral">&quot;U&quot;</span>,1); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.build_fields(); </div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base nme:nme847.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
</div><!-- fragment --><p> Note that initially we set the same approximation order to each entity. However in general approximation order can be heterogenous. Approximation order of vertices is always "1" for H1 space, since for given nodes values uniquely piecewise linear function is given.</p>
<p>If it is needed additional abstraction, the field can carry additional information about its covariant and contravariant base, see MoFEM::CoordSys. We do not need this here, since we work only with one component of displacement field in Cartesian base.</p>
<h3><a class="anchor" id="fe_minimal_surface_equation"></a>
Declaring &amp; definition finite elements</h3>
<p>In <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> finite element is entity (<em>Vertex</em>, <em>Edge</em>, <em>Triangle</em>, <em>Quad</em>, <em>Tet</em>, <em>Prism</em> ... <em>Meshset</em>), on which we do some calculations, f.e. integrate internal force vector.</p>
<p>Definition of a finite element resembles how we write bilinear form, f.e. problem in the week form is given by general equation   </p><p class="formulaDsp">
\[
b(v,u;\alpha) = f(v)\;\in\Omega
\]
</p>
<p> where \(u,v\in\mathcal{V} \subset H_1(\Omega)\) belongs to some finite vector space and \(\alpha = \alpha(x,y) \in L_2(\Omega)\) is some field of coefficients. A testing function (wighting) space, tested (approximated) field and data (coefficient) field on which bilinear form operates, need to be specified when finite element is declared. Note that in general bilinear form can be decomposed on several parts (by introducing several elements) to split complex problem on simpler tasks.</p>
<p>In this example we declaring two elements, one <em>Edge</em> elements used to calculate approximation of function \(u=g(x,y)\) on boundary \(\partial \Omega\), and another on <em>Triangles</em> to formulate main problem of minimal surface equation in \(\Omega\).</p>
<p>The element in film domain is declared as follows </p><div class="fragment"><div class="line"><span class="comment">// Add (declare) finite element (this defines element declaration comes later)</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.add_finite_element(<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>); </div>
<div class="line"><span class="comment">// Set (define) on which fields that element operates</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.modify_finite_element_add_field_row(<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.modify_finite_element_add_field_col(<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.modify_finite_element_add_field_data(<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>); </div>
</div><!-- fragment --><p> and for boundary elements element is declared in analogically, as follows </p><div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.add_finite_element(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.modify_finite_element_add_field_row(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.modify_finite_element_add_field_col(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.modify_finite_element_add_field_data(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>,<span class="stringliteral">&quot;U&quot;</span>); </div>
</div><!-- fragment --><p>In addition we need to set domain of the finite element, it is done by adding entities to the finite element, for <em>MINIMAL_SURFACE_ELEMENT</em> we will use all triangle elements in the root meshset; </p><div class="fragment"><div class="line"><span class="comment">// Add entities to that element</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.add_ents_to_finite_element_by_type(root_set,MBTRI,<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>); </div>
</div><!-- fragment --><p> For <em>BC_ELEMENT</em>, we will take a skin form triangles to obtain edges on the boundary and add them to the boundary finite element; </p><div class="fragment"><div class="line"><span class="comment">// Take a skin form the mesh</span></div>
<div class="line">Skinner skin(&amp;m_field.get_moab());</div>
<div class="line"><a class="code hl_class" href="class_range.html">Range</a> tris;</div>
<div class="line">rval = moab.get_entities_by_type(root_set,MBTRI,tris,<span class="keyword">false</span>); </div>
<div class="line"><a class="code hl_class" href="class_range.html">Range</a> bc_edges;</div>
<div class="line">rval = skin.find_skin(root_set,tris,<span class="keyword">false</span>,bc_edges); </div>
<div class="line"><span class="comment">// Add entities to that element</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.add_ents_to_finite_element_by_EDGEs(</div>
<div class="line">  bc_edges,<span class="stringliteral">&quot;BC_ELEMENT&quot;</span></div>
<div class="line">); </div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
</div><!-- fragment --><p>Note that dimension of a domain is not explicitly given, it is associated with the type of an entity, in this case we use triangles and edges. However user can do more exotic combinations, mixing different dimensions and do generic element from a meshset. Dimension of a field is implicitly defined not by a finite element, but fields on which it operates and structure MoFEM::CoordSys carried with each field.</p>
<h2><a class="anchor" id="prblem_minimal_surface_equation"></a>
Declaring and defining problem and registering discrete manager</h2>
<p>The <em>KSP</em> solver, <em>SNES</em> solver or <em>TS</em> solver from PETSc library could be run directly using native <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> interface, optionally PETSc Discrete Manager (DM) <a href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/DM/">http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/DM/</a> can be used by <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> DM interface, see <a class="el" href="group__dm.html">Distributed mesh manager</a>.</p>
<p>In this example we will solve sequentially two problems, linear problem finding function approximation on the boundary and nonlinear problem on the film domain. First problem is defined as follows; </p><div class="fragment"><div class="line">DM bc_dm;</div>
<div class="line">DMType dm_name = <span class="stringliteral">&quot;DM_BC&quot;</span>;</div>
<div class="line"><span class="comment">// Register DM problem</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMRegister_MoFEM(dm_name); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD,&amp;bc_dm);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(bc_dm,dm_name);</div>
<div class="line"><span class="comment">// Create DM instance</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMCreateMoFEM(bc_dm,&amp;m_field,dm_name,bit_level0); </div>
<div class="line"><span class="comment">// Configure DM from line command options (DM itself, solvers, pre-conditioners, ... )</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(bc_dm); </div>
<div class="line"><span class="comment">// Add elements to dm (only one here)</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMAddElement(bc_dm,<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>); </div>
<div class="line"><span class="comment">// Set up problem (number dofs, partition mesh, etc.)</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(bc_dm); </div>
</div><!-- fragment --><p> where <em>bit_level0</em> declares on which refinement level problem is solved. In principle user can have several problems on different mesh refinements, or problem which spanning on several nested meshes.</p>
<p>Analogically second problem is created as follows; </p><div class="fragment"><div class="line">DM dm;</div>
<div class="line">DMType dm_name = <span class="stringliteral">&quot;DM_MINIMAL_AREA&quot;</span>;</div>
<div class="line"><span class="comment">// Register problem</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMRegister_MoFEM(dm_name); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD,&amp;dm);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm,dm_name);</div>
<div class="line"><span class="comment">// Create DM instance</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMCreateMoFEM(dm,&amp;m_field,dm_name,bit_level0); </div>
<div class="line"><span class="comment">// Get options fron line command</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(dm); </div>
<div class="line"><span class="comment">// Add elements to dm (only one here)</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMAddElement(dm,<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>); </div>
<div class="line"><span class="comment">// Set up data structures</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm); </div>
</div><!-- fragment --><p>Once DMs are created for each problem, using PETSc interface <a href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/DM/">http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/DM/</a> we can create vectors and matrices for each of the problems, f.e. </p><div class="fragment"><div class="line">Vec T,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">Mat <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line"><span class="comment">// Create vectors</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm,&amp;T); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(T,&amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>); </div>
<div class="line"><span class="comment">// Create matrix</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm,&amp;A); </div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
</div><!-- fragment --><p>Such implementation make transparent for user how vectors and matrices are created. Since DM is defined for <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> problem, problem is composed from set of finite elements and those are using fields, for given space of those fields (L2,H1,Hdiv,Hcurl) and given entities caring those fields, adjacency matrix is uniquely defined.</p>
<p>In <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> solution is build "bottom to up", such that fields, approximations, finite elements and their implementation is a problem independent. This enables to use finite element to solve problems, independently on their dimension and number of fields on which those problems operates.</p>
<p>In this example, we exploit this to some extend. The 1d problem is solved first on the edges and then the 2d problem is solved on triangles. Those two problems operates on the same field and since field is independent from problem, data transfer from one to another is effortless.</p>
<h2><a class="anchor" id="solvers_work_minimal_surface_equation"></a>
Solving problems</h2>
<h3><a class="anchor" id="linear_sol_work_minimal_surface_equation"></a>
Solving linear boundary problem</h3>
<p>To solve problem the right hand side vector and the left hand side matrix need to be calculated, </p><div class="fragment"><div class="line"><span class="comment">// Loop, integrate and assemble</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMLoopFiniteElements(</div>
<div class="line">  bc_dm,<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>,&amp;minimal_surface_element.feBcEdge</div>
<div class="line">); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(A,MAT_FINAL_ASSEMBLY); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(A,MAT_FINAL_ASSEMBLY); </div>
</div><!-- fragment --><p> The element implementation is hidden in its object instance <em>minimal_surface_element.feBcEdge</em>, implementation of this class is discussed in following sections. Having vector and matrices assembled system of equations is solved using <em>KSP</em> solver </p><div class="fragment"><div class="line">KSP solver;</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPCreate(PETSC_COMM_WORLD,&amp;solver); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(solver,A,A); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(solver); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(solver); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(solver,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,T); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPDestroy(&amp;solver); </div>
</div><!-- fragment --><p> Once problem is solved, results are stored in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> database, independently from particular problem numeration, partitioning on several processors or refinement level </p><div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMMeshToGlobalVector(bc_dm,T,INSERT_VALUES,SCATTER_REVERSE); </div>
</div><!-- fragment --><h3><a class="anchor" id="nl_sol_work_minimal_surface_equation"></a>
Solving nonlinear minimal area equation</h3>
<p>Solution of a nonlinear problem in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> is as simple as solving linear problem, taking advantage from PETSc functionality. To run SNES solver one need to register finite element object instances responsible for calculation of a tangent matrix and a vector of residuals, this is simply done as follows; </p><div class="fragment"><div class="line"><span class="comment">//Rhs</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMSNESSetFunction(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,&amp;fix_edges_ents,NULL); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMSNESSetFunction(dm,<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,&amp;minimal_surface_element.feRhs,PETSC_NULL,PETSC_NULL);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMSNESSetFunction(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,NULL,&amp;fix_edges_ents); </div>
<div class="line"><span class="comment">//Lhs</span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMSNESSetJacobian(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,&amp;fix_edges_ents,NULL); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMSNESSetJacobian(dm,<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,&amp;minimal_surface_element.feLhs,PETSC_NULL,PETSC_NULL);</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMSNESSetJacobian(dm,<a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>,NULL,NULL,&amp;fix_edges_ents); </div>
<div class="ttc" id="a_d_m_mo_f_e_m_8hpp_html_a8643d43312bdd9afb90733cfdcc77cf9"><div class="ttname"><a href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a></div><div class="ttdeci">#define DM_NO_ELEMENT</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l00010">DMMoFEM.hpp:10</a></div></div>
</div><!-- fragment --><p> where <em>fix_edges_ents</em>, <em>minimal_surface_element.feRhs</em> and minimal_surface_element.feLhs are particular finite element implementations. Implementation of <em>fix_edges_ents</em> is not discussed here, it is general propose finite element to enforce essential boundary conditions, in this case fixes <em>DOFs</em> on domain boundary. Implementation of <em>minimal_surface_element.feRhs</em> and minimal_surface_element.feLhs is discussed in following sections.</p>
<p>User can add several elements, for each <em>Newton</em> iteration, elements instances are executed in order in which were added (registered) in <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> SNES solver. Low level element class is here <a class="el" href="struct_mo_f_e_m_1_1_f_e_method.html">MoFEM::FEMethod</a>. Usually user not uses directly this class, it implement using set of so called <em>data</em> <em>entity</em> <em>operators</em> as is shown bellow. Such structure allow to break down complex problem on smaller tasks, easy to debug, reuse in different modules and tests and last but not least produce efficient code.</p>
<p>To create nonlinear solver instance, linked to DM, follow code; </p><div class="fragment"><div class="line">SNES snes;</div>
<div class="line"><a class="code hl_class" href="class_snes_ctx.html">SnesCtx</a> *snes_ctx;</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESCreate(PETSC_COMM_WORLD,&amp;snes); </div>
<div class="line"><span class="comment">//CHKERR SNESSetDM(snes,dm); </span></div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMGetSnesCtx(dm,&amp;snes_ctx); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFunction(snes,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,SnesRhs,snes_ctx); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetJacobian(snes,A,A,SnesMat,snes_ctx); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFromOptions(snes); </div>
<div class="ttc" id="aclass_snes_ctx_html"><div class="ttname"><a href="class_snes_ctx.html">SnesCtx</a></div></div>
</div><!-- fragment --><p> Note that type of SNES solver, line searchers, parameters are set from line command, see for details <a href="https://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/SNES/">https://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/SNES/</a>, in particular <a href="https://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/SNES/SNESSetFromOptions.html">https://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/SNES/SNESSetFromOptions.html</a></p>
<p>Analyzed problem in this example strongly nonlinear it is convenient to apply sub-stepping, as in the following code; </p><div class="fragment"><div class="line">Vec T0;</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(T,&amp;T0); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMMeshToLocalVector(dm,T0,INSERT_VALUES,SCATTER_FORWARD); </div>
<div class="line"><span class="keywordtype">double</span> step_size = 1./nb_sub_steps;</div>
<div class="line"><span class="keywordflow">for</span>(<span class="keywordtype">int</span> ss = 1;ss&lt;=nb_sub_steps;ss++) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAXPY(T,step_size,T0); </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMMeshToLocalVector(dm,T,INSERT_VALUES,SCATTER_REVERSE); </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSolve(snes,PETSC_NULL,T); </div>
<div class="line">}</div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(T,INSERT_VALUES,SCATTER_FORWARD); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(T,INSERT_VALUES,SCATTER_FORWARD); </div>
<div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMMeshToGlobalVector(dm,T,INSERT_VALUES,SCATTER_REVERSE); </div>
</div><!-- fragment --><p> where DMoFEMMeshToLocalVector get values from the field (previously calculated in boundary problem) and stores values in vector <code>T0</code>. This vector is scaled by size <em>step</em> <em>size</em> and added to unknown vector.</p>
<h1><a class="anchor" id="element_work_minimal_surface_equation"></a>
Implementing finite elements</h1>
<p>A finite element is simply understand here as a object doing some calculations (usually integration) on some domain associated with element entity, f.e. example for <em>edge</em> is a segment emerged in 1d/2d/3d space depending on needed level of abstraction, for triangle is a 2d domain (potential emerged in some higher order dimension space). Low level implementation starts with <a class="el" href="struct_mo_f_e_m_1_1_f_e_method.html">MoFEM::FEMethod</a>, however here we will implement elements with some "driver" classes which will do some typical work for a user. This section as well introduces concept <em>user</em> <em>data</em> <em>operator</em> (see <a class="el" href="struct_mo_f_e_m_1_1_data_operator.html" title="base operator to do operations at Gauss Pt. level">MoFEM::DataOperator</a>). In this implementation two types of elements are used <a class="el" href="group__mofem__forces__and__sources__edge__element.html">Edge Element</a> and <a class="el" href="group__mofem__forces__and__sources__tri__element.html">Face Element</a>.</p>
<p>Finite element operates on one or several fields, where approximation spaces of fields are span on some set of entities, specific for each field space and approximation order. For example, space H1 and order 1, span only on <em>vertices</em>, order 2 span on <em>vertices</em> and <em>edges</em>, order 3 span additionally on faces, and so on. Another example, space <em>Hdiv</em> in 3d, span only on faces and volumes, depending on approximation order.</p>
<p>Managing complexities for hierarchical and heterogenous approximation fields on unstructured meshes could be difficult. <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> try to make that easy but yet give maximal flexibility. Inside of each element, <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> loops over all entities or all possible combinations, according to canonical element numeration <b>[tautges_moab:2004]</b>. For each looped entity ordered set of operators (implemented by user) is executed, where from operator user get easy access to finite element data and data on specific entity, like shape functions, vales of degrees of freedom, indices and other data more specific to finite element entity type.</p>
<p>Implementation of this problem is in <a class="el" href="_minimal_surface_element_8hpp.html" title="Implementation of minimal surface element.">MinimalSurfaceElement.hpp</a> particular in class <a class="el" href="struct_minimal_surface_equation_1_1_minimal_surface_element.html">MinimalSurfaceEquation::MinimalSurfaceElement</a>.</p>
<h2><a class="anchor" id="bc_implementation_minimal_surface_equation"></a>
Finite element on boundary</h2>
<p>Problem boundary is implemented with the <a class="el" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core.html">MoFEM::EdgeElementForcesAndSourcesCore</a>, see </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element.html">MinimalSurfaceEquation::MinimalSurfaceElement::EdgeElement</a>: <span class="keyword">public</span> <a class="code hl_class" href="class_edge_element_forces_and_sources_core.html">EdgeElementForcesAndSourcesCore</a> {</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element.html#aa74b97bd7db1d0c14dd30d84a76f3d1b">EdgeElement</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field):</div>
<div class="line">  <a class="code hl_class" href="class_edge_element_forces_and_sources_core.html">EdgeElementForcesAndSourcesCore</a>(m_field) {}<span class="comment"></span></div>
<div class="line"><span class="comment">  /** \brief Set integrate rule</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element.html#a97712698386abe892a1687de4727cae7">getRule</a>(<span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) { <span class="keywordflow">return</span> 2*<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>; };</div>
<div class="line">};</div>
<div class="line">EdgeElement feBcEdge;</div>
<div class="ttc" id="aclass_edge_element_forces_and_sources_core_html"><div class="ttname"><a href="class_edge_element_forces_and_sources_core.html">EdgeElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element.html">MinimalSurfaceEquation::MinimalSurfaceElement::EdgeElement</a></div><div class="ttdoc">Bondary problem.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00057">MinimalSurfaceElement.hpp:57</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element_html_a97712698386abe892a1687de4727cae7"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element.html#a97712698386abe892a1687de4727cae7">MinimalSurfaceEquation::MinimalSurfaceElement::EdgeElement::getRule</a></div><div class="ttdeci">int getRule(int order)</div><div class="ttdoc">Set integrate rule.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00063">MinimalSurfaceElement.hpp:63</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element_html_aa74b97bd7db1d0c14dd30d84a76f3d1b"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_edge_element.html#aa74b97bd7db1d0c14dd30d84a76f3d1b">MinimalSurfaceEquation::MinimalSurfaceElement::EdgeElement::EdgeElement</a></div><div class="ttdeci">EdgeElement(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00058">MinimalSurfaceElement.hpp:58</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
</div><!-- fragment --><p> where order of appropriate oder of quadrature is set to integrate least square problem   </p><p class="formulaDsp">
\[
\int_L \mathbf{N}^\textrm{T}\mathbf{N} \textrm{d}L \; \mathbf{u} = \int_L \mathbf{N}^\textrm{T} g(x,y) \textrm{d}L
\]
</p>
<p> where \(\mathbf{u}\) represents vector of unknown <em>DOFs</em> on boundary of the domain.</p>
<p>The right hand side vector is calculated using instance of </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  Vec <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a1317d0270607efc7e39dc517a42f10f9">vF</a>;</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#aba2881fa71fb3e7305ca971305aa3fc3">OpAssmebleBcRhs</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,Vec v_f):</div>
<div class="line">  <a class="code hl_class" href="class_edge_element_forces_and_sources_core.html">EdgeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a1317d0270607efc7e39dc517a42f10f9">vF</a>(v_f) {}</div>
<div class="line">  <span class="keyword">virtual</span> <span class="keywordtype">double</span> <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a6e22c5aa764b64669f3f30b296ce0b34">evalFunction</a>(<span class="keywordtype">double</span> x,<span class="keywordtype">double</span> y) {</div>
<div class="line">    <span class="keywordflow">return</span> sin(2*M_PI*(x+y));</div>
<div class="line">  }</div>
<div class="line">  VectorDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a50ec14c1ae187171c53d0afba4317ffd">nF</a>;</div>
<div class="line">  PetscErrorCode <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a5d7d42abefc8fa8c441f9d1fa523ac4b">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> side,EntityType type,DataForcesAndSourcesCore::EntData &amp;data</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordtype">int</span> nb_dofs = data.getFieldData().size();</div>
<div class="line">    <span class="keywordflow">if</span>(nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a50ec14c1ae187171c53d0afba4317ffd">nF</a>.resize(nb_dofs,<span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a50ec14c1ae187171c53d0afba4317ffd">nF</a>.clear();</div>
<div class="line">    <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">      <span class="keywordtype">double</span> val = getLength()*getGaussPts()(1,gg);</div>
<div class="line">      <span class="keywordtype">double</span> x = getCoordsAtGaussPts()(gg,0);</div>
<div class="line">      <span class="keywordtype">double</span> y = getCoordsAtGaussPts()(gg,1);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a50ec14c1ae187171c53d0afba4317ffd">nF</a>) += val*<a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a6e22c5aa764b64669f3f30b296ce0b34">evalFunction</a>(x,y)*data.getN(gg);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a1317d0270607efc7e39dc517a42f10f9">vF</a>,data.getIndices().size(),&amp;data.getIndices()[0],&amp;<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a50ec14c1ae187171c53d0afba4317ffd">nF</a>[0],ADD_VALUES</div>
<div class="line">    ); </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="a_hooke_element_8hpp_html_aee27a2ebc8f3d34a5c1ce71b2607d1a3"><div class="ttname"><a href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a></div><div class="ttdeci">ForcesAndSourcesCore::UserDataOperator UserDataOperator</div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00075">HookeElement.hpp:75</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_aef01d33cbe1d8ed916ce789bd25c4495"><div class="ttname"><a href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">MoFEM::VecSetValues</a></div><div class="ttdeci">MoFEMErrorCode VecSetValues(Vec V, const EntitiesFieldData::EntData &amp;data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc vector.</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l01589">EntitiesFieldData.hpp:1589</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs</a></div><div class="ttdoc">Integrate vector on rhs,.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00091">MinimalSurfaceElement.hpp:92</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs_html_a1317d0270607efc7e39dc517a42f10f9"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a1317d0270607efc7e39dc517a42f10f9">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs::vF</a></div><div class="ttdeci">Vec vF</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00093">MinimalSurfaceElement.hpp:93</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs_html_a50ec14c1ae187171c53d0afba4317ffd"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a50ec14c1ae187171c53d0afba4317ffd">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs::nF</a></div><div class="ttdeci">VectorDouble nF</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00107">MinimalSurfaceElement.hpp:107</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs_html_a5d7d42abefc8fa8c441f9d1fa523ac4b"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a5d7d42abefc8fa8c441f9d1fa523ac4b">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int side, EntityType type, DataForcesAndSourcesCore::EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00108">MinimalSurfaceElement.hpp:108</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs_html_a6e22c5aa764b64669f3f30b296ce0b34"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#a6e22c5aa764b64669f3f30b296ce0b34">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs::evalFunction</a></div><div class="ttdeci">virtual double evalFunction(double x, double y)</div><div class="ttdoc">Function on boundary Inherit this class and overload this function to change bc.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00102">MinimalSurfaceElement.hpp:102</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs_html_aba2881fa71fb3e7305ca971305aa3fc3"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html#aba2881fa71fb3e7305ca971305aa3fc3">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcRhs::OpAssmebleBcRhs</a></div><div class="ttdeci">OpAssmebleBcRhs(const string field_name, Vec v_f)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00094">MinimalSurfaceElement.hpp:94</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for EDGE element</div><div class="ttdef"><b>Definition</b> <a href="_edge_element_forces_and_sources_core_8hpp_source.html#l00068">EdgeElementForcesAndSourcesCore.hpp:69</a></div></div>
</div><!-- fragment --><p> This <em><a class="el" href="class_user_data_operator.html">UserDataOperator</a></em> is has type <b>OPROW</b>, it means that it operates on fields which are on rows, "left side" of bilinear form. In that class user has access to range of information on different abstraction levels. Importantly here information about numerical integration, finite element edge length or global position of integration points is accessed. Member function <b>doWork</b> is executed of each entity adjacent to finite element, i.e. <em>vertices</em> and <em>edge</em>. If will be need this class could be inherited and virtual function <code>evalFunction</code> overload, to change function on the boundary of the domain.</p>
<p>The left hand side operator is used to calculate stiffness matrix, </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_edge_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::EdgeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  Mat <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a9075a5bb123d188ec0aef8276649fc28">mA</a>;</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a8467e1005aa32ba65be8bcdd2fe02161">OpAssmebleBcLhs</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,Mat m_a):</div>
<div class="line">  <a class="code hl_class" href="class_edge_element_forces_and_sources_core.html">EdgeElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROWCOL),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a9075a5bb123d188ec0aef8276649fc28">mA</a>(m_a) {}</div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">K</a>,<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a92f4959e7d57095a67e5b145ad0660d2">transK</a>;</div>
<div class="line">  PetscErrorCode <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#ac25633a7fc187f33cc2409f1ff892bb0">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> row_side,<span class="keywordtype">int</span> col_side,</div>
<div class="line">    EntityType row_type,EntityType col_type,</div>
<div class="line">    DataForcesAndSourcesCore::EntData &amp;row_data,</div>
<div class="line">    DataForcesAndSourcesCore::EntData &amp;col_data</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">    <span class="keywordflow">if</span>(row_nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">    <span class="keywordflow">if</span>(col_nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">K</a>.resize(row_nb_dofs,col_nb_dofs,<span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">K</a>.clear();</div>
<div class="line">    <span class="keywordtype">int</span> nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">      <span class="keywordtype">double</span> val = getLength()*getGaussPts()(1,gg);</div>
<div class="line">      VectorAdaptor row_n = row_data.getN(gg);</div>
<div class="line">      VectorAdaptor col_n = col_data.getN(gg);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">K</a>) += val*outer_prod(row_n,col_n);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a9075a5bb123d188ec0aef8276649fc28">mA</a>,</div>
<div class="line">      row_nb_dofs,&amp;*row_data.getIndices().data().begin(),</div>
<div class="line">      col_nb_dofs,&amp;*col_data.getIndices().data().begin(),</div>
<div class="line">      &amp;*<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">K</a>.data().begin()</div>
<div class="line">      ,ADD_VALUES</div>
<div class="line">    ); </div>
<div class="line">    <span class="comment">// Matrix is symmetric, assemble off diagonal part</span></div>
<div class="line">    <span class="keywordflow">if</span>(row_type != col_type || row_side != col_side) {</div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a92f4959e7d57095a67e5b145ad0660d2">transK</a>.resize(col_nb_dofs,row_nb_dofs,<span class="keyword">false</span>);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a92f4959e7d57095a67e5b145ad0660d2">transK</a>) = trans(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">K</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a9075a5bb123d188ec0aef8276649fc28">mA</a>,</div>
<div class="line">        col_nb_dofs,&amp;*col_data.getIndices().data().begin(),</div>
<div class="line">        row_nb_dofs,&amp;*row_data.getIndices().data().begin(),</div>
<div class="line">        &amp;*<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a92f4959e7d57095a67e5b145ad0660d2">transK</a>.data().begin()</div>
<div class="line">        ,ADD_VALUES</div>
<div class="line">      ); </div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a9c8c990b46b2b3994e4971b70f340074"><div class="ttname"><a href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MoFEM::MatSetValues</a></div><div class="ttdeci">MoFEMErrorCode MatSetValues(Mat M, const EntitiesFieldData::EntData &amp;row_data, const EntitiesFieldData::EntData &amp;col_data, const double *ptr, InsertMode iora)</div><div class="ttdoc">Assemble PETSc matrix.</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l01644">EntitiesFieldData.hpp:1644</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs</a></div><div class="ttdoc">Integrate vector on lhs,.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00139">MinimalSurfaceElement.hpp:140</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs_html_a8467e1005aa32ba65be8bcdd2fe02161"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a8467e1005aa32ba65be8bcdd2fe02161">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs::OpAssmebleBcLhs</a></div><div class="ttdeci">OpAssmebleBcLhs(const string field_name, Mat m_a)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00142">MinimalSurfaceElement.hpp:142</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs_html_a9075a5bb123d188ec0aef8276649fc28"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a9075a5bb123d188ec0aef8276649fc28">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs::mA</a></div><div class="ttdeci">Mat mA</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00141">MinimalSurfaceElement.hpp:141</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs_html_a92f4959e7d57095a67e5b145ad0660d2"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#a92f4959e7d57095a67e5b145ad0660d2">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs::transK</a></div><div class="ttdeci">MatrixDouble transK</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00146">MinimalSurfaceElement.hpp:146</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs_html_ac25633a7fc187f33cc2409f1ff892bb0"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#ac25633a7fc187f33cc2409f1ff892bb0">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, DataForcesAndSourcesCore::EntData &amp;row_data, DataForcesAndSourcesCore::EntData &amp;col_data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00147">MinimalSurfaceElement.hpp:147</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs_html_acff1995f776492fe405153937c0951cc"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html#acff1995f776492fe405153937c0951cc">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssmebleBcLhs::K</a></div><div class="ttdeci">MatrixDouble K</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00146">MinimalSurfaceElement.hpp:146</a></div></div>
</div><!-- fragment --><p> This operator has type <b>OPROWCOL</b>, it means that it loops over rows and columns and all possible combinations, taking in account that problem is symmetric. The values of shape functions at integration points are obtained by </p><div class="fragment"><div class="line">VectorAdaptor row_n = row_data.getN(gg);</div>
<div class="line">VectorAdaptor col_n = col_data.getN(gg);</div>
</div><!-- fragment --><p> where indices of degrees of freedom can be get by </p><div class="fragment"><div class="line">VectorInt &amp;row_indices = row_data.getIndices();</div>
<div class="line">VectorInt &amp;col_indices = col_data.getIndices();</div>
</div><!-- fragment --><p>Note that each operator has overload function <b>doWork</b>, depending which variant of a function is overloaded work is done on <em>rows</em>, <em>columns</em> or combinations or possible <em>rows</em> and <em>columns</em>. This member function is run for all adjacent entities to entity of the finite element.</p>
<p>Each finite element keeps vector of smart pointers to user data operators. The vector of smart pointer to operators in this particulate is accessed by </p><div class="fragment"><div class="line"><span class="comment">// Boundary problem</span></div>
<div class="line">MinimalSurfaceElement minimal_surface_element(m_field);</div>
<div class="line">boost::ptr_vector&lt;ForcesAndSourcesCore::UserDataOperator&gt; &amp;list_of_operators = minimal_surface_element.feBcEdge.getOpPtrVector();</div>
</div><!-- fragment --><p> Finally element is composed by adding to it operators, </p><div class="fragment"><div class="line"><span class="comment">// Push operators to finite element</span></div>
<div class="line">list_of_operators.push_back(<span class="keyword">new</span> MinimalSurfaceElement::OpAssmebleBcRhs(<span class="stringliteral">&quot;U&quot;</span>,<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>));</div>
<div class="line">list_of_operators.push_back(<span class="keyword">new</span> MinimalSurfaceElement::OpAssmebleBcLhs(<span class="stringliteral">&quot;U&quot;</span>,A));</div>
</div><!-- fragment --><p> which can be executed by <em>Discrete</em> <em>Manager</em>; </p><div class="fragment"><div class="line"><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMoFEMLoopFiniteElements(bc_dm,<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>,&amp;minimal_surface_element.feBcEdge); </div>
</div><!-- fragment --><h2><a class="anchor" id="main_implementation_minimal_surface_equation"></a>
Finite element for minimal surface area problem</h2>
<p>The minimal surface area is decomposed on several smaller operations. Note that implementation of operator and finite element is independent of the problem and if there will be need, all showed here operators can be reused in different context in to solve different problem.</p>
<p>Implementation starts with data structure (see <a class="el" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html" title="Keep date between operators.">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData</a>), shared between finite elements and <em>user</em> <em>data</em> <em>operators</em>. It could be understand as small memory pool, used to sharing and data exchange. Is used as well to accumulate results from different entities; </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData</a> {</div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>; <span class="comment">///&lt; nb_gauss_pts x 2 gradients at integration pts</span></div>
<div class="line">  VectorDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a4c699cfa98190e97ad0afcbe52333c59">normGradU2</a>; <span class="comment">///&lt; size of nb_gauss_pts, norm of gradient</span></div>
<div class="line">  VectorDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">aN</a>; <span class="comment">///&lt; size of nb_gauss_pts, \f$a_n = \frac{1}{\sqrt{1+\|u_i\|^2}}\f$</span></div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#acfcdc87e47186b9a4e9f4c3811c8f723">aNbyGradU</a>; <span class="comment">///&lt; nb_gauss_pts x 2, \f$a_n \nabla u\f$</span></div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a75741adcc2be81dc695efe1c022e9ca0">aNpow3byGradU</a>; <span class="comment">///&lt; nb_gauss_pts x 2, \f$a_n^3 \nabla u\f$</span></div>
<div class="line">};</div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData</a></div><div class="ttdoc">Keep date between operators.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00075">MinimalSurfaceElement.hpp:75</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data_html_a0d03218b19cf8ac68cfe1edfc0d39c00"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData::gradU</a></div><div class="ttdeci">MatrixDouble gradU</div><div class="ttdoc">nb_gauss_pts x 2 gradients at integration pts</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00076">MinimalSurfaceElement.hpp:76</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data_html_a4c699cfa98190e97ad0afcbe52333c59"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a4c699cfa98190e97ad0afcbe52333c59">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData::normGradU2</a></div><div class="ttdeci">VectorDouble normGradU2</div><div class="ttdoc">size of nb_gauss_pts, norm of gradient</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00077">MinimalSurfaceElement.hpp:77</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data_html_a579763c8fc02cc19a6e28bf0a3babffd"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData::aN</a></div><div class="ttdeci">VectorDouble aN</div><div class="ttdoc">size of nb_gauss_pts,</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00079">MinimalSurfaceElement.hpp:79</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data_html_a75741adcc2be81dc695efe1c022e9ca0"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a75741adcc2be81dc695efe1c022e9ca0">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData::aNpow3byGradU</a></div><div class="ttdeci">MatrixDouble aNpow3byGradU</div><div class="ttdoc">nb_gauss_pts x 2,</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00081">MinimalSurfaceElement.hpp:81</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data_html_acfcdc87e47186b9a4e9f4c3811c8f723"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#acfcdc87e47186b9a4e9f4c3811c8f723">MinimalSurfaceEquation::MinimalSurfaceElement::CommonData::aNbyGradU</a></div><div class="ttdeci">MatrixDouble aNbyGradU</div><div class="ttdoc">nb_gauss_pts x 2,</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00080">MinimalSurfaceElement.hpp:80</a></div></div>
</div><!-- fragment --><p>Next we implement a finite element on face entity, in this particular case on triangle </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element.html">MinimalSurfaceEquation::MinimalSurfaceElement::SurfaceElement</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">MoFEM::FaceElementForcesAndSourcesCore</a> {</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element.html#ab8a4039efd7dc75abb46d0ab0e79d810">SurfaceElement</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field):</div>
<div class="line">  <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>(m_field) {}<span class="comment"></span></div>
<div class="line"><span class="comment">  /** \brief Set integrate rule</span></div>
<div class="line"><span class="comment">  */</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element.html#ac9d582ef5444778b726108c715093d88">getRule</a>(<span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) { <span class="keywordflow">return</span> 2*(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>-1)+1; };</div>
<div class="line">};</div>
<div class="ttc" id="aclass_face_element_forces_and_sources_core_html"><div class="ttname"><a href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element.html">MinimalSurfaceEquation::MinimalSurfaceElement::SurfaceElement</a></div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00041">MinimalSurfaceElement.hpp:41</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element_html_ab8a4039efd7dc75abb46d0ab0e79d810"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element.html#ab8a4039efd7dc75abb46d0ab0e79d810">MinimalSurfaceEquation::MinimalSurfaceElement::SurfaceElement::SurfaceElement</a></div><div class="ttdeci">SurfaceElement(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00042">MinimalSurfaceElement.hpp:42</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element_html_ac9d582ef5444778b726108c715093d88"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_surface_element.html#ac9d582ef5444778b726108c715093d88">MinimalSurfaceEquation::MinimalSurfaceElement::SurfaceElement::getRule</a></div><div class="ttdeci">int getRule(int order)</div><div class="ttdoc">Set integrate rule.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00047">MinimalSurfaceElement.hpp:47</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_face_element_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition</b> <a href="_face_element_forces_and_sources_core_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
</div><!-- fragment --><p> where here only function controlling quadrature rule is overloaded.</p>
<p>The actual work, i.e. integration of residual and tangent matrix, is made by operators. Here we break down work on smaller four task. In first <em>user</em> <em>data</em> <em>operator</em> is implemented to calculate displacement gradient at each integration points; </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a306c52f7097099cd6d87446cf5582a6a">commonData</a>;</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a87d330c27c4fa820c648e49d6742bde7">OpGetDataAtGaussPts</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;common_data):</div>
<div class="line">  <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPCOL),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a306c52f7097099cd6d87446cf5582a6a">commonData</a>(common_data) {</div>
<div class="line">  }</div>
<div class="line">  PetscErrorCode <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a3decad04d49c9381b92df8b22363c07f">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> side,EntityType type,DataForcesAndSourcesCore::EntData &amp;data</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordtype">int</span> nb_dofs = data.getFieldData().size();</div>
<div class="line">    <span class="keywordflow">if</span>(nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">    <span class="comment">// Element loops over entities, it start from vertices</span></div>
<div class="line">    <span class="keywordflow">if</span>(type == MBVERTEX) {</div>
<div class="line">      <span class="comment">// Setting size of common data vectors</span></div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a306c52f7097099cd6d87446cf5582a6a">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>.resize(nb_gauss_pts,2);</div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a306c52f7097099cd6d87446cf5582a6a">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>.clear();</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MatrixAdaptor</a> grad_shape_fun = data.getDiffN(gg);</div>
<div class="line">      ublas::matrix_row&lt;MatrixDouble &gt; grad_at_gauss_pt(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a306c52f7097099cd6d87446cf5582a6a">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>,gg);</div>
<div class="line">      noalias(grad_at_gauss_pt) += prod(trans(grad_shape_fun),data.getFieldData());</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_ab467fcf0a32d31e9e038d1188ed8958f"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MoFEM::Types::MatrixAdaptor</a></div><div class="ttdeci">MatrixShallowArrayAdaptor&lt; double &gt; MatrixAdaptor</div><div class="ttdoc">Matrix adaptor.</div><div class="ttdef"><b>Definition</b> <a href="_types_8hpp_source.html#l00132">Types.hpp:132</a></div></div>
<div class="ttc" id="astruct_common_data_html"><div class="ttname"><a href="struct_common_data.html">CommonData</a></div><div class="ttdef"><b>Definition</b> <a href="continuity__check__on__skeleton__with__simple__2d__for__h1_8cpp_source.html#l00022">continuity_check_on_skeleton_with_simple_2d_for_h1.cpp:22</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts</a></div><div class="ttdoc">Evaluate function values and gradients at Gauss Pts.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00190">MinimalSurfaceElement.hpp:191</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts_html_a306c52f7097099cd6d87446cf5582a6a"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a306c52f7097099cd6d87446cf5582a6a">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts::commonData</a></div><div class="ttdeci">CommonData &amp; commonData</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00192">MinimalSurfaceElement.hpp:192</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts_html_a3decad04d49c9381b92df8b22363c07f"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a3decad04d49c9381b92df8b22363c07f">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int side, EntityType type, DataForcesAndSourcesCore::EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00198">MinimalSurfaceElement.hpp:198</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts_html_a87d330c27c4fa820c648e49d6742bde7"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html#a87d330c27c4fa820c648e49d6742bde7">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts::OpGetDataAtGaussPts</a></div><div class="ttdeci">OpGetDataAtGaussPts(const string field_name, CommonData &amp;common_data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00193">MinimalSurfaceElement.hpp:193</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition</b> <a href="_face_element_forces_and_sources_core_8hpp_source.html#l00094">FaceElementForcesAndSourcesCore.hpp:95</a></div></div>
</div><!-- fragment --><p> This is operator of type <b>OPCOL</b>, it is executed on adjacent entities to finite element entity (in this case, triangle element is adjacent to three vertices, three edges and one face). For each finite element loop over entities starts always from lowest possible entity dimension i.e. vertices, this is exploited here to setup common data structure, i.e. to set sizes and clear vectors and matrixes.</p>
<p>Next coefficients in linearized week from are evaluated; </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>;</div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6550ca6aca874dc92779f5af2f98877d">rhsAndNotLhs</a>;</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a4a64564ca42394a1b414d4eeabe43782">OpCalculateCoefficientsAtGaussPts</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;common_data,<span class="keywordtype">bool</span> rhs_and_not_lhs):</div>
<div class="line">  <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>(common_data),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6550ca6aca874dc92779f5af2f98877d">rhsAndNotLhs</a>(rhs_and_not_lhs) {</div>
<div class="line">  }</div>
<div class="line">  PetscErrorCode <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a13bd4f19a5c1ba4b4a0cf7d10bab0a19">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> side,EntityType type,DataForcesAndSourcesCore::EntData &amp;data</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// Element loops over entities, it start from vertices</span></div>
<div class="line">    <span class="keywordflow">if</span>(type == MBVERTEX) {</div>
<div class="line">      <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a4c699cfa98190e97ad0afcbe52333c59">normGradU2</a>.resize(nb_gauss_pts,<span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">        ublas::matrix_row&lt;MatrixDouble &gt; grad_at_gauss_pt(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>,gg);</div>
<div class="line">        <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a4c699cfa98190e97ad0afcbe52333c59">normGradU2</a>[gg] = inner_prod(grad_at_gauss_pt,grad_at_gauss_pt);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">aN</a>.resize(nb_gauss_pts,<span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">        <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">aN</a>[gg] = 1./sqrt(1+<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a4c699cfa98190e97ad0afcbe52333c59">normGradU2</a>[gg]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span>(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6550ca6aca874dc92779f5af2f98877d">rhsAndNotLhs</a>) {</div>
<div class="line">        <span class="comment">// needed at right hand side when residual is calculated</span></div>
<div class="line">        <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#acfcdc87e47186b9a4e9f4c3811c8f723">aNbyGradU</a>.resize(nb_gauss_pts,2,<span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">          ublas::matrix_row&lt;MatrixDouble &gt; grad_at_gauss_pt(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>,gg);</div>
<div class="line">          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rr = 0;rr!=2;rr++) {</div>
<div class="line">            <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#acfcdc87e47186b9a4e9f4c3811c8f723">aNbyGradU</a>(gg,rr) = <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">aN</a>[gg]*grad_at_gauss_pt[rr];</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// needed at left hand side when matrix is calculated</span></div>
<div class="line">        <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a75741adcc2be81dc695efe1c022e9ca0">aNpow3byGradU</a>.resize(nb_gauss_pts,2,<span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">          ublas::matrix_row&lt;MatrixDouble &gt; grad_at_gauss_pt(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>,gg);</div>
<div class="line">          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> rr = 0;rr!=2;rr++) {</div>
<div class="line">            <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a75741adcc2be81dc695efe1c022e9ca0">aNpow3byGradU</a>(gg,rr) = pow(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">aN</a>[gg],3)*grad_at_gauss_pt[rr];</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts</a></div><div class="ttdoc">Evaluate function values and gradients at Gauss Pts.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00228">MinimalSurfaceElement.hpp:229</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts_html_a13bd4f19a5c1ba4b4a0cf7d10bab0a19"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a13bd4f19a5c1ba4b4a0cf7d10bab0a19">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int side, EntityType type, DataForcesAndSourcesCore::EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00239">MinimalSurfaceElement.hpp:239</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts_html_a4a64564ca42394a1b414d4eeabe43782"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a4a64564ca42394a1b414d4eeabe43782">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts::OpCalculateCoefficientsAtGaussPts</a></div><div class="ttdeci">OpCalculateCoefficientsAtGaussPts(const string field_name, CommonData &amp;common_data, bool rhs_and_not_lhs)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00232">MinimalSurfaceElement.hpp:232</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts_html_a6052b799888be3d071d1144dbb6d3bec"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6052b799888be3d071d1144dbb6d3bec">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts::commonData</a></div><div class="ttdeci">CommonData &amp; commonData</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00230">MinimalSurfaceElement.hpp:230</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts_html_a6550ca6aca874dc92779f5af2f98877d"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html#a6550ca6aca874dc92779f5af2f98877d">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts::rhsAndNotLhs</a></div><div class="ttdeci">bool rhsAndNotLhs</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00231">MinimalSurfaceElement.hpp:231</a></div></div>
</div><!-- fragment --><p> This operator has two variants controlled by variable <code>rhsAndNotLhs</code>, depending if is executed when left or right hand side is calculated, different set of coefficients is needed. Note that coefficients are calculated for given value of gradient already calculated in different data operator.</p>
<p>Once coefficients are calculated residual vector is assembled; </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#aebf214d019633d67d683645446396c0f">commonData</a>;</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a2a4ce621bd2c71bc6a10d969fa9bf7fd">OpAssembleResidaul</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;common_data):</div>
<div class="line">  <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROW),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#aebf214d019633d67d683645446396c0f">commonData</a>(common_data) {</div>
<div class="line">  }</div>
<div class="line">  VectorDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a01058ecb122dbc3c24136c5312734b35">rEsidual</a>;</div>
<div class="line">  PetscErrorCode <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#ae2aba453052dec78640ad82200b21acb">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> side,EntityType type,DataForcesAndSourcesCore::EntData &amp;data</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> nb_dofs = data.getIndices().size();</div>
<div class="line">    <span class="keywordflow">if</span>(nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a01058ecb122dbc3c24136c5312734b35">rEsidual</a>.resize(nb_dofs,<span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a01058ecb122dbc3c24136c5312734b35">rEsidual</a>.clear();</div>
<div class="line">    <span class="keywordtype">int</span> nb_gauss_pts = data.getN().size1();</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">      <span class="keywordtype">double</span> val = getGaussPts()(2,gg)*getArea();</div>
<div class="line">      ublas::matrix_row&lt;MatrixDouble &gt; an_by_grad_u(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#aebf214d019633d67d683645446396c0f">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#acfcdc87e47186b9a4e9f4c3811c8f723">aNbyGradU</a>,gg);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a01058ecb122dbc3c24136c5312734b35">rEsidual</a>)+=val*prod(data.getDiffN(gg),an_by_grad_u);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#aef01d33cbe1d8ed916ce789bd25c4495">VecSetValues</a>(</div>
<div class="line">      getFEMethod()-&gt;snes_f,</div>
<div class="line">      data.getIndices().size(),</div>
<div class="line">      &amp;*data.getIndices().data().begin(),</div>
<div class="line">      &amp;<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a01058ecb122dbc3c24136c5312734b35">rEsidual</a>[0],</div>
<div class="line">      ADD_VALUES</div>
<div class="line">    ); </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul</a></div><div class="ttdoc">Assemble residual.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00295">MinimalSurfaceElement.hpp:296</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul_html_a01058ecb122dbc3c24136c5312734b35"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a01058ecb122dbc3c24136c5312734b35">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul::rEsidual</a></div><div class="ttdeci">VectorDouble rEsidual</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00302">MinimalSurfaceElement.hpp:302</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul_html_a2a4ce621bd2c71bc6a10d969fa9bf7fd"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#a2a4ce621bd2c71bc6a10d969fa9bf7fd">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul::OpAssembleResidaul</a></div><div class="ttdeci">OpAssembleResidaul(const string field_name, CommonData &amp;common_data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00298">MinimalSurfaceElement.hpp:298</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul_html_ae2aba453052dec78640ad82200b21acb"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#ae2aba453052dec78640ad82200b21acb">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int side, EntityType type, DataForcesAndSourcesCore::EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00303">MinimalSurfaceElement.hpp:303</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul_html_aebf214d019633d67d683645446396c0f"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html#aebf214d019633d67d683645446396c0f">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul::commonData</a></div><div class="ttdeci">CommonData &amp; commonData</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00297">MinimalSurfaceElement.hpp:297</a></div></div>
</div><!-- fragment --><p> and tangent matrix </p><div class="fragment"><div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent</a>: <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line">  <a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a4fa02078d1e047169854fbb655d9b890">commonData</a>;</div>
<div class="line">  <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a9868300bce8dad3cd81e7510655e8df8">OpAssembleTangent</a>(<span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_struct" href="struct_common_data.html">CommonData</a> &amp;common_data):</div>
<div class="line">  <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>::<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,<a class="code hl_typedef" href="_hooke_element_8hpp.html#aee27a2ebc8f3d34a5c1ce71b2607d1a3">UserDataOperator</a>::OPROWCOL),</div>
<div class="line">  <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a4fa02078d1e047169854fbb655d9b890">commonData</a>(common_data) {</div>
<div class="line">    sYmm = <span class="keyword">false</span>; <span class="comment">// matrix is not symmetric</span></div>
<div class="line">  }</div>
<div class="line">  MatrixDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#ad3aeebb86c155957d035c10712710b1f">kTangent</a>,<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#adce52ca6c616381d6cbe2ae776faa0ee">auxMat</a>;</div>
<div class="line">  VectorDouble <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a63903e5170f171d20322afc079d468aa">auxVec</a>;</div>
<div class="line">  PetscErrorCode    <a class="code hl_function" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#aa482059fa36effe1d5b49d985d87b96b">doWork</a>(</div>
<div class="line">    <span class="keywordtype">int</span> row_side,<span class="keywordtype">int</span> col_side,</div>
<div class="line">    EntityType row_type, EntityType col_type,</div>
<div class="line">    DataForcesAndSourcesCore::EntData &amp;row_data,</div>
<div class="line">    DataForcesAndSourcesCore::EntData &amp;col_data</div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">int</span> row_nb_dofs = row_data.getIndices().size();</div>
<div class="line">    <span class="keywordflow">if</span>(row_nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordtype">int</span> col_nb_dofs = col_data.getIndices().size();</div>
<div class="line">    <span class="keywordflow">if</span>(col_nb_dofs == 0) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#ad3aeebb86c155957d035c10712710b1f">kTangent</a>.resize(row_nb_dofs,col_nb_dofs,<span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#ad3aeebb86c155957d035c10712710b1f">kTangent</a>.clear();</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a63903e5170f171d20322afc079d468aa">auxVec</a>.resize(col_nb_dofs,<span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#adce52ca6c616381d6cbe2ae776faa0ee">auxMat</a>.resize(col_nb_dofs,2,<span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordtype">int</span> nb_gauss_pts = row_data.getN().size1();</div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> gg = 0;gg!=nb_gauss_pts;gg++) {</div>
<div class="line">      <span class="keywordtype">double</span> val = getGaussPts()(2,gg)*getArea();</div>
<div class="line">      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MatrixAdaptor</a> row_diff_n = row_data.getDiffN(gg);</div>
<div class="line">      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#ab467fcf0a32d31e9e038d1188ed8958f">MatrixAdaptor</a> col_diff_n = col_data.getDiffN(gg);</div>
<div class="line">      <span class="keywordtype">double</span> an = <a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a4fa02078d1e047169854fbb655d9b890">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a579763c8fc02cc19a6e28bf0a3babffd">aN</a>[gg];</div>
<div class="line">      ublas::matrix_row&lt;MatrixDouble &gt; grad_u(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a4fa02078d1e047169854fbb655d9b890">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a0d03218b19cf8ac68cfe1edfc0d39c00">gradU</a>,gg);</div>
<div class="line">      ublas::matrix_row&lt;MatrixDouble &gt; an_pow3_by_grad_u(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a4fa02078d1e047169854fbb655d9b890">commonData</a>.<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html#a75741adcc2be81dc695efe1c022e9ca0">aNpow3byGradU</a>,gg);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a63903e5170f171d20322afc079d468aa">auxVec</a>) = prod(col_diff_n,an_pow3_by_grad_u);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#adce52ca6c616381d6cbe2ae776faa0ee">auxMat</a>) = outer_prod(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a63903e5170f171d20322afc079d468aa">auxVec</a>,grad_u);</div>
<div class="line">      noalias(<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#ad3aeebb86c155957d035c10712710b1f">kTangent</a>) += val*prod(row_diff_n,trans(an*col_diff_n-<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#adce52ca6c616381d6cbe2ae776faa0ee">auxMat</a>));</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a9c8c990b46b2b3994e4971b70f340074">MatSetValues</a>(</div>
<div class="line">      getFEMethod()-&gt;snes_B,</div>
<div class="line">      row_nb_dofs,&amp;*row_data.getIndices().data().begin(),</div>
<div class="line">      col_nb_dofs,&amp;*col_data.getIndices().data().begin(),</div>
<div class="line">      &amp;*<a class="code hl_variable" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#ad3aeebb86c155957d035c10712710b1f">kTangent</a>.data().begin()</div>
<div class="line">      ,ADD_VALUES</div>
<div class="line">    ); </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent</a></div><div class="ttdoc">Assemble tangent matrix.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00328">MinimalSurfaceElement.hpp:329</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html_a4fa02078d1e047169854fbb655d9b890"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a4fa02078d1e047169854fbb655d9b890">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent::commonData</a></div><div class="ttdeci">CommonData &amp; commonData</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00330">MinimalSurfaceElement.hpp:330</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html_a63903e5170f171d20322afc079d468aa"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a63903e5170f171d20322afc079d468aa">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent::auxVec</a></div><div class="ttdeci">VectorDouble auxVec</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00338">MinimalSurfaceElement.hpp:338</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html_a9868300bce8dad3cd81e7510655e8df8"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#a9868300bce8dad3cd81e7510655e8df8">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent::OpAssembleTangent</a></div><div class="ttdeci">OpAssembleTangent(const string field_name, CommonData &amp;common_data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00331">MinimalSurfaceElement.hpp:331</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html_aa482059fa36effe1d5b49d985d87b96b"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#aa482059fa36effe1d5b49d985d87b96b">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent::doWork</a></div><div class="ttdeci">PetscErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, DataForcesAndSourcesCore::EntData &amp;row_data, DataForcesAndSourcesCore::EntData &amp;col_data)</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00340">MinimalSurfaceElement.hpp:340</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html_ad3aeebb86c155957d035c10712710b1f"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#ad3aeebb86c155957d035c10712710b1f">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent::kTangent</a></div><div class="ttdeci">MatrixDouble kTangent</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00337">MinimalSurfaceElement.hpp:337</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent_html_adce52ca6c616381d6cbe2ae776faa0ee"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html#adce52ca6c616381d6cbe2ae776faa0ee">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent::auxMat</a></div><div class="ttdeci">MatrixDouble auxMat</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00339">MinimalSurfaceElement.hpp:339</a></div></div>
</div><!-- fragment --><p>Finally when finite element and entity operators are implemented, we add operators to finite elements instances, we do that staring from the right hand side operator </p><div class="fragment"><div class="line"><span class="comment">// Data structure for common data</span></div>
<div class="line">MinimalSurfaceElement::CommonData mse_common_data;</div>
<div class="line"><span class="comment">// Right hand side operators (run for each entity in element)</span></div>
<div class="line"><span class="comment">// Calculate inverse of the Jacobian</span></div>
<div class="line">minimal_surface_element.feRhs.getOpPtrVector().push_back(<span class="keyword">new</span> OpCalculateHOJacForFace(jac_ptr));</div>
<div class="line">minimal_surface_element.feRhs.getOpPtrVector().push_back(<span class="keyword">new</span> OpInvertMatrix&lt;2&gt;(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line"><span class="comment">// Apply inv_jac_ptr to shape functions</span></div>
<div class="line">minimal_surface_element.feRhs.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">MoFEM::OpSetInvJacH1ForFace</a>(inv_jac_ptr));</div>
<div class="line"><span class="comment">// Below operators are specific to minimal area problem</span></div>
<div class="line">minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;U&quot;</span>,mse_common_data)</div>
<div class="line">);</div>
<div class="line">minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts</a>(<span class="stringliteral">&quot;U&quot;</span>,mse_common_data,<span class="keyword">true</span>)</div>
<div class="line">);</div>
<div class="line">minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleResidaul</a>(<span class="stringliteral">&quot;U&quot;</span>,mse_common_data)</div>
<div class="line">);</div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">MoFEM::OpSetInvJacH1ForFace</a></div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l03322">UserDataOperators.hpp:3323</a></div></div>
</div><!-- fragment --><p> and left hand side operator </p><div class="fragment"><div class="line"><span class="comment">// Calculate inverse of the Jacobian</span></div>
<div class="line">minimal_surface_element.feLhs.getOpPtrVector().push_back(<span class="keyword">new</span> OpCalculateHOJacForFace(jac_ptr));</div>
<div class="line">minimal_surface_element.feLhs.getOpPtrVector().push_back(<span class="keyword">new</span> OpInvertMatrix&lt;2&gt;(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">minimal_surface_element.feLhs.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">MoFEM::OpSetInvJacH1ForFace</a>(inv_jac_ptr));</div>
<div class="line"><span class="comment">// Below operators are specific to minimal area problem</span></div>
<div class="line">minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;U&quot;</span>,mse_common_data)</div>
<div class="line">);</div>
<div class="line">minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts</a>(<span class="stringliteral">&quot;U&quot;</span>,mse_common_data,<span class="keyword">false</span>)</div>
<div class="line">);</div>
<div class="line">minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">  <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html">MinimalSurfaceEquation::MinimalSurfaceElement::OpAssembleTangent</a>(<span class="stringliteral">&quot;U&quot;</span>,mse_common_data)</div>
<div class="line">);</div>
</div><!-- fragment --><p> Note that general purpose operators MoFEM::OpCalculateJacForFace, OpInvertMatrix, and <a class="el" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">MoFEM::OpSetInvJacH1ForFace</a> are used to calculate inverse of the Jacobian, and apply it to gradient of shape functions. Those two operators are implemented as a part core <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library and are used in different contexts if needed.</p>
<p>All operators are run in order which are pushed to given element, so that first inverse of the Jacobian is calculated, then transverse of the inverse of the the Jacobian matrix it is applied to gradients of shape functions, next field gradient is calculated, then coefficients and finally residual vector or tangent matrix.</p>
<p>The elements for the right hand side and the left hand side calculations are added to SNES elements using following code; </p><div class="fragment"><div class="line">DMMoFEMSNESSetFunction(dm,<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,&amp;minimal_surface_element.feRhs,PETSC_NULL,PETSC_NULL);</div>
<div class="line">DMMoFEMSNESSetJacobian(dm,<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,&amp;minimal_surface_element.feLhs,PETSC_NULL,PETSC_NULL);</div>
</div><!-- fragment --><h1><a class="anchor" id="example_minimal_surface_equation"></a>
Example</h1>
<p>Running code: </p><div class="fragment"><div class="line">cd $MOFEM_INSTALL_DIR/users_modules/minimal_surface_equationa</div>
<div class="line">mpirun -np 4 ./minimal_surface_area \</div>
<div class="line">-my_file meshes/circle.h5m \</div>
<div class="line">-ksp_monitor -ksp_converged_reason \</div>
<div class="line">-pc_type lu -pc_factor_mat_solver_package mumps -mat_mumps_icntl_20 0 \</div>
<div class="line">-snes_linesearch_type l2 -snes_linesearch_monitor -snes_linesearch_minlambda 0.01 \</div>
<div class="line">-snes_monitor -snes_converged_reason \</div>
<div class="line">-my_order 4 -my_nb_sub_steps 60 &amp;&amp; \</div>
<div class="line">mbconvert out.h5m out.vtk</div>
</div><!-- fragment --><dl class="section note"><dt>Note</dt><dd>If you woring in build directory meshes are located in moudle source directory. If you working in install directory meshes are located in your current directory.</dd></dl>
<p>Program <b>minimal_surface_equationa</b> is started using <b>mpirun</b>, where the number of processors is selected to four in above example. The key parameters are order or approximation and number of sub-steps. In addition user can select different types of line-searchers or change SNES solver and select trust method. More details are available in PETSc documentation of SNES solver, see for details <a href="http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/SNES/SNESSetFromOptions.html">http://www.mcs.anl.gov/petsc/petsc-current/docs/manualpages/SNES/SNESSetFromOptions.html</a>.</p>
<p>In this particular example is run for circular wire loop, function on boundary is given by   </p><p class="formulaDsp">
\[
u = \sin \left[ \pi (x+y) \right],\quad \textrm{on}\,\partial\Omega
\]
</p>
<div class="image">
<img src="minimal_surface_equation.gif" alt=""/>
<div class="caption">
Soap film spanned between circular wire</div></div>
<p>Mesh file is created with Cubit <a href="https://cubit.sandia.gov">https://cubit.sandia.gov</a> </p><div class="fragment"><div class="line">reset</div>
<div class="line">#create surface circle radius 1 zplane </div>
<div class="line">create surface rectangle width 2 height 2 zplane</div>
<div class="line">surface all scheme TriMesh</div>
<div class="line">surface all size auto factor 6</div>
<div class="line">mesh surface all</div>
<div class="line">refine curve all  numsplit 2 bias 1.0 depth 1 smooth</div>
</div><!-- fragment --><h1><a class="anchor" id="future_work_minimal_surface_equation"></a>
Future work and contribution</h1>
<p>If you like to contribute to this module (or <a class="el" href="namespace_mo_f_e_m.html" title="implementation of Data Operators for Forces and Sources">MoFEM</a> library), you are very welcome. Pleas feel free to add changes, including improving this documentation. If you like to work and modify this user module, you can fork this repository, make your changes, and do pull request. <a class="el" href="struct_contact.html">Contact</a> us <a href="#" onclick="location.href='mai'+'lto:'+'cma'+'tg'+'u@g'+'oo'+'gle'+'gr'+'oup'+'s.'+'com'; return false;">cmatg<span class="obfuscator">.nosp@m.</span>u@go<span class="obfuscator">.nosp@m.</span>ogleg<span class="obfuscator">.nosp@m.</span>roup<span class="obfuscator">.nosp@m.</span>s.com</a> or <a href="https://mofem.slack.com/">https://mofem.slack.com/</a> if you need any help or comments.</p>
<p>This is work in progress and more stuff can be done. You could consider own paper or student project.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000089">Todo</a></b></dt><dd><p class="startdd">Make this documentation better </p>
<p class="interdd">Error estimator for L2, H1 and H1 semi-norm </p>
<p class="interdd">Mesh hp-adaptivity (All tools are there, need be used in this example). </p>
<p class="interdd">Generalization to arbitrary wire curve in 3d space. </p>
<p class="interdd">Write documentation about mesh bit levels and mesh refining. </p>
<p class="interdd">Convergence analysis h- vs. p- refinement. </p>
<p class="enddd">Adaptive time stepping</p>
</dd></dl>
<h1><a class="anchor" id="mai_minimal_surface_equation"></a>
The plain program</h1>
<div class="fragment"><div class="line"><span class="comment">/** \file minimal_surface_area.cpp</span></div>
<div class="line"><span class="comment">  \example minimal_surface_area.cpp</span></div>
<div class="line"><span class="comment">  \brief Minimal surface area</span></div>
<div class="line"><span class="comment">  \ingroup minimal_surface_area</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  Implementation is based on:</span></div>
<div class="line"><span class="comment">  &lt;https://www.dealii.org/developer/doxygen/deal.II/step_15.html&gt; Look for</span></div>
<div class="line"><span class="comment">  formulation details on deal.II web page.</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  \todo Make this example with heterogenous approx. apace</span></div>
<div class="line"><span class="comment">  \todo Make this example with several refined meshes</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">*/</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">/* This file is part of MoFEM.</span></div>
<div class="line"><span class="comment"> * MoFEM is free software: you can redistribute it and/or modify it under</span></div>
<div class="line"><span class="comment"> * the terms of the GNU Lesser General Public License as published by the</span></div>
<div class="line"><span class="comment"> * Free Software Foundation, either version 3 of the License, or (at your</span></div>
<div class="line"><span class="comment"> * option) any later version.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * MoFEM is distributed in the hope that it will be useful, but WITHOUT</span></div>
<div class="line"><span class="comment"> * ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or</span></div>
<div class="line"><span class="comment"> * FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> * License for more details.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * You should have received a copy of the GNU Lesser General Public</span></div>
<div class="line"><span class="comment"> * License along with MoFEM. If not, see &lt;http://www.gnu.org/licenses/&gt;. */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;MethodForForceScaling.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_dirichlet_b_c_8hpp.html">DirichletBC.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_post_proc_on_ref_mesh_8hpp.html">PostProcOnRefMesh.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_minimal_surface_element_8hpp.html">MinimalSurfaceElement.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_minimal_surface_equation.html">MinimalSurfaceEquation</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, (<span class="keywordtype">char</span> *)0, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    moab::Core mb_instance;</div>
<div class="line">    moab::Interface &amp;moab = mb_instance;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">char</span> <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>[255];</div>
<div class="line">    PetscInt <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 2;</div>
<div class="line">    PetscInt nb_sub_steps = 10;</div>
<div class="line">    PetscBool flg_file = PETSC_FALSE;</div>
<div class="line">    PetscBool is_partitioned = PETSC_FALSE;</div>
<div class="line">    PetscBool is_atom_test = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;Minimal surface area config&quot;</span>, <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_file&quot;</span>, <span class="stringliteral">&quot;mesh file name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;mesh.h5m&quot;</span>,</div>
<div class="line">                                <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 255, &amp;flg_file);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_order&quot;</span>, <span class="stringliteral">&quot;default approximation order&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 2,</div>
<div class="line">                             &amp;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, PETSC_NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-my_nb_sub_steps&quot;</span>, <span class="stringliteral">&quot;number of substeps&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, 10,</div>
<div class="line">                             &amp;nb_sub_steps, PETSC_NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-my_is_partitioned&quot;</span>,</div>
<div class="line">                              <span class="stringliteral">&quot;set if mesh is partitioned (this result that &quot;</span></div>
<div class="line">                              <span class="stringliteral">&quot;each process keeps only part of the mesh&quot;</span>,</div>
<div class="line">                              <span class="stringliteral">&quot;&quot;</span>, PETSC_FALSE, &amp;is_partitioned, PETSC_NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(</div>
<div class="line">          <span class="stringliteral">&quot;-my_is_atom_test&quot;</span>,</div>
<div class="line">          <span class="stringliteral">&quot;is used with testing, exit with error when diverged&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">          PETSC_FALSE, &amp;is_atom_test, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a> = PetscOptionsEnd();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Reade parameters from line command</span></div>
<div class="line">      <span class="keywordflow">if</span> (flg_file != PETSC_TRUE) {</div>
<div class="line">        SETERRQ(PETSC_COMM_SELF, 1, <span class="stringliteral">&quot;*** ERROR -my_file (MESH FILE NEEDED)&quot;</span>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (is_partitioned == PETSC_TRUE) {</div>
<div class="line">        <span class="comment">// Read mesh to MOAB</span></div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">        option = <span class="stringliteral">&quot;PARALLEL=BCAST_DELETE;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;PARALLEL_RESOLVE_SHARED_ENTS;&quot;</span></div>
<div class="line">                 <span class="stringliteral">&quot;PARTITION=PARALLEL_PARTITION;&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">        option = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line">      }</div>
<div class="line">      ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">      <span class="keywordflow">if</span> (pcomm == NULL)</div>
<div class="line">        pcomm = <span class="keyword">new</span> ParallelComm(&amp;moab, PETSC_COMM_WORLD);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
<div class="line">    <span class="comment">// meshset consisting all entities in mesh</span></div>
<div class="line">    <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> root_set = moab.get_root_set();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Seed all mesh entities to MoFEM database, those entities can be</span></div>
<div class="line">    <span class="comment">// potentially used as finite elements or as entities which carry some</span></div>
<div class="line">    <span class="comment">// approximation field.</span></div>
<div class="line">    BitRefLevel bit_level0;</div>
<div class="line">    bit_level0.set(0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevelByDim(</div>
<div class="line">        0, 2, bit_level0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add field</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">    <span class="comment">// Add entities to field (root_mesh, i.e. on all mesh entities fields are</span></div>
<div class="line">    <span class="comment">// approx.) On those entities and lower dimension entities approximation is</span></div>
<div class="line">    <span class="comment">// spaned,</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(root_set, MBTRI, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <span class="comment">// Set approximation oder</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set, MBTRI, <span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set, MBEDGE, <span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(root_set, MBVERTEX, <span class="stringliteral">&quot;U&quot;</span>, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add finite element (this defines element declaration comes later)</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>);</div>
<div class="line">    <span class="comment">// Set on which fields that element operates</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(</div>
<div class="line">        <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(</div>
<div class="line">        <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(</div>
<div class="line">        <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <span class="comment">// Add entities to that element</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(</div>
<div class="line">        root_set, MBTRI, <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<span class="stringliteral">&quot;BC_ELEMENT&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    <span class="comment">// Add entities to that element</span></div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> bc_edges, bc_ents;</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Take a skin form the mesh</span></div>
<div class="line">      Skinner skin(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> tris;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_entities_by_type(root_set, MBTRI, tris, <span class="keyword">false</span>);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> bc_edges;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(root_set, tris, <span class="keyword">false</span>, bc_edges);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> bc_nodes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(bc_edges, bc_nodes);</div>
<div class="line">      bc_ents.merge(bc_edges);</div>
<div class="line">      bc_ents.merge(bc_nodes);</div>
<div class="line">      <span class="comment">// Add entities to that element</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(bc_edges, MBEDGE,</div>
<div class="line">                                                        <span class="stringliteral">&quot;BC_ELEMENT&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build finite elements</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>();</div>
<div class="line">    <span class="comment">// build adjacencies between elements and degrees of freedom</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(bit_level0);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create minimal surface area and elements</span></div>
<div class="line">    <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element.html">MinimalSurfaceElement</a> minimal_surface_element(m_field);</div>
<div class="line">    <span class="comment">// Data structure for common data</span></div>
<div class="line">    <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_common_data.html">MinimalSurfaceElement::CommonData</a> mse_common_data;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// This class is used to fix dofs on entities</span></div>
<div class="line">    <a class="code hl_struct" href="struct_dirichlet_fix_field_at_entities_bc.html">DirichletFixFieldAtEntitiesBc</a> fix_edges_ents(m_field, <span class="stringliteral">&quot;U&quot;</span>, NULL, NULL, NULL,</div>
<div class="line">                                                 bc_ents);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(<span class="stringliteral">&quot;MoFEM&quot;</span>);</div>
<div class="line">    <span class="comment">// Solve BC problem</span></div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// define problems</span></div>
<div class="line">      DM bc_dm;</div>
<div class="line">      <span class="comment">// Register DM problem</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;bc_dm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(bc_dm, <span class="stringliteral">&quot;MoFEM&quot;</span>);</div>
<div class="line">      <span class="comment">// Create DM instance</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(bc_dm, &amp;m_field, <span class="stringliteral">&quot;DM_BC&quot;</span>, bit_level0);</div>
<div class="line">      <span class="comment">// Configure DM form line command options (DM itself, solvers,</span></div>
<div class="line">      <span class="comment">// pre-conditioners, ... )</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(bc_dm);</div>
<div class="line">      <span class="comment">// Add elements to dm (only one here)</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(bc_dm, <span class="stringliteral">&quot;BC_ELEMENT&quot;</span>);</div>
<div class="line">      <span class="comment">// Set up problem (number dofs, partition mesh, etc.)</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(bc_dm);</div>
<div class="line">      Mat <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line">      Vec T, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(bc_dm, &amp;T);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(T, &amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(bc_dm, &amp;A);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Boundary problem</span></div>
<div class="line">      minimal_surface_element.feBcEdge.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_rhs.html">MinimalSurfaceElement::OpAssmebleBcRhs</a>(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>));</div>
<div class="line">      minimal_surface_element.feBcEdge.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assmeble_bc_lhs.html">MinimalSurfaceElement::OpAssmebleBcLhs</a>(<span class="stringliteral">&quot;U&quot;</span>, A));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(bc_dm, <span class="stringliteral">&quot;BC_ELEMENT&quot;</span>,</div>
<div class="line">                                      &amp;minimal_surface_element.feBcEdge);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyBegin(A, MAT_FINAL_ASSEMBLY);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatAssemblyEnd(A, MAT_FINAL_ASSEMBLY);</div>
<div class="line"> </div>
<div class="line">      {</div>
<div class="line">        KSP solver;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPCreate(PETSC_COMM_WORLD, &amp;solver);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(solver, A, A);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(solver);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(solver);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(solver, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, T);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPDestroy(&amp;solver);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Scatter data on mesh</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(T, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(T, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gad94692d0472b346672a25c63e91fb930">DMoFEMMeshToGlobalVector</a>(bc_dm, T, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;T);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;A);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;bc_dm);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">//  //define problems</span></div>
<div class="line">    <span class="comment">//  CHKERR m_field.add_problem(&quot;DM_MINIMAL_AREA&quot;);</span></div>
<div class="line">    <span class="comment">//  //set refinement level for problem</span></div>
<div class="line">    <span class="comment">//  CHKERR</span></div>
<div class="line">    <span class="comment">//  m_field.modify_problem_ref_level_add_bit(&quot;DM_MINIMAL_AREA&quot;,bit_level0);</span></div>
<div class="line">    <span class="comment">// Create discrete manager instance</span></div>
<div class="line">    DM dm;</div>
<div class="line">    {</div>
<div class="line">      <span class="comment">// Register problem</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm, <span class="stringliteral">&quot;MoFEM&quot;</span>);</div>
<div class="line">      <span class="comment">// Create DM instance</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(dm, &amp;m_field, <span class="stringliteral">&quot;DM_MINIMAL_AREA&quot;</span>, bit_level0);</div>
<div class="line">      <span class="comment">// Get options fron line command</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(dm);</div>
<div class="line">      <span class="comment">// Add elements to dm (only one here)</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(dm, <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>);</div>
<div class="line">      <span class="comment">// Set up data structures</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create matrices and vectors used for analysis</span></div>
<div class="line">    Vec T, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>;</div>
<div class="line">    Mat <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>;</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateGlobalVector(dm, &amp;T);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(T, &amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreateMatrix(dm, &amp;A);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Adding elements to DMSnes</span></div>
<div class="line">    {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Right hand side operators (run for each entity in element)</span></div>
<div class="line">      <span class="comment">// Calculate inverse of jacobian</span></div>
<div class="line">      <span class="keyword">auto</span> det_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> inv_jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_o_jac_for_face_impl_3_012_01_4.html">OpCalculateHOJacForFace</a>(jac_ptr));</div>
<div class="line">      minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_invert_matrix.html">OpInvertMatrix&lt;2&gt;</a>(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">      <span class="comment">// Apply inv_jac_ptr to shape functions</span></div>
<div class="line">      minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">OpSetInvJacH1ForFace</a>(inv_jac_ptr));</div>
<div class="line">      <span class="comment">// Below operators are specific to minimal area problem</span></div>
<div class="line">      minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html">MinimalSurfaceElement::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;U&quot;</span>, mse_common_data));</div>
<div class="line">      minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html">MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, mse_common_data, <span class="keyword">true</span>));</div>
<div class="line">      minimal_surface_element.feRhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_residaul.html">MinimalSurfaceElement::OpAssembleResidaul</a>(<span class="stringliteral">&quot;U&quot;</span>, mse_common_data));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Left hand side operators (run for each entity in element)</span></div>
<div class="line">      <span class="comment">// Calculate inverse of jacobian</span></div>
<div class="line">      minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_o_jac_for_face_impl_3_012_01_4.html">OpCalculateHOJacForFace</a>(jac_ptr));</div>
<div class="line">      minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_invert_matrix.html">OpInvertMatrix&lt;2&gt;</a>(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">      <span class="comment">// Apply inv_jac_ptr to shape functions</span></div>
<div class="line">      minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_inv_jac_h1_for_face.html">OpSetInvJacH1ForFace</a>(inv_jac_ptr));</div>
<div class="line">      <span class="comment">// Below operators are specific to minimal area problem</span></div>
<div class="line">      minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_get_data_at_gauss_pts.html">MinimalSurfaceElement::OpGetDataAtGaussPts</a>(<span class="stringliteral">&quot;U&quot;</span>, mse_common_data));</div>
<div class="line">      minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_calculate_coefficients_at_gauss_pts.html">MinimalSurfaceElement::OpCalculateCoefficientsAtGaussPts</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, mse_common_data, <span class="keyword">false</span>));</div>
<div class="line">      minimal_surface_element.feLhs.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_minimal_surface_equation_1_1_minimal_surface_element_1_1_op_assemble_tangent.html">MinimalSurfaceElement::OpAssembleTangent</a>(<span class="stringliteral">&quot;U&quot;</span>, mse_common_data));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Rhs</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">DMMoFEMSNESSetFunction</a>(dm, <a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, NULL, &amp;fix_edges_ents,</div>
<div class="line">                                    NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">DMMoFEMSNESSetFunction</a>(dm, <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,</div>
<div class="line">                                    &amp;minimal_surface_element.feRhs, PETSC_NULL,</div>
<div class="line">                                    PETSC_NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">DMMoFEMSNESSetFunction</a>(dm, <a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, NULL, NULL,</div>
<div class="line">                                    &amp;fix_edges_ents);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Lhs</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">DMMoFEMSNESSetJacobian</a>(dm, <a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, NULL, &amp;fix_edges_ents,</div>
<div class="line">                                    NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">DMMoFEMSNESSetJacobian</a>(dm, <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,</div>
<div class="line">                                    &amp;minimal_surface_element.feLhs, PETSC_NULL,</div>
<div class="line">                                    PETSC_NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">DMMoFEMSNESSetJacobian</a>(dm, <a class="code hl_define" href="_d_m_mo_f_e_m_8hpp.html#a8643d43312bdd9afb90733cfdcc77cf9">DM_NO_ELEMENT</a>, NULL, NULL,</div>
<div class="line">                                    &amp;fix_edges_ents);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    SNESConvergedReason snes_reason;</div>
<div class="line">    <span class="comment">// Solve problem</span></div>
<div class="line">    {</div>
<div class="line">      SNES snes;</div>
<div class="line">      <a class="code hl_class" href="class_snes_ctx.html">SnesCtx</a> *snes_ctx;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESCreate(PETSC_COMM_WORLD, &amp;snes);</div>
<div class="line">      <span class="comment">// CHKERR SNESSetDM(snes,dm);</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gad3fd04d49e1c12dd37f8052245b8e653">DMMoFEMGetSnesCtx</a>(dm, &amp;snes_ctx);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFunction(snes, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, SnesRhs, snes_ctx);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetJacobian(snes, A, A, SnesMat, snes_ctx);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFromOptions(snes);</div>
<div class="line"> </div>
<div class="line">      Vec T0;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(T, &amp;T0);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, T0, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> step_size = 1. / nb_sub_steps;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ss = 1; ss &lt;= nb_sub_steps; ss++) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAXPY(T, step_size, T0);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, T, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSolve(snes, PETSC_NULL, T);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetConvergedReason(snes, &amp;snes_reason);</div>
<div class="line">        <span class="keywordtype">int</span> its;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetIterationNumber(snes, &amp;its);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscPrintf(PETSC_COMM_WORLD,</div>
<div class="line">                           <span class="stringliteral">&quot;number of Newton iterations = %D\n\n&quot;</span>, its);</div>
<div class="line">        <span class="keywordflow">if</span> (snes_reason &lt; 0) {</div>
<div class="line">          <span class="keywordflow">if</span> (is_atom_test) {</div>
<div class="line">            SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">                    <span class="stringliteral">&quot;atom test diverged&quot;</span>);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(T, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(T, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gad94692d0472b346672a25c63e91fb930">DMoFEMMeshToGlobalVector</a>(dm, T, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">//  CHKERR MatView(A,PETSC_VIEWER_DRAW_SELF);</span></div>
<div class="line">      <span class="comment">//  std::string wait;</span></div>
<div class="line">      <span class="comment">//  std::cin &gt;&gt; wait;</span></div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;T0);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESDestroy(&amp;snes);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_struct" href="struct_post_proc_face_on_refined_mesh.html">PostProcFaceOnRefinedMesh</a> post_proc(m_field);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.generateReferenceElementMesh();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.addFieldValuesPostProc(<span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;MINIMAL_SURFACE_ELEMENT&quot;</span>,</div>
<div class="line">                                      &amp;post_proc);</div>
<div class="line">      <span class="comment">// Save data on mesh</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc.postProcMesh.write_file(<span class="stringliteral">&quot;out.h5m&quot;</span>, <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line">                                               <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Clean and destroy</span></div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;T);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatDestroy(&amp;A);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="a_dirichlet_b_c_8hpp_html"><div class="ttname"><a href="_dirichlet_b_c_8hpp.html">DirichletBC.hpp</a></div></div>
<div class="ttc" id="a_minimal_surface_element_8hpp_html"><div class="ttname"><a href="_minimal_surface_element_8hpp.html">MinimalSurfaceElement.hpp</a></div><div class="ttdoc">Implementation of minimal surface element.</div></div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="a_post_proc_on_ref_mesh_8hpp_html"><div class="ttname"><a href="_post_proc_on_ref_mesh_8hpp.html">PostProcOnRefMesh.hpp</a></div><div class="ttdoc">Post-process fields on refined mesh.</div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="abase__functions_8c_html_a56d2889a19d8d7affaa85cfca4aadd67"><div class="ttname"><a href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a></div><div class="ttdeci">static PetscErrorCode ierr</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00013">base_functions.c:13</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00496">definitions.h:496</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="agroup__dm_html_ga2289e53ec5efa90a46dc702b9c7bc9f4"><div class="ttname"><a href="group__dm.html#ga2289e53ec5efa90a46dc702b9c7bc9f4">MoFEM::DMMoFEMSNESSetFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSNESSetFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set SNES residual evaluation function</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00718">DMMoFEM.cpp:718</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="agroup__dm_html_ga7bb674a8c2feaf3c80814b0d980fec1c"><div class="ttname"><a href="group__dm.html#ga7bb674a8c2feaf3c80814b0d980fec1c">MoFEM::DMMoFEMSNESSetJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSNESSetJacobian(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set SNES Jacobian evaluation function</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00759">DMMoFEM.cpp:759</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="agroup__dm_html_gad3fd04d49e1c12dd37f8052245b8e653"><div class="ttname"><a href="group__dm.html#gad3fd04d49e1c12dd37f8052245b8e653">MoFEM::DMMoFEMGetSnesCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetSnesCtx(DM dm, MoFEM::SnesCtx **snes_ctx)</div><div class="ttdoc">get MoFEM::SnesCtx data structure</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01094">DMMoFEM.cpp:1094</a></div></div>
<div class="ttc" id="agroup__dm_html_gad94692d0472b346672a25c63e91fb930"><div class="ttname"><a href="group__dm.html#gad94692d0472b346672a25c63e91fb930">MoFEM::DMoFEMMeshToGlobalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToGlobalVector(DM dm, Vec g, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set ghosted vector values on all existing mesh entities</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00535">DMMoFEM.cpp:535</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gacbb3bbf1fa80b85848bc3cfcd604182b"><div class="ttname"><a href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">MoFEM::CoreInterface::add_ents_to_finite_element_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_type(const EntityHandle entities, const EntityType type, const std::string name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__field_html_gaa584a5c9cc28f5ae0a7088d130683be8"><div class="ttname"><a href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">MoFEM::CoreInterface::add_ents_to_field_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_type(const Range &amp;ents, const EntityType type, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="amesh__smoothing_8cpp_html_ae20b66af13b03d8e8a4593186c23cd07"><div class="ttname"><a href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a></div><div class="ttdeci">char mesh_file_name[255]</div><div class="ttdef"><b>Definition</b> <a href="mesh__smoothing_8cpp_source.html#l00022">mesh_smoothing.cpp:22</a></div></div>
<div class="ttc" id="anamespace_minimal_surface_equation_html"><div class="ttname"><a href="namespace_minimal_surface_equation.html">MinimalSurfaceEquation</a></div><div class="ttdoc">Minimal surface equation.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00031">MinimalSurfaceElement.hpp:31</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="astruct_dirichlet_fix_field_at_entities_bc_html"><div class="ttname"><a href="struct_dirichlet_fix_field_at_entities_bc.html">DirichletFixFieldAtEntitiesBc</a></div><div class="ttdoc">Fix dofs on entities.</div><div class="ttdef"><b>Definition</b> <a href="_dirichlet_b_c_8hpp_source.html#l00258">DirichletBC.hpp:258</a></div></div>
<div class="ttc" id="astruct_minimal_surface_equation_1_1_minimal_surface_element_html"><div class="ttname"><a href="struct_minimal_surface_equation_1_1_minimal_surface_element.html">MinimalSurfaceEquation::MinimalSurfaceElement</a></div><div class="ttdoc">Implementation of minimal area element.</div><div class="ttdef"><b>Definition</b> <a href="_minimal_surface_element_8hpp_source.html#l00037">MinimalSurfaceElement.hpp:37</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a8008ad16315eb609dcb0fd88746b991a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_h_o_jac_for_face_impl_3_012_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_h_o_jac_for_face_impl_3_012_01_4.html">MoFEM::OpCalculateHOJacForFaceImpl&lt; 2 &gt;</a></div><div class="ttdef"><b>Definition</b> <a href="_h_o_data_operators_8hpp_source.html#l00243">HODataOperators.hpp:244</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_invert_matrix_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_invert_matrix.html">MoFEM::OpInvertMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l03653">UserDataOperators.hpp:3653</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astruct_post_proc_face_on_refined_mesh_html"><div class="ttname"><a href="struct_post_proc_face_on_refined_mesh.html">PostProcFaceOnRefinedMesh</a></div><div class="ttdoc">Postprocess on face.</div><div class="ttdef"><b>Definition</b> <a href="_post_proc_on_ref_mesh_8hpp_source.html#l01032">PostProcOnRefMesh.hpp:1033</a></div></div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
