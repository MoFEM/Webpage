<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.9.8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: PoissonOperators.hpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js"></script>
  <script>
    window.MathJax = {
      tex: {
        tags: 'all', // Enables equation numbering
      },
      loader: {
        load: ['[tex]/boldsymbol']
      }
    };
  </script>
  <script type="text/javascript " src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.15.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script><!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">PoissonOperators.hpp</div></div>
</div><!--header-->
<div class="contents">
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file PoissonOperators.hpp</span></div>
<div class="line"><span class="comment"> * \example PoissonOperators.hpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef __POISSONOPERATORS_HPP__</span></div>
<div class="line"><span class="preprocessor">#define __POISSONOPERATORS_HPP__</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="MoFEM_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespaceMoFEM.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespacePoissonExample.html">PoissonExample</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a id="a0" name="a0"></a><a class="code hl_typedef" href="namespacePoissonExample.html#a097610ce0a8fd450f66ead79cc7e81a7">PostProcFE</a> = <a id="_a1" name="_a1"></a><a class="code hl_struct" href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">PostProcBrokenMeshInMoab&lt;VolumeElementForcesAndSourcesCore&gt;</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Calculate the grad-grad operator and assemble matrix</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Calculate</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{K}=\int_\Omega \nabla \boldsymbol\phi \cdot \nabla \boldsymbol\phi</span></div>
<div class="line"><span class="comment"> * \textrm{d}\Omega \f] and assemble to global matrix.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This operator is executed on element for each unique combination of entities.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a2" name="_a2"></a><a class="code hl_struct" href="structOpK.html">OpK</a> : <span class="keyword">public</span> <a id="_a3" name="_a3"></a><a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolumeElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="structOpK.html">OpK</a>(<span class="keywordtype">bool</span> symm = <span class="keyword">true</span>)</div>
<div class="line">      : <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">VolumeElementForcesAndSourcesCore::UserDataOperator</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, OPROWCOL,</div>
<div class="line">                                                            symm) {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Do calculations for give operator</span></div>
<div class="line"><span class="comment">   * @param  row_side row side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">   * @param  col_side column side number (local number) of entity on element</span></div>
<div class="line"><span class="comment">   * @param  row_type type of row entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">   * @param  col_type type of column entity MBVERTEX, MBEDGE, MBTRI or MBTET</span></div>
<div class="line"><span class="comment">   * @param  row_data data for row</span></div>
<div class="line"><span class="comment">   * @param  col_data data for column</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a4" name="a4"></a><a class="code hl_function" href="structPoissonExample_1_1OpK.html#a43ef1dd3ea49ba1a6dcd8d3f62f602b3">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                        EntityType col_type,</div>
<div class="line">                        <a id="_a5" name="_a5"></a><a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a id="a6" name="a6"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    <a id="a7" name="a7"></a><a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a> = row_data.<a id="a8" name="a8"></a><a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// if no dofs on row, exit that work, nothing to do here</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>)</div>
<div class="line">      <a id="a9" name="a9"></a><a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of dofs on column</span></div>
<div class="line">    <a id="a10" name="a10"></a><a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a> = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// if no dofs on Columbia, exit nothing to do here</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    <a id="a11" name="a11"></a><a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">nbIntegrationPts</a> = getGaussPts().size2();</div>
<div class="line">    <span class="comment">// check if entity block is on matrix diagonal</span></div>
<div class="line">    <span class="keywordflow">if</span> (row_side == col_side &amp;&amp; row_type == col_type) {</div>
<div class="line">      <a id="a12" name="a12"></a><a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a> = <span class="keyword">true</span>; <span class="comment">// yes, it is</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a> = <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="comment">// integrate local matrix for entity block</span></div>
<div class="line">    <a id="a13" name="a13"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a14" name="a14"></a><a class="code hl_function" href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3">iNtegrate</a>(row_data, col_data);</div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a15" name="a15"></a><a class="code hl_function" href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">aSsemble</a>(row_data, col_data);</div>
<div class="line">    <a id="a16" name="a16"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  ///&lt; error code</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>;           <span class="comment">///&lt; number of dofs on rows</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>;           <span class="comment">///&lt; number if dof on column</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">nbIntegrationPts</a>; <span class="comment">///&lt; number of integration points</span></div>
<div class="line">  <span class="keywordtype">bool</span> <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a>;          <span class="comment">///&lt; true if this block is on diagonal</span></div>
<div class="line"> </div>
<div class="line">  <a id="_a17" name="_a17"></a><a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a id="a18" name="a18"></a><a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>; <span class="comment">///&lt; summit Index</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> <a id="a19" name="a19"></a><a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>;      <span class="comment">///&lt; local entity block matrix</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate grad-grad operator</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                   <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local entity bock</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.resize(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear matrix</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.clear();</div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function gradient on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_row_grad = row_data.<a id="a20" name="a20"></a><a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">    <span class="comment">// loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// take into account Jacobean</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = t_w * vol;</div>
<div class="line">      <span class="comment">// noalias(locMat) +=</span></div>
<div class="line">      <span class="comment">// alpha*prod(row_data.getDiffN(gg),trans(col_data.getDiffN(gg))); take</span></div>
<div class="line">      <span class="comment">// fist element to local matrix</span></div>
<div class="line">      <a id="_a21" name="_a21"></a><a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;double *&gt;</a> <a id="a22" name="a22"></a><a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>(&amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.data().begin());</div>
<div class="line">      <span class="comment">// loop over rows base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>; rr++) {</div>
<div class="line">        <span class="comment">// get column base functions gradient at gauss point gg</span></div>
<div class="line">        <span class="keyword">auto</span> t_col_grad = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line">        <span class="comment">// loop over columns</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>; cc++) {</div>
<div class="line">          <span class="comment">// calculate element of local matrix</span></div>
<div class="line">          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += alpha * (t_row_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>) * t_col_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>));</div>
<div class="line">          ++t_col_grad; <span class="comment">// move to another gradient of base function on column</span></div>
<div class="line">          ++<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;          <span class="comment">// move to another element of local matrix in column</span></div>
<div class="line">        }</div>
<div class="line">        ++t_row_grad; <span class="comment">// move to another element of gradient of base function on</span></div>
<div class="line">                      <span class="comment">// row</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w; <span class="comment">// move to another integration weight</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Assemble local entity block matrix</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                  <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get pointer to first global index on row</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">    <span class="comment">// get pointer to first global index on column</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">    Mat <a id="_a23" name="_a23"></a><a class="code hl_class" href="classB.html">B</a> = getFEMethod()-&gt;ksp_B != PETSC_NULLPTR ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                               : getFEMethod()-&gt;snes_B;</div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues(<a class="code hl_class" href="classB.html">B</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>, row_indices, <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>, col_indices,</div>
<div class="line">                        &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.data().begin(), ADD_VALUES);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">isDiag</a> &amp;&amp; sYmm) {</div>
<div class="line">      <span class="comment">// if not diagonal term and since global matrix is symmetric assemble</span></div>
<div class="line">      <span class="comment">// transpose term.</span></div>
<div class="line">      <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a> = trans(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues(<a class="code hl_class" href="classB.html">B</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>, col_indices, <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>, row_indices,</div>
<div class="line">                          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.data().begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief template class for integration oh the right hand side</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keyword">typename</span> OPBASE&gt; <span class="keyword">struct </span>OpBaseRhs : <span class="keyword">public</span> <a id="_a24" name="_a24"></a><a class="code hl_class" href="classOPBASE.html">OPBASE</a> {</div>
<div class="line"> </div>
<div class="line">  OpBaseRhs(<span class="keyword">const</span> std::string <a id="a25" name="a25"></a><a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) : <a class="code hl_class" href="classOPBASE.html">OPBASE</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, OPBASE::OPROW) {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief This function is called by finite element</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * Do work is composed from two operations, integrate and assembly. Also,</span></div>
<div class="line"><span class="comment">   * it set values nbRows, and nbIntegrationPts.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a26" name="a26"></a><a class="code hl_function" href="structPoissonExample_1_1OpBaseRhs.html#a7e0053c987e075cbcd68b4d567115630">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type,</div>
<div class="line">                        <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    <a id="a27" name="a27"></a><a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a> = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    <a id="a28" name="a28"></a><a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a> = OPBASE::getGaussPts().size2();</div>
<div class="line">    <span class="comment">// integrate local vector</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a29" name="a29"></a><a class="code hl_function" href="structPoissonExample_1_1OpBaseRhs.html#afc2927f382c9aa8af5c414dc81d4becb">iNtegrate</a>(row_data);</div>
<div class="line">    <span class="comment">// assemble local vector</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a30" name="a30"></a><a class="code hl_function" href="structPoissonExample_1_1OpBaseRhs.html#a436705aa66999557e70e43853b4dc320">aSsemble</a>(row_data);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Class dedicated to integrate operator</span></div>
<div class="line"><span class="comment">   * @param  data entity data on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpBaseRhs.html#afc2927f382c9aa8af5c414dc81d4becb">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) = 0;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Class dedicated to assemble operator to global system vector</span></div>
<div class="line"><span class="comment">   * @param  data entity data (indices, base functions, etc. ) on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">virtual</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpBaseRhs.html#a436705aa66999557e70e43853b4dc320">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) = 0;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  ///&lt; error code</span></div>
<div class="line"><span class="comment"></span>  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>;           <span class="comment">///&lt; number of dofs on row</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; <span class="comment">///&lt; number of integration points</span></div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Operator calculate source term,</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{F} = \int_\Omega \boldsymbol\phi f \textrm{d}\Omega</span></div>
<div class="line"><span class="comment"> * \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>OpF</div>
<div class="line">    : <span class="keyword">public</span> OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a id="_a31" name="_a31"></a><a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      <a id="a32" name="a32"></a><a class="code hl_typedef" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a>;</div>
<div class="line"> </div>
<div class="line">  OpF(<a class="code hl_typedef" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a> f_source)</div>
<div class="line">      : OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;(<span class="stringliteral">&quot;U&quot;</span>),</div>
<div class="line">        <a id="a33" name="a33"></a><a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>(f_source) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a id="_a34" name="_a34"></a><a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> <a id="a35" name="a35"></a><a class="code hl_variable" href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">NX</a>;</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> <a id="a36" name="a36"></a><a class="code hl_variable" href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">NY</a>;</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> <a id="a37" name="a37"></a><a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">NZ</a>;</div>
<div class="line">  <a class="code hl_typedef" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a> <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> <a id="a38" name="a38"></a><a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local entity vector</span></div>
<div class="line"><span class="comment">   * @param  data entity data on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a39" name="a39"></a><a class="code hl_function" href="structPoissonExample_1_1OpF.html#a935925a0321aa4e03a740d1f5056de0d">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.resize(<a id="a40" name="a40"></a><a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local entity vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.clear();</div>
<div class="line">    <span class="comment">// get finite element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base functions on entity</span></div>
<div class="line">    <span class="keyword">auto</span> t_v = data.<a id="a41" name="a41"></a><a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get coordinates at integration points</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// loop over all integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a id="a42" name="a42"></a><a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// evaluate constant term</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha =</div>
<div class="line">          vol * t_w * <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>(t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">NX</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">NY</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">NZ</a>));</div>
<div class="line">      <span class="comment">// get element of local vector</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.data().begin());</div>
<div class="line">      <span class="comment">// loop over base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>; rr++) {</div>
<div class="line">        <span class="comment">// add to local vector source term</span></div>
<div class="line">        t_a -= alpha * t_v;</div>
<div class="line">        ++t_a; <span class="comment">// move to next element of local vector</span></div>
<div class="line">        ++t_v; <span class="comment">// move to next base function</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w;      <span class="comment">// move to next integration weight</span></div>
<div class="line">      ++t_coords; <span class="comment">// move to next physical coordinates at integration point</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief assemble local entity vector to the global right hand side</span></div>
<div class="line"><span class="comment">   * @param  data entity data, i.e. global indices of local vector</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a43" name="a43"></a><a class="code hl_function" href="structPoissonExample_1_1OpF.html#a303a9491f132ded9c0ffce846bd4bd59">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get global indices of local vector</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *indices = &amp;*data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">    <span class="comment">// get values from local vector</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> *vals = &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.data().begin();</div>
<div class="line">    Vec f = getFEMethod()-&gt;ksp_f != PETSC_NULLPTR ? getFEMethod()-&gt;ksp_f</div>
<div class="line">                                               : getFEMethod()-&gt;snes_f;</div>
<div class="line">    <span class="comment">// assemble vector</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValues(f, <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, indices, vals, ADD_VALUES);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Calculate constrains matrix</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{C} = \int_{\partial\Omega} \boldsymbol\psi \boldsymbol\phi</span></div>
<div class="line"><span class="comment"> * \textrm{d}\partial\Omega \f] where \f$\lambda \f$ is base function on</span></div>
<div class="line"><span class="comment"> * boundary</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>OpC : <span class="keyword">public</span> <a id="_a44" name="_a44"></a><a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">FaceElementForcesAndSourcesCore::UserDataOperator</a> {</div>
<div class="line"> </div>
<div class="line">  OpC(<span class="keyword">const</span> <span class="keywordtype">bool</span> assemble_transpose)</div>
<div class="line">      : <a class="code hl_struct" href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">FaceElementForcesAndSourcesCore::UserDataOperator</a>(<span class="stringliteral">&quot;L&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, OPROWCOL,</div>
<div class="line">                                                          <span class="keyword">false</span>),</div>
<div class="line">        <a id="a45" name="a45"></a><a class="code hl_variable" href="structPoissonExample_1_1OpC.html#ab2ea8ac3cf7966295408965ed074c0ef">assembleTranspose</a>(assemble_transpose) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a46" name="a46"></a><a class="code hl_function" href="structPoissonExample_1_1OpC.html#a1252608d057c9cdd1b5817cec530b5d6">doWork</a>(<span class="keywordtype">int</span> row_side, <span class="keywordtype">int</span> col_side, EntityType row_type,</div>
<div class="line">                        EntityType col_type,</div>
<div class="line">                        <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                        <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get number of dofs on row</span></div>
<div class="line">    <a id="a47" name="a47"></a><a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a> = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// exit here if no dofs on row, nothing to do</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of dofs on column,</span></div>
<div class="line">    <a id="a48" name="a48"></a><a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a> = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().size();</div>
<div class="line">    <span class="comment">// exit here if no dofs on roe, nothing to do</span></div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <span class="comment">// get number of integration points</span></div>
<div class="line">    <a id="a49" name="a49"></a><a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a70d4563fe32d3b33eb936fa5526e6f3e">nbIntegrationPts</a> = getGaussPts().size2();</div>
<div class="line">    <span class="comment">// integrate local constrains matrix</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a50" name="a50"></a><a class="code hl_function" href="structPoissonExample_1_1OpC.html#a4e14f1cba17ed0174a5548bae8d592c9">iNtegrate</a>(row_data, col_data);</div>
<div class="line">    <span class="comment">// assemble local constrains matrix</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a51" name="a51"></a><a class="code hl_function" href="structPoissonExample_1_1OpC.html#a18deac04ec16cf98590c21aaf7cde5f4">aSsemble</a>(row_data, col_data);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  ///&lt; error code</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a>;                   <span class="comment">///&lt; number of dofs on row</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a>;                   <span class="comment">///&lt; number of dofs on column</span></div>
<div class="line">  <span class="keywordtype">int</span> <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a70d4563fe32d3b33eb936fa5526e6f3e">nbIntegrationPts</a>;         <span class="comment">///&lt; number of integration points</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#ab2ea8ac3cf7966295408965ed074c0ef">assembleTranspose</a>; <span class="comment">///&lt; assemble transpose, i.e. CT if set to true</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MatrixDouble</a> <a id="a52" name="a52"></a><a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>; <span class="comment">///&lt; local constrains matrix</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** \brief Integrate local constrains matrix</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpC.html#a4e14f1cba17ed0174a5548bae8d592c9">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                  <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local constrains matrix</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>.resize(<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear matrix</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>.clear();</div>
<div class="line">    <span class="comment">// get area of element</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base functions on entity</span></div>
<div class="line">    <span class="keyword">auto</span> t_row = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// run over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a70d4563fe32d3b33eb936fa5526e6f3e">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = area * t_w;</div>
<div class="line">      <span class="comment">// get element of local matrix</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; <a id="a53" name="a53"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>.data().begin());</div>
<div class="line">      <span class="comment">// run over base functions on rows</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a>; rr++) {</div>
<div class="line">        <span class="comment">// get first base functions on column for integration point gg</span></div>
<div class="line">        <span class="keyword">auto</span> t_col = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">        <span class="comment">// run over base function on column</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a>; cc++) {</div>
<div class="line">          <span class="comment">// integrate element of constrains matrix</span></div>
<div class="line">          <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> += alpha * t_row * t_col;</div>
<div class="line">          ++t_col; <span class="comment">// move to next base function on column</span></div>
<div class="line">          ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>;     <span class="comment">// move to next element of local matrix</span></div>
<div class="line">        }</div>
<div class="line">        ++t_row; <span class="comment">// move to next base function on row</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w; <span class="comment">// move to next integrate weight</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief integrate local constrains matrix</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpC.html#a18deac04ec16cf98590c21aaf7cde5f4">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                 <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// get indices on row</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *row_indices = &amp;*row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">    <span class="comment">// get indices on column</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *col_indices = &amp;*col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">    Mat <a class="code hl_class" href="classB.html">B</a> = getFEMethod()-&gt;ksp_B != PETSC_NULLPTR ? getFEMethod()-&gt;ksp_B</div>
<div class="line">                                               : getFEMethod()-&gt;snes_B;</div>
<div class="line">    <span class="comment">// assemble local matrix</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues(<a class="code hl_class" href="classB.html">B</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a>, row_indices, <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a>, col_indices,</div>
<div class="line">                        &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>.data().begin(), ADD_VALUES);</div>
<div class="line">    <span class="comment">// cerr &lt;&lt; locMat &lt;&lt; endl;</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#ab2ea8ac3cf7966295408965ed074c0ef">assembleTranspose</a>) {</div>
<div class="line">      <span class="comment">// assemble transpose of local matrix</span></div>
<div class="line">      <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a> = trans(<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatSetValues(<a class="code hl_class" href="classB.html">B</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">nbCols</a>, col_indices, <a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">nbRows</a>, row_indices,</div>
<div class="line">                          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">locMat</a>.data().begin(), ADD_VALUES);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Assemble constrains vector</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> * \mathbf{g} = \int_{\partial\Omega} \boldsymbol\psi \overline{u}</span></div>
<div class="line"><span class="comment"> * \textrm{d}\partial\Omega \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>Op_g</div>
<div class="line">    : <span class="keyword">public</span> OpBaseRhs&lt;FaceElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      <a id="a54" name="a54"></a><a class="code hl_typedef" href="structPoissonExample_1_1Op__g.html#a36df8342dcddc4a5c595ec98e2e5c70a">FVal</a>;</div>
<div class="line"> </div>
<div class="line">  Op_g(<a class="code hl_typedef" href="structPoissonExample_1_1Op__g.html#a36df8342dcddc4a5c595ec98e2e5c70a">FVal</a> f_value, <span class="keyword">const</span> <span class="keywordtype">string</span> <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a> = <span class="stringliteral">&quot;L&quot;</span>, <span class="keyword">const</span> <span class="keywordtype">double</span> beta = 1)</div>
<div class="line">      : OpBaseRhs&lt;FaceElementForcesAndSourcesCore::UserDataOperator&gt;(</div>
<div class="line">            <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>),</div>
<div class="line">        <a id="a55" name="a55"></a><a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a9cf6f30ad8d893d8c9f931346b94d45c">fValue</a>(f_value), <a id="a56" name="a56"></a><a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#adf44a1fd390a69f6c46d87d337f7758a">bEta</a>(beta) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> <a id="a57" name="a57"></a><a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a464b4029a2f5039ccabdf5aa51c504a6">NX</a>; <span class="comment">///&lt; x-direction index</span></div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> <a id="a58" name="a58"></a><a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a8cfe1da343b8ed9e6755d32a037a77ad">NY</a>; <span class="comment">///&lt; y-direction index</span></div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> <a id="a59" name="a59"></a><a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a03e18be153927b768e51cb9d1e6d3601">NZ</a>; <span class="comment">///&lt; z-direction index</span></div>
<div class="line">  <a class="code hl_typedef" href="structPoissonExample_1_1Op__g.html#a36df8342dcddc4a5c595ec98e2e5c70a">FVal</a> <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a9cf6f30ad8d893d8c9f931346b94d45c">fValue</a>; <span class="comment">///&lt; Function pointer evaluating values of &quot;U&quot; at the boundary</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">VectorDouble</a> <a id="a60" name="a60"></a><a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#adf44a1fd390a69f6c46d87d337f7758a">bEta</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local constrains vector</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a61" name="a61"></a><a class="code hl_function" href="structPoissonExample_1_1Op__g.html#a3d420c78551d8957da4e600ffc0ad59a">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size to local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.resize(<a id="a62" name="a62"></a><a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.clear();</div>
<div class="line">    <span class="comment">// get face area</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea() * <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#adf44a1fd390a69f6c46d87d337f7758a">bEta</a>;</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function</span></div>
<div class="line">    <span class="keyword">auto</span> t_l = data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get coordinates at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// make loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a id="a63" name="a63"></a><a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// evaluate function on boundary and scale it by area and integration</span></div>
<div class="line">      <span class="comment">// weight</span></div>
<div class="line">      <span class="keywordtype">double</span> alpha =</div>
<div class="line">          area * t_w * <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a9cf6f30ad8d893d8c9f931346b94d45c">fValue</a>(t_coords(<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a464b4029a2f5039ccabdf5aa51c504a6">NX</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a8cfe1da343b8ed9e6755d32a037a77ad">NY</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a03e18be153927b768e51cb9d1e6d3601">NZ</a>));</div>
<div class="line">      <span class="comment">// get element of vector</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.data().begin());</div>
<div class="line">      <span class="comment">//</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>; rr++) {</div>
<div class="line">        t_a += alpha * t_l;</div>
<div class="line">        ++t_a;</div>
<div class="line">        ++t_l;</div>
<div class="line">      }</div>
<div class="line">      ++t_w;</div>
<div class="line">      ++t_coords;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief assemble constrains vectors</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a64" name="a64"></a><a class="code hl_function" href="structPoissonExample_1_1Op__g.html#a181bfd64ce7e6c2bd0be0d3e736826dc">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> *indices = &amp;*data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">getIndices</a>().data().begin();</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> *vals = &amp;*<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.data().begin();</div>
<div class="line">    Vec f = getFEMethod()-&gt;ksp_f != PETSC_NULLPTR ? getFEMethod()-&gt;ksp_f</div>
<div class="line">                                               : getFEMethod()-&gt;snes_f;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValues(f, <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, indices, &amp;*vals, ADD_VALUES);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Evaluate error</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a65" name="_a65"></a><a class="code hl_struct" href="structOpError.html">OpError</a></div>
<div class="line">    : <span class="keyword">public</span> OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt; {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      <a id="a66" name="a66"></a><a class="code hl_typedef" href="structPoissonExample_1_1OpError.html#a517f1b72975cf08edfb4e0c43e9da64d">UVal</a>;</div>
<div class="line">  <span class="keyword">typedef</span> boost::function&lt;FTensor::Tensor1&lt;double, 3&gt;(</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">      <a id="a67" name="a67"></a><a class="code hl_typedef" href="structPoissonExample_1_1OpError.html#ada8e7ed84c3e3f597408e9b7af89dd83">GVal</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="structOpError.html">OpError</a>(<a class="code hl_typedef" href="structPoissonExample_1_1OpError.html#a517f1b72975cf08edfb4e0c43e9da64d">UVal</a> u_value, <a class="code hl_typedef" href="structPoissonExample_1_1OpError.html#ada8e7ed84c3e3f597408e9b7af89dd83">GVal</a> g_value,</div>
<div class="line">          boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals,</div>
<div class="line">          boost::shared_ptr&lt;MatrixDouble&gt; &amp;grad_vals, Vec global_error)</div>
<div class="line">      : OpBaseRhs&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;(<span class="stringliteral">&quot;ERROR&quot;</span>),</div>
<div class="line">        <a id="a68" name="a68"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a1351ee7b257e586ffcfc6e83194103cc">globalError</a>(global_error), <a id="a69" name="a69"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a16bb56bc60331d302a0b3f6feb825671">uValue</a>(u_value), <a id="a70" name="a70"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a8733815305e402bdb988460188f689a0">gValue</a>(g_value),</div>
<div class="line">        <a id="a71" name="a71"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a91a102c742d515db8819fa42ed70b843">fieldVals</a>(field_vals), <a id="a72" name="a72"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a3f5e82da6a1ad7ffc7bd609558fc8c3e">gradVals</a>(grad_vals) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a73" name="a73"></a><a class="code hl_function" href="structPoissonExample_1_1OpError.html#a3f7abcb94b3846cf7b67102541d8d6f9">doWork</a>(<span class="keywordtype">int</span> row_side, EntityType row_type,</div>
<div class="line">                        <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a> = row_data.<a id="a74" name="a74"></a><a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6fb60e6aba0a189316962e4e96bce5e4">getFieldData</a>().size();</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a> = getGaussPts().size2();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a75" name="a75"></a><a class="code hl_function" href="structPoissonExample_1_1OpError.html#a94c3d65735d75b6a15f4ce997b62fe26">iNtegrate</a>(row_data);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a76" name="a76"></a><a class="code hl_function" href="structPoissonExample_1_1OpError.html#afefb3352b6edc0930da3fa9051eb55ea">aSsemble</a>(row_data);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  Vec <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a1351ee7b257e586ffcfc6e83194103cc">globalError</a>; <span class="comment">///&lt; ghost vector with global (integrated over volume) error</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;0&gt;</a> <a id="a77" name="a77"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">NX</a>;</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;1&gt;</a> <a id="a78" name="a78"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">NY</a>;</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Number.html">FTensor::Number&lt;2&gt;</a> <a id="a79" name="a79"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">NZ</a>;</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a id="a80" name="a80"></a><a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>;</div>
<div class="line">  <a class="code hl_typedef" href="structPoissonExample_1_1OpError.html#a517f1b72975cf08edfb4e0c43e9da64d">UVal</a> <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a16bb56bc60331d302a0b3f6feb825671">uValue</a>; <span class="comment">///&lt; function with exact solution</span></div>
<div class="line">  <a class="code hl_typedef" href="structPoissonExample_1_1OpError.html#ada8e7ed84c3e3f597408e9b7af89dd83">GVal</a> <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a8733815305e402bdb988460188f689a0">gValue</a>; <span class="comment">///&lt; function with exact solution for gradient</span></div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a91a102c742d515db8819fa42ed70b843">fieldVals</a>;</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a3f5e82da6a1ad7ffc7bd609558fc8c3e">gradVals</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate error</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpError.html#a94c3d65735d75b6a15f4ce997b62fe26">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// clear field dofs</span></div>
<div class="line">    data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6fb60e6aba0a189316962e4e96bce5e4">getFieldData</a>().clear();</div>
<div class="line">    <span class="comment">// get volume of element</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = getFTensor0FromVec(*<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a91a102c742d515db8819fa42ed70b843">fieldVals</a>);</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a3f5e82da6a1ad7ffc7bd609558fc8c3e">gradVals</a>);</div>
<div class="line">    <span class="comment">// get coordinates at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// keep exact gradient and error or gradient</span></div>
<div class="line">    <a id="_a81" name="_a81"></a><a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_exact_grad, t_error_grad;</div>
<div class="line">    <span class="comment">// integrate over</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="keywordtype">double</span> alpha = vol * t_w;</div>
<div class="line">      <span class="comment">// evaluate exact value</span></div>
<div class="line">      <span class="keywordtype">double</span> exact_u = <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a16bb56bc60331d302a0b3f6feb825671">uValue</a>(t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">NX</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">NY</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">NZ</a>));</div>
<div class="line">      <span class="comment">// evaluate exact gradient</span></div>
<div class="line">      t_exact_grad = <a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a8733815305e402bdb988460188f689a0">gValue</a>(t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">NX</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">NY</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">NZ</a>));</div>
<div class="line">      <span class="comment">// calculate gradient errro</span></div>
<div class="line">      t_error_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>) = t_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>) - t_exact_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>);</div>
<div class="line">      <span class="comment">// error</span></div>
<div class="line">      <span class="keywordtype">double</span> error = pow(t_u - exact_u, 2) + t_error_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>) * t_error_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">i</a>);</div>
<div class="line">      <span class="comment">// iterate over base functions</span></div>
<div class="line">      data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6fb60e6aba0a189316962e4e96bce5e4">getFieldData</a>()[0] += alpha * error;</div>
<div class="line">      ++t_w;      <span class="comment">// move to next integration point</span></div>
<div class="line">      ++t_u;      <span class="comment">// next value of function at integration point</span></div>
<div class="line">      ++t_grad;   <span class="comment">// next gradient at integration point</span></div>
<div class="line">      ++t_coords; <span class="comment">// next coordinate at integration point</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Assemble error</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="structPoissonExample_1_1OpError.html#afefb3352b6edc0930da3fa9051eb55ea">aSsemble</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set error on mesh</span></div>
<div class="line">    data.<a id="a82" name="a82"></a><a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ab762079df5a543d6e8cdcfc01fba148b">getFieldDofs</a>()[0]-&gt;getFieldData() = sqrt(data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6fb60e6aba0a189316962e4e96bce5e4">getFieldData</a>()[0]);</div>
<div class="line">    <span class="comment">// assemble vector to global error</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecSetValue(<a class="code hl_variable" href="structPoissonExample_1_1OpError.html#a1351ee7b257e586ffcfc6e83194103cc">globalError</a>, 0, data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6fb60e6aba0a189316962e4e96bce5e4">getFieldData</a>()[0], ADD_VALUES);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpKt : <span class="keyword">public</span> <a class="code hl_struct" href="structOpK.html">OpK</a> {</div>
<div class="line"> </div>
<div class="line">  OpKt(boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line">       boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; diff_a,</div>
<div class="line">       boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals,</div>
<div class="line">       boost::shared_ptr&lt;MatrixDouble&gt; &amp;grad_vals)</div>
<div class="line">      : <a class="code hl_struct" href="structOpK.html">OpK</a>(<span class="keyword">false</span>), <a id="a83" name="a83"></a><a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#ac5c508443965992164f75bfd6553566e">A</a>(<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>), <a id="a84" name="a84"></a><a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a376ac929209b0cd8d30c3d3fcd07f809">diffA</a>(diff_a), <a id="a85" name="a85"></a><a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a9c58f35447322a93dda82cab0adcf05e">fieldVals</a>(field_vals),</div>
<div class="line">        <a id="a86" name="a86"></a><a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a481af7f82f338deb3cb87b6390846b16">gradVals</a>(grad_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate grad-grad operator</span></div>
<div class="line"><span class="comment">   * @param  row_data row data (consist base functions on row entity)</span></div>
<div class="line"><span class="comment">   * @param  col_data column data (consist base functions on column entity)</span></div>
<div class="line"><span class="comment">   * @return          error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">inline</span> <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a87" name="a87"></a><a class="code hl_function" href="structPoissonExample_1_1OpKt.html#a5c700b04e80fe02828a68ec3200d5cb7">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;row_data,</div>
<div class="line">                                  <a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;col_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local entity bock</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.resize(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>, <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear matrix</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.clear();</div>
<div class="line">    <span class="comment">// get element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = getFTensor0FromVec(*<a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a9c58f35447322a93dda82cab0adcf05e">fieldVals</a>);</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*<a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a481af7f82f338deb3cb87b6390846b16">gradVals</a>);</div>
<div class="line">    <span class="comment">// get base function gradient on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_row_grad = row_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">    <span class="comment">// loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// take into account Jacobian</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = t_w * vol;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> beta = alpha * <a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#ac5c508443965992164f75bfd6553566e">A</a>(t_u);</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_gamma;</div>
<div class="line">      t_gamma(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>) = (alpha * <a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a376ac929209b0cd8d30c3d3fcd07f809">diffA</a>(t_u)) * t_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>);</div>
<div class="line">      <span class="comment">// take fist element to local matrix</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">locMat</a>.data().begin());</div>
<div class="line">      <span class="comment">// loop over rows base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">nbRows</a>; rr++) {</div>
<div class="line">        <span class="comment">// get column base function</span></div>
<div class="line">        <span class="keyword">auto</span> t_col = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>(gg, 0);</div>
<div class="line">        <span class="comment">// get column base functions gradient at gauss point gg</span></div>
<div class="line">        <span class="keyword">auto</span> t_col_grad = col_data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;(gg, 0);</div>
<div class="line">        <span class="comment">// loop over columns</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> cc = 0; cc != <a class="code hl_variable" href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">nbCols</a>; cc++) {</div>
<div class="line">          <span class="comment">// calculate element of local matrix</span></div>
<div class="line">          <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += (t_row_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>) * beta) * t_col_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>) +</div>
<div class="line">               t_row_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>) * (t_gamma(<a class="code hl_variable" href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">i</a>) * t_col);</div>
<div class="line">          ++t_col;      <span class="comment">// move to next base function</span></div>
<div class="line">          ++t_col_grad; <span class="comment">// move to another gradient of base function on column</span></div>
<div class="line">          ++<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>;          <span class="comment">// move to another element of local matrix in column</span></div>
<div class="line">        }</div>
<div class="line">        ++t_row_grad; <span class="comment">// move to another element of gradient of base function on</span></div>
<div class="line">                      <span class="comment">// row</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w;    <span class="comment">// move to another integration weight</span></div>
<div class="line">      ++t_u;    <span class="comment">// move to next value at integration point</span></div>
<div class="line">      ++t_grad; <span class="comment">// move to next gradient value</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#ac5c508443965992164f75bfd6553566e">A</a>;</div>
<div class="line">  boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a376ac929209b0cd8d30c3d3fcd07f809">diffA</a>;</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a9c58f35447322a93dda82cab0adcf05e">fieldVals</a>;</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpKt.html#a481af7f82f338deb3cb87b6390846b16">gradVals</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpResF_Domain : <span class="keyword">public</span> OpF {</div>
<div class="line"> </div>
<div class="line">  OpResF_Domain(<a class="code hl_typedef" href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">FSource</a> f_source, boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line">                boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals,</div>
<div class="line">                boost::shared_ptr&lt;MatrixDouble&gt; &amp;grad_vals)</div>
<div class="line">      : OpF(f_source), <a id="a88" name="a88"></a><a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a96fbfefcb56fc8a6409c425ef66ef146">A</a>(<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>), <a id="a89" name="a89"></a><a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a539ef1d9788532f235a0034a7dc1d3bd">fieldVals</a>(field_vals), <a id="a90" name="a90"></a><a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a2943e501cac13e060e0430bb308a4eec">gradVals</a>(grad_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  <a class="code hl_class" href="classFTensor_1_1Index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a id="a91" name="a91"></a><a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#aab2b718a555fabc8d82ec0e577d215a0">i</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local entity vector</span></div>
<div class="line"><span class="comment">   * @param  data entity data on element row</span></div>
<div class="line"><span class="comment">   * @return      error code</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a92" name="a92"></a><a class="code hl_function" href="structPoissonExample_1_1OpResF__Domain.html#a5f65c8de439084edb23847e528e8a112">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size of local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.resize(<a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local entity vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.clear();</div>
<div class="line">    <span class="comment">// get finite element volume</span></div>
<div class="line">    <span class="keywordtype">double</span> vol = getVolume();</div>
<div class="line">    <span class="comment">// get integration weights</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = getFTensor0FromVec(*<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a539ef1d9788532f235a0034a7dc1d3bd">fieldVals</a>);</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_grad = getFTensor1FromMat&lt;3&gt;(*<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a2943e501cac13e060e0430bb308a4eec">gradVals</a>);</div>
<div class="line">    <span class="comment">// get base functions on entity</span></div>
<div class="line">    <span class="keyword">auto</span> t_v = data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get base function gradient on rows</span></div>
<div class="line">    <span class="keyword">auto</span> t_v_grad = data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">getFTensor1DiffN</a>&lt;3&gt;();</div>
<div class="line">    <span class="comment">// get coordinates at integration points</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// loop over all integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// evaluate constant term</span></div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> alpha = vol * t_w;</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> source_term =</div>
<div class="line">          alpha * <a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">fSource</a>(t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">NX</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">NY</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">NZ</a>));</div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> grad_term;</div>
<div class="line">      grad_term(<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#aab2b718a555fabc8d82ec0e577d215a0">i</a>) = (alpha * <a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a96fbfefcb56fc8a6409c425ef66ef146">A</a>(t_u)) * t_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#aab2b718a555fabc8d82ec0e577d215a0">i</a>);</div>
<div class="line">      <span class="comment">// get element of local vector</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">locVec</a>.data().begin());</div>
<div class="line">      <span class="comment">// loop over base functions</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>; rr++) {</div>
<div class="line">        <span class="comment">// add to local vector source term</span></div>
<div class="line">        t_a += t_v_grad(<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#aab2b718a555fabc8d82ec0e577d215a0">i</a>) * grad_term(<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#aab2b718a555fabc8d82ec0e577d215a0">i</a>) + t_v * source_term;</div>
<div class="line">        ++t_a;      <span class="comment">// move to next element of local vector</span></div>
<div class="line">        ++t_v;      <span class="comment">// move to next base function</span></div>
<div class="line">        ++t_v_grad; <span class="comment">// move to next gradient of base function</span></div>
<div class="line">      }</div>
<div class="line">      ++t_w;      <span class="comment">// move to next integration weights</span></div>
<div class="line">      ++t_u;      <span class="comment">// move to next value</span></div>
<div class="line">      ++t_grad;   <span class="comment">// move to next gradient value</span></div>
<div class="line">      ++t_coords; <span class="comment">// move to next physical coordinates at integration point</span></div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a96fbfefcb56fc8a6409c425ef66ef146">A</a>;</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a539ef1d9788532f235a0034a7dc1d3bd">fieldVals</a>;</div>
<div class="line">  boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpResF__Domain.html#a2943e501cac13e060e0430bb308a4eec">gradVals</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpRes_g : <span class="keyword">public</span> Op_g {</div>
<div class="line"> </div>
<div class="line">  OpRes_g(<a class="code hl_typedef" href="structPoissonExample_1_1Op__g.html#a36df8342dcddc4a5c595ec98e2e5c70a">FVal</a> f_value, boost::shared_ptr&lt;VectorDouble&gt; &amp;field_vals)</div>
<div class="line">      : Op_g(f_value, <span class="stringliteral">&quot;L&quot;</span>, 1), <a id="a93" name="a93"></a><a class="code hl_variable" href="structPoissonExample_1_1OpRes__g.html#addd484a1e6323eb229b38bad558b1ae4">fieldVals</a>(field_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpRes__g.html#addd484a1e6323eb229b38bad558b1ae4">fieldVals</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local constrains vector</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a94" name="a94"></a><a class="code hl_function" href="structPoissonExample_1_1OpRes__g.html#a4fea4cc1e70d944cd4cfa7ea50ff3183">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size to local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.resize(<a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.clear();</div>
<div class="line">    <span class="comment">// get face area</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea() * <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#adf44a1fd390a69f6c46d87d337f7758a">bEta</a>;</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function</span></div>
<div class="line">    <span class="keyword">auto</span> t_l = data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = getFTensor0FromVec(*<a class="code hl_variable" href="structPoissonExample_1_1OpRes__g.html#addd484a1e6323eb229b38bad558b1ae4">fieldVals</a>);</div>
<div class="line">    <span class="comment">// get coordinates at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_coords = getFTensor1CoordsAtGaussPts();</div>
<div class="line">    <span class="comment">// make loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// evaluate function on boundary and scale it by area and integration</span></div>
<div class="line">      <span class="comment">// weight</span></div>
<div class="line">      <span class="keywordtype">double</span> alpha = area * t_w;</div>
<div class="line">      <span class="comment">// get element of vector</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.data().begin());</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>; rr++) {</div>
<div class="line">        t_a += alpha * t_l *</div>
<div class="line">               (t_u - <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a9cf6f30ad8d893d8c9f931346b94d45c">fValue</a>(t_coords(<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a464b4029a2f5039ccabdf5aa51c504a6">NX</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a8cfe1da343b8ed9e6755d32a037a77ad">NY</a>), t_coords(<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a03e18be153927b768e51cb9d1e6d3601">NZ</a>)));</div>
<div class="line">        ++t_a;</div>
<div class="line">        ++t_l;</div>
<div class="line">      }</div>
<div class="line">      ++t_w;</div>
<div class="line">      ++t_u;</div>
<div class="line">      ++t_coords;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>OpResF_Boundary : <span class="keyword">public</span> Op_g {</div>
<div class="line"> </div>
<div class="line">  OpResF_Boundary(boost::shared_ptr&lt;VectorDouble&gt; &amp;lambda_vals)</div>
<div class="line">      : Op_g(<a class="code hl_typedef" href="structPoissonExample_1_1Op__g.html#a36df8342dcddc4a5c595ec98e2e5c70a">FVal</a>(), <span class="stringliteral">&quot;U&quot;</span>, 1), <a id="a95" name="a95"></a><a class="code hl_variable" href="structPoissonExample_1_1OpResF__Boundary.html#a469555d9dc0f74efb69a2690225756e4">lambdaVals</a>(lambda_vals) {}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">protected</span>:</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="structPoissonExample_1_1OpResF__Boundary.html#a469555d9dc0f74efb69a2690225756e4">lambdaVals</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Integrate local constrains vector</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a96" name="a96"></a><a class="code hl_function" href="structPoissonExample_1_1OpResF__Boundary.html#a7d230b2cfc0a8d551931343ccf81a0bf">iNtegrate</a>(<a class="code hl_struct" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// set size to local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.resize(<a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// clear local vector</span></div>
<div class="line">    <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.clear();</div>
<div class="line">    <span class="comment">// get face area</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> area = getArea() * <a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#adf44a1fd390a69f6c46d87d337f7758a">bEta</a>;</div>
<div class="line">    <span class="comment">// get integration weight</span></div>
<div class="line">    <span class="keyword">auto</span> t_w = getFTensor0IntegrationWeight();</div>
<div class="line">    <span class="comment">// get base function</span></div>
<div class="line">    <span class="keyword">auto</span> t_u = data.<a class="code hl_function" href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">getFTensor0N</a>();</div>
<div class="line">    <span class="comment">// get solution at integration point</span></div>
<div class="line">    <span class="keyword">auto</span> t_lambda = getFTensor0FromVec(*<a class="code hl_variable" href="structPoissonExample_1_1OpResF__Boundary.html#a469555d9dc0f74efb69a2690225756e4">lambdaVals</a>);</div>
<div class="line">    <span class="comment">// make loop over integration points</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> gg = 0; gg != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">nbIntegrationPts</a>; gg++) {</div>
<div class="line">      <span class="comment">// evaluate function on boundary and scale it by area and integration</span></div>
<div class="line">      <span class="comment">// weight</span></div>
<div class="line">      <span class="keywordtype">double</span> alpha = area * t_w;</div>
<div class="line">      <span class="comment">// get element of vector</span></div>
<div class="line">      <a class="code hl_class" href="classFTensor_1_1Tensor0.html">FTensor::Tensor0&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>&gt; t_a(</div>
<div class="line">          &amp;*<a class="code hl_variable" href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">locVec</a>.data().begin());</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> rr = 0; rr != <a class="code hl_variable" href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">nbRows</a>; rr++) {</div>
<div class="line">        t_a += alpha * t_u * t_lambda;</div>
<div class="line">        ++t_a;</div>
<div class="line">        ++t_u;</div>
<div class="line">      }</div>
<div class="line">      ++t_w;</div>
<div class="line">      ++t_lambda;</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Set integration rule to volume elements</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This rule is used to integrate \f$\nabla v \cdot \nabla u\f$, thus</span></div>
<div class="line"><span class="comment"> * if approximation field and testing field are polynomial order &quot;p&quot;,</span></div>
<div class="line"><span class="comment"> * then rule for exact integration is 2*(p-1).</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Integration rule is order of polynomial which is calculated exactly. Finite</span></div>
<div class="line"><span class="comment"> * element selects integration method based on return of this function.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a97" name="_a97"></a><a class="code hl_struct" href="structVolRule.html">VolRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a98" name="a98"></a><a class="code hl_function" href="structPoissonExample_1_1VolRule.html#a86629201e8986494b09703678832168b">operator()</a>(<span class="keywordtype">int</span>, <span class="keywordtype">int</span>, <span class="keywordtype">int</span> p)<span class="keyword"> const </span>{ <span class="keywordflow">return</span> 2 * (p - 1); }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Set integration rule to boundary elements</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This is uses to integrate values on the face. Is used to integrate</span></div>
<div class="line"><span class="comment"> * \f$(\mathbf{n} \cdot \lambda) u\f$, where Lagrange multiplayer</span></div>
<div class="line"><span class="comment"> * is order &quot;p_row&quot; and approximate function is order &quot;p_col&quot;.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Integration rule is order of polynomial which is calculated exactly. Finite</span></div>
<div class="line"><span class="comment"> * element selects integration method based on return of this function.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a99" name="_a99"></a><a class="code hl_struct" href="structFaceRule.html">FaceRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a100" name="a100"></a><a class="code hl_function" href="structPoissonExample_1_1FaceRule.html#a24d22cdabf15039021ef4ce15d41fc7d">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * p_data + 1;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \brief Create finite elements instances</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Create finite element instances and add operators to finite elements.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span>CreateFiniteElements {</div>
<div class="line"> </div>
<div class="line">  CreateFiniteElements(<a id="_a101" name="_a101"></a><a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;m_field) : <a id="a102" name="a102"></a><a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>(m_field) {}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to calculate matrix and vectors</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a103" name="a103"></a><a class="code hl_function" href="structPoissonExample_1_1CreateFiniteElements.html#ae7e856976912e3f952c8c5b96b674978">createFEToAssembleMatrixAndVector</a>(</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; f_u,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">          f_source,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_rhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_rhs_fe,</div>
<div class="line">      <span class="keywordtype">bool</span> trans = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create elements element instances</span></div>
<div class="line">    domain_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a104" name="_a104"></a><a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(<a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>));</div>
<div class="line">    boundary_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a105" name="_a105"></a><a class="code hl_class" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(<a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>));</div>
<div class="line">    domain_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(<a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>));</div>
<div class="line">    boundary_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_class" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(<a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rule to elements instances</span></div>
<div class="line">    domain_lhs_fe-&gt;getRuleHook = <a class="code hl_struct" href="structVolRule.html">VolRule</a>();</div>
<div class="line">    domain_rhs_fe-&gt;getRuleHook = <a class="code hl_struct" href="structVolRule.html">VolRule</a>();</div>
<div class="line">    boundary_lhs_fe-&gt;getRuleHook = <a class="code hl_struct" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line">    boundary_rhs_fe-&gt;getRuleHook = <a class="code hl_struct" href="structFaceRule.html">FaceRule</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operators to element instances</span></div>
<div class="line">    <span class="comment">// Add operator grad-grad for calculate matrix</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="structOpK.html">OpK</a>());</div>
<div class="line">    <span class="comment">// Add operator to calculate source terms</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpF(f_source));</div>
<div class="line">    <span class="comment">// Add operator calculating constrains matrix</span></div>
<div class="line">    boundary_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC(trans));</div>
<div class="line">    <span class="comment">// Add operator calculating constrains vector</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> Op_g(f_u));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to calculate error</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a106" name="a106"></a><a class="code hl_function" href="structPoissonExample_1_1CreateFiniteElements.html#ae250a14f45127e19c97e17df96252329">createFEToEvaluateError</a>(</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; f_u,</div>
<div class="line">      boost::function&lt;<a class="code hl_class" href="classFTensor_1_1Tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>,</div>
<div class="line">                                                  <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">          g_u,</div>
<div class="line">      Vec global_error,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_error)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// Create finite element instance to calculate error</span></div>
<div class="line">    domain_error = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(<a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>));</div>
<div class="line">    domain_error-&gt;getRuleHook = <a class="code hl_struct" href="structVolRule.html">VolRule</a>();</div>
<div class="line">    <span class="comment">// Set integration rule</span></div>
<div class="line">    <span class="comment">// Crate shared vector storing values of field &quot;u&quot; on integration points on</span></div>
<div class="line">    <span class="comment">// element. element is local and is used to exchange data between operators.</span></div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; values_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="comment">// Storing gradients of field</span></div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; grad_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a107" name="_a107"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate field gradient at integration points</span></div>
<div class="line">    domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a108" name="_a108"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator to integrate error element by element.</span></div>
<div class="line">    domain_error-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structOpError.html">OpError</a>(f_u, g_u, values_at_integration_ptr,</div>
<div class="line">                    grad_at_integration_ptr, global_error));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to post-process results</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a109" name="a109"></a><a class="code hl_function" href="structPoissonExample_1_1CreateFiniteElements.html#a63d3da59aa561779e9e56bf4284ceeea">creatFEToPostProcessResults</a>(</div>
<div class="line">      boost::shared_ptr&lt;PostProcFE&gt; &amp;post_proc_volume)<span class="keyword"> const </span>{</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Note that user can stack together arbitrary number of operators to</span></div>
<div class="line">    <span class="comment">// compose complex PDEs.</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Post-process results. This is standard element, with functionality</span></div>
<div class="line">    <span class="comment">// enabling refining mesh for post-processing. In addition in</span></div>
<div class="line">    <span class="comment">// PostProcOnRefMesh.hpp are implanted set of  users operators to</span></div>
<div class="line">    <span class="comment">// post-processing fields. Here using simplified mechanism for</span></div>
<div class="line">    <span class="comment">// post-processing finite element, we add operators to save data from field</span></div>
<div class="line">    <span class="comment">// on mesh tags for ParaView visualization.</span></div>
<div class="line">    post_proc_volume =</div>
<div class="line">        boost::shared_ptr&lt;PostProcFE&gt;(<span class="keyword">new</span> <a class="code hl_typedef" href="namespacePoissonExample.html#a097610ce0a8fd450f66ead79cc7e81a7">PostProcFE</a>(<a class="code hl_variable" href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">mField</a>));</div>
<div class="line">    <span class="comment">// Add operators to the elements, starting with some generic</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> det_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> inv_jac_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a110" name="_a110"></a><a class="code hl_struct" href="structMoFEM_1_1OpCalculateHOJac.html">OpCalculateHOJac&lt;3&gt;</a>(jac_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a111" name="_a111"></a><a class="code hl_struct" href="structMoFEM_1_1OpInvertMatrix.html">OpInvertMatrix&lt;3&gt;</a>(jac_ptr, det_ptr, inv_jac_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a112" name="_a112"></a><a class="code hl_struct" href="structMoFEM_1_1OpSetHOInvJacToScalarBases.html">OpSetHOInvJacToScalarBases&lt;3&gt;</a>(<a id="a113" name="a113"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, inv_jac_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> grad_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> e_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_ptr));</div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;ERROR&quot;</span>, e_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a id="_a114" name="_a114"></a><a class="code hl_struct" href="structMoFEM_1_1OpPostProcMapInMoab.html">OpPostProcMapInMoab&lt;3, 3&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    post_proc_volume-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a id="a115" name="a115"></a><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">            post_proc_volume-&gt;getPostProcMesh(),</div>
<div class="line">            post_proc_volume-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}, {<span class="stringliteral">&quot;ERROR&quot;</span>, e_ptr}},</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;GRAD&quot;</span>, grad_ptr}},</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {}</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * \brief Create finite element to calculate matrix and vectors</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> createFEToAssembleMatrixAndVectorForNonlinearProblem(</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; f_u,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>)&gt;</div>
<div class="line">          f_source,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>,</div>
<div class="line">      boost::function&lt;<span class="keywordtype">double</span>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; diff_a,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_lhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;domain_rhs_fe,</div>
<div class="line">      boost::shared_ptr&lt;ForcesAndSourcesCore&gt; &amp;boundary_rhs_fe,</div>
<div class="line">      <a class="code hl_typedef" href="structMoFEM_1_1ForcesAndSourcesCore.html#ab74a230ea17b23143370a833d5b476b2">ForcesAndSourcesCore::RuleHookFun</a> vol_rule,</div>
<div class="line">      <a class="code hl_typedef" href="structMoFEM_1_1ForcesAndSourcesCore.html#ab74a230ea17b23143370a833d5b476b2">ForcesAndSourcesCore::RuleHookFun</a> face_rule = <a class="code hl_struct" href="structFaceRule.html">FaceRule</a>(),</div>
<div class="line">      <span class="keywordtype">bool</span> trans = <span class="keyword">true</span>)<span class="keyword"> const </span>{</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create elements element instances</span></div>
<div class="line">    domain_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    boundary_lhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_class" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    domain_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">VolumeElementForcesAndSourcesCore</a>(mField));</div>
<div class="line">    boundary_rhs_fe = boost::shared_ptr&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_class" href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a>(mField));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rule to elements instances</span></div>
<div class="line">    domain_lhs_fe-&gt;getRuleHook = vol_rule;</div>
<div class="line">    domain_rhs_fe-&gt;getRuleHook = vol_rule;</div>
<div class="line">    boundary_lhs_fe-&gt;getRuleHook = face_rule;</div>
<div class="line">    boundary_rhs_fe-&gt;getRuleHook = face_rule;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Set integration rule</span></div>
<div class="line">    <span class="comment">// Crate shared vector storing values of field &quot;u&quot; on integration points on</span></div>
<div class="line">    <span class="comment">// element. element is local and is used to exchange data between operators.</span></div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; values_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="comment">// Storing gradients of field</span></div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; grad_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// multipliers values</span></div>
<div class="line">    boost::shared_ptr&lt;VectorDouble&gt; multiplier_at_integration_ptr =</div>
<div class="line">        boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operators to element instances</span></div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate field gradient at integration points</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator grad-(1+u^2)grad for calculate matrix</span></div>
<div class="line">    domain_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpKt(</div>
<div class="line">        <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, diff_a, values_at_integration_ptr, grad_at_integration_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate field gradient at integration points</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">OpCalculateScalarFieldGradient&lt;3&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, grad_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator to calculate source terms</span></div>
<div class="line">    domain_rhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpResF_Domain(</div>
<div class="line">        f_source, <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, values_at_integration_ptr, grad_at_integration_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add operator calculating constrains matrix</span></div>
<div class="line">    boundary_lhs_fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC(trans));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add default operator to calculate field values at integration points</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;U&quot;</span>, values_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add default operator to calculate values of Lagrange multipliers</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="structMoFEM_1_1OpCalculateScalarFieldValues.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;L&quot;</span>, multiplier_at_integration_ptr));</div>
<div class="line">    <span class="comment">// Add operator calculating constrains vector</span></div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpRes_g(f_u, values_at_integration_ptr));</div>
<div class="line">    boundary_rhs_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpResF_Boundary(multiplier_at_integration_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_struct" href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::Interface</a> &amp;mField;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace PoissonExample</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">//__POISSONOPERATORS_HPP__</span></div>
<div class="ttc" id="aMoFEM_8hpp_html"><div class="ttname"><a href="MoFEM_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="aclassB_html"><div class="ttname"><a href="classB.html">B</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Index_html"><div class="ttname"><a href="classFTensor_1_1Index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition</b> <a href="Index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Number_html"><div class="ttname"><a href="classFTensor_1_1Number.html">FTensor::Number</a></div><div class="ttdef"><b>Definition</b> <a href="Number_8hpp_source.html#l00011">Number.hpp:12</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor0_html"><div class="ttname"><a href="classFTensor_1_1Tensor0.html">FTensor::Tensor0</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor0_8hpp_source.html#l00016">Tensor0.hpp:17</a></div></div>
<div class="ttc" id="aclassFTensor_1_1Tensor1_html"><div class="ttname"><a href="classFTensor_1_1Tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="Tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclassFaceElementForcesAndSourcesCore_html"><div class="ttname"><a href="classFaceElementForcesAndSourcesCore.html">FaceElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="aclassOPBASE_html"><div class="ttname"><a href="classOPBASE.html">OPBASE</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00463">definitions.h:463</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00432">definitions.h:432</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00551">definitions.h:551</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespaceMoFEM_1_1Exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="Exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_a71f706f784fbf6fd240806b70ed7d933"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#a71f706f784fbf6fd240806b70ed7d933">MoFEM::Types::MatrixDouble</a></div><div class="ttdeci">UBlasMatrix&lt; double &gt; MatrixDouble</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00077">Types.hpp:77</a></div></div>
<div class="ttc" id="anamespaceMoFEM_1_1Types_html_aab2f28b2af54eb9f62cc60a53e1c6d3b"><div class="ttname"><a href="namespaceMoFEM_1_1Types.html#aab2f28b2af54eb9f62cc60a53e1c6d3b">MoFEM::Types::VectorDouble</a></div><div class="ttdeci">UBlasVector&lt; double &gt; VectorDouble</div><div class="ttdef"><b>Definition</b> <a href="Types_8hpp_source.html#l00068">Types.hpp:68</a></div></div>
<div class="ttc" id="anamespaceMoFEM_html"><div class="ttname"><a href="namespaceMoFEM.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="Common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespacePoissonExample_html"><div class="ttname"><a href="namespacePoissonExample.html">PoissonExample</a></div><div class="ttdef"><b>Definition</b> <a href="AuxPoissonFunctions_8hpp_source.html#l00012">AuxPoissonFunctions.hpp:12</a></div></div>
<div class="ttc" id="anamespacePoissonExample_html_a097610ce0a8fd450f66ead79cc7e81a7"><div class="ttname"><a href="namespacePoissonExample.html#a097610ce0a8fd450f66ead79cc7e81a7">PoissonExample::PostProcFE</a></div><div class="ttdeci">PostProcBrokenMeshInMoab&lt; VolumeElementForcesAndSourcesCore &gt; PostProcFE</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00015">PoissonOperators.hpp:15</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="astructFaceRule_html"><div class="ttname"><a href="structFaceRule.html">FaceRule</a></div><div class="ttdoc">Set integration rule to boundary elements.</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00091">simple_interface.cpp:91</a></div></div>
<div class="ttc" id="astructMoFEM_1_1DeprecatedCoreInterface_html"><div class="ttname"><a href="structMoFEM_1_1DeprecatedCoreInterface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="DeprecatedCoreInterface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a0488e04e389071c795c0233b028de015"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a0488e04e389071c795c0233b028de015">MoFEM::EntitiesFieldData::EntData::getFTensor1DiffN</a></div><div class="ttdeci">FTensor::Tensor1&lt; FTensor::PackPtr&lt; double *, Tensor_Dim &gt;, Tensor_Dim &gt; getFTensor1DiffN(const FieldApproximationBase base)</div><div class="ttdoc">Get derivatives of base functions.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8cpp_source.html#l00526">EntitiesFieldData.cpp:526</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a1effe6c5260104eb70a930d993942675"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a1effe6c5260104eb70a930d993942675">MoFEM::EntitiesFieldData::EntData::getFTensor0N</a></div><div class="ttdeci">FTensor::Tensor0&lt; FTensor::PackPtr&lt; double *, 1 &gt; &gt; getFTensor0N(const FieldApproximationBase base)</div><div class="ttdoc">Get base function as Tensor0.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01502">EntitiesFieldData.hpp:1502</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_a6fb60e6aba0a189316962e4e96bce5e4"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#a6fb60e6aba0a189316962e4e96bce5e4">MoFEM::EntitiesFieldData::EntData::getFieldData</a></div><div class="ttdeci">const VectorDouble &amp; getFieldData() const</div><div class="ttdoc">get dofs values</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01254">EntitiesFieldData.hpp:1254</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_ab762079df5a543d6e8cdcfc01fba148b"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ab762079df5a543d6e8cdcfc01fba148b">MoFEM::EntitiesFieldData::EntData::getFieldDofs</a></div><div class="ttdeci">const VectorDofs &amp; getFieldDofs() const</div><div class="ttdoc">get dofs data stature FEDofEntity</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01269">EntitiesFieldData.hpp:1269</a></div></div>
<div class="ttc" id="astructMoFEM_1_1EntitiesFieldData_1_1EntData_html_ae5f8ff17de93c9dbb9701dc0bf067b2e"><div class="ttname"><a href="structMoFEM_1_1EntitiesFieldData_1_1EntData.html#ae5f8ff17de93c9dbb9701dc0bf067b2e">MoFEM::EntitiesFieldData::EntData::getIndices</a></div><div class="ttdeci">const VectorInt &amp; getIndices() const</div><div class="ttdoc">Get global indices of dofs on entity.</div><div class="ttdef"><b>Definition</b> <a href="EntitiesFieldData_8hpp_source.html#l01214">EntitiesFieldData.hpp:1214</a></div></div>
<div class="ttc" id="astructMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1FaceElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::FaceElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdoc">default operator for TRI element</div><div class="ttdef"><b>Definition</b> <a href="FaceElementForcesAndSourcesCore_8hpp_source.html#l00094">FaceElementForcesAndSourcesCore.hpp:95</a></div></div>
<div class="ttc" id="astructMoFEM_1_1ForcesAndSourcesCore_html_ab74a230ea17b23143370a833d5b476b2"><div class="ttname"><a href="structMoFEM_1_1ForcesAndSourcesCore.html#ab74a230ea17b23143370a833d5b476b2">MoFEM::ForcesAndSourcesCore::RuleHookFun</a></div><div class="ttdeci">boost::function&lt; int(int order_row, int order_col, int order_data)&gt; RuleHookFun</div><div class="ttdef"><b>Definition</b> <a href="ForcesAndSourcesCore_8hpp_source.html#l00028">ForcesAndSourcesCore.hpp:28</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateHOJac_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateHOJac.html">MoFEM::OpCalculateHOJac</a></div><div class="ttdef"><b>Definition</b> <a href="HODataOperators_8hpp_source.html#l00267">HODataOperators.hpp:267</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldGradient_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldGradient.html">MoFEM::OpCalculateScalarFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar field rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l01319">UserDataOperators.hpp:1321</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpCalculateScalarFieldValues_html"><div class="ttname"><a href="structMoFEM_1_1OpCalculateScalarFieldValues.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l00082">UserDataOperators.hpp:83</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpInvertMatrix_html"><div class="ttname"><a href="structMoFEM_1_1OpInvertMatrix.html">MoFEM::OpInvertMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="UserDataOperators_8hpp_source.html#l03700">UserDataOperators.hpp:3700</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpPostProcMapInMoab_html"><div class="ttname"><a href="structMoFEM_1_1OpPostProcMapInMoab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00709">PostProcBrokenMeshInMoabBase.hpp:709</a></div></div>
<div class="ttc" id="astructMoFEM_1_1OpSetHOInvJacToScalarBases_html"><div class="ttname"><a href="structMoFEM_1_1OpSetHOInvJacToScalarBases.html">MoFEM::OpSetHOInvJacToScalarBases</a></div><div class="ttdoc">Set inverse jacobian to base functions.</div><div class="ttdef"><b>Definition</b> <a href="HODataOperators_8hpp_source.html#l00073">HODataOperators.hpp:73</a></div></div>
<div class="ttc" id="astructMoFEM_1_1PostProcBrokenMeshInMoab_html"><div class="ttname"><a href="structMoFEM_1_1PostProcBrokenMeshInMoab.html">MoFEM::PostProcBrokenMeshInMoab</a></div><div class="ttdef"><b>Definition</b> <a href="PostProcBrokenMeshInMoabBase_8hpp_source.html#l00677">PostProcBrokenMeshInMoabBase.hpp:677</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore_1_1UserDataOperator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00109">VolumeElementForcesAndSourcesCore.hpp:110</a></div></div>
<div class="ttc" id="astructMoFEM_1_1VolumeElementForcesAndSourcesCore_html"><div class="ttname"><a href="structMoFEM_1_1VolumeElementForcesAndSourcesCore.html">MoFEM::VolumeElementForcesAndSourcesCore</a></div><div class="ttdoc">Volume finite element base.</div><div class="ttdef"><b>Definition</b> <a href="VolumeElementForcesAndSourcesCore_8hpp_source.html#l00026">VolumeElementForcesAndSourcesCore.hpp:26</a></div></div>
<div class="ttc" id="astructOpError_html"><div class="ttname"><a href="structOpError.html">OpError</a></div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00061">initial_diffusion.cpp:61</a></div></div>
<div class="ttc" id="astructOpK_html"><div class="ttname"><a href="structOpK.html">OpK</a></div><div class="ttdef"><b>Definition</b> <a href="simple__elasticity_8cpp_source.html#l00016">simple_elasticity.cpp:16</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_a3e82f5eca01cac50ed0d7524c6bc998b"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#a3e82f5eca01cac50ed0d7524c6bc998b">PoissonExample::CreateFiniteElements::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l01096">PoissonOperators.hpp:1096</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_a63d3da59aa561779e9e56bf4284ceeea"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#a63d3da59aa561779e9e56bf4284ceeea">PoissonExample::CreateFiniteElements::creatFEToPostProcessResults</a></div><div class="ttdeci">MoFEMErrorCode creatFEToPostProcessResults(boost::shared_ptr&lt; PostProcFE &gt; &amp;post_proc_volume) const</div><div class="ttdoc">Create finite element to post-process results.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00947">PoissonOperators.hpp:947</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_ae250a14f45127e19c97e17df96252329"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#ae250a14f45127e19c97e17df96252329">PoissonExample::CreateFiniteElements::createFEToEvaluateError</a></div><div class="ttdeci">MoFEMErrorCode createFEToEvaluateError(boost::function&lt; double(const double, const double, const double)&gt; f_u, boost::function&lt; FTensor::Tensor1&lt; double, 3 &gt;(const double, const double, const double)&gt; g_u, Vec global_error, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;domain_error) const</div><div class="ttdoc">Create finite element to calculate error.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00911">PoissonOperators.hpp:911</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1CreateFiniteElements_html_ae7e856976912e3f952c8c5b96b674978"><div class="ttname"><a href="structPoissonExample_1_1CreateFiniteElements.html#ae7e856976912e3f952c8c5b96b674978">PoissonExample::CreateFiniteElements::createFEToAssembleMatrixAndVector</a></div><div class="ttdeci">MoFEMErrorCode createFEToAssembleMatrixAndVector(boost::function&lt; double(const double, const double, const double)&gt; f_u, boost::function&lt; double(const double, const double, const double)&gt; f_source, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;domain_lhs_fe, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;boundary_lhs_fe, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;domain_rhs_fe, boost::shared_ptr&lt; ForcesAndSourcesCore &gt; &amp;boundary_rhs_fe, bool trans=true) const</div><div class="ttdoc">Create finite element to calculate matrix and vectors.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00868">PoissonOperators.hpp:868</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1FaceRule_html_a24d22cdabf15039021ef4ce15d41fc7d"><div class="ttname"><a href="structPoissonExample_1_1FaceRule.html#a24d22cdabf15039021ef4ce15d41fc7d">PoissonExample::FaceRule::operator()</a></div><div class="ttdeci">int operator()(int p_row, int p_col, int p_data) const</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00850">PoissonOperators.hpp:850</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a279399b0c2e4b596c33f6cdc344695be"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a279399b0c2e4b596c33f6cdc344695be">PoissonExample::OpBaseRhs::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">&lt; error code</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00207">PoissonOperators.hpp:207</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a3147299c39a32de4e3efd0d05d2e381d"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a3147299c39a32de4e3efd0d05d2e381d">PoissonExample::OpBaseRhs::nbIntegrationPts</a></div><div class="ttdeci">int nbIntegrationPts</div><div class="ttdoc">number of integration points</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00208">PoissonOperators.hpp:208</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a436705aa66999557e70e43853b4dc320"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a436705aa66999557e70e43853b4dc320">PoissonExample::OpBaseRhs::aSsemble</a></div><div class="ttdeci">virtual MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)=0</div><div class="ttdoc">Class dedicated to assemble operator to global system vector.</div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_a7e0053c987e075cbcd68b4d567115630"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#a7e0053c987e075cbcd68b4d567115630">PoissonExample::OpBaseRhs::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntitiesFieldData::EntData &amp;row_data)</div><div class="ttdoc">This function is called by finite element.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00175">PoissonOperators.hpp:175</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpBaseRhs_html_afc2927f382c9aa8af5c414dc81d4becb"><div class="ttname"><a href="structPoissonExample_1_1OpBaseRhs.html#afc2927f382c9aa8af5c414dc81d4becb">PoissonExample::OpBaseRhs::iNtegrate</a></div><div class="ttdeci">virtual MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)=0</div><div class="ttdoc">Class dedicated to integrate operator.</div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_a0ca6d80c7b24b4f1409390d256797212"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#a0ca6d80c7b24b4f1409390d256797212">PoissonExample::OpC::locMat</a></div><div class="ttdeci">MatrixDouble locMat</div><div class="ttdoc">local constrains matrix</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00344">PoissonOperators.hpp:344</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_a1252608d057c9cdd1b5817cec530b5d6"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#a1252608d057c9cdd1b5817cec530b5d6">PoissonExample::OpC::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00312">PoissonOperators.hpp:312</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_a18deac04ec16cf98590c21aaf7cde5f4"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#a18deac04ec16cf98590c21aaf7cde5f4">PoissonExample::OpC::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">integrate local constrains matrix</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00388">PoissonOperators.hpp:388</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_a4e14f1cba17ed0174a5548bae8d592c9"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#a4e14f1cba17ed0174a5548bae8d592c9">PoissonExample::OpC::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Integrate local constrains matrix.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00348">PoissonOperators.hpp:348</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_a70d4563fe32d3b33eb936fa5526e6f3e"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#a70d4563fe32d3b33eb936fa5526e6f3e">PoissonExample::OpC::nbIntegrationPts</a></div><div class="ttdeci">int nbIntegrationPts</div><div class="ttdoc">number of integration points</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00341">PoissonOperators.hpp:341</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_a7c58bee41dbe309db4106532a9a835f7"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#a7c58bee41dbe309db4106532a9a835f7">PoissonExample::OpC::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">&lt; error code</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00339">PoissonOperators.hpp:339</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_ab2ea8ac3cf7966295408965ed074c0ef"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#ab2ea8ac3cf7966295408965ed074c0ef">PoissonExample::OpC::assembleTranspose</a></div><div class="ttdeci">const bool assembleTranspose</div><div class="ttdoc">assemble transpose, i.e. CT if set to true</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00342">PoissonOperators.hpp:342</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpC_html_abe2a3c128582dd71828109f8ca4225f0"><div class="ttname"><a href="structPoissonExample_1_1OpC.html#abe2a3c128582dd71828109f8ca4225f0">PoissonExample::OpC::nbCols</a></div><div class="ttdeci">int nbCols</div><div class="ttdoc">number of dofs on column</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00340">PoissonOperators.hpp:340</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a1351ee7b257e586ffcfc6e83194103cc"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a1351ee7b257e586ffcfc6e83194103cc">PoissonExample::OpError::globalError</a></div><div class="ttdeci">Vec globalError</div><div class="ttdoc">ghost vector with global (integrated over volume) error</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00523">PoissonOperators.hpp:523</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a16bb56bc60331d302a0b3f6feb825671"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a16bb56bc60331d302a0b3f6feb825671">PoissonExample::OpError::uValue</a></div><div class="ttdeci">UVal uValue</div><div class="ttdoc">function with exact solution</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00529">PoissonOperators.hpp:529</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a3f5e82da6a1ad7ffc7bd609558fc8c3e"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a3f5e82da6a1ad7ffc7bd609558fc8c3e">PoissonExample::OpError::gradVals</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; gradVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00533">PoissonOperators.hpp:533</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a3f7abcb94b3846cf7b67102541d8d6f9"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a3f7abcb94b3846cf7b67102541d8d6f9">PoissonExample::OpError::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, EntityType row_type, EntitiesFieldData::EntData &amp;row_data)</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00510">PoissonOperators.hpp:510</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a517f1b72975cf08edfb4e0c43e9da64d"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a517f1b72975cf08edfb4e0c43e9da64d">PoissonExample::OpError::UVal</a></div><div class="ttdeci">boost::function&lt; double(const double, const double, const double)&gt; UVal</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00498">PoissonOperators.hpp:498</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a75a3dd953a0e8765942f4e6052b5c91c"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a75a3dd953a0e8765942f4e6052b5c91c">PoissonExample::OpError::NZ</a></div><div class="ttdeci">FTensor::Number&lt; 2 &gt; NZ</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00527">PoissonOperators.hpp:527</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a7917a5778c46a3fb1d572d13972b7747"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a7917a5778c46a3fb1d572d13972b7747">PoissonExample::OpError::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 3 &gt; i</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00528">PoissonOperators.hpp:528</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a8733815305e402bdb988460188f689a0"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a8733815305e402bdb988460188f689a0">PoissonExample::OpError::gValue</a></div><div class="ttdeci">GVal gValue</div><div class="ttdoc">function with exact solution for gradient</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00530">PoissonOperators.hpp:530</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a91a102c742d515db8819fa42ed70b843"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a91a102c742d515db8819fa42ed70b843">PoissonExample::OpError::fieldVals</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; fieldVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00532">PoissonOperators.hpp:532</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_a94c3d65735d75b6a15f4ce997b62fe26"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#a94c3d65735d75b6a15f4ce997b62fe26">PoissonExample::OpError::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate error.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00538">PoissonOperators.hpp:538</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_aa3707c83acb519472473e7d121a7ecec"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#aa3707c83acb519472473e7d121a7ecec">PoissonExample::OpError::NY</a></div><div class="ttdeci">FTensor::Number&lt; 1 &gt; NY</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00526">PoissonOperators.hpp:526</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_ada8e7ed84c3e3f597408e9b7af89dd83"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#ada8e7ed84c3e3f597408e9b7af89dd83">PoissonExample::OpError::GVal</a></div><div class="ttdeci">boost::function&lt; FTensor::Tensor1&lt; double, 3 &gt;(const double, const double, const double)&gt; GVal</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00501">PoissonOperators.hpp:501</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_ade7157aa42faac4aa2a798ef169fcfb5"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#ade7157aa42faac4aa2a798ef169fcfb5">PoissonExample::OpError::NX</a></div><div class="ttdeci">FTensor::Number&lt; 0 &gt; NX</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00525">PoissonOperators.hpp:525</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpError_html_afefb3352b6edc0930da3fa9051eb55ea"><div class="ttname"><a href="structPoissonExample_1_1OpError.html#afefb3352b6edc0930da3fa9051eb55ea">PoissonExample::OpError::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Assemble error.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00578">PoissonOperators.hpp:578</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a1748266c75e0908089cffccd3c694df6"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a1748266c75e0908089cffccd3c694df6">PoissonExample::OpF::locVec</a></div><div class="ttdeci">VectorDouble locVec</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00235">PoissonOperators.hpp:235</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a303a9491f132ded9c0ffce846bd4bd59"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a303a9491f132ded9c0ffce846bd4bd59">PoissonExample::OpF::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">assemble local entity vector to the global right hand side</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00282">PoissonOperators.hpp:282</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a43c37be2c702f6c5a6e5db862abfd5fc"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a43c37be2c702f6c5a6e5db862abfd5fc">PoissonExample::OpF::NZ</a></div><div class="ttdeci">FTensor::Number&lt; 2 &gt; NZ</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00232">PoissonOperators.hpp:232</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a935925a0321aa4e03a740d1f5056de0d"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a935925a0321aa4e03a740d1f5056de0d">PoissonExample::OpF::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate local entity vector.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00242">PoissonOperators.hpp:242</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a9995d25be251f57ba72526331fc98f55"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a9995d25be251f57ba72526331fc98f55">PoissonExample::OpF::FSource</a></div><div class="ttdeci">boost::function&lt; double(const double, const double, const double)&gt; FSource</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00223">PoissonOperators.hpp:223</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_a9f90a4a852c7cb1c66b67da66c292ada"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#a9f90a4a852c7cb1c66b67da66c292ada">PoissonExample::OpF::fSource</a></div><div class="ttdeci">FSource fSource</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00233">PoissonOperators.hpp:233</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_abb4794c73c5ee3f4f031613c0d79a27e"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#abb4794c73c5ee3f4f031613c0d79a27e">PoissonExample::OpF::NY</a></div><div class="ttdeci">FTensor::Number&lt; 1 &gt; NY</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00231">PoissonOperators.hpp:231</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpF_html_ad9564a0f63832bb0069d064ffae44eee"><div class="ttname"><a href="structPoissonExample_1_1OpF.html#ad9564a0f63832bb0069d064ffae44eee">PoissonExample::OpF::NX</a></div><div class="ttdeci">FTensor::Number&lt; 0 &gt; NX</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00230">PoissonOperators.hpp:230</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a0ab73b3e1778e7f0a4b71874411f7fb3"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a0ab73b3e1778e7f0a4b71874411f7fb3">PoissonExample::OpK::iNtegrate</a></div><div class="ttdeci">virtual MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Integrate grad-grad operator.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00091">PoissonOperators.hpp:91</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a1058045ce8043b0c29196a52100e6959"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a1058045ce8043b0c29196a52100e6959">PoissonExample::OpK::nbRows</a></div><div class="ttdeci">int nbRows</div><div class="ttdoc">&lt; error code</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00077">PoissonOperators.hpp:77</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a3b9ff6d399d5abc8e0edc7a8b55a6d7d"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a3b9ff6d399d5abc8e0edc7a8b55a6d7d">PoissonExample::OpK::nbCols</a></div><div class="ttdeci">int nbCols</div><div class="ttdoc">number if dof on column</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00078">PoissonOperators.hpp:78</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a43ef1dd3ea49ba1a6dcd8d3f62f602b3"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a43ef1dd3ea49ba1a6dcd8d3f62f602b3">PoissonExample::OpK::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Do calculations for give operator.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00044">PoissonOperators.hpp:44</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a870e8adc242ac26e7e7da47bbea995a2"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a870e8adc242ac26e7e7da47bbea995a2">PoissonExample::OpK::isDiag</a></div><div class="ttdeci">bool isDiag</div><div class="ttdoc">true if this block is on diagonal</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00080">PoissonOperators.hpp:80</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a89da441abf8576f1a9f789d934258fbf"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a89da441abf8576f1a9f789d934258fbf">PoissonExample::OpK::locMat</a></div><div class="ttdeci">MatrixDouble locMat</div><div class="ttdoc">local entity block matrix</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00083">PoissonOperators.hpp:83</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_a8c40a8bd41503c9ee6bbaa5611918b0a"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#a8c40a8bd41503c9ee6bbaa5611918b0a">PoissonExample::OpK::nbIntegrationPts</a></div><div class="ttdeci">int nbIntegrationPts</div><div class="ttdoc">number of integration points</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00079">PoissonOperators.hpp:79</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_aaa779f6842211bf1a0b88d8b1712eece"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#aaa779f6842211bf1a0b88d8b1712eece">PoissonExample::OpK::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 3 &gt; i</div><div class="ttdoc">summit Index</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00082">PoissonOperators.hpp:82</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpK_html_ab78619ca7e4a303ac2313930dffecd7a"><div class="ttname"><a href="structPoissonExample_1_1OpK.html#ab78619ca7e4a303ac2313930dffecd7a">PoissonExample::OpK::aSsemble</a></div><div class="ttdeci">virtual MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Assemble local entity block matrix.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00137">PoissonOperators.hpp:137</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpKt_html_a376ac929209b0cd8d30c3d3fcd07f809"><div class="ttname"><a href="structPoissonExample_1_1OpKt.html#a376ac929209b0cd8d30c3d3fcd07f809">PoissonExample::OpKt::diffA</a></div><div class="ttdeci">boost::function&lt; double(const double)&gt; diffA</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00657">PoissonOperators.hpp:657</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpKt_html_a481af7f82f338deb3cb87b6390846b16"><div class="ttname"><a href="structPoissonExample_1_1OpKt.html#a481af7f82f338deb3cb87b6390846b16">PoissonExample::OpKt::gradVals</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; gradVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00659">PoissonOperators.hpp:659</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpKt_html_a5c700b04e80fe02828a68ec3200d5cb7"><div class="ttname"><a href="structPoissonExample_1_1OpKt.html#a5c700b04e80fe02828a68ec3200d5cb7">PoissonExample::OpKt::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Integrate grad-grad operator.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00604">PoissonOperators.hpp:604</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpKt_html_a9c58f35447322a93dda82cab0adcf05e"><div class="ttname"><a href="structPoissonExample_1_1OpKt.html#a9c58f35447322a93dda82cab0adcf05e">PoissonExample::OpKt::fieldVals</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; fieldVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00658">PoissonOperators.hpp:658</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpKt_html_ac5c508443965992164f75bfd6553566e"><div class="ttname"><a href="structPoissonExample_1_1OpKt.html#ac5c508443965992164f75bfd6553566e">PoissonExample::OpKt::A</a></div><div class="ttdeci">boost::function&lt; double(const double)&gt; A</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00656">PoissonOperators.hpp:656</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Boundary_html_a469555d9dc0f74efb69a2690225756e4"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Boundary.html#a469555d9dc0f74efb69a2690225756e4">PoissonExample::OpResF_Boundary::lambdaVals</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; lambdaVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00784">PoissonOperators.hpp:784</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Boundary_html_a7d230b2cfc0a8d551931343ccf81a0bf"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Boundary.html#a7d230b2cfc0a8d551931343ccf81a0bf">PoissonExample::OpResF_Boundary::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate local constrains vector.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00789">PoissonOperators.hpp:789</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Domain_html_a2943e501cac13e060e0430bb308a4eec"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Domain.html#a2943e501cac13e060e0430bb308a4eec">PoissonExample::OpResF_Domain::gradVals</a></div><div class="ttdeci">boost::shared_ptr&lt; MatrixDouble &gt; gradVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00726">PoissonOperators.hpp:726</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Domain_html_a539ef1d9788532f235a0034a7dc1d3bd"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Domain.html#a539ef1d9788532f235a0034a7dc1d3bd">PoissonExample::OpResF_Domain::fieldVals</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; fieldVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00725">PoissonOperators.hpp:725</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Domain_html_a5f65c8de439084edb23847e528e8a112"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Domain.html#a5f65c8de439084edb23847e528e8a112">PoissonExample::OpResF_Domain::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate local entity vector.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00677">PoissonOperators.hpp:677</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Domain_html_a96fbfefcb56fc8a6409c425ef66ef146"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Domain.html#a96fbfefcb56fc8a6409c425ef66ef146">PoissonExample::OpResF_Domain::A</a></div><div class="ttdeci">boost::function&lt; double(const double)&gt; A</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00724">PoissonOperators.hpp:724</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpResF__Domain_html_aab2b718a555fabc8d82ec0e577d215a0"><div class="ttname"><a href="structPoissonExample_1_1OpResF__Domain.html#aab2b718a555fabc8d82ec0e577d215a0">PoissonExample::OpResF_Domain::i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', 3 &gt; i</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00670">PoissonOperators.hpp:670</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpRes__g_html_a4fea4cc1e70d944cd4cfa7ea50ff3183"><div class="ttname"><a href="structPoissonExample_1_1OpRes__g.html#a4fea4cc1e70d944cd4cfa7ea50ff3183">PoissonExample::OpRes_g::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate local constrains vector.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00740">PoissonOperators.hpp:740</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1OpRes__g_html_addd484a1e6323eb229b38bad558b1ae4"><div class="ttname"><a href="structPoissonExample_1_1OpRes__g.html#addd484a1e6323eb229b38bad558b1ae4">PoissonExample::OpRes_g::fieldVals</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; fieldVals</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00735">PoissonOperators.hpp:735</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a03e18be153927b768e51cb9d1e6d3601"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a03e18be153927b768e51cb9d1e6d3601">PoissonExample::Op_g::NZ</a></div><div class="ttdeci">FTensor::Number&lt; 2 &gt; NZ</div><div class="ttdoc">z-direction index</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00433">PoissonOperators.hpp:433</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a181bfd64ce7e6c2bd0be0d3e736826dc"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a181bfd64ce7e6c2bd0be0d3e736826dc">PoissonExample::Op_g::aSsemble</a></div><div class="ttdeci">MoFEMErrorCode aSsemble(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">assemble constrains vectors</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00480">PoissonOperators.hpp:480</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a36df8342dcddc4a5c595ec98e2e5c70a"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a36df8342dcddc4a5c595ec98e2e5c70a">PoissonExample::Op_g::FVal</a></div><div class="ttdeci">boost::function&lt; double(const double, const double, const double)&gt; FVal</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00423">PoissonOperators.hpp:423</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a3d420c78551d8957da4e600ffc0ad59a"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a3d420c78551d8957da4e600ffc0ad59a">PoissonExample::Op_g::iNtegrate</a></div><div class="ttdeci">MoFEMErrorCode iNtegrate(EntitiesFieldData::EntData &amp;data)</div><div class="ttdoc">Integrate local constrains vector.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00442">PoissonOperators.hpp:442</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a464b4029a2f5039ccabdf5aa51c504a6"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a464b4029a2f5039ccabdf5aa51c504a6">PoissonExample::Op_g::NX</a></div><div class="ttdeci">FTensor::Number&lt; 0 &gt; NX</div><div class="ttdoc">x-direction index</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00431">PoissonOperators.hpp:431</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a67a30e6112945ac5b1e7fcefab602e6b"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a67a30e6112945ac5b1e7fcefab602e6b">PoissonExample::Op_g::locVec</a></div><div class="ttdeci">VectorDouble locVec</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00436">PoissonOperators.hpp:436</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a8cfe1da343b8ed9e6755d32a037a77ad"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a8cfe1da343b8ed9e6755d32a037a77ad">PoissonExample::Op_g::NY</a></div><div class="ttdeci">FTensor::Number&lt; 1 &gt; NY</div><div class="ttdoc">y-direction index</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00432">PoissonOperators.hpp:432</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_a9cf6f30ad8d893d8c9f931346b94d45c"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#a9cf6f30ad8d893d8c9f931346b94d45c">PoissonExample::Op_g::fValue</a></div><div class="ttdeci">FVal fValue</div><div class="ttdoc">Function pointer evaluating values of &quot;U&quot; at the boundary.</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00434">PoissonOperators.hpp:434</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1Op__g_html_adf44a1fd390a69f6c46d87d337f7758a"><div class="ttname"><a href="structPoissonExample_1_1Op__g.html#adf44a1fd390a69f6c46d87d337f7758a">PoissonExample::Op_g::bEta</a></div><div class="ttdeci">const double bEta</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00437">PoissonOperators.hpp:437</a></div></div>
<div class="ttc" id="astructPoissonExample_1_1VolRule_html_a86629201e8986494b09703678832168b"><div class="ttname"><a href="structPoissonExample_1_1VolRule.html#a86629201e8986494b09703678832168b">PoissonExample::VolRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int p) const</div><div class="ttdef"><b>Definition</b> <a href="PoissonOperators_8hpp_source.html#l00835">PoissonOperators.hpp:835</a></div></div>
<div class="ttc" id="astructVolRule_html"><div class="ttname"><a href="structVolRule.html">VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00088">simple_interface.cpp:88</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.9.8
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>