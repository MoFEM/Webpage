<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: lorentz_force.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">lorentz_force.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>Calculate Lorentz fore from magnetic field.</p>
<p>Calculate Lorentz fore from magnetic field.It is not attemt to have accurate or realistic model of moving particles in magnetic field. This example was create to show how field evaluator works with precalculated magnetic field.</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000058">Todo</a></b></dt><dd><p class="startdd">use physical quantities </p>
<p class="interdd">take in account higher order geometry </p>
<p class="enddd">code panellisation, works serial only</p>
</dd></dl>
<p>Exaltation           </p><p class="formulaDsp">
\[
 v_i = (p_{i+1} - p_{i-1}) / (2 \delta t) \\
 (p_{i-1} - 2 p_i + p_{i+1}) / \delta t^2 = \frac{q}{m} v_i \times B_i \\
 (p_{i-1} - 2 p_i + p_{i+1}) / \delta t^2 = \frac{q}{m} (p_{i+1} - p_{i-1}) /
(2 \delta t)  \times B_i \\
 (p_{i-1} - 2 p_i + p_{i+1}) / \delta t = \frac{q}{m} (p_{i+1} - p_{i-1})
\times B_i / 2  \\
 p_{i+1} / \delta t - p_{i+1} \times B_i / 2= (2 p_i - p_{i-1}) / \delta t -
p_{i-1} \times B_i / 2 \\ p_{i+1} (\mathbf{1} / \delta t - \frac{q}{m}
\mathbf{1} \times B_i / 2 )= (2 p_i - p_{i-1}) / \delta t - \frac{q}{m}
p_{i-1} \times B_i / 2 \]
</p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file lorentz_force.cpp</span></div>
<div class="line"><span class="comment"> * \example lorentz_force.cpp</span></div>
<div class="line"><span class="comment"> * \brief Calculate Lorentz fore from magnetic field.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * It is not attemt to have accurate or realistic model of moving particles in</span></div>
<div class="line"><span class="comment"> * magnetic field. This example was create to show how field evaluator works</span></div>
<div class="line"><span class="comment"> * with precalculated magnetic field.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \todo use physical quantities</span></div>
<div class="line"><span class="comment"> * \todo take in account higher order geometry</span></div>
<div class="line"><span class="comment"> * \todo code panellisation, works serial only</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Exaltation</span></div>
<div class="line"><span class="comment"> * \f[</span></div>
<div class="line"><span class="comment"> *  v_i = (p_{i+1} - p_{i-1}) / (2 \delta t) \\</span></div>
<div class="line"><span class="comment"> *  (p_{i-1} - 2 p_i + p_{i+1}) / \delta t^2 = \frac{q}{m} v_i \times B_i \\</span></div>
<div class="line"><span class="comment"> *  (p_{i-1} - 2 p_i + p_{i+1}) / \delta t^2 = \frac{q}{m} (p_{i+1} - p_{i-1}) /</span></div>
<div class="line"><span class="comment"> * (2 \delta t)  \times B_i \\</span></div>
<div class="line"><span class="comment"> *  (p_{i-1} - 2 p_i + p_{i+1}) / \delta t = \frac{q}{m} (p_{i+1} - p_{i-1})</span></div>
<div class="line"><span class="comment"> * \times B_i / 2  \\</span></div>
<div class="line"><span class="comment"> *  p_{i+1} / \delta t - p_{i+1} \times B_i / 2= (2 p_i - p_{i-1}) / \delta t -</span></div>
<div class="line"><span class="comment"> * p_{i-1} \times B_i / 2 \\ p_{i+1} (\mathbf{1} / \delta t - \frac{q}{m}</span></div>
<div class="line"><span class="comment"> * \mathbf{1} \times B_i / 2 )= (2 p_i - p_{i-1}) / \delta t - \frac{q}{m}</span></div>
<div class="line"><span class="comment"> * p_{i-1} \times B_i / 2 \f]</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \ingroup maxwell_element</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a id="a0" name="a0"></a><a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a1" name="a1"></a><a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line">  <a id="a2" name="a2"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, (<span class="keywordtype">char</span> *)0, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">    moab::Core mb_instance;</div>
<div class="line">    moab::Interface &amp;moab = mb_instance;</div>
<div class="line"> </div>
<div class="line">    ParallelComm *pcomm = ParallelComm::get_pcomm(&amp;moab, <a id="a3" name="a3"></a><a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <span class="keyword">auto</span> moab_comm_wrap =</div>
<div class="line">        boost::make_shared&lt;WrapMPIComm&gt;(PETSC_COMM_WORLD, <span class="keyword">false</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (pcomm == NULL)</div>
<div class="line">      pcomm =</div>
<div class="line">          <span class="keyword">new</span> ParallelComm(&amp;moab, moab_comm_wrap-&gt;get_comm());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Read parameters from line command</span></div>
<div class="line">    PetscBool flg_file;</div>
<div class="line">    <span class="keywordtype">char</span> <a id="a4" name="a4"></a><a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>[255];</div>
<div class="line">    <a id="a5" name="a5"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Lorenz force configure&quot;</span>,</div>
<div class="line">                             <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsString(<span class="stringliteral">&quot;-my_file&quot;</span>, <span class="stringliteral">&quot;mesh file name&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;solution.h5m&quot;</span>,</div>
<div class="line">                              <a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 255, &amp;flg_file);</div>
<div class="line">    <a id="a6" name="a6"></a><a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a> = PetscOptionsEnd();</div>
<div class="line">    <a id="a7" name="a7"></a><a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">char</span> *option;</div>
<div class="line">    option = <span class="stringliteral">&quot;&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.load_file(<a class="code hl_variable" href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a>, 0, option);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Create mofem interface</span></div>
<div class="line">    <a id="_a8" name="_a8"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);</div>
<div class="line">    <a id="_a9" name="_a9"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = core;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a10" name="a10"></a><a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a11" name="a11"></a><a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a12" name="a12"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(BitRefLevel().set(0));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set up DM</span></div>
<div class="line">    DM dm;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMRegister_MoFEM(<span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(PETSC_COMM_WORLD, &amp;dm);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(dm, <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMCreateMoFEM(dm, &amp;m_field, <span class="stringliteral">&quot;MAGNETIC_PROBLEM&quot;</span>,</div>
<div class="line">                              BitRefLevel().set(0));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetFromOptions(dm);</div>
<div class="line">    <span class="comment">// add elements to blockData.dM</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMAddElement(dm, <span class="stringliteral">&quot;MAGNETIC&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(dm);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a id="_a13" name="_a13"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core.html">VolEle</a> = VolumeElementForcesAndSourcesCore;</div>
<div class="line">    <span class="keyword">using </span><a id="_a14" name="_a14"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolOp</a> = VolumeElementForcesAndSourcesCore::UserDataOperator;</div>
<div class="line">    <span class="comment">// using SetPtsData = FieldEvaluatorInterface::SetPtsData;</span></div>
<div class="line">    <span class="comment">// using SetPts = FieldEvaluatorInterface::SetPts;</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * @brief Only for debuging</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keyword">struct </span>MyOpDebug : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">VolOp</a> {</div>
<div class="line"> </div>
<div class="line">      boost::shared_ptr&lt;MatrixDouble&gt; <a id="a15" name="a15"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_petsc_data.html#ac67b1f883f5f72ae1419de10ab08e8a1">B</a>;</div>
<div class="line">      MyOpDebug(<span class="keyword">decltype</span>(<a id="_a16" name="_a16"></a><a class="code hl_class" href="class_b.html">B</a>) b) : <a id="a17" name="a17"></a><a class="code hl_typedef" href="test__cache__on__entities_8cpp.html#a13fc17754645553e99693475b0f5c454">VolOp</a>(<span class="stringliteral">&quot;MAGNETIC_POTENTIAL&quot;</span>, OPROW), <a class="code hl_variable" href="struct_mo_f_e_m_1_1_petsc_data.html#ac67b1f883f5f72ae1419de10ab08e8a1">B</a>(b) {}</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a18" name="a18"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_data_operator.html#a19219f04bba3938fd893898f128dcfb2">doWork</a>(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line">                            <a id="_a19" name="_a19"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">        <a id="a20" name="a20"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordflow">if</span> (type == MBEDGE &amp;&amp; side == 0) {</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;found &quot;</span> &lt;&lt; (*B) &lt;&lt; endl;</div>
<div class="line">          std::cout &lt;&lt; <span class="stringliteral">&quot;data &quot;</span> &lt;&lt; data.<a id="a21" name="a21"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6fb60e6aba0a189316962e4e96bce5e4">getFieldData</a>() &lt;&lt; endl;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a id="a22" name="a22"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> dist = 1e-12;             <span class="comment">// Distance for tree search</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_random_points = 5000;     <span class="comment">// number of points</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_steps = 10000;            <span class="comment">// number of time steps</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> mod_step = 10;               <span class="comment">// save every step</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> <a id="a23" name="a23"></a><a class="code hl_variable" href="heat__method_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = 1e-5;                <span class="comment">// Time step size</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> velocity_scale = 0.1;     <span class="comment">// scale velocity vector</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> magnetic_field_scale = 1; <span class="comment">// scale magnetic field vector</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> scale_box = 0.5; <span class="comment">// scale box where partices are placed</span></div>
<div class="line"> </div>
<div class="line">    <a id="_a24" name="_a24"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_field_evaluator_interface.html">FieldEvaluatorInterface</a> *field_eval_ptr;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a25" name="a25"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>(field_eval_ptr);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Get access to data</span></div>
<div class="line">    <span class="keyword">auto</span> data_at_pts = field_eval_ptr-&gt;<a id="a26" name="a26"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_field_evaluator_interface.html#a9c7bd881921f817f19a42bfd24d8762c">getData</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core.html">VolEle</a>&gt;();</div>
<div class="line">    <span class="keyword">auto</span> vol_ele = data_at_pts-&gt;feMethodPtr.lock();</div>
<div class="line">    <span class="keywordflow">if</span> (!vol_ele)</div>
<div class="line">      SETERRQ(PETSC_COMM_SELF, <a id="a27" name="a27"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Pointer to element does not exists&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> <a id="a28" name="a28"></a><a class="code hl_variable" href="field__evaluator_8cpp.html#a676b7630fd9162ef69c3edf6e300c38e">get_rule</a> = [&amp;](<span class="keywordtype">int</span> order_row, <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data) {</div>
<div class="line">      <span class="keywordflow">return</span> -1;</div>
<div class="line">    };</div>
<div class="line">    vol_ele-&gt;<a id="a29" name="a29"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#af171faae74e7347c83067c39dfcdca63">getRuleHook</a> = <a class="code hl_variable" href="field__evaluator_8cpp.html#a676b7630fd9162ef69c3edf6e300c38e">get_rule</a>;</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;MatrixDouble&gt; <a class="code hl_class" href="class_b.html">B</a>(<span class="keyword">new</span> MatrixDouble());</div>
<div class="line">    vol_ele-&gt;<a id="a30" name="a30"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">getOpPtrVector</a>().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a31" name="_a31"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_hcurl_vector_curl.html">OpCalculateHcurlVectorCurl&lt;3, 3&gt;</a>(<span class="stringliteral">&quot;MAGNETIC_POTENTIAL&quot;</span>, <a class="code hl_class" href="class_b.html">B</a>));</div>
<div class="line">    <span class="comment">// vol_ele-&gt;getOpPtrVector().push_back(new MyOpDebug(B));</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <a id="_a32" name="_a32"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_problem.html">MoFEM::Problem</a> *prb_ptr;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMMoFEMGetProblemPtr(dm, &amp;prb_ptr);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> field_eval_ptr-&gt;<a id="a33" name="a33"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_field_evaluator_interface.html#a096aea3206927ec1b6885c4bbb736822">buildTree3D</a>(data_at_pts, <span class="stringliteral">&quot;MAGNETIC&quot;</span>);</div>
<div class="line">    BoundBox box;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> data_at_pts-&gt;treePtr-&gt;get_bounding_box(box);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> bMin = box.bMin[0];</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">double</span> bMax = box.bMax[0];</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_vertices = [nb_random_points, bMin, bMax,</div>
<div class="line">                            scale_box](moab::Interface &amp;moab, <span class="keyword">auto</span> &amp;verts,</div>
<div class="line">                                       <span class="keyword">auto</span> &amp;arrays_coord) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      ReadUtilIface *iface;</div>
<div class="line">      <a id="_a34" name="_a34"></a><a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> startv;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.query_interface(iface);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> iface-&gt;get_node_coords(3, nb_random_points, 0, startv,</div>
<div class="line">                                    arrays_coord);</div>
<div class="line">      <a id="_a35" name="_a35"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; t_coords = {</div>
<div class="line">          arrays_coord[0], arrays_coord[1], arrays_coord[2]};</div>
<div class="line">      <a id="_a36" name="_a36"></a><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a id="a37" name="a37"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      verts = <a id="_a38" name="_a38"></a><a class="code hl_class" href="class_range.html">Range</a>(startv, startv + nb_random_points - 1);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a id="a39" name="a39"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 0; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> != nb_random_points; ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) {</div>
<div class="line">        t_coords(0) = 0;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {1, 2}) {</div>
<div class="line">          t_coords(ii) = scale_box * (bMax - bMin) *</div>
<div class="line">                             (std::rand() / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(RAND_MAX)) -</div>
<div class="line">                         bMax * scale_box;</div>
<div class="line">        }</div>
<div class="line">        ++t_coords;</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_positions = [nb_random_points, <a class="code hl_variable" href="heat__method_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>, velocity_scale](</div>
<div class="line">                             moab::Interface &amp;moab, <span class="keyword">auto</span> &amp;arrays_coord) {</div>
<div class="line">      MatrixDouble init_pos(3, nb_random_points);</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; t_coords = {</div>
<div class="line">          arrays_coord[0], arrays_coord[1], arrays_coord[2]};</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt; t_init_coords = {</div>
<div class="line">          &amp;init_pos(0, 0), &amp;init_pos(1, 0), &amp;init_pos(2, 0)};</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 0; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> != nb_random_points; ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) {</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_velocity;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {0, 1, 2})</div>
<div class="line">          t_velocity(ii) = (rand() / <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(RAND_MAX) - 0.5);</div>
<div class="line">        t_velocity(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) /= std::sqrt(t_velocity(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_velocity(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">        t_init_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + <a class="code hl_variable" href="heat__method_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> * velocity_scale * t_velocity(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">        ++t_coords;</div>
<div class="line">        ++t_init_coords;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> init_pos;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    moab::Core mb_charged_partices;</div>
<div class="line">    moab::Interface &amp;moab_charged_partices = mb_charged_partices;</div>
<div class="line">    vector&lt;double *&gt; arrays_coord;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> verts;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> create_vertices(moab_charged_partices, verts, arrays_coord);</div>
<div class="line">    <span class="keyword">auto</span> init_positions = set_positions(moab, arrays_coord);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_t_coords = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt;(</div>
<div class="line">          arrays_coord[0], arrays_coord[1], arrays_coord[2]);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_t_init_coords = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 1&gt;</a>, 3&gt;(</div>
<div class="line">          &amp;init_positions(0, 0), &amp;init_positions(1, 0), &amp;init_positions(2, 0));</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> calc_rhs = [&amp;](<span class="keyword">auto</span> &amp;t_p, <span class="keyword">auto</span> &amp;t_init_p, <span class="keyword">auto</span> &amp;t_B) {</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_rhs;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a id="a40" name="a40"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a id="a41" name="a41"></a><a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">      t_rhs(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = (2 * t_p(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) - t_init_p(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>)) / <a class="code hl_variable" href="heat__method_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> -</div>
<div class="line">                 levi_civita(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_init_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_B(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      <span class="keywordflow">return</span> t_rhs;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> calc_lhs = [&amp;](<span class="keyword">auto</span> &amp;t_B) {</div>
<div class="line">      <a id="_a42" name="_a42"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_lhs;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line">      t_lhs(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) = levi_civita(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * (-t_B(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>));</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {0, 1, 2})</div>
<div class="line">        t_lhs(ii, ii) += 1 / <a class="code hl_variable" href="heat__method_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line">      <span class="keywordflow">return</span> t_lhs;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// auto set_periodicity = [&amp;](auto &amp;t_p, auto &amp;t_init_p) {</span></div>
<div class="line">    <span class="comment">//   for (int i : {0, 1, 2})</span></div>
<div class="line">    <span class="comment">//     if (t_p(i) &gt; bMax) {</span></div>
<div class="line">    <span class="comment">//       t_p(i) -= 2 * bMax;</span></div>
<div class="line">    <span class="comment">//       t_init_p(i) -= 2 * bMax;</span></div>
<div class="line">    <span class="comment">//     } else if (t_p(i) &lt; bMin) {</span></div>
<div class="line">    <span class="comment">//       t_p(i) -= 2 * bMin;</span></div>
<div class="line">    <span class="comment">//       t_init_p(i) -= 2 * bMin;</span></div>
<div class="line">    <span class="comment">//     }</span></div>
<div class="line">    <span class="comment">// };</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> is_out = [&amp;](<span class="keyword">auto</span> &amp;t_p) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> : {0, 1, 2})</div>
<div class="line">        <span class="keywordflow">if</span> (t_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) &gt; bMax) {</div>
<div class="line">          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (t_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) &lt; bMin) {</div>
<div class="line">          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> cache_ptr = boost::make_shared&lt;CacheTuple&gt;();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a id="a43" name="a43"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a3038cf62a8d74245c82ef2d0b35e8054">cache_problem_entities</a>(prb_ptr-&gt;<a id="a44" name="a44"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), cache_ptr);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> calc_position = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> t_p = get_t_coords();</div>
<div class="line">      <span class="keyword">auto</span> t_init_p = get_t_init_coords();</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, 3&gt; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, 3&gt; <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 0; <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> != nb_random_points; ++<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>) {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (is_out(t_p)) {</div>
<div class="line">          ++t_p;</div>
<div class="line">          ++t_init_p;</div>
<div class="line">          <span class="keywordflow">continue</span>;</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        std::array&lt;double, 3&gt; point = {t_p(0), t_p(1), t_p(2)};</div>
<div class="line">        data_at_pts-&gt;setEvalPoints(point.data(), 1);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> field_eval_ptr-&gt;<a id="a45" name="a45"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_field_evaluator_interface.html#acd55ee4517f56af70b0b92cae6059f30">evalFEAtThePoint3D</a>(</div>
<div class="line">            point.data(), dist, prb_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_problem.html#ac27123017bcc40cd4259e674a7318b3c">getName</a>(), <span class="stringliteral">&quot;MAGNETIC&quot;</span>, data_at_pts,</div>
<div class="line">            m_field.<a id="a46" name="a46"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>(), m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>(), cache_ptr,</div>
<div class="line">            <a id="a47" name="a47"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a4f6e3b96dbc5db09c3281b676d448b7f">MF_EXIST</a>, <a id="a48" name="a48"></a><a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_B;</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_class" href="class_b.html">B</a>-&gt;size2())</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii : {0, 1, 2})</div>
<div class="line">            t_B(ii) = (*B)(ii, 0);</div>
<div class="line">        <span class="keywordflow">else</span></div>
<div class="line">          t_B(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = 0;</div>
<div class="line"> </div>
<div class="line">        t_B(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= magnetic_field_scale * 0.5;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> t_rhs = calc_rhs(t_p, t_init_p, t_B);</div>
<div class="line">        <span class="keyword">auto</span> t_lhs = calc_lhs(t_B);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordtype">double</span> det;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> determinantTensor3by3(t_lhs, det);</div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;double, 3, 3&gt;</a> t_inv_lhs;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> invertTensor3by3(t_lhs, det, t_inv_lhs);</div>
<div class="line"> </div>
<div class="line">        t_init_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">        t_p(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_inv_lhs(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_rhs(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// set_periodicity(t_p, t_init_p);</span></div>
<div class="line"> </div>
<div class="line">        ++t_p;</div>
<div class="line">        ++t_init_p;</div>
<div class="line">      }</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a id="a49" name="a49"></a><a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> = 0; <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> != nb_steps; ++<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>) {</div>
<div class="line"> </div>
<div class="line">      std::string print_step =</div>
<div class="line">          <span class="stringliteral">&quot;Step : &quot;</span> + boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>) + <span class="stringliteral">&quot;\r&quot;</span>;</div>
<div class="line">      std::cout &lt;&lt; print_step &lt;&lt; std::flush;</div>
<div class="line"> </div>
<div class="line">      calc_position();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> ((<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> % mod_step) == 0) {</div>
<div class="line">        <span class="comment">// write points</span></div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_charged_partices.write_file(</div>
<div class="line">            (<span class="stringliteral">&quot;step_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> / mod_step) + <span class="stringliteral">&quot;.vtk&quot;</span>)</div>
<div class="line">                .c_str(),</div>
<div class="line">            <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    std::cout &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMDestroy(&amp;dm);</div>
<div class="line">  }</div>
<div class="line">  <a id="a50" name="a50"></a><a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a id="a51" name="a51"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="abase__functions_8c_html_a56d2889a19d8d7affaa85cfca4aadd67"><div class="ttname"><a href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a></div><div class="ttdeci">static PetscErrorCode ierr</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00013">base_functions.c:13</a></div></div>
<div class="ttc" id="aclass_b_html"><div class="ttname"><a href="class_b.html">B</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a4f6e3b96dbc5db09c3281b676d448b7f"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a4f6e3b96dbc5db09c3281b676d448b7f">MF_EXIST</a></div><div class="ttdeci">@ MF_EXIST</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00113">definitions.h:113</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00496">definitions.h:496</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="afield__evaluator_8cpp_html_a676b7630fd9162ef69c3edf6e300c38e"><div class="ttname"><a href="field__evaluator_8cpp.html#a676b7630fd9162ef69c3edf6e300c38e">get_rule</a></div><div class="ttdeci">auto get_rule</div><div class="ttdef"><b>Definition</b> <a href="field__evaluator_8cpp_source.html#l00073">field_evaluator.cpp:73</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="aheat__method_8cpp_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="heat__method_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition</b> <a href="heat__method_8cpp_source.html#l00026">heat_method.cpp:26</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="amesh__smoothing_8cpp_html_ae20b66af13b03d8e8a4593186c23cd07"><div class="ttname"><a href="mesh__smoothing_8cpp.html#ae20b66af13b03d8e8a4593186c23cd07">mesh_file_name</a></div><div class="ttdeci">char mesh_file_name[255]</div><div class="ttdef"><b>Definition</b> <a href="mesh__smoothing_8cpp_source.html#l00022">mesh_smoothing.cpp:22</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition</b> <a href="plate_8cpp_source.html#l00058">plate.cpp:58</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a3038cf62a8d74245c82ef2d0b35e8054"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a3038cf62a8d74245c82ef2d0b35e8054">MoFEM::CoreInterface::cache_problem_entities</a></div><div class="ttdeci">virtual MoFEMErrorCode cache_problem_entities(const std::string prb_name, CacheTupleWeakPtr cache_ptr)=0</div><div class="ttdoc">Cache variables.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_data_operator_html_a19219f04bba3938fd893898f128dcfb2"><div class="ttname"><a href="struct_mo_f_e_m_1_1_data_operator.html#a19219f04bba3938fd893898f128dcfb2">MoFEM::DataOperator::doWork</a></div><div class="ttdeci">virtual MoFEMErrorCode doWork(int row_side, int col_side, EntityType row_type, EntityType col_type, EntitiesFieldData::EntData &amp;row_data, EntitiesFieldData::EntData &amp;col_data)</div><div class="ttdoc">Operator for bi-linear form, usually to calculate values on left hand side.</div><div class="ttdef"><b>Definition</b> <a href="_data_operators_8hpp_source.html#l00040">DataOperators.hpp:40</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html_a6fb60e6aba0a189316962e4e96bce5e4"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html#a6fb60e6aba0a189316962e4e96bce5e4">MoFEM::EntitiesFieldData::EntData::getFieldData</a></div><div class="ttdeci">const VectorDouble &amp; getFieldData() const</div><div class="ttdoc">get dofs values</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l01254">EntitiesFieldData.hpp:1254</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_field_evaluator_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_field_evaluator_interface.html">MoFEM::FieldEvaluatorInterface</a></div><div class="ttdoc">Field evaluator interface.</div><div class="ttdef"><b>Definition</b> <a href="_field_evaluator_8hpp_source.html#l00021">FieldEvaluator.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_field_evaluator_interface_html_a096aea3206927ec1b6885c4bbb736822"><div class="ttname"><a href="struct_mo_f_e_m_1_1_field_evaluator_interface.html#a096aea3206927ec1b6885c4bbb736822">MoFEM::FieldEvaluatorInterface::buildTree3D</a></div><div class="ttdeci">MoFEMErrorCode buildTree3D(boost::shared_ptr&lt; SetPtsData &gt; spd_ptr, const std::string finite_element)</div><div class="ttdoc">Build spatial tree.</div><div class="ttdef"><b>Definition</b> <a href="_field_evaluator_8cpp_source.html#l00057">FieldEvaluator.cpp:57</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_field_evaluator_interface_html_a9c7bd881921f817f19a42bfd24d8762c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_field_evaluator_interface.html#a9c7bd881921f817f19a42bfd24d8762c">MoFEM::FieldEvaluatorInterface::getData</a></div><div class="ttdeci">boost::shared_ptr&lt; SPD &gt; getData(const double *ptr=nullptr, const int nb_eval_points=0, const double eps=1e-12, VERBOSITY_LEVELS verb=QUIET)</div><div class="ttdoc">Get the Data object.</div><div class="ttdef"><b>Definition</b> <a href="_field_evaluator_8hpp_source.html#l00107">FieldEvaluator.hpp:107</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_field_evaluator_interface_html_acd55ee4517f56af70b0b92cae6059f30"><div class="ttname"><a href="struct_mo_f_e_m_1_1_field_evaluator_interface.html#acd55ee4517f56af70b0b92cae6059f30">MoFEM::FieldEvaluatorInterface::evalFEAtThePoint3D</a></div><div class="ttdeci">MoFEMErrorCode evalFEAtThePoint3D(const double *const point, const double distance, const std::string problem, const std::string finite_element, boost::shared_ptr&lt; SetPtsData &gt; data_ptr, int lower_rank, int upper_rank, boost::shared_ptr&lt; CacheTuple &gt; cache_ptr, MoFEMTypes bh=MF_EXIST, VERBOSITY_LEVELS verb=QUIET)</div><div class="ttdoc">Evaluate field at artbitray position.</div><div class="ttdef"><b>Definition</b> <a href="_field_evaluator_8cpp_source.html#l00364">FieldEvaluator.cpp:364</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_html_aba236b9f5892be49d6ae6756b12f5a88"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#aba236b9f5892be49d6ae6756b12f5a88">MoFEM::ForcesAndSourcesCore::getOpPtrVector</a></div><div class="ttdeci">boost::ptr_deque&lt; UserDataOperator &gt; &amp; getOpPtrVector()</div><div class="ttdoc">Use to push back operator for row operator.</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l00083">ForcesAndSourcesCore.hpp:83</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_html_af171faae74e7347c83067c39dfcdca63"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#af171faae74e7347c83067c39dfcdca63">MoFEM::ForcesAndSourcesCore::getRuleHook</a></div><div class="ttdeci">RuleHookFun getRuleHook</div><div class="ttdoc">Hook to get rule.</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l00042">ForcesAndSourcesCore.hpp:42</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_hcurl_vector_curl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_hcurl_vector_curl.html">MoFEM::OpCalculateHcurlVectorCurl</a></div><div class="ttdoc">Calculate curl of vector field.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l02544">UserDataOperators.hpp:2544</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_petsc_data_html_ac67b1f883f5f72ae1419de10ab08e8a1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_petsc_data.html#ac67b1f883f5f72ae1419de10ab08e8a1">MoFEM::PetscData::B</a></div><div class="ttdeci">Mat B</div><div class="ttdef"><b>Definition</b> <a href="_loop_methods_8hpp_source.html#l00052">LoopMethods.hpp:52</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html">MoFEM::Problem</a></div><div class="ttdoc">keeps basic data about problem</div><div class="ttdef"><b>Definition</b> <a href="_problems_multi_indices_8hpp_source.html#l00054">ProblemsMultiIndices.hpp:54</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problem_html_ac27123017bcc40cd4259e674a7318b3c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problem.html#ac27123017bcc40cd4259e674a7318b3c">MoFEM::Problem::getName</a></div><div class="ttdeci">auto getName() const</div><div class="ttdef"><b>Definition</b> <a href="_problems_multi_indices_8hpp_source.html#l00372">ProblemsMultiIndices.hpp:372</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_1_1_user_data_operator.html">MoFEM::VolumeElementForcesAndSourcesCore::UserDataOperator</a></div><div class="ttdef"><b>Definition</b> <a href="_volume_element_forces_and_sources_core_8hpp_source.html#l00109">VolumeElementForcesAndSourcesCore.hpp:110</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_volume_element_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_volume_element_forces_and_sources_core.html">MoFEM::VolumeElementForcesAndSourcesCore</a></div><div class="ttdoc">Volume finite element base.</div><div class="ttdef"><b>Definition</b> <a href="_volume_element_forces_and_sources_core_8hpp_source.html#l00026">VolumeElementForcesAndSourcesCore.hpp:26</a></div></div>
<div class="ttc" id="atest__cache__on__entities_8cpp_html_a13fc17754645553e99693475b0f5c454"><div class="ttname"><a href="test__cache__on__entities_8cpp.html#a13fc17754645553e99693475b0f5c454">VolOp</a></div><div class="ttdeci">VolEle::UserDataOperator VolOp</div><div class="ttdef"><b>Definition</b> <a href="test__cache__on__entities_8cpp_source.html#l00023">test_cache_on_entities.cpp:23</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
