<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: free_surface.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">free_surface.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>Using PipelineManager interface calculate the divergence of base functions, and integral of flux on the boundary. Since the h-div space is used, volume integral and boundary integral should give the same result.</p>
<p>Implementation based on <a class="el" href="citelist.html#CITEREF_lovric2019-qn">[48]</a></p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file free_surface.cpp</span></div>
<div class="line"><span class="comment"> * \example free_surface.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Using PipelineManager interface calculate the divergence of base functions,</span></div>
<div class="line"><span class="comment"> * and integral of flux on the boundary. Since the h-div space is used, volume</span></div>
<div class="line"><span class="comment"> * integral and boundary integral should give the same result.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Implementation based on \cite Lovric2019-qn</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;petsc/private/petscimpl.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keywordtype">char</span> <a id="a0" name="a0"></a><a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>[] = <span class="stringliteral">&quot;...\n\n&quot;</span>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#undef PYTHON_INIT_SURFACE</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_INIT_SURFACE</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/python/def.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>bp = boost::python;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SurfacePython {</div>
<div class="line">  SurfacePython() = <span class="keywordflow">default</span>;</div>
<div class="line">  <span class="keyword">virtual</span> ~SurfacePython() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> surfaceInit(<span class="keyword">const</span> std::string py_file) {</div>
<div class="line">    <a id="a1" name="a1"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// create main module</span></div>
<div class="line">      <span class="keyword">auto</span> main_module = bp::import(<span class="stringliteral">&quot;__main__&quot;</span>);</div>
<div class="line">      mainNamespace = main_module.attr(<span class="stringliteral">&quot;__dict__&quot;</span>);</div>
<div class="line">      bp::exec_file(py_file.c_str(), mainNamespace, mainNamespace);</div>
<div class="line">      <span class="comment">// create a reference to python function</span></div>
<div class="line">      surfaceFun = mainNamespace[<span class="stringliteral">&quot;surface&quot;</span>];</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (bp::error_already_set <span class="keyword">const</span> &amp;) {</div>
<div class="line">      <span class="comment">// print all other errors to stderr</span></div>
<div class="line">      PyErr_Print();</div>
<div class="line">      <a id="a2" name="a2"></a><a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a3" name="a3"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;Python error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a id="a4" name="a4"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> evalSurface(</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z, <span class="keywordtype">double</span> <a id="a5" name="a5"></a><a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>, <span class="keywordtype">double</span> &amp;s</div>
<div class="line"> </div>
<div class="line">  ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">try</span> {</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// call python function</span></div>
<div class="line">      s = bp::extract&lt;double&gt;(surfaceFun(x, y, z, <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>));</div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">catch</span> (bp::error_already_set <span class="keyword">const</span> &amp;) {</div>
<div class="line">      <span class="comment">// print all other errors to stderr</span></div>
<div class="line">      PyErr_Print();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a>, <span class="stringliteral">&quot;Python error&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  bp::object mainNamespace;</div>
<div class="line">  bp::object surfaceFun;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> boost::weak_ptr&lt;SurfacePython&gt; surfacePythonWeakPtr;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a6" name="a6"></a><a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a2b858ab7cb6771654cc5c6c1e5267677">coord_type</a> = EXECUTABLE_COORD_TYPE;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a id="a7" name="a7"></a><a class="code hl_variable" href="dg__projection_8cpp.html#a87778f5f0ec7eba11e8f327af2258018">BASE_DIM</a> = 1;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a id="a8" name="a8"></a><a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> = 2;</div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a id="a9" name="a9"></a><a class="code hl_variable" href="free__surface_8cpp.html#a141ea5cd379b49e5fa78f0dd95c7a635">U_FIELD_DIM</a> = <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="group__mofem__forms.html#gabb82cd10e89a1d4d25fa7756360b181b">AssemblyType</a> A = AssemblyType::PETSC; <span class="comment">//&lt; selected assembly type</span></div>
<div class="line"><span class="keyword">constexpr</span> <a class="code hl_enumeration" href="group__mofem__forms.html#ga2136fdd1cb130ca18f645e799b05569f">IntegrationType</a> <a id="a10" name="a10"></a><a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a> =</div>
<div class="line">    IntegrationType::GAUSS;                     <span class="comment">//&lt; selected integration type</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;<span class="keywordtype">int</span> DIM&gt;</div>
<div class="line"><span class="keyword">using </span><a id="_a11" name="_a11"></a><a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps</a> = <a id="_a12" name="_a12"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#ac94bc5f632538c35d02cd487d55b31d2">DomainEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::DomainEle</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="level__set_8cpp.html#abd3c08a89738e1bb4365d3fcd72e8c7e">DomianParentEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::DomianParentEle</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a13" name="_a13"></a><a class="code hl_class" href="class_domain_ele_op.html">DomainEleOp</a> = DomainEle::UserDataOperator;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::BoundaryParentEle</a>;</div>
<div class="line"><span class="keyword">using </span><a id="_a14" name="_a14"></a><a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code hl_struct" href="struct_elements_and_ops.html">ElementsAndOps&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#ad3cb845283ccc6b6bfcedf2cd798c923">SideOp</a> = SideEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="dynamic__first__order__con__law_8cpp.html#a06a735b6649ab72b1c55b0c3e4ace878">PostProcEleDomain</a> = <a id="_a15" name="_a15"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab.html">PostProcBrokenMeshInMoab&lt;DomainEle&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a3dee636d734a20d33cf10323c629d5da">PostProcEleDomainCont</a> = <a id="_a16" name="_a16"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_cont_impl.html">PostProcBrokenMeshInMoabBaseCont&lt;DomainEle&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a628a79e931efe5e92813c2557088ee00">PostProcEleBdyCont</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_cont_impl.html">PostProcBrokenMeshInMoabBaseCont&lt;BoundaryEle&gt;</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a id="_a17" name="_a17"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="tensor__divergence__operator_8cpp.html#a614aff059c889b5343fba0aaadecebb4">AssemblyDomainEleOp</a> = <a id="_a18" name="_a18"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;A&gt;<a id="a19" name="a19"></a><a class="code hl_typedef" href="radiation_8cpp.html#a62d290f01cfc65a09faa805099b2e06f">::OpBase</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="tensor__divergence__operator_8cpp.html#a328c51ff3e09057f317d8821c4b80f91">AssemblyBoundaryEleOp</a> =</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;A&gt;<a class="code hl_typedef" href="radiation_8cpp.html#a62d290f01cfc65a09faa805099b2e06f">::OpBase</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a05fa1e48e6fb969147b13b55dacbd2e9">OpDomainMassU</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;A&gt;<a id="_a20" name="_a20"></a><a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm</a>&lt;</div>
<div class="line">    <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>&gt;<a class="code hl_typedef" href="seepage_8cpp.html#a7870ef6bf83f42149a763635e1bb4c8c">::OpMass&lt;BASE_DIM, U_FIELD_DIM&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#ab42544325abba8cc4ec2b39dbb701302">OpDomainMassH</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;A&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm</a>&lt;</div>
<div class="line">    <a class="code hl_variable" href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a>&gt;<a class="code hl_typedef" href="seepage_8cpp.html#a7870ef6bf83f42149a763635e1bb4c8c">::OpMass&lt;BASE_DIM, 1&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a7a097aeb92b0e72fbe9058279b42aee2">OpDomainMassP</a> = <a id="a21" name="a21"></a><a class="code hl_typedef" href="free__surface_8cpp.html#ab42544325abba8cc4ec2b39dbb701302">OpDomainMassH</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a4684744887622bc40ac4d5def27344e2">OpDomainMassG</a> = <a class="code hl_typedef" href="free__surface_8cpp.html#ab42544325abba8cc4ec2b39dbb701302">OpDomainMassH</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a271f46dff095cfa001adf659298f195d">OpBoundaryMassL</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    A&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm&lt;I&gt;::OpMass</a>&lt;<a class="code hl_variable" href="dg__projection_8cpp.html#a87778f5f0ec7eba11e8f327af2258018">BASE_DIM</a>, 1&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a4c51e25ae2f4a6111d2538d87ea73c58">OpDomainAssembleVector</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    A&gt;<a id="_a22" name="_a22"></a><a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;I&gt;::OpBaseTimesVector</a>&lt;<a class="code hl_variable" href="dg__projection_8cpp.html#a87778f5f0ec7eba11e8f327af2258018">BASE_DIM</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, 1&gt;;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    A&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;I&gt;::OpBaseTimesScalar</a>&lt;<a class="code hl_variable" href="dg__projection_8cpp.html#a87778f5f0ec7eba11e8f327af2258018">BASE_DIM</a>&gt;;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#aedc6e3cd14a21843cb47a0cb3975f4a2">OpBoundaryAssembleScalar</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BoundaryEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    A&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;I&gt;::OpBaseTimesScalar</a>&lt;<a class="code hl_variable" href="dg__projection_8cpp.html#a87778f5f0ec7eba11e8f327af2258018">BASE_DIM</a>&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">template</span> &lt;CoordinateTypes COORD_TYPE&gt;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#a83ec90365447ce19c2bc90892eef8e3d">OpMixScalarTimesDiv</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;DomainEleOp&gt;::Assembly</a>&lt;</div>
<div class="line">    A&gt;<a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm&lt;I&gt;::OpMixScalarTimesDiv</a>&lt;<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a23" name="a23"></a><a class="code hl_variable" href="tensor__divergence__operator_8cpp.html#afa76c795f8d0a75dfa200089923c7cb6">COORD_TYPE</a>&gt;;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Flux is applied by Lagrange Multiplie</span></div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="thermo__elastic_8cpp.html#af2f99d568add28fdf16023f29fb8ef02">BoundaryNaturalBC</a> = <a id="_a24" name="_a24"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly.html">NaturalBC&lt;BoundaryEleOp&gt;::Assembly</a>&lt;A&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm&lt;I&gt;</a>;</div>
<div class="line"><span class="keyword">using </span><a class="code hl_typedef" href="free__surface_8cpp.html#af3610ce2daf6b1fafd490a37f3d43135">OpFluidFlux</a> =</div>
<div class="line">    BoundaryNaturalBC::OpFlux&lt;NaturalMeshsetType&lt;BLOCKSET&gt;, 1, 1&gt;;</div>
<div class="line"> </div>
<div class="line"><a id="_a25" name="_a25"></a><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;i&#39;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; <a id="a26" name="a26"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>;</div>
<div class="line"><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;j&#39;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; <a id="a27" name="a27"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>;</div>
<div class="line"><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;k&#39;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; <a id="a28" name="a28"></a><a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>;</div>
<div class="line"><a class="code hl_class" href="class_f_tensor_1_1_index.html">FTensor::Index</a>&lt;<span class="charliteral">&#39;l&#39;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; <a id="a29" name="a29"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keyword">auto</span> <a id="a30" name="a30"></a><a class="code hl_variable" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a> = <a id="_a31" name="_a31"></a><a class="code hl_class" href="class_f_tensor_1_1_kronecker___delta__symmetric.html">FTensor::Kronecker_Delta_symmetric&lt;int&gt;</a>();</div>
<div class="line"> </div>
<div class="line"><span class="comment">// mesh refinement</span></div>
<div class="line"><span class="keywordtype">int</span> <a id="a32" name="a32"></a><a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = 3;          <span class="comment">///&lt; approximation order</span></div>
<div class="line"><span class="keywordtype">int</span> <a id="a33" name="a33"></a><a class="code hl_variable" href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a> = 4;      <span class="comment">//&lt; number of refinement levels</span></div>
<div class="line"><span class="keywordtype">int</span> <a id="a34" name="a34"></a><a class="code hl_variable" href="free__surface_8cpp.html#ab9ee1c6b1a408c8680179d21cd3ec51f">refine_overlap</a> = 4; <span class="comment">//&lt; mesh overlap while refine</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a id="a35" name="a35"></a><a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a36" name="a36"></a><a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a> = []() {</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a> + 1;</div>
<div class="line">}; <span class="comment">//&lt; first refinement level for computational mesh</span></div>
<div class="line"><span class="keyword">auto</span> <a id="a37" name="a37"></a><a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a> = []() {</div>
<div class="line">  <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + 1;</div>
<div class="line">}; <span class="comment">///&lt; dofs bit used to do calculations</span></div>
<div class="line"><span class="keyword">auto</span> <a id="a38" name="a38"></a><a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a> = []() { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + 2; };</div>
<div class="line"><span class="keyword">auto</span> <a id="a39" name="a39"></a><a class="code hl_variable" href="free__surface_8cpp.html#ac6bfdcdc75a76c6e1aa9c176ab98d5ef">get_skin_child_bit</a> = []() { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + 3; };</div>
<div class="line"><span class="keyword">auto</span> <a id="a40" name="a40"></a><a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a> = []() { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + 4; };</div>
<div class="line"><span class="keyword">auto</span> <a id="a41" name="a41"></a><a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a> = []() { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + 5; };</div>
<div class="line"> </div>
<div class="line"><span class="comment">// FIXME: Set parameters from command line</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Physical parameters</span></div>
<div class="line"><span class="keywordtype">double</span> <a id="a42" name="a42"></a><a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> = 980;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a43" name="a43"></a><a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a> = 0.998;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a44" name="a44"></a><a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a> = 0.010101 * 1e2;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a45" name="a45"></a><a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a> = 0.0012;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a46" name="a46"></a><a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a> = 0.000182 * 1e2;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a47" name="a47"></a><a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> = 73; <span class="comment">///&lt; surface tension</span></div>
<div class="line"><span class="keywordtype">double</span> <a id="a48" name="a48"></a><a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a> = 0.25;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Model parameters</span></div>
<div class="line"><span class="keywordtype">double</span> <a id="a49" name="a49"></a><a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> = 0.03; <span class="comment">// mesh size</span></div>
<div class="line"><span class="keywordtype">double</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> = <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a50" name="a50"></a><a class="code hl_variable" href="free__surface_8cpp.html#a653c95bd340aa1fd18c34afdfdae7d13">eta2</a> = <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> * <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// Numerical parameters</span></div>
<div class="line"><span class="keywordtype">double</span> <a id="a51" name="a51"></a><a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> = 1e-2; <span class="comment">// mobility</span></div>
<div class="line"><span class="keywordtype">double</span> <a id="a52" name="a52"></a><a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> = 1e-12;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a53" name="a53"></a><a class="code hl_variable" href="mesh__smoothing_8cpp.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a> = std::numeric_limits&lt;float&gt;::epsilon();</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a id="a54" name="a54"></a><a class="code hl_variable" href="free__surface_8cpp.html#a5879ea15360d7f578572e5a7e760f777">rho_ave</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a> + <a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a>) / 2;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a55" name="a55"></a><a class="code hl_variable" href="free__surface_8cpp.html#a4ed33c41b617d287b500d415ef1063af">rho_diff</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a> - <a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a>) / 2;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a56" name="a56"></a><a class="code hl_variable" href="free__surface_8cpp.html#a974233f815d533deae50cb320c7439b3">mu_ave</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a> + <a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a>) / 2;</div>
<div class="line"><span class="keywordtype">double</span> <a id="a57" name="a57"></a><a class="code hl_variable" href="free__surface_8cpp.html#a0befd7944c7ed7e9373b2e2c2fb7d338">mu_diff</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a> - <a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a>) / 2;</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a id="a58" name="a58"></a><a class="code hl_variable" href="free__surface_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a> = (3. / (4. * std::sqrt(2. * <a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a>))) * (<a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> / <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>);</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a59" name="a59"></a><a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a> = [](int, int, int) { <span class="keywordflow">return</span> 2 * <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> + 1; };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a60" name="a60"></a><a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="incompressible__elasticity_8cpp.html#a2b858ab7cb6771654cc5c6c1e5267677">coord_type</a> == <a id="a61" name="a61"></a><a class="code hl_enumvalue" href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6a8bcf3ac927052dfa8318c1fb96c4ad10">CYLINDRICAL</a>)</div>
<div class="line">    <span class="keywordflow">return</span> 2 * M_PI * <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> 1.;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a62" name="a62"></a><a class="code hl_variable" href="free__surface_8cpp.html#ab9b6c8710e2076a5e271c60f0363aac9">wetting_angle_sub_stepping</a> = [](<span class="keyword">auto</span> ts_step) {</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> sub_stepping = 16;</div>
<div class="line">  <span class="keywordflow">return</span> std::min(1., <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(ts_step) / sub_stepping);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// cut off function</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a63" name="a63"></a><a class="code hl_variable" href="free__surface_8cpp.html#abe6104fc2964fbaa2958eff4563f35cf">my_max</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> x) { <span class="keywordflow">return</span> (x - 1 + std::abs(x + 1)) / 2; };</div>
<div class="line"><span class="keyword">auto</span> <a id="a64" name="a64"></a><a class="code hl_variable" href="free__surface_8cpp.html#afc5310bd26fb5327a0a65a4c85fcbfcf">my_min</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> x) { <span class="keywordflow">return</span> (x + 1 - std::abs(x - 1)) / 2; };</div>
<div class="line"><span class="keyword">auto</span> <a id="a65" name="a65"></a><a class="code hl_variable" href="free__surface_8cpp.html#ac52e9f0bda51760b1ff6367d5cdbe0a6">cut_off</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#abe6104fc2964fbaa2958eff4563f35cf">my_max</a>(<a class="code hl_variable" href="free__surface_8cpp.html#afc5310bd26fb5327a0a65a4c85fcbfcf">my_min</a>(<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>)); };</div>
<div class="line"><span class="keyword">auto</span> <a id="a66" name="a66"></a><a class="code hl_variable" href="free__surface_8cpp.html#afa9aacf64432582b849eabccf4e782c7">d_cut_off</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) {</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> &gt;= -1 &amp;&amp; <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> &lt; 1)</div>
<div class="line">    <span class="keywordflow">return</span> 1.;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> 0.;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a67" name="a67"></a><a class="code hl_variable" href="free__surface_8cpp.html#a985de4887e01f1dc8aba4e3e3eaab7f3">phase_function</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> diff, <span class="keyword">const</span> <span class="keywordtype">double</span> ave) {</div>
<div class="line">  <span class="keywordflow">return</span> diff * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> + ave;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a68" name="a68"></a><a class="code hl_variable" href="free__surface_8cpp.html#a527ea211a847e157b65b68f8c5e9c8e2">d_phase_function_h</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>, <span class="keyword">const</span> <span class="keywordtype">double</span> diff) {</div>
<div class="line">  <span class="keywordflow">return</span> diff;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// order function (free energy)</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a69" name="a69"></a><a class="code hl_variable" href="free__surface_8cpp.html#af28f2ebcea367853e11b662bfbc41b48">get_f</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> 4 * <a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a> * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * (<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> - 1); };</div>
<div class="line"><span class="keyword">auto</span> <a id="a70" name="a70"></a><a class="code hl_variable" href="free__surface_8cpp.html#a71a9f760a3ed38bc49a21637c6a734e1">get_f_dh</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> 4 * <a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a> * (3 * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> - 1); };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a71" name="a71"></a><a class="code hl_variable" href="free__surface_8cpp.html#a686d607908b00c0f7634206cb0fc3e08">get_M0</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a>; };</div>
<div class="line"><span class="keyword">auto</span> <a id="a72" name="a72"></a><a class="code hl_variable" href="free__surface_8cpp.html#abc5564e5c2cf362c587c446e78fe7196">get_M0_dh</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> 0; };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a73" name="a73"></a><a class="code hl_variable" href="free__surface_8cpp.html#a126ba8fcdbf289259612be39d3b4fab8">get_M2</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) {</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> * (1 - <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a74" name="a74"></a><a class="code hl_variable" href="free__surface_8cpp.html#a2460ec9dbd7f7522e7ce4981c744ca4b">get_M2_dh</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> -<a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> * 2 * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>; };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a75" name="a75"></a><a class="code hl_variable" href="free__surface_8cpp.html#a723528e62ed95192e672e44445d647a7">get_M3</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) {</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> h2 = <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> h3 = h2 * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> &gt;= 0)</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> * (2 * h3 - 3 * h2 + 1);</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> * (-2 * h3 - 3 * h2 + 1);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a76" name="a76"></a><a class="code hl_variable" href="free__surface_8cpp.html#a4825a358b4456cf947fbd333c04b8227">get_M3_dh</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) {</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> &gt;= 0)</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> * (6 * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * (<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> - 1));</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a> * (-6 * <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> * (<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> + 1));</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a77" name="a77"></a><a class="code hl_variable" href="free__surface_8cpp.html#a92271a50ab29307cc3f148adbb38b696">get_M</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a686d607908b00c0f7634206cb0fc3e08">get_M0</a>(<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>); };</div>
<div class="line"><span class="keyword">auto</span> <a id="a78" name="a78"></a><a class="code hl_variable" href="free__surface_8cpp.html#a308677c5b6f6cf47ab407f3a6bcc6949">get_M_dh</a> = [](<span class="keyword">auto</span> <a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>) { <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#abc5564e5c2cf362c587c446e78fe7196">get_M0_dh</a>(<a class="code hl_variable" href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>); };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a79" name="a79"></a><a class="code hl_variable" href="free__surface_8cpp.html#ab5a0080448e42b2f5548763f9ab619df">get_D</a> = [](<span class="keyword">const</span> <span class="keywordtype">double</span> <a id="a80" name="a80"></a><a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>) {</div>
<div class="line">  <a id="_a81" name="_a81"></a><a class="code hl_class" href="class_f_tensor_1_1_ddg.html">FTensor::Ddg&lt;double, SPACE_DIM, SPACE_DIM&gt;</a> t_D;</div>
<div class="line">  t_D(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) = A * ((<a class="code hl_variable" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) ^ <a class="code hl_variable" href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a>(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>)) / 4.);</div>
<div class="line">  <span class="keywordflow">return</span> t_D;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="comment">// some examples of initialisation functions</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a82" name="a82"></a><a class="code hl_variable" href="free__surface_8cpp.html#a5f02ab7d688a9646857dbc77ce86e84f">kernel_oscillation</a> = [](<span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keywordtype">double</span> y, <a id="_a83" name="_a83"></a><a class="code hl_class" href="classdouble.html">double</a>) {</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a id="a84" name="a84"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> = 3;</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a id="a85" name="a85"></a><a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = 0.0125;</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> A = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> * 0.2;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> theta = atan2(r, y);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">w</a> = <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> + A * cos(<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a> * theta);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> = std::sqrt(r * r + y * y);</div>
<div class="line">  <span class="keywordflow">return</span> tanh((w - d) / (<a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> * std::sqrt(2)));</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a86" name="a86"></a><a class="code hl_variable" href="free__surface_8cpp.html#a320d55c79de3bfd842fc427d83450f3f">kernel_eye</a> = [](<span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keywordtype">double</span> y, <a class="code hl_class" href="classdouble.html">double</a>) {</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> y0 = 0.5;</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> = 0.4;</div>
<div class="line">  y -= y0;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> = std::sqrt(r * r + y * y);</div>
<div class="line">  <span class="keywordflow">return</span> tanh((<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> - d) / (<a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> * std::sqrt(2)));</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a87" name="a87"></a><a class="code hl_variable" href="free__surface_8cpp.html#aedb68ad91550d74f18295f359a3cc222">capillary_tube</a> = [](<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z) {</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">double</span> water_height = 0.;</div>
<div class="line">  <span class="keywordflow">return</span> tanh((water_height - y) / (<a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> * std::sqrt(2)));</div>
<div class="line">  ;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a88" name="a88"></a><a class="code hl_variable" href="free__surface_8cpp.html#a0befa2aa45cf04b37afaae9b9d032eb6">bubble_device</a> = [](<span class="keywordtype">double</span> x, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> z) {</div>
<div class="line">  <span class="keywordflow">return</span> -tanh((-0.039 - x) / (<a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> * std::sqrt(2)));</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Initialisation function</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @note If UMs are compiled with Python to initialise phase field &quot;H&quot;</span></div>
<div class="line"><span class="comment"> * surface.py function is used, which has to be present in execution folder.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">auto</span> <a id="a89" name="a89"></a><a class="code hl_variable" href="free__surface_8cpp.html#a4fb2265adb844df23bf19d7818b5d59e">init_h</a> = [](<span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keywordtype">double</span> y, <span class="keywordtype">double</span> theta) {</div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_INIT_SURFACE</span></div>
<div class="line">  <span class="keywordtype">double</span> s = 1;</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = surfacePythonWeakPtr.lock()) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(ptr-&gt;evalSurface(r, y, theta, <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>, s),</div>
<div class="line">                      <span class="stringliteral">&quot;error eval python&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> s;</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">  <span class="comment">// return bubble_device(r, y, theta);</span></div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#aedb68ad91550d74f18295f359a3cc222">capillary_tube</a>(r, y, theta);</div>
<div class="line">  <span class="comment">// return kernel_eye(r, y, theta);</span></div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a90" name="a90"></a><a class="code hl_variable" href="free__surface_8cpp.html#a8eb2e32e83ed444e6d3ac8fdf877804b">wetting_angle</a> = [](<span class="keywordtype">double</span> water_level) { <span class="keywordflow">return</span> water_level; };</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a91" name="a91"></a><a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> = [](<span class="keyword">auto</span> b) { <span class="keywordflow">return</span> BitRefLevel().set(b); };</div>
<div class="line"><span class="keyword">auto</span> <a id="a92" name="a92"></a><a class="code hl_variable" href="hanging__node__approx_8cpp.html#a09bbb09bc96abf04b6a0e92775d64a1b">marker</a> = [](<span class="keyword">auto</span> b) { <span class="keywordflow">return</span> BitRefLevel().set(<a id="a93" name="a93"></a><a class="code hl_define" href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a> - b); };</div>
<div class="line"><span class="keyword">auto</span> <a id="a94" name="a94"></a><a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a> = [](<a id="_a95" name="_a95"></a><a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">  <span class="keywordflow">return</span> fe_ptr-&gt;numeredEntFiniteElementPtr-&gt;getBitRefLevel();</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a96" name="a96"></a><a class="code hl_variable" href="free__surface_8cpp.html#aa27d9fb6c66edd61c856e1946194cc8c">get_global_size</a> = [](<span class="keywordtype">int</span> l_size) {</div>
<div class="line">  <span class="keywordtype">int</span> g_size;</div>
<div class="line">  MPI_Allreduce(&amp;l_size, &amp;g_size, 1, MPI_INT, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line">  <span class="keywordflow">return</span> g_size;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">auto</span> <a id="a97" name="a97"></a><a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a> = [](moab::Interface &amp;moab, <span class="keyword">const</span> std::string name,</div>
<div class="line">                     <span class="keyword">const</span> <a id="_a98" name="_a98"></a><a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="free__surface_8cpp.html#aa27d9fb6c66edd61c856e1946194cc8c">get_global_size</a>(<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size())) {</div>
<div class="line">    <span class="keyword">auto</span> out_meshset = <a class="code hl_function" href="namespace_mo_f_e_m.html#ad17eefd5d88d2b51c71ec46cae8569ac">get_temp_meshset_ptr</a>(moab);</div>
<div class="line">    <a id="a99" name="a99"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(*out_meshset, r);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(name.c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>, <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>,</div>
<div class="line">                           out_meshset-&gt;get_ptr(), 1);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief get entities of dofs in the problem - used for debugging</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">auto</span> <a id="a100" name="a100"></a><a class="code hl_variable" href="free__surface_8cpp.html#aa6663f5cc1a1590e06266b81c8a078a6">get_dofs_ents_by_field_name</a> = [](<span class="keyword">auto</span> dm, <span class="keyword">auto</span> <a id="a101" name="a101"></a><a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">  <span class="keyword">auto</span> prb_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#aed3c6c3193c6c5a30bb408cf4a6f5c53">getProblemPtr</a>(dm);</div>
<div class="line">  std::vector&lt;EntityHandle&gt; ents_vec;</div>
<div class="line"> </div>
<div class="line">  <a id="_a102" name="_a102"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dm, &amp;m_field_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bit_number = m_field_ptr-&gt;<a id="a103" name="a103"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">get_field_bit_number</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">  <span class="keyword">auto</span> dofs = prb_ptr-&gt;numeredRowDofsPtr;</div>
<div class="line">  <span class="keyword">auto</span> lo_it = dofs-&gt;lower_bound(FieldEntity::getLoBitNumberUId(bit_number));</div>
<div class="line">  <span class="keyword">auto</span> hi_it = dofs-&gt;upper_bound(FieldEntity::getHiBitNumberUId(bit_number));</div>
<div class="line">  ents_vec.reserve(std::distance(lo_it, hi_it));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (; lo_it != hi_it; ++lo_it) {</div>
<div class="line">    ents_vec.push_back((*lo_it)-&gt;getEnt());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  std::sort(ents_vec.begin(), ents_vec.end());</div>
<div class="line">  <span class="keyword">auto</span> it = std::unique(ents_vec.begin(), ents_vec.end());</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">  <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.insert_list(ents_vec.begin(), it);</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief get entities of dofs in the problem - used for debugging</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">auto</span> <a id="a104" name="a104"></a><a class="code hl_variable" href="free__surface_8cpp.html#a98586395e62b3439ebaa3eff115fcc2e">get_dofs_ents_all</a> = [](<span class="keyword">auto</span> dm) {</div>
<div class="line">  <span class="keyword">auto</span> prb_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#aed3c6c3193c6c5a30bb408cf4a6f5c53">getProblemPtr</a>(dm);</div>
<div class="line">  std::vector&lt;EntityHandle&gt; ents_vec;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(dm, &amp;m_field_ptr);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dofs = prb_ptr-&gt;numeredRowDofsPtr;</div>
<div class="line">  ents_vec.reserve(dofs-&gt;size());</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> d : *dofs) {</div>
<div class="line">    ents_vec.push_back(<a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>-&gt;getEnt());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  std::sort(ents_vec.begin(), ents_vec.end());</div>
<div class="line">  <span class="keyword">auto</span> it = std::unique(ents_vec.begin(), ents_vec.end());</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">  <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.insert_list(ents_vec.begin(), it);</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_free_surface_ops_8hpp.html">FreeSurfaceOps.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_free_surface_ops.html">FreeSurfaceOps</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a105" name="_a105"></a><a class="code hl_struct" href="struct_free_surface.html">FreeSurface</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">enum</span> <a class="code hl_enumeration" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84">FR</a> { <a id="a106" name="a106"></a><a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a> }; <span class="comment">// F - forward, and reverse</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Set of functions called by PETSc solver used to refine and update</span></div>
<div class="line"><span class="comment"> * mesh.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * @note Currently theta method is only handled by this code.</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a107" name="_a107"></a><a class="code hl_struct" href="struct_t_s_pre_post_proc.html">TSPrePostProc</a> {</div>
<div class="line"> </div>
<div class="line">  <a id="a108" name="a108"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a91cdfc76b8bef1ae795d8800a78a45ed">TSPrePostProc</a>() = <span class="keywordflow">default</span>;</div>
<div class="line">  <span class="keyword">virtual</span> <a id="a109" name="a109"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a2b715125764ba0fb6c6795c0ee3224d2">~TSPrePostProc</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * @brief Used to setup TS solver</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param ts</span></div>
<div class="line"><span class="comment">   * @return MoFEMErrorCode</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a110" name="a110"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#aef485703101f9710430c3288f65d37ad">tsSetUp</a>(TS ts);</div>
<div class="line"> </div>
<div class="line">  <a id="_a111" name="_a111"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a> <a id="a112" name="a112"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a7098c3f3aa8ebc6c31c87caed0dcce29">getScatter</a>(Vec x, Vec y, <span class="keyword">enum</span> <a class="code hl_enumeration" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84">FR</a> fr);</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> <a id="a113" name="a113"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a55a9f26c6211f55d1b267f5766d45cb4">getSubVector</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> <a id="a114" name="a114"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a76a5770ed5d62aafbd7d06cce02d31ae">solverSubDM</a>;</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> <a id="a115" name="a115"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a3f680d202782ea9ba9fd7fef764359ad">globSol</a>;</div>
<div class="line">  <a class="code hl_struct" href="struct_free_surface.html">FreeSurface</a> *<a id="a116" name="a116"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a42c0ddb4765f16b94923b46aeb258b5a">fsRawPtr</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:<span class="comment"></span></div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * @brief Pre process time step</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * Refine mesh and update fields</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param ts</span></div>
<div class="line"><span class="comment">   * @return MoFEMErrorCode</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a117" name="a117"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a8711d535a7c4e3c854da590188f734e8">tsPreProc</a>(TS ts);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * @brief Post process time step.</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * Currently that function do not make anything major</span></div>
<div class="line"><span class="comment">   *</span></div>
<div class="line"><span class="comment">   * @param ts</span></div>
<div class="line"><span class="comment">   * @return MoFEMErrorCode</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a118" name="a118"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#ac81a85e08d887a61d720779da1640e45">tsPostProc</a>(TS ts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a119" name="a119"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#acef52bd1dd574d27fb470f6cab8f24fc">tsPreStage</a>(TS ts);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a120" name="a120"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#ab6aae3ab3d56525658dadea33e1f6129">tsSetIFunction</a>(TS ts, PetscReal <a id="a121" name="a121"></a><a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, Vec u, Vec u_t,</div>
<div class="line">                                       Vec f,</div>
<div class="line">                                       <span class="keywordtype">void</span> *ctx); <span class="comment">//&lt; Wrapper for SNES Rhs</span></div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a122" name="a122"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a78cc980454599ea5b44b2252e3f5d067">tsSetIJacobian</a>(TS ts, PetscReal <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, Vec u, Vec u_t,</div>
<div class="line">                                       PetscReal <a id="a123" name="a123"></a><a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, Mat A, Mat <a id="_a124" name="_a124"></a><a class="code hl_class" href="class_b.html">B</a>,</div>
<div class="line">                                       <span class="keywordtype">void</span> *ctx); <span class="comment">///&lt; Wrapper for SNES Lhs</span></div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a125" name="a125"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a5f73ef09d0d6bee6da2efe31de1bb91a">tsMonitor</a>(TS ts, PetscInt step, PetscReal <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, Vec u,</div>
<div class="line">                                  <span class="keywordtype">void</span> *ctx);      <span class="comment">///&lt; Wrapper for TS monitor</span></div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a126" name="a126"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#abda9f1a13eb25322d633155cbd0402eb">pcSetup</a>(PC pc);</div>
<div class="line">  <span class="keyword">static</span> <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a127" name="a127"></a><a class="code hl_function" href="struct_t_s_pre_post_proc.html#a65c9fdb310ee9855607e8f3ec6e805db">pcApply</a>(PC pc, Vec pc_f, Vec pc_x);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> <a id="a128" name="a128"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a2d152ba57407eedcc035262b813171e8">globRes</a>; <span class="comment">//&lt; global residual</span></div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Mat&gt;</a> <a id="a129" name="a129"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a337f6fb2dd3d45814b6288bad9b76e8a">subB</a>;    <span class="comment">//&lt; sub problem tangent matrix</span></div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;KSP&gt;</a> <a id="a130" name="a130"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#af3c68ebd9603b10fbf1a97f033e969a0">subKSP</a>;  <span class="comment">//&lt; sub problem KSP solver</span></div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;SnesCtx&gt;</div>
<div class="line">      <a id="a131" name="a131"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a86adf30485426c053d1c4cb45e134ed2">snesCtxPtr</a>; <span class="comment">//&lt; infernal data (context) for MoFEM SNES fuctions</span></div>
<div class="line">  boost::shared_ptr&lt;TsCtx&gt;</div>
<div class="line">      <a id="a132" name="a132"></a><a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a019ad880bca1112380d99d65cabcdc83">tsCtxPtr</a>;   <span class="comment">//&lt;  internal data (context) for MoFEM TS functions.</span></div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> boost::weak_ptr&lt;TSPrePostProc&gt; <a id="a133" name="a133"></a><a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a class="code hl_struct" href="struct_free_surface.html">FreeSurface</a> {</div>
<div class="line"> </div>
<div class="line">  <a id="a134" name="a134"></a><a class="code hl_function" href="struct_free_surface.html#a2c01b80ff5d3e7fa0a9a0c699b7a64fe">FreeSurface</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field) : <a id="a135" name="a135"></a><a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>(m_field) {}</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a136" name="a136"></a><a class="code hl_function" href="struct_free_surface.html#a1b055cfa0c1aa5d9e84f7ee624e6d301">runProblem</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a137" name="a137"></a><a class="code hl_function" href="struct_free_surface.html#af7617d5702951e33f34ce60d08456987">makeRefProblem</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>;</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a138" name="a138"></a><a class="code hl_function" href="struct_free_surface.html#a9073812e30e6f582c3df7f1775914e9a">readMesh</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a139" name="a139"></a><a class="code hl_function" href="struct_free_surface.html#a0dfede003abd0635ad388425507f4b85">setupProblem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a140" name="a140"></a><a class="code hl_function" href="struct_free_surface.html#a8f554e1221984163ef18529432cb2255">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a141" name="a141"></a><a class="code hl_function" href="struct_free_surface.html#a3f816ecc2a3be8170d9e319b9da9b6b3">projectData</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a142" name="a142"></a><a class="code hl_function" href="struct_free_surface.html#adc4e43a82a3bfc8bb8d78d2e8d48dd5d">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a143" name="a143"></a><a class="code hl_function" href="struct_free_surface.html#afbae12770d9512be114113fda808366b">solveSystem</a>();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /// @brief Find entities on refinement levels</span></div>
<div class="line"><span class="comment">  /// @param overlap level of overlap</span></div>
<div class="line"><span class="comment">  /// @return</span></div>
<div class="line"><span class="comment"></span>  std::vector&lt;Range&gt; <a id="a144" name="a144"></a><a class="code hl_function" href="struct_free_surface.html#aa6539a6215159c2c4df22edf4442f70f">findEntitiesCrossedByPhaseInterface</a>(<span class="keywordtype">size_t</span> overlap);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /// @brief</span></div>
<div class="line"><span class="comment">  /// @param ents</span></div>
<div class="line"><span class="comment">  /// @param level</span></div>
<div class="line"><span class="comment">  /// @param mask</span></div>
<div class="line"><span class="comment">  /// @return</span></div>
<div class="line"><span class="comment"></span>  <a class="code hl_class" href="class_range.html">Range</a> <a id="a145" name="a145"></a><a class="code hl_function" href="struct_free_surface.html#a02f2da5badf9cdc622f432e93d4741eb">findParentsToRefine</a>(<a class="code hl_class" href="class_range.html">Range</a> ents, BitRefLevel level, BitRefLevel mask);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /// @brief</span></div>
<div class="line"><span class="comment">  /// @param overlap</span></div>
<div class="line"><span class="comment">  /// @return</span></div>
<div class="line"><span class="comment"></span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a146" name="a146"></a><a class="code hl_function" href="struct_free_surface.html#ae8a9be5bb92874beaf3d16d4fab499a6">refineMesh</a>(<span class="keywordtype">size_t</span> overlap);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /// @brief Create hierarchy of elements run on parents levels</span></div>
<div class="line"><span class="comment">  /// @param fe_top pipeline element to which hierarchy is attached</span></div>
<div class="line"><span class="comment">  /// @param op type of operator OPSPACE, OPROW, OPCOL or OPROWCOL</span></div>
<div class="line"><span class="comment">  /// @param get_elema lambda function to create element on hierarchy</span></div>
<div class="line"><span class="comment">  /// @param verbosity verbosity level</span></div>
<div class="line"><span class="comment">  /// @param sev severity level</span></div>
<div class="line"><span class="comment">  /// @return</span></div>
<div class="line"><span class="comment"></span>  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a147" name="a147"></a><a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">      boost::shared_ptr&lt;FEMethod&gt; fe_top, std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">      ForcesAndSourcesCore::UserDataOperator::OpType op,</div>
<div class="line">      BitRefLevel child_ent_bit,</div>
<div class="line">      boost::function&lt;boost::shared_ptr&lt;ForcesAndSourcesCore&gt;()&gt; get_elem,</div>
<div class="line">      <span class="keywordtype">int</span> verbosity, <a class="code hl_enumeration" href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">LogManager::SeverityLevel</a> sev);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">friend</span> <span class="keyword">struct </span><a class="code hl_struct" href="struct_t_s_pre_post_proc.html">TSPrePostProc</a>;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Run programme]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#a1b055cfa0c1aa5d9e84f7ee624e6d301">FreeSurface::runProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9073812e30e6f582c3df7f1775914e9a">readMesh</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a0dfede003abd0635ad388425507f4b85">setupProblem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a8f554e1221984163ef18529432cb2255">boundaryCondition</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#adc4e43a82a3bfc8bb8d78d2e8d48dd5d">assembleSystem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#afbae12770d9512be114113fda808366b">solveSystem</a>();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Run programme]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#a9073812e30e6f582c3df7f1775914e9a">FreeSurface::readMesh</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a id="a148" name="a148"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Read mesh for problem&quot;</span>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a id="a149" name="a149"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a150" name="_a150"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getParentAdjacencies() = <span class="keyword">true</span>;</div>
<div class="line">  <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getBitRefLevel() = <a id="a151" name="a151"></a><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getOptions();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;loadFile();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Read mesh]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#a0dfede003abd0635ad388425507f4b85">FreeSurface::setupProblem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a152" name="a152"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-order&quot;</span>, &amp;<a id="a153" name="a153"></a><a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-nb_levels&quot;</span>, &amp;<a id="a154" name="a154"></a><a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>,</div>
<div class="line">                            PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">PetscOptionsGetInt</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-refine_overlap&quot;</span>, &amp;<a class="code hl_variable" href="free__surface_8cpp.html#ab9ee1c6b1a408c8680179d21cd3ec51f">refine_overlap</a>,</div>
<div class="line">                            PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *coord_type_names[] = {<span class="stringliteral">&quot;cartesian&quot;</span>, <span class="stringliteral">&quot;polar&quot;</span>, <span class="stringliteral">&quot;cylindrical&quot;</span>,</div>
<div class="line">                                    <span class="stringliteral">&quot;spherical&quot;</span>};</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a155" name="a155"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#abee82d436d03244c6886fc99f71116f0">PetscOptionsGetEList</a>(PETSC_NULL, NULL, <span class="stringliteral">&quot;-coords&quot;</span>, coord_type_names,</div>
<div class="line">                              <a id="a156" name="a156"></a><a class="code hl_enumvalue" href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6a340b797fa39cddc215962bea367322c1">LAST_COORDINATE_SYSTEM</a>, &amp;<a id="a157" name="a157"></a><a class="code hl_variable" href="free__surface_8cpp.html#a5ea560308c20afbf49c6113148979636">coord_type</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Approximation order = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Number of refinement levels nb_levels = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>;</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> += 1;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a158" name="a158"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;Acceleration&quot;</span>, <span class="stringliteral">&quot;-a0&quot;</span>, &amp;<a id="a159" name="a159"></a><a class="code hl_variable" href="free__surface_8cpp.html#ad95dcba445836b4ba94129111a4b888c">a0</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;\&quot;Minus\&quot; phase density rho_m&quot;</span>,</div>
<div class="line">                               <span class="stringliteral">&quot;-rho_m&quot;</span>, &amp;<a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;\&quot;Minus\&quot; phase viscosity&quot;</span>, <span class="stringliteral">&quot;-mu_m&quot;</span>,</div>
<div class="line">                               &amp;<a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;\&quot;Plus\&quot; phase density&quot;</span>, <span class="stringliteral">&quot;-rho_p&quot;</span>,</div>
<div class="line">                               &amp;<a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;\&quot;Plus\&quot; phase viscosity&quot;</span>, <span class="stringliteral">&quot;-mu_p&quot;</span>,</div>
<div class="line">                               &amp;<a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;Surface tension&quot;</span>, <span class="stringliteral">&quot;-lambda&quot;</span>,</div>
<div class="line">                               &amp;<a id="a160" name="a160"></a><a class="code hl_variable" href="free__surface_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL,</div>
<div class="line">                               <span class="stringliteral">&quot;Height of the well in energy functional&quot;</span>, <span class="stringliteral">&quot;-W&quot;</span>,</div>
<div class="line">                               &amp;<a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a5879ea15360d7f578572e5a7e760f777">rho_ave</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a> + <a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a>) / 2;</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a4ed33c41b617d287b500d415ef1063af">rho_diff</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a> - <a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a>) / 2;</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a974233f815d533deae50cb320c7439b3">mu_ave</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a> + <a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a>) / 2;</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a0befd7944c7ed7e9373b2e2c2fb7d338">mu_diff</a> = (<a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a> - <a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a>) / 2;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-h&quot;</span>, &amp;<a id="a161" name="a161"></a><a class="code hl_variable" href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> = <a class="code hl_variable" href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>;</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a653c95bd340aa1fd18c34afdfdae7d13">eta2</a> = <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a> * <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>;</div>
<div class="line">  <a class="code hl_variable" href="free__surface_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a> = (3. / (4. * std::sqrt(2. * <a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a>))) * (<a class="code hl_variable" href="free__surface_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a> / <a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-md&quot;</span>, &amp;<a class="code hl_variable" href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Acceleration a0 = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#ad95dcba445836b4ba94129111a4b888c">a0</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;\&quot;Minus\&quot; phase density rho_m = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;\&quot;Minus\&quot; phase viscosity mu_m = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;\&quot;Plus\&quot; phase density rho_p = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;\&quot;Plus\&quot; phase viscosity mu_p = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Surface tension lambda = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Height of the well in energy functional W = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Characteristic mesh size h = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Mobility md = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Average density rho_ave = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a5879ea15360d7f578572e5a7e760f777">rho_ave</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Difference density rho_diff = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a4ed33c41b617d287b500d415ef1063af">rho_diff</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Average viscosity mu_ave = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a974233f815d533deae50cb320c7439b3">mu_ave</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Difference viscosity mu_diff = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a0befd7944c7ed7e9373b2e2c2fb7d338">mu_diff</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;kappa = &quot;</span> &lt;&lt; <a class="code hl_variable" href="free__surface_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a>;</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Fields on domain</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Velocity field</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;U&quot;</span>, <a id="a162" name="a162"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a id="a163" name="a163"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, <a class="code hl_variable" href="free__surface_8cpp.html#a141ea5cd379b49e5fa78f0dd95c7a635">U_FIELD_DIM</a>);</div>
<div class="line">  <span class="comment">// Pressure field</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;P&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">  <span class="comment">// Order/phase fild</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;H&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">  <span class="comment">// Chemical potential</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addDomainField(<span class="stringliteral">&quot;G&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Field on boundary</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>,</div>
<div class="line">                                  <a class="code hl_variable" href="free__surface_8cpp.html#a141ea5cd379b49e5fa78f0dd95c7a635">U_FIELD_DIM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;H&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;G&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line">  <span class="comment">// Lagrange multiplier which constrains slip conditions</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;addBoundaryField(<span class="stringliteral">&quot;L&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, 1);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;P&quot;</span>, <a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a> - 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;H&quot;</span>, <a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;G&quot;</span>, <a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setFieldOrder(<span class="stringliteral">&quot;L&quot;</span>, <a class="code hl_variable" href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialise bit ref levels</span></div>
<div class="line">  <span class="keyword">auto</span> set_problem_bit = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="comment">// Set bits to build adjacencies between parents and children. That is</span></div>
<div class="line">    <span class="comment">// used by simple interface.</span></div>
<div class="line">    <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getBitAdjEnt() = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set();</div>
<div class="line">    <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getBitAdjParent() = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set();</div>
<div class="line">    <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getBitRefLevel() = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set();</div>
<div class="line">    <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getBitRefLevelMask() = <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_problem_bit();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;setUp();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Set up problem]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#a8f554e1221984163ef18529432cb2255">FreeSurface::boundaryCondition</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_INIT_SURFACE</span></div>
<div class="line">  <span class="keyword">auto</span> get_py_surface_init = []() {</div>
<div class="line">    <span class="keyword">auto</span> py_surf_init = boost::make_shared&lt;SurfacePython&gt;();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> py_surf_init-&gt;surfaceInit(<span class="stringliteral">&quot;surface.py&quot;</span>);</div>
<div class="line">    surfacePythonWeakPtr = py_surf_init;</div>
<div class="line">    <span class="keywordflow">return</span> py_surf_init;</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">auto</span> py_surf_init = get_py_surface_init();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> pip_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a164" name="_a164"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a165" name="_a165"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bit_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a166" name="_a166"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>UDO = ForcesAndSourcesCore::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> reset_bits = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    BitRefLevel start_mask;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> s = 0; s != <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>(); ++s)</div>
<div class="line">      start_mask[s] = <span class="keyword">true</span>;</div>
<div class="line">    <span class="comment">// reset bit ref levels</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;lambdaBitRefLevel(</div>
<div class="line">        [&amp;](<a id="_a167" name="_a167"></a><a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent, BitRefLevel &amp;<a id="a168" name="a168"></a><a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) { <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> &amp;= start_mask; });</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> level0;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(0), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), level0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(level0, <a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(level0, <a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_parent_field = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, field, op, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a id="a169" name="a169"></a><a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a id="a170" name="a170"></a><a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> h_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> grad_h_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> g_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> grad_g_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_generic = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="_a171" name="_a171"></a><a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">              fe_parent-&gt;getOpPtrVector(), {H1});</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="_a172" name="_a172"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">    pip.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a173" name="_a173"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, grad_h_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;G&quot;</span>, g_ptr));</div>
<div class="line">    pip.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, grad_g_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc = [&amp;](<span class="keyword">auto</span> exe_test) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> post_proc_fe = boost::make_shared&lt;PostProcEleDomain&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>);</div>
<div class="line">    post_proc_fe-&gt;exeTestHook = exe_test;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_generic(post_proc_fe);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a id="_a174" name="_a174"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a id="a175" name="a175"></a><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(post_proc_fe-&gt;getPostProcMesh(),</div>
<div class="line">                    post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">                    {{<span class="stringliteral">&quot;H&quot;</span>, h_ptr}, {<span class="stringliteral">&quot;G&quot;</span>, g_ptr}},</div>
<div class="line"> </div>
<div class="line">                    {{<span class="stringliteral">&quot;GRAD_H&quot;</span>, grad_h_ptr}, {<span class="stringliteral">&quot;GRAD_G&quot;</span>, grad_g_ptr}},</div>
<div class="line"> </div>
<div class="line">                    {},</div>
<div class="line"> </div>
<div class="line">                    {}</div>
<div class="line"> </div>
<div class="line">                    )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a176" name="a176"></a><a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;dFE&quot;</span>, post_proc_fe);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_fe-&gt;writeFile(<span class="stringliteral">&quot;out_init.h5m&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> solve_init = [&amp;](<span class="keyword">auto</span> exe_test) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    pip_mng-&gt;getOpDomainRhsPipeline().clear();</div>
<div class="line">    pip_mng-&gt;getOpDomainLhsPipeline().clear();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_domain_rhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_generic(fe);</div>
<div class="line">      <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a177" name="_a177"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_rhs_h.html">OpRhsH&lt;true&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, <span class="keyword">nullptr</span>, <span class="keyword">nullptr</span>, h_ptr, grad_h_ptr,</div>
<div class="line">                                     grad_g_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a178" name="_a178"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_rhs_g.html">OpRhsG&lt;true&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, h_ptr, grad_h_ptr, g_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_domain_lhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_generic(fe);</div>
<div class="line">      <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPCOL, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a179" name="_a179"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_h__d_h.html">OpLhsH_dH&lt;true&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, <span class="keyword">nullptr</span>, h_ptr, grad_g_ptr));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPCOL, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a180" name="_a180"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_h__d_g.html">OpLhsH_dG&lt;true&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, h_ptr));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a181" name="_a181"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_g__d_g.html">OpLhsG_dG</a>(<span class="stringliteral">&quot;G&quot;</span>));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field(fe, UDO::OPCOL, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a182" name="_a182"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_g__d_h.html">OpLhsG_dH&lt;true&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_subdm = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> level_ents_ptr = boost::make_shared&lt;Range&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;getEntitiesByRefLevel(</div>
<div class="line">          <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), *level_ents_ptr);</div>
<div class="line"> </div>
<div class="line">      DM subdm;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(mField.<a id="a183" name="a183"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), &amp;subdm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(subdm, <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a184" name="a184"></a><a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(subdm, dm, <span class="stringliteral">&quot;SUB_INIT&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a185" name="a185"></a><a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(subdm, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a186" name="a186"></a><a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(subdm, PETSC_TRUE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a187" name="a187"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(subdm, PETSC_TRUE);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>}) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a188" name="a188"></a><a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(subdm, f, level_ents_ptr);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a189" name="a189"></a><a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(subdm, f, level_ents_ptr);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(subdm);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (mField.<a id="a190" name="a190"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>() == 1) {</div>
<div class="line">          <span class="keyword">auto</span> dm_ents = <a class="code hl_variable" href="free__surface_8cpp.html#a98586395e62b3439ebaa3eff115fcc2e">get_dofs_ents_all</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a>(subdm, <span class="keyword">true</span>));</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(mField.<a id="a191" name="a191"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;sub_dm_init_ents_verts.h5m&quot;</span>,</div>
<div class="line">                            dm_ents.subset_by_type(MBVERTEX));</div>
<div class="line">          dm_ents = subtract(dm_ents, dm_ents.subset_by_type(MBVERTEX));</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;sub_dm_init_ents.h5m&quot;</span>, dm_ents);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a>(subdm);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> subdm = create_subdm();</div>
<div class="line"> </div>
<div class="line">    pip_mng-&gt;getDomainRhsFE().reset();</div>
<div class="line">    pip_mng-&gt;getDomainLhsFE().reset();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">    pip_mng-&gt;getDomainLhsFE()-&gt;exeTestHook = exe_test;</div>
<div class="line">    pip_mng-&gt;getDomainRhsFE()-&gt;exeTestHook = exe_test;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_rhs(pip_mng-&gt;getCastDomainRhsFE());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_lhs(pip_mng-&gt;getCastDomainLhsFE());</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> <a id="a192" name="a192"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a id="a193" name="a193"></a><a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(subdm);</div>
<div class="line">    <span class="keyword">auto</span> snes = pip_mng-&gt;createSNES(subdm);</div>
<div class="line">    <span class="keyword">auto</span> snes_ctx_ptr = <a id="a194" name="a194"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#addce2077b77e610d248ae548a01e77e3">getDMSnesCtx</a>(subdm);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_section_monitor = [&amp;](<span class="keyword">auto</span> solver) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(solver,</div>
<div class="line">                            (<a id="a195" name="a195"></a><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal,</div>
<div class="line">                                               <span class="keywordtype">void</span> *))<a id="a196" name="a196"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a37c8aa74d57ef9fcf60e6c508b987113">MoFEMSNESMonitorFields</a>,</div>
<div class="line">                            (<span class="keywordtype">void</span> *)(snes_ctx_ptr.get()), <span class="keyword">nullptr</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> print_section_field = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> section =</div>
<div class="line">          mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a197" name="_a197"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;sectionCreate(<span class="stringliteral">&quot;SUB_INIT&quot;</span>);</div>
<div class="line">      PetscInt num_fields;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetNumFields(section, &amp;num_fields);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> &lt; num_fields; ++<a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetFieldName(section, f, &amp;<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Field &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::string(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section_monitor(snes);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_section_field();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>}) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a198" name="_a198"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_field_blas.html">FieldBlas</a>&gt;()-&gt;setField(0, f);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetFromOptions(snes);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSolve(snes, PETSC_NULL, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a199" name="a199"></a><a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(subdm, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> reset_bits();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> solve_init(</div>
<div class="line">      [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) { <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(0); });</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refineMesh(<a class="code hl_variable" href="free__surface_8cpp.html#ab9ee1c6b1a408c8680179d21cd3ec51f">refine_overlap</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>}) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_field_blas.html">FieldBlas</a>&gt;()-&gt;setField(0, f);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> solve_init([](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a> - 1);</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc([](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a> - 1);</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  pip_mng-&gt;getOpDomainRhsPipeline().clear();</div>
<div class="line">  pip_mng-&gt;getOpDomainLhsPipeline().clear();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Remove DOFs where boundary conditions are set</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;SYM_X&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;U&quot;</span>, 0, 0);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;SYM_X&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;L&quot;</span>, 0, 0);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;SYM_Y&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;U&quot;</span>, 1, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;SYM_Y&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;L&quot;</span>, 1, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;FIX&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                           0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;FIX&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line">                                           0, 0);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;removeBlockDOFsOnEntities(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), <span class="stringliteral">&quot;ZERO&quot;</span>,</div>
<div class="line">                                           <span class="stringliteral">&quot;L&quot;</span>, 0, 0);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Boundary condition]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Data projection]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#a3f816ecc2a3be8170d9e319b9da9b6b3">FreeSurface::projectData</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// FIXME: Functionality in this method should be improved (projection should</span></div>
<div class="line">  <span class="comment">// be done field by field), generalised, and move to become core</span></div>
<div class="line">  <span class="comment">// functionality.</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> pip_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bit_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> field_blas = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_field_blas.html">FieldBlas</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Store all existing elements pipelines, replace them by data projection</span></div>
<div class="line">  <span class="comment">// pipelines, to put them back when projection is done.</span></div>
<div class="line">  <span class="keyword">auto</span> fe_domain_lhs = pip_mng-&gt;getDomainLhsFE();</div>
<div class="line">  <span class="keyword">auto</span> fe_domain_rhs = pip_mng-&gt;getDomainRhsFE();</div>
<div class="line">  <span class="keyword">auto</span> fe_bdy_lhs = pip_mng-&gt;getBoundaryLhsFE();</div>
<div class="line">  <span class="keyword">auto</span> fe_bdy_rhs = pip_mng-&gt;getBoundaryRhsFE();</div>
<div class="line"> </div>
<div class="line">  pip_mng-&gt;getDomainLhsFE().reset();</div>
<div class="line">  pip_mng-&gt;getDomainRhsFE().reset();</div>
<div class="line">  pip_mng-&gt;getBoundaryLhsFE().reset();</div>
<div class="line">  pip_mng-&gt;getBoundaryRhsFE().reset();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>UDO = ForcesAndSourcesCore::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// extract field data for domain parent element</span></div>
<div class="line">  <span class="keyword">auto</span> add_parent_field_domain = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field, <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, field, op, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// extract field data for boundary parent element</span></div>
<div class="line">  <span class="keyword">auto</span> add_parent_field_bdy = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field, <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, field, op, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a id="a200" name="a200"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// run this element on element with given bit, otherwise run other nested</span></div>
<div class="line">  <span class="comment">// element</span></div>
<div class="line">  <span class="keyword">auto</span> create_run_parent_op = [&amp;](<span class="keyword">auto</span> parent_fe_ptr, <span class="keyword">auto</span> this_fe_ptr,</div>
<div class="line">                                  <span class="keyword">auto</span> fe_bit) {</div>
<div class="line">    <span class="keyword">auto</span> parent_mask = fe_bit;</div>
<div class="line">    parent_mask.flip();</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">new</span> <a id="_a201" name="_a201"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_run_parent.html">OpRunParent</a>(parent_fe_ptr, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), parent_mask,</div>
<div class="line">                           this_fe_ptr, fe_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>,</div>
<div class="line">                           Sev::inform);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// create hierarchy of nested elements</span></div>
<div class="line">  <span class="keyword">auto</span> get_parents_vel_fe_ptr = [&amp;](<span class="keyword">auto</span> this_fe_ptr, <span class="keyword">auto</span> fe_bit) {</div>
<div class="line">    std::vector&lt;boost::shared_ptr&lt;DomianParentEle&gt;&gt; parents_elems_ptr_vec;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a id="a202" name="a202"></a><a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 0; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> &lt; <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>)</div>
<div class="line">      parents_elems_ptr_vec.emplace_back(</div>
<div class="line">          boost::make_shared&lt;DomianParentEle&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 1; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> &lt; <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">      parents_elems_ptr_vec[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> - 1]-&gt;getOpPtrVector().push_back(</div>
<div class="line">          create_run_parent_op(parents_elems_ptr_vec[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>], this_fe_ptr, fe_bit));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> parents_elems_ptr_vec[0];</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// solve projection problem</span></div>
<div class="line">  <span class="keyword">auto</span> solve_projection = [&amp;](<span class="keyword">auto</span> exe_test) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_domain_rhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> h_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">      <span class="keyword">auto</span> g_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> eval_fe_ptr = boost::make_shared&lt;DomianParentEle&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>);</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">auto</span> &amp;pip = eval_fe_ptr-&gt;getOpPtrVector();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">            eval_fe_ptr, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()),</div>
<div class="line"> </div>
<div class="line">            [&amp;]() {</div>
<div class="line">              boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                  <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">              <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">            },</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">        <span class="comment">// That can be done much smarter, by block, field by field. For</span></div>
<div class="line">        <span class="comment">// simplicity is like that.</span></div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(eval_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a203" name="_a203"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(eval_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P&quot;</span>, p_ptr));</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(eval_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(eval_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;G&quot;</span>, g_ptr));</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> parent_eval_fe_ptr =</div>
<div class="line">          get_parents_vel_fe_ptr(eval_fe_ptr, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>()));</div>
<div class="line">      pip.push_back(create_run_parent_op(parent_eval_fe_ptr, eval_fe_ptr,</div>
<div class="line">                                         <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>())));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> assemble_fe_ptr = boost::make_shared&lt;DomianParentEle&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>);</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">auto</span> &amp;pip = assemble_fe_ptr-&gt;getOpPtrVector();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">            assemble_fe_ptr, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">            [&amp;]() {</div>
<div class="line">              boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                  <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">              <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">            },</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(assemble_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="a204" name="a204"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a4c51e25ae2f4a6111d2538d87ea73c58">OpDomainAssembleVector</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(assemble_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="a205" name="a205"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a>(<span class="stringliteral">&quot;P&quot;</span>, p_ptr));</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(assemble_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a>(<span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(assemble_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>,</div>
<div class="line">                                       <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a>(<span class="stringliteral">&quot;G&quot;</span>, g_ptr));</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> parent_assemble_fe_ptr =</div>
<div class="line">          get_parents_vel_fe_ptr(assemble_fe_ptr, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()));</div>
<div class="line">      pip.push_back(create_run_parent_op(</div>
<div class="line">          parent_assemble_fe_ptr, assemble_fe_ptr, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>())));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_domain_lhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">          fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// That can be done much smarter, by block, field by field. For simplicity</span></div>
<div class="line">      <span class="comment">// is like that.</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="a206" name="a206"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a05fa1e48e6fb969147b13b55dacbd2e9">OpDomainMassU</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;P&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="a207" name="a207"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a7a097aeb92b0e72fbe9058279b42aee2">OpDomainMassP</a>(<span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;H&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#ab42544325abba8cc4ec2b39dbb701302">OpDomainMassH</a>(<span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;G&quot;</span>,</div>
<div class="line">                                     <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="a208" name="a208"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a4684744887622bc40ac4d5def27344e2">OpDomainMassG</a>(<span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_bdy_rhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> l_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> eval_fe_ptr = boost::make_shared&lt;BoundaryParentEle&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>);</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">auto</span> &amp;pip = eval_fe_ptr-&gt;getOpPtrVector();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">            eval_fe_ptr, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()),</div>
<div class="line"> </div>
<div class="line">            [&amp;]() {</div>
<div class="line">              boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                  <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">              <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">            },</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">        <span class="comment">// That can be done much smarter, by block, field by field. For</span></div>
<div class="line">        <span class="comment">// simplicity is like that.</span></div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(eval_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line">                                    <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;L&quot;</span>, l_ptr));</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> parent_eval_fe_ptr =</div>
<div class="line">          get_parents_vel_fe_ptr(eval_fe_ptr, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>()));</div>
<div class="line">      pip.push_back(create_run_parent_op(parent_eval_fe_ptr, eval_fe_ptr,</div>
<div class="line">                                         <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>())));</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> assemble_fe_ptr = boost::make_shared&lt;BoundaryParentEle&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>);</div>
<div class="line">      {</div>
<div class="line">        <span class="keyword">auto</span> &amp;pip = assemble_fe_ptr-&gt;getOpPtrVector();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">            assemble_fe_ptr, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">            [&amp;]() {</div>
<div class="line">              boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                  <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">              <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">            },</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">struct </span>OpLSize : <span class="keyword">public</span> <a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a> {</div>
<div class="line">          OpLSize(boost::shared_ptr&lt;VectorDouble&gt; l_ptr)</div>
<div class="line">              : <a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a>(<a id="a209" name="a209"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a>, <a class="code hl_class" href="class_domain_ele_op.html">DomainEleOp</a>::OPSPACE), lPtr(l_ptr) {}</div>
<div class="line">          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span>, EntityType, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">            <span class="keywordflow">if</span> (lPtr-&gt;size() != getGaussPts().size2()) {</div>
<div class="line">              lPtr-&gt;resize(getGaussPts().size2());</div>
<div class="line">              lPtr-&gt;clear();</div>
<div class="line">            }</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">private</span>:</div>
<div class="line">          boost::shared_ptr&lt;VectorDouble&gt; lPtr;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpLSize(l_ptr));</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(assemble_fe_ptr, UDO::OPROW, <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line">                                    <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="a210" name="a210"></a><a class="code hl_typedef" href="free__surface_8cpp.html#aedc6e3cd14a21843cb47a0cb3975f4a2">OpBoundaryAssembleScalar</a>(<span class="stringliteral">&quot;L&quot;</span>, l_ptr));</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> parent_assemble_fe_ptr =</div>
<div class="line">          get_parents_vel_fe_ptr(assemble_fe_ptr, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()));</div>
<div class="line">      pip.push_back(create_run_parent_op(</div>
<div class="line">          parent_assemble_fe_ptr, assemble_fe_ptr, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>())));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_bdy_lhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">          fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// That can be done much smarter, by block, field by field. For simplicity</span></div>
<div class="line">      <span class="comment">// is like that.</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line">                                  <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPCOL, <span class="stringliteral">&quot;L&quot;</span>,</div>
<div class="line">                                  <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="a211" name="a211"></a><a class="code hl_typedef" href="free__surface_8cpp.html#a271f46dff095cfa001adf659298f195d">OpBoundaryMassL</a>(<span class="stringliteral">&quot;L&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_subdm = [&amp;]() -&gt; <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> {</div>
<div class="line">      <span class="keyword">auto</span> level_ents_ptr = boost::make_shared&lt;Range&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;getEntitiesByRefLevel(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), *level_ents_ptr);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_prj_ents = [&amp;]() {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> prj_mesh;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByDimAndRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>()),</div>
<div class="line">                                                    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line">                                                    <a id="a212" name="a212"></a><a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, prj_mesh);</div>
<div class="line">        <span class="keyword">auto</span> common_ents = intersect(prj_mesh, *level_ents_ptr);</div>
<div class="line">        prj_mesh = subtract(unite(*level_ents_ptr, prj_mesh), common_ents)</div>
<div class="line">                       .subset_by_dimension(<a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> prj_mesh;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> prj_ents = get_prj_ents();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="free__surface_8cpp.html#aa27d9fb6c66edd61c856e1946194cc8c">get_global_size</a>(prj_ents.size())) {</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> rebuild = [&amp;]() {</div>
<div class="line">          <span class="keyword">auto</span> prb_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a213" name="_a213"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;();</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;std::string&gt; fields{<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>};</div>
<div class="line">          std::map&lt;std::string, boost::shared_ptr&lt;Range&gt;&gt; range_maps{</div>
<div class="line"> </div>
<div class="line">              {<span class="stringliteral">&quot;U&quot;</span>, level_ents_ptr},</div>
<div class="line">              {<span class="stringliteral">&quot;P&quot;</span>, level_ents_ptr},</div>
<div class="line">              {<span class="stringliteral">&quot;H&quot;</span>, level_ents_ptr},</div>
<div class="line">              {<span class="stringliteral">&quot;G&quot;</span>, level_ents_ptr},</div>
<div class="line">              {<span class="stringliteral">&quot;L&quot;</span>, level_ents_ptr}</div>
<div class="line"> </div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng-&gt;<a id="a214" name="a214"></a><a class="code hl_function" href="group__mofem__problems__manager.html#ga9c86df8247b9fda02508dd26018fff8c">buildSubProblem</a>(<span class="stringliteral">&quot;SUB_SOLVER&quot;</span>, fields, fields,</div>
<div class="line">                                          <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName(), PETSC_TRUE,</div>
<div class="line">                                          &amp;range_maps, &amp;range_maps);</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// partition problem</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng-&gt;partitionFiniteElements(<span class="stringliteral">&quot;SUB_SOLVER&quot;</span>, <span class="keyword">true</span>, 0,</div>
<div class="line">                                                  <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line">          <span class="comment">// set ghost nodes</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> prb_mng-&gt;partitionGhostDofsOnDistributedMesh(<span class="stringliteral">&quot;SUB_SOLVER&quot;</span>);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Create projection problem&quot;</span>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> rebuild();</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">        DM subdm;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), &amp;subdm);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(subdm, <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(subdm, dm, <span class="stringliteral">&quot;SUB_SOLVER&quot;</span>);</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a>(subdm);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Nothing to project&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a>();</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_dummy_dm = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> dummy_dm = <a id="a215" name="a215"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a216" name="a216"></a><a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(dummy_dm, &amp;<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>,</div>
<div class="line">                                           <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName().c_str(),</div>
<div class="line">                                           BitRefLevel(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>()),</div>
<div class="line">                        <span class="stringliteral">&quot;create dummy dm&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> dummy_dm;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> subdm = create_subdm();</div>
<div class="line">    <span class="keywordflow">if</span> (subdm) {</div>
<div class="line"> </div>
<div class="line">      pip_mng-&gt;getDomainRhsFE().reset();</div>
<div class="line">      pip_mng-&gt;getDomainLhsFE().reset();</div>
<div class="line">      pip_mng-&gt;getBoundaryRhsFE().reset();</div>
<div class="line">      pip_mng-&gt;getBoundaryLhsFE().reset();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setBoundaryRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setBoundaryLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">      pip_mng-&gt;getDomainLhsFE()-&gt;exeTestHook = exe_test;</div>
<div class="line">      pip_mng-&gt;getDomainRhsFE()-&gt;exeTestHook = [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(<a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> - 1);</div>
<div class="line">      };</div>
<div class="line">      pip_mng-&gt;getBoundaryLhsFE()-&gt;exeTestHook = exe_test;</div>
<div class="line">      pip_mng-&gt;getBoundaryRhsFE()-&gt;exeTestHook = [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(<a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> - 1);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_rhs(pip_mng-&gt;getCastDomainRhsFE());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_lhs(pip_mng-&gt;getCastDomainLhsFE());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_bdy_rhs(pip_mng-&gt;getCastBoundaryRhsFE());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_bdy_lhs(pip_mng-&gt;getCastBoundaryLhsFE());</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(subdm);</div>
<div class="line">      <span class="keyword">auto</span> <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a> = <a id="a217" name="a217"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> ksp = pip_mng-&gt;createKSP(subdm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(ksp);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetUp(ksp);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// get vector norm</span></div>
<div class="line">      <span class="keyword">auto</span> get_norm = [&amp;](<span class="keyword">auto</span> x) {</div>
<div class="line">        <span class="keywordtype">double</span> nrm;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(x, NORM_2, &amp;nrm);</div>
<div class="line">        <span class="keywordflow">return</span> nrm;</div>
<div class="line">      };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      /**</span></div>
<div class="line"><span class="comment">       * @brief Zero DOFs, used by FieldBlas</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keyword">auto</span> zero_dofs = [](boost::shared_ptr&lt;FieldEntity&gt; ent_ptr) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a id="a218" name="a218"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : ent_ptr-&gt;getEntFieldData()) {</div>
<div class="line">          <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = 0;</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> <a id="a219" name="a219"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a75ec25c20769bd419ad19f79e062aa66">solve</a> = [&amp;](<span class="keyword">auto</span> S) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(S);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(ksp, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>, S);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(S, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(S, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Solve projection&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a75ec25c20769bd419ad19f79e062aa66">solve</a>(<a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> glob_x = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">      <span class="keyword">auto</span> sub_x = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(subdm);</div>
<div class="line">      <span class="keyword">auto</span> dummy_dm = create_dummy_dm();</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      /**</span></div>
<div class="line"><span class="comment">       * @brief get TSTheta data operators</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keyword">auto</span> apply_restrict = [&amp;]() {</div>
<div class="line">        <span class="keyword">auto</span> get_is = [](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>) {</div>
<div class="line">          IS iy;</div>
<div class="line">          <span class="keyword">auto</span> create = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">            <span class="keywordtype">int</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, ystart;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetLocalSize(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetOwnershipRange(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, &amp;ystart, NULL);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISCreateStride(PETSC_COMM_SELF, <a class="code hl_variable" href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a>, ystart, 1, &amp;iy);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(create(), <span class="stringliteral">&quot;create is&quot;</span>);</div>
<div class="line">          <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a>(iy);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> iy = get_is(glob_x);</div>
<div class="line">        <span class="keyword">auto</span> s = <a id="a220" name="a220"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a748d9a902fa774326786c28c22517a0c">createVecScatter</a>(glob_x, PETSC_NULL, glob_x, iy);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">            DMSubDomainRestrict(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), s, PETSC_NULL, dummy_dm),</div>
<div class="line">            <span class="stringliteral">&quot;restrict&quot;</span>);</div>
<div class="line">        Vec X0, Xdot;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(DMGetNamedGlobalVector(dummy_dm, <span class="stringliteral">&quot;TSTheta_X0&quot;</span>, &amp;X0),</div>
<div class="line">                          <span class="stringliteral">&quot;get X0&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">            DMGetNamedGlobalVector(dummy_dm, <span class="stringliteral">&quot;TSTheta_Xdot&quot;</span>, &amp;Xdot),</div>
<div class="line">            <span class="stringliteral">&quot;get Xdot&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> forward_ghost = [](<span class="keyword">auto</span> <a id="a221" name="a221"></a><a class="code hl_variable" href="shallow__wave_8cpp.html#ab65af9ad1ab66fac4ba26a865ae7ae13">g</a>) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="shallow__wave_8cpp.html#ab65af9ad1ab66fac4ba26a865ae7ae13">g</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="shallow__wave_8cpp.html#ab65af9ad1ab66fac4ba26a865ae7ae13">g</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(forward_ghost(X0), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(forward_ghost(Xdot), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a id="a222" name="a222"></a><a class="code hl_variable" href="free__surface_8cpp.html#a6b72e54baf646b08b4b87f987f583dcb">debug</a>) {</div>
<div class="line">          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Reverse restrict: X0 &quot;</span> &lt;&lt; get_norm(X0) &lt;&lt; <span class="stringliteral">&quot; Xdot &quot;</span></div>
<div class="line">              &lt;&lt; get_norm(Xdot);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">return</span> std::vector&lt;Vec&gt;{X0, Xdot};</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> ts_solver_vecs = apply_restrict();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (ts_solver_vecs.size()) {</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : ts_solver_vecs) {</div>
<div class="line">          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Solve projection vector&quot;</span>;</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, INSERT_VALUES,</div>
<div class="line">                                         SCATTER_REVERSE);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a75ec25c20769bd419ad19f79e062aa66">solve</a>(sub_x);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>}) {</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Zero field &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> field_blas-&gt;fieldLambdaOnEntities(zero_dofs, f);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(subdm, sub_x, INSERT_VALUES,</div>
<div class="line">                                         SCATTER_REVERSE);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, INSERT_VALUES,</div>
<div class="line">                                         SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Norm V &quot;</span> &lt;&lt; get_norm(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMRestoreNamedGlobalVector(dummy_dm, <span class="stringliteral">&quot;TSTheta_X0&quot;</span>,</div>
<div class="line">                                          &amp;ts_solver_vecs[0]);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMRestoreNamedGlobalVector(dummy_dm, <span class="stringliteral">&quot;TSTheta_Xdot&quot;</span>,</div>
<div class="line">                                          &amp;ts_solver_vecs[1]);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>}) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;WORLD&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Zero field &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> field_blas-&gt;fieldLambdaOnEntities(zero_dofs, f);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(subdm, <a class="code hl_variable" href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// postprocessing (only for debugging proposes)</span></div>
<div class="line">  <span class="keyword">auto</span> post_proc = [&amp;](<span class="keyword">auto</span> exe_test) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> post_proc_fe = boost::make_shared&lt;PostProcEleDomain&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>);</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = post_proc_fe-&gt;getOpPtrVector();</div>
<div class="line">    post_proc_fe-&gt;exeTestHook = exe_test;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        post_proc_fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">              fe_parent-&gt;getOpPtrVector(), {H1});</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> h_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> g_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                   <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>,</div>
<div class="line">                                   <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P&quot;</span>, p_ptr));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>,</div>
<div class="line">                                   <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>,</div>
<div class="line">                                   <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;G&quot;</span>, g_ptr));</div>
<div class="line"> </div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(post_proc_fe-&gt;getPostProcMesh(),</div>
<div class="line">                    post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">                    {{<span class="stringliteral">&quot;P&quot;</span>, p_ptr}, {<span class="stringliteral">&quot;H&quot;</span>, h_ptr}, {<span class="stringliteral">&quot;G&quot;</span>, g_ptr}},</div>
<div class="line"> </div>
<div class="line">                    {{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}},</div>
<div class="line"> </div>
<div class="line">                    {},</div>
<div class="line"> </div>
<div class="line">                    {}</div>
<div class="line"> </div>
<div class="line">                    )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dm, <span class="stringliteral">&quot;dFE&quot;</span>, post_proc_fe);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_fe-&gt;writeFile(<span class="stringliteral">&quot;out_projection.h5m&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> solve_projection([](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>());</div>
<div class="line">  });</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc([](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a>(fe_ptr).test(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>());</div>
<div class="line">    });</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  fe_domain_lhs.swap(pip_mng-&gt;getDomainLhsFE());</div>
<div class="line">  fe_domain_rhs.swap(pip_mng-&gt;getDomainRhsFE());</div>
<div class="line">  fe_bdy_lhs.swap(pip_mng-&gt;getBoundaryLhsFE());</div>
<div class="line">  fe_bdy_rhs.swap(pip_mng-&gt;getBoundaryRhsFE());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Data projection]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Push operators to pip]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#adc4e43a82a3bfc8bb8d78d2e8d48dd5d">FreeSurface::assembleSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>UDO = ForcesAndSourcesCore::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_parent_field_domain = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, field, op, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_parent_field_bdy = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, field, op, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a id="a223" name="a223"></a><a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a> = [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">    <span class="keywordflow">return</span> fe_ptr-&gt;numeredEntFiniteElementPtr-&gt;getBitRefLevel().test(</div>
<div class="line">        <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> - 1);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dot_u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> grad_u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> dot_h_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> h_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> grad_h_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> g_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> grad_g_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> lambda_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> div_u_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Push element from reference configuration to current configuration in 3d</span></div>
<div class="line">  <span class="comment">// space</span></div>
<div class="line">  <span class="keyword">auto</span> set_domain_general = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(pip, {<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>});</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">              fe_parent-&gt;getOpPtrVector(), {H1});</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    pip.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a224" name="_a224"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDot&lt;U_FIELD_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, dot_u_ptr));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;U_FIELD_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="_a225" name="_a225"></a><a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;U_FIELD_DIM, SPACE_DIM&gt;</a>(</div>
<div class="line">        <span class="stringliteral">&quot;U&quot;</span>, grad_u_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">switch</span> (<a class="code hl_variable" href="free__surface_8cpp.html#a5ea560308c20afbf49c6113148979636">coord_type</a>) {</div>
<div class="line">    <span class="keywordflow">case</span> <a id="a226" name="a226"></a><a class="code hl_enumvalue" href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6ad0f64430e58c5010eddd5289ab519800">CARTESIAN</a>:</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a227" name="_a227"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_divergence_vector_field_values.html">OpCalculateDivergenceVectorFieldValues&lt;SPACE_DIM, CARTESIAN&gt;</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, div_u_ptr));</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6a8bcf3ac927052dfa8318c1fb96c4ad10">CYLINDRICAL</a>:</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_divergence_vector_field_values.html">OpCalculateDivergenceVectorFieldValues&lt;SPACE_DIM, CYLINDRICAL&gt;</a>(</div>
<div class="line">              <span class="stringliteral">&quot;U&quot;</span>, div_u_ptr));</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">    <span class="keywordflow">default</span>:</div>
<div class="line">      SETERRQ(PETSC_COMM_WORLD, <a id="a228" name="a228"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Coordinate system not implemented&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="a229" name="a229"></a><a class="code hl_typedef" href="namespace_mo_f_e_m.html#ad8b6ce3375c62fd0b096e01cb710da98">OpCalculateScalarFieldValuesDot</a>(<span class="stringliteral">&quot;H&quot;</span>, dot_h_ptr));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">    pip.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, grad_h_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;G&quot;</span>, g_ptr));</div>
<div class="line">    pip.push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, grad_g_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P&quot;</span>, p_ptr));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_domain_rhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_general(fe);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="_a230" name="_a230"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_rhs_u.html">OpRhsU</a>(<span class="stringliteral">&quot;U&quot;</span>, dot_u_ptr, u_ptr, grad_u_ptr, h_ptr,</div>
<div class="line">                             grad_h_ptr, g_ptr, p_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_free_surface_ops_1_1_op_rhs_h.html">OpRhsH&lt;false&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, u_ptr, dot_h_ptr, h_ptr, grad_h_ptr,</div>
<div class="line">                                    grad_g_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_free_surface_ops_1_1_op_rhs_g.html">OpRhsG&lt;false&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, h_ptr, grad_h_ptr, g_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a>(</div>
<div class="line">        <span class="stringliteral">&quot;P&quot;</span>, div_u_ptr, [](<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>) {</div>
<div class="line">          <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a>(r);</div>
<div class="line">        }));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a>(</div>
<div class="line">        <span class="stringliteral">&quot;P&quot;</span>, p_ptr, [](<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>) {</div>
<div class="line">          <span class="keywordflow">return</span> <a id="a231" name="a231"></a><a class="code hl_variable" href="free__surface_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a> * <a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a>(r);</div>
<div class="line">        }));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_domain_lhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_general(fe);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a232" name="_a232"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_u__d_u.html">OpLhsU_dU</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr, grad_u_ptr, h_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      pip.push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a233" name="_a233"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_u__d_h.html">OpLhsU_dH</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, dot_u_ptr, u_ptr, grad_u_ptr, h_ptr, g_ptr));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a234" name="_a234"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_u__d_g.html">OpLhsU_dG</a>(<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, grad_h_ptr));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a id="_a235" name="_a235"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_h__d_u.html">OpLhsH_dU</a>(<span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>, grad_h_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_h__d_h.html">OpLhsH_dH&lt;false&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, u_ptr, h_ptr, grad_g_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_h__d_g.html">OpLhsH_dG&lt;false&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, h_ptr));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_g__d_h.html">OpLhsG_dH&lt;false&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_free_surface_ops_1_1_op_lhs_g__d_g.html">OpLhsG_dG</a>(<span class="stringliteral">&quot;G&quot;</span>));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">switch</span> (<a class="code hl_variable" href="free__surface_8cpp.html#a5ea560308c20afbf49c6113148979636">coord_type</a>) {</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6ad0f64430e58c5010eddd5289ab519800">CARTESIAN</a>:</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a83ec90365447ce19c2bc90892eef8e3d">OpMixScalarTimesDiv&lt;CARTESIAN&gt;</a>(</div>
<div class="line">            <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">            [](<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>) {</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a>(r);</div>
<div class="line">            },</div>
<div class="line">            <span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6a8bcf3ac927052dfa8318c1fb96c4ad10">CYLINDRICAL</a>:</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a83ec90365447ce19c2bc90892eef8e3d">OpMixScalarTimesDiv&lt;CYLINDRICAL&gt;</a>(</div>
<div class="line">            <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">            [](<span class="keyword">const</span> <span class="keywordtype">double</span> r, <span class="keyword">const</span> <span class="keywordtype">double</span>, <span class="keyword">const</span> <span class="keywordtype">double</span>) {</div>
<div class="line">              <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a>(r);</div>
<div class="line">            },</div>
<div class="line">            <span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line">        <span class="keywordflow">break</span>;</div>
<div class="line">      <span class="keywordflow">default</span>:</div>
<div class="line">        SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>,</div>
<div class="line">                <span class="stringliteral">&quot;Coordinate system not implemented&quot;</span>);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(fe, UDO::OPCOL, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">      pip.push_back(<span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a7a097aeb92b0e72fbe9058279b42aee2">OpDomainMassP</a>(<span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, [](<span class="keywordtype">double</span> r, <span class="keywordtype">double</span>, <span class="keywordtype">double</span>) {</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a> * <a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a>(r);</div>
<div class="line">      }));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_block_name = [](<span class="keyword">auto</span> name) {</div>
<div class="line">    <span class="keywordflow">return</span> boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % <span class="stringliteral">&quot;WETTING_ANGLE&quot;</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_blocks = [&amp;](<span class="keyword">auto</span> &amp;&amp;name) {</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a236" name="_a236"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(</div>
<div class="line">        std::regex(name.str()));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_boundary_rhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;U_FIELD_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;L&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;L&quot;</span>, lambda_ptr));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="_a237" name="_a237"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_normal_constrain_rhs.html">OpNormalConstrainRhs</a>(<span class="stringliteral">&quot;L&quot;</span>, u_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> BoundaryNaturalBC::AddFluxToPipeline&lt;OpFluidFlux&gt;::add(</div>
<div class="line">        pip, <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>, <span class="stringliteral">&quot;L&quot;</span>, {}, <span class="stringliteral">&quot;INFLUX&quot;</span>,</div>
<div class="line">        [](<span class="keywordtype">double</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <a class="code hl_class" href="classdouble.html">double</a>, <a class="code hl_class" href="classdouble.html">double</a>) { <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a>(r); }, Sev::inform);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="_a238" name="_a238"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_normal_force_rhs.html">OpNormalForceRhs</a>(<span class="stringliteral">&quot;U&quot;</span>, lambda_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> wetting_block = get_blocks(get_block_name(<span class="stringliteral">&quot;WETTING_ANGLE&quot;</span>));</div>
<div class="line">    <span class="keywordflow">if</span> (wetting_block.size()) {</div>
<div class="line">      <span class="comment">// push operators to the side element which is called from op_bdy_side</span></div>
<div class="line">      <span class="keyword">auto</span> op_bdy_side =</div>
<div class="line">          <span class="keyword">new</span> <a id="_a239" name="_a239"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;SideEle&gt;</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">      op_bdy_side-&gt;getSideFEPtr()-&gt;exeTestHook = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_bdy_side-&gt;getOpPtrVector(), {H1});</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">          op_bdy_side-&gt;getSideFEPtr(), <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE,</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">            <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">                fe_parent-&gt;getOpPtrVector(), {H1});</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(op_bdy_side-&gt;getSideFEPtr(), UDO::OPROW,</div>
<div class="line">                                     <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      op_bdy_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, grad_h_ptr));</div>
<div class="line">      <span class="comment">// push bdy side op</span></div>
<div class="line">      pip.push_back(op_bdy_side);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push operators for rhs wetting angle</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;b : wetting_block) {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> force_edges;</div>
<div class="line">        std::vector&lt;double&gt; attr_vec;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> b-&gt;getMeshsetIdEntitiesByDimension(</div>
<div class="line">            <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, force_edges, <span class="keyword">true</span>);</div>
<div class="line">        b-&gt;getAttributes(attr_vec);</div>
<div class="line">        <span class="keywordflow">if</span> (attr_vec.size() != 1)</div>
<div class="line">          SETERRQ(PETSC_COMM_SELF, <a id="a240" name="a240"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a>,</div>
<div class="line">                  <span class="stringliteral">&quot;Should be one attribute&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Wetting angle: &quot;</span> &lt;&lt; attr_vec.front();</div>
<div class="line">        <span class="comment">// need to find the attributes and pass to operator</span></div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a241" name="_a241"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_wetting_angle_rhs.html">OpWettingAngleRhs</a>(</div>
<div class="line">            <span class="stringliteral">&quot;G&quot;</span>, grad_h_ptr, boost::make_shared&lt;Range&gt;(force_edges),</div>
<div class="line">            attr_vec.front()));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_boundary_lhs = [&amp;](<span class="keyword">auto</span> fe) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;pip = fe-&gt;getOpPtrVector();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;L&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPCOL, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a id="_a242" name="_a242"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_normal_constrain_lhs.html">OpNormalConstrainLhs</a>(<span class="stringliteral">&quot;L&quot;</span>, <span class="stringliteral">&quot;U&quot;</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> wetting_block = get_blocks(get_block_name(<span class="stringliteral">&quot;WETTING_ANGLE&quot;</span>));</div>
<div class="line">    <span class="keywordflow">if</span> (wetting_block.size()) {</div>
<div class="line">      <span class="keyword">auto</span> col_ind_ptr = boost::make_shared&lt;std::vector&lt;VectorInt&gt;&gt;();</div>
<div class="line">      <span class="keyword">auto</span> col_diff_base_ptr = boost::make_shared&lt;std::vector&lt;MatrixDouble&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push operators to the side element which is called from op_bdy_side</span></div>
<div class="line">      <span class="keyword">auto</span> op_bdy_side =</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;SideEle&gt;</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">      op_bdy_side-&gt;getSideFEPtr()-&gt;exeTestHook = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_bdy_side-&gt;getOpPtrVector(), {H1});</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">          op_bdy_side-&gt;getSideFEPtr(), <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE,</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">            <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">                fe_parent-&gt;getOpPtrVector(), {H1});</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(op_bdy_side-&gt;getSideFEPtr(), UDO::OPROW,</div>
<div class="line">                                     <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      op_bdy_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, grad_h_ptr));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(op_bdy_side-&gt;getSideFEPtr(), UDO::OPCOL,</div>
<div class="line">                                     <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">      op_bdy_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a243" name="_a243"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_loop_side_get_data_for_side_ele.html">OpLoopSideGetDataForSideEle</a>(<span class="stringliteral">&quot;H&quot;</span>, col_ind_ptr, col_diff_base_ptr));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push bdy side op</span></div>
<div class="line">      pip.push_back(op_bdy_side);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push operators for lhs wetting angle</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;b : wetting_block) {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> force_edges;</div>
<div class="line">        std::vector&lt;double&gt; attr_vec;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> b-&gt;getMeshsetIdEntitiesByDimension(</div>
<div class="line">            <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, force_edges, <span class="keyword">true</span>);</div>
<div class="line">        b-&gt;getAttributes(attr_vec);</div>
<div class="line">        <span class="keywordflow">if</span> (attr_vec.size() != 1)</div>
<div class="line">          SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a>,</div>
<div class="line">                  <span class="stringliteral">&quot;Should be one attribute&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;wetting angle edges size &quot;</span> &lt;&lt; force_edges.size();</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a244" name="_a244"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_wetting_angle_lhs.html">OpWettingAngleLhs</a>(</div>
<div class="line">            <span class="stringliteral">&quot;G&quot;</span>, grad_h_ptr, col_ind_ptr, col_diff_base_ptr,</div>
<div class="line">            boost::make_shared&lt;Range&gt;(force_edges), attr_vec.front()));</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> *pip_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_rhs(pip_mng-&gt;getCastDomainRhsFE());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_domain_lhs(pip_mng-&gt;getCastDomainLhsFE());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_boundary_rhs(pip_mng-&gt;getCastBoundaryRhsFE());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_boundary_lhs(pip_mng-&gt;getCastBoundaryLhsFE());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setDomainLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setBoundaryRhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pip_mng-&gt;setBoundaryLhsIntegrationRule(<a class="code hl_variable" href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a>);</div>
<div class="line"> </div>
<div class="line">  pip_mng-&gt;getDomainLhsFE()-&gt;exeTestHook = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a>;</div>
<div class="line">  pip_mng-&gt;getDomainRhsFE()-&gt;exeTestHook = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a>;</div>
<div class="line">  pip_mng-&gt;getBoundaryLhsFE()-&gt;exeTestHook = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a>;</div>
<div class="line">  pip_mng-&gt;getBoundaryRhsFE()-&gt;exeTestHook = <a class="code hl_variable" href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Push operators to pip]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Monitor solution</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * This functions is called by TS kso at the end of each step. It is used</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a245" name="_a245"></a><a class="code hl_struct" href="struct_monitor.html">Monitor</a> : <span class="keyword">public</span> <a class="code hl_class" href="class_f_e_method.html">FEMethod</a> {</div>
<div class="line">  <a id="a246" name="a246"></a><a class="code hl_function" href="struct_monitor.html#a51e14b6b79321ce8c5b4e442f69db386">Monitor</a>(</div>
<div class="line">      <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> dm, boost::shared_ptr&lt;moab::Core&gt; post_proc_mesh,</div>
<div class="line">      boost::shared_ptr&lt;PostProcEleDomainCont&gt; post_proc,</div>
<div class="line">      boost::shared_ptr&lt;PostProcEleBdyCont&gt; post_proc_edge,</div>
<div class="line">      std::pair&lt;boost::shared_ptr&lt;BoundaryEle&gt;, boost::shared_ptr&lt;VectorDouble&gt;&gt;</div>
<div class="line">          p)</div>
<div class="line">      : <a id="a247" name="a247"></a><a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>(dm), <a id="a248" name="a248"></a><a class="code hl_variable" href="struct_monitor.html#a63e22b46f3401bac9f25cb3e0d2a68a2">postProcMesh</a>(post_proc_mesh), <a id="a249" name="a249"></a><a class="code hl_variable" href="struct_monitor.html#adfbe1bfb50dd34928514ba723a7723c1">postProc</a>(post_proc),</div>
<div class="line">        <a id="a250" name="a250"></a><a class="code hl_variable" href="struct_monitor.html#ae0160cce2daeb742610993dd1b4e3f51">postProcEdge</a>(post_proc_edge), <a id="a251" name="a251"></a><a class="code hl_variable" href="struct_monitor.html#ac219a0368b742c497988ab7af05b7928">liftFE</a>(p.first), <a id="a252" name="a252"></a><a class="code hl_variable" href="struct_monitor.html#abf0c895cd7f4330ae3df3dd04ca10a44">liftVec</a>(p.second) {}</div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a253" name="a253"></a><a class="code hl_function" href="struct_monitor.html#aa3f39564d02335db9af906cd8a77b86b">postProcess</a>() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Monitor&quot;</span>;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> <a id="a254" name="a254"></a><a class="code hl_variable" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a> = 1;</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a255" name="a255"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_t_s_method.html#ad6cfbd3594ea3521910e4dc8db9d5fb0">ts_step</a> % <a class="code hl_variable" href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a> == 0) {</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Mesh pre proc&quot;</span>;</div>
<div class="line">      <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> *m_field_ptr;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a256" name="a256"></a><a class="code hl_function" href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">DMoFEMGetInterfacePtr</a>(<a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>, &amp;m_field_ptr);</div>
<div class="line">      <span class="keyword">auto</span> post_proc_begin =</div>
<div class="line">          boost::make_shared&lt;PostProcBrokenMeshInMoabBaseBegin&gt;(*m_field_ptr,</div>
<div class="line">                                                                <a class="code hl_variable" href="struct_monitor.html#a63e22b46f3401bac9f25cb3e0d2a68a2">postProcMesh</a>);</div>
<div class="line">      <span class="keyword">auto</span> post_proc_end = boost::make_shared&lt;PostProcBrokenMeshInMoabBaseEnd&gt;(</div>
<div class="line">          *m_field_ptr, <a class="code hl_variable" href="struct_monitor.html#a63e22b46f3401bac9f25cb3e0d2a68a2">postProcMesh</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a257" name="a257"></a><a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(<a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>, post_proc_begin-&gt;getFEMethod());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>, <span class="stringliteral">&quot;dFE&quot;</span>, <a class="code hl_variable" href="struct_monitor.html#adfbe1bfb50dd34928514ba723a7723c1">postProc</a>,</div>
<div class="line">                                      this-&gt;<a id="a258" name="a258"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_basic_method.html#a758c8a8cdac350c8d3fe0bc8c147992e">getCacheWeakPtr</a>());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>, <span class="stringliteral">&quot;bFE&quot;</span>, <a class="code hl_variable" href="struct_monitor.html#ae0160cce2daeb742610993dd1b4e3f51">postProcEdge</a>,</div>
<div class="line">                                      this-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_basic_method.html#a758c8a8cdac350c8d3fe0bc8c147992e">getCacheWeakPtr</a>());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a259" name="a259"></a><a class="code hl_function" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(<a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>, post_proc_end-&gt;getFEMethod());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_end-&gt;writeFile(</div>
<div class="line">          <span class="stringliteral">&quot;out_step_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="struct_mo_f_e_m_1_1_t_s_method.html#ad6cfbd3594ea3521910e4dc8db9d5fb0">ts_step</a>) + <span class="stringliteral">&quot;.h5m&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;Mesh pre proc done&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_variable" href="struct_monitor.html#abf0c895cd7f4330ae3df3dd04ca10a44">liftVec</a>-&gt;resize(<a id="a260" name="a260"></a><a class="code hl_variable" href="adolc__plasticity_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_variable" href="struct_monitor.html#abf0c895cd7f4330ae3df3dd04ca10a44">liftVec</a>-&gt;clear();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>, <span class="stringliteral">&quot;bFE&quot;</span>, <a class="code hl_variable" href="struct_monitor.html#ac219a0368b742c497988ab7af05b7928">liftFE</a>, this-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_basic_method.html#a758c8a8cdac350c8d3fe0bc8c147992e">getCacheWeakPtr</a>());</div>
<div class="line">    MPI_Allreduce(MPI_IN_PLACE, &amp;(*<a class="code hl_variable" href="struct_monitor.html#abf0c895cd7f4330ae3df3dd04ca10a44">liftVec</a>)[0], <a class="code hl_variable" href="adolc__plasticity_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, MPI_DOUBLE, MPI_SUM,</div>
<div class="line">                  MPI_COMM_WORLD);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Step &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_mo_f_e_m_1_1_t_s_method.html#ad6cfbd3594ea3521910e4dc8db9d5fb0">ts_step</a> &lt;&lt; <span class="stringliteral">&quot; time &quot;</span> &lt;&lt; <a id="a261" name="a261"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_t_s_method.html#a5eb15bd118b06018110428672a4821c7">ts_t</a></div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot; lift vec x: &quot;</span> &lt;&lt; (*liftVec)[0] &lt;&lt; <span class="stringliteral">&quot; y: &quot;</span> &lt;&lt; (*liftVec)[1];</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> <a class="code hl_variable" href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">dM</a>;</div>
<div class="line">  boost::shared_ptr&lt;moab::Core&gt; <a class="code hl_variable" href="struct_monitor.html#a63e22b46f3401bac9f25cb3e0d2a68a2">postProcMesh</a>;</div>
<div class="line">  boost::shared_ptr&lt;PostProcEleDomainCont&gt; <a class="code hl_variable" href="struct_monitor.html#adfbe1bfb50dd34928514ba723a7723c1">postProc</a>;</div>
<div class="line">  boost::shared_ptr&lt;PostProcEleBdyCont&gt; <a class="code hl_variable" href="struct_monitor.html#ae0160cce2daeb742610993dd1b4e3f51">postProcEdge</a>;</div>
<div class="line">  boost::shared_ptr&lt;BoundaryEle&gt; <a class="code hl_variable" href="struct_monitor.html#ac219a0368b742c497988ab7af05b7928">liftFE</a>;</div>
<div class="line">  boost::shared_ptr&lt;VectorDouble&gt; <a class="code hl_variable" href="struct_monitor.html#abf0c895cd7f4330ae3df3dd04ca10a44">liftVec</a>;</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Solve]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#afbae12770d9512be114113fda808366b">FreeSurface::solveSystem</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>UDO = ForcesAndSourcesCore::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> pip_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager.html">PipelineManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> create_solver_dm = [&amp;](<span class="keyword">auto</span> dm) -&gt; <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a> {</div>
<div class="line">    DM subdm;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_subdm = [&amp;](<span class="keyword">auto</span> dm) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> bit_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">      <span class="keyword">auto</span> level_ents_ptr = boost::make_shared&lt;Range&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), *level_ents_ptr);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMCreate(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), &amp;subdm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetType(subdm, <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(subdm, dm, <span class="stringliteral">&quot;SUB_SOLVER&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(subdm, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(subdm, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getBoundaryFEName());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(subdm, PETSC_TRUE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(subdm, PETSC_FALSE);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : {<span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;P&quot;</span>, <span class="stringliteral">&quot;H&quot;</span>, <span class="stringliteral">&quot;G&quot;</span>, <span class="stringliteral">&quot;L&quot;</span>}) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(subdm, f, level_ents_ptr);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">DMMoFEMAddSubFieldCol</a>(subdm, f, level_ents_ptr);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(subdm);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(setup_subdm(dm), <span class="stringliteral">&quot;create subdm&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a>(subdm);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_fe_post_proc = [&amp;](<span class="keyword">auto</span> post_proc_mesh) {</div>
<div class="line">    <span class="keyword">auto</span> add_parent_field_domain = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field) {</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">          fe, field, op, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> post_proc_fe =</div>
<div class="line">        boost::make_shared&lt;PostProcEleDomainCont&gt;(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>, post_proc_mesh);</div>
<div class="line">    post_proc_fe-&gt;exeTestHook = [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr-&gt;numeredEntFiniteElementPtr-&gt;getBitRefLevel().test(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> - 1);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> grad_u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> h_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> grad_h_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> g_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> grad_g_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        post_proc_fe-&gt;getOpPtrVector(), {H1});</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">setParentDofs</a>(</div>
<div class="line">        post_proc_fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>));</div>
<div class="line">          <a class="code hl_struct" href="struct_add_h_o_ops.html">AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">              fe_parent-&gt;getOpPtrVector(), {H1});</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;U_FIELD_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;U_FIELD_DIM, SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>,</div>
<div class="line">                                                                   grad_u_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;H&quot;</span>, h_ptr));</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;H&quot;</span>, grad_h_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P&quot;</span>, p_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_domain(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;G&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;G&quot;</span>, g_ptr));</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">OpCalculateScalarFieldGradient&lt;SPACE_DIM&gt;</a>(<span class="stringliteral">&quot;G&quot;</span>, grad_g_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;2, 2&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line">            post_proc_fe-&gt;getPostProcMesh(), post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;H&quot;</span>, h_ptr}, {<span class="stringliteral">&quot;P&quot;</span>, p_ptr}, {<span class="stringliteral">&quot;G&quot;</span>, g_ptr}},</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}, {<span class="stringliteral">&quot;H_GRAD&quot;</span>, grad_h_ptr}, {<span class="stringliteral">&quot;G_GRAD&quot;</span>, grad_g_ptr}},</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;GRAD_U&quot;</span>, grad_u_ptr}},</div>
<div class="line"> </div>
<div class="line">            {}</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> post_proc_fe;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_bdy_post_proc_fe = [&amp;](<span class="keyword">auto</span> post_proc_mesh) {</div>
<div class="line">    <span class="keyword">auto</span> add_parent_field_bdy = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field) {</div>
<div class="line">      <span class="keywordflow">return</span> setParentDofs(</div>
<div class="line">          fe, field, op, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a id="a262" name="a262"></a><a class="code hl_typedef" href="child__and__parent_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(mField));</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> post_proc_fe =</div>
<div class="line">        boost::make_shared&lt;PostProcEleBdyCont&gt;(mField, post_proc_mesh);</div>
<div class="line">    post_proc_fe-&gt;exeTestHook = [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr-&gt;numeredEntFiniteElementPtr-&gt;getBitRefLevel().test(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a> - 1);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setParentDofs(</div>
<div class="line">        post_proc_fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(mField));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">struct </span>OpGetNormal : <span class="keyword">public</span> <a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a> {</div>
<div class="line"> </div>
<div class="line">      OpGetNormal(boost::shared_ptr&lt;VectorDouble&gt; l_ptr,</div>
<div class="line">                  boost::shared_ptr&lt;MatrixDouble&gt; n_ptr)</div>
<div class="line">          : <a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a>, <a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a>::OPSPACE), ptrL(l_ptr),</div>
<div class="line">            ptrNormal(n_ptr) {}</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line">                            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keyword">auto</span> t_l = getFTensor0FromVec(*ptrL);</div>
<div class="line">        <span class="keyword">auto</span> t_n_fe = getFTensor1NormalsAtGaussPts();</div>
<div class="line">        ptrNormal-&gt;resize(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, getGaussPts().size2(), <span class="keyword">false</span>);</div>
<div class="line">        <span class="keyword">auto</span> t_n = getFTensor1FromMat&lt;SPACE_DIM&gt;(*ptrNormal);</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> gg = 0; gg != getGaussPts().size2(); ++gg) {</div>
<div class="line">          t_n(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_n_fe(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_l / std::sqrt(t_n_fe(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_n_fe(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">          ++t_n_fe;</div>
<div class="line">          ++t_l;</div>
<div class="line">          ++t_n;</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">protected</span>:</div>
<div class="line">      boost::shared_ptr&lt;VectorDouble&gt; ptrL;</div>
<div class="line">      boost::shared_ptr&lt;MatrixDouble&gt; ptrNormal;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> u_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> lambda_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> normal_l_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;U&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;U_FIELD_DIM&gt;</a>(<span class="stringliteral">&quot;U&quot;</span>, u_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;L&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;L&quot;</span>, lambda_ptr));</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpGetNormal(lambda_ptr, normal_l_ptr));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(post_proc_fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;P&quot;</span>, p_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> op_ptr = <span class="keyword">new</span> <a id="a263" name="a263"></a><a class="code hl_typedef" href="child__and__parent_8cpp.html#afcd75ab2301efeac675f87f3ba9d00f4">BoundaryEleOp</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a>, BoundaryEleOp::OPSPACE);</div>
<div class="line">    op_ptr-&gt;doWorkRhsHook = [&amp;](<a id="_a264" name="_a264"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_data_operator.html">DataOperator</a> *base_op_ptr, <span class="keywordtype">int</span> side,</div>
<div class="line">                                EntityType <a class="code hl_variable" href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">type</a>,</div>
<div class="line">                                <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;2, 2&gt;</a>;</div>
<div class="line"> </div>
<div class="line">    post_proc_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(post_proc_fe-&gt;getPostProcMesh(),</div>
<div class="line">                    post_proc_fe-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">                    OpPPMap::DataMapVec{{<span class="stringliteral">&quot;P&quot;</span>, p_ptr}},</div>
<div class="line"> </div>
<div class="line">                    OpPPMap::DataMapMat{{<span class="stringliteral">&quot;U&quot;</span>, u_ptr}, {<span class="stringliteral">&quot;L&quot;</span>, normal_l_ptr}},</div>
<div class="line"> </div>
<div class="line">                    OpPPMap::DataMapMat(),</div>
<div class="line"> </div>
<div class="line">                    OpPPMap::DataMapMat()</div>
<div class="line"> </div>
<div class="line">                        )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> post_proc_fe;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_lift_fe = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> add_parent_field_bdy = [&amp;](<span class="keyword">auto</span> fe, <span class="keyword">auto</span> op, <span class="keyword">auto</span> field) {</div>
<div class="line">      <span class="keywordflow">return</span> setParentDofs(</div>
<div class="line">          fe, field, op, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">          [&amp;]() {</div>
<div class="line">            boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">                <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(mField));</div>
<div class="line">            <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">          },</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> fe = boost::make_shared&lt;BoundaryEle&gt;(mField);</div>
<div class="line">    fe-&gt;exeTestHook = [](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_ptr) {</div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr-&gt;numeredEntFiniteElementPtr-&gt;getBitRefLevel().test(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a> - 1);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> lift_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> p_ptr = boost::make_shared&lt;VectorDouble&gt;();</div>
<div class="line">    <span class="keyword">auto</span> ents_ptr = boost::make_shared&lt;Range&gt;();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> setParentDofs(</div>
<div class="line">        fe, <span class="stringliteral">&quot;&quot;</span>, UDO::OPSPACE, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line"> </div>
<div class="line">        [&amp;]() {</div>
<div class="line">          boost::shared_ptr&lt;ForcesAndSourcesCore&gt; fe_parent(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_typedef" href="child__and__parent_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a>(mField));</div>
<div class="line">          <span class="keywordflow">return</span> fe_parent;</div>
<div class="line">        },</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;const CubitMeshSets *&gt; vec_ptr;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;getCubitMeshsetPtr(</div>
<div class="line">        std::regex(<span class="stringliteral">&quot;LIFT&quot;</span>), vec_ptr);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr : vec_ptr) {</div>
<div class="line">      <span class="keyword">auto</span> meshset = m_ptr-&gt;getMeshset();</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(meshset, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1,</div>
<div class="line">                                                         ents, <span class="keyword">true</span>);</div>
<div class="line">      ents_ptr-&gt;merge(ents);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::noisy) &lt;&lt; <span class="stringliteral">&quot;Lift ents &quot;</span> &lt;&lt; (*ents_ptr);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_parent_field_bdy(fe, UDO::OPROW, <span class="stringliteral">&quot;P&quot;</span>);</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">OpCalculateScalarFieldValues</a>(<span class="stringliteral">&quot;L&quot;</span>, p_ptr));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a265" name="_a265"></a><a class="code hl_struct" href="struct_free_surface_ops_1_1_op_calculate_lift.html">OpCalculateLift</a>(<span class="stringliteral">&quot;L&quot;</span>, p_ptr, lift_ptr, ents_ptr));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(fe, lift_ptr);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_post_proc_monitor = [&amp;](<span class="keyword">auto</span> ts) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    DM dm;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetDM(ts, &amp;dm);</div>
<div class="line">    boost::shared_ptr&lt;FEMethod&gt; null_fe;</div>
<div class="line">    <span class="keyword">auto</span> post_proc_mesh = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">    <span class="keyword">auto</span> monitor_ptr = boost::make_shared&lt;Monitor&gt;(</div>
<div class="line">        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;DM&gt;</a>(dm, <span class="keyword">true</span>), post_proc_mesh,</div>
<div class="line">        get_fe_post_proc(post_proc_mesh), get_bdy_post_proc_fe(post_proc_mesh),</div>
<div class="line">        get_lift_fe());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a112dfab22d28426fcd0ab2d61cf8f494">DMMoFEMTSSetMonitor</a>(dm, ts, <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDomainFEName(), null_fe,</div>
<div class="line">                               null_fe, monitor_ptr);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line">  <span class="keyword">auto</span> ts = <a class="code hl_function" href="namespace_mo_f_e_m.html#a89f535c8339c55c756485568be5559f7">createTS</a>(mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, dm);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ts_pre_post_proc = boost::make_shared&lt;TSPrePostProc&gt;();</div>
<div class="line">  <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a> = ts_pre_post_proc;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="dynamic__first__order__con__law_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line"> </div>
<div class="line">    ptr-&gt;fsRawPtr = <span class="keyword">this</span>;</div>
<div class="line">    ptr-&gt;solverSubDM = create_solver_dm(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM());</div>
<div class="line">    ptr-&gt;globSol = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(dm);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(dm, ptr-&gt;globSol, INSERT_VALUES,</div>
<div class="line">                                   SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(ptr-&gt;globSol);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(ptr-&gt;globSol);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> sub_ts = pip_mng-&gt;createTSIM(ptr-&gt;solverSubDM);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_post_proc_monitor(sub_ts);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Add monitor to time solver</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ptr-&gt;tsSetUp(ts);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(ts);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> print_fields_in_section = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> section = mField.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;sectionCreate(</div>
<div class="line">          <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getProblemName());</div>
<div class="line">      PetscInt num_fields;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetNumFields(section, &amp;num_fields);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> f = 0; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> &lt; num_fields; ++<a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetFieldName(section, f, &amp;<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform)</div>
<div class="line">            &lt;&lt; <span class="stringliteral">&quot;Field &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::string(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_fields_in_section();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, ptr-&gt;globSol);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> <a id="a266" name="a266"></a><a class="code hl_function" href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[]) {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_INIT_SURFACE</span></div>
<div class="line">  Py_Initialize();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Initialisation of MoFEM/PETSc and MOAB data structures</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> param_file[] = <span class="stringliteral">&quot;param_file.petsc&quot;</span>;</div>
<div class="line">  <a id="a267" name="a267"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::Core::Initialize</a>(&amp;argc, &amp;argv, param_file, <a class="code hl_variable" href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add logging channel for example</span></div>
<div class="line">  <span class="keyword">auto</span> core_log = logging::core::get();</div>
<div class="line">  core_log-&gt;add_sink(LogManager::createSink(LogManager::getStrmWorld(), <span class="stringliteral">&quot;FS&quot;</span>));</div>
<div class="line">  LogManager::setLog(<span class="stringliteral">&quot;FS&quot;</span>);</div>
<div class="line">  <a id="a268" name="a268"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a>(<span class="stringliteral">&quot;FS&quot;</span>, <span class="stringliteral">&quot;free surface&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">try</span> {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc]</span></div>
<div class="line"><span class="comment"></span>    DMType dm_name = <span class="stringliteral">&quot;DMMOFEM&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">DMRegister_MoFEM</a>(dm_name);<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Register MoFEM discrete manager in PETSc</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span>    moab::Core mb_instance;              <span class="comment">///&lt; mesh database</span></div>
<div class="line">    moab::Interface &amp;moab = mb_instance; <span class="comment">///&lt; mesh database interface</span><span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Create MoAB]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span>    <a id="_a269" name="_a269"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::Core</a> core(moab);           <span class="comment">///&lt; finite element database</span></div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field = core; <span class="comment">///&lt; finite element database interface</span><span class="comment"></span></div>
<div class="line"><span class="comment">    //! [Create MoFEM]</span></div>
<div class="line"><span class="comment"></span><span class="comment"></span> </div>
<div class="line"><span class="comment">    //! [FreeSurface]</span></div>
<div class="line"><span class="comment"></span>    <a class="code hl_struct" href="struct_free_surface.html">FreeSurface</a> ex(m_field);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ex.runProblem();<span class="comment"></span></div>
<div class="line"><span class="comment">    //! [FreeSurface]</span></div>
<div class="line"><span class="comment"></span>  }</div>
<div class="line">  <a id="a270" name="a270"></a><a class="code hl_define" href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a271" name="a271"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::Core::Finalize</a>();</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_INIT_SURFACE</span></div>
<div class="line">  <span class="keywordflow">if</span> (Py_FinalizeEx() &lt; 0) {</div>
<div class="line">    exit(120);</div>
<div class="line">  }</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">std::vector&lt;Range&gt;</div>
<div class="line"><a class="code hl_function" href="struct_free_surface.html#aa6539a6215159c2c4df22edf4442f70f">FreeSurface::findEntitiesCrossedByPhaseInterface</a>(<span class="keywordtype">size_t</span> overlap) {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">  <span class="keyword">auto</span> bit_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> comm_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a272" name="_a272"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> vertices;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(bit_mng-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">                        <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(0), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBVERTEX, vertices),</div>
<div class="line">                    <span class="stringliteral">&quot;can not get vertices on bit 0&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;dofs_mi = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a id="a273" name="a273"></a><a class="code hl_function" href="group__mofem__access.html#ga7fc3e2d994adf8ef767f674ee3d76493">get_dofs</a>()-&gt;get&lt;<a id="_a274" name="_a274"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_unique__mi__tag.html">Unique_mi_tag</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> field_bit_number = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">get_field_bit_number</a>(<span class="stringliteral">&quot;H&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> plus_range, minus_range;</div>
<div class="line">  std::vector&lt;EntityHandle&gt; plus, minus;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get vertices on level 0 on plus and minus side</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = vertices.pair_begin(); p != vertices.pair_end(); ++p) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> = p-&gt;first;</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> s = p-&gt;second;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Lowest Dof UId for given field (field bit number) on entity f</span></div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> lo_uid = DofEntity::getLoFieldEntityUId(field_bit_number, f);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> hi_uid = DofEntity::getHiFieldEntityUId(field_bit_number, s);</div>
<div class="line">    <span class="keyword">auto</span> it = dofs_mi.lower_bound(lo_uid);</div>
<div class="line">    <span class="keyword">const</span> <span class="keyword">auto</span> hi_it = dofs_mi.upper_bound(hi_uid);</div>
<div class="line"> </div>
<div class="line">    plus.clear();</div>
<div class="line">    minus.clear();</div>
<div class="line">    plus.reserve(std::distance(it, hi_it));</div>
<div class="line">    minus.reserve(std::distance(it, hi_it));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (; it != hi_it; ++it) {</div>
<div class="line">      <span class="keyword">const</span> <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = (*it)-&gt;getFieldData();</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> &gt; 0)</div>
<div class="line">        plus.push_back((*it)-&gt;getEnt());</div>
<div class="line">      <span class="keywordflow">else</span></div>
<div class="line">        minus.push_back((*it)-&gt;getEnt());</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    plus_range.insert_list(plus.begin(), plus.end());</div>
<div class="line">    minus_range.insert_list(minus.begin(), minus.end());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a id="a275" name="a275"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a>(<span class="stringliteral">&quot;SYNC&quot;</span>);</div>
<div class="line">  <a id="a276" name="a276"></a><a class="code hl_define" href="_log_manager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::noisy, <span class="stringliteral">&quot;FS&quot;</span>)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Plus range &quot;</span> &lt;&lt; plus_range &lt;&lt; endl;</div>
<div class="line">  <a class="code hl_define" href="_log_manager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::noisy, <span class="stringliteral">&quot;FS&quot;</span>)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Minus range &quot;</span> &lt;&lt; minus_range &lt;&lt; endl;</div>
<div class="line">  <a id="a277" name="a277"></a><a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), Sev::noisy);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_elems = [&amp;](<span class="keyword">auto</span> &amp;ents, <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">auto</span> mask) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> adj;</div>
<div class="line">    <a id="a278" name="a278"></a><a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(ents, <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">false</span>, adj,</div>
<div class="line">                                        moab::Interface::UNION),</div>
<div class="line">                   <span class="stringliteral">&quot;can not get adjacencies&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(bit_mng-&gt;filterEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, mask, adj),</div>
<div class="line">                      <span class="stringliteral">&quot;can not filter elements with bit 0&quot;</span>);</div>
<div class="line">    <span class="keywordflow">return</span> adj;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> comm_mng-&gt;synchroniseEntities(plus_range);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> comm_mng-&gt;synchroniseEntities(minus_range);</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;Range&gt; ele_plus(<a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>), ele_minus(<a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>);</div>
<div class="line">  ele_plus[0] = get_elems(plus_range, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(0), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">  ele_minus[0] = get_elems(minus_range, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(0), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">  <span class="keyword">auto</span> common = intersect(ele_plus[0], ele_minus[0]);</div>
<div class="line">  ele_plus[0] = subtract(ele_plus[0], common);</div>
<div class="line">  ele_minus[0] = subtract(ele_minus[0], common);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_children = [&amp;](<span class="keyword">auto</span> &amp;p, <span class="keyword">auto</span> &amp;<a id="a279" name="a279"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;updateRangeByChildren(p, <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>);</div>
<div class="line">    <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a> = <a class="code hl_variable" href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a>.subset_by_dimension(<a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 1; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(get_children(ele_plus[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> - 1], ele_plus[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>]),</div>
<div class="line">                      <span class="stringliteral">&quot;get children&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(get_children(ele_minus[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> - 1], ele_minus[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>]),</div>
<div class="line">                      <span class="stringliteral">&quot;get children&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_level = [&amp;](<span class="keyword">auto</span> &amp;p, <span class="keyword">auto</span> &amp;<a id="a280" name="a280"></a><a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>, <span class="keyword">auto</span> z, <span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <span class="keyword">auto</span> mask) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">        bit_mng-&gt;getEntitiesByDimAndRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, mask, <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>),</div>
<div class="line">        <span class="stringliteral">&quot;can not get vertices on bit&quot;</span>);</div>
<div class="line">    <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = subtract(<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>, p);</div>
<div class="line">    <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = subtract(<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> f = 0; <a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a> != z; ++<a class="code hl_variable" href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">f</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_connectivity(<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>, conn, <span class="keyword">true</span>), <span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(conn);</div>
<div class="line">      <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = get_elems(conn, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, mask);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  std::vector&lt;Range&gt; vec_levels(<a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> - 1; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> &gt;= 0; --<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">    vec_levels[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>] = get_level(ele_plus[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>], ele_minus[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>], 2 * overlap, <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>),</div>
<div class="line">                              <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_variable" href="free__surface_8cpp.html#a6b72e54baf646b08b4b87f987f583dcb">debug</a>) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>() == 1) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 0; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">        std::string name = (boost::format(<span class="stringliteral">&quot;out_r%d.h5m&quot;</span>) % <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>).str();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a281" name="a281"></a><a class="code hl_variable" href="free__surface_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), name, vec_levels[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>]),</div>
<div class="line">                          <span class="stringliteral">&quot;save mesh&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> vec_levels;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#ae8a9be5bb92874beaf3d16d4fab499a6">FreeSurface::refineMesh</a>(<span class="keywordtype">size_t</span> overlap) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bit_mng = <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  BitRefLevel start_mask;</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> s = 0; s != <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>(); ++s)</div>
<div class="line">    start_mask[s] = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// store prev_level</span></div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> prev_level;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()),</div>
<div class="line">                                        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), prev_level);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> prev_level_skin;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line">                                        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), prev_level_skin);</div>
<div class="line">  <span class="comment">// reset bit ref levels</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;lambdaBitRefLevel(</div>
<div class="line">      [&amp;](<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent, BitRefLevel &amp;<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>) { <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a> &amp;= start_mask; });</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(prev_level, <a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(prev_level_skin, <a class="code hl_variable" href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a>(),</div>
<div class="line">                                    <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set refinement levels</span></div>
<div class="line">  <span class="keyword">auto</span> set_levels = [&amp;](<span class="keyword">auto</span> &amp;&amp;</div>
<div class="line">                            vec_levels <span class="comment">/*entities are refined on each level*/</span>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// start with zero level, which is the coarsest mesh</span></div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> level0;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(0), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), level0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(level0, <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get lower dimension entities</span></div>
<div class="line">    <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> ents) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(ents, conn, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;get conn&quot;</span>);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> d = 1; <a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>; ++<a class="code hl_variable" href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">d</a>) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                           ents.subset_by_dimension(<a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>), d, <span class="keyword">false</span>, conn,</div>
<div class="line">                           moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get adj&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      ents.merge(conn);</div>
<div class="line">      <span class="keywordflow">return</span> ents;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set bit levels</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 1; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> level_prev;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByDimAndRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> - 1),</div>
<div class="line">                                                  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line">                                                  <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, level_prev);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> parents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;updateRangeByParent(vec_levels[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>], parents);</div>
<div class="line">      <span class="comment">// subtract entities from previous level, which are refined, so should be</span></div>
<div class="line">      <span class="comment">// not there</span></div>
<div class="line">      level_prev = subtract(level_prev, parents);</div>
<div class="line">      <span class="comment">// and instead add their children</span></div>
<div class="line">      level_prev.merge(vec_levels[<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>]);</div>
<div class="line">      <span class="comment">// set bit to each level</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(level_prev, <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>, <span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set bit levels to lower dimension entities</span></div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 1; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> level;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByDimAndRefLevel(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, level);</div>
<div class="line">      level = get_adj(level);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(level);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(level, <a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>, <span class="keyword">true</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// resolve skin between refined levels</span></div>
<div class="line">  <span class="keyword">auto</span> set_skins = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    moab::Skinner skinner(&amp;<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a id="a282" name="a282"></a><a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get skin of bit level</span></div>
<div class="line">    <span class="keyword">auto</span> get_bit_skin = [&amp;](BitRefLevel <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, BitRefLevel mask) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> bit_ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;<a id="a283" name="a283"></a><a class="code hl_function" href="group__mofem__bit__ref.html#ga539727a53d34c396c8a47f273334350b">getEntitiesByDimAndRefLevel</a>(</div>
<div class="line">              <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, mask, <a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, bit_ents),</div>
<div class="line">          <span class="stringliteral">&quot;can&#39;t get bit level&quot;</span>);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> bit_skin;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(skinner.find_skin(0, bit_ents, <span class="keyword">false</span>, bit_skin),</div>
<div class="line">                     <span class="stringliteral">&quot;can&#39;t get skin&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> bit_skin;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_level_skin = [&amp;]() {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> skin;</div>
<div class="line">      BitRefLevel bit_prev;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 1; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">        <span class="keyword">auto</span> skin_level_mesh = get_bit_skin(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">        <span class="comment">// filter (remove) all entities which are on partitions boarders</span></div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin_level_mesh,</div>
<div class="line">                                     PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                     PSTATUS_NOT, -1, <span class="keyword">nullptr</span>);</div>
<div class="line">        <span class="keyword">auto</span> skin_level =</div>
<div class="line">            get_bit_skin(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set());</div>
<div class="line">        skin_level = subtract(skin_level,</div>
<div class="line">                              skin_level_mesh); <span class="comment">// get only internal skins, not</span></div>
<div class="line">                                                <span class="comment">// on the body boundary</span></div>
<div class="line">        <span class="comment">// get lower dimension adjacencies (FIXME: add edges if 3D)</span></div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> skin_level_verts;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(skin_level, skin_level_verts,</div>
<div class="line">                                                  <span class="keyword">true</span>);</div>
<div class="line">        skin_level.merge(skin_level_verts);</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// remove previous level</span></div>
<div class="line">        bit_prev.set(<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> - 1);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> level_prev;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(bit_prev, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line">                                              level_prev);</div>
<div class="line">        skin.merge(subtract(skin_level, level_prev));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> skin;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> resolve_shared = [&amp;](<span class="keyword">auto</span> &amp;&amp;skin) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> tmp_skin = skin;</div>
<div class="line"> </div>
<div class="line">      map&lt;int, Range&gt; map_procs;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">          tmp_skin, &amp;map_procs);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> from_other_procs; <span class="comment">// entities which also exist on other processors</span></div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map_procs) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first != <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a id="a284" name="a284"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) {</div>
<div class="line">          from_other_procs.merge(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second);</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> common = intersect(</div>
<div class="line">          skin, from_other_procs); <span class="comment">// entities which are on internal skin</span></div>
<div class="line">      skin.merge(from_other_procs);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// entities which are on processors boards, and several processors are not</span></div>
<div class="line">      <span class="comment">// true skin.</span></div>
<div class="line">      <span class="keywordflow">if</span> (!common.empty()) {</div>
<div class="line">        <span class="comment">// skin is internal exist on other procs</span></div>
<div class="line">        skin = subtract(skin, common);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> skin;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get parents of entities</span></div>
<div class="line">    <span class="keyword">auto</span> get_parent_level_skin = [&amp;](<span class="keyword">auto</span> skin) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> skin_parents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;updateRangeByParent(</div>
<div class="line">          skin.subset_by_dimension(<a class="code hl_variable" href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), skin_parents);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> skin_parent_verts;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(skin_parents, skin_parent_verts,</div>
<div class="line">                                                <span class="keyword">true</span>);</div>
<div class="line">      skin_parents.merge(skin_parent_verts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">          skin_parents);</div>
<div class="line">      <span class="keywordflow">return</span> skin_parents;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> child_skin = resolve_shared(get_level_skin());</div>
<div class="line">    <span class="keyword">auto</span> parent_skin = get_parent_level_skin(child_skin);</div>
<div class="line"> </div>
<div class="line">    child_skin = subtract(child_skin, parent_skin);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(child_skin, <a class="code hl_variable" href="free__surface_8cpp.html#ac6bfdcdc75a76c6e1aa9c176ab98d5ef">get_skin_child_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(parent_skin, <a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// take last level, remove childs on boarder, and set bit</span></div>
<div class="line">  <span class="keyword">auto</span> set_current = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> last_level;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a> - 1),</div>
<div class="line">                                          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), last_level);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> skin_child;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByRefLevel(<a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ac6bfdcdc75a76c6e1aa9c176ab98d5ef">get_skin_child_bit</a>()),</div>
<div class="line">                                          <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), skin_child);</div>
<div class="line"> </div>
<div class="line">    last_level = subtract(last_level, skin_child);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;setNthBitRefLevel(last_level, <a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>(), <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set bits to levels</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_levels(<a class="code hl_function" href="struct_free_surface.html#aa6539a6215159c2c4df22edf4442f70f">findEntitiesCrossedByPhaseInterface</a>(overlap));</div>
<div class="line">  <span class="comment">// set bits to skin</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_skins();</div>
<div class="line">  <span class="comment">// set current level bit</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_current();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (<a class="code hl_variable" href="free__surface_8cpp.html#a6b72e54baf646b08b4b87f987f583dcb">debug</a>) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>() == 1) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> = 0; <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a> != <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>; ++<a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>) {</div>
<div class="line">        std::string name = (boost::format(<span class="stringliteral">&quot;out_level%d.h5m&quot;</span>) % <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>).str();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;writeBitLevel(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a>() + <a class="code hl_variable" href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a>),</div>
<div class="line">                                      <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), name.c_str(), <span class="stringliteral">&quot;MOAB&quot;</span>,</div>
<div class="line">                                      <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;writeBitLevel(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()),</div>
<div class="line">                                    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <span class="stringliteral">&quot;current_bit.h5m&quot;</span>,</div>
<div class="line">                                    <span class="stringliteral">&quot;MOAB&quot;</span>, <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;writeBitLevel(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a>()),</div>
<div class="line">                                    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <span class="stringliteral">&quot;projection_bit.h5m&quot;</span>,</div>
<div class="line">                                    <span class="stringliteral">&quot;MOAB&quot;</span>, <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;writeBitLevel(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="free__surface_8cpp.html#ac6bfdcdc75a76c6e1aa9c176ab98d5ef">get_skin_child_bit</a>()),</div>
<div class="line">                                    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <span class="stringliteral">&quot;skin_child_bit.h5m&quot;</span>,</div>
<div class="line">                                    <span class="stringliteral">&quot;MOAB&quot;</span>, <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;writeBitLevel(<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(<a class="code hl_variable" href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a>()),</div>
<div class="line">                                    <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <span class="stringliteral">&quot;skin_parent_bit.h5m&quot;</span>,</div>
<div class="line">                                    <span class="stringliteral">&quot;MOAB&quot;</span>, <span class="stringliteral">&quot;PARALLEL=WRITE_PART&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">FreeSurface::setParentDofs</a>(</div>
<div class="line">    boost::shared_ptr&lt;FEMethod&gt; fe_top, std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">    ForcesAndSourcesCore::UserDataOperator::OpType op,</div>
<div class="line">    BitRefLevel child_ent_bit,</div>
<div class="line">    boost::function&lt;boost::shared_ptr&lt;ForcesAndSourcesCore&gt;()&gt; get_elem,</div>
<div class="line">    <span class="keywordtype">int</span> verbosity, <a class="code hl_enumeration" href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">LogManager::SeverityLevel</a> sev) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /**</span></div>
<div class="line"><span class="comment">   * @brief Collect data from parent elements to child</span></div>
<div class="line"><span class="comment">   */</span></div>
<div class="line">  boost::function&lt;void(boost::shared_ptr&lt;ForcesAndSourcesCore&gt;, <span class="keywordtype">int</span>)&gt;</div>
<div class="line">      add_parent_level =</div>
<div class="line">          [&amp;](boost::shared_ptr&lt;ForcesAndSourcesCore&gt; parent_fe_pt, <span class="keywordtype">int</span> level) {</div>
<div class="line">            <span class="comment">// Evaluate if not last parent element</span></div>
<div class="line">            <span class="keywordflow">if</span> (level &gt; 0) {</div>
<div class="line"> </div>
<div class="line">              <span class="comment">// Create domain parent FE</span></div>
<div class="line">              <span class="keyword">auto</span> fe_ptr_current = get_elem();</div>
<div class="line"> </div>
<div class="line">              <span class="comment">// Call next level</span></div>
<div class="line">              add_parent_level(</div>
<div class="line">                  boost::dynamic_pointer_cast&lt;ForcesAndSourcesCore&gt;(</div>
<div class="line">                      fe_ptr_current),</div>
<div class="line">                  level - 1);</div>
<div class="line"> </div>
<div class="line">              <span class="comment">// Add data to curent fe level</span></div>
<div class="line">              <span class="keywordflow">if</span> (op == ForcesAndSourcesCore::UserDataOperator::OPSPACE) {</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Only base</span></div>
<div class="line">                parent_fe_pt-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">new</span> <a id="_a285" name="_a285"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_add_parent_ent_data.html">OpAddParentEntData</a>(</div>
<div class="line"> </div>
<div class="line">                        <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, op, fe_ptr_current,</div>
<div class="line"> </div>
<div class="line">                        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"> </div>
<div class="line">                        child_ent_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"> </div>
<div class="line">                        verbosity, sev));</div>
<div class="line"> </div>
<div class="line">              } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Filed data</span></div>
<div class="line">                parent_fe_pt-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_add_parent_ent_data.html">OpAddParentEntData</a>(</div>
<div class="line"> </div>
<div class="line">                        <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, op, fe_ptr_current,</div>
<div class="line"> </div>
<div class="line">                        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"> </div>
<div class="line">                        child_ent_bit, <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(),</div>
<div class="line"> </div>
<div class="line">                        verbosity, sev));</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">  add_parent_level(boost::dynamic_pointer_cast&lt;ForcesAndSourcesCore&gt;(fe_top),</div>
<div class="line">                   <a class="code hl_variable" href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a8711d535a7c4e3c854da590188f734e8">TSPrePostProc::tsPreProc</a>(TS ts) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a id="a286" name="a286"></a><a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">    /**</span></div>
<div class="line"><span class="comment">     * @brief cut-off values at nodes, i.e. abs(&quot;H&quot;) &lt;= 1</span></div>
<div class="line"><span class="comment">     *</span></div>
<div class="line"><span class="comment">     */</span></div>
<div class="line">    <span class="keyword">auto</span> cut_off_dofs = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> &amp;m_field = ptr-&gt;fsRawPtr-&gt;mField;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> current_verts;</div>
<div class="line">      <span class="keyword">auto</span> bit_mng = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bit_mng-&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>(<a class="code hl_variable" href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a>()), <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">BitRefLevel</a>().set(), MBVERTEX, current_verts);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> cut_off_verts = [&amp;](boost::shared_ptr&lt;FieldEntity&gt; ent_ptr) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> : ent_ptr-&gt;getEntFieldData()) {</div>
<div class="line">          <a class="code hl_variable" href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a> = <a class="code hl_variable" href="free__surface_8cpp.html#ac52e9f0bda51760b1ff6367d5cdbe0a6">cut_off</a>(<a class="code hl_variable" href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a>);</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> field_blas = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_field_blas.html">FieldBlas</a>&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> field_blas-&gt;fieldLambdaOnEntities(cut_off_verts, <span class="stringliteral">&quot;H&quot;</span>,</div>
<div class="line">                                               &amp;current_verts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> cut_off_dofs();</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Run step pre proc&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = ptr-&gt;fsRawPtr-&gt;mField;</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// get vector norm</span></div>
<div class="line">    <span class="keyword">auto</span> get_norm = [&amp;](<span class="keyword">auto</span> x) {</div>
<div class="line">      <span class="keywordtype">double</span> nrm;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(x, NORM_2, &amp;nrm);</div>
<div class="line">      <span class="keywordflow">return</span> nrm;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// refine problem and project data, including theta data</span></div>
<div class="line">    <span class="keyword">auto</span> refine_problem = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Refine problem&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ptr-&gt;fsRawPtr-&gt;refineMesh(<a class="code hl_variable" href="free__surface_8cpp.html#ab9ee1c6b1a408c8680179d21cd3ec51f">refine_overlap</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ptr-&gt;fsRawPtr-&gt;projectData();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set new jacobin operator, since problem and thus tangent matrix size has</span></div>
<div class="line">    <span class="comment">// changed</span></div>
<div class="line">    <span class="keyword">auto</span> set_jacobian_operators = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      ptr-&gt;subB = <a id="a287" name="a287"></a><a class="code hl_function" href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">createDMMatrix</a>(ptr-&gt;solverSubDM);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPReset(ptr-&gt;subKSP);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// set new solution</span></div>
<div class="line">    <span class="keyword">auto</span> set_solution = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Set solution&quot;</span>;</div>
<div class="line"> </div>
<div class="line">      PetscObjectState state;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Record the state, and set it again. This is to fool PETSc that solution</span></div>
<div class="line">      <span class="comment">// vector is not updated. Otherwise PETSc will treat every step as a first</span></div>
<div class="line">      <span class="comment">// step.</span></div>
<div class="line"> </div>
<div class="line">      <span class="comment">// globSol is updated as result mesh refinement -  this is not really set</span></div>
<div class="line">      <span class="comment">// a new solution.</span></div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscObjectStateGet(<a id="a288" name="a288"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#ac66ae807ded4ad510b8be2f40d9e125a">getPetscObject</a>(ptr-&gt;globSol.get()), &amp;state);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(<a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM(), ptr-&gt;globSol,</div>
<div class="line">                                     INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscObjectStateSet(<a class="code hl_function" href="namespace_mo_f_e_m.html#ac66ae807ded4ad510b8be2f40d9e125a">getPetscObject</a>(ptr-&gt;globSol.get()), state);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Set solution, vector norm &quot;</span> &lt;&lt; get_norm(ptr-&gt;globSol);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    PetscBool is_theta;</div>
<div class="line">    PetscObjectTypeCompare((PetscObject)ts, TSTHETA, &amp;is_theta);</div>
<div class="line">    <span class="keywordflow">if</span> (is_theta) {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine_problem();         <span class="comment">// refine problem</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_jacobian_operators(); <span class="comment">// set new jacobian</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_solution();           <span class="comment">// set solution</span></div>
<div class="line"> </div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      SETERRQ(PETSC_COMM_WORLD, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>,</div>
<div class="line">              <span class="stringliteral">&quot;Sorry, only TSTheta handling is implemented&quot;</span>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Need barriers, somme functions in TS solver need are called collectively</span></div>
<div class="line">    <span class="comment">// and requite the same state of variables</span></div>
<div class="line">    PetscBarrier((PetscObject)ts);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a>(<span class="stringliteral">&quot;SYNC&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="_log_manager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::verbose, <span class="stringliteral">&quot;FS&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;PreProc done&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), Sev::verbose);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#ac81a85e08d887a61d720779da1640e45">TSPrePostProc::tsPostProc</a>(TS ts) {</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = ptr-&gt;fsRawPtr-&gt;mField;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a>(<span class="stringliteral">&quot;SYNC&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="_log_manager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::verbose, <span class="stringliteral">&quot;FS&quot;</span>) &lt;&lt; <span class="stringliteral">&quot;PostProc done&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), Sev::verbose);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#ab6aae3ab3d56525658dadea33e1f6129">TSPrePostProc::tsSetIFunction</a>(TS ts, PetscReal <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, Vec u, Vec u_t,</div>
<div class="line">                                             Vec f, <span class="keywordtype">void</span> *ctx) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <span class="keyword">auto</span> sub_u = ptr-&gt;getSubVector();</div>
<div class="line">    <span class="keyword">auto</span> sub_u_t = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(sub_u);</div>
<div class="line">    <span class="keyword">auto</span> sub_f = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(sub_u);</div>
<div class="line">    <span class="keyword">auto</span> scatter = ptr-&gt;getScatter(sub_u, u, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> apply_scatter_and_update = [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> sub_x) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterBegin(scatter, x, sub_x, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterEnd(scatter, x, sub_x, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(sub_x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(sub_x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> apply_scatter_and_update(u, sub_u);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> apply_scatter_and_update(u_t, sub_u_t);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a289" name="a289"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a65f22030e64fd429012bf8f0f025d9a1">TsSetIFunction</a>(ts, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, sub_u, sub_u_t, sub_f, ptr-&gt;tsCtxPtr.get());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterBegin(scatter, sub_f, f, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterEnd(scatter, sub_f, f, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a78cc980454599ea5b44b2252e3f5d067">TSPrePostProc::tsSetIJacobian</a>(TS ts, PetscReal <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, Vec u, Vec u_t,</div>
<div class="line">                                             PetscReal <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, Mat A, Mat <a class="code hl_class" href="class_b.html">B</a>,</div>
<div class="line">                                             <span class="keywordtype">void</span> *ctx) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <span class="keyword">auto</span> sub_u = ptr-&gt;getSubVector();</div>
<div class="line">    <span class="keyword">auto</span> sub_u_t = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(sub_u);</div>
<div class="line">    <span class="keyword">auto</span> scatter = ptr-&gt;getScatter(sub_u, u, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> apply_scatter_and_update = [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> sub_x) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterBegin(scatter, x, sub_x, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterEnd(scatter, x, sub_x, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(sub_x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(sub_x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> apply_scatter_and_update(u, sub_u);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> apply_scatter_and_update(u_t, sub_u_t);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a290" name="a290"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a12477157e716aece7dd7b3e316fef7a3">TsSetIJacobian</a>(ts, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, sub_u, sub_u_t, <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, ptr-&gt;subB, ptr-&gt;subB,</div>
<div class="line">                          ptr-&gt;tsCtxPtr.get());</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a5f73ef09d0d6bee6da2efe31de1bb91a">TSPrePostProc::tsMonitor</a>(TS ts, PetscInt step, PetscReal <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>,</div>
<div class="line">                                        Vec u, <span class="keywordtype">void</span> *ctx) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <span class="keyword">auto</span> get_norm = [&amp;](<span class="keyword">auto</span> x) {</div>
<div class="line">      <span class="keywordtype">double</span> nrm;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecNorm(x, NORM_2, &amp;nrm);</div>
<div class="line">      <span class="keywordflow">return</span> nrm;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> sub_u = ptr-&gt;getSubVector();</div>
<div class="line">    <span class="keyword">auto</span> scatter = ptr-&gt;getScatter(sub_u, u, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterBegin(scatter, u, sub_u, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterEnd(scatter, u, sub_u, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(sub_u, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(sub_u, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;u norm &quot;</span> &lt;&lt; get_norm(u) &lt;&lt; <span class="stringliteral">&quot; u sub nom &quot;</span> &lt;&lt; get_norm(sub_u);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a291" name="a291"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a1654dd29ff9af437332ec55af104ff48">TsMonitorSet</a>(ts, step, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, sub_u, ptr-&gt;tsCtxPtr.get());</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#abda9f1a13eb25322d633155cbd0402eb">TSPrePostProc::pcSetup</a>(PC pc) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;SetUP sub PC&quot;</span>;</div>
<div class="line">    ptr-&gt;subKSP = <a id="a292" name="a292"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a10bae3a5a92d97274ffdd4b5d3ed5c0e">createKSP</a>(ptr-&gt;fsRawPtr-&gt;mField.get_comm());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(ptr-&gt;subKSP);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a65c9fdb310ee9855607e8f3ec6e805db">TSPrePostProc::pcApply</a>(PC pc, Vec pc_f, Vec pc_x) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <span class="keyword">auto</span> sub_x = ptr-&gt;getSubVector();</div>
<div class="line">    <span class="keyword">auto</span> sub_f = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(sub_x);</div>
<div class="line">    <span class="keyword">auto</span> scatter = ptr-&gt;getScatter(sub_x, pc_x, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterBegin(scatter, pc_f, sub_f, INSERT_VALUES,</div>
<div class="line">                           SCATTER_REVERSE);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterEnd(scatter, pc_f, sub_f, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetOperators(ptr-&gt;subKSP, ptr-&gt;subB, ptr-&gt;subB);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;PCShell solve&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(ptr-&gt;subKSP, sub_f, sub_x);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;FS&quot;</span>, Sev::verbose) &lt;&lt; <span class="stringliteral">&quot;PCShell solve &lt;- done&quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterBegin(scatter, sub_x, pc_x, INSERT_VALUES,</div>
<div class="line">                           SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScatterEnd(scatter, sub_x, pc_x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a7098c3f3aa8ebc6c31c87caed0dcce29">TSPrePostProc::getScatter</a>(Vec x, Vec y, <span class="keyword">enum</span> <a class="code hl_enumeration" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84">FR</a> fr) {</div>
<div class="line">  <span class="keywordflow">if</span> (<span class="keyword">auto</span> ptr = <a class="code hl_variable" href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a>.lock()) {</div>
<div class="line">    <span class="keyword">auto</span> prb_ptr = ptr-&gt;fsRawPtr-&gt;mField.get_problem(<span class="stringliteral">&quot;SUB_SOLVER&quot;</span>);</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> sub_data = prb_ptr-&gt;getSubData()) {</div>
<div class="line">      <span class="keyword">auto</span> is = sub_data-&gt;getSmartColIs();</div>
<div class="line">      VecScatter s;</div>
<div class="line">      <span class="keywordflow">if</span> (fr == <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a>) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(VecScatterCreate(x, PETSC_NULL, y, is, &amp;s),</div>
<div class="line">                          <span class="stringliteral">&quot;crate scatter&quot;</span>);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(VecScatterCreate(x, is, y, PETSC_NULL, &amp;s),</div>
<div class="line">                          <span class="stringliteral">&quot;crate scatter&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a>(s);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a293" name="a293"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No prb pinter&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;VecScatter&gt;</a>();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a55a9f26c6211f55d1b267f5766d45cb4">TSPrePostProc::getSubVector</a>() {</div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a76a5770ed5d62aafbd7d06cce02d31ae">solverSubDM</a>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_t_s_pre_post_proc.html#aef485703101f9710430c3288f65d37ad">TSPrePostProc::tsSetUp</a>(TS ts) {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> &amp;m_field = <a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a42c0ddb4765f16b94923b46aeb258b5a">fsRawPtr</a>-&gt;<a id="a294" name="a294"></a><a class="code hl_variable" href="struct_example.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>;</div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a> = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_simple.html">Simple</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> dm = <a class="code hl_function" href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a>-&gt;getDM();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a2d152ba57407eedcc035262b813171e8">globRes</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a3f680d202782ea9ba9fd7fef764359ad">globSol</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIFunction(ts, <a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a2d152ba57407eedcc035262b813171e8">globRes</a>, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#ab6aae3ab3d56525658dadea33e1f6129">tsSetIFunction</a>, <span class="keyword">nullptr</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetIJacobian(ts, PETSC_NULL, PETSC_NULL, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a78cc980454599ea5b44b2252e3f5d067">tsSetIJacobian</a>, <span class="keyword">nullptr</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a5f73ef09d0d6bee6da2efe31de1bb91a">tsMonitor</a>, <a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a42c0ddb4765f16b94923b46aeb258b5a">fsRawPtr</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  SNES snes;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">  <span class="keyword">auto</span> snes_ctx_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#addce2077b77e610d248ae548a01e77e3">getDMSnesCtx</a>(dm);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_section_monitor = [&amp;](<span class="keyword">auto</span> snes) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(snes,</div>
<div class="line">                          (<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal,</div>
<div class="line">                                             <span class="keywordtype">void</span> *))<a class="code hl_function" href="namespace_mo_f_e_m.html#a37c8aa74d57ef9fcf60e6c508b987113">MoFEMSNESMonitorFields</a>,</div>
<div class="line">                          (<span class="keywordtype">void</span> *)(snes_ctx_ptr.get()), <span class="keyword">nullptr</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section_monitor(snes);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> ksp = <a class="code hl_function" href="namespace_mo_f_e_m.html#a10bae3a5a92d97274ffdd4b5d3ed5c0e">createKSP</a>(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetType(ksp, KSPPREONLY); <span class="comment">// Run KSP internally in ShellPC</span></div>
<div class="line">  <span class="keyword">auto</span> sub_pc = <a id="a295" name="a295"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a93d0c64e0863847d28ef4248b8dad31c">createPC</a>(<a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a42c0ddb4765f16b94923b46aeb258b5a">fsRawPtr</a>-&gt;<a class="code hl_variable" href="struct_example.html#ab79afebe5c16553d0c38e3ec022f868f">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCSetType(sub_pc, PCSHELL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCShellSetSetUp(sub_pc, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#abda9f1a13eb25322d633155cbd0402eb">pcSetup</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PCShellSetApply(sub_pc, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a65c9fdb310ee9855607e8f3ec6e805db">pcApply</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetPC(ksp, sub_pc);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESSetKSP(snes, ksp);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a86adf30485426c053d1c4cb45e134ed2">snesCtxPtr</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#addce2077b77e610d248ae548a01e77e3">getDMSnesCtx</a>(<a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a76a5770ed5d62aafbd7d06cce02d31ae">solverSubDM</a>);</div>
<div class="line">  <a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a019ad880bca1112380d99d65cabcdc83">tsCtxPtr</a> = <a id="a296" name="a296"></a><a class="code hl_function" href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(<a class="code hl_variable" href="struct_t_s_pre_post_proc.html#a76a5770ed5d62aafbd7d06cce02d31ae">solverSubDM</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPreStep(ts, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#a8711d535a7c4e3c854da590188f734e8">tsPreProc</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, <a class="code hl_function" href="struct_t_s_pre_post_proc.html#ac81a85e08d887a61d720779da1640e45">tsPostProc</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="ttc" id="a_free_surface_ops_8hpp_html"><div class="ttname"><a href="_free_surface_ops_8hpp.html">FreeSurfaceOps.hpp</a></div></div>
<div class="ttc" id="a_log_manager_8hpp_html_a3b22f6000e678d07d69a2c790177a352"><div class="ttname"><a href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a></div><div class="ttdeci">#define MOFEM_LOG_SEVERITY_SYNC(comm, severity)</div><div class="ttdoc">Synchronise &quot;SYNC&quot; on curtain severity level.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00352">LogManager.hpp:352</a></div></div>
<div class="ttc" id="a_log_manager_8hpp_html_afebc04c745581aa8f72c6ace26073f6c"><div class="ttname"><a href="_log_manager_8hpp.html#afebc04c745581aa8f72c6ace26073f6c">MOFEM_TAG_AND_LOG</a></div><div class="ttdeci">#define MOFEM_TAG_AND_LOG(channel, severity, tag)</div><div class="ttdoc">Tag and log in channel.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00362">LogManager.hpp:362</a></div></div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="aacoustic_8cpp_html_ad68ed57e17c71816ecfad0ea6746c8d3"><div class="ttname"><a href="acoustic_8cpp.html#ad68ed57e17c71816ecfad0ea6746c8d3">simple</a></div><div class="ttdeci">void simple(double P1[], double P2[], double P3[], double c[], const int N)</div><div class="ttdef"><b>Definition</b> <a href="acoustic_8cpp_source.html#l00069">acoustic.cpp:69</a></div></div>
<div class="ttc" id="aactivate__deactivate__dofs_8cpp_html_a29680e68c64040f4884f60691a193226"><div class="ttname"><a href="activate__deactivate__dofs_8cpp.html#a29680e68c64040f4884f60691a193226">help</a></div><div class="ttdeci">static char help[]</div><div class="ttdef"><b>Definition</b> <a href="activate__deactivate__dofs_8cpp_source.html#l00013">activate_deactivate_dofs.cpp:13</a></div></div>
<div class="ttc" id="aadol-c__atom_8cpp_html_ae66f6b31b5ad750f1fe042a706a4e3d4"><div class="ttname"><a href="adol-c__atom_8cpp.html#ae66f6b31b5ad750f1fe042a706a4e3d4">main</a></div><div class="ttdeci">int main()</div><div class="ttdef"><b>Definition</b> <a href="adol-c__atom_8cpp_source.html#l00046">adol-c_atom.cpp:46</a></div></div>
<div class="ttc" id="aadolc__plasticity_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="adolc__plasticity_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition</b> <a href="adolc__plasticity_8cpp_source.html#l00014">adolc_plasticity.cpp:14</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="acheck__base__functions__derivatives__on__tet_8cpp_html_a3d8c24629d725b9ef8c238cf27c9b158"><div class="ttname"><a href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a></div><div class="ttdeci">static const double eps</div><div class="ttdef"><b>Definition</b> <a href="check__base__functions__derivatives__on__tet_8cpp_source.html#l00011">check_base_functions_derivatives_on_tet.cpp:11</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a171672db6f0eaebc9fd8616aaeb542fe"><div class="ttname"><a href="child__and__parent_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryParentEle BoundaryParentEle</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00041">child_and_parent.cpp:41</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a81eee41c11480cdc68dc9e63bef4e113"><div class="ttname"><a href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryEle BoundaryEle</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00039">child_and_parent.cpp:39</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_ac94bc5f632538c35d02cd487d55b31d2"><div class="ttname"><a href="child__and__parent_8cpp.html#ac94bc5f632538c35d02cd487d55b31d2">DomainEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::DomainEle DomainEle</div><div class="ttdoc">[Define dimension]</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00034">child_and_parent.cpp:34</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_afcd75ab2301efeac675f87f3ba9d00f4"><div class="ttname"><a href="child__and__parent_8cpp.html#afcd75ab2301efeac675f87f3ba9d00f4">BoundaryEleOp</a></div><div class="ttdeci">BoundaryEle::UserDataOperator BoundaryEleOp</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00040">child_and_parent.cpp:40</a></div></div>
<div class="ttc" id="aclass_b_html"><div class="ttname"><a href="class_b.html">B</a></div></div>
<div class="ttc" id="aclass_bi_linear_form_html"><div class="ttname"><a href="class_bi_linear_form.html">BiLinearForm</a></div></div>
<div class="ttc" id="aclass_boundary_ele_op_html"><div class="ttname"><a href="class_boundary_ele_op.html">BoundaryEleOp</a></div></div>
<div class="ttc" id="aclass_domain_ele_op_html"><div class="ttname"><a href="class_domain_ele_op.html">DomainEleOp</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_f_e_method_html"><div class="ttname"><a href="class_f_e_method.html">FEMethod</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_ddg_html"><div class="ttname"><a href="class_f_tensor_1_1_ddg.html">FTensor::Ddg</a></div><div class="ttdef"><b>Definition</b> <a href="_ddg__value_8hpp_source.html#l00007">Ddg_value.hpp:8</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_index_html"><div class="ttname"><a href="class_f_tensor_1_1_index.html">FTensor::Index</a></div><div class="ttdef"><b>Definition</b> <a href="_index_8hpp_source.html#l00023">Index.hpp:24</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_kronecker___delta__symmetric_html"><div class="ttname"><a href="class_f_tensor_1_1_kronecker___delta__symmetric.html">FTensor::Kronecker_Delta_symmetric</a></div><div class="ttdoc">Kronecker Delta class symmetric.</div><div class="ttdef"><b>Definition</b> <a href="_kronecker___delta_8hpp_source.html#l00049">Kronecker_Delta.hpp:49</a></div></div>
<div class="ttc" id="aclass_linear_form_html"><div class="ttname"><a href="class_linear_form.html">LinearForm</a></div></div>
<div class="ttc" id="aclass_op_calculate_vector_field_gradient_html"><div class="ttname"><a href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a1e74d797bf522e2b291419cddab27835"><div class="ttname"><a href="definitions_8h.html#a1e74d797bf522e2b291419cddab27835">CATCH_ERRORS</a></div><div class="ttdeci">#define CATCH_ERRORS</div><div class="ttdoc">Catch errors.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00385">definitions.h:385</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base nme:nme847.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a3b43531d53059927f420c79cf954561a"><div class="ttname"><a href="definitions_8h.html#a3b43531d53059927f420c79cf954561a">BITREFLEVEL_SIZE</a></div><div class="ttdeci">#define BITREFLEVEL_SIZE</div><div class="ttdoc">max number of refinements</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00232">definitions.h:232</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00609">definitions.h:609</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a870cba1f12f133e280384cbaffdeec0f">NOSPACE</a></div><div class="ttdeci">@ NOSPACE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00083">definitions.h:83</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a793899f524a281eb88e3ff2b01ce6acb"><div class="ttname"><a href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a></div><div class="ttdeci">#define CHK_MOAB_THROW(err, msg)</div><div class="ttdoc">Check error code of MoAB function and throw MoFEM exception.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00589">definitions.h:589</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaa4d3788e72b298f5fc901644e3f1ad95">MOFEM_OPERATION_UNSUCCESSFUL</a></div><div class="ttdeci">@ MOFEM_OPERATION_UNSUCCESSFUL</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00034">definitions.h:34</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaded6d08fa6d0cd6d9b116fac8318c262">MOFEM_INVALID_DATA</a></div><div class="ttdeci">@ MOFEM_INVALID_DATA</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00036">definitions.h:36</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a></div><div class="ttdeci">@ MOFEM_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00032">definitions.h:32</a></div></div>
<div class="ttc" id="adefinitions_8h_html_ab13c3333360effa7b18858a010a79cf6a340b797fa39cddc215962bea367322c1"><div class="ttname"><a href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6a340b797fa39cddc215962bea367322c1">LAST_COORDINATE_SYSTEM</a></div><div class="ttdeci">@ LAST_COORDINATE_SYSTEM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00133">definitions.h:132</a></div></div>
<div class="ttc" id="adefinitions_8h_html_ab13c3333360effa7b18858a010a79cf6a8bcf3ac927052dfa8318c1fb96c4ad10"><div class="ttname"><a href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6a8bcf3ac927052dfa8318c1fb96c4ad10">CYLINDRICAL</a></div><div class="ttdeci">@ CYLINDRICAL</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00130">definitions.h:130</a></div></div>
<div class="ttc" id="adefinitions_8h_html_ab13c3333360effa7b18858a010a79cf6ad0f64430e58c5010eddd5289ab519800"><div class="ttname"><a href="definitions_8h.html#ab13c3333360effa7b18858a010a79cf6ad0f64430e58c5010eddd5289ab519800">CARTESIAN</a></div><div class="ttdeci">@ CARTESIAN</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00128">definitions.h:128</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_a87778f5f0ec7eba11e8f327af2258018"><div class="ttname"><a href="dg__projection_8cpp.html#a87778f5f0ec7eba11e8f327af2258018">BASE_DIM</a></div><div class="ttdeci">constexpr int BASE_DIM</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00015">dg_projection.cpp:15</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_a06a735b6649ab72b1c55b0c3e4ace878"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#a06a735b6649ab72b1c55b0c3e4ace878">PostProcEleDomain</a></div><div class="ttdeci">PostProcEleByDim&lt; SPACE_DIM &gt;::PostProcEleDomain PostProcEleDomain</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00052">dynamic_first_order_con_law.cpp:52</a></div></div>
<div class="ttc" id="adynamic__first__order__con__law_8cpp_html_a180e8dc30b1bcbf079462587049cd156"><div class="ttname"><a href="dynamic__first__order__con__law_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a></div><div class="ttdeci">static boost::weak_ptr&lt; TSPrePostProc &gt; tsPrePostProc</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00404">dynamic_first_order_con_law.cpp:404</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a00652cce88aea3f2b6f196c27be2094b"><div class="ttname"><a href="free__surface_8cpp.html#a00652cce88aea3f2b6f196c27be2094b">cylindrical</a></div><div class="ttdeci">auto cylindrical</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00189">free_surface.cpp:189</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a05ac5235b52a827a368e74ed228dd485"><div class="ttname"><a href="free__surface_8cpp.html#a05ac5235b52a827a368e74ed228dd485">kappa</a></div><div class="ttdeci">double kappa</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00185">free_surface.cpp:185</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a05fa1e48e6fb969147b13b55dacbd2e9"><div class="ttname"><a href="free__surface_8cpp.html#a05fa1e48e6fb969147b13b55dacbd2e9">OpDomainMassU</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpMass&lt; BASE_DIM, U_FIELD_DIM &gt; OpDomainMassU</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00109">free_surface.cpp:109</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a0befa2aa45cf04b37afaae9b9d032eb6"><div class="ttname"><a href="free__surface_8cpp.html#a0befa2aa45cf04b37afaae9b9d032eb6">bubble_device</a></div><div class="ttdeci">auto bubble_device</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00286">free_surface.cpp:286</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a0befd7944c7ed7e9373b2e2c2fb7d338"><div class="ttname"><a href="free__surface_8cpp.html#a0befd7944c7ed7e9373b2e2c2fb7d338">mu_diff</a></div><div class="ttdeci">double mu_diff</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00183">free_surface.cpp:183</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a11853fc6dfa8d79a1adb95c8c02626c9"><div class="ttname"><a href="free__surface_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a></div><div class="ttdeci">auto save_range</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00326">free_surface.cpp:326</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a126ba8fcdbf289259612be39d3b4fab8"><div class="ttname"><a href="free__surface_8cpp.html#a126ba8fcdbf289259612be39d3b4fab8">get_M2</a></div><div class="ttdeci">auto get_M2</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00229">free_surface.cpp:229</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a141ea5cd379b49e5fa78f0dd95c7a635"><div class="ttname"><a href="free__surface_8cpp.html#a141ea5cd379b49e5fa78f0dd95c7a635">U_FIELD_DIM</a></div><div class="ttdeci">constexpr int U_FIELD_DIM</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00081">free_surface.cpp:81</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a171672db6f0eaebc9fd8616aaeb542fe"><div class="ttname"><a href="free__surface_8cpp.html#a171672db6f0eaebc9fd8616aaeb542fe">BoundaryParentEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryParentEle BoundaryParentEle</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00094">free_surface.cpp:94</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a180e8dc30b1bcbf079462587049cd156"><div class="ttname"><a href="free__surface_8cpp.html#a180e8dc30b1bcbf079462587049cd156">tsPrePostProc</a></div><div class="ttdeci">static boost::weak_ptr&lt; TSPrePostProc &gt; tsPrePostProc</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00469">free_surface.cpp:469</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a2460ec9dbd7f7522e7ce4981c744ca4b"><div class="ttname"><a href="free__surface_8cpp.html#a2460ec9dbd7f7522e7ce4981c744ca4b">get_M2_dh</a></div><div class="ttdeci">auto get_M2_dh</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00233">free_surface.cpp:233</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a271f46dff095cfa001adf659298f195d"><div class="ttname"><a href="free__surface_8cpp.html#a271f46dff095cfa001adf659298f195d">OpBoundaryMassL</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpMass&lt; BASE_DIM, 1 &gt; OpBoundaryMassL</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00115">free_surface.cpp:115</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84">FR</a></div><div class="ttdeci">FR</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84a1784b1a3d7cbd43c45ff82c72d05e4ae">R</a></div><div class="ttdeci">@ R</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a28f0c075108bbb02a47f54fccb48ea1a"><div class="ttname"><a href="free__surface_8cpp.html#a28f0c075108bbb02a47f54fccb48ea1a">integration_rule</a></div><div class="ttdeci">auto integration_rule</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00187">free_surface.cpp:187</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a308677c5b6f6cf47ab407f3a6bcc6949"><div class="ttname"><a href="free__surface_8cpp.html#a308677c5b6f6cf47ab407f3a6bcc6949">get_M_dh</a></div><div class="ttdeci">auto get_M_dh</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00252">free_surface.cpp:252</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a320d55c79de3bfd842fc427d83450f3f"><div class="ttname"><a href="free__surface_8cpp.html#a320d55c79de3bfd842fc427d83450f3f">kernel_eye</a></div><div class="ttdeci">auto kernel_eye</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00272">free_surface.cpp:272</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a3c19989a9262ec68cb63da9cd095cb47"><div class="ttname"><a href="free__surface_8cpp.html#a3c19989a9262ec68cb63da9cd095cb47">mu_m</a></div><div class="ttdeci">double mu_m</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00164">free_surface.cpp:164</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="free__surface_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">double lambda</div><div class="ttdoc">surface tension</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00167">free_surface.cpp:167</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a3dee636d734a20d33cf10323c629d5da"><div class="ttname"><a href="free__surface_8cpp.html#a3dee636d734a20d33cf10323c629d5da">PostProcEleDomainCont</a></div><div class="ttdeci">PostProcBrokenMeshInMoabBaseCont&lt; DomainEle &gt; PostProcEleDomainCont</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00100">free_surface.cpp:100</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a4684744887622bc40ac4d5def27344e2"><div class="ttname"><a href="free__surface_8cpp.html#a4684744887622bc40ac4d5def27344e2">OpDomainMassG</a></div><div class="ttdeci">OpDomainMassH OpDomainMassG</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00114">free_surface.cpp:114</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a4825a358b4456cf947fbd333c04b8227"><div class="ttname"><a href="free__surface_8cpp.html#a4825a358b4456cf947fbd333c04b8227">get_M3_dh</a></div><div class="ttdeci">auto get_M3_dh</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00244">free_surface.cpp:244</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a4c51e25ae2f4a6111d2538d87ea73c58"><div class="ttname"><a href="free__surface_8cpp.html#a4c51e25ae2f4a6111d2538d87ea73c58">OpDomainAssembleVector</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::LinearForm&lt; I &gt;::OpBaseTimesVector&lt; BASE_DIM, SPACE_DIM, 1 &gt; OpDomainAssembleVector</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00118">free_surface.cpp:118</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a4ed33c41b617d287b500d415ef1063af"><div class="ttname"><a href="free__surface_8cpp.html#a4ed33c41b617d287b500d415ef1063af">rho_diff</a></div><div class="ttdeci">double rho_diff</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00181">free_surface.cpp:181</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a4fb2265adb844df23bf19d7818b5d59e"><div class="ttname"><a href="free__surface_8cpp.html#a4fb2265adb844df23bf19d7818b5d59e">init_h</a></div><div class="ttdeci">auto init_h</div><div class="ttdoc">Initialisation function.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00297">free_surface.cpp:297</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a52438586143ef05bfe922220a317c144"><div class="ttname"><a href="free__surface_8cpp.html#a52438586143ef05bfe922220a317c144">t_kd</a></div><div class="ttdeci">constexpr auto t_kd</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00139">free_surface.cpp:139</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a527ea211a847e157b65b68f8c5e9c8e2"><div class="ttname"><a href="free__surface_8cpp.html#a527ea211a847e157b65b68f8c5e9c8e2">d_phase_function_h</a></div><div class="ttdeci">auto d_phase_function_h</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00217">free_surface.cpp:217</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a535e562ee6e9f8b2995fe7ea52a12cc1"><div class="ttname"><a href="free__surface_8cpp.html#a535e562ee6e9f8b2995fe7ea52a12cc1">get_fe_bit</a></div><div class="ttdeci">auto get_fe_bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00316">free_surface.cpp:316</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="free__surface_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00080">free_surface.cpp:80</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5879ea15360d7f578572e5a7e760f777"><div class="ttname"><a href="free__surface_8cpp.html#a5879ea15360d7f578572e5a7e760f777">rho_ave</a></div><div class="ttdeci">double rho_ave</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00180">free_surface.cpp:180</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5b5dc92f38830b5eb0a331087879e1a7"><div class="ttname"><a href="free__surface_8cpp.html#a5b5dc92f38830b5eb0a331087879e1a7">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', SPACE_DIM &gt; l</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00137">free_surface.cpp:137</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5bdff9403d1001862d7b23865c51aace"><div class="ttname"><a href="free__surface_8cpp.html#a5bdff9403d1001862d7b23865c51aace">OpDomainAssembleScalar</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::LinearForm&lt; I &gt;::OpBaseTimesScalar&lt; BASE_DIM &gt; OpDomainAssembleScalar</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00120">free_surface.cpp:120</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5ea560308c20afbf49c6113148979636"><div class="ttname"><a href="free__surface_8cpp.html#a5ea560308c20afbf49c6113148979636">coord_type</a></div><div class="ttdeci">int coord_type</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00077">free_surface.cpp:77</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5ec511930edd29ba1a84430964cf60cd"><div class="ttname"><a href="free__surface_8cpp.html#a5ec511930edd29ba1a84430964cf60cd">W</a></div><div class="ttdeci">double W</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00168">free_surface.cpp:168</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a5f02ab7d688a9646857dbc77ce86e84f"><div class="ttname"><a href="free__surface_8cpp.html#a5f02ab7d688a9646857dbc77ce86e84f">kernel_oscillation</a></div><div class="ttdeci">auto kernel_oscillation</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00262">free_surface.cpp:262</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a628a79e931efe5e92813c2557088ee00"><div class="ttname"><a href="free__surface_8cpp.html#a628a79e931efe5e92813c2557088ee00">PostProcEleBdyCont</a></div><div class="ttdeci">PostProcBrokenMeshInMoabBaseCont&lt; BoundaryEle &gt; PostProcEleBdyCont</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00101">free_surface.cpp:101</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a653c95bd340aa1fd18c34afdfdae7d13"><div class="ttname"><a href="free__surface_8cpp.html#a653c95bd340aa1fd18c34afdfdae7d13">eta2</a></div><div class="ttdeci">double eta2</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00173">free_surface.cpp:173</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a657a8ad9ae185addb0a0c0654e5bc8f3"><div class="ttname"><a href="free__surface_8cpp.html#a657a8ad9ae185addb0a0c0654e5bc8f3">get_skin_parent_bit</a></div><div class="ttdeci">auto get_skin_parent_bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00154">free_surface.cpp:154</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a686d607908b00c0f7634206cb0fc3e08"><div class="ttname"><a href="free__surface_8cpp.html#a686d607908b00c0f7634206cb0fc3e08">get_M0</a></div><div class="ttdeci">auto get_M0</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00226">free_surface.cpp:226</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a6b72e54baf646b08b4b87f987f583dcb"><div class="ttname"><a href="free__surface_8cpp.html#a6b72e54baf646b08b4b87f987f583dcb">debug</a></div><div class="ttdeci">constexpr bool debug</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00146">free_surface.cpp:146</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a71a9f760a3ed38bc49a21637c6a734e1"><div class="ttname"><a href="free__surface_8cpp.html#a71a9f760a3ed38bc49a21637c6a734e1">get_f_dh</a></div><div class="ttdeci">auto get_f_dh</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00224">free_surface.cpp:224</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a723528e62ed95192e672e44445d647a7"><div class="ttname"><a href="free__surface_8cpp.html#a723528e62ed95192e672e44445d647a7">get_M3</a></div><div class="ttdeci">auto get_M3</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00235">free_surface.cpp:235</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a72db05665a631ca555995f0adc362703"><div class="ttname"><a href="free__surface_8cpp.html#a72db05665a631ca555995f0adc362703">rho_p</a></div><div class="ttdeci">double rho_p</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00165">free_surface.cpp:165</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a7678cc566b60b18cf2640a48f6f04f95"><div class="ttname"><a href="free__surface_8cpp.html#a7678cc566b60b18cf2640a48f6f04f95">mu_p</a></div><div class="ttdeci">double mu_p</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00166">free_surface.cpp:166</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a77bc552a32f6fe2b1e9cb70ae0401c5b"><div class="ttname"><a href="free__surface_8cpp.html#a77bc552a32f6fe2b1e9cb70ae0401c5b">get_start_bit</a></div><div class="ttdeci">auto get_start_bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00148">free_surface.cpp:148</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a7a097aeb92b0e72fbe9058279b42aee2"><div class="ttname"><a href="free__surface_8cpp.html#a7a097aeb92b0e72fbe9058279b42aee2">OpDomainMassP</a></div><div class="ttdeci">OpDomainMassH OpDomainMassP</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00113">free_surface.cpp:113</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a83ec90365447ce19c2bc90892eef8e3d"><div class="ttname"><a href="free__surface_8cpp.html#a83ec90365447ce19c2bc90892eef8e3d">OpMixScalarTimesDiv</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpMixScalarTimesDiv&lt; SPACE_DIM, COORD_TYPE &gt; OpMixScalarTimesDiv</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00126">free_surface.cpp:126</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a89155291a570b52ccaa924ff867a218a"><div class="ttname"><a href="free__surface_8cpp.html#a89155291a570b52ccaa924ff867a218a">nb_levels</a></div><div class="ttdeci">int nb_levels</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00143">free_surface.cpp:143</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a8eb2e32e83ed444e6d3ac8fdf877804b"><div class="ttname"><a href="free__surface_8cpp.html#a8eb2e32e83ed444e6d3ac8fdf877804b">wetting_angle</a></div><div class="ttdeci">auto wetting_angle</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00312">free_surface.cpp:312</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a8ee9be1b5aa75abae556de3088cba6d9"><div class="ttname"><a href="free__surface_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a></div><div class="ttdeci">double h</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00171">free_surface.cpp:171</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a92271a50ab29307cc3f148adbb38b696"><div class="ttname"><a href="free__surface_8cpp.html#a92271a50ab29307cc3f148adbb38b696">get_M</a></div><div class="ttdeci">auto get_M</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00251">free_surface.cpp:251</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a974233f815d533deae50cb320c7439b3"><div class="ttname"><a href="free__surface_8cpp.html#a974233f815d533deae50cb320c7439b3">mu_ave</a></div><div class="ttdeci">double mu_ave</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00182">free_surface.cpp:182</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a974b448c3d0a13d483d36ef15de369b5"><div class="ttname"><a href="free__surface_8cpp.html#a974b448c3d0a13d483d36ef15de369b5">eps</a></div><div class="ttdeci">double eps</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00177">free_surface.cpp:177</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a98586395e62b3439ebaa3eff115fcc2e"><div class="ttname"><a href="free__surface_8cpp.html#a98586395e62b3439ebaa3eff115fcc2e">get_dofs_ents_all</a></div><div class="ttdeci">auto get_dofs_ents_all</div><div class="ttdoc">get entities of dofs in the problem - used for debugging</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00370">free_surface.cpp:370</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a985de4887e01f1dc8aba4e3e3eaab7f3"><div class="ttname"><a href="free__surface_8cpp.html#a985de4887e01f1dc8aba4e3e3eaab7f3">phase_function</a></div><div class="ttdeci">auto phase_function</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00213">free_surface.cpp:213</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_aa269b31c43f6e2a39aa0759811800860"><div class="ttname"><a href="free__surface_8cpp.html#aa269b31c43f6e2a39aa0759811800860">get_skin_projection_bit</a></div><div class="ttdeci">auto get_skin_projection_bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00157">free_surface.cpp:157</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_aa27d9fb6c66edd61c856e1946194cc8c"><div class="ttname"><a href="free__surface_8cpp.html#aa27d9fb6c66edd61c856e1946194cc8c">get_global_size</a></div><div class="ttdeci">auto get_global_size</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00320">free_surface.cpp:320</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_aa6663f5cc1a1590e06266b81c8a078a6"><div class="ttname"><a href="free__surface_8cpp.html#aa6663f5cc1a1590e06266b81c8a078a6">get_dofs_ents_by_field_name</a></div><div class="ttdeci">auto get_dofs_ents_by_field_name</div><div class="ttdoc">get entities of dofs in the problem - used for debugging</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00342">free_surface.cpp:342</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_aa76cd399d84e307225624cba05693463"><div class="ttname"><a href="free__surface_8cpp.html#aa76cd399d84e307225624cba05693463">DomianParentEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::DomianParentEle DomianParentEle</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00091">free_surface.cpp:91</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ab42544325abba8cc4ec2b39dbb701302"><div class="ttname"><a href="free__surface_8cpp.html#ab42544325abba8cc4ec2b39dbb701302">OpDomainMassH</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::BiLinearForm&lt; I &gt;::OpMass&lt; BASE_DIM, 1 &gt; OpDomainMassH</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00111">free_surface.cpp:111</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ab5a0080448e42b2f5548763f9ab619df"><div class="ttname"><a href="free__surface_8cpp.html#ab5a0080448e42b2f5548763f9ab619df">get_D</a></div><div class="ttdeci">auto get_D</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00254">free_surface.cpp:254</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ab9b6c8710e2076a5e271c60f0363aac9"><div class="ttname"><a href="free__surface_8cpp.html#ab9b6c8710e2076a5e271c60f0363aac9">wetting_angle_sub_stepping</a></div><div class="ttdeci">auto wetting_angle_sub_stepping</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00196">free_surface.cpp:196</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ab9ee1c6b1a408c8680179d21cd3ec51f"><div class="ttname"><a href="free__surface_8cpp.html#ab9ee1c6b1a408c8680179d21cd3ec51f">refine_overlap</a></div><div class="ttdeci">int refine_overlap</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00144">free_surface.cpp:144</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_abc5564e5c2cf362c587c446e78fe7196"><div class="ttname"><a href="free__surface_8cpp.html#abc5564e5c2cf362c587c446e78fe7196">get_M0_dh</a></div><div class="ttdeci">auto get_M0_dh</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00227">free_surface.cpp:227</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_abe6104fc2964fbaa2958eff4563f35cf"><div class="ttname"><a href="free__surface_8cpp.html#abe6104fc2964fbaa2958eff4563f35cf">my_max</a></div><div class="ttdeci">auto my_max</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00203">free_surface.cpp:203</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ac52e9f0bda51760b1ff6367d5cdbe0a6"><div class="ttname"><a href="free__surface_8cpp.html#ac52e9f0bda51760b1ff6367d5cdbe0a6">cut_off</a></div><div class="ttdeci">auto cut_off</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00205">free_surface.cpp:205</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ac6bfdcdc75a76c6e1aa9c176ab98d5ef"><div class="ttname"><a href="free__surface_8cpp.html#ac6bfdcdc75a76c6e1aa9c176ab98d5ef">get_skin_child_bit</a></div><div class="ttdeci">auto get_skin_child_bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00155">free_surface.cpp:155</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ac85d5511fdb8d162a7278bfb440ae420"><div class="ttname"><a href="free__surface_8cpp.html#ac85d5511fdb8d162a7278bfb440ae420">order</a></div><div class="ttdeci">int order</div><div class="ttdoc">approximation order</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00142">free_surface.cpp:142</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ad3cb845283ccc6b6bfcedf2cd798c923"><div class="ttname"><a href="free__surface_8cpp.html#ad3cb845283ccc6b6bfcedf2cd798c923">SideOp</a></div><div class="ttdeci">SideEle::UserDataOperator SideOp</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00097">free_surface.cpp:97</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ad95dcba445836b4ba94129111a4b888c"><div class="ttname"><a href="free__surface_8cpp.html#ad95dcba445836b4ba94129111a4b888c">a0</a></div><div class="ttdeci">double a0</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00162">free_surface.cpp:162</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_addfde5f32ee335b673e3cabcebbaf68a"><div class="ttname"><a href="free__surface_8cpp.html#addfde5f32ee335b673e3cabcebbaf68a">rho_m</a></div><div class="ttdeci">double rho_m</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00163">free_surface.cpp:163</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ade8c17ad9a7ad98be2e3c9cc859651d3"><div class="ttname"><a href="free__surface_8cpp.html#ade8c17ad9a7ad98be2e3c9cc859651d3">get_current_bit</a></div><div class="ttdeci">auto get_current_bit</div><div class="ttdoc">dofs bit used to do calculations</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00151">free_surface.cpp:151</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ae4f402913d5fc5dd3aebca242ab26019"><div class="ttname"><a href="free__surface_8cpp.html#ae4f402913d5fc5dd3aebca242ab26019">eta</a></div><div class="ttdeci">double eta</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00172">free_surface.cpp:172</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="free__surface_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00314">free_surface.cpp:314</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_ae9d33445e0520ebdaaedb6ea478cb858"><div class="ttname"><a href="free__surface_8cpp.html#ae9d33445e0520ebdaaedb6ea478cb858">md</a></div><div class="ttdeci">double md</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00176">free_surface.cpp:176</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_aedb68ad91550d74f18295f359a3cc222"><div class="ttname"><a href="free__surface_8cpp.html#aedb68ad91550d74f18295f359a3cc222">capillary_tube</a></div><div class="ttdeci">auto capillary_tube</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00280">free_surface.cpp:280</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_aedc6e3cd14a21843cb47a0cb3975f4a2"><div class="ttname"><a href="free__surface_8cpp.html#aedc6e3cd14a21843cb47a0cb3975f4a2">OpBoundaryAssembleScalar</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; A &gt;::LinearForm&lt; I &gt;::OpBaseTimesScalar&lt; BASE_DIM &gt; OpBoundaryAssembleScalar</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00122">free_surface.cpp:122</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_af28f2ebcea367853e11b662bfbc41b48"><div class="ttname"><a href="free__surface_8cpp.html#af28f2ebcea367853e11b662bfbc41b48">get_f</a></div><div class="ttdeci">auto get_f</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00223">free_surface.cpp:223</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_af3610ce2daf6b1fafd490a37f3d43135"><div class="ttname"><a href="free__surface_8cpp.html#af3610ce2daf6b1fafd490a37f3d43135">OpFluidFlux</a></div><div class="ttdeci">BoundaryNaturalBC::OpFlux&lt; NaturalMeshsetType&lt; BLOCKSET &gt;, 1, 1 &gt; OpFluidFlux</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00131">free_surface.cpp:131</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_af3b37fccf55388875f9bf518d73161ee"><div class="ttname"><a href="free__surface_8cpp.html#af3b37fccf55388875f9bf518d73161ee">get_projection_bit</a></div><div class="ttdeci">auto get_projection_bit</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00156">free_surface.cpp:156</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_afa9aacf64432582b849eabccf4e782c7"><div class="ttname"><a href="free__surface_8cpp.html#afa9aacf64432582b849eabccf4e782c7">d_cut_off</a></div><div class="ttdeci">auto d_cut_off</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00206">free_surface.cpp:206</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_afc5310bd26fb5327a0a65a4c85fcbfcf"><div class="ttname"><a href="free__surface_8cpp.html#afc5310bd26fb5327a0a65a4c85fcbfcf">my_min</a></div><div class="ttdeci">auto my_min</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00204">free_surface.cpp:204</a></div></div>
<div class="ttc" id="agroup__dm_html_ga175a29f4cdd0e7b7ae6cc2a0d7ed1704"><div class="ttname"><a href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">MoFEM::DMMoFEMCreateSubDM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateSubDM(DM subdm, DM dm, const char problem_name[])</div><div class="ttdoc">Must be called by user to set Sub DM MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00215">DMMoFEM.cpp:215</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="agroup__dm_html_ga27babc6dfb0df28667682a98b5822739"><div class="ttname"><a href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">MoFEM::DMMoFEMSetSquareProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetSquareProblem(DM dm, PetscBool square_problem)</div><div class="ttdoc">set squared problem</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00456">DMMoFEM.cpp:456</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga3fcdbd5c74eba11ee82492e57d730756"><div class="ttname"><a href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">MoFEM::DMoFEMPostProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPostProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00556">DMMoFEM.cpp:556</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="agroup__dm_html_ga62400e040ecf09a00b7ec3767fc7f124"><div class="ttname"><a href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">MoFEM::DMMoFEMAddSubFieldRow</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldRow(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00238">DMMoFEM.cpp:238</a></div></div>
<div class="ttc" id="agroup__dm_html_ga899ec9d1ad35488bbe4273731f6d5c90"><div class="ttname"><a href="group__dm.html#ga899ec9d1ad35488bbe4273731f6d5c90">MoFEM::DMRegister_MoFEM</a></div><div class="ttdeci">PetscErrorCode DMRegister_MoFEM(const char sname[])</div><div class="ttdoc">Register MoFEM problem.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00043">DMMoFEM.cpp:43</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01099">DMMoFEM.hpp:1099</a></div></div>
<div class="ttc" id="agroup__dm_html_gac5ffe05a59f8ff6145029d62093f2e9b"><div class="ttname"><a href="group__dm.html#gac5ffe05a59f8ff6145029d62093f2e9b">MoFEM::DMoFEMGetInterfacePtr</a></div><div class="ttdeci">PetscErrorCode DMoFEMGetInterfacePtr(DM dm, MoFEM::Interface **m_field_ptr)</div><div class="ttdoc">Get pointer to MoFEM::Interface.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00414">DMMoFEM.cpp:414</a></div></div>
<div class="ttc" id="agroup__dm_html_gac7a16ef15dc01cc47e25241d138d85da"><div class="ttname"><a href="group__dm.html#gac7a16ef15dc01cc47e25241d138d85da">MoFEM::DMMoFEMAddSubFieldCol</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldCol(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00280">DMMoFEM.cpp:280</a></div></div>
<div class="ttc" id="agroup__dm_html_gad0c8678dac27b8ef08e604406ba783c7"><div class="ttname"><a href="group__dm.html#gad0c8678dac27b8ef08e604406ba783c7">MoFEM::createDMMatrix</a></div><div class="ttdeci">auto createDMMatrix(DM dm)</div><div class="ttdoc">Get smart matrix from DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01056">DMMoFEM.hpp:1056</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00546">DMMoFEM.cpp:546</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_ga7fc3e2d994adf8ef767f674ee3d76493"><div class="ttname"><a href="group__mofem__access.html#ga7fc3e2d994adf8ef767f674ee3d76493">MoFEM::CoreInterface::get_dofs</a></div><div class="ttdeci">virtual const DofEntity_multiIndex * get_dofs() const =0</div><div class="ttdoc">Get the dofs object.</div></div>
<div class="ttc" id="agroup__mofem__bit__ref_html_ga539727a53d34c396c8a47f273334350b"><div class="ttname"><a href="group__mofem__bit__ref.html#ga539727a53d34c396c8a47f273334350b">MoFEM::BitRefManager::getEntitiesByDimAndRefLevel</a></div><div class="ttdeci">MoFEMErrorCode getEntitiesByDimAndRefLevel(const BitRefLevel bit, const BitRefLevel mask, const int dim, const EntityHandle meshset, int verb=0) const</div><div class="ttdoc">add all ents from ref level given by bit to meshset</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8cpp_source.html#l00822">BitRefManager.cpp:822</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_ga2136fdd1cb130ca18f645e799b05569f"><div class="ttname"><a href="group__mofem__forms.html#ga2136fdd1cb130ca18f645e799b05569f">MoFEM::IntegrationType</a></div><div class="ttdeci">IntegrationType</div><div class="ttdoc">Form integrator integration types.</div><div class="ttdef"><b>Definition</b> <a href="_forms_integrators_8hpp_source.html#l00136">FormsIntegrators.hpp:136</a></div></div>
<div class="ttc" id="agroup__mofem__forms_html_gabb82cd10e89a1d4d25fa7756360b181b"><div class="ttname"><a href="group__mofem__forms.html#gabb82cd10e89a1d4d25fa7756360b181b">MoFEM::AssemblyType</a></div><div class="ttdeci">AssemblyType</div><div class="ttdoc">[Storage and set boundary conditions]</div><div class="ttdef"><b>Definition</b> <a href="_forms_integrators_8hpp_source.html#l00104">FormsIntegrators.hpp:104</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga1d256cf4cf0b698de94c0907f7f0fe93"><div class="ttname"><a href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">MoFEM::LogManager::SeverityLevel</a></div><div class="ttdeci">SeverityLevel</div><div class="ttdoc">Severity levels.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00033">LogManager.hpp:33</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga202c2d0258d78f4c0d60ecac64bf2252"><div class="ttname"><a href="group__mofem__log__manager.html#ga202c2d0258d78f4c0d60ecac64bf2252">MOFEM_LOG_TAG</a></div><div class="ttdeci">#define MOFEM_LOG_TAG(channel, tag)</div><div class="ttdoc">Tag channel.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00339">LogManager.hpp:339</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga47d7053307c012af4b78f8a09e21fa83"><div class="ttname"><a href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a></div><div class="ttdeci">#define MOFEM_LOG_CHANNEL(channel)</div><div class="ttdoc">Set and reset channel.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00284">LogManager.hpp:284</a></div></div>
<div class="ttc" id="agroup__mofem__problems__manager_html_ga9c86df8247b9fda02508dd26018fff8c"><div class="ttname"><a href="group__mofem__problems__manager.html#ga9c86df8247b9fda02508dd26018fff8c">MoFEM::ProblemsManager::buildSubProblem</a></div><div class="ttdeci">MoFEMErrorCode buildSubProblem(const std::string out_name, const std::vector&lt; std::string &gt; &amp;fields_row, const std::vector&lt; std::string &gt; &amp;fields_col, const std::string main_problem, const bool square_matrix=true, const map&lt; std::string, boost::shared_ptr&lt; Range &gt; &gt; *entityMapRow=nullptr, const map&lt; std::string, boost::shared_ptr&lt; Range &gt; &gt; *entityMapCol=nullptr, int verb=VERBOSE)</div><div class="ttdoc">build sub problem</div><div class="ttdef"><b>Definition</b> <a href="_problems_manager_8cpp_source.html#l00986">ProblemsManager.cpp:986</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_a09bbb09bc96abf04b6a0e92775d64a1b"><div class="ttname"><a href="hanging__node__approx_8cpp.html#a09bbb09bc96abf04b6a0e92775d64a1b">marker</a></div><div class="ttdeci">auto marker</div><div class="ttdoc">set bit to marker</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00082">hanging_node_approx.cpp:82</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_a39d05b2de535e7a2f2cf8140b7ac3e5f"><div class="ttname"><a href="hanging__node__approx_8cpp.html#a39d05b2de535e7a2f2cf8140b7ac3e5f">test_bit_child</a></div><div class="ttdeci">auto test_bit_child</div><div class="ttdoc">lambda function used to select elements on which finite element pipelines are executed.</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00173">hanging_node_approx.cpp:173</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="ahcurl__check__approx__in__2d_8cpp_html_a6c7cb8ddd43ff771629f497cdde37cf0"><div class="ttname"><a href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a></div><div class="ttdeci">constexpr double a0</div><div class="ttdef"><b>Definition</b> <a href="hcurl__check__approx__in__2d_8cpp_source.html#l00037">hcurl_check_approx_in_2d.cpp:37</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a2b858ab7cb6771654cc5c6c1e5267677"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a2b858ab7cb6771654cc5c6c1e5267677">coord_type</a></div><div class="ttdeci">constexpr CoordinateTypes coord_type</div><div class="ttdef"><b>Definition</b> <a href="incompressible__elasticity_8cpp_source.html#l00019">incompressible_elasticity.cpp:19</a></div></div>
<div class="ttc" id="aincompressible__elasticity_8cpp_html_a3db359547eed8cfd48ca821d95f577af"><div class="ttname"><a href="incompressible__elasticity_8cpp.html#a3db359547eed8cfd48ca821d95f577af">lambda</a></div><div class="ttdeci">static double lambda</div><div class="ttdef"><b>Definition</b> <a href="incompressible__elasticity_8cpp_source.html#l00199">incompressible_elasticity.cpp:199</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_a8fc6defe4e499b1b9b9c275689e44352"><div class="ttname"><a href="initial__diffusion_8cpp.html#a8fc6defe4e499b1b9b9c275689e44352">c</a></div><div class="ttdeci">const double c</div><div class="ttdoc">speed of light (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00039">initial_diffusion.cpp:39</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_ad8657a5ec76e12f3066fb4b4eb75ace9"><div class="ttname"><a href="initial__diffusion_8cpp.html#ad8657a5ec76e12f3066fb4b4eb75ace9">D</a></div><div class="ttdeci">double D</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00044">initial_diffusion.cpp:44</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_afd53743d1af6bfa2856255b23b5a41a9"><div class="ttname"><a href="initial__diffusion_8cpp.html#afd53743d1af6bfa2856255b23b5a41a9">n</a></div><div class="ttdeci">const double n</div><div class="ttdoc">refractive index of diffusive medium</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00038">initial_diffusion.cpp:38</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_a4a62410a15dcd5a702a26f8bff4ae683"><div class="ttname"><a href="level__set_8cpp.html#a4a62410a15dcd5a702a26f8bff4ae683">nb_levels</a></div><div class="ttdeci">constexpr int nb_levels</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l00058">level_set.cpp:58</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_abd3c08a89738e1bb4365d3fcd72e8c7e"><div class="ttname"><a href="level__set_8cpp.html#abd3c08a89738e1bb4365d3fcd72e8c7e">DomianParentEle</a></div><div class="ttdeci">PipelineManager::ElementsAndOpsByDim&lt; FE_DIM &gt;::DomianParentEle DomianParentEle</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l00038">level_set.cpp:38</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="amesh__smoothing_8cpp_html_a2687e4b3cb5da7dbd00e565343f66c6c"><div class="ttname"><a href="mesh__smoothing_8cpp.html#a2687e4b3cb5da7dbd00e565343f66c6c">tol</a></div><div class="ttdeci">double tol</div><div class="ttdef"><b>Definition</b> <a href="mesh__smoothing_8cpp_source.html#l00026">mesh_smoothing.cpp:26</a></div></div>
<div class="ttc" id="anamespace_free_surface_ops_html"><div class="ttname"><a href="namespace_free_surface_ops.html">FreeSurfaceOps</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00001">FreeSurfaceOps.hpp:1</a></div></div>
<div class="ttc" id="anamespace_hencky_ops_html_a990086ab6bdc667b830a40f0ffb74aa3"><div class="ttname"><a href="namespace_hencky_ops.html#a990086ab6bdc667b830a40f0ffb74aa3">HenckyOps::f</a></div><div class="ttdeci">auto f</div><div class="ttdef"><b>Definition</b> <a href="_hencky_ops_8hpp_source.html#l00015">HenckyOps.hpp:15</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_types_html_aa9495b406c5326b7bca937846ec421c5"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_types.html#aa9495b406c5326b7bca937846ec421c5">MoFEM::Types::BitRefLevel</a></div><div class="ttdeci">std::bitset&lt; BITREFLEVEL_SIZE &gt; BitRefLevel</div><div class="ttdoc">Bit structure attached to each entity identifying to what mesh entity is attached.</div><div class="ttdef"><b>Definition</b> <a href="_types_8hpp_source.html#l00040">Types.hpp:40</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a10bae3a5a92d97274ffdd4b5d3ed5c0e"><div class="ttname"><a href="namespace_mo_f_e_m.html#a10bae3a5a92d97274ffdd4b5d3ed5c0e">MoFEM::createKSP</a></div><div class="ttdeci">auto createKSP(MPI_Comm comm)</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00261">PetscSmartObj.hpp:261</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a112dfab22d28426fcd0ab2d61cf8f494"><div class="ttname"><a href="namespace_mo_f_e_m.html#a112dfab22d28426fcd0ab2d61cf8f494">MoFEM::DMMoFEMTSSetMonitor</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetMonitor(DM dm, TS ts, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">Set Monitor To TS solver.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01056">DMMoFEM.cpp:1056</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a12477157e716aece7dd7b3e316fef7a3"><div class="ttname"><a href="namespace_mo_f_e_m.html#a12477157e716aece7dd7b3e316fef7a3">MoFEM::TsSetIJacobian</a></div><div class="ttdeci">PetscErrorCode TsSetIJacobian(TS ts, PetscReal t, Vec u, Vec u_t, PetscReal a, Mat A, Mat B, void *ctx)</div><div class="ttdoc">Set function evaluating jacobian in TS solver.</div><div class="ttdef"><b>Definition</b> <a href="_ts_ctx_8cpp_source.html#l00169">TsCtx.cpp:169</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a1654dd29ff9af437332ec55af104ff48"><div class="ttname"><a href="namespace_mo_f_e_m.html#a1654dd29ff9af437332ec55af104ff48">MoFEM::TsMonitorSet</a></div><div class="ttdeci">PetscErrorCode TsMonitorSet(TS ts, PetscInt step, PetscReal t, Vec u, void *ctx)</div><div class="ttdoc">Set monitor for TS solver.</div><div class="ttdef"><b>Definition</b> <a href="_ts_ctx_8cpp_source.html#l00263">TsCtx.cpp:263</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a1808931312a0a80aad5a5e769aa9e536"><div class="ttname"><a href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">MoFEM::getDMTsCtx</a></div><div class="ttdeci">auto getDMTsCtx(DM dm)</div><div class="ttdoc">Get TS context data structure used by DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01141">DMMoFEM.hpp:1141</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a2ae9847dc65a4ed504f68633851f8ddf"><div class="ttname"><a href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">MoFEM::DMMoFEMSetDestroyProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetDestroyProblem(DM dm, PetscBool destroy_problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00438">DMMoFEM.cpp:438</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a2d7af8e1af9a42f3180d8cc96f8f8c06"><div class="ttname"><a href="namespace_mo_f_e_m.html#a2d7af8e1af9a42f3180d8cc96f8f8c06">MoFEM::PetscOptionsGetInt</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetInt(PetscOptions *, const char pre[], const char name[], PetscInt *ivalue, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_petsc_8hpp_source.html#l00142">DeprecatedPetsc.hpp:142</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a37c8aa74d57ef9fcf60e6c508b987113"><div class="ttname"><a href="namespace_mo_f_e_m.html#a37c8aa74d57ef9fcf60e6c508b987113">MoFEM::MoFEMSNESMonitorFields</a></div><div class="ttdeci">MoFEMErrorCode MoFEMSNESMonitorFields(SNES snes, PetscInt its, PetscReal fgnorm, SnesCtx *snes_ctx)</div><div class="ttdoc">Sens monitor printing residual field by field.</div><div class="ttdef"><b>Definition</b> <a href="_snes_ctx_8cpp_source.html#l00239">SnesCtx.cpp:239</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_petsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a65f22030e64fd429012bf8f0f025d9a1"><div class="ttname"><a href="namespace_mo_f_e_m.html#a65f22030e64fd429012bf8f0f025d9a1">MoFEM::TsSetIFunction</a></div><div class="ttdeci">PetscErrorCode TsSetIFunction(TS ts, PetscReal t, Vec u, Vec u_t, Vec F, void *ctx)</div><div class="ttdoc">Set IFunction for TS solver.</div><div class="ttdef"><b>Definition</b> <a href="_ts_ctx_8cpp_source.html#l00056">TsCtx.cpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a681e912e2d0043503d2da810dc186d73"><div class="ttname"><a href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">MoFEM::vectorDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; vectorDuplicate(Vec vec)</div><div class="ttdoc">Create duplicate vector of smart vector.</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00221">PetscSmartObj.hpp:221</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a748d9a902fa774326786c28c22517a0c"><div class="ttname"><a href="namespace_mo_f_e_m.html#a748d9a902fa774326786c28c22517a0c">MoFEM::createVecScatter</a></div><div class="ttdeci">auto createVecScatter(Vec x, IS ix, Vec y, IS iy)</div><div class="ttdoc">Create a Vec Scatter object.</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00361">PetscSmartObj.hpp:361</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a75ec25c20769bd419ad19f79e062aa66"><div class="ttname"><a href="namespace_mo_f_e_m.html#a75ec25c20769bd419ad19f79e062aa66">MoFEM::solve</a></div><div class="ttdeci">static PetscErrorCode solve(Mat mat, Vec x, Vec y)</div><div class="ttdef"><b>Definition</b> <a href="_schur_8cpp_source.html#l01296">Schur.cpp:1296</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a89f535c8339c55c756485568be5559f7"><div class="ttname"><a href="namespace_mo_f_e_m.html#a89f535c8339c55c756485568be5559f7">MoFEM::createTS</a></div><div class="ttdeci">auto createTS(MPI_Comm comm)</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00249">PetscSmartObj.hpp:249</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a93d0c64e0863847d28ef4248b8dad31c"><div class="ttname"><a href="namespace_mo_f_e_m.html#a93d0c64e0863847d28ef4248b8dad31c">MoFEM::createPC</a></div><div class="ttdeci">auto createPC(MPI_Comm comm)</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00267">PetscSmartObj.hpp:267</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_abee82d436d03244c6886fc99f71116f0"><div class="ttname"><a href="namespace_mo_f_e_m.html#abee82d436d03244c6886fc99f71116f0">MoFEM::PetscOptionsGetEList</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetEList(PetscOptions *, const char pre[], const char name[], const char *const *list, PetscInt next, PetscInt *value, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_petsc_8hpp_source.html#l00203">DeprecatedPetsc.hpp:203</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ac66ae807ded4ad510b8be2f40d9e125a"><div class="ttname"><a href="namespace_mo_f_e_m.html#ac66ae807ded4ad510b8be2f40d9e125a">MoFEM::getPetscObject</a></div><div class="ttdeci">PetscObject getPetscObject(T obj)</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00009">PetscSmartObj.hpp:9</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ad17eefd5d88d2b51c71ec46cae8569ac"><div class="ttname"><a href="namespace_mo_f_e_m.html#ad17eefd5d88d2b51c71ec46cae8569ac">MoFEM::get_temp_meshset_ptr</a></div><div class="ttdeci">auto get_temp_meshset_ptr(moab::Interface &amp;moab)</div><div class="ttdoc">Create smart pointer to temporary meshset.</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01886">Templates.hpp:1886</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ad8b6ce3375c62fd0b096e01cb710da98"><div class="ttname"><a href="namespace_mo_f_e_m.html#ad8b6ce3375c62fd0b096e01cb710da98">MoFEM::OpCalculateScalarFieldValuesDot</a></div><div class="ttdeci">OpCalculateScalarFieldValuesFromPetscVecImpl&lt; PetscData::CTX_SET_X_T &gt; OpCalculateScalarFieldValuesDot</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00272">UserDataOperators.hpp:272</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_addce2077b77e610d248ae548a01e77e3"><div class="ttname"><a href="namespace_mo_f_e_m.html#addce2077b77e610d248ae548a01e77e3">MoFEM::getDMSnesCtx</a></div><div class="ttdeci">auto getDMSnesCtx(DM dm)</div><div class="ttdoc">Get SNES context data structure used by DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01127">DMMoFEM.hpp:1127</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ae6b64312d73966f4cc41953bc77a4ba3"><div class="ttname"><a href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">MoFEM::createDM</a></div><div class="ttdeci">auto createDM(MPI_Comm comm, const std::string dm_type_name)</div><div class="ttdoc">Creates smart DM object.</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00141">PetscSmartObj.hpp:141</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_aed3c6c3193c6c5a30bb408cf4a6f5c53"><div class="ttname"><a href="namespace_mo_f_e_m.html#aed3c6c3193c6c5a30bb408cf4a6f5c53">MoFEM::getProblemPtr</a></div><div class="ttdeci">auto getProblemPtr(DM dm)</div><div class="ttdoc">get problem pointer from DM</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01044">DMMoFEM.hpp:1044</a></div></div>
<div class="ttc" id="anamespaceconvert_html_a80e685c1c2056739a335dd39b1981ef7"><div class="ttname"><a href="namespaceconvert.html#a80e685c1c2056739a335dd39b1981ef7">convert.type</a></div><div class="ttdeci">type</div><div class="ttdef"><b>Definition</b> <a href="convert_8py_source.html#l00064">convert.py:64</a></div></div>
<div class="ttc" id="anamespacesdf__hertz__2d__axisymm__plane_html_a8204f26163e5d184298bc6fa855b88ea"><div class="ttname"><a href="namespacesdf__hertz__2d__axisymm__plane.html#a8204f26163e5d184298bc6fa855b88ea">sdf_hertz_2d_axisymm_plane.d</a></div><div class="ttdeci">float d</div><div class="ttdef"><b>Definition</b> <a href="sdf__hertz__2d__axisymm__plane_8py_source.html#l00004">sdf_hertz_2d_axisymm_plane.py:4</a></div></div>
<div class="ttc" id="anamespacesdf__wavy__2d_html_ab736ce7138c0ba29f61877ebea4f2bc6"><div class="ttname"><a href="namespacesdf__wavy__2d.html#ab736ce7138c0ba29f61877ebea4f2bc6">sdf_wavy_2d.w</a></div><div class="ttdeci">int w</div><div class="ttdef"><b>Definition</b> <a href="sdf__wavy__2d_8py_source.html#l00006">sdf_wavy_2d.py:6</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_a99b759dd71581f497626034776727d3d"><div class="ttname"><a href="operators__tests_8cpp.html#a99b759dd71581f497626034776727d3d">I</a></div><div class="ttdeci">constexpr IntegrationType I</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00031">operators_tests.cpp:31</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_a8ee9be1b5aa75abae556de3088cba6d9"><div class="ttname"><a href="photon__diffusion_8cpp.html#a8ee9be1b5aa75abae556de3088cba6d9">h</a></div><div class="ttdeci">double h</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00060">photon_diffusion.cpp:60</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_abded98f73756cdfa3293cc0b9fd50450"><div class="ttname"><a href="photon__diffusion_8cpp.html#abded98f73756cdfa3293cc0b9fd50450">save_every_nth_step</a></div><div class="ttdeci">int save_every_nth_step</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00067">photon_diffusion.cpp:67</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ae9faec98b784e677f51cf7ede5a592b4"><div class="ttname"><a href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::SideEle SideEle</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00061">plastic.cpp:61</a></div></div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition</b> <a href="plate_8cpp_source.html#l00058">plate.cpp:58</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="aradiation_8cpp_html_a62d290f01cfc65a09faa805099b2e06f"><div class="ttname"><a href="radiation_8cpp.html#a62d290f01cfc65a09faa805099b2e06f">OpBase</a></div><div class="ttdeci">OpBaseImpl&lt; PETSC, EdgeEleOp &gt; OpBase</div><div class="ttdef"><b>Definition</b> <a href="radiation_8cpp_source.html#l00029">radiation.cpp:29</a></div></div>
<div class="ttc" id="aseepage_8cpp_html_a7870ef6bf83f42149a763635e1bb4c8c"><div class="ttname"><a href="seepage_8cpp.html#a7870ef6bf83f42149a763635e1bb4c8c">OpMass</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; PETSC &gt;::BiLinearForm&lt; GAUSS &gt;::OpMass&lt; 1, SPACE_DIM &gt; OpMass</div><div class="ttdoc">[Only used with Hooke equation (linear material model)]</div><div class="ttdef"><b>Definition</b> <a href="seepage_8cpp_source.html#l00056">seepage.cpp:56</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ab65af9ad1ab66fac4ba26a865ae7ae13"><div class="ttname"><a href="shallow__wave_8cpp.html#ab65af9ad1ab66fac4ba26a865ae7ae13">g</a></div><div class="ttdeci">constexpr double g</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00063">shallow_wave.cpp:63</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astruct_add_h_o_ops_html"><div class="ttname"><a href="struct_add_h_o_ops.html">AddHOOps</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00597">EshelbianOperators.hpp:597</a></div></div>
<div class="ttc" id="astruct_elements_and_ops_html"><div class="ttname"><a href="struct_elements_and_ops.html">ElementsAndOps</a></div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00018">child_and_parent.cpp:18</a></div></div>
<div class="ttc" id="astruct_example_html_ab79afebe5c16553d0c38e3ec022f868f"><div class="ttname"><a href="struct_example.html#ab79afebe5c16553d0c38e3ec022f868f">Example::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00223">plastic.cpp:223</a></div></div>
<div class="ttc" id="astruct_free_surface_html"><div class="ttname"><a href="struct_free_surface.html">FreeSurface</a></div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00471">free_surface.cpp:471</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a02f2da5badf9cdc622f432e93d4741eb"><div class="ttname"><a href="struct_free_surface.html#a02f2da5badf9cdc622f432e93d4741eb">FreeSurface::findParentsToRefine</a></div><div class="ttdeci">Range findParentsToRefine(Range ents, BitRefLevel level, BitRefLevel mask)</div></div>
<div class="ttc" id="astruct_free_surface_html_a0dfede003abd0635ad388425507f4b85"><div class="ttname"><a href="struct_free_surface.html#a0dfede003abd0635ad388425507f4b85">FreeSurface::setupProblem</a></div><div class="ttdeci">MoFEMErrorCode setupProblem()</div><div class="ttdoc">[Read mesh]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00552">free_surface.cpp:552</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a1b055cfa0c1aa5d9e84f7ee624e6d301"><div class="ttname"><a href="struct_free_surface.html#a1b055cfa0c1aa5d9e84f7ee624e6d301">FreeSurface::runProblem</a></div><div class="ttdeci">MoFEMErrorCode runProblem()</div><div class="ttdoc">[Run programme]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00524">free_surface.cpp:524</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a2c01b80ff5d3e7fa0a9a0c699b7a64fe"><div class="ttname"><a href="struct_free_surface.html#a2c01b80ff5d3e7fa0a9a0c699b7a64fe">FreeSurface::FreeSurface</a></div><div class="ttdeci">FreeSurface(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00473">free_surface.cpp:473</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a3f816ecc2a3be8170d9e319b9da9b6b3"><div class="ttname"><a href="struct_free_surface.html#a3f816ecc2a3be8170d9e319b9da9b6b3">FreeSurface::projectData</a></div><div class="ttdeci">MoFEMErrorCode projectData()</div><div class="ttdoc">[Boundary condition]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00953">free_surface.cpp:953</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a8f554e1221984163ef18529432cb2255"><div class="ttname"><a href="struct_free_surface.html#a8f554e1221984163ef18529432cb2255">FreeSurface::boundaryCondition</a></div><div class="ttdeci">MoFEMErrorCode boundaryCondition()</div><div class="ttdoc">[Set up problem]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00663">free_surface.cpp:663</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a9073812e30e6f582c3df7f1775914e9a"><div class="ttname"><a href="struct_free_surface.html#a9073812e30e6f582c3df7f1775914e9a">FreeSurface::readMesh</a></div><div class="ttdeci">MoFEMErrorCode readMesh()</div><div class="ttdoc">[Run programme]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00536">free_surface.cpp:536</a></div></div>
<div class="ttc" id="astruct_free_surface_html_a9d92e2c1cb708d828de61f1f6154e72c"><div class="ttname"><a href="struct_free_surface.html#a9d92e2c1cb708d828de61f1f6154e72c">FreeSurface::setParentDofs</a></div><div class="ttdeci">MoFEMErrorCode setParentDofs(boost::shared_ptr&lt; FEMethod &gt; fe_top, std::string field_name, ForcesAndSourcesCore::UserDataOperator::OpType op, BitRefLevel child_ent_bit, boost::function&lt; boost::shared_ptr&lt; ForcesAndSourcesCore &gt;()&gt; get_elem, int verbosity, LogManager::SeverityLevel sev)</div><div class="ttdoc">Create hierarchy of elements run on parents levels.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02806">free_surface.cpp:2806</a></div></div>
<div class="ttc" id="astruct_free_surface_html_aa6539a6215159c2c4df22edf4442f70f"><div class="ttname"><a href="struct_free_surface.html#aa6539a6215159c2c4df22edf4442f70f">FreeSurface::findEntitiesCrossedByPhaseInterface</a></div><div class="ttdeci">std::vector&lt; Range &gt; findEntitiesCrossedByPhaseInterface(size_t overlap)</div><div class="ttdoc">Find entities on refinement levels.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02453">free_surface.cpp:2453</a></div></div>
<div class="ttc" id="astruct_free_surface_html_adc4e43a82a3bfc8bb8d78d2e8d48dd5d"><div class="ttname"><a href="struct_free_surface.html#adc4e43a82a3bfc8bb8d78d2e8d48dd5d">FreeSurface::assembleSystem</a></div><div class="ttdeci">MoFEMErrorCode assembleSystem()</div><div class="ttdoc">[Data projection]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l01581">free_surface.cpp:1581</a></div></div>
<div class="ttc" id="astruct_free_surface_html_ae6f967e01e46cfc7d59813a9dffe778e"><div class="ttname"><a href="struct_free_surface.html#ae6f967e01e46cfc7d59813a9dffe778e">FreeSurface::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00479">free_surface.cpp:479</a></div></div>
<div class="ttc" id="astruct_free_surface_html_ae8a9be5bb92874beaf3d16d4fab499a6"><div class="ttname"><a href="struct_free_surface.html#ae8a9be5bb92874beaf3d16d4fab499a6">FreeSurface::refineMesh</a></div><div class="ttdeci">MoFEMErrorCode refineMesh(size_t overlap)</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02575">free_surface.cpp:2575</a></div></div>
<div class="ttc" id="astruct_free_surface_html_af7617d5702951e33f34ce60d08456987"><div class="ttname"><a href="struct_free_surface.html#af7617d5702951e33f34ce60d08456987">FreeSurface::makeRefProblem</a></div><div class="ttdeci">MoFEMErrorCode makeRefProblem()</div></div>
<div class="ttc" id="astruct_free_surface_html_afbae12770d9512be114113fda808366b"><div class="ttname"><a href="struct_free_surface.html#afbae12770d9512be114113fda808366b">FreeSurface::solveSystem</a></div><div class="ttdeci">MoFEMErrorCode solveSystem()</div><div class="ttdoc">[Solve]</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02044">free_surface.cpp:2044</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_calculate_lift_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_calculate_lift.html">FreeSurfaceOps::OpCalculateLift</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00003">FreeSurfaceOps.hpp:3</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_g__d_g_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_g__d_g.html">FreeSurfaceOps::OpLhsG_dG</a></div><div class="ttdoc">Lhs for H dH.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l01321">FreeSurfaceOps.hpp:1321</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_g__d_h_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_g__d_h.html">FreeSurfaceOps::OpLhsG_dH</a></div><div class="ttdoc">Lhs for H dH.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l01249">FreeSurfaceOps.hpp:1249</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_h__d_g_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_h__d_g.html">FreeSurfaceOps::OpLhsH_dG</a></div><div class="ttdoc">Lhs for H dH.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l01117">FreeSurfaceOps.hpp:1117</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_h__d_h_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_h__d_h.html">FreeSurfaceOps::OpLhsH_dH</a></div><div class="ttdoc">Lhs for H dH.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00973">FreeSurfaceOps.hpp:973</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_h__d_u_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_h__d_u.html">FreeSurfaceOps::OpLhsH_dU</a></div><div class="ttdoc">Lhs for H dU.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00915">FreeSurfaceOps.hpp:915</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_u__d_g_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_u__d_g.html">FreeSurfaceOps::OpLhsU_dG</a></div><div class="ttdoc">Lhs for G dH.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00732">FreeSurfaceOps.hpp:732</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_u__d_h_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_u__d_h.html">FreeSurfaceOps::OpLhsU_dH</a></div><div class="ttdoc">Lhs for U dH.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00611">FreeSurfaceOps.hpp:611</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_lhs_u__d_u_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_lhs_u__d_u.html">FreeSurfaceOps::OpLhsU_dU</a></div><div class="ttdoc">Lhs for U dU.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00473">FreeSurfaceOps.hpp:473</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_loop_side_get_data_for_side_ele_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_loop_side_get_data_for_side_ele.html">FreeSurfaceOps::OpLoopSideGetDataForSideEle</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00576">FreeSurfaceOps.hpp:576</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_normal_constrain_lhs_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_normal_constrain_lhs.html">FreeSurfaceOps::OpNormalConstrainLhs</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00195">FreeSurfaceOps.hpp:195</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_normal_constrain_rhs_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_normal_constrain_rhs.html">FreeSurfaceOps::OpNormalConstrainRhs</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00050">FreeSurfaceOps.hpp:50</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_normal_force_rhs_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_normal_force_rhs.html">FreeSurfaceOps::OpNormalForceRhs</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00092">FreeSurfaceOps.hpp:92</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_rhs_g_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_rhs_g.html">FreeSurfaceOps::OpRhsG</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l01181">FreeSurfaceOps.hpp:1181</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_rhs_h_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_rhs_h.html">FreeSurfaceOps::OpRhsH</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00795">FreeSurfaceOps.hpp:795</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_rhs_u_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_rhs_u.html">FreeSurfaceOps::OpRhsU</a></div><div class="ttdoc">Rhs for U.</div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00356">FreeSurfaceOps.hpp:356</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_wetting_angle_lhs_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_wetting_angle_lhs.html">FreeSurfaceOps::OpWettingAngleLhs</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00246">FreeSurfaceOps.hpp:246</a></div></div>
<div class="ttc" id="astruct_free_surface_ops_1_1_op_wetting_angle_rhs_html"><div class="ttname"><a href="struct_free_surface_ops_1_1_op_wetting_angle_rhs.html">FreeSurfaceOps::OpWettingAngleRhs</a></div><div class="ttdef"><b>Definition</b> <a href="_free_surface_ops_8hpp_source.html#l00138">FreeSurfaceOps.hpp:138</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_basic_method_html_a758c8a8cdac350c8d3fe0bc8c147992e"><div class="ttname"><a href="struct_mo_f_e_m_1_1_basic_method.html#a758c8a8cdac350c8d3fe0bc8c147992e">MoFEM::BasicMethod::getCacheWeakPtr</a></div><div class="ttdeci">boost::weak_ptr&lt; CacheTuple &gt; getCacheWeakPtr() const</div><div class="ttdoc">Get the cache weak ptr object.</div><div class="ttdef"><b>Definition</b> <a href="_loop_methods_8hpp_source.html#l00348">LoopMethods.hpp:348</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bc_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bc_manager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition</b> <a href="_bc_manager_8hpp_source.html#l00025">BcManager.hpp:25</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_comm_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_comm_interface.html">MoFEM::CommInterface</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="_comm_interface_8hpp_source.html#l00021">CommInterface.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a093526a60371b07213a0be2aaf7afa35"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">MoFEM::CoreInterface::get_comm_size</a></div><div class="ttdeci">virtual int get_comm_size() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a151a5aaa12774c726c7a32ba250d2586"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a151a5aaa12774c726c7a32ba250d2586">MoFEM::CoreInterface::get_field_bit_number</a></div><div class="ttdeci">virtual FieldBitNumber get_field_bit_number(const std::string name) const =0</div><div class="ttdoc">get field bit number</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a9b2bc8c1b980f49d31a0b5f7fbe756f5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html">MoFEM::CoreTmp&lt; 0 &gt;</a></div><div class="ttdoc">Core (interface) class.</div><div class="ttdef"><b>Definition</b> <a href="_core_8hpp_source.html#l00082">Core.hpp:82</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_a137f1f2092d00ef0c1ec679db94b8cb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#a137f1f2092d00ef0c1ec679db94b8cb0">MoFEM::CoreTmp&lt; 0 &gt;::Initialize</a></div><div class="ttdeci">static MoFEMErrorCode Initialize(int *argc, char ***args, const char file[], const char help[])</div><div class="ttdoc">Initializes the MoFEM database PETSc, MOAB and MPI.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00072">Core.cpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_3_010_01_4_html_aa5abe3b5d998e2dc50e4ef6916915eb1"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp_3_010_01_4.html#aa5abe3b5d998e2dc50e4ef6916915eb1">MoFEM::CoreTmp&lt; 0 &gt;::Finalize</a></div><div class="ttdeci">static MoFEMErrorCode Finalize()</div><div class="ttdoc">Checks for options to be called at the conclusion of the program.</div><div class="ttdef"><b>Definition</b> <a href="_core_8cpp_source.html#l00112">Core.cpp:112</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_data_operator_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_data_operator.html">MoFEM::DataOperator</a></div><div class="ttdoc">base operator to do operations at Gauss Pt. level</div><div class="ttdef"><b>Definition</b> <a href="_data_operators_8hpp_source.html#l00024">DataOperators.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_field_blas_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_field_blas.html">MoFEM::FieldBlas</a></div><div class="ttdoc">Basic algebra on fields.</div><div class="ttdef"><b>Definition</b> <a href="_field_blas_8hpp_source.html#l00021">FieldBlas.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forms_integrators_1_1_assembly_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">MoFEM::FormsIntegrators::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition</b> <a href="_forms_integrators_8hpp_source.html#l00317">FormsIntegrators.hpp:317</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_i_s_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_i_s_manager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition</b> <a href="_i_s_manager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_natural_b_c_1_1_assembly_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_natural_b_c_1_1_assembly.html">MoFEM::NaturalBC::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition</b> <a href="_natural_8hpp_source.html#l00065">Natural.hpp:65</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_add_parent_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_add_parent_ent_data.html">MoFEM::OpAddParentEntData</a></div><div class="ttdoc">Operator to project base functions from parent entity to child.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_projection_data_operators_8hpp_source.html#l00066">MeshProjectionDataOperators.hpp:66</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_divergence_vector_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_divergence_vector_field_values.html">MoFEM::OpCalculateDivergenceVectorFieldValues</a></div><div class="ttdoc">Calculate field values (template specialization) for tensor field rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00488">UserDataOperators.hpp:489</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_gradient.html">MoFEM::OpCalculateScalarFieldGradient</a></div><div class="ttdoc">Get field gradients at integration pts for scalar filed rank 0, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l01319">UserDataOperators.hpp:1321</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_scalar_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_scalar_field_values.html">MoFEM::OpCalculateScalarFieldValues</a></div><div class="ttdoc">Get value at integration points for scalar field.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00082">UserDataOperators.hpp:83</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">MoFEM::OpCalculateVectorFieldValuesFromPetscVecImpl</a></div><div class="ttdoc">Approximate field values for given petsc vector.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00597">UserDataOperators.hpp:598</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">MoFEM::OpCalculateVectorFieldValues</a></div><div class="ttdoc">Get values at integration pts for tensor filed rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00468">UserDataOperators.hpp:470</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_loop_side_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_loop_side.html">MoFEM::OpLoopSide</a></div><div class="ttdoc">Element used to execute operators on side of the element.</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l01291">ForcesAndSourcesCore.hpp:1291</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_post_proc_map_in_moab_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00698">PostProcBrokenMeshInMoabBase.hpp:698</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_run_parent_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_run_parent.html">MoFEM::OpRunParent</a></div><div class="ttdoc">Operator to execute finite element instance on parent element. This operator is typically used to pro...</div><div class="ttdef"><b>Definition</b> <a href="_mesh_projection_data_operators_8hpp_source.html#l00017">MeshProjectionDataOperators.hpp:17</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">MoFEM::PipelineManager::ElementsAndOpsByDim</a></div><div class="ttdef"><b>Definition</b> <a href="_pipeline_manager_8hpp_source.html#l00038">PipelineManager.hpp:38</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager.html">MoFEM::PipelineManager</a></div><div class="ttdoc">PipelineManager interface.</div><div class="ttdef"><b>Definition</b> <a href="_pipeline_manager_8hpp_source.html#l00024">PipelineManager.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_cont_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_cont_impl.html">MoFEM::PostProcBrokenMeshInMoabBaseContImpl</a></div><div class="ttdef"><b>Definition</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00883">PostProcBrokenMeshInMoabBase.hpp:884</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab.html">MoFEM::PostProcBrokenMeshInMoab</a></div><div class="ttdef"><b>Definition</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00667">PostProcBrokenMeshInMoabBase.hpp:667</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problems_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problems_manager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition</b> <a href="_problems_manager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_simple_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_simple.html">MoFEM::Simple</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition</b> <a href="_simple_8hpp_source.html#l00027">Simple.hpp:27</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_smart_petsc_obj_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">MoFEM::SmartPetscObj</a></div><div class="ttdoc">intrusive_ptr for managing petsc objects</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00082">PetscSmartObj.hpp:83</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_t_s_method_html_a5eb15bd118b06018110428672a4821c7"><div class="ttname"><a href="struct_mo_f_e_m_1_1_t_s_method.html#a5eb15bd118b06018110428672a4821c7">MoFEM::TSMethod::ts_t</a></div><div class="ttdeci">PetscReal ts_t</div><div class="ttdoc">time</div><div class="ttdef"><b>Definition</b> <a href="_loop_methods_8hpp_source.html#l00166">LoopMethods.hpp:166</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_t_s_method_html_ad6cfbd3594ea3521910e4dc8db9d5fb0"><div class="ttname"><a href="struct_mo_f_e_m_1_1_t_s_method.html#ad6cfbd3594ea3521910e4dc8db9d5fb0">MoFEM::TSMethod::ts_step</a></div><div class="ttdeci">PetscInt ts_step</div><div class="ttdoc">time step number</div><div class="ttdef"><b>Definition</b> <a href="_loop_methods_8hpp_source.html#l00163">LoopMethods.hpp:163</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unique__mi__tag_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unique__mi__tag.html">MoFEM::Unique_mi_tag</a></div><div class="ttdef"><b>Definition</b> <a href="_tag_multi_indices_8hpp_source.html#l00018">TagMultiIndices.hpp:18</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astruct_monitor_html"><div class="ttname"><a href="struct_monitor.html">Monitor</a></div><div class="ttdoc">[Push operators to pipeline]</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00774">dynamic_first_order_con_law.cpp:774</a></div></div>
<div class="ttc" id="astruct_monitor_html_a51e14b6b79321ce8c5b4e442f69db386"><div class="ttname"><a href="struct_monitor.html#a51e14b6b79321ce8c5b4e442f69db386">Monitor::Monitor</a></div><div class="ttdeci">Monitor(SmartPetscObj&lt; DM &gt; dm, MoFEM::Interface &amp;m_field, boost::shared_ptr&lt; PostProcEle &gt; post_proc, boost::shared_ptr&lt; PostProcFaceEle &gt; post_proc_bdry, boost::shared_ptr&lt; MatrixDouble &gt; velocity_field_ptr, boost::shared_ptr&lt; MatrixDouble &gt; x2_field_ptr, boost::shared_ptr&lt; MatrixDouble &gt; geometry_field_ptr, std::array&lt; double, 3 &gt; pass_field_eval_coords, boost::shared_ptr&lt; SetPtsData &gt; pass_field_eval_data)</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00776">dynamic_first_order_con_law.cpp:776</a></div></div>
<div class="ttc" id="astruct_monitor_html_a63e22b46f3401bac9f25cb3e0d2a68a2"><div class="ttname"><a href="struct_monitor.html#a63e22b46f3401bac9f25cb3e0d2a68a2">Monitor::postProcMesh</a></div><div class="ttdeci">boost::shared_ptr&lt; moab::Core &gt; postProcMesh</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02036">free_surface.cpp:2036</a></div></div>
<div class="ttc" id="astruct_monitor_html_a954e9a046eb88f00d82eb7529d1506a1"><div class="ttname"><a href="struct_monitor.html#a954e9a046eb88f00d82eb7529d1506a1">Monitor::dM</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dM</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00873">dynamic_first_order_con_law.cpp:873</a></div></div>
<div class="ttc" id="astruct_monitor_html_aa3f39564d02335db9af906cd8a77b86b"><div class="ttname"><a href="struct_monitor.html#aa3f39564d02335db9af906cd8a77b86b">Monitor::postProcess</a></div><div class="ttdeci">MoFEMErrorCode postProcess()</div><div class="ttdoc">function is run at the end of loop</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00789">dynamic_first_order_con_law.cpp:789</a></div></div>
<div class="ttc" id="astruct_monitor_html_abf0c895cd7f4330ae3df3dd04ca10a44"><div class="ttname"><a href="struct_monitor.html#abf0c895cd7f4330ae3df3dd04ca10a44">Monitor::liftVec</a></div><div class="ttdeci">boost::shared_ptr&lt; VectorDouble &gt; liftVec</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02040">free_surface.cpp:2040</a></div></div>
<div class="ttc" id="astruct_monitor_html_ac219a0368b742c497988ab7af05b7928"><div class="ttname"><a href="struct_monitor.html#ac219a0368b742c497988ab7af05b7928">Monitor::liftFE</a></div><div class="ttdeci">boost::shared_ptr&lt; BoundaryEle &gt; liftFE</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02039">free_surface.cpp:2039</a></div></div>
<div class="ttc" id="astruct_monitor_html_adfbe1bfb50dd34928514ba723a7723c1"><div class="ttname"><a href="struct_monitor.html#adfbe1bfb50dd34928514ba723a7723c1">Monitor::postProc</a></div><div class="ttdeci">boost::shared_ptr&lt; PostProcEle &gt; postProc</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00874">dynamic_first_order_con_law.cpp:874</a></div></div>
<div class="ttc" id="astruct_monitor_html_ae0160cce2daeb742610993dd1b4e3f51"><div class="ttname"><a href="struct_monitor.html#ae0160cce2daeb742610993dd1b4e3f51">Monitor::postProcEdge</a></div><div class="ttdeci">boost::shared_ptr&lt; PostProcEleBdyCont &gt; postProcEdge</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02038">free_surface.cpp:2038</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html"><div class="ttname"><a href="struct_t_s_pre_post_proc.html">TSPrePostProc</a></div><div class="ttdoc">Set of functions called by PETSc solver used to refine and update mesh.</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00383">dynamic_first_order_con_law.cpp:383</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a019ad880bca1112380d99d65cabcdc83"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a019ad880bca1112380d99d65cabcdc83">TSPrePostProc::tsCtxPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; TsCtx &gt; tsCtxPtr</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00466">free_surface.cpp:466</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a2b715125764ba0fb6c6795c0ee3224d2"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a2b715125764ba0fb6c6795c0ee3224d2">TSPrePostProc::~TSPrePostProc</a></div><div class="ttdeci">virtual ~TSPrePostProc()=default</div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a2d152ba57407eedcc035262b813171e8"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a2d152ba57407eedcc035262b813171e8">TSPrePostProc::globRes</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; globRes</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00459">free_surface.cpp:459</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a337f6fb2dd3d45814b6288bad9b76e8a"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a337f6fb2dd3d45814b6288bad9b76e8a">TSPrePostProc::subB</a></div><div class="ttdeci">SmartPetscObj&lt; Mat &gt; subB</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00460">free_surface.cpp:460</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a3f680d202782ea9ba9fd7fef764359ad"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a3f680d202782ea9ba9fd7fef764359ad">TSPrePostProc::globSol</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; globSol</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00422">free_surface.cpp:422</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a42c0ddb4765f16b94923b46aeb258b5a"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a42c0ddb4765f16b94923b46aeb258b5a">TSPrePostProc::fsRawPtr</a></div><div class="ttdeci">Example * fsRawPtr</div><div class="ttdef"><b>Definition</b> <a href="dynamic__first__order__con__law_8cpp_source.html#l00397">dynamic_first_order_con_law.cpp:397</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a55a9f26c6211f55d1b267f5766d45cb4"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a55a9f26c6211f55d1b267f5766d45cb4">TSPrePostProc::getSubVector</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; getSubVector()</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03127">free_surface.cpp:3127</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a5f73ef09d0d6bee6da2efe31de1bb91a"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a5f73ef09d0d6bee6da2efe31de1bb91a">TSPrePostProc::tsMonitor</a></div><div class="ttdeci">static MoFEMErrorCode tsMonitor(TS ts, PetscInt step, PetscReal t, Vec u, void *ctx)</div><div class="ttdoc">Wrapper for TS monitor.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03052">free_surface.cpp:3052</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a65c9fdb310ee9855607e8f3ec6e805db"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a65c9fdb310ee9855607e8f3ec6e805db">TSPrePostProc::pcApply</a></div><div class="ttdeci">static MoFEMErrorCode pcApply(PC pc, Vec pc_f, Vec pc_x)</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03087">free_surface.cpp:3087</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a7098c3f3aa8ebc6c31c87caed0dcce29"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a7098c3f3aa8ebc6c31c87caed0dcce29">TSPrePostProc::getScatter</a></div><div class="ttdeci">SmartPetscObj&lt; VecScatter &gt; getScatter(Vec x, Vec y, enum FR fr)</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03107">free_surface.cpp:3107</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a76a5770ed5d62aafbd7d06cce02d31ae"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a76a5770ed5d62aafbd7d06cce02d31ae">TSPrePostProc::solverSubDM</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; solverSubDM</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00421">free_surface.cpp:421</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a78cc980454599ea5b44b2252e3f5d067"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a78cc980454599ea5b44b2252e3f5d067">TSPrePostProc::tsSetIJacobian</a></div><div class="ttdeci">static MoFEMErrorCode tsSetIJacobian(TS ts, PetscReal t, Vec u, Vec u_t, PetscReal a, Mat A, Mat B, void *ctx)</div><div class="ttdoc">Wrapper for SNES Lhs.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03025">free_surface.cpp:3025</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a86adf30485426c053d1c4cb45e134ed2"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a86adf30485426c053d1c4cb45e134ed2">TSPrePostProc::snesCtxPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; SnesCtx &gt; snesCtxPtr</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00464">free_surface.cpp:464</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a8711d535a7c4e3c854da590188f734e8"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a8711d535a7c4e3c854da590188f734e8">TSPrePostProc::tsPreProc</a></div><div class="ttdeci">static MoFEMErrorCode tsPreProc(TS ts)</div><div class="ttdoc">Pre process time step.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02872">free_surface.cpp:2872</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_a91cdfc76b8bef1ae795d8800a78a45ed"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#a91cdfc76b8bef1ae795d8800a78a45ed">TSPrePostProc::TSPrePostProc</a></div><div class="ttdeci">TSPrePostProc()=default</div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_ab6aae3ab3d56525658dadea33e1f6129"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#ab6aae3ab3d56525658dadea33e1f6129">TSPrePostProc::tsSetIFunction</a></div><div class="ttdeci">static MoFEMErrorCode tsSetIFunction(TS ts, PetscReal t, Vec u, Vec u_t, Vec f, void *ctx)</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02997">free_surface.cpp:2997</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_abda9f1a13eb25322d633155cbd0402eb"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#abda9f1a13eb25322d633155cbd0402eb">TSPrePostProc::pcSetup</a></div><div class="ttdeci">static MoFEMErrorCode pcSetup(PC pc)</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03077">free_surface.cpp:3077</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_ac81a85e08d887a61d720779da1640e45"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#ac81a85e08d887a61d720779da1640e45">TSPrePostProc::tsPostProc</a></div><div class="ttdeci">static MoFEMErrorCode tsPostProc(TS ts)</div><div class="ttdoc">Post process time step.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l02987">free_surface.cpp:2987</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_acef52bd1dd574d27fb470f6cab8f24fc"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#acef52bd1dd574d27fb470f6cab8f24fc">TSPrePostProc::tsPreStage</a></div><div class="ttdeci">static MoFEMErrorCode tsPreStage(TS ts)</div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_aef485703101f9710430c3288f65d37ad"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#aef485703101f9710430c3288f65d37ad">TSPrePostProc::tsSetUp</a></div><div class="ttdeci">MoFEMErrorCode tsSetUp(TS ts)</div><div class="ttdoc">Used to setup TS solver.</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l03131">free_surface.cpp:3131</a></div></div>
<div class="ttc" id="astruct_t_s_pre_post_proc_html_af3c68ebd9603b10fbf1a97f033e969a0"><div class="ttname"><a href="struct_t_s_pre_post_proc.html#af3c68ebd9603b10fbf1a97f033e969a0">TSPrePostProc::subKSP</a></div><div class="ttdeci">SmartPetscObj&lt; KSP &gt; subKSP</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00461">free_surface.cpp:461</a></div></div>
<div class="ttc" id="atensor__divergence__operator_8cpp_html_a328c51ff3e09057f317d8821c4b80f91"><div class="ttname"><a href="tensor__divergence__operator_8cpp.html#a328c51ff3e09057f317d8821c4b80f91">AssemblyBoundaryEleOp</a></div><div class="ttdeci">FormsIntegrators&lt; BoundaryEleOp &gt;::Assembly&lt; A &gt;::OpBase AssemblyBoundaryEleOp</div><div class="ttdef"><b>Definition</b> <a href="tensor__divergence__operator_8cpp_source.html#l00060">tensor_divergence_operator.cpp:60</a></div></div>
<div class="ttc" id="atensor__divergence__operator_8cpp_html_a614aff059c889b5343fba0aaadecebb4"><div class="ttname"><a href="tensor__divergence__operator_8cpp.html#a614aff059c889b5343fba0aaadecebb4">AssemblyDomainEleOp</a></div><div class="ttdeci">FormsIntegrators&lt; DomainEleOp &gt;::Assembly&lt; A &gt;::OpBase AssemblyDomainEleOp</div><div class="ttdef"><b>Definition</b> <a href="tensor__divergence__operator_8cpp_source.html#l00059">tensor_divergence_operator.cpp:59</a></div></div>
<div class="ttc" id="atensor__divergence__operator_8cpp_html_afa76c795f8d0a75dfa200089923c7cb6"><div class="ttname"><a href="tensor__divergence__operator_8cpp.html#afa76c795f8d0a75dfa200089923c7cb6">COORD_TYPE</a></div><div class="ttdeci">constexpr CoordinateTypes COORD_TYPE</div><div class="ttdef"><b>Definition</b> <a href="tensor__divergence__operator_8cpp_source.html#l00036">tensor_divergence_operator.cpp:36</a></div></div>
<div class="ttc" id="athermo__elastic_8cpp_html_a11853fc6dfa8d79a1adb95c8c02626c9"><div class="ttname"><a href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a></div><div class="ttdeci">auto save_range</div><div class="ttdef"><b>Definition</b> <a href="thermo__elastic_8cpp_source.html#l00157">thermo_elastic.cpp:157</a></div></div>
<div class="ttc" id="athermo__elastic_8cpp_html_af2f99d568add28fdf16023f29fb8ef02"><div class="ttname"><a href="thermo__elastic_8cpp.html#af2f99d568add28fdf16023f29fb8ef02">BoundaryNaturalBC</a></div><div class="ttdeci">NaturalBC&lt; BoundaryEleOp &gt;::Assembly&lt; PETSC &gt;::LinearForm&lt; GAUSS &gt; BoundaryNaturalBC</div><div class="ttdoc">[Body and heat source]</div><div class="ttdef"><b>Definition</b> <a href="thermo__elastic_8cpp_source.html#l00110">thermo_elastic.cpp:110</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
