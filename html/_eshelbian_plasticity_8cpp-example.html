<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: EshelbianPlasticity.cpp</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="doc-content">
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">EshelbianPlasticity.cpp</div></div>
</div><!--header-->
<div class="contents">
<p>Eshelbian plasticity implementation.</p>
<p>Eshelbian plasticity implementation</p>
<div class="fragment"><div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * \file EshelbianPlasticity.cpp</span></div>
<div class="line"><span class="comment"> * \example EshelbianPlasticity.cpp</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * \brief Eshelbian plasticity implementation</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#define SINGULARITY</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a>&gt;</span></div>
<div class="line"><span class="keyword">using namespace </span><a class="code hl_namespace" href="namespace_mo_f_e_m.html">MoFEM</a>;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_c_g_g_tonsorial_bubble_base_8hpp.html">CGGTonsorialBubbleBase.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_eshelbian_plasticity_8hpp.html">EshelbianPlasticity.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;boost/math/constants/constants.hpp&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="cholesky_8hpp.html">cholesky.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python/def.hpp&gt;</span></div>
<div class="line"><span class="preprocessor">  #include &lt;boost/python/numpy.hpp&gt;</span></div>
<div class="line"><span class="keyword">namespace </span>bp = boost::python;</div>
<div class="line"><span class="keyword">namespace </span>np = boost::python::numpy;</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">  #pragma message &quot;With PYTHON_SDF&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">  #pragma message &quot;Without PYTHON_SDF&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_eshelbian_aux_8hpp.html">EshelbianAux.hpp</a>&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_eshelbian_contact_8hpp.html">EshelbianContact.hpp</a>&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">extern</span> <span class="stringliteral">&quot;C&quot;</span> {</div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="quad_8h.html">phg-quadrule/quad.h</a>&gt;</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_eshelbian_plasticity.html">EshelbianPlasticity</a> {</div>
<div class="line"><span class="keyword">struct </span>VolUserDataOperatorStabAssembly</div>
<div class="line">    : <span class="keyword">public</span> VolumeElementForcesAndSourcesCore::UserDataOperator {</div>
<div class="line">  <span class="keyword">using </span>VolumeElementForcesAndSourcesCore::UserDataOperator::UserDataOperator;</div>
<div class="line">};</div>
<div class="line"><span class="keyword">struct </span>FaceUserDataOperatorStabAssembly</div>
<div class="line">    : <span class="keyword">public</span> FaceElementForcesAndSourcesCore::UserDataOperator {</div>
<div class="line">  <span class="keyword">using </span>FaceElementForcesAndSourcesCore::UserDataOperator::UserDataOperator;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace EshelbianPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a0" name="a0"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a id="_a1" name="_a1"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                 <span class="keyword">const</span> std::string block_name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">  <a id="_a2" name="_a2"></a><a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> mesh_mng = m_field.<a id="a3" name="a3"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a4" name="_a4"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <span class="keyword">auto</span> bcs = mesh_mng-&gt;<a id="a5" name="a5"></a><a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line"> </div>
<div class="line">      std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % block_name).str())</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bcs) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line">    <a id="a6" name="a6"></a><a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(bc-&gt;getMeshsetIdEntitiesByDimension(m_field.<a id="a7" name="a7"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), dim,</div>
<div class="line">                                                       faces, <span class="keyword">true</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;get meshset ents&quot;</span>);</div>
<div class="line">    <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.merge(faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a8" name="a8"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a652208c3378b6381518790e0b1cdfc96">get_block_meshset</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field, <span class="keyword">const</span> <span class="keywordtype">int</span> ms_id,</div>
<div class="line">                              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> cubit_bc_type) {</div>
<div class="line">  <span class="keyword">auto</span> mesh_mng = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <a id="_a9" name="_a9"></a><a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line">  <a id="a10" name="a10"></a><a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> mesh_mng-&gt;getMeshset(ms_id, cubit_bc_type, meshset);</div>
<div class="line">  <span class="keywordflow">return</span> meshset;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a11" name="a11"></a><a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab::Interface &amp;moab, <span class="keyword">const</span> std::string name,</div>
<div class="line">                       <span class="keyword">const</span> <a class="code hl_class" href="class_range.html">Range</a> r, std::vector&lt;Tag&gt; tags = {}) {</div>
<div class="line">  <a id="a12" name="a12"></a><a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> out_meshset = <a class="code hl_function" href="namespace_mo_f_e_m.html#ad17eefd5d88d2b51c71ec46cae8569ac">get_temp_meshset_ptr</a>(moab);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.add_entities(*out_meshset, r);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size()) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.write_file(name.c_str(), <span class="stringliteral">&quot;VTK&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, out_meshset-&gt;get_ptr(), 1,</div>
<div class="line">                           tags.data(), tags.size());</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a id="a13" name="a13"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::warning) &lt;&lt; <span class="stringliteral">&quot;Empty range for &quot;</span> &lt;&lt; name;</div>
<div class="line">  }</div>
<div class="line">  <a id="a14" name="a14"></a><a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a15" name="a15"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="class_range.html">Range</a> &amp;&amp;skin) {</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> boundary_ents;</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a id="a16" name="a16"></a><a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin,</div>
<div class="line">                                       PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                       PSTATUS_NOT, -1, &amp;boundary_ents),</div>
<div class="line">                 <span class="stringliteral">&quot;filter_pstatus&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a17" name="a17"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="class_range.html">Range</a> skin) {</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> owner_ents;</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin, PSTATUS_NOT_OWNED, PSTATUS_NOT, -1,</div>
<div class="line">                                       &amp;owner_ents),</div>
<div class="line">                 <span class="stringliteral">&quot;filter_pstatus&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> owner_ents;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a18" name="a18"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="class_range.html">Range</a> body_ents) {</div>
<div class="line">  Skinner skin(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> skin_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents), <span class="stringliteral">&quot;find_skin&quot;</span>);</div>
<div class="line">  <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a19" name="a19"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a08d97e06a4534524e4b6b87cfb27c4ae">get_crack_front_edges</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field, <a class="code hl_class" href="class_range.html">Range</a> crack_faces,</div>
<div class="line">                                  <span class="keywordtype">bool</span> parallel = <span class="keyword">true</span>) {</div>
<div class="line">  <span class="keyword">auto</span> &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">  <span class="keyword">auto</span> crack_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, crack_faces);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">      m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a id="a20" name="a20"></a><a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents),</div>
<div class="line">      <span class="stringliteral">&quot;get_entities_by_dimension&quot;</span>);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> body_skin;</div>
<div class="line">  <span class="keywordflow">if</span> (parallel) {</div>
<div class="line">    body_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(m_field, <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, body_ents));</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    body_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, body_ents);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> body_skin_edges;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(body_skin, 1, <span class="keyword">true</span>, body_skin_edges,</div>
<div class="line">                                      moab::Interface::UNION),</div>
<div class="line">                 <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">  crack_skin = subtract(crack_skin, body_skin_edges);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (parallel) {</div>
<div class="line">    std::map&lt;int, Range&gt; received_ents;</div>
<div class="line">    <a id="a21" name="a21"></a><a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">        m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a22" name="_a22"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;<a id="a23" name="a23"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_comm_interface.html#aaf48742e4832bab940f922703f6176b6">synchroniseEntities</a>(</div>
<div class="line">            crack_skin, &amp;received_ents),</div>
<div class="line">        <span class="stringliteral">&quot;synchroniseEntities&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a id="a24" name="a24"></a><a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : received_ents) {</div>
<div class="line">      crack_skin.merge(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> to_remove;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : received_ents) {</div>
<div class="line">      <span class="comment">// if the same edges appear on two or more processors, they are not at</span></div>
<div class="line">      <span class="comment">// the front</span></div>
<div class="line">      to_remove.merge(<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second);</div>
<div class="line">    }</div>
<div class="line">    crack_skin = subtract(crack_skin, to_remove);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(</div>
<div class="line">        m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_comm_interface.html#aaf48742e4832bab940f922703f6176b6">synchroniseEntities</a>(crack_skin),</div>
<div class="line">        <span class="stringliteral">&quot;synchroniseEntities&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> crack_skin;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">static</span> <span class="keyword">auto</span> <a id="a25" name="a25"></a><a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a711a5a75b4797d9d4f46d1a45dccaf32">get_two_sides_of_crack_surface</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field,</div>
<div class="line">                                           <a class="code hl_class" href="class_range.html">Range</a> crack_faces) {</div>
<div class="line"> </div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;get_two_sides_of_crack_surface&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!pcomm-&gt;rank()) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">        m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents),</div>
<div class="line">        <span class="stringliteral">&quot;get_entities_by_dimension&quot;</span>);</div>
<div class="line">    <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, body_ents);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> body_skin_edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(body_skin, 1, <span class="keyword">true</span>, body_skin_edges,</div>
<div class="line">                                        moab::Interface::UNION),</div>
<div class="line">                   <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> crack_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(m_field, crack_faces);</div>
<div class="line">    crack_skin = subtract(crack_skin, body_skin_edges);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(crack_faces, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>,</div>
<div class="line">                                        crack_edges, moab::Interface::UNION),</div>
<div class="line">                   <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_skin_conn;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_connectivity(crack_skin, crack_skin_conn, <span class="keyword">true</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;get_connectivity&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_skin_conn_edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(crack_skin_conn, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>,</div>
<div class="line">                                        crack_skin_conn_edges,</div>
<div class="line">                                        moab::Interface::UNION),</div>
<div class="line">                   <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">    crack_edges = subtract(crack_edges, crack_skin_conn_edges);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_conn;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_connectivity(crack_edges, crack_conn, <span class="keyword">true</span>),</div>
<div class="line">                   <span class="stringliteral">&quot;get_connectivity&quot;</span>);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> all_tets;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(crack_conn, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>, all_tets,</div>
<div class="line">                                        moab::Interface::UNION),</div>
<div class="line">                   <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                              <span class="stringliteral">&quot;all_crack_tets&quot;</span> +</div>
<div class="line">                                  boost::lexical_cast&lt;std::string&gt;(</div>
<div class="line">                                      m_field.<a id="a26" name="a26"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) +</div>
<div class="line">                                  <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                              all_tets),</div>
<div class="line">                   <span class="stringliteral">&quot;save all&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                              <span class="stringliteral">&quot;crack_edges_all_&quot;</span> +</div>
<div class="line">                                  boost::lexical_cast&lt;std::string&gt;(</div>
<div class="line">                                      m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) +</div>
<div class="line">                                  <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">                              crack_edges),</div>
<div class="line">                   <span class="stringliteral">&quot;crack_edges_all&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (crack_faces.size()) {</div>
<div class="line">      <span class="keyword">auto</span> grow = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> crack_faces_conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">            moab.get_connectivity(crack_faces, crack_faces_conn, <span class="keyword">true</span>),</div>
<div class="line">            <span class="stringliteral">&quot;get_connectivity&quot;</span>);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> <a id="a27" name="a27"></a><a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>;</div>
<div class="line">        <span class="keyword">auto</span> size_r = 0;</div>
<div class="line">        <span class="keywordflow">while</span> (size_r != <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size() &amp;&amp; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size()) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_connectivity(r, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">true</span>), <span class="stringliteral">&quot;get_connectivity&quot;</span>);</div>
<div class="line">          <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = subtract(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, crack_faces_conn);</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.size()) {</div>
<div class="line">            size_r = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size();</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>, r,</div>
<div class="line">                                                moab::Interface::UNION),</div>
<div class="line">                           <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">            <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a> = intersect(r, all_tets);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      std::pair&lt;Range, Range&gt; saids;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> all_tets_ord = all_tets;</div>
<div class="line">      <span class="keywordflow">while</span> (all_tets.size()) {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(unite(saids.first, saids.second),</div>
<div class="line">                                            <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>, faces,</div>
<div class="line">                                            moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">        faces = subtract(crack_faces, faces);</div>
<div class="line">        <span class="keywordflow">if</span> (faces.size()) {</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">          <span class="keyword">auto</span> face = faces[0];</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(&amp;face, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>, tets,</div>
<div class="line">                                              moab::Interface::UNION),</div>
<div class="line">                         <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">          <span class="keywordflow">if</span> (tets.size() != 2) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a id="a28" name="a28"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;tets.size()!=2&quot;</span>);</div>
<div class="line">          }</div>
<div class="line">          saids.first.insert(tets[0]);</div>
<div class="line">          saids.second.insert(tets[1]);</div>
<div class="line">          saids.first = grow(saids.first);</div>
<div class="line">          saids.second = grow(saids.second);</div>
<div class="line">          all_tets = subtract(all_tets, saids.first);</div>
<div class="line">          all_tets = subtract(all_tets, saids.second);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          <span class="keywordflow">break</span>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      saids.first = subtract(all_tets_ord, saids.second);</div>
<div class="line">      saids.second = subtract(all_tets_ord, saids.first);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_faces_numbers = [&amp;]() {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> first_side_faces;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(saids.first, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                            first_side_faces,</div>
<div class="line">                                            moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">        first_side_faces = subtract(first_side_faces, crack_faces);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> second_side_faces;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(saids.second, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                            second_side_faces,</div>
<div class="line">                                            moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">        second_side_faces = subtract(first_side_faces, crack_faces);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> crack_skin_faces;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(crack_skin, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                            crack_skin_faces,</div>
<div class="line">                                            moab::Interface::UNION),</div>
<div class="line">                       <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : crack_skin) {</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> e_faces;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(&amp;e, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                              e_faces, moab::Interface::UNION),</div>
<div class="line">                         <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">          e_faces = intersect(e_faces, first_side_faces);</div>
<div class="line">          <span class="keywordflow">if</span> (e_faces.size() != 1) {</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::error)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;e_faces.size()!=1 but is &quot;</span> &lt;&lt; e_faces.size();</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;e_faces.size()!=1&quot;</span>);</div>
<div class="line">          }</div>
<div class="line">          std::vector&lt;EntityHandle&gt; faces_series;</div>
<div class="line">          faces_series.push_back(e_faces[0]);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> all_tets = saids.first;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> size = 0;</div>
<div class="line">          <span class="keywordflow">for</span> (;;) {</div>
<div class="line">            <span class="keyword">auto</span> last_face = <a class="code hl_class" href="class_range.html">Range</a>(faces_series.back(), faces_series.back());</div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(last_face, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>,</div>
<div class="line">                                                tets, moab::Interface::UNION),</div>
<div class="line">                           <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">            tets = subtract(tets, all_tets);</div>
<div class="line">            all_tets.merge(tets);</div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> tets_faces;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.get_adjacencies(tets, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                                tets_faces,</div>
<div class="line">                                                moab::Interface::UNION),</div>
<div class="line">                           <span class="stringliteral">&quot;get_adjacencies&quot;</span>);</div>
<div class="line">            tets_faces = intersect(tets_faces, crack_skin_faces);</div>
<div class="line">            tets_faces = subtract(tets_faces, last_face);</div>
<div class="line">            tets_faces = subtract(tets_faces, crack_faces);</div>
<div class="line">            <span class="keywordflow">if</span> (tets_faces.size()) {</div>
<div class="line">              <span class="keywordflow">if</span> (tets_faces.size() != 1) {</div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::error)</div>
<div class="line">                    &lt;&lt; <span class="stringliteral">&quot;tets_faces.size()!=1 but is &quot;</span> &lt;&lt; tets_faces.size();</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                  <span class="stringliteral">&quot;tets_faces.size()!=1&quot;</span>);</div>
<div class="line">              }</div>
<div class="line">              faces_series.push_back(tets_faces[0]);</div>
<div class="line">            } <span class="keywordflow">else</span> {</div>
<div class="line">              <span class="keywordflow">break</span>;</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">int</span> def_val[] = {-1};</div>
<div class="line">            <a id="_a29" name="_a29"></a><a class="code hl_class" href="class_tag.html">Tag</a> th_face_order;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.tag_get_handle(</div>
<div class="line">                               <span class="stringliteral">&quot;FACE_INDEX&quot;</span>, 1, MB_TYPE_INTEGER, th_face_order,</div>
<div class="line">                               MB_TAG_SPARSE | MB_TAG_CREAT, def_val),</div>
<div class="line">                           <span class="stringliteral">&quot;tag_get_handle&quot;</span>);</div>
<div class="line">            <span class="keywordtype">int</span> idx = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> f : faces_series) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(moab.tag_set_data(th_face_order, &amp;f, 1, &amp;idx),</div>
<div class="line">                             <span class="stringliteral">&quot;tag_set_data&quot;</span>);</div>
<div class="line">              idx++;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">            <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab, <span class="stringliteral">&quot;crack_skin_faces.vtk&quot;</span>, crack_skin_faces),</div>
<div class="line">            <span class="stringliteral">&quot;save_range&quot;</span>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_faces_numbers();</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">return</span> saids;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">return</span> std::pair&lt;Range, Range&gt;();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keyword">namespace </span><a class="code hl_namespace" href="namespace_eshelbian_plasticity.html">EshelbianPlasticity</a> {</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>DynamicRelaxationTimeScale : <span class="keyword">public</span> <a id="_a30" name="_a30"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_time_scale.html">TimeScale</a> {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span>TimeScale::TimeScale;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> <a id="a31" name="a31"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_dynamic_relaxation_time_scale.html#ac2f9d0f0316d04466a9de44dceeeb0d2">getScale</a>(<span class="keyword">const</span> <span class="keywordtype">double</span> time)<span class="keyword"> override </span>{</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a32" name="a32"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af2f5e656c08e45228c61eba5585b637d">EshelbianCore::dynamicRelaxation</a>) {</div>
<div class="line">      <span class="keywordflow">return</span> TimeScale::getScale(<a id="a33" name="a33"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a57346b56a7ba2439fbcc44096f5efc6a">EshelbianCore::dynamicTime</a>);</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> TimeScale::getScale(time);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SetIntegrationAtFrontVolume {</div>
<div class="line"> </div>
<div class="line">  <a id="a34" name="a34"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a7dc972d07b328600c38de68bd13b3d85">SetIntegrationAtFrontVolume</a>(boost::shared_ptr&lt;Range&gt; front_nodes,</div>
<div class="line">                              boost::shared_ptr&lt;Range&gt; front_edges)</div>
<div class="line">      : <a id="a35" name="a35"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>(front_nodes), <a id="a36" name="a36"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>(front_edges) {};</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a37" name="a37"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1b019460b638fe37940b91de58a6e910">operator()</a>(<a id="_a38" name="_a38"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                            <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a id="a39" name="a39"></a><a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numNodes = 4;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numEdges = 6;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> refinementLevels = 4;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = fe_raw_ptr-&gt;<a id="a40" name="a40"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#ac1d7ee38dde697833773a3b8cb197a76">mField</a>;</div>
<div class="line">    <span class="keyword">auto</span> fe_ptr = <span class="keyword">static_cast&lt;</span>Fe *<span class="keyword">&gt;</span>(fe_raw_ptr);</div>
<div class="line">    <span class="keyword">auto</span> fe_handle = fe_ptr-&gt;getFEEntityHandle();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_base_quadrature = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordtype">int</span> rule = 2 * order_data + 1;</div>
<div class="line">      <span class="keywordflow">if</span> (rule &lt; <a id="a41" name="a41"></a><a class="code hl_define" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a42" name="a42"></a><a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;dim != 3) {</div>
<div class="line">          SETERRQ(m_field.<a id="a43" name="a43"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                  <span class="stringliteral">&quot;wrong dimension&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a id="a44" name="a44"></a><a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &lt; rule) {</div>
<div class="line">          SETERRQ2(m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;wrong order %d != %d&quot;</span>, <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a id="a45" name="a45"></a><a class="code hl_variable" href="struct_q_u_a_d__.html#a4ceb3af6a1dd055a067f6c3c1f6d4c86">order</a>, rule);</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;<a id="a46" name="a46"></a><a class="code hl_variable" href="struct_q_u_a_d__.html#ad40798bbebc1ea30e30dfcde923eccaa">npoints</a>;</div>
<div class="line">        <span class="keyword">auto</span> &amp;gauss_pts = fe_ptr-&gt;gaussPts;</div>
<div class="line">        gauss_pts.resize(4, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[1], 4,</div>
<div class="line">                    &amp;gauss_pts(0, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[2], 4,</div>
<div class="line">                    &amp;gauss_pts(1, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points[3], 4,</div>
<div class="line">                    &amp;gauss_pts(2, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;weights, 1,</div>
<div class="line">                    &amp;gauss_pts(3, 0), 1);</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a id="a47" name="a47"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a id="a48" name="a48"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4,</div>
<div class="line">                                                              <span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        cblas_dcopy(4 * nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a>[rule]-&gt;points, 1, shape_ptr,</div>
<div class="line">                    1);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;rule &gt; quadrature order %d &lt; %d&quot;</span>, rule, <a class="code hl_define" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_base_quadrature();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>-&gt;size() &amp;&amp; <a id="a49" name="a49"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a5d56beb53f302e471c3627a96733b9a0">EshelbianCore::setSingularity</a>) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_nodes = [&amp;]() {</div>
<div class="line">        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(fe_handle, conn, num_nodes,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        std::bitset&lt;numNodes&gt; singular_nodes;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn = 0; nn != numNodes; ++nn) {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>-&gt;find(conn[nn]) != <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>-&gt;end()) {</div>
<div class="line">            singular_nodes.set(nn);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_nodes.reset(nn);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_nodes;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_edges = [&amp;]() {</div>
<div class="line">        std::bitset&lt;numEdges&gt; singular_edges;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">          <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> edge;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(fe_handle, 1, ee, edge);</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>-&gt;find(edge) != <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>-&gt;end()) {</div>
<div class="line">            singular_edges.set(ee);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_edges.reset(ee);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_edges;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_gauss_pts = [&amp;](<span class="keyword">auto</span> &amp;ref_gauss_pts) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        fe_ptr-&gt;gaussPts.swap(ref_gauss_pts);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a50" name="a50"></a><a class="code hl_function" href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a>(shape_ptr, &amp;fe_ptr-&gt;gaussPts(0, 0),</div>
<div class="line">                          &amp;fe_ptr-&gt;gaussPts(1, 0), &amp;fe_ptr-&gt;gaussPts(2, 0),</div>
<div class="line">                          nb_gauss_pts);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> singular_nodes = get_singular_nodes();</div>
<div class="line">      <span class="keywordflow">if</span> (singular_nodes.count()) {</div>
<div class="line">        <span class="keyword">auto</span> it_map_ref_coords = <a id="a51" name="a51"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>.find(singular_nodes.to_ulong());</div>
<div class="line">        <span class="keywordflow">if</span> (it_map_ref_coords != <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>.end()) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(it_map_ref_coords-&gt;second);</div>
<div class="line">          <a id="a52" name="a52"></a><a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> refine_quadrature = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> max_level = refinementLevels;</div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> tet;</div>
<div class="line"> </div>
<div class="line">            moab::Core moab_ref;</div>
<div class="line">            <span class="keywordtype">double</span> base_coords[] = {0, 0, 0, 1, 0, 0, 0, 1, 0, 0, 0, 1};</div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> nodes[4];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != 4; nn++)</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_vertex(&amp;base_coords[3 * nn], nodes[nn]);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_element(MBTET, nodes, 4, tet);</div>
<div class="line">            <a id="_a53" name="_a53"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp.html">MoFEM::CoreTmp</a>&lt;-1&gt; mofem_ref_core(moab_ref, PETSC_COMM_SELF, -2);</div>
<div class="line">            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field_ref = mofem_ref_core;</div>
<div class="line">            {</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> tets(tet, tet);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                  tets, 1, <span class="keyword">true</span>, edges, moab::Interface::UNION);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a54" name="_a54"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevel(</div>
<div class="line">                  tets, BitRefLevel().set(0), <span class="keyword">false</span>, <a id="a55" name="a55"></a><a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> nodes_at_front;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_nodes[nn]) {</div>
<div class="line">                <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tet, 0, nn, ent);</div>
<div class="line">                nodes_at_front.insert(ent);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> singular_edges = get_singular_edges();</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_meshset(MESHSET_SET, meshset);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_edges[ee]) {</div>
<div class="line">                <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tet, 1, ee, ent);</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.add_entities(meshset, &amp;ent, 1);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// refine mesh</span></div>
<div class="line">            <span class="keyword">auto</span> *m_ref = m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a56" name="_a56"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_mesh_refinement.html">MeshRefinement</a>&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != max_level; ll++) {</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(BitRefLevel().set(ll),</div>
<div class="line">                                                 BitRefLevel().set(), MBEDGE,</div>
<div class="line">                                                 edges);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> ref_edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_adjacencies(</div>
<div class="line">                  nodes_at_front, 1, <span class="keyword">true</span>, ref_edges, moab::Interface::UNION);</div>
<div class="line">              ref_edges = intersect(ref_edges, edges);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_entities_by_type(meshset, MBEDGE, ents, <span class="keyword">true</span>);</div>
<div class="line">              ref_edges = intersect(ref_edges, ents);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">                      BitRefLevel().set(ll), BitRefLevel().set(), MBTET, tets);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;addVerticesInTheMiddleOfEdges(</div>
<div class="line">                  ref_edges, BitRefLevel().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;refineTets(tets, BitRefLevel().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;updateMeshsetByEntitiesChildren(meshset,</div>
<div class="line">                                                    BitRefLevel().set(ll + 1),</div>
<div class="line">                                                    meshset, MBEDGE, <span class="keyword">true</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// get ref coords</span></div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                -&gt;getEntitiesByTypeAndRefLevel(BitRefLevel().set(max_level),</div>
<div class="line">                                               BitRefLevel().set(), MBTET,</div>
<div class="line">                                               tets);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab_ref, <span class="stringliteral">&quot;ref_tets.vtk&quot;</span>, tets);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            MatrixDouble ref_coords(tets.size(), 12, <span class="keyword">false</span>);</div>
<div class="line">            <span class="keywordtype">int</span> tt = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (Range::iterator tit = tets.begin(); tit != tets.end();</div>
<div class="line">                 tit++, tt++) {</div>
<div class="line">              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">              <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_connectivity(*tit, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_coords(conn, num_nodes, &amp;ref_coords(tt, 0));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">            MatrixDouble ref_gauss_pts(4, nb_gauss_pts * ref_coords.size1());</div>
<div class="line">            MatrixDouble &amp;shape_n =</div>
<div class="line">                data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>);</div>
<div class="line">            <span class="keywordtype">int</span> gg = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tt = 0; tt != ref_coords.size1(); tt++) {</div>
<div class="line">              <span class="keywordtype">double</span> *tet_coords = &amp;ref_coords(tt, 0);</div>
<div class="line">              <span class="keywordtype">double</span> det = Tools::tetVolume(tet_coords);</div>
<div class="line">              det *= 6;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ggg = 0; ggg != nb_gauss_pts; ++ggg, ++gg) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">                  ref_gauss_pts(dd, gg) =</div>
<div class="line">                      shape_n(ggg, 0) * tet_coords[3 * 0 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 1) * tet_coords[3 * 1 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 2) * tet_coords[3 * 2 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 3) * tet_coords[3 * 3 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>];</div>
<div class="line">                }</div>
<div class="line">                ref_gauss_pts(3, gg) = fe_ptr-&gt;gaussPts(3, ggg) * det;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>[singular_nodes.to_ulong()].swap(ref_gauss_pts);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>[singular_nodes.to_ulong()]);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine_quadrature();</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keyword">struct </span>Fe : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html">ForcesAndSourcesCore</a> {</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::dataOnElement;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::ForcesAndSourcesCore;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1e20c2dfc8d0572a6a3ba832fc309894">frontNodes</a>;</div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#ab7b229f126666030c6df2f79152acd6c">frontEdges</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> std::map&lt;long int, MatrixDouble&gt; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a624e7331dfc478ad470f2e0a40fb7cc5">mapRefCoords</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>SetIntegrationAtFrontFace {</div>
<div class="line"> </div>
<div class="line">  <a id="a57" name="a57"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbdb6a592360dd706ccd289d8503c01a">SetIntegrationAtFrontFace</a>(boost::shared_ptr&lt;Range&gt; front_nodes,</div>
<div class="line">                            boost::shared_ptr&lt;Range&gt; front_edges)</div>
<div class="line">      : <a id="a58" name="a58"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>(front_nodes), <a id="a59" name="a59"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>(front_edges) {};</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a60" name="a60"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad294721b379a4a6cea8db53b27fac1ec">operator()</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                            <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">false</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numNodes = 3;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> numEdges = 3;</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> refinementLevels = 4;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> &amp;m_field = fe_raw_ptr-&gt;<a class="code hl_variable" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#ac1d7ee38dde697833773a3b8cb197a76">mField</a>;</div>
<div class="line">    <span class="keyword">auto</span> fe_ptr = <span class="keyword">static_cast&lt;</span>Fe *<span class="keyword">&gt;</span>(fe_raw_ptr);</div>
<div class="line">    <span class="keyword">auto</span> fe_handle = fe_ptr-&gt;getFEEntityHandle();</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_base_quadrature = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keywordtype">int</span> rule = 2 * (order_data + 1);</div>
<div class="line">      <span class="keywordflow">if</span> (rule &lt; <a id="a61" name="a61"></a><a class="code hl_define" href="quad_8h.html#a054557173149016194334ebfa52bdfff">QUAD_2D_TABLE_SIZE</a>) {</div>
<div class="line">        <span class="keywordflow">if</span> (<a id="a62" name="a62"></a><a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;dim != 2) {</div>
<div class="line">          SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;wrong dimension&quot;</span>);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &lt; rule) {</div>
<div class="line">          SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                   <span class="stringliteral">&quot;wrong order %d != %d&quot;</span>, <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, rule);</div>
<div class="line">        }</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;<a class="code hl_variable" href="struct_q_u_a_d__.html#ad40798bbebc1ea30e30dfcde923eccaa">npoints</a>;</div>
<div class="line">        fe_ptr-&gt;gaussPts.resize(3, nb_gauss_pts, <span class="keyword">false</span>);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;points[1], 3,</div>
<div class="line">                    &amp;fe_ptr-&gt;gaussPts(0, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, &amp;<a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;points[2], 3,</div>
<div class="line">                    &amp;fe_ptr-&gt;gaussPts(1, 0), 1);</div>
<div class="line">        cblas_dcopy(nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;weights, 1,</div>
<div class="line">                    &amp;fe_ptr-&gt;gaussPts(2, 0), 1);</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 3,</div>
<div class="line">                                                              <span class="keyword">false</span>);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        cblas_dcopy(3 * nb_gauss_pts, <a class="code hl_variable" href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a>[rule]-&gt;points, 1, shape_ptr,</div>
<div class="line">                    1);</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getDiffN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(3, 2, <span class="keyword">false</span>);</div>
<div class="line">        std::copy(</div>
<div class="line">            Tools::diffShapeFunMBTRI.begin(), Tools::diffShapeFunMBTRI.end(),</div>
<div class="line">            data-&gt;dataOnEntities[MBVERTEX][0].getDiffN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin());</div>
<div class="line"> </div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        SETERRQ2(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                 <span class="stringliteral">&quot;rule &gt; quadrature order %d &lt; %d&quot;</span>, rule, <a class="code hl_define" href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a>);</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_base_quadrature();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>-&gt;size() &amp;&amp; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a5d56beb53f302e471c3627a96733b9a0">EshelbianCore::setSingularity</a>) {</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_nodes = [&amp;]() {</div>
<div class="line">        <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">        <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(fe_handle, conn, num_nodes,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        std::bitset&lt;numNodes&gt; singular_nodes;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> nn = 0; nn != numNodes; ++nn) {</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>-&gt;find(conn[nn]) != <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>-&gt;end()) {</div>
<div class="line">            singular_nodes.set(nn);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_nodes.reset(nn);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_nodes;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> get_singular_edges = [&amp;]() {</div>
<div class="line">        std::bitset&lt;numEdges&gt; singular_edges;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">          <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> edge;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_element(fe_handle, 1, ee, edge);</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>-&gt;find(edge) != <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>-&gt;end()) {</div>
<div class="line">            singular_edges.set(ee);</div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line">            singular_edges.reset(ee);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> singular_edges;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_gauss_pts = [&amp;](<span class="keyword">auto</span> &amp;ref_gauss_pts) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        fe_ptr-&gt;gaussPts.swap(ref_gauss_pts);</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">        <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">        data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).resize(nb_gauss_pts, 4);</div>
<div class="line">        <span class="keywordtype">double</span> *shape_ptr =</div>
<div class="line">            &amp;*data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>).data().begin();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a63" name="a63"></a><a class="code hl_function" href="fem__tools_8h.html#af39e9dc2be2d3d367f56d6277553ba00">ShapeMBTRI</a>(shape_ptr, &amp;fe_ptr-&gt;gaussPts(0, 0),</div>
<div class="line">                          &amp;fe_ptr-&gt;gaussPts(1, 0), nb_gauss_pts);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> singular_nodes = get_singular_nodes();</div>
<div class="line">      <span class="keywordflow">if</span> (singular_nodes.count()) {</div>
<div class="line">        <span class="keyword">auto</span> it_map_ref_coords = <a id="a64" name="a64"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>.find(singular_nodes.to_ulong());</div>
<div class="line">        <span class="keywordflow">if</span> (it_map_ref_coords != <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>.end()) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(it_map_ref_coords-&gt;second);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">auto</span> refine_quadrature = [&amp;]() {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">int</span> max_level = refinementLevels;</div>
<div class="line"> </div>
<div class="line">            moab::Core moab_ref;</div>
<div class="line">            <span class="keywordtype">double</span> base_coords[] = {0, 0, 0, 1, 0, 0, 0, 1, 0};</div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> nodes[numNodes];</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++)</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_vertex(&amp;base_coords[3 * nn], nodes[nn]);</div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> tri;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_element(MBTRI, nodes, numNodes, tri);</div>
<div class="line">            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_core_tmp.html">MoFEM::CoreTmp</a>&lt;-1&gt; mofem_ref_core(moab_ref, PETSC_COMM_SELF, -2);</div>
<div class="line">            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field_ref = mofem_ref_core;</div>
<div class="line">            {</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> tris(tri, tri);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                  tris, 1, <span class="keyword">true</span>, edges, moab::Interface::UNION);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()-&gt;setBitRefLevel(</div>
<div class="line">                  tris, BitRefLevel().set(0), <span class="keyword">false</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> nodes_at_front;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> nn = 0; nn != numNodes; nn++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_nodes[nn]) {</div>
<div class="line">                <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tri, 0, nn, ent);</div>
<div class="line">                nodes_at_front.insert(ent);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> singular_edges = get_singular_edges();</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.create_meshset(MESHSET_SET, meshset);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ee = 0; ee != numEdges; ee++) {</div>
<div class="line">              <span class="keywordflow">if</span> (singular_edges[ee]) {</div>
<div class="line">                <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> ent;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.side_element(tri, 1, ee, ent);</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.add_entities(meshset, &amp;ent, 1);</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// refine mesh</span></div>
<div class="line">            <span class="keyword">auto</span> *m_ref = m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_mesh_refinement.html">MeshRefinement</a>&gt;();</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ll = 0; ll != max_level; ll++) {</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(BitRefLevel().set(ll),</div>
<div class="line">                                                 BitRefLevel().set(), MBEDGE,</div>
<div class="line">                                                 edges);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> ref_edges;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_adjacencies(</div>
<div class="line">                  nodes_at_front, 1, <span class="keyword">true</span>, ref_edges, moab::Interface::UNION);</div>
<div class="line">              ref_edges = intersect(ref_edges, edges);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_entities_by_type(meshset, MBEDGE, ents, <span class="keyword">true</span>);</div>
<div class="line">              ref_edges = intersect(ref_edges, ents);</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> tris;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;getEntitiesByTypeAndRefLevel(</div>
<div class="line">                      BitRefLevel().set(ll), BitRefLevel().set(), MBTRI, tris);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;addVerticesInTheMiddleOfEdges(</div>
<div class="line">                  ref_edges, BitRefLevel().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_ref-&gt;refineTris(tris, BitRefLevel().set(ll + 1));</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                  -&gt;updateMeshsetByEntitiesChildren(meshset,</div>
<div class="line">                                                    BitRefLevel().set(ll + 1),</div>
<div class="line">                                                    meshset, MBEDGE, <span class="keyword">true</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// get ref coords</span></div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> tris;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> m_field_ref.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bit_ref_manager.html">BitRefManager</a>&gt;()</div>
<div class="line">                -&gt;getEntitiesByTypeAndRefLevel(BitRefLevel().set(max_level),</div>
<div class="line">                                               BitRefLevel().set(), MBTRI,</div>
<div class="line">                                               tris);</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(moab_ref, <span class="stringliteral">&quot;ref_tris.vtk&quot;</span>, tris);</div>
<div class="line">              SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;debug&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            MatrixDouble ref_coords(tris.size(), 9, <span class="keyword">false</span>);</div>
<div class="line">            <span class="keywordtype">int</span> tt = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (Range::iterator tit = tris.begin(); tit != tris.end();</div>
<div class="line">                 tit++, tt++) {</div>
<div class="line">              <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">              <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_connectivity(*tit, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab_ref.get_coords(conn, num_nodes, &amp;ref_coords(tt, 0));</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> &amp;data = fe_ptr-&gt;dataOnElement[<a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>];</div>
<div class="line">            <span class="keyword">const</span> <span class="keywordtype">size_t</span> nb_gauss_pts = fe_ptr-&gt;gaussPts.size2();</div>
<div class="line">            MatrixDouble ref_gauss_pts(3, nb_gauss_pts * ref_coords.size1());</div>
<div class="line">            MatrixDouble &amp;shape_n =</div>
<div class="line">                data-&gt;dataOnEntities[MBVERTEX][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a>);</div>
<div class="line">            <span class="keywordtype">int</span> gg = 0;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> tt = 0; tt != ref_coords.size1(); tt++) {</div>
<div class="line">              <span class="keywordtype">double</span> *tri_coords = &amp;ref_coords(tt, 0);</div>
<div class="line">              <a id="_a65" name="_a65"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_normal;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Tools::getTriNormal(tri_coords, &amp;t_normal(0));</div>
<div class="line">              <span class="keyword">auto</span> det = t_normal.<a id="a66" name="a66"></a><a class="code hl_function" href="class_f_tensor_1_1_tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>();</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> ggg = 0; ggg != nb_gauss_pts; ++ggg, ++gg) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 2; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">                  ref_gauss_pts(dd, gg) =</div>
<div class="line">                      shape_n(ggg, 0) * tri_coords[3 * 0 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 1) * tri_coords[3 * 1 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] +</div>
<div class="line">                      shape_n(ggg, 2) * tri_coords[3 * 2 + <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>];</div>
<div class="line">                }</div>
<div class="line">                ref_gauss_pts(2, gg) = fe_ptr-&gt;gaussPts(2, ggg) * det;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>[singular_nodes.to_ulong()].swap(ref_gauss_pts);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_gauss_pts(<a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>[singular_nodes.to_ulong()]);</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">          };</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> refine_quadrature();</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line"><span class="keyword">private</span>:</div>
<div class="line">  <span class="keyword">struct </span>Fe : <span class="keyword">public</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html">ForcesAndSourcesCore</a> {</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::dataOnElement;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">private</span>:</div>
<div class="line">    <span class="keyword">using </span>ForcesAndSourcesCore::ForcesAndSourcesCore;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#a55a01ba77a1e9a4e923d95a00214d5ea">frontNodes</a>;</div>
<div class="line">  boost::shared_ptr&lt;Range&gt; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbf66122eef1dc218551708d7fc511b5">frontEdges</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">static</span> <span class="keyword">inline</span> std::map&lt;long int, MatrixDouble&gt; <a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad6a979fd7063ce295a2d5838ff85ee21">mapRefCoords</a>;</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">double</span> <a id="a67" name="a67"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a> = exp(1);</div>
<div class="line">boost::function&lt;<a id="_a68" name="_a68"></a><a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a69" name="a69"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianCore::f</a> = <a id="a70" name="a70"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a374c8a768747b54ac4baddcdf32deeeb">EshelbianCore::f_log_e</a>;</div>
<div class="line">boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a71" name="a71"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianCore::d_f</a> =</div>
<div class="line">    <a id="a72" name="a72"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a68a9aa377549588728583769158e9c2b">EshelbianCore::d_f_log_e</a>;</div>
<div class="line">boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a73" name="a73"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianCore::dd_f</a> =</div>
<div class="line">    <a id="a74" name="a74"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ab52e3754dac2b60f6b1b3399ef3a1fcd">EshelbianCore::dd_f_log_e</a>;</div>
<div class="line">boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a75" name="a75"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianCore::inv_f</a> =</div>
<div class="line">    <a id="a76" name="a76"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af65f9922d452b7c6579f0491567e5025">EshelbianCore::inv_f_log_e</a>;</div>
<div class="line">boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a77" name="a77"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianCore::inv_d_f</a> =</div>
<div class="line">    <a id="a78" name="a78"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a57f3ade0a2bae3cf6a447c75864d50e0">EshelbianCore::inv_d_f_log_e</a>;</div>
<div class="line">boost::function&lt;<a class="code hl_class" href="classdouble.html">double</a>(<span class="keyword">const</span> <span class="keywordtype">double</span>)&gt; <a id="a79" name="a79"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianCore::inv_dd_f</a> =</div>
<div class="line">    <a id="a80" name="a80"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a57ce234b76d335e73b56513c94b8e689">EshelbianCore::inv_dd_f_log_e</a>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a81" name="a81"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a7ec2050d610e40a8a05a3dcabe0b40df">EshelbianCore::query_interface</a>(boost::typeindex::type_index type_index,</div>
<div class="line">                               <a id="_a82" name="_a82"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_unknown_interface.html">UnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line">  *iface = <span class="keyword">const_cast&lt;</span><a id="_a83" name="_a83"></a><a class="code hl_struct" href="struct_eshelbian_core.html">EshelbianCore</a> *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a84" name="a84"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_op_jacobian.html#ae8b1e124a71d3c85bff23022318278d7">OpJacobian::doWork</a>(<span class="keywordtype">int</span> side, EntityType type, <a id="_a85" name="_a85"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntData</a> &amp;data) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a id="a86" name="a86"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_op_jacobian.html#a15ad4f8943e9270c375ed5ca5d7caf0e">evalRhs</a>)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a87" name="a87"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_op_jacobian.html#a747fe83f343f4ffd426b2a0792fbe022">evaluateRhs</a>(data);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a id="a88" name="a88"></a><a class="code hl_variable" href="struct_eshelbian_plasticity_1_1_op_jacobian.html#aec3faab23d15be5756fc7664e28adf1f">evalLhs</a>)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a89" name="a89"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_op_jacobian.html#a9ace7930bd971e106adc4688e82af754">evaluateLhs</a>(data);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a id="a90" name="a90"></a><a class="code hl_function" href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af5300bd764a6432f701ebff075f6e5ba">EshelbianCore::EshelbianCore</a>(<a class="code hl_struct" href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::Interface</a> &amp;m_field) : mField(m_field) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(getOptions(), <span class="stringliteral">&quot;getOptions failed&quot;</span>);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a id="a91" name="a91"></a><a class="code hl_function" href="struct_eshelbian_core.html#ade8d241d9d55fac1ca2740756a1bc1bd">EshelbianCore::~EshelbianCore</a>() = <span class="keywordflow">default</span>;</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a92" name="a92"></a><a class="code hl_function" href="struct_eshelbian_core.html#a6ce37c333084d7776612a9165edd487a">EshelbianCore::getOptions</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_rots[] = {<span class="stringliteral">&quot;small&quot;</span>, <span class="stringliteral">&quot;moderate&quot;</span>, <span class="stringliteral">&quot;large&quot;</span>, <span class="stringliteral">&quot;no_h1&quot;</span>};</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_symm[] = {<span class="stringliteral">&quot;symm&quot;</span>, <span class="stringliteral">&quot;not_symm&quot;</span>};</div>
<div class="line">  PetscInt choice_rot = <a id="a93" name="a93"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a>;</div>
<div class="line">  PetscInt choice_grad = <a id="a94" name="a94"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a>;</div>
<div class="line">  PetscInt choice_symm = <a id="a95" name="a95"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">char</span> *list_stretches[] = {<span class="stringliteral">&quot;linear&quot;</span>, <span class="stringliteral">&quot;log&quot;</span>};</div>
<div class="line">  PetscInt choice_stretch = StretchSelector::LOG;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Eshelbian plasticity&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-space_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for space&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a id="a96" name="a96"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-space_h1_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for space&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         <a id="a97" name="a97"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-material_order&quot;</span>, <span class="stringliteral">&quot;approximation oder for material&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, <a id="a98" name="a98"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a2975cb8401f36e568b72eb027375fe40">materialOrder</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a2975cb8401f36e568b72eb027375fe40">materialOrder</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_u&quot;</span>, <span class="stringliteral">&quot;viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a99" name="a99"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_w&quot;</span>, <span class="stringliteral">&quot;viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a100" name="a100"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-viscosity_alpha_omega&quot;</span>, <span class="stringliteral">&quot;rot viscosity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                            <a id="a101" name="a101"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-density_alpha_rho&quot;</span>, <span class="stringliteral">&quot;density&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a102" name="a102"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-rotations&quot;</span>, <span class="stringliteral">&quot;rotations&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_rots,</div>
<div class="line">                           LARGE_ROT + 1, list_rots[choice_rot], &amp;choice_rot,</div>
<div class="line">                           PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-grad&quot;</span>, <span class="stringliteral">&quot;gradient of defamation approximate&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                           list_rots, NO_H1_CONFIGURATION + 1,</div>
<div class="line">                           list_rots[choice_grad], &amp;choice_grad, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(<span class="stringliteral">&quot;-symm&quot;</span>, <span class="stringliteral">&quot;symmetric variant&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_symm, 2,</div>
<div class="line">                           list_symm[choice_symm], &amp;choice_symm, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-exponent_base&quot;</span>, <span class="stringliteral">&quot;exponent_base&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a103" name="a103"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">exponentBase</a>,</div>
<div class="line">                            &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsEList(</div>
<div class="line">      <span class="stringliteral">&quot;-stretches&quot;</span>, <span class="stringliteral">&quot;stretches&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, list_stretches, StretchSelector::LOG + 1,</div>
<div class="line">      list_stretches[choice_stretch], &amp;choice_stretch, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-no_stretch&quot;</span>, <span class="stringliteral">&quot;do not solve for stretch&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a104" name="a104"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-set_singularity&quot;</span>, <span class="stringliteral">&quot;set singularity&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a105" name="a105"></a><a class="code hl_variable" href="struct_eshelbian_core.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-l2_user_base_scale&quot;</span>, <span class="stringliteral">&quot;streach scale&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a106" name="a106"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// dynamic relaxation</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-dynamic_relaxation&quot;</span>, <span class="stringliteral">&quot;dynamic time relaxation&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          <a id="a107" name="a107"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a5d5c5ee0702329b9063b5e2c1ab13979">dynamicRelaxation</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a5d5c5ee0702329b9063b5e2c1ab13979">dynamicRelaxation</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// contact parameters</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-contact_max_post_proc_ref_level&quot;</span>, <span class="stringliteral">&quot;refinement level&quot;</span>,</div>
<div class="line">                         <span class="stringliteral">&quot;&quot;</span>, <a id="a108" name="a108"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a767ea904eb33f7f44cbdef68cfe7cdfc">contactRefinementLevels</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a767ea904eb33f7f44cbdef68cfe7cdfc">contactRefinementLevels</a>,</div>
<div class="line">                         PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// cracking parameters</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-cracking_on&quot;</span>, <span class="stringliteral">&quot;cracking ON&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a id="a109" name="a109"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a41356565364f05177e0256f536e42603">crackingOn</a>,</div>
<div class="line">                          &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a41356565364f05177e0256f536e42603">crackingOn</a>, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a id="a110" name="a110"></a><a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a> = PetscOptionsEnd();</div>
<div class="line">  <a id="a111" name="a111"></a><a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>) {</div>
<div class="line">    <a class="code hl_variable" href="struct_eshelbian_core.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a> = PETSC_TRUE;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespace_eshelbian_plasticity.html#aad51dbcb3d4d470a0d589df584a43e17">RotSelector</a><span class="keyword">&gt;</span>(choice_rot);</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespace_eshelbian_plasticity.html#aad51dbcb3d4d470a0d589df584a43e17">RotSelector</a><span class="keyword">&gt;</span>(choice_grad);</div>
<div class="line">  <a id="a112" name="a112"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a0fa131247db161516b235b0a567300ad">EshelbianCore::stretchSelector</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespace_eshelbian_plasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6">StretchSelector</a><span class="keyword">&gt;</span>(choice_stretch);</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a> = <span class="keyword">static_cast&lt;</span><a class="code hl_enumeration" href="namespace_eshelbian_plasticity.html#ae337388c661d8b90487c846cd2f361fa">SymmetrySelector</a><span class="keyword">&gt;</span>(choice_symm);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a0fa131247db161516b235b0a567300ad">EshelbianCore::stretchSelector</a>) {</div>
<div class="line">  <span class="keywordflow">case</span> StretchSelector::LINEAR:</div>
<div class="line">    <a id="a113" name="a113"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">EshelbianCore::f</a> = <a id="a114" name="a114"></a><a class="code hl_function" href="struct_eshelbian_core.html#afa60d86e456beaabddc2df730598719d">f_linear</a>;</div>
<div class="line">    <a id="a115" name="a115"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aa0a8e2aa21e3ed0d300b23df2b768ed3">EshelbianCore::d_f</a> = <a id="a116" name="a116"></a><a class="code hl_function" href="struct_eshelbian_core.html#aeb84ef335d710054abe0411d4672d3eb">d_f_linear</a>;</div>
<div class="line">    <a id="a117" name="a117"></a><a class="code hl_variable" href="struct_eshelbian_core.html#af6d348cacae8133fa2001387610b936c">EshelbianCore::dd_f</a> = <a id="a118" name="a118"></a><a class="code hl_function" href="struct_eshelbian_core.html#a98338d042e94f47e4b0cc5a6e4ede06f">dd_f_linear</a>;</div>
<div class="line">    <a id="a119" name="a119"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab74eed1af3e5f8a2e392f1206a4857c7">EshelbianCore::inv_f</a> = <a id="a120" name="a120"></a><a class="code hl_function" href="struct_eshelbian_core.html#a1b2cd0d3b7edf33d32a29531faff5d43">inv_f_linear</a>;</div>
<div class="line">    <a id="a121" name="a121"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab3b94154522357001e15c95e93a32537">EshelbianCore::inv_d_f</a> = <a id="a122" name="a122"></a><a class="code hl_function" href="struct_eshelbian_core.html#aae203dfeaee5453b2400a66b729b7005">inv_d_f_linear</a>;</div>
<div class="line">    <a id="a123" name="a123"></a><a class="code hl_variable" href="struct_eshelbian_core.html#af3b85cda0efd198ed74405e0a55c5ae2">EshelbianCore::inv_dd_f</a> = <a id="a124" name="a124"></a><a class="code hl_function" href="struct_eshelbian_core.html#ab8a03cc8007a0a926b9387941141303f">inv_dd_f_linear</a>;</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> StretchSelector::LOG:</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a> != exp(1)) {</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">EshelbianCore::f</a> = <a id="a125" name="a125"></a><a class="code hl_function" href="struct_eshelbian_core.html#aec89ac53f8bdf554768e788c8aa48282">f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#aa0a8e2aa21e3ed0d300b23df2b768ed3">EshelbianCore::d_f</a> = <a id="a126" name="a126"></a><a class="code hl_function" href="struct_eshelbian_core.html#a6591b5a3838e0c8dc4452ec9924f1eeb">d_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#af6d348cacae8133fa2001387610b936c">EshelbianCore::dd_f</a> = <a id="a127" name="a127"></a><a class="code hl_function" href="struct_eshelbian_core.html#a227e7b13b2bd905c1803d2bc65eacf82">dd_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ab74eed1af3e5f8a2e392f1206a4857c7">EshelbianCore::inv_f</a> = <a id="a128" name="a128"></a><a class="code hl_function" href="struct_eshelbian_core.html#a8b49e02a24c217a6abc9df5ca4bd7330">inv_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ab3b94154522357001e15c95e93a32537">EshelbianCore::inv_d_f</a> = <a id="a129" name="a129"></a><a class="code hl_function" href="struct_eshelbian_core.html#a2767660e68cb6e73ceaf90c95670cc4d">inv_d_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#af3b85cda0efd198ed74405e0a55c5ae2">EshelbianCore::inv_dd_f</a> = <a id="a130" name="a130"></a><a class="code hl_function" href="struct_eshelbian_core.html#aafaa9cff0830a9a3e5e5cb00c072b47d">inv_dd_f_log</a>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">EshelbianCore::f</a> = <a id="a131" name="a131"></a><a class="code hl_function" href="struct_eshelbian_core.html#add41a67a6d5f76559b0657f214048e8c">f_log_e</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#aa0a8e2aa21e3ed0d300b23df2b768ed3">EshelbianCore::d_f</a> = <a id="a132" name="a132"></a><a class="code hl_function" href="struct_eshelbian_core.html#ac1cb92ee0356ce898bfecc6c30a83b87">d_f_log_e</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#af6d348cacae8133fa2001387610b936c">EshelbianCore::dd_f</a> = <a id="a133" name="a133"></a><a class="code hl_function" href="struct_eshelbian_core.html#a50a7cd87dab88c005a77cc1843141fa7">dd_f_log_e</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ab74eed1af3e5f8a2e392f1206a4857c7">EshelbianCore::inv_f</a> = <a class="code hl_function" href="struct_eshelbian_core.html#a8b49e02a24c217a6abc9df5ca4bd7330">inv_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ab3b94154522357001e15c95e93a32537">EshelbianCore::inv_d_f</a> = <a class="code hl_function" href="struct_eshelbian_core.html#a2767660e68cb6e73ceaf90c95670cc4d">inv_d_f_log</a>;</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#af3b85cda0efd198ed74405e0a55c5ae2">EshelbianCore::inv_dd_f</a> = <a class="code hl_function" href="struct_eshelbian_core.html#aafaa9cff0830a9a3e5e5cb00c072b47d">inv_dd_f_log</a>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(<a id="a134" name="a134"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Unknown stretch&quot;</span>);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;spaceOrder &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;spaceH1Order &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;materialOrder &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a2975cb8401f36e568b72eb027375fe40">materialOrder</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaU &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaW &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaOmega &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;alphaRho &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Rotations &quot;</span> &lt;&lt; list_rots[<a class="code hl_variable" href="struct_eshelbian_core.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a>];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Gradient of deformation &quot;</span></div>
<div class="line">                               &lt;&lt; list_rots[<a class="code hl_variable" href="struct_eshelbian_core.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a>];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Symmetry &quot;</span> &lt;&lt; list_symm[<a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a>];</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">exponentBase</a> != exp(1))</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Base exponent &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a>;</div>
<div class="line">  <span class="keywordflow">else</span></div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Base exponent e&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Stretch &quot;</span> &lt;&lt; list_stretches[choice_stretch];</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Dynamic relaxation &quot;</span> &lt;&lt; (<a class="code hl_variable" href="struct_eshelbian_core.html#a5d5c5ee0702329b9063b5e2c1ab13979">dynamicRelaxation</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Singularity &quot;</span> &lt;&lt; (<a class="code hl_variable" href="struct_eshelbian_core.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>) ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">                                                                     : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;L2 user base scale &quot;</span> &lt;&lt; (<a class="code hl_variable" href="struct_eshelbian_core.html#a2ab70613ca1c05f21fc1092acf0b0585">l2UserBaseScale</a>)</div>
<div class="line">      ? <span class="stringliteral">&quot;yes&quot;</span></div>
<div class="line">      : <span class="stringliteral">&quot;no&quot;</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a> == -1)</div>
<div class="line">    <a class="code hl_variable" href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a> = <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a135" name="a135"></a><a class="code hl_function" href="struct_eshelbian_core.html#a0ccbbae7b9f76b00b39760756c85ca7b">EshelbianCore::addFields</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tets = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(meshset, MBTET, tets);</div>
<div class="line">    <span class="keywordflow">return</span> tets;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tets_skin = [&amp;]() {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> tets_skin_part;</div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, get_tets(), <span class="keyword">false</span>, tets_skin_part);</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(tets_skin_part,</div>
<div class="line">                                 PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;tets_skin);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> subtract_boundary_conditions = [&amp;](<span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="comment">// That mean, that hybrid field on all faces on which traction is applied,</span></div>
<div class="line">    <span class="comment">// on other faces, or enforcing displacements as</span></div>
<div class="line">    <span class="comment">// natural boundary condition.</span></div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a136" name="a136"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>)</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>) {</div>
<div class="line">        tets_skin = subtract(tets_skin, <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_blockset = [&amp;](<span class="keyword">auto</span> block_name, <span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="keyword">auto</span> crack_faces =</div>
<div class="line">        <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;block_name&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    tets_skin.merge(crack_faces);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> subtract_blockset = [&amp;](<span class="keyword">auto</span> block_name, <span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <span class="keyword">auto</span> contact_range =</div>
<div class="line">        <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, block_name, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">    tets_skin = subtract(tets_skin, contact_range);</div>
<div class="line">    <span class="keywordflow">return</span> tets_skin;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_stress_trace_faces = [&amp;](<span class="keyword">auto</span> &amp;&amp;tets_skin) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(get_tets(), <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                             faces, moab::Interface::UNION);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> trace_faces = subtract(faces, tets_skin);</div>
<div class="line">    <span class="keywordflow">return</span> trace_faces;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> tets = get_tets();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// remove also contact faces, i.e. that is also kind of hybrid field but</span></div>
<div class="line">  <span class="comment">// named but used to enforce contact conditions</span></div>
<div class="line">  <span class="keyword">auto</span> trace_faces = get_stress_trace_faces(</div>
<div class="line"> </div>
<div class="line">      subtract_blockset(<span class="stringliteral">&quot;CONTACT&quot;</span>,</div>
<div class="line">                        subtract_boundary_conditions(get_tets_skin()))</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <a id="a137" name="a137"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a> = boost::make_shared&lt;Range&gt;(intersect(</div>
<div class="line">      trace_faces, <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1)));</div>
<div class="line">  <a id="a138" name="a138"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a> =</div>
<div class="line">      boost::make_shared&lt;Range&gt;(subtract(trace_faces, *<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>));</div>
<div class="line">  <a id="a139" name="a139"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a0ce204135f6840cd235ce7f1cde1ca11">materialSkeletonFaces</a> =</div>
<div class="line">      boost::make_shared&lt;Range&gt;(get_stress_trace_faces(<a class="code hl_class" href="class_range.html">Range</a>()));</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>-&gt;size())</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;contact_faces.vtk&quot;</span>, *<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>-&gt;size())</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;skeleton_faces.vtk&quot;</span>, *<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>-&gt;size())</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;material_skeleton_faces.vtk&quot;</span>,</div>
<div class="line">                      *<a class="code hl_variable" href="struct_eshelbian_core.html#a0ce204135f6840cd235ce7f1cde1ca11">materialSkeletonFaces</a>);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_broken_hdiv_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a id="a140" name="a140"></a><a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                               <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">constexpr</span> <a class="code hl_enumeration" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a> base = <a id="a141" name="a141"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_side_map_hdiv = [&amp;]() {</div>
<div class="line">      <span class="keywordflow">return</span> std::vector&lt;</div>
<div class="line"> </div>
<div class="line">          std::pair&lt;EntityType,</div>
<div class="line">                    std::function&lt;<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(<a class="code hl_typedef" href="struct_mo_f_e_m_1_1_base_function.html#ab7aacd90b8b076207dc5e7bd070b7e4b">BaseFunction::DofsSideMap</a> &amp;)&gt;</div>
<div class="line"> </div>
<div class="line">                    &gt;&gt;{</div>
<div class="line"> </div>
<div class="line">          {MBTET,</div>
<div class="line">           [&amp;](<a class="code hl_typedef" href="struct_mo_f_e_m_1_1_base_function.html#ab7aacd90b8b076207dc5e7bd070b7e4b">BaseFunction::DofsSideMap</a> &amp;dofs_side_map) -&gt; <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> {</div>
<div class="line">             <span class="keywordflow">return</span> TetPolynomialBase::setDofsSideMap(<a id="a142" name="a142"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, <a id="a143" name="a143"></a><a class="code hl_enumvalue" href="definitions_8h.html#a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4">DISCONTINUOUS</a>, base,</div>
<div class="line">                                                      dofs_side_map);</div>
<div class="line">           }}</div>
<div class="line"> </div>
<div class="line">      };</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a144" name="a144"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a4a1460f62976a6d7224b1c280cecedfc">add_broken_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, base, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                   get_side_map_hdiv(), MB_TAG_DENSE, <a id="a145" name="a145"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a146" name="a146"></a><a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a147" name="a147"></a><a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_l2_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a148" name="a148"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a id="a149" name="a149"></a><a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a id="a150" name="a150"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_h1_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBVERTEX, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, 1);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBEDGE, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTRI, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_l2_field_by_range = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim,</div>
<div class="line">                                      <span class="keyword">const</span> <span class="keywordtype">int</span> field_dim, <a class="code hl_class" href="class_range.html">Range</a> &amp;&amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a>, field_dim,</div>
<div class="line">                            MB_TAG_DENSE, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(r);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a151" name="a151"></a><a class="code hl_function" href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">add_ents_to_field_by_dim</a>(r, dim, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(r, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_bubble_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                          <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>, <a id="a152" name="a152"></a><a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>, dim, MB_TAG_DENSE,</div>
<div class="line">                            <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// Modify field</span></div>
<div class="line">    <span class="keyword">auto</span> field_ptr = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a153" name="a153"></a><a class="code hl_function" href="group__mofem__field.html#ga01ac334d9339ed5f1b0bcfa12a8daf1d">get_field_structure</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <span class="keyword">auto</span> field_order_table =</div>
<div class="line">        <span class="keyword">const_cast&lt;</span><a id="_a154" name="_a154"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_field.html">Field</a> *<span class="keyword">&gt;</span>(field_ptr)-&gt;getFieldOrderTable();</div>
<div class="line">    <span class="keyword">auto</span> get_cgg_bubble_order_zero = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 0; };</div>
<div class="line">    <span class="keyword">auto</span> get_cgg_bubble_order_tet = [](<span class="keywordtype">int</span> p) {</div>
<div class="line">      <span class="keywordflow">return</span> <a id="a155" name="a155"></a><a class="code hl_define" href="_c_g_g_tonsorial_bubble_base_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a>(p);</div>
<div class="line">    };</div>
<div class="line">    field_order_table[MBVERTEX] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBEDGE] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBTRI] = get_cgg_bubble_order_zero;</div>
<div class="line">    field_order_table[MBTET] = get_cgg_bubble_order_tet;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTRI, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_user_l2_field = [<span class="keyword">this</span>, meshset](<span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>,</div>
<div class="line">                                           <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keyword">const</span> <span class="keywordtype">int</span> dim) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">add_field</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>, dim, MB_TAG_DENSE,</div>
<div class="line">                            <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <span class="comment">// Modify field</span></div>
<div class="line">    <span class="keyword">auto</span> field_ptr = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga01ac334d9339ed5f1b0bcfa12a8daf1d">get_field_structure</a>(<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <span class="keyword">auto</span> field_order_table =</div>
<div class="line">        <span class="keyword">const_cast&lt;</span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_field.html">Field</a> *<span class="keyword">&gt;</span>(field_ptr)-&gt;getFieldOrderTable();</div>
<div class="line">    <span class="keyword">auto</span> zero_dofs = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> 0; };</div>
<div class="line">    <span class="keyword">auto</span> dof_l2_tet = [](<span class="keywordtype">int</span> p) { <span class="keywordflow">return</span> <a id="a156" name="a156"></a><a class="code hl_define" href="h1__hdiv__hcurl__l2_8h.html#afff51d616c826e4714c19b69816fa74f">NBVOLUMETET_L2</a>(p); };</div>
<div class="line">    field_order_table[MBVERTEX] = zero_dofs;</div>
<div class="line">    field_order_table[MBEDGE] = zero_dofs;</div>
<div class="line">    field_order_table[MBTRI] = zero_dofs;</div>
<div class="line">    field_order_table[MBTET] = dof_l2_tet;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">add_ents_to_field_by_type</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">set_field_order</a>(meshset, MBTET, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>, <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// spatial fields</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_broken_hdiv_field(<a id="a157" name="a157"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_bubble_field(<a id="a158" name="a158"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, 1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(<a id="a159" name="a159"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 3);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(<a id="a160" name="a160"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 3);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_user_l2_field(<a id="a161" name="a161"></a><a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a> ? -1 : <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>, 6);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>)</div>
<div class="line">    SETERRQ(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No skeleton faces&quot;</span>);</div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>)</div>
<div class="line">    SETERRQ(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No contact faces&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(<a id="a162" name="a162"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 2, 3,</div>
<div class="line">                               <a class="code hl_class" href="class_range.html">Range</a>(*<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>));</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(<a id="a163" name="a163"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 2, 3,</div>
<div class="line">                               <a class="code hl_class" href="class_range.html">Range</a>(*<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// spatial displacement</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_h1_field(<a id="a164" name="a164"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">spaceH1Order</a>, 3);</div>
<div class="line">  <span class="comment">// material positions</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_h1_field(<a id="a165" name="a165"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, 2, 3);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Eshelby stress</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_broken_hdiv_field(<a id="a166" name="a166"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a4cd3e5bf9787574d458637416d6a06a4">eshelbyStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field(<a id="a167" name="a167"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ac6f12eded8044632f771b705c1b1d6a3">materialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 3);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_l2_field_by_range(<a id="a168" name="a168"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a7acb9f3d2fc946df28d0616ef12c28ab">hybridMaterialDisp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a> - 1, 2, 3,</div>
<div class="line">                               <a class="code hl_class" href="class_range.html">Range</a>(*<a class="code hl_variable" href="struct_eshelbian_core.html#a0ce204135f6840cd235ce7f1cde1ca11">materialSkeletonFaces</a>));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a169" name="a169"></a><a class="code hl_function" href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">build_fields</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a170" name="a170"></a><a class="code hl_function" href="struct_eshelbian_core.html#a33a23a7598af848601fa49a1eb8554a0">EshelbianCore::projectGeometry</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> meshset_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_handle(meshset, meshset_ents);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> project_ho_geometry = [&amp;](<span class="keyword">auto</span> field) {</div>
<div class="line">    <a id="_a171" name="_a171"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">Projection10NodeCoordsOnField</a> ent_method(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a172" name="a172"></a><a class="code hl_function" href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">loop_dofs</a>(field, ent_method);</div>
<div class="line">  };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> project_ho_geometry(<a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front_edges = [&amp;](<span class="keyword">auto</span> &amp;front_edges) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> front_crack_nodes;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(front_edges, front_crack_nodes, <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        front_crack_nodes);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_front_edges;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(front_crack_nodes, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">false</span>,</div>
<div class="line">                                crack_front_edges, moab::Interface::UNION);</div>
<div class="line">    crack_front_edges =</div>
<div class="line">        intersect(subtract(crack_front_edges, front_edges), meshset_ents);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_front_edges);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_front_edges_nodes;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(crack_front_edges, crack_front_edges_nodes,</div>
<div class="line">                                 <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_front_edges_nodes);</div>
<div class="line">    crack_front_edges_nodes =</div>
<div class="line">        subtract(crack_front_edges_nodes, front_crack_nodes);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_front_edges_with_both_nodes_not_at_front;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_adjacencies(crack_front_edges_nodes, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">false</span>,</div>
<div class="line">                                crack_front_edges_with_both_nodes_not_at_front,</div>
<div class="line">                                moab::Interface::UNION);</div>
<div class="line">    crack_front_edges_with_both_nodes_not_at_front =</div>
<div class="line">        intersect(crack_front_edges_with_both_nodes_not_at_front, meshset_ents);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_front_edges_with_both_nodes_not_at_front);</div>
<div class="line">    crack_front_edges_with_both_nodes_not_at_front = intersect(</div>
<div class="line">        crack_front_edges_with_both_nodes_not_at_front, crack_front_edges);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(boost::make_shared&lt;Range&gt;(front_crack_nodes),</div>
<div class="line">                          boost::make_shared&lt;Range&gt;(</div>
<div class="line">                              crack_front_edges_with_both_nodes_not_at_front));</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_faces_of_crack_front_verts = [&amp;](<span class="keyword">auto</span> front_edges_faces) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> verts;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(front_edges_faces, verts, <span class="keyword">true</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(verts);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> crack_faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(verts, 2, <span class="keyword">true</span>, crack_faces,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">        crack_faces);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> faces_verts;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(crack_faces, faces_verts, <span class="keyword">true</span>);</div>
<div class="line">    faces_verts = subtract(faces_verts, verts);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> faces_verts_faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">        faces_verts, 2, <span class="keyword">true</span>, faces_verts_faces, moab::Interface::UNION);</div>
<div class="line">    crack_faces = subtract(crack_faces, faces_verts_faces);</div>
<div class="line">    <span class="keywordflow">return</span> crack_faces;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> own_tets =</div>
<div class="line">      CommInterface::getPartEntities(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>())</div>
<div class="line">          .subset_by_dimension(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> own_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(own_tets, 2, <span class="keyword">true</span>, own_faces,</div>
<div class="line">                                           moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">  <a id="a173" name="a173"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a> = boost::make_shared&lt;Range&gt;(</div>
<div class="line">      <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CRACK&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>-&gt;merge(get_faces_of_crack_front_verts(</div>
<div class="line">      <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a08d97e06a4534524e4b6b87cfb27c4ae">get_crack_front_edges</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, intersect(*<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, own_faces))));</div>
<div class="line">  <a id="a174" name="a174"></a><a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a> = boost::make_shared&lt;Range&gt;(</div>
<div class="line">      <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a08d97e06a4534524e4b6b87cfb27c4ae">get_crack_front_edges</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, intersect(*<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, own_faces)));</div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">    <a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a> = boost::make_shared&lt;Range&gt;(</div>
<div class="line">        <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a08d97e06a4534524e4b6b87cfb27c4ae">get_crack_front_edges</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>, <span class="keyword">false</span>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> [front_vertices, front_adj_edges] = get_adj_front_edges(*<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">  <a id="a175" name="a175"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a> = front_vertices;</div>
<div class="line">  <a id="a176" name="a176"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a> = front_adj_edges;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// #ifndef NDEBUG</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a41356565364f05177e0256f536e42603">crackingOn</a>) {</div>
<div class="line">    <span class="keyword">auto</span> rank = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;meshset_ents_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      meshset_ents);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;crack_faces_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;front_edges_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      *<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;front_vertices_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      *<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                      (boost::format(<span class="stringliteral">&quot;front_adj_edges_%d.vtk&quot;</span>) % rank).str(),</div>
<div class="line">                      *<a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// #endif // NDEBUG</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_singular_dofs = [&amp;](<span class="keyword">auto</span> &amp;front_adj_edges, <span class="keyword">auto</span> &amp;front_vertices) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line"> </div>
<div class="line">    <span class="keywordtype">double</span> <a id="a177" name="a177"></a><a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> = 1;</div>
<div class="line">    <span class="keywordtype">double</span> beta = 0;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">PetscOptionsGetScalar</a>(PETSC_NULL, <span class="stringliteral">&quot;-singularity_eps&quot;</span>, &amp;beta,</div>
<div class="line">                                 PETSC_NULL);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Singularity eps &quot;</span> &lt;&lt; beta;</div>
<div class="line">    <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a> -= beta;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> edge : front_adj_edges) {</div>
<div class="line">      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_connectivity(edge, conn, num_nodes, <span class="keyword">false</span>);</div>
<div class="line">      <span class="keywordtype">double</span> coords[6];</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.get_coords(conn, num_nodes, coords);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> dir[3] = {coords[3] - coords[0], coords[4] - coords[1],</div>
<div class="line">                             coords[5] - coords[2]};</div>
<div class="line">      <span class="keywordtype">double</span> dof[3] = {0, 0, 0};</div>
<div class="line">      <span class="keywordflow">if</span> (front_vertices.find(conn[0]) != front_vertices.end()) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">          dof[<a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] = -dir[<a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] * <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line">        }</div>
<div class="line">      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (front_vertices.find(conn[1]) != front_vertices.end()) {</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>++) {</div>
<div class="line">          dof[<a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] = +dir[<a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] * <a class="code hl_variable" href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">for</span> (<a id="a178" name="a178"></a><a class="code hl_define" href="group__mofem__access.html#gaead3887ddc924ad6d2a0993bfb4a9b27">_IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_</a>(</div>
<div class="line">               <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, edge, dit)) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">int</span> idx = dit-&gt;get()-&gt;getEntDofIdx();</div>
<div class="line">        <span class="keywordflow">if</span> (idx &gt; 2) {</div>
<div class="line">          dit-&gt;get()-&gt;getFieldData() = 0;</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          dit-&gt;get()-&gt;getFieldData() = dof[idx];</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#abfb627d240daa3e65a6c556d486c3775">setSingularity</a>)</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_singular_dofs(*<a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a179" name="a179"></a><a class="code hl_function" href="struct_eshelbian_core.html#a0c39ec57ae27dba1a6fe02b45d971d68">EshelbianCore::addVolumeFiniteElement</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set finite element fields</span></div>
<div class="line">  <span class="keyword">auto</span> add_field_to_fe = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string fe,</div>
<div class="line">                                <span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a180" name="a180"></a><a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a181" name="a181"></a><a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a182" name="a182"></a><a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a183" name="a183"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a184" name="a184"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>)) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a185" name="a185"></a><a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a186" name="a186"></a><a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(meshset, MBTET,</div>
<div class="line">                                                     <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// build finite elements data structures</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a187" name="a187"></a><a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a188" name="a188"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">materialVolumeElement</a>)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> front_edges = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;FRONT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> front_elements;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a id="a189" name="a189"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> != <a id="a190" name="a190"></a><a class="code hl_variable" href="struct_eshelbian_core.html#abfe3b15fb8e48c579531e64684a2ecdc">frontLayers</a>; ++<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> front_elements_layer;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(front_edges, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>,</div>
<div class="line">                                               front_elements_layer,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      front_elements.merge(front_elements_layer);</div>
<div class="line">      front_edges.clear();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(front_elements_layer,</div>
<div class="line">                                               <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>, front_edges,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">materialVolumeElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(front_elements, MBTET,</div>
<div class="line">                                                     <a class="code hl_variable" href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">materialVolumeElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">materialVolumeElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4cd3e5bf9787574d458637416d6a06a4">eshelbyStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">materialVolumeElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ac6f12eded8044632f771b705c1b1d6a3">materialL2Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">materialVolumeElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a191" name="a191"></a><a class="code hl_function" href="struct_eshelbian_core.html#a14d44e8866e1201657b06ce8d1d82206">EshelbianCore::addBoundaryFiniteElement</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> meshset_ents;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_handle(meshset, meshset_ents);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_fe_adjacency = [&amp;](<span class="keyword">auto</span> fe_name) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a id="a192" name="a192"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a912ebbcc505570f26b497c1a788c49c0">parentAdjSkeletonFunctionDim2</a> =</div>
<div class="line">        boost::make_shared&lt;ParentFiniteElementAdjacencyFunctionSkeleton&lt;2&gt;&gt;(</div>
<div class="line">            <a id="a193" name="a193"></a><a class="code hl_variable" href="struct_eshelbian_core.html#acdf2dd025fc4286ff5719a079c2e61ac">bitAdjParent</a>, <a id="a194" name="a194"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aaf238d1b79dcea860e0648463d07e698">bitAdjParentMask</a>, <a id="a195" name="a195"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a2363fb172da13a753995b83e0555f565">bitAdjEnt</a>, <a id="a196" name="a196"></a><a class="code hl_variable" href="struct_eshelbian_core.html#af87b5b277e9ed4a79838f7a04bf7c36f">bitAdjEntMask</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a197" name="a197"></a><a class="code hl_function" href="group__mofem__fe.html#ga9c5d28e66a86646de9e733b34ea03a71">modify_finite_element_adjacency_table</a>(</div>
<div class="line">        fe_name, MBTRI, *<a class="code hl_variable" href="struct_eshelbian_core.html#a912ebbcc505570f26b497c1a788c49c0">parentAdjSkeletonFunctionDim2</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set finite element fields</span></div>
<div class="line">  <span class="keyword">auto</span> add_field_to_fe = [<span class="keyword">this</span>](<span class="keyword">const</span> std::string fe,</div>
<div class="line">                                <span class="keyword">const</span> std::string <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">modify_finite_element_add_field_row</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">modify_finite_element_add_field_col</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(fe, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(fe, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a198" name="a198"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> natural_bc_elements;</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a199" name="a199"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a id="a200" name="a200"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>) {</div>
<div class="line">        natural_bc_elements.merge(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    natural_bc_elements = intersect(natural_bc_elements, meshset_ents);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(natural_bc_elements, MBTRI,</div>
<div class="line">                                                     <a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a> = [&amp;](<span class="keyword">auto</span> &amp;body_ents) {</div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> skin_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, body_ents, <span class="keyword">false</span>, skin_ents);</div>
<div class="line">    <span class="keywordflow">return</span> skin_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a> = [&amp;](<span class="keyword">auto</span> &amp;&amp;skin) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> boundary_ents;</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(skin, PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                 PSTATUS_NOT, -1, &amp;boundary_ents);</div>
<div class="line">    <span class="keywordflow">return</span> boundary_ents;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a201" name="a201"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(meshset, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                       body_ents);</div>
<div class="line">    <span class="keyword">auto</span> skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(body_ents));</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(skin, MBTRI, <a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#a7acb9f3d2fc946df28d0616ef12c28ab">hybridMaterialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">modify_finite_element_add_field_data</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a202" name="a202"></a><a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>) {</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">          &lt;&lt; <span class="stringliteral">&quot;Contact elements &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>-&gt;size();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(*<a class="code hl_variable" href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">contactFaces</a>, MBTRI,</div>
<div class="line">                                                       <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a203" name="a203"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>)) {</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>)</div>
<div class="line">      SETERRQ(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;No skeleton faces&quot;</span>);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">        &lt;&lt; <span class="stringliteral">&quot;Skeleton elements &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>-&gt;size();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(*<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>, MBTRI,</div>
<div class="line">                                                     <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">check_finite_element</a>(<a id="a204" name="a204"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>)) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> front_edges = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;FRONT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> front_elements;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> != <a class="code hl_variable" href="struct_eshelbian_core.html#abfe3b15fb8e48c579531e64684a2ecdc">frontLayers</a>; ++<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> front_elements_layer;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(front_edges, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">true</span>,</div>
<div class="line">                                               front_elements_layer,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      front_elements.merge(front_elements_layer);</div>
<div class="line">      front_edges.clear();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(front_elements_layer,</div>
<div class="line">                                               <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 2, <span class="keyword">true</span>, front_edges,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> front_elements_faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(front_elements, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1,</div>
<div class="line">                                             <span class="keyword">true</span>, front_elements_faces,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line">    <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(body_ents));</div>
<div class="line">    <span class="keyword">auto</span> front_elements_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(front_elements));</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> material_skeleton_faces =</div>
<div class="line">        subtract(front_elements_faces, front_elements_skin);</div>
<div class="line">    material_skeleton_faces.merge(intersect(front_elements_skin, body_skin));</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;front_elements.vtk&quot;</span>, front_elements);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;front_elements_skin.vtk&quot;</span>,</div>
<div class="line">                      front_elements_skin);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;material_skeleton_faces.vtk&quot;</span>,</div>
<div class="line">                      material_skeleton_faces);</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">add_finite_element</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>, <a class="code hl_enumvalue" href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">add_ents_to_finite_element_by_type</a>(</div>
<div class="line">        material_skeleton_faces, MBTRI, <a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4cd3e5bf9787574d458637416d6a06a4">eshelbyStress</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_field_to_fe(<a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a7acb9f3d2fc946df28d0616ef12c28ab">hybridMaterialDisp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_fe_adjacency(<a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">build_finite_elements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">materialSkeletonElement</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a205" name="a205"></a><a class="code hl_function" href="struct_eshelbian_core.html#ac9225b726d868b3097e7fc41be2b3acc">EshelbianCore::addDMs</a>(<span class="keyword">const</span> BitRefLevel <a id="a206" name="a206"></a><a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line">                                     <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// find adjacencies between finite elements and dofs</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a207" name="a207"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">build_adjacencies</a>(<a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>, <a id="a208" name="a208"></a><a class="code hl_enumvalue" href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create coupled problem</span></div>
<div class="line">  <a id="a209" name="a209"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">DMMoFEMCreateMoFEM</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;ESHELBY_PLASTICITY&quot;</span>, <a class="code hl_variable" href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a>,</div>
<div class="line">                            BitRefLevel().set());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a210" name="_a210"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_TRUE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>);</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;buildProblemFromFields = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> remove_dofs_on_broken_skin = [&amp;](<span class="keyword">const</span> std::string prb_name) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d : {0, 1, 2}) {</div>
<div class="line">      std::vector&lt;boost::weak_ptr&lt;NumeredDofEntity&gt;&gt; dofs_to_remove;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()</div>
<div class="line">          -&gt;getSideDofsOnBrokenSpaceEntities(</div>
<div class="line">              dofs_to_remove, prb_name, <a id="a211" name="a211"></a><a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">              (*<a id="a212" name="a212"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aa2f4d1f9bac948fedcaebe1712299295">bcSpatialFreeTraction</a>)[d], <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, d, d);</div>
<div class="line">      <span class="comment">// remove piola dofs, i.e. traction free boundary</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;removeDofs(prb_name, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>,</div>
<div class="line">                                                                dofs_to_remove);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;removeDofs(prb_name, <a id="a213" name="a213"></a><a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a>,</div>
<div class="line">                                                                dofs_to_remove);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> remove_dofs_on_broken_skin(<span class="stringliteral">&quot;ESHELBY_PLASTICITY&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Create elastic sub-problem</span></div>
<div class="line">  <a id="a214" name="a214"></a><a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>);</div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>);</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// dmMaterial = createDM(mField.get_comm(), &quot;DMMOFEM&quot;);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMCreateSubDM(dmMaterial, dM, &quot;MATERIAL_PROBLEM&quot;);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetDestroyProblem(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddSubFieldRow(dmMaterial, eshelbyStress);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddSubFieldRow(dmMaterial, materialL2Disp);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterh elementVolumeName);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterial, naturalBcElement);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMAddElement(dmMaterial, skinElement);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetSquareProblem(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMMoFEMSetIsPartitioned(dmMaterial, PETSC_TRUE);</span></div>
<div class="line">  <span class="comment">// CHKERR DMSetUp(dmMaterial);</span></div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_zero_block = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>);</div>
<div class="line">    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()-&gt;addFieldToEmptyFieldBlocks(</div>
<div class="line">          <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a id="a215" name="a215"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aec7eec34db87d222944bbaf74cf7c0f3">solTSStep</a> = <a class="code hl_function" href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">createDMVector</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_section = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    PetscSection section;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a216" name="_a216"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;sectionCreate(<span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>,</div>
<div class="line">                                                           &amp;section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetSection(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetGlobalSection(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionDestroy(&amp;section);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_zero_block();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_section();</div>
<div class="line"> </div>
<div class="line">  <a id="a217" name="a217"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">createDM</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <span class="stringliteral">&quot;DMMOFEM&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">DMMoFEMCreateSubDM</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <span class="stringliteral">&quot;PROJECT_SPATIAL&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">DMMoFEMSetDestroyProblem</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">DMMoFEMAddSubFieldRow</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">DMMoFEMAddElement</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">DMMoFEMSetSquareProblem</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">DMMoFEMSetIsPartitioned</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>, PETSC_TRUE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMSetUp(<a class="code hl_variable" href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">dmPrjSpatial</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a218" name="_a218"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;()</div>
<div class="line">      -&gt;pushMarkDOFsOnEntities&lt;DisplacementCubitBcData&gt;(</div>
<div class="line">          <span class="stringliteral">&quot;PROJECT_SPATIAL&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <span class="keyword">true</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BcDisp::BcDisp(std::string name, std::vector&lt;double&gt; &amp;attr, <a class="code hl_class" href="class_range.html">Range</a> &amp;faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">    flags[ii] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(attr[ii + 3]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCDisp &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCDisp vals &quot;</span> &lt;&lt; vals[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCDisp flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCDisp nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">BcRot::BcRot(std::string name, std::vector&lt;double&gt; &amp;attr, <a class="code hl_class" href="class_range.html">Range</a> &amp;faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">  }</div>
<div class="line">  theta = attr[3];</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">TractionBc::TractionBc(std::string name, std::vector&lt;double&gt; &amp;attr,</div>
<div class="line">                       <a class="code hl_class" href="class_range.html">Range</a> &amp;faces)</div>
<div class="line">    : blockName(name), faces(faces) {</div>
<div class="line">  vals.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  flags.resize(3, <span class="keyword">false</span>);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ii = 0; ii != 3; ++ii) {</div>
<div class="line">    vals[ii] = attr[ii];</div>
<div class="line">    flags[ii] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(attr[ii + 3]);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCForce &quot;</span> &lt;&lt; name;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCForce vals &quot;</span> &lt;&lt; vals[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; vals[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Add BCForce flags &quot;</span> &lt;&lt; flags[0] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[1] &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; flags[2];</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Add BCForce nb. of faces &quot;</span> &lt;&lt; faces.size();</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a id="a219" name="a219"></a><a class="code hl_function" href="struct_eshelbian_core.html#a44780924071e102fcb49da8bc01637e8">EshelbianCore::getTractionFreeBc</a>(<span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> meshset,</div>
<div class="line">                                 boost::shared_ptr&lt;TractionFreeBc&gt; &amp;bc_ptr,</div>
<div class="line">                                 <span class="keyword">const</span> std::string contact_set_name) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// get skin from all tets</span></div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(meshset, MBTET, tets);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> tets_skin_part;</div>
<div class="line">  Skinner skin(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, tets, <span class="keyword">false</span>, tets_skin_part);</div>
<div class="line">  ParallelComm *pcomm =</div>
<div class="line">      ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> tets_skin;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> pcomm-&gt;filter_pstatus(tets_skin_part,</div>
<div class="line">                               PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                               PSTATUS_NOT, -1, &amp;tets_skin);</div>
<div class="line"> </div>
<div class="line">  bc_ptr-&gt;resize(3);</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> dd = 0; <a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a> != 3; ++<a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>)</div>
<div class="line">    (*bc_ptr)[<a class="code hl_function" href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">dd</a>] = tets_skin;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do not remove dofs on which traction is applied</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[0])</div>
<div class="line">        (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[1])</div>
<div class="line">        (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.flags[2])</div>
<div class="line">        (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Do not remove dofs on which rotation is applied</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>)</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> : *<a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>) {</div>
<div class="line">      (*bc_ptr)[0] = subtract((*bc_ptr)[0], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[1] = subtract((*bc_ptr)[1], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">      (*bc_ptr)[2] = subtract((*bc_ptr)[2], <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.faces);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// remove contact</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line">           std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % contact_set_name).str()))) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 2, faces,</div>
<div class="line">                                              <span class="keyword">true</span>);</div>
<div class="line">    (*bc_ptr)[0] = subtract((*bc_ptr)[0], faces);</div>
<div class="line">    (*bc_ptr)[1] = subtract((*bc_ptr)[1], faces);</div>
<div class="line">    (*bc_ptr)[2] = subtract((*bc_ptr)[2], faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">/**</span></div>
<div class="line"><span class="comment"> * @brief Set integration rule on element</span></div>
<div class="line"><span class="comment"> * \param order on row</span></div>
<div class="line"><span class="comment"> * \param order on column</span></div>
<div class="line"><span class="comment"> * \param order on data</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> * Use maximal oder on data in order to determine integration rule</span></div>
<div class="line"><span class="comment"> *</span></div>
<div class="line"><span class="comment"> */</span></div>
<div class="line"><span class="keyword">struct </span><a id="_a220" name="_a220"></a><a class="code hl_struct" href="struct_vol_rule.html">VolRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a221" name="a221"></a><a class="code hl_function" href="struct_vol_rule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * p_data + 1;</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span><a id="_a222" name="_a222"></a><a class="code hl_struct" href="struct_face_rule.html">FaceRule</a> {</div>
<div class="line">  <span class="keywordtype">int</span> <a id="a223" name="a223"></a><a class="code hl_function" href="struct_face_rule.html#aa4dbe8a983fafee94833d9f28e4eb5bf">operator()</a>(<span class="keywordtype">int</span> p_row, <span class="keywordtype">int</span> p_col, <span class="keywordtype">int</span> p_data)<span class="keyword"> const </span>{</div>
<div class="line">    <span class="keywordflow">return</span> 2 * (p_data + 1);</div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line">CGGUserPolynomialBase::CGGUserPolynomialBase(</div>
<div class="line">    boost::shared_ptr&lt;CachePhi&gt; cache_phi_otr)</div>
<div class="line">    : <a id="_a224" name="_a224"></a><a class="code hl_class" href="class_tet_polynomial_base.html">TetPolynomialBase</a>(), cachePhiPtr(cache_phi_otr) {}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> CGGUserPolynomialBase::query_interface(</div>
<div class="line">    boost::typeindex::type_index type_index,</div>
<div class="line">    <a id="_a225" name="_a225"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_base_function_unknown_interface.html">BaseFunctionUnknownInterface</a> **iface)<span class="keyword"> const </span>{</div>
<div class="line">  *iface = <span class="keyword">const_cast&lt;</span>CGGUserPolynomialBase *<span class="keyword">&gt;</span>(<span class="keyword">this</span>);</div>
<div class="line">  <span class="keywordflow">return</span> 0;</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">CGGUserPolynomialBase::getValue(MatrixDouble &amp;pts,</div>
<div class="line">                                boost::shared_ptr&lt;BaseFunctionCtx&gt; ctx_ptr) {</div>
<div class="line">  <a id="a226" name="a226"></a><a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line"> </div>
<div class="line">  this-&gt;cTx = ctx_ptr-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a227" name="_a227"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_ent_polynomial_base_ctx.html">EntPolynomialBaseCtx</a>&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">int</span> nb_gauss_pts = pts.size2();</div>
<div class="line">  <span class="keywordflow">if</span> (!nb_gauss_pts) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (pts.size1() &lt; 3) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Wrong dimension of pts, should be at least 3 rows with &quot;</span></div>
<div class="line">            <span class="stringliteral">&quot;coordinates&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">const</span> <span class="keyword">auto</span> base = this-&gt;cTx-&gt;bAse;</div>
<div class="line">  <a id="_a228" name="_a228"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data.html">EntitiesFieldData</a> &amp;data = this-&gt;cTx-&gt;dAta;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">switch</span> (this-&gt;cTx-&gt;sPace) {</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a>:</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getValueHdivForCGGBubble(pts);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a>:</div>
<div class="line">    data.<a id="a229" name="a229"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getN(base).resize(nb_gauss_pts, 4, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> Tools::shapeFunMBTET(</div>
<div class="line">        &amp;*data.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getN(base).data().begin(),</div>
<div class="line">        &amp;pts(0, 0), &amp;pts(1, 0), &amp;pts(2, 0), nb_gauss_pts);</div>
<div class="line">    data.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getDiffN(base).resize(4, 3, <span class="keyword">false</span>);</div>
<div class="line">    std::copy(Tools::diffShapeFunMBTET.begin(), Tools::diffShapeFunMBTET.end(),</div>
<div class="line">              data.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBVERTEX][0].getDiffN(base).data().begin());</div>
<div class="line">    this-&gt;cTx-&gt;basePolynomialsType0 = <a id="a230" name="a230"></a><a class="code hl_function" href="group__mofem__base__functions.html#ga176a495a81c85ce580624a284726521e">Legendre_polynomials</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> getValueL2AinsworthBase(pts);</div>
<div class="line">    <span class="keywordflow">break</span>;</div>
<div class="line">  <span class="keywordflow">default</span>:</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a id="a231" name="a231"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a>, <span class="stringliteral">&quot;Not yet implemented&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line">CGGUserPolynomialBase::getValueHdivForCGGBubble(MatrixDouble &amp;pts) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// This should be used only in case USER_BASE is selected</span></div>
<div class="line">  <span class="keywordflow">if</span> (this-&gt;cTx-&gt;bAse != <a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>) {</div>
<div class="line">    SETERRQ(PETSC_COMM_SELF, <a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">            <span class="stringliteral">&quot;Wrong base, should be USER_BASE&quot;</span>);</div>
<div class="line">  }</div>
<div class="line">  <span class="comment">// get access to data structures on element</span></div>
<div class="line">  <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data.html">EntitiesFieldData</a> &amp;data = this-&gt;cTx-&gt;dAta;</div>
<div class="line">  <span class="comment">// Get approximation order on element. Note that bubble functions are only</span></div>
<div class="line">  <span class="comment">// on tetrahedron.</span></div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> = data.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getOrder();<span class="comment"></span></div>
<div class="line"><span class="comment">  /// number of integration points</span></div>
<div class="line"><span class="comment"></span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nb_gauss_pts = pts.size2();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> check_cache = [<span class="keyword">this</span>](<span class="keywordtype">int</span> <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, <span class="keywordtype">int</span> nb_gauss_pts) -&gt; <span class="keywordtype">bool</span> {</div>
<div class="line">    <span class="keywordflow">if</span> (cachePhiPtr) {</div>
<div class="line">      <span class="keywordflow">return</span> cachePhiPtr-&gt;get&lt;0&gt;() == <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a> &amp;&amp;</div>
<div class="line">             cachePhiPtr-&gt;get&lt;1&gt;() == nb_gauss_pts;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (check_cache(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, nb_gauss_pts)) {</div>
<div class="line">    <span class="keyword">auto</span> &amp;mat = cachePhiPtr-&gt;get&lt;2&gt;();</div>
<div class="line">    <span class="keyword">auto</span> &amp;<a id="a232" name="a232"></a><a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = data.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>);</div>
<div class="line">    <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(mat.size1(), mat.size2(), <span class="keyword">false</span>);</div>
<div class="line">    noalias(<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>) = mat;</div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <span class="comment">// calculate shape functions, i.e. barycentric coordinates</span></div>
<div class="line">    shapeFun.resize(nb_gauss_pts, 4, <span class="keyword">false</span>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a>(&amp;*shapeFun.data().begin(), &amp;pts(0, 0), &amp;pts(1, 0),</div>
<div class="line">                      &amp;pts(2, 0), nb_gauss_pts);</div>
<div class="line">    <span class="comment">// derivatives of shape functions</span></div>
<div class="line">    <span class="keywordtype">double</span> diff_shape_fun[12];</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a233" name="a233"></a><a class="code hl_function" href="fem__tools_8h.html#a19deff62572d607bc77ed2f82fa639cc">ShapeDiffMBTET</a>(diff_shape_fun);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> nb_base_functions = <a class="code hl_define" href="_c_g_g_tonsorial_bubble_base_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a>(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>);</div>
<div class="line">    <span class="comment">// get base functions and set size</span></div>
<div class="line">    MatrixDouble &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = data.<a class="code hl_variable" href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">dataOnEntities</a>[MBTET][0].getN(<a class="code hl_enumvalue" href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a>);</div>
<div class="line">    <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(nb_gauss_pts, 9 * nb_base_functions, <span class="keyword">false</span>);</div>
<div class="line">    <span class="comment">// finally calculate base functions</span></div>
<div class="line">    <a id="_a234" name="_a234"></a><a class="code hl_class" href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2&lt;FTensor::PackPtr&lt;double *, 9&gt;</a>, 3, 3&gt; t_phi(</div>
<div class="line">        &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 0), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 1), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 2),</div>
<div class="line"> </div>
<div class="line">        &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 3), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 4), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 5),</div>
<div class="line"> </div>
<div class="line">        &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 6), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 7), &amp;<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>(0, 8));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_eshelbian_plasticity.html#a68543d06189d85f76d53dfc14a39ecf5">CGG_BubbleBase_MBTET</a>(<a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>, &amp;shapeFun(0, 0), diff_shape_fun, t_phi,</div>
<div class="line">                                nb_gauss_pts);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (cachePhiPtr) {</div>
<div class="line">      cachePhiPtr-&gt;get&lt;0&gt;() = <a class="code hl_variable" href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a>;</div>
<div class="line">      cachePhiPtr-&gt;get&lt;1&gt;() = nb_gauss_pts;</div>
<div class="line">      cachePhiPtr-&gt;get&lt;2&gt;().resize(<a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size1(), <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size2(), <span class="keyword">false</span>);</div>
<div class="line">      noalias(cachePhiPtr-&gt;get&lt;2&gt;()) = <a class="code hl_variable" href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a235" name="a235"></a><a class="code hl_function" href="struct_eshelbian_core.html#a4530aa6762e72237e130380c7ce2ba86">EshelbianCore::setBaseVolumeElementOps</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_rhs, <span class="keyword">const</span> <span class="keywordtype">bool</span> do_lhs, <span class="keyword">const</span> <span class="keywordtype">bool</span> calc_rates,</div>
<div class="line">    <a id="_a236" name="_a236"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a> var_vec,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; fe) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bubble_cache =</div>
<div class="line">      boost::make_shared&lt;CGGUserPolynomialBase::CachePhi&gt;(0, 0, MatrixDouble());</div>
<div class="line">  fe-&gt;getUserPolynomialBase() =</div>
<div class="line">      boost::make_shared&lt;CGGUserPolynomialBase&gt;(bubble_cache);</div>
<div class="line">  <a id="_a237" name="_a237"></a><a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      fe-&gt;getOpPtrVector(), {HDIV, H1, L2}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set integration rule</span></div>
<div class="line">  fe-&gt;getRuleHook = [](int, int, int) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  fe-&gt;setRuleHook = SetIntegrationAtFrontVolume(<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  <span class="comment">// fe-&gt;getRuleHook = VolRule();</span></div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a id="a238" name="a238"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>) {</div>
<div class="line">    <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a> =</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt;(<span class="keyword">new</span> <a id="_a239" name="_a239"></a><a class="code hl_struct" href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a>());</div>
<div class="line">    <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;physicsPtr = <a id="a240" name="a240"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate fields values</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a241" name="_a241"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts()));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a242" name="_a242"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), MBMAXTYPE));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a243" name="_a243"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_divergence.html">OpCalculateHVecTensorDivergence&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getDivPAtPts()));</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a244" name="_a244"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchTensorAtPts(), MBTET));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a245" name="_a245"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisAtPts(), MBTET));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxis0AtPts(), <a class="code hl_variable" href="struct_eshelbian_core.html#aec7eec34db87d222944bbaf74cf7c0f3">solTSStep</a>, MBTET));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2AtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// H1 displacements</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWH1AtPts()));</div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a246" name="_a246"></a><a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWGradH1AtPts()));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// velocities</span></div>
<div class="line">  <span class="keywordflow">if</span> (calc_rates) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a247" name="_a247"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2DotAtPts(), MBTET));</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a248" name="_a248"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values_dot.html">OpCalculateTensor2SymmetricFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchDotTensorAtPts(), MBTET));</div>
<div class="line">    }</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDot&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisDotAtPts(), MBTET));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a249" name="_a249"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_gradient_dot.html">OpCalculateVectorFieldGradientDot&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisGradDotAtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_gradient_dot.html">OpCalculateVectorFieldGradientDot&lt;6, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getGradLogStretchDotTensorAtPts(), MBTET));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// acceleration</span></div>
<div class="line">    <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">OpCalculateVectorFieldValuesDotDot&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2DotDotAtPts(), MBTET));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// variations</span></div>
<div class="line">  <span class="keywordflow">if</span> (var_vec.<a id="a250" name="a250"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html#ab83f85c53d250afafd28487980674a97">use_count</a>()) {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(), boost::make_shared&lt;double&gt;(1),</div>
<div class="line">        var_vec));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(), boost::make_shared&lt;double&gt;(1),</div>
<div class="line">        var_vec, MBMAXTYPE));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarRotAxisPts(), var_vec, MBTET));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_divergence.html">OpCalculateHVecTensorDivergence&lt;3, 3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getDivVarPiolaPts(), var_vec));</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarWL2Pts(), var_vec, MBTET));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateVarStretchFromStress(</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarLogStreachPts(), var_vec, MBTET));</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// calculate other derived quantities</span></div>
<div class="line">  fe-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a251" name="_a251"></a><a class="code hl_struct" href="struct_op_calculate_rotation_and_spatial_gradient.html">OpCalculateRotationAndSpatialGradient</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, ((do_rhs || do_lhs) &amp;&amp; calc_rates) ? <a class="code hl_variable" href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a> : 0.));</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// evaluate integration points</span></div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    fe-&gt;getOpPtrVector().push_back(<a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpJacobian(</div>
<div class="line">        tag, do_rhs, do_lhs, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a252" name="a252"></a><a class="code hl_function" href="struct_eshelbian_core.html#a7e7a066d74bb6e8258720b709490e138">EshelbianCore::setVolumeElementOps</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_elastic, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_material,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe_rhs,</div>
<div class="line">    boost::shared_ptr&lt;VolumeElementForcesAndSourcesCore&gt; &amp;fe_lhs) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** Contact requires that body is marked */</span></div>
<div class="line">  <span class="keyword">auto</span> get_body_range = [<span class="keyword">this</span>](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr :</div>
<div class="line">         <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(std::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_ptr-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                                                            dim, ents, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;by dim&quot;</span>);</div>
<div class="line">      map[m_ptr-&gt;getMeshsetId()] = ents;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> rule_contact = [](int, int, <span class="keywordtype">int</span> o) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  <span class="keyword">auto</span> refine = Tools::refineTriangle(<a class="code hl_variable" href="struct_eshelbian_core.html#a767ea904eb33f7f44cbdef68cfe7cdfc">contactRefinementLevels</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_rule_contact = [refine](</div>
<div class="line"> </div>
<div class="line">                              <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html">ForcesAndSourcesCore</a> *fe_raw_ptr, <span class="keywordtype">int</span> order_row,</div>
<div class="line">                              <span class="keywordtype">int</span> order_col, <span class="keywordtype">int</span> order_data</div>
<div class="line"> </div>
<div class="line">                          ) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> rule = 2 * order_data;</div>
<div class="line">    fe_raw_ptr-&gt;<a id="a253" name="a253"></a><a class="code hl_variable" href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#a91c6f5f96b8f4ec76ed7c87ea96bbd9c">gaussPts</a> = Tools::refineTriangleIntegrationPts(rule, refine);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> time_scale = boost::make_shared&lt;DynamicRelaxationTimeScale&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Right hand side</span></div>
<div class="line">  fe_rhs = boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a4530aa6762e72237e130380c7ce2ba86">setBaseVolumeElementOps</a>(tag, <span class="keyword">true</span>, <span class="keyword">false</span>, <span class="keyword">true</span>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(),</div>
<div class="line">                                 fe_rhs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a254" name="_a254"></a><a class="code hl_struct" href="struct_op_spatial_equilibrium.html">OpSpatialEquilibrium</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a255" name="_a255"></a><a class="code hl_struct" href="struct_op_spatial_rotation.html">OpSpatialRotation</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>));</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      <span class="comment">// do nothing - no stretch approximation</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSpatialPhysical(<a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">                                                     <a class="code hl_variable" href="struct_eshelbian_core.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>));</div>
<div class="line">    }</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a256" name="_a256"></a><a class="code hl_struct" href="struct_op_spatial_consistency_p.html">OpSpatialConsistencyP</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a257" name="_a257"></a><a class="code hl_struct" href="struct_op_spatial_consistency_bubble.html">OpSpatialConsistencyBubble</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a258" name="_a258"></a><a class="code hl_struct" href="struct_op_spatial_consistency_div_term.html">OpSpatialConsistencyDivTerm</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_hybridisation = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a> =</div>
<div class="line">          <a id="_a259" name="_a259"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a id="_a260" name="_a260"></a><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a id="_a261" name="_a261"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line">      <span class="comment">// op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = FaceRule();</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = [](int, int, int) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      };</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook =</div>
<div class="line">          SetIntegrationAtFrontFace(<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly one</span></div>
<div class="line">      <span class="comment">// domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a id="_a262" name="_a262"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_broken_loop_side.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a263" name="_a263"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_get_broken_base_side_data.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, broken_data_ptr));</div>
<div class="line">      <span class="keyword">auto</span> flux_mat_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;SPACE_DIM, SPACE_DIM&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                               flux_mat_ptr));</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a264" name="_a264"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_set_flux.html">OpSetFlux&lt;SideEleOp&gt;</a>(broken_data_ptr, flux_mat_ptr));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Assemble on skeleton</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keyword">using </span>OpC_dHybrid = <a id="_a265" name="_a265"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;A&gt;<a id="_a266" name="_a266"></a><a class="code hl_class" href="class_linear_form.html">::LinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDHybrid&lt;SPACE_DIM&gt;;</div>
<div class="line">      <span class="keyword">using </span>OpC_dBroken = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;A&gt;<a class="code hl_class" href="class_linear_form.html">::LinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrainDFlux&lt;SPACE_DIM&gt;;</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC_dHybrid(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, broken_data_ptr, boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line">      <span class="keyword">auto</span> hybrid_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>,</div>
<div class="line">                                                      hybrid_ptr));</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> OpC_dBroken(</div>
<div class="line">          broken_data_ptr, hybrid_ptr, boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_contact = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule_contact;</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook = set_rule_contact;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly</span></div>
<div class="line">      <span class="comment">// one domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Data storing contact fields</span></div>
<div class="line">      <span class="keyword">auto</span> contact_common_data_ptr =</div>
<div class="line">          boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_domain_side = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">        <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_broken_loop_side.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">        op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">            boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">        <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">            op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_get_broken_base_side_data.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                   broken_data_ptr));</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a267" name="_a267"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_trace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">        pip.push_back(op_loop_domain_side);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_contact_rhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// get body id and SDF range</span></div>
<div class="line">        <span class="keyword">auto</span> contact_sfd_map_range_ptr =</div>
<div class="line">            boost::make_shared&lt;std::map&lt;int, Range&gt;&gt;(</div>
<div class="line">                get_body_range(<span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">        <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">            <a id="a268" name="a268"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">            <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), <span class="keyword">nullptr</span>,</div>
<div class="line">            <span class="keyword">nullptr</span>));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a269" name="_a269"></a><a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_rhs.html">EshelbianPlasticity::OpConstrainBoundaryL2Rhs</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>,</div>
<div class="line">            contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a270" name="_a270"></a><a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_h_div_rhs.html">EshelbianPlasticity::OpConstrainBoundaryHDivRhs&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                broken_data_ptr, contact_common_data_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>));</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push ops to face/side pipeline</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_domain_side(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_contact_rhs(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_hybridisation(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_contact(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Body forces</span></div>
<div class="line">    <span class="keyword">using </span>BodyNaturalBC =</div>
<div class="line">        <a id="_a271" name="_a271"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_natural_b_c.html">NaturalBC&lt;VolumeElementForcesAndSourcesCore::UserDataOperator&gt;</a>::</div>
<div class="line">            Assembly&lt;PETSC&gt;::LinearForm&lt;<a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="thermo__elastic_8cpp.html#a650be1395bef846425c9a2cd2cc7a211">OpBodyForce</a> =</div>
<div class="line">        BodyNaturalBC::OpFlux&lt;NaturalMeshsetType&lt;BLOCKSET&gt;, 1, 3&gt;;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> BodyNaturalBC::AddFluxToPipeline&lt;OpBodyForce&gt;::add(</div>
<div class="line">        fe_rhs-&gt;getOpPtrVector(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, {time_scale},</div>
<div class="line">        <span class="stringliteral">&quot;BODY_FORCE&quot;</span>, Sev::inform);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Left hand side</span></div>
<div class="line">  fe_lhs = boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a4530aa6762e72237e130380c7ce2ba86">setBaseVolumeElementOps</a>(tag, <span class="keyword">true</span>, <span class="keyword">true</span>, <span class="keyword">true</span>, <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(),</div>
<div class="line">                                 fe_lhs);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// elastic</span></div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a272" name="_a272"></a><a class="code hl_struct" href="struct_op_spatial_consistency__d_p__d_p.html">OpSpatialConsistency_dP_dP</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a273" name="_a273"></a><a class="code hl_struct" href="struct_op_spatial_consistency__d_bubble__d_p.html">OpSpatialConsistency_dBubble_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a274" name="_a274"></a><a class="code hl_struct" href="struct_op_spatial_consistency__d_bubble__d_bubble.html">OpSpatialConsistency_dBubble_dBubble</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>,</div>
<div class="line">                                                   <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSpatialPhysical_du_du(</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a872472e8bf68a52c384c7b1db5aaa084">alphaU</a>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a275" name="_a275"></a><a class="code hl_struct" href="struct_op_spatial_physical__du__d_p.html">OpSpatialPhysical_du_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">true</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a276" name="_a276"></a><a class="code hl_struct" href="struct_op_spatial_physical__du__d_bubble.html">OpSpatialPhysical_du_dBubble</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">true</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a277" name="_a277"></a><a class="code hl_struct" href="struct_op_spatial_physical__du__domega.html">OpSpatialPhysical_du_domega</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">true</span> : <span class="keyword">false</span>));</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a278" name="_a278"></a><a class="code hl_struct" href="struct_op_spatial_equilibrium__dw__d_p.html">OpSpatialEquilibrium_dw_dP</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">true</span>));</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a279" name="_a279"></a><a class="code hl_struct" href="struct_op_spatial_equilibrium__dw__dw.html">OpSpatialEquilibrium_dw_dw</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a0529d7544a0444bc591f0a52e00cd551">alphaW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>));</div>
<div class="line"> </div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a280" name="_a280"></a><a class="code hl_struct" href="struct_op_spatial_consistency__d_p__domega.html">OpSpatialConsistency_dP_domega</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">true</span> : <span class="keyword">false</span>));</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a281" name="_a281"></a><a class="code hl_struct" href="struct_op_spatial_consistency__d_bubble__domega.html">OpSpatialConsistency_dBubble_domega</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>,</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">true</span> : <span class="keyword">false</span>));</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">symmetrySelector</a> == SYMMETRIC ? <span class="keyword">false</span> : <span class="keyword">true</span>) {</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a282" name="_a282"></a><a class="code hl_struct" href="struct_op_spatial_rotation__domega__du.html">OpSpatialRotation_domega_du</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">false</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a283" name="_a283"></a><a class="code hl_struct" href="struct_op_spatial_rotation__domega__d_p.html">OpSpatialRotation_domega_dP</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">false</span>));</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a284" name="_a284"></a><a class="code hl_struct" href="struct_op_spatial_rotation__domega__d_bubble.html">OpSpatialRotation_domega_dBubble</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">false</span>));</div>
<div class="line">    }</div>
<div class="line">    fe_lhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a285" name="_a285"></a><a class="code hl_struct" href="struct_op_spatial_rotation__domega__domega.html">OpSpatialRotation_domega_domega</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">alphaOmega</a>));</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_hybridisation = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line">      <span class="comment">// op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = FaceRule();</span></div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = [](int, int, int) {</div>
<div class="line">        <span class="keywordflow">return</span> -1;</div>
<div class="line">      };</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook =</div>
<div class="line">          SetIntegrationAtFrontFace(<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly one</span></div>
<div class="line">      <span class="comment">// domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_broken_loop_side.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_get_broken_base_side_data.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, broken_data_ptr));</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keyword">using </span>OpC = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">FormsIntegrators&lt;BdyEleOp&gt;::Assembly</a>&lt;A&gt;<a id="_a286" name="_a286"></a><a class="code hl_class" href="class_bi_linear_form.html">::BiLinearForm</a>&lt;</div>
<div class="line">          <a class="code hl_enumvalue" href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">GAUSS</a>&gt;::OpBrokenSpaceConstrain&lt;SPACE_DIM&gt;;</div>
<div class="line">      op_loop_skeleton_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> OpC(<a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, broken_data_ptr,</div>
<div class="line">                  boost::make_shared&lt;double&gt;(1.0), <span class="keyword">true</span>, <span class="keyword">false</span>));</div>
<div class="line"> </div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_contact = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::BoundaryEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// First: Iterate over skeleton FEs adjacent to Domain FEs</span></div>
<div class="line">      <span class="comment">// Note:  BoundaryEle, i.e. uses skeleton interation rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_skeleton_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;BoundaryEle&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy);</div>
<div class="line"> </div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;getRuleHook = rule_contact;</div>
<div class="line">      op_loop_skeleton_side-&gt;getSideFEPtr()-&gt;setRuleHook = set_rule_contact;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> EshelbianPlasticity::</div>
<div class="line">          AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add(</div>
<div class="line">              op_loop_skeleton_side-&gt;getOpPtrVector(), {L2},</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Second: Iterate over domain FEs adjacent to skelton, particularly</span></div>
<div class="line">      <span class="comment">// one domain element.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Data storing contact fields</span></div>
<div class="line">      <span class="keyword">auto</span> contact_common_data_ptr =</div>
<div class="line">          boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_domain_side = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">        <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_broken_loop_side.html">OpBrokenLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">        op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">            boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">        <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">            op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_get_broken_base_side_data.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                   broken_data_ptr));</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_trace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr()));</div>
<div class="line">        pip.push_back(op_loop_domain_side);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> add_ops_contact_lhs = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">        <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">        pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">            <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1), <span class="keyword">nullptr</span>,</div>
<div class="line">            <span class="keyword">nullptr</span>));</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// get body id and SDF range</span></div>
<div class="line">        <span class="keyword">auto</span> contact_sfd_map_range_ptr =</div>
<div class="line">            boost::make_shared&lt;std::map&lt;int, Range&gt;&gt;(</div>
<div class="line">                get_body_range(<span class="stringliteral">&quot;CONTACT_SDF&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1));</div>
<div class="line"> </div>
<div class="line">        pip.push_back(<span class="keyword">new</span> <a id="_a287" name="_a287"></a><a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_lhs__d_u.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dU</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>,</div>
<div class="line">            contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a288" name="_a288"></a><a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_lhs__d_p.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dP&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, broken_data_ptr, contact_common_data_ptr,</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_sfd_map_range_ptr));</div>
<div class="line">        pip.push_back(</div>
<div class="line">            <span class="keyword">new</span> <a id="_a289" name="_a289"></a><a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_h_div_lhs__d_u.html">EshelbianPlasticity::OpConstrainBoundaryHDivLhs_dU&lt;A, GAUSS&gt;</a>(</div>
<div class="line">                broken_data_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr,</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>));</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// push ops to face/side pipeline</span></div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_domain_side(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_ops_contact_lhs(op_loop_skeleton_side-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// Add skeleton to domain pipeline</span></div>
<div class="line">      pip.push_back(op_loop_skeleton_side);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_hybridisation(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_contact(fe_lhs-&gt;getOpPtrVector());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (add_material) {</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a290" name="a290"></a><a class="code hl_function" href="struct_eshelbian_core.html#a99a3132d0ad53b6ca41822303148d2d6">EshelbianCore::setFaceElementOps</a>(</div>
<div class="line">    <span class="keyword">const</span> <span class="keywordtype">bool</span> add_elastic, <span class="keyword">const</span> <span class="keywordtype">bool</span> add_material,</div>
<div class="line">    boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; &amp;fe_rhs,</div>
<div class="line">    boost::shared_ptr&lt;FaceElementForcesAndSourcesCore&gt; &amp;fe_lhs) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  fe_rhs = boost::make_shared&lt;FaceElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">  fe_lhs = boost::make_shared&lt;FaceElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// set integration rule</span></div>
<div class="line">  <span class="comment">// fe_rhs-&gt;getRuleHook = [](int, int, int p) { return 2 * (p + 1); };</span></div>
<div class="line">  <span class="comment">// fe_lhs-&gt;getRuleHook = [](int, int, int p) { return 2 * (p + 1); };</span></div>
<div class="line">  fe_rhs-&gt;getRuleHook = [](int, int, int) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  fe_lhs-&gt;getRuleHook = [](int, int, int) { <span class="keywordflow">return</span> -1; };</div>
<div class="line">  fe_rhs-&gt;setRuleHook = SetIntegrationAtFrontFace(<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  fe_lhs-&gt;setRuleHook = SetIntegrationAtFrontFace(<a class="code hl_variable" href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">frontVertices</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      fe_rhs-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">  <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      fe_lhs-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (add_elastic) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_broken_op_side = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">      <span class="keyword">using </span><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">      <span class="comment">// Iterate over domain FEs adjacent to boundary.</span></div>
<div class="line">      <span class="keyword">auto</span> broken_data_ptr =</div>
<div class="line">          boost::make_shared&lt;std::vector&lt;BrokenBaseSideData&gt;&gt;();</div>
<div class="line">      <span class="comment">// Note: EleOnSide, i.e. uses on domain projected skeleton rule</span></div>
<div class="line">      <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">      op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">          boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div>
<div class="line">      <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_get_broken_base_side_data.html">OpGetBrokenBaseSideData&lt;SideEleOp&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, broken_data_ptr));</div>
<div class="line">      boost::shared_ptr&lt;double&gt; piola_scale_ptr(<span class="keyword">new</span> <span class="keywordtype">double</span>);</div>
<div class="line">      op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSetScale(piola_scale_ptr,</div>
<div class="line">                                              <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      pip.push_back(op_loop_domain_side);</div>
<div class="line">      <span class="keywordflow">return</span> std::make_pair(broken_data_ptr, piola_scale_ptr);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> [broken_data_ptr, piola_scale_ptr] =</div>
<div class="line">        get_broken_op_side(fe_rhs-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a291" name="_a291"></a><a class="code hl_struct" href="struct_op_disp_bc.html">OpDispBc</a>(</div>
<div class="line">        broken_data_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>,</div>
<div class="line">        {</div>
<div class="line"> </div>
<div class="line">            boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(<span class="stringliteral">&quot;disp_history.txt&quot;</span>)</div>
<div class="line"> </div>
<div class="line">        }));</div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a id="_a292" name="_a292"></a><a class="code hl_struct" href="struct_op_rotation_bc.html">OpRotationBc</a>(broken_data_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#a5b883dfed933920248c7e23bf940d6e0">bcSpatialRotationVecPtr</a>,</div>
<div class="line"> </div>
<div class="line">                         {</div>
<div class="line"> </div>
<div class="line">                             boost::make_shared&lt;DynamicRelaxationTimeScale&gt;(</div>
<div class="line">                                 <span class="stringliteral">&quot;rotation_history.txt&quot;</span>)</div>
<div class="line"> </div>
<div class="line">                         }));</div>
<div class="line"> </div>
<div class="line">    fe_rhs-&gt;getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a293" name="_a293"></a><a class="code hl_struct" href="struct_op_broken_traction_bc.html">OpBrokenTractionBc</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>, piola_scale_ptr));</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a294" name="a294"></a><a class="code hl_function" href="struct_eshelbian_core.html#a973fec6048052976e4167d61468443fb">EshelbianCore::setContactElementRhsOps</a>(</div>
<div class="line"> </div>
<div class="line">    boost::shared_ptr&lt;ContactTree&gt; &amp;fe_contact_tree</div>
<div class="line"> </div>
<div class="line">) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">  /** Contact requires that body is marked */</span></div>
<div class="line">  <span class="keyword">auto</span> get_body_range = [<span class="keyword">this</span>](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim, <span class="keyword">auto</span> sev) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> m_ptr :</div>
<div class="line">         <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(std::regex(</div>
<div class="line"> </div>
<div class="line">             (boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str()</div>
<div class="line"> </div>
<div class="line">                 ))</div>
<div class="line"> </div>
<div class="line">    ) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> ents;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(m_ptr-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                                                            dim, ents, <span class="keyword">true</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;by dim&quot;</span>);</div>
<div class="line">      map[m_ptr-&gt;getMeshsetId()] = ents;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSYNC&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Meshset: &quot;</span> &lt;&lt; m_ptr-&gt;getMeshsetId() &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                               &lt;&lt; ents.size() &lt;&lt; <span class="stringliteral">&quot; entities&quot;</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <a id="a295" name="a295"></a><a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), sev);</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_map_skin = [<span class="keyword">this</span>](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    ParallelComm *pcomm =</div>
<div class="line">        ParallelComm::get_pcomm(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_define" href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a>);</div>
<div class="line"> </div>
<div class="line">    Skinner skin(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> skin_faces;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> skin.find_skin(0, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, <span class="keyword">false</span>, skin_faces);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(pcomm-&gt;filter_pstatus(skin_faces,</div>
<div class="line">                                           PSTATUS_SHARED | PSTATUS_MULTISHARED,</div>
<div class="line">                                           PSTATUS_NOT, -1, <span class="keyword">nullptr</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;filter&quot;</span>);</div>
<div class="line">      <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.swap(skin_faces);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">/* The above code is written in C++ and it appears to be defining and using</span></div>
<div class="line"><span class="comment">  various operations on boundary elements and side elements. */</span></div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a> = <a id="_a296" name="_a296"></a><a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">  <span class="keyword">using </span><a id="_a297" name="_a297"></a><a class="code hl_class" href="class_boundary_ele_op.html">BoundaryEleOp</a> = BoundaryEle::UserDataOperator;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> contact_common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calcs_side_traction = [&amp;](<span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">    op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">        boost::make_shared&lt;CGGUserPolynomialBase&gt;();</div>
<div class="line">    <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">    op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_trace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line">    pip.push_back(op_loop_domain_side);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_contact_three = [&amp;]() {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> tree_moab_ptr = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">    fe_contact_tree = boost::make_shared&lt;ContactTree&gt;(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, tree_moab_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">spaceOrder</a>,</div>
<div class="line">        get_body_range(<span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::inform));</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calcs_side_traction(fe_contact_tree-&gt;getOpPtrVector());</div>
<div class="line">    <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">    fe_contact_tree-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> OpMoveNode(fe_contact_tree, contact_common_data_ptr, u_h1_ptr));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> add_contact_three();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a298" name="a298"></a><a class="code hl_function" href="struct_eshelbian_core.html#a086c46eedf160d647dd5261161545ed4">EshelbianCore::setElasticElementOps</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Add contact operators. Note that only for rhs. THe lhs is assembled with</span></div>
<div class="line">  <span class="comment">// volume element, to enable schur complement evaluation.</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a973fec6048052976e4167d61468443fb">setContactElementRhsOps</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a7e7a066d74bb6e8258720b709490e138">setVolumeElementOps</a>(tag, <span class="keyword">true</span>, <span class="keyword">false</span>, <a id="a299" name="a299"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>, <a id="a300" name="a300"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a99a3132d0ad53b6ca41822303148d2d6">setFaceElementOps</a>(<span class="keyword">true</span>, <span class="keyword">false</span>, <a id="a301" name="a301"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a2d854849515a43de7542231c5dc29570">elasticBcRhs</a>, <a id="a302" name="a302"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a3fa759a191f5c61035bc28d824acea64">elasticBcLhs</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> adj_cache =</div>
<div class="line">      boost::make_shared&lt;ForcesAndSourcesCore::UserDataOperator::AdjCache&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_op_contact_bc = [&amp;]() {</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a> = <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;SideEle&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, Sev::noisy, adj_cache);</div>
<div class="line">    <span class="keywordflow">return</span> op_loop_side;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a303" name="a303"></a><a class="code hl_function" href="struct_eshelbian_core.html#a74019c5d29e41cf539cd905c55497f00">EshelbianCore::setElasticElementToTs</a>(DM dm) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  boost::shared_ptr&lt;FEMethod&gt; null;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">DMMoFEMTSSetI2Function</a>(dm, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">DMMoFEMTSSetI2Function</a>(dm, <a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a2d854849515a43de7542231c5dc29570">elasticBcRhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">DMMoFEMTSSetI2Jacobian</a>(dm, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>, null,</div>
<div class="line">                                  null);</div>
<div class="line">    <span class="comment">// CHKERR DMMoFEMTSSetI2Jacobian(dm, naturalBcElement, elasticBcLhs, null,</span></div>
<div class="line">    <span class="comment">//                               null);</span></div>
<div class="line"> </div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">DMMoFEMTSSetIFunction</a>(dm, <a class="code hl_variable" href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">naturalBcElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a2d854849515a43de7542231c5dc29570">elasticBcRhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">DMMoFEMTSSetIJacobian</a>(dm, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>, null,</div>
<div class="line">                                 null);</div>
<div class="line">    <span class="comment">// CHKERR DMMoFEMTSSetIJacobian(dm, naturalBcElement, elasticBcLhs, null,</span></div>
<div class="line">    <span class="comment">//                              null);</span></div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_eshelbian_monitor_8cpp.html">impl/EshelbianMonitor.cpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_set_up_schur_impl_8cpp.html">impl/SetUpSchurImpl.cpp</a>&quot;</span></div>
<div class="line"><span class="preprocessor">#include &quot;<a class="code" href="_t_s_elastic_post_step_8cpp.html">impl/TSElasticPostStep.cpp</a>&quot;</span></div>
<div class="line"> </div>
<div class="line"><span class="keyword">struct </span>solve_elastic_setup {</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">inline</span> <span class="keyword">static</span> <span class="keyword">auto</span> setup(<a class="code hl_struct" href="struct_eshelbian_core.html">EshelbianCore</a> *ep_ptr, TS ts, Vec x,</div>
<div class="line">                           <span class="keywordtype">bool</span> set_ts_monitor) {</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line">    <span class="keyword">auto</span> setup_sdf = [&amp;]() {</div>
<div class="line">      boost::shared_ptr&lt;ContactOps::SDFPython&gt; sdf_python_ptr;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> file_exists = [](std::string myfile) {</div>
<div class="line">        std::ifstream file(myfile.c_str());</div>
<div class="line">        <span class="keywordflow">if</span> (file) {</div>
<div class="line">          <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">char</span> sdf_file_name[255] = <span class="stringliteral">&quot;sdf.py&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#acd15202cb7502a684f8276aae2b4ed70">PetscOptionsGetString</a>(PETSC_NULL, PETSC_NULL, <span class="stringliteral">&quot;-sdf_file&quot;</span>,</div>
<div class="line">                                   sdf_file_name, 255, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (file_exists(sdf_file_name)) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; sdf_file_name &lt;&lt; <span class="stringliteral">&quot; file found&quot;</span>;</div>
<div class="line">        sdf_python_ptr = boost::make_shared&lt;ContactOps::SDFPython&gt;();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> sdf_python_ptr-&gt;sdfInit(sdf_file_name);</div>
<div class="line">        ContactOps::sdfPythonWeakPtr = sdf_python_ptr;</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::warning) &lt;&lt; sdf_file_name &lt;&lt; <span class="stringliteral">&quot; file NOT found&quot;</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> sdf_python_ptr;</div>
<div class="line">    };</div>
<div class="line">    <span class="keyword">auto</span> sdf_python_ptr = setup_sdf();</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_ts_monitor = [&amp;]() {</div>
<div class="line">      boost::shared_ptr&lt;TsCtx&gt; <a id="a304" name="a304"></a><a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>;</div>
<div class="line">      <a class="code hl_function" href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">DMMoFEMGetTsCtx</a>(ep_ptr-&gt;<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">      <span class="keywordflow">if</span> (set_ts_monitor) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSMonitorSet(ts, TsMonitorSet, <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>.get(), PETSC_NULL);</div>
<div class="line">        <span class="keyword">auto</span> monitor_ptr = boost::make_shared&lt;EshelbianMonitor&gt;(*ep_ptr);</div>
<div class="line">        <a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>-&gt;<a id="a305" name="a305"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_ts_ctx.html#a3980182510ce819db5b281b6df595130">getLoopsMonitor</a>().push_back(</div>
<div class="line">            <a id="_a306" name="_a306"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_pair_name_f_e_method_ptr.html">TsCtx::PairNameFEMethodPtr</a>(ep_ptr-&gt;<a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, monitor_ptr));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> std::make_tuple(<a class="code hl_variable" href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a>);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_snes_monitor = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">      SNES snes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">      PetscViewerAndFormat *vf;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscViewerAndFormatCreate(PETSC_VIEWER_STDOUT_WORLD,</div>
<div class="line">                                        PETSC_VIEWER_DEFAULT, &amp;vf);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESMonitorSet(</div>
<div class="line">          snes,</div>
<div class="line">          (<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(SNES, PetscInt, PetscReal,</div>
<div class="line">                             <span class="keywordtype">void</span> *))SNESMonitorFields,</div>
<div class="line">          vf, (<a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a>(*)(<span class="keywordtype">void</span> **))PetscViewerAndFormatDestroy);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_section = [&amp;]() {</div>
<div class="line">      PetscSection section_raw;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> DMGetSection(ep_ptr-&gt;<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, &amp;section_raw);</div>
<div class="line">      <span class="keywordtype">int</span> num_fields;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetNumFields(section_raw, &amp;num_fields);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ff = 0; ff != num_fields; ff++) {</div>
<div class="line">        <span class="keyword">const</span> <span class="keywordtype">char</span> *<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscSectionGetFieldName(section_raw, ff, &amp;<a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">        <a id="a307" name="a307"></a><a class="code hl_define" href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform, <span class="stringliteral">&quot;Field %d name %s&quot;</span>, ff, <a class="code hl_variable" href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> section_raw;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_vector_on_mesh = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">DMoFEMMeshToLocalVector</a>(ep_ptr-&gt;<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, x, INSERT_VALUES,</div>
<div class="line">                                     SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> setup_schur_block_solver = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSAppendOptionsPrefix(ts, <span class="stringliteral">&quot;elastic_&quot;</span>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetFromOptions(ts);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetDM(ts, ep_ptr-&gt;<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line">      <span class="comment">// Adding field split solver</span></div>
<div class="line">      boost::shared_ptr&lt;EshelbianCore::SetUpSchur&gt; schur_ptr;</div>
<div class="line">      <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (A == AssemblyType::BLOCK_MAT) {</div>
<div class="line">        schur_ptr =</div>
<div class="line">            <a id="a308" name="a308"></a><a class="code hl_function" href="struct_eshelbian_core_1_1_set_up_schur.html#a6eb28d3a5bfe67448e57dd15eaee5318">EshelbianCore::SetUpSchur::createSetUpSchur</a>(ep_ptr-&gt;<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, ep_ptr);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(schur_ptr-&gt;setUp(ts), <span class="stringliteral">&quot;setup schur&quot;</span>);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">return</span> schur_ptr;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Warning: sequence of construction is not guaranteed for tuple. You have</span></div>
<div class="line">    <span class="comment">// to enforce order by proper packaging.</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifdef PYTHON_SDF</span></div>
<div class="line">    <span class="keywordflow">return</span> std::make_tuple(setup_sdf(), setup_ts_monitor(),</div>
<div class="line">                           setup_snes_monitor(), setup_section(),</div>
<div class="line">                           set_vector_on_mesh(), setup_schur_block_solver());</div>
<div class="line"><span class="preprocessor">#else</span></div>
<div class="line">    <span class="keywordflow">return</span> std::make_tuple(setup_ts_monitor(), setup_snes_monitor(),</div>
<div class="line">                           setup_section(), set_vector_on_mesh(),</div>
<div class="line">                           setup_schur_block_solver());</div>
<div class="line"><span class="preprocessor">#endif</span></div>
<div class="line">  }</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a309" name="a309"></a><a class="code hl_function" href="struct_eshelbian_core.html#a64e2ddd4583aa15ef34929b7c16f6abf">EshelbianCore::solveElastic</a>(TS ts, Vec x) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> debug_residuals = <span class="keyword">true</span>;</div>
<div class="line">  <span class="keywordflow">if</span> (debug_residuals) {</div>
<div class="line">    <span class="keyword">auto</span> ts_ctx_ptr = <a class="code hl_function" href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">getDMTsCtx</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>);</div>
<div class="line">    <span class="keyword">auto</span> post_proc = [&amp;](TS ts, PetscReal <a id="a310" name="a310"></a><a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, Vec u, Vec u_t, Vec u_tt, Vec <a id="a311" name="a311"></a><a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>,</div>
<div class="line">                         <span class="keywordtype">void</span> *ctx) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      SNES snes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">      <span class="keywordtype">int</span> it;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetIterationNumber(snes, &amp;it);</div>
<div class="line">      std::string file_name = <span class="stringliteral">&quot;snes_iteration_&quot;</span> + std::to_string(it) + <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a312" name="a312"></a><a class="code hl_function" href="struct_eshelbian_core.html#af6c7c52dde40c4a5f90afda29a7dad8f">postProcessResults</a>(1, file_name, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line">      std::string file_skel_name =</div>
<div class="line">          <span class="stringliteral">&quot;snes_iteration_skel_&quot;</span> + std::to_string(it) + <span class="stringliteral">&quot;.h5m&quot;</span>;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a313" name="a313"></a><a class="code hl_function" href="struct_eshelbian_core.html#a28419be22dbaad69b585370d6ae66215">postProcessSkeletonResults</a>(1, file_skel_name, <a class="code hl_enumvalue" href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a>);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line">    ts_ctx_ptr-&gt;tsDebugHook = post_proc;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> storage = solve_elastic_setup::setup(<span class="keyword">this</span>, ts, x, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (std::abs(<a class="code hl_variable" href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">alphaRho</a>) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">    Vec xx;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDuplicate(x, &amp;xx);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(xx);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TS2SetSolution(ts, x, xx);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecDestroy(&amp;xx);</div>
<div class="line">  } <span class="keywordflow">else</span> {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetSolution(ts, x);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(ts);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPreStep(ts, <a id="a314" name="a314"></a><a class="code hl_function" href="struct_t_s_elastic_post_step.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, <a id="a315" name="a315"></a><a class="code hl_function" href="struct_t_s_elastic_post_step.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a316" name="a316"></a><a class="code hl_function" href="struct_t_s_elastic_post_step.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a>(<span class="keyword">this</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a317" name="a317"></a><a class="code hl_function" href="struct_t_s_elastic_post_step.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a>();</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line"> </div>
<div class="line">  SNES snes;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">  <span class="keywordtype">int</span> lin_solver_iterations;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetLinearSolveIterations(snes, &amp;lin_solver_iterations);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Number of linear solver iterations &quot;</span> &lt;&lt; lin_solver_iterations;</div>
<div class="line"> </div>
<div class="line">  PetscBool test_cook_flg = PETSC_FALSE;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a55db6ee7b037f883685d61baabd7ace4">PetscOptionsGetBool</a>(PETSC_NULL, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;-test_cook&quot;</span>, &amp;test_cook_flg,</div>
<div class="line">                             PETSC_NULL);</div>
<div class="line">  <span class="keywordflow">if</span> (test_cook_flg) {</div>
<div class="line">    <span class="keyword">constexpr</span> <span class="keywordtype">int</span> expected_lin_solver_iterations = 11;</div>
<div class="line">    <span class="keywordflow">if</span> (lin_solver_iterations &gt; expected_lin_solver_iterations)</div>
<div class="line">      SETERRQ2(</div>
<div class="line">          PETSC_COMM_SELF, <a id="a318" name="a318"></a><a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>,</div>
<div class="line">          <span class="stringliteral">&quot;Expected number of iterations is different than expected %d &gt; %d&quot;</span>,</div>
<div class="line">          lin_solver_iterations, expected_lin_solver_iterations);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a319" name="a319"></a><a class="code hl_function" href="struct_eshelbian_core.html#a7980928dbcfa5bf174ac19e22784fe95">gettingNorms</a>();</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a320" name="a320"></a><a class="code hl_function" href="struct_eshelbian_core.html#a832337ab1645d6112dda0d6c0573088b">EshelbianCore::solveDynamicRelaxation</a>(TS ts, Vec x) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> storage = solve_elastic_setup::setup(<span class="keyword">this</span>, ts, x, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> final_time = 1;</div>
<div class="line">  <span class="keywordtype">double</span> delta_time = 0.1;</div>
<div class="line">  <span class="keywordtype">int</span> max_it = 10;</div>
<div class="line">  PetscBool ts_h1_update = PETSC_FALSE;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBegin(PETSC_COMM_WORLD, <span class="stringliteral">&quot;&quot;</span>, <span class="stringliteral">&quot;Dynamic Relaxation Options&quot;</span>,</div>
<div class="line">                           <span class="stringliteral">&quot;none&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-dynamic_final_time&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;dynamic relaxation final time&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, final_time,</div>
<div class="line">                            &amp;final_time, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsScalar(<span class="stringliteral">&quot;-dynamic_delta_time&quot;</span>,</div>
<div class="line">                            <span class="stringliteral">&quot;dynamic relaxation final time&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, delta_time,</div>
<div class="line">                            &amp;delta_time, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsInt(<span class="stringliteral">&quot;-dynamic_max_it&quot;</span>, <span class="stringliteral">&quot;dynamic relaxation iterations&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                         max_it, &amp;max_it, PETSC_NULL);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> PetscOptionsBool(<span class="stringliteral">&quot;-dynamic_h1_update&quot;</span>, <span class="stringliteral">&quot;update each ts step&quot;</span>, <span class="stringliteral">&quot;&quot;</span>,</div>
<div class="line">                          ts_h1_update, &amp;ts_h1_update, PETSC_NULL);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a> = PetscOptionsEnd();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a>(<a class="code hl_variable" href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> setup_ts_monitor = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> monitor_ptr = boost::make_shared&lt;EshelbianMonitor&gt;(*<span class="keyword">this</span>);</div>
<div class="line">    <span class="keywordflow">return</span> monitor_ptr;</div>
<div class="line">  };</div>
<div class="line">  <span class="keyword">auto</span> monitor_ptr = setup_ts_monitor();</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetUp(ts);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_t_s_elastic_post_step.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a>(<span class="keyword">this</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> ts_delta_time;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetTimeStep(ts, &amp;ts_delta_time);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (ts_h1_update) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPreStep(ts, <a class="code hl_function" href="struct_t_s_elastic_post_step.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetPostStep(ts, <a class="code hl_function" href="struct_t_s_elastic_post_step.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_t_s_elastic_post_step.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>(ts);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_t_s_elastic_post_step.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>(ts);</div>
<div class="line"> </div>
<div class="line">  <a id="a321" name="a321"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> = 0;</div>
<div class="line">  <a id="a322" name="a322"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> = 0;</div>
<div class="line">  monitor_ptr-&gt;ts_u = PETSC_NULL;</div>
<div class="line">  monitor_ptr-&gt;ts_t = <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a>;</div>
<div class="line">  monitor_ptr-&gt;ts_step = <a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, monitor_ptr);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;IT &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> &lt;&lt; <span class="stringliteral">&quot; Time &quot;</span></div>
<div class="line">                               &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> &lt;&lt; <span class="stringliteral">&quot; delta time &quot;</span> &lt;&lt; delta_time;</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> += delta_time;</div>
<div class="line">  ++<a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (; <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> &lt; final_time; <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> += delta_time) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;IT &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> &lt;&lt; <span class="stringliteral">&quot; Time &quot;</span></div>
<div class="line">                                 &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a> &lt;&lt; <span class="stringliteral">&quot; delta time &quot;</span> &lt;&lt; delta_time;</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetStepNumber(ts, 0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetTime(ts, 0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSetTimeStep(ts, ts_delta_time);</div>
<div class="line">    <span class="keywordflow">if</span> (!ts_h1_update) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_t_s_elastic_post_step.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a>(ts);</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSSolve(ts, PETSC_NULL);</div>
<div class="line">    <span class="keywordflow">if</span> (!ts_h1_update) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_t_s_elastic_post_step.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a>(ts);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    monitor_ptr-&gt;ts_u = PETSC_NULL;</div>
<div class="line">    monitor_ptr-&gt;ts_t = <a class="code hl_variable" href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">dynamicTime</a>;</div>
<div class="line">    monitor_ptr-&gt;ts_step = <a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">dmElastic</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, monitor_ptr);</div>
<div class="line"> </div>
<div class="line">    ++<a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a>;</div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">dynamicStep</a> &gt; max_it)</div>
<div class="line">      <span class="keywordflow">break</span>;</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_t_s_elastic_post_step.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a>();</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;(</div>
<div class="line">      {<a class="code hl_variable" href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">elasticFeLhs</a>.get(), <a class="code hl_variable" href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">elasticFeRhs</a>.get()});</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a323" name="a323"></a><a class="code hl_function" href="struct_eshelbian_core.html#a3e38767261f39bd323b727fd31959284">EshelbianCore::setBlockTagsOnSkin</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_block = [&amp;](<span class="keyword">auto</span> name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::map&lt;int, Range&gt; map;</div>
<div class="line">    <span class="keyword">auto</span> set_tag_impl = [&amp;](<span class="keyword">auto</span> name) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> mesh_mng = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">      <span class="keyword">auto</span> bcs = mesh_mng-&gt;<a class="code hl_function" href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">getCubitMeshsetPtr</a>(</div>
<div class="line"> </div>
<div class="line">          std::regex((boost::format(<span class="stringliteral">&quot;%s(.*)&quot;</span>) % name).str())</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bcs) {</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc-&gt;getMeshsetIdEntitiesByDimension(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), dim, r,</div>
<div class="line">                                                   <span class="keyword">true</span>);</div>
<div class="line">        map[bc-&gt;getMeshsetId()] = <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>;</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag_impl(name);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(name, map);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_skin = [&amp;](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map.second) {</div>
<div class="line">      <span class="keyword">auto</span> s = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second));</div>
<div class="line">      <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second.swap(s);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> map;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">auto</span> &amp;&amp;map) {</div>
<div class="line">    <a class="code hl_class" href="class_tag.html">Tag</a> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">    <span class="keyword">auto</span> name = map.first;</div>
<div class="line">    <span class="keywordtype">int</span> def_val[] = {-1};</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(name, 1, MB_TYPE_INTEGER, th,</div>
<div class="line">                                         MB_TAG_SPARSE | MB_TAG_CREAT, def_val),</div>
<div class="line">        <span class="stringliteral">&quot;create tag&quot;</span>);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : map.second) {</div>
<div class="line">      <span class="keywordtype">int</span> <span class="keywordtype">id</span> = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_clear_data(th, <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second, &amp;<span class="keywordtype">id</span>),</div>
<div class="line">                     <span class="stringliteral">&quot;clear tag&quot;</span>);</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <a class="code hl_variable" href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">th</a>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a id="a324" name="a324"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(set_tag(set_skin(set_block(<span class="stringliteral">&quot;BODY&quot;</span>, 3))));</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(set_tag(set_skin(set_block(<span class="stringliteral">&quot;MAT_ELASTIC&quot;</span>, 3))));</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(</div>
<div class="line">      set_tag(set_skin(set_block(<span class="stringliteral">&quot;MAT_NEOHOOKEAN&quot;</span>, 3))));</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>.push_back(set_tag(set_block(<span class="stringliteral">&quot;CONTACT&quot;</span>, 2)));</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a></div>
<div class="line"><a class="code hl_function" href="struct_eshelbian_core.html#af6c7c52dde40c4a5f90afda29a7dad8f">EshelbianCore::postProcessResults</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag, <span class="keyword">const</span> std::string file,</div>
<div class="line">                                  Vec f_residual, Vec var_vector,</div>
<div class="line">                                  std::vector&lt;Tag&gt; tags_to_transfer) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// add tags to transfer</span></div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : <a class="code hl_variable" href="struct_eshelbian_core.html#a3f4520cca364a7edbf442bb09054566b">listTagsToTransfer</a>) {</div>
<div class="line">    tags_to_transfer.push_back(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>) {</div>
<div class="line">    <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a> =</div>
<div class="line">        boost::shared_ptr&lt;DataAtIntegrationPts&gt;(<span class="keyword">new</span> <a class="code hl_struct" href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a>());</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">contactElement</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_post_proc = [&amp;](<span class="keyword">auto</span> &amp;post_proc_mesh, <span class="keyword">auto</span> sense) {</div>
<div class="line">    <span class="keyword">using </span><a id="_a325" name="_a325"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">FaceEle</a> = <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line">    <span class="keyword">auto</span> post_proc_ptr =</div>
<div class="line">        boost::make_shared&lt;PostProcBrokenMeshInMoabBaseCont&lt;FaceEle&gt;&gt;(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, post_proc_mesh);</div>
<div class="line">    <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        post_proc_ptr-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> domain_ops = [&amp;](<span class="keyword">auto</span> &amp;fe, <span class="keywordtype">int</span> sense) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      fe.getUserPolynomialBase() =</div>
<div class="line">          boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line">      <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">          fe.getOpPtrVector(), {HDIV, H1, L2}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">      <span class="keyword">auto</span> piola_scale_ptr = boost::make_shared&lt;double&gt;(1.0);</div>
<div class="line">      fe.getOpPtrVector().push_back(<a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpSetScale(</div>
<div class="line">          piola_scale_ptr, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), piola_scale_ptr));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts(), piola_scale_ptr,</div>
<div class="line">          <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(), MBMAXTYPE));</div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">        fe.getOpPtrVector().push_back(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateStretchFromStress(</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        fe.getOpPtrVector().push_back(</div>
<div class="line">            <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchTensorAtPts(), MBTET));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(var_vector, <span class="keyword">true</span>);</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec));</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec, MBMAXTYPE));</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarRotAxisPts(), vec, MBTET));</div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateVarStretchFromStress(</div>
<div class="line">                  <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">        } <span class="keywordflow">else</span> {</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                  <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarLogStreachPts(), vec, MBTET));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisAtPts(), MBTET));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxis0AtPts(), <a class="code hl_variable" href="struct_eshelbian_core.html#aec7eec34db87d222944bbaf74cf7c0f3">solTSStep</a>, MBTET));</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2AtPts(), MBTET));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWH1AtPts()));</div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_class" href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient&lt;3, 3&gt;</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWGradH1AtPts()));</div>
<div class="line">      <span class="comment">// evaluate derived quantities</span></div>
<div class="line">      fe.getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a class="code hl_struct" href="struct_op_calculate_rotation_and_spatial_gradient.html">OpCalculateRotationAndSpatialGradient</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// evaluate integration points</span></div>
<div class="line">      fe.getOpPtrVector().push_back(<a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpJacobian(</div>
<div class="line">          tag, <span class="keyword">true</span>, <span class="keyword">false</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>));</div>
<div class="line">      <span class="keywordflow">if</span> (<span class="keyword">auto</span> op =</div>
<div class="line">              <a class="code hl_variable" href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">physicalEquations</a>-&gt;returnOpCalculateEnergy(<a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, <span class="keyword">nullptr</span>)) {</div>
<div class="line">        fe.getOpPtrVector().push_back(op);</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a326" name="_a326"></a><a class="code hl_struct" href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// // post-proc</span></div>
<div class="line">      <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a id="_a327" name="_a327"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab</a>&lt;</div>
<div class="line">          <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">          VolumeElementForcesAndSourcesCoreOnSide::UserDataOperator&gt;;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">struct </span>OpSidePPMap : <span class="keyword">public</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> {</div>
<div class="line">        OpSidePPMap(moab::Interface &amp;post_proc_mesh,</div>
<div class="line">                    std::vector&lt;EntityHandle&gt; &amp;map_gauss_pts,</div>
<div class="line">                    DataMapVec data_map_scalar, DataMapMat data_map_vec,</div>
<div class="line">                    DataMapMat data_map_mat, DataMapMat data_symm_map_mat,</div>
<div class="line">                    <span class="keywordtype">int</span> sense)</div>
<div class="line">            : <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(post_proc_mesh, map_gauss_pts, data_map_scalar,</div>
<div class="line">                      data_map_vec, data_map_mat, data_symm_map_mat),</div>
<div class="line">              tagSense(sense) {}</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> doWork(<span class="keywordtype">int</span> side, EntityType type,</div>
<div class="line">                              <a class="code hl_struct" href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">EntitiesFieldData::EntData</a> &amp;data) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (tagSense != OpPPMap::getSkeletonSense())</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a>(0);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> OpPPMap::doWork(side, type, data);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">private</span>:</div>
<div class="line">        <span class="keywordtype">int</span> tagSense;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      OpPPMap::DataMapMat vec_fields;</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;SpatialDisplacementL2&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWL2AtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;SpatialDisplacementH1&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getSmallWH1AtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;Omega&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getRotAxisAtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;ContactDisplacement&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getContactL2AtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;AngularMomentum&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLeviKirchhoffAtPts();</div>
<div class="line">      vec_fields[<span class="stringliteral">&quot;X&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLargeXH1AtPts();</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(var_vector, <span class="keyword">true</span>);</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;VarOmega&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarRotAxisPts();</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;VarSpatialDisplacementL2&quot;</span>] =</div>
<div class="line">            boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, vec_fields[<span class="stringliteral">&quot;VarSpatialDisplacementL2&quot;</span>], vec, MBTET));</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>);</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;ResSpatialDisplacementL2&quot;</span>] =</div>
<div class="line">            boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, vec_fields[<span class="stringliteral">&quot;ResSpatialDisplacementL2&quot;</span>], vec, MBTET));</div>
<div class="line">        vec_fields[<span class="stringliteral">&quot;ResOmega&quot;</span>] = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, vec_fields[<span class="stringliteral">&quot;ResOmega&quot;</span>], vec, MBTET));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      OpPPMap::DataMapMat mat_fields;</div>
<div class="line">      mat_fields[<span class="stringliteral">&quot;PiolaStress&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getApproxPAtPts();</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        mat_fields[<span class="stringliteral">&quot;VarPiolaStress&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarPiolaPts();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>);</div>
<div class="line">        mat_fields[<span class="stringliteral">&quot;ResPiolaStress&quot;</span>] = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, mat_fields[<span class="stringliteral">&quot;ResPiolaStress&quot;</span>],</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec));</div>
<div class="line">        fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field.html">OpCalculateHTensorTensorField&lt;3, 3&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, mat_fields[<span class="stringliteral">&quot;ResPiolaStress&quot;</span>],</div>
<div class="line">            boost::make_shared&lt;double&gt;(1), vec, MBMAXTYPE));</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      OpPPMap::DataMapMat mat_fields_symm;</div>
<div class="line">      mat_fields_symm[<span class="stringliteral">&quot;LogSpatialStretch&quot;</span>] =</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLogStretchTensorAtPts();</div>
<div class="line">      mat_fields_symm[<span class="stringliteral">&quot;SpatialStretch&quot;</span>] = <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getStretchTensorAtPts();</div>
<div class="line">      <span class="keywordflow">if</span> (var_vector) {</div>
<div class="line">        mat_fields_symm[<span class="stringliteral">&quot;VarLogSpatialStretch&quot;</span>] =</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getVarLogStreachPts();</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">        <span class="keyword">auto</span> vec = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>);</div>
<div class="line">        <span class="keywordflow">if</span> (!<a class="code hl_variable" href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">noStretch</a>) {</div>
<div class="line">          mat_fields_symm[<span class="stringliteral">&quot;ResLogSpatialStretch&quot;</span>] =</div>
<div class="line">              boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">          fe.getOpPtrVector().push_back(</div>
<div class="line">              <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values.html">OpCalculateTensor2SymmetricFieldValues&lt;3&gt;</a>(</div>
<div class="line">                  <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, mat_fields_symm[<span class="stringliteral">&quot;ResLogSpatialStretch&quot;</span>], vec,</div>
<div class="line">                  MBTET));</div>
<div class="line">        }</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">          <span class="keyword">new</span> OpSidePPMap(</div>
<div class="line"> </div>
<div class="line">              post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">              {},</div>
<div class="line"> </div>
<div class="line">              vec_fields,</div>
<div class="line"> </div>
<div class="line">              mat_fields,</div>
<div class="line"> </div>
<div class="line">              mat_fields_symm,</div>
<div class="line"> </div>
<div class="line">              sense</div>
<div class="line"> </div>
<div class="line">              )</div>
<div class="line"> </div>
<div class="line">      );</div>
<div class="line"> </div>
<div class="line">      fe.getOpPtrVector().push_back(<span class="keyword">new</span> <a id="_a328" name="_a328"></a><a class="code hl_struct" href="struct_op_post_proc_data_structure.html">OpPostProcDataStructure</a>(</div>
<div class="line">          post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, sense));</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>,</div>
<div class="line">                                            <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getContactL2AtPts()));</div>
<div class="line">    <span class="keyword">auto</span> X_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    <span class="comment">// H1 material positions</span></div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">                                            <a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>-&gt;getLargeXH1AtPts()));</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// domain</span></div>
<div class="line">    <span class="keyword">auto</span> op_loop_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;VolumeElementForcesAndSourcesCoreOnSide&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">    domain_ops(*(op_loop_side-&gt;getSideFEPtr()), sense);</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(op_loop_side);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> post_proc_ptr;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// contact</span></div>
<div class="line">  <span class="keyword">auto</span> calcs_side_traction_and_displacements = [&amp;](<span class="keyword">auto</span> &amp;post_proc_ptr,</div>
<div class="line">                                                   <span class="keyword">auto</span> &amp;pip) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> contact_common_data_ptr = boost::make_shared&lt;ContactOps::CommonData&gt;();</div>
<div class="line">    <span class="comment">// evaluate traction</span></div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a> =</div>
<div class="line">        <a class="code hl_struct" href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">PipelineManager::ElementsAndOpsByDim&lt;SPACE_DIM&gt;::FaceSideEle</a>;</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_class" href="class_side_ele_op.html">SideEleOp</a> = EleOnSide::UserDataOperator;</div>
<div class="line">    <span class="keyword">auto</span> op_loop_domain_side = <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_loop_side.html">OpLoopSide&lt;EleOnSide&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, Sev::noisy);</div>
<div class="line">    op_loop_domain_side-&gt;getSideFEPtr()-&gt;getUserPolynomialBase() =</div>
<div class="line">        boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line">    <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">        op_loop_domain_side-&gt;getOpPtrVector(), {HDIV, H1, L2},</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line">    op_loop_domain_side-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_trace.html">OpCalculateHVecTensorTrace&lt;SPACE_DIM, SideEleOp&gt;</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, contact_common_data_ptr-&gt;contactTractionPtr(),</div>
<div class="line">            boost::make_shared&lt;double&gt;(1.0)));</div>
<div class="line">    pip.push_back(op_loop_domain_side);</div>
<div class="line">    <span class="comment">// evaluate contact displacement and contact conditions</span></div>
<div class="line">    <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">contactDisp</a>, contact_common_data_ptr-&gt;contactDispPtr()));</div>
<div class="line">    pip.push_back(<span class="keyword">new</span> OpTreeSearch(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">contactTreeRhs</a>, contact_common_data_ptr, u_h1_ptr,</div>
<div class="line">        <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CONTACT&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1),</div>
<div class="line">        &amp;post_proc_ptr-&gt;getPostProcMesh(), &amp;post_proc_ptr-&gt;getMapGaussPts()));</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_mesh = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">  <span class="keyword">auto</span> post_proc_ptr = get_post_proc(post_proc_mesh, 1);</div>
<div class="line">  <span class="keyword">auto</span> post_proc_negative_sense_ptr = get_post_proc(post_proc_mesh, -1);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calcs_side_traction_and_displacements(post_proc_ptr,</div>
<div class="line">                                               post_proc_ptr-&gt;getOpPtrVector());</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> own_tets =</div>
<div class="line">      CommInterface::getPartEntities(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>())</div>
<div class="line">          .subset_by_dimension(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> own_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(own_tets, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                           own_faces, moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_post_negative = [&amp;](<span class="keyword">auto</span> &amp;&amp;ents) {</div>
<div class="line">    <span class="keyword">auto</span> crack_faces_pos = ents;</div>
<div class="line">    <span class="keyword">auto</span> crack_faces_neg = crack_faces_pos;</div>
<div class="line">    <span class="keyword">auto</span> skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, own_tets);</div>
<div class="line">    <span class="keyword">auto</span> crack_on_proc_skin = intersect(crack_faces_pos, skin);</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> : crack_on_proc_skin) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> tet;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">false</span>, tet);</div>
<div class="line">      tet = intersect(tet, own_tets);</div>
<div class="line">      <span class="keywordtype">int</span> side_number, sense, offset;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(tet[0], <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, side_number, sense,</div>
<div class="line">                                           offset);</div>
<div class="line">      <span class="keywordflow">if</span> (sense == 1) {</div>
<div class="line">        crack_faces_neg.erase(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        crack_faces_pos.erase(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(crack_faces_pos, crack_faces_neg);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> [crack_faces_pos, crack_faces_neg] =</div>
<div class="line">      get_post_negative(intersect(own_faces, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> only_crack_faces = [&amp;](<a id="_a329" name="_a329"></a><a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">    <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keywordflow">if</span> (crack_faces_pos.find(ent) == crack_faces_pos.end()) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> only_negative_crack_faces = [&amp;](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">    <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keywordflow">if</span> (crack_faces_neg.find(ent) == crack_faces_neg.end()) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> skeleton_faces = *<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> adj_front;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(*<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, 2, <span class="keyword">true</span>, adj_front,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">    adj_front = intersect(adj_front, skeleton_faces);</div>
<div class="line">    adj_front = subtract(adj_front, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    adj_front = intersect(own_faces, adj_front);</div>
<div class="line">    <span class="keywordflow">return</span> adj_front;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> [adj_front_pos, adj_front_neg] =</div>
<div class="line">      get_post_negative(<a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, get_adj_front()));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> only_front_faces_pos = [adj_front_pos](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">    <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keywordflow">if</span> (adj_front_pos.find(ent) == adj_front_pos.end()) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> only_front_faces_neg = [adj_front_neg](<a class="code hl_class" href="class_f_e_method.html">FEMethod</a> *fe_method_ptr) {</div>
<div class="line">    <span class="keyword">auto</span> ent = fe_method_ptr-&gt;getFEEntityHandle();</div>
<div class="line">    <span class="keywordflow">if</span> (adj_front_neg.find(ent) == adj_front_neg.end()) {</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  post_proc_ptr-&gt;setTagsToTransfer(tags_to_transfer);</div>
<div class="line">  post_proc_negative_sense_ptr-&gt;setTagsToTransfer(tags_to_transfer);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_begin =</div>
<div class="line">      <a id="_a330" name="_a330"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_begin_impl.html">PostProcBrokenMeshInMoabBaseBegin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, post_proc_begin.getFEMethod());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">skinElement</a>, post_proc_ptr);</div>
<div class="line">  post_proc_ptr-&gt;exeTestHook = only_crack_faces;</div>
<div class="line">  post_proc_negative_sense_ptr-&gt;exeTestHook = only_negative_crack_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, post_proc_ptr, 0, <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a331" name="a331"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>,</div>
<div class="line">                                              post_proc_negative_sense_ptr, 0,</div>
<div class="line">                                              <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line">  post_proc_ptr-&gt;exeTestHook = only_front_faces_pos;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>, post_proc_ptr, 0, <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line">  post_proc_negative_sense_ptr-&gt;exeTestHook = only_front_faces_neg;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">DMoFEMLoopFiniteElementsUpAndLowRank</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">skeletonElement</a>,</div>
<div class="line">                                              post_proc_negative_sense_ptr,</div>
<div class="line">                                              0, <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line">  <span class="keyword">auto</span> post_proc_end = <a id="_a332" name="_a332"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_end_impl.html">PostProcBrokenMeshInMoabBaseEnd</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, post_proc_end.getFEMethod());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_end.writeFile(file.c_str());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_eshelbian_core.html#a28419be22dbaad69b585370d6ae66215">EshelbianCore::postProcessSkeletonResults</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag,</div>
<div class="line">                                                         <span class="keyword">const</span> std::string file,</div>
<div class="line">                                                         Vec f_residual) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_struct" href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">FaceEle</a> = <a class="code hl_class" href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_mesh = boost::make_shared&lt;moab::Core&gt;();</div>
<div class="line">  <span class="keyword">auto</span> post_proc_ptr =</div>
<div class="line">      boost::make_shared&lt;PostProcBrokenMeshInMoabBaseCont&lt;FaceEle&gt;&gt;(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, post_proc_mesh);</div>
<div class="line">  <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM - 1, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      post_proc_ptr-&gt;getOpPtrVector(), {L2}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> hybrid_disp = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, hybrid_disp));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> hybrid_res = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, hybrid_disp));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line">  post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">new</span> <a id="a333" name="a333"></a><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">          post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {{<span class="stringliteral">&quot;hybrid_disp&quot;</span>, hybrid_disp}},</div>
<div class="line"> </div>
<div class="line">          {},</div>
<div class="line"> </div>
<div class="line">          {}</div>
<div class="line"> </div>
<div class="line">          )</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (f_residual) {</div>
<div class="line">    <span class="keyword">auto</span> hybrid_res = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;3&gt;</a>(</div>
<div class="line">            hybridSpatialDisp, hybrid_res,</div>
<div class="line">            <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;Vec&gt;</a>(f_residual, <span class="keyword">true</span>)));</div>
<div class="line">    <span class="keyword">using </span><a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a> = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">OpPostProcMapInMoab&lt;SPACE_DIM, SPACE_DIM&gt;</a>;</div>
<div class="line">    post_proc_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">new</span> <a class="code hl_typedef" href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a>(</div>
<div class="line"> </div>
<div class="line">            post_proc_ptr-&gt;getPostProcMesh(), post_proc_ptr-&gt;getMapGaussPts(),</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {{<span class="stringliteral">&quot;res_hybrid&quot;</span>, hybrid_res}},</div>
<div class="line"> </div>
<div class="line">            {},</div>
<div class="line"> </div>
<div class="line">            {}</div>
<div class="line"> </div>
<div class="line">            )</div>
<div class="line"> </div>
<div class="line">    );</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_begin =</div>
<div class="line">      <a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_begin_impl.html">PostProcBrokenMeshInMoabBaseBegin</a>(mField, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">DMoFEMPreProcessFiniteElements</a>(dM, post_proc_begin.getFEMethod());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(dM, skeletonElement, post_proc_ptr);</div>
<div class="line">  <span class="keyword">auto</span> post_proc_end = <a class="code hl_struct" href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_end_impl.html">PostProcBrokenMeshInMoabBaseEnd</a>(mField, post_proc_mesh);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">DMoFEMPostProcessFiniteElements</a>(dM, post_proc_end.getFEMethod());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> post_proc_end.writeFile(file.c_str());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a334" name="a334"></a><a class="code hl_function" href="struct_eshelbian_core.html#a6f708350b49c1ae611628563edecb532">EshelbianCore::calculateEnergyRelease</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag, TS ts) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tags_vec = [&amp;]() {</div>
<div class="line">    std::vector&lt;Tag&gt; tags(1);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_and_clean = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">      <span class="keyword">auto</span> rval = moab.tag_get_handle(<span class="stringliteral">&quot;ReleaseEnergy&quot;</span>, tags[0]);</div>
<div class="line">      <span class="keywordflow">if</span>(rval == MB_SUCCESS) {</div>
<div class="line">        moab.tag_delete(tags[0]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordtype">double</span> def_val[] = {0};</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(<span class="stringliteral">&quot;ReleaseEnergy&quot;</span>, 1, MB_TYPE_DOUBLE, tags[0],</div>
<div class="line">                                 MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(create_and_clean(), <span class="stringliteral">&quot;create_and_clean&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> tags;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> tags = get_tags_vec();</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front = [&amp;]() {</div>
<div class="line">    <span class="keyword">auto</span> skeleton_faces = *<a class="code hl_variable" href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">skeletonFaces</a>;</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> adj_front;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(*<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, 2, <span class="keyword">true</span>, adj_front,</div>
<div class="line">                                             moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">    adj_front = intersect(adj_front, skeleton_faces);</div>
<div class="line">    adj_front = subtract(adj_front, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    <span class="keywordflow">return</span> adj_front;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_nb_front_faces_on_proc = [&amp;](<span class="keyword">auto</span> &amp;&amp;adj_front) {</div>
<div class="line">    <span class="keywordtype">int</span> send_size = adj_front.size();</div>
<div class="line">    std::vector&lt;int&gt; recv_data(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>());</div>
<div class="line">    MPI_Allgather(&amp;send_size, 1, MPI_INT, recv_data.data(), 1, MPI_INT,</div>
<div class="line">                  <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">    recv_data[<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()] = send_size;</div>
<div class="line">    <span class="keywordflow">return</span> std::pair(recv_data, adj_front);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_snes = [&amp;](TS ts) {</div>
<div class="line">    SNES snes;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSNES(ts, &amp;snes);</div>
<div class="line">    <span class="keywordflow">return</span> snes;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_ksp = [&amp;](SNES snes) {</div>
<div class="line">    KSP ksp;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> SNESGetKSP(snes, &amp;ksp);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSetFromOptions(ksp);</div>
<div class="line">    <span class="keywordflow">return</span> ksp;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keywordtype">double</span> total_energy_sum = 0;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> integrate_energy = [&amp;](<span class="keyword">auto</span> x, <span class="keyword">auto</span> release_energy_ptr) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keyword">auto</span> set_volume = [&amp;]() {</div>
<div class="line">      <span class="keyword">auto</span> fe_ptr =</div>
<div class="line">          boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line">      fe_ptr-&gt;ts_ctx = TSMethod::CTX_TSSETIJACOBIAN;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a4530aa6762e72237e130380c7ce2ba86">setBaseVolumeElementOps</a>(tag, <span class="keyword">false</span>, <span class="keyword">false</span>, <span class="keyword">false</span>, x, fe_ptr);</div>
<div class="line">      fe_ptr-&gt;getOpPtrVector().push_back(</div>
<div class="line">          <span class="keyword">new</span> <a id="_a335" name="_a335"></a><a class="code hl_struct" href="struct_op_release_energy.html">OpReleaseEnergy</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">dataAtPts</a>, release_energy_ptr));</div>
<div class="line">      <span class="keywordflow">return</span> fe_ptr;</div>
<div class="line">    }; </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">DMoFEMLoopFiniteElements</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">dM</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>, set_volume());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> calc_release_energy = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, <span class="keyword">auto</span> x, <span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, <span class="keyword">auto</span> adj_front) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Calculate face release energy&quot;</span>;</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> ksp = get_ksp(get_snes(ts));</div>
<div class="line"> </div>
<div class="line">    std::vector&lt;boost::weak_ptr&lt;NumeredDofEntity&gt;&gt; piola_skelton_dofs_vec;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_problems_manager.html">ProblemsManager</a>&gt;()</div>
<div class="line">        -&gt;getSideDofsOnBrokenSpaceEntities(piola_skelton_dofs_vec,</div>
<div class="line">                                           <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                           adj_front, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> skeleton_piola_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()</div>
<div class="line">        -&gt;isCreateProblemBrokenFieldAndRankLocal(piola_skelton_dofs_vec,</div>
<div class="line">                                                 skeleton_piola_is);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> skeleton_hybrid_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">        skeleton_hybrid_is, &amp;adj_front);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> streach_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">stretchTensor</a>, 0, 6, streach_is);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> piola_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, piola_is);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> bubble_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">bubbleField</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, bubble_is);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> rot_axis_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">rotAxis</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, rot_axis_is);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> spatial_l2_disp_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">        spatial_l2_disp_is);</div>
<div class="line">    <a class="code hl_struct" href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">SmartPetscObj&lt;IS&gt;</a> hybrid_is;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_i_s_manager.html">ISManager</a>&gt;()-&gt;isCreateProblemFieldAndRankLocal(</div>
<div class="line">        <span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_enumvalue" href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">hybridSpatialDisp</a>, 0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">        hybrid_is);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> copy_is = [&amp;](<span class="keyword">auto</span> is, <span class="keyword">auto</span> <a id="a336" name="a336"></a><a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, <span class="keyword">auto</span> b) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">const</span> PetscInt *is_array;</div>
<div class="line">      PetscInt is_size;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISGetLocalSize(is, &amp;is_size);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISGetIndices(is, &amp;is_array);</div>
<div class="line">      <span class="keywordtype">double</span> *pa;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArray(<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, &amp;pa);</div>
<div class="line">      <span class="keyword">const</span> <span class="keywordtype">double</span> *pb;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(b, &amp;pb);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a id="a337" name="a337"></a><a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != is_size; ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">        pa[is_array[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]] = pb[is_array[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]];</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(b, &amp;pb);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArray(<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, &amp;pa);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISRestoreIndices(is, &amp;is_array);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> zero_is = [&amp;](<span class="keyword">auto</span> is, <span class="keyword">auto</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">const</span> PetscInt *is_array;</div>
<div class="line">      PetscInt is_size;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISGetLocalSize(is, &amp;is_size);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISGetIndices(is, &amp;is_array);</div>
<div class="line">      <span class="keywordtype">double</span> *pa;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArray(<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, &amp;pa);</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != is_size; ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">        pa[is_array[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]] = 0;</div>
<div class="line">      }</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArray(<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, &amp;pa);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> ISRestoreIndices(is, &amp;is_array);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> estimate_energy = [&amp;](<span class="keyword">auto</span> x) {</div>
<div class="line">      <span class="keyword">auto</span> release_energy_ptr = boost::make_shared&lt;double&gt;(0);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(integrate_energy(x, release_energy_ptr),</div>
<div class="line">                        <span class="stringliteral">&quot;integrate_energy&quot;</span>);</div>
<div class="line"> </div>
<div class="line">      <span class="keywordtype">double</span> area = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> : <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, adj_front)) {</div>
<div class="line">        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_normal;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a id="_a338" name="_a338"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_tools.html">Tools</a>&gt;()-&gt;getTriNormal(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, &amp;t_normal(0));</div>
<div class="line">        area += t_normal.<a class="code hl_function" href="class_f_tensor_1_1_tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>();</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      std::array&lt;double, 2&gt; send_data{area, *release_energy_ptr};</div>
<div class="line">      std::array&lt;double, 2&gt; recv_data{0, 0};</div>
<div class="line"> </div>
<div class="line">      MPI_Allreduce(send_data.data(), recv_data.data(), 2, MPI_DOUBLE, MPI_SUM,</div>
<div class="line">                    <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>());</div>
<div class="line">      total_energy_sum += recv_data[1];</div>
<div class="line">      <span class="keywordflow">return</span> recv_data[1];<span class="comment">// / recv_data[0];</span></div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">auto</span> &amp;&amp;release_energy, <span class="keyword">auto</span> adj_front) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> own = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, adj_front);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;Energy release &quot;</span> &lt;&lt; release_energy;</div>
<div class="line">      <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_clear_data(tags[0], own, &amp;release_energy);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> solve = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(x);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> copy_is(skeleton_piola_is, x, <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line"> </div>
<div class="line">      Mat mA;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPGetOperators(ksp, &amp;mA, PETSC_NULL);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> MatMult(mA, x, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> zero_is(hybrid_is, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> zero_is(streach_is, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> zero_is(piola_is, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> zero_is(bubble_is, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(x);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> KSPSolve(ksp, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, x);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecScale(x, -1);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> solve();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag(estimate_energy(x), adj_front);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> run_faces = [&amp;](<span class="keyword">auto</span> &amp;&amp;p) {</div>
<div class="line">    <span class="keyword">auto</span> [recv_data, adj_front] = p;</div>
<div class="line">    Vec <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> TSGetSolution(ts, &amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line">    <span class="keyword">auto</span> x = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line">    <span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line">    <span class="keyword">auto</span> face_x = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line">    <span class="keyword">auto</span> face_f = <a class="code hl_function" href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">vectorDuplicate</a>(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> solve_and_add = [&amp;](<span class="keyword">auto</span> &amp;&amp;face) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::noisy) &lt;&lt; face;</div>
<div class="line">      <a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), Sev::noisy);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(face);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calc_release_energy(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, face_x, face_f, face);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAXPY(x, 1, face_x);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAXPY(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, 1, face_f);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = 0; p &lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>(); ++p) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> = 0; <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> &lt; recv_data[p]; ++<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>) {</div>
<div class="line">        solve_and_add(<a class="code hl_class" href="class_range.html">Range</a>());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> = 0; <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> &lt; recv_data[<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()]; ++<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>) {</div>
<div class="line">      solve_and_add(<a class="code hl_class" href="class_range.html">Range</a>(adj_front[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>], adj_front[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>]));</div>
<div class="line">    }</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() + 1; p &lt; <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>(); ++p) {</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> = 0; <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> &lt; recv_data[p]; ++<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>) {</div>
<div class="line">        solve_and_add(<a class="code hl_class" href="class_range.html">Range</a>());</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> std::make_pair(x, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> [recv_data, adj_front] =</div>
<div class="line">      get_nb_front_faces_on_proc(<a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, get_adj_front()));</div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> p = 0; p != <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">get_comm_size</a>(); ++p) {</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SYNC&quot;</span>, Sev::warning) &lt;&lt; p &lt;&lt; <span class="stringliteral">&quot; number of faces &quot;</span> &lt;&lt; recv_data[p];</div>
<div class="line">  }</div>
<div class="line">  <a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), Sev::warning);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> [x, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>] = run_faces(</div>
<div class="line"> </div>
<div class="line">      get_nb_front_faces_on_proc(<a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, get_adj_front()))</div>
<div class="line"> </div>
<div class="line">  );</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                                                  <a id="a339" name="a339"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ad481b72d51e6377015a74f929bc6a672">volumeExchange</a>, tags[0]);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> CommInterface::updateEntitiesPetscVector(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">                                                  <a id="a340" name="a340"></a><a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a>, tags[0]);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(x, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line">    <span class="keyword">auto</span> release_energy_ptr = boost::make_shared&lt;double&gt;(0);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> integrate_energy(x, release_energy_ptr);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, body_ents);</div>
<div class="line">    <span class="keyword">auto</span> skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents));</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> : skin) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> tet;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <span class="keyword">false</span>, tet);</div>
<div class="line">      <span class="keywordflow">if</span> (tet.size() != 1) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::error) &lt;&lt; <span class="stringliteral">&quot;tet.size()!=1&quot;</span>;</div>
<div class="line">        <span class="keywordflow">continue</span>;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordtype">double</span> release_energy;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(tags[0], tet, &amp;release_energy);</div>
<div class="line">      release_energy /= total_energy_sum;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(tags[0], &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, 1, &amp;release_energy);</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#af6c7c52dde40c4a5f90afda29a7dad8f">postProcessResults</a>(1, <span class="stringliteral">&quot;test_perturbation.h5m&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, x, tags);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a28419be22dbaad69b585370d6ae66215">postProcessSkeletonResults</a>(1, <span class="stringliteral">&quot;test_skelton_perturbation.h5m&quot;</span>);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a341" name="a341"></a><a class="code hl_function" href="struct_eshelbian_core.html#a8acc61f8b8b3e19a7a32e16f7eb1fa5b">EshelbianCore::calculateOrientation</a>(<span class="keyword">const</span> <span class="keywordtype">int</span> tag,</div>
<div class="line">                                                   <span class="keywordtype">bool</span> set_orientation) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a> = <span class="keyword">true</span>;</div>
<div class="line">  <span class="keyword">constexpr</span> <span class="keyword">auto</span> sev = Sev::inform;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_tags_vec = [&amp;](<span class="keyword">auto</span> tag_name, <span class="keywordtype">int</span> dim) {</div>
<div class="line">    std::vector&lt;Tag&gt; tags(1);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (dim &gt; 3)</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a>, <span class="stringliteral">&quot;dim&gt;3&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> create_and_clean = [&amp;]() {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">      <span class="keyword">auto</span> &amp;moab = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>();</div>
<div class="line">      <span class="keyword">auto</span> rval = moab.tag_get_handle(tag_name, tags[0]);</div>
<div class="line">      <span class="keywordflow">if</span> (rval == MB_SUCCESS) {</div>
<div class="line">        moab.tag_delete(tags[0]);</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordtype">double</span> def_val[] = {0., 0., 0.};</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> moab.tag_get_handle(tag_name, dim, MB_TYPE_DOUBLE, tags[0],</div>
<div class="line">                                 MB_TAG_CREAT | MB_TAG_SPARSE, def_val);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(create_and_clean(), <span class="stringliteral">&quot;create_and_clean&quot;</span>);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> tags;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> get_adj_front = [&amp;](<span class="keywordtype">bool</span> subtract_crack) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> adj_front;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(*<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">true</span>,</div>
<div class="line">                                             adj_front, moab::Interface::UNION);</div>
<div class="line">    <span class="keywordflow">if</span> (subtract_crack)</div>
<div class="line">      adj_front = subtract(adj_front, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    <span class="keywordflow">return</span> adj_front;</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a id="a342" name="a342"></a><a class="code hl_define" href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a>(<span class="stringliteral">&quot;SELF&quot;</span>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> th_front_position = get_tags_vec(<span class="stringliteral">&quot;FrontPosition&quot;</span>, 3);</div>
<div class="line">  <span class="keyword">auto</span> th_max_face_energy = get_tags_vec(<span class="stringliteral">&quot;MaxFaceEnergy&quot;</span>, 1);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_crack_adj_tets = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> crack_faces_conn;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(r, crack_faces_conn);</div>
<div class="line">      <a class="code hl_class" href="class_range.html">Range</a> crack_faces_conn_tets;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(crack_faces_conn, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                               <span class="keyword">true</span>, crack_faces_conn_tets,</div>
<div class="line">                                               moab::Interface::UNION);</div>
<div class="line">      <span class="keywordflow">return</span> crack_faces_conn_tets;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_layers_for_sides = [&amp;](<span class="keyword">auto</span> &amp;side) {</div>
<div class="line">      std::vector&lt;Range&gt; layers;</div>
<div class="line">      <span class="keyword">auto</span> get = [&amp;]() {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_adj = [&amp;](<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>, <span class="keywordtype">int</span> dim) {</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> adj;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(r, dim, <span class="keyword">true</span>, adj,</div>
<div class="line">                                                   moab::Interface::UNION);</div>
<div class="line">          <span class="keywordflow">return</span> adj;</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_tets = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>) { <span class="keywordflow">return</span> get_adj(r, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>); };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> front_nodes;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, front_nodes,</div>
<div class="line">                                                  <span class="keyword">true</span>);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> front_faces = get_adj(front_nodes, 2);</div>
<div class="line">        front_faces = subtract(front_faces, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">        <span class="keyword">auto</span> front_tets = get_tets(front_nodes);</div>
<div class="line">        <span class="keyword">auto</span> front_side = intersect(side, front_tets);</div>
<div class="line">        layers.push_back(front_side);</div>
<div class="line">        <span class="keywordflow">for</span> (;;) {</div>
<div class="line">          <span class="keyword">auto</span> adj_faces = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, layers.back());</div>
<div class="line">          adj_faces = intersect(adj_faces, front_faces);</div>
<div class="line">          <span class="keyword">auto</span> adj_faces_tets = get_tets(adj_faces);</div>
<div class="line">          adj_faces_tets = intersect(adj_faces_tets, front_tets);</div>
<div class="line">          layers.push_back(unite(layers.back(), adj_faces_tets));</div>
<div class="line">          <span class="keywordflow">if</span> (layers.back().size() == layers[layers.size() - 2].size()) {</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(get(), <span class="stringliteral">&quot;get_layers_for_sides&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> layers;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> sides_pair = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a711a5a75b4797d9d4f46d1a45dccaf32">get_two_sides_of_crack_surface</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">    <span class="keyword">auto</span> layers_top = get_layers_for_sides(sides_pair.first);</div>
<div class="line">    <span class="keyword">auto</span> layers_bottom = get_layers_for_sides(sides_pair.second);</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">          <span class="stringliteral">&quot;crack_tets_&quot;</span> +</div>
<div class="line">              boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">          get_crack_adj_tets(*<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>));</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;sides_first.vtk&quot;</span>, sides_pair.first);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;sides_second.vtk&quot;</span>,</div>
<div class="line">                        sides_pair.second);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Nb. layers &quot;</span> &lt;&lt; layers_top.size();</div>
<div class="line">      <span class="keywordtype">int</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = 0;</div>
<div class="line">      <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;r : layers_top) {</div>
<div class="line">        <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Layer &quot;</span> &lt;&lt; <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> &lt;&lt; <span class="stringliteral">&quot; size &quot;</span> &lt;&lt; <a class="code hl_variable" href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">r</a>.size();</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">            <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">            <span class="stringliteral">&quot;layers_top_&quot;</span> + boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>) + <span class="stringliteral">&quot;.vtk&quot;</span>, r);</div>
<div class="line">        ++<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_cross = [&amp;](<span class="keyword">auto</span> t_dir, <span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>) {</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_normal;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_tools.html">Tools</a>&gt;()-&gt;getTriNormal(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, &amp;t_normal(0));</div>
<div class="line">      t_normal.<a id="a343" name="a343"></a><a class="code hl_function" href="class_f_tensor_1_1_tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">normalize</a>();</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_cross;</div>
<div class="line">      <a id="a344" name="a344"></a><a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a345" name="a345"></a><a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">      <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a id="a346" name="a346"></a><a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line">      t_cross(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = <a id="a347" name="a347"></a><a class="code hl_function" href="namespace_f_tensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a>(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>) * t_normal(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_dir(<a class="code hl_variable" href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a>);</div>
<div class="line">      <span class="keywordflow">return</span> t_cross;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> get_sense = [&amp;](<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, <span class="keyword">auto</span> e) {</div>
<div class="line">      <span class="keywordtype">int</span> side, sense, offset;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().side_number(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, e, side, sense, offset),</div>
<div class="line">                     <span class="stringliteral">&quot;get sense&quot;</span>);</div>
<div class="line">      <span class="keywordflow">return</span> std::make_tuple(side, sense, offset);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> calculate_edge_direction = [&amp;](<span class="keyword">auto</span> e) {</div>
<div class="line">      <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">      <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(e, conn, num_nodes, <span class="keyword">true</span>);</div>
<div class="line">      std::array&lt;double, 6&gt; coords;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(conn, num_nodes, coords.data());</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; t_p0{</div>
<div class="line">          &amp;coords[0], &amp;coords[1], &amp;coords[2]};</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;FTensor::PackPtr&lt;double *, 0&gt;</a>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>&gt; t_p1{</div>
<div class="line">          &amp;coords[3], &amp;coords[4], &amp;coords[5]};</div>
<div class="line">      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_dir;</div>
<div class="line">      <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      t_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_p1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_p0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">      <span class="keyword">auto</span> <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> = t_dir.<a class="code hl_function" href="class_f_tensor_1_1_tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">l2</a>();</div>
<div class="line">      t_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) /= <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>;</div>
<div class="line">      <span class="keywordflow">return</span> t_dir;</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <span class="keyword">auto</span> evaluate_face_energy_and_set_orientation = [&amp;](<span class="keyword">auto</span> front_edges,</div>
<div class="line">                                                        <span class="keyword">auto</span> front_faces,</div>
<div class="line">                                                        <span class="keyword">auto</span> &amp;sides_pair,</div>
<div class="line">                                                        <span class="keyword">auto</span> th_position) {</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_class" href="class_tag.html">Tag</a> th_face_energy;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;ReleaseEnergy&quot;</span>, th_face_energy);</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      /**</span></div>
<div class="line"><span class="comment">       * Iterate over front edges, get adjacent faces, find maximal face energy.</span></div>
<div class="line"><span class="comment">       * Maximal face energy is stored in the edge. The is then maximises across</span></div>
<div class="line"><span class="comment">       * all processors.</span></div>
<div class="line"><span class="comment">       *</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keyword">auto</span> find_maximal_face_energy = [&amp;](<span class="keyword">auto</span> front_edges, <span class="keyword">auto</span> front_faces,</div>
<div class="line">                                          <span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : front_edges) {</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;e, 1, 2, <span class="keyword">false</span>, faces);</div>
<div class="line">          faces = intersect(faces, front_faces);</div>
<div class="line"> </div>
<div class="line">          std::vector&lt;double&gt; face_energy(faces.size());</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_face_energy, faces,</div>
<div class="line">                                                face_energy.data());</div>
<div class="line">          <span class="keyword">auto</span> max_energy_it =</div>
<div class="line">              std::max_element(face_energy.begin(), face_energy.end());</div>
<div class="line">          <span class="keywordtype">double</span> max_energy =</div>
<div class="line">              max_energy_it != face_energy.end() ? *max_energy_it : 0;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_face_energy, &amp;e, 1,</div>
<div class="line">                                                &amp;max_energy);</div>
<div class="line">          edge_face_max_energy_map[e] =</div>
<div class="line">              std::make_tuple(faces[max_energy_it - face_energy.begin()],</div>
<div class="line">                              max_energy, <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(0));</div>
<div class="line">          <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">              &lt;&lt; <span class="stringliteral">&quot;Edge &quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; max energy &quot;</span> &lt;&lt; max_energy;</div>
<div class="line">        };</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">      /**</span></div>
<div class="line"><span class="comment">       * For each front edge, find maximal face energy and orientation. This is</span></div>
<div class="line"><span class="comment">       * done by solving quadratic equation.</span></div>
<div class="line"><span class="comment">       *</span></div>
<div class="line"><span class="comment">       */</span></div>
<div class="line">      <span class="keyword">auto</span> calculate_face_orientation = [&amp;](<span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> up_down_face = [&amp;](</div>
<div class="line"> </div>
<div class="line">                                <span class="keyword">auto</span> &amp;face_angle_map_up,</div>
<div class="line">                                <span class="keyword">auto</span> &amp;face_angle_map_down</div>
<div class="line"> </div>
<div class="line">                            ) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">            <span class="keyword">auto</span> e = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">            <span class="keyword">auto</span> [max_face, energy, opt_angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> faces;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;e, 1, 2, <span class="keyword">false</span>, faces);</div>
<div class="line">            faces = intersect(faces, front_faces);</div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> adj_tets; <span class="comment">// tetrahedrons adjacent to the face</span></div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;max_face, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                     <span class="keyword">false</span>, adj_tets,</div>
<div class="line">                                                     moab::Interface::UNION);</div>
<div class="line">            <span class="keywordflow">if</span> (adj_tets.size()) {</div>
<div class="line"> </div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> adj_tets; <span class="comment">// tetrahedrons adjacent to the face</span></div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;max_face, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>,</div>
<div class="line">                                                       <span class="keyword">false</span>, adj_tets,</div>
<div class="line">                                                       moab::Interface::UNION);</div>
<div class="line">              <span class="keywordflow">if</span> (adj_tets.size()) {</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_class" href="class_range.html">Range</a> adj_tets_faces;</div>
<div class="line">                <span class="comment">// get faces</span></div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                    adj_tets, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">false</span>, adj_tets_faces,</div>
<div class="line">                    moab::Interface::UNION);</div>
<div class="line">                adj_tets_faces = intersect(adj_tets_faces, faces);</div>
<div class="line">                <span class="keywordflow">if</span> (adj_tets_faces.size() != 3 &amp;&amp; adj_tets_faces.size() != 2) {</div>
<div class="line">                  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, Sev::error)</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot;Wrong number of crack faces &quot;</span> &lt;&lt; adj_tets_faces.size()</div>
<div class="line">                      &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; adj_tets.size();</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                    <span class="stringliteral">&quot;Wrong number of crack faces&quot;</span>);</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// cross product of face normal and edge direction</span></div>
<div class="line">                <span class="keyword">auto</span> t_cross_max =</div>
<div class="line">                    get_cross(calculate_edge_direction(e), max_face);</div>
<div class="line">                <span class="keyword">auto</span> [side_max, sense_max, offset_max] = get_sense(max_face, e);</div>
<div class="line">                t_cross_max(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= sense_max;</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : adj_tets) {</div>
<div class="line">                  <a class="code hl_class" href="class_range.html">Range</a> adj_tets_faces;</div>
<div class="line">                  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                      &amp;<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, 1, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1, <span class="keyword">false</span>, adj_tets_faces);</div>
<div class="line">                  adj_tets_faces = intersect(adj_tets_faces, faces);</div>
<div class="line">                  adj_tets_faces =</div>
<div class="line">                      subtract(adj_tets_faces, <a class="code hl_class" href="class_range.html">Range</a>(max_face, max_face));</div>
<div class="line"> </div>
<div class="line">                  <span class="keywordflow">if</span> (adj_tets_faces.size() == 1) {</div>
<div class="line"> </div>
<div class="line">                    <span class="comment">// cross product of adjacent face normal and edge</span></div>
<div class="line">                    <span class="comment">// direction</span></div>
<div class="line">                    <span class="keyword">auto</span> t_cross = get_cross(calculate_edge_direction(e),</div>
<div class="line">                                             adj_tets_faces[0]);</div>
<div class="line">                    <span class="keyword">auto</span> [side, sense, offset] =</div>
<div class="line">                        get_sense(adj_tets_faces[0], e);</div>
<div class="line">                    t_cross(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= sense;</div>
<div class="line">                    <span class="keywordtype">double</span> dot = t_cross(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) * t_cross_max(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">                    <span class="keyword">auto</span> angle = std::acos(dot);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordtype">double</span> energy;</div>
<div class="line">                    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(</div>
<div class="line">                        th_face_energy, adj_tets_faces, &amp;energy);</div>
<div class="line"> </div>
<div class="line">                    <span class="keyword">auto</span> [side_face, sense_face, offset_face] =</div>
<div class="line">                        get_sense(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, max_face);</div>
<div class="line"> </div>
<div class="line">                    <span class="keywordflow">if</span> (sense_face &gt; 0) {</div>
<div class="line">                      face_angle_map_up[e] =</div>
<div class="line">                          std::make_tuple(energy, angle, adj_tets_faces[0]);</div>
<div class="line"> </div>
<div class="line">                    } <span class="keywordflow">else</span> {</div>
<div class="line">                      face_angle_map_down[e] =</div>
<div class="line">                          std::make_tuple(energy, -angle, adj_tets_faces[0]);</div>
<div class="line">                    }</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        MatrixDouble <a id="a348" name="a348"></a><a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(3, 3);</div>
<div class="line">        VectorDouble b(3);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> calc_optimal_angle_impl = [&amp;](<span class="keywordtype">double</span> <a id="a349" name="a349"></a><a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a>, <span class="keywordtype">double</span> e0, <span class="keywordtype">double</span> <a id="a350" name="a350"></a><a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a>,</div>
<div class="line">                                           <span class="keywordtype">double</span> e1, <span class="keywordtype">double</span> <a id="a351" name="a351"></a><a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a>, <span class="keywordtype">double</span> e2) {</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(0, 0) = <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a> * <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a>;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(1, 0) = <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a>;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(2, 0) = 1;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(0, 1) = <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a> * <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a>;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(1, 1) = <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a>;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(2, 1) = 1;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(0, 2) = <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> * <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a>;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(1, 2) = <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a>;</div>
<div class="line">          <a class="code hl_variable" href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a>(2, 2) = 1;</div>
<div class="line"> </div>
<div class="line">          b[0] = e1;</div>
<div class="line">          b[1] = e2;</div>
<div class="line">          b[2] = e0;</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="namespace_mo_f_e_m.html#a5ad6537f1d6adcc338597770747bc19a">solveLinearSystem</a>(A, b);</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (b[0] &gt; -std::numeric_limits&lt;float&gt;::epsilon()) {</div>
<div class="line">            <span class="keywordflow">return</span> std::make_pair(e0, 0.);</div>
<div class="line"> </div>
<div class="line">          } <span class="keywordflow">else</span> {</div>
<div class="line"> </div>
<div class="line">            <span class="keyword">auto</span> optimal_angle = -b[1] / (2 * b[0]);</div>
<div class="line">            <span class="keyword">auto</span> optimal_energy = b[0] * optimal_angle * optimal_angle +</div>
<div class="line">                                  b[1] * optimal_angle + b[2];</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Optimal_energy &quot;</span> &lt;&lt; optimal_energy &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; e0 &lt;&lt; <span class="stringliteral">&quot; &quot;</span></div>
<div class="line">                &lt;&lt; (optimal_energy - e0) / e0 &lt;&lt; <span class="stringliteral">&quot;% ) &quot;</span> &lt;&lt; optimal_angle</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; e1 : a1 &quot;</span> &lt;&lt; e1 &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a> &lt;&lt; <span class="stringliteral">&quot; e2 : a2 &quot;</span> &lt;&lt; e2</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; : &quot;</span> &lt;&lt; <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a>;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordtype">double</span> angle = -M_PI;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keywordtype">double</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = -M_PI; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> &lt; M_PI; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> += M_PI / 20.) {</div>
<div class="line">              <span class="keywordtype">double</span> energy = b[0] * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> + b[1] * <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> + b[2];</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;PlotAngles &quot;</span> &lt;&lt; <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; energy;</div>
<div class="line">            }</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;PlotAngles &quot;</span> &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;AnglePts &quot;</span> &lt;&lt; <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; e1;</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;AnglePts &quot;</span> &lt;&lt; <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; e0;</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;AnglePts &quot;</span> &lt;&lt; <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; e2;</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;AnglePts &quot;</span> &lt;&lt; endl;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">return</span> std::make_pair(optimal_energy, optimal_angle);</div>
<div class="line">          }</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">          <span class="keyword">auto</span> [opt_e0, opt_a0] = calc_optimal_angle_impl(1, 1, 0, 0, 3, -3);</div>
<div class="line">          <span class="keywordflow">if</span> (std::abs(opt_e0 - 1) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Wrong optimal energy&quot;</span>);</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (std::abs(opt_a0 - 1) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>, <span class="stringliteral">&quot;Wrong optimal angle&quot;</span>);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> calc_optimal_angle = [&amp;](</div>
<div class="line"> </div>
<div class="line">                                      <span class="keyword">auto</span> &amp;face_angle_map_up,</div>
<div class="line">                                      <span class="keyword">auto</span> &amp;face_angle_map_down</div>
<div class="line"> </div>
<div class="line">                                  ) {</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">            <span class="keyword">auto</span> e = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">            <span class="keyword">auto</span> &amp;[max_face, e0, <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a>] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line"> </div>
<div class="line">            <span class="keywordflow">if</span> (std::abs(e0) &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line"> </div>
<div class="line">              <span class="keywordflow">if</span> (face_angle_map_up.find(e) == face_angle_map_up.end() ||</div>
<div class="line">                  face_angle_map_down.find(e) == face_angle_map_down.end()) {</div>
<div class="line"> </div>
<div class="line">              } <span class="keywordflow">else</span> {</div>
<div class="line">                <span class="keyword">auto</span> [e1, <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a>, face_up] = face_angle_map_up.at(e);</div>
<div class="line">                <span class="keyword">auto</span> [e2, <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a>, face_down] = face_angle_map_down.at(e);</div>
<div class="line"> </div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Edge &quot;</span> &lt;&lt; e;</div>
<div class="line">                <span class="keyword">auto</span> [optimal_energy, optimal_angle] =</div>
<div class="line">                    calc_optimal_angle_impl(<a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a>, e0, <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a>, e1, <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a>, e2);</div>
<div class="line"> </div>
<div class="line">                e0 = optimal_energy;</div>
<div class="line">                <a class="code hl_variable" href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a> = optimal_angle;</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        std::map&lt;EntityHandle, std::tuple&lt;double, double, EntityHandle&gt;&gt;</div>
<div class="line">            face_angle_map_up;</div>
<div class="line">        std::map&lt;EntityHandle, std::tuple&lt;double, double, EntityHandle&gt;&gt;</div>
<div class="line">            face_angle_map_down;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> up_down_face(face_angle_map_up, face_angle_map_down);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calc_optimal_angle(face_angle_map_up, face_angle_map_down);</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">          <span class="keyword">auto</span> th_angle = get_tags_vec(<span class="stringliteral">&quot;Angle&quot;</span>, 1);</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> up;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : face_angle_map_up) {</div>
<div class="line">            <span class="keyword">auto</span> [e, <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, face] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            up.insert(face);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_angle[0], &amp;face, 1, &amp;<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>);</div>
<div class="line">          }</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> down;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : face_angle_map_down) {</div>
<div class="line">            <span class="keyword">auto</span> [e, <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>, face] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            down.insert(face);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_angle[0], &amp;face, 1, &amp;<a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a>);</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> max_energy_faces;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">            <span class="keyword">auto</span> [face, e, angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">            max_energy_faces.insert(face);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_angle[0], &amp;face, 1,</div>
<div class="line">                                                  &amp;angle);</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>() == 0) {</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;up_faces.vtk&quot;</span>, up);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;down_faces.vtk&quot;</span>, down);</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;max_energy_faces.vtk&quot;</span>,</div>
<div class="line">                              max_energy_faces);</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> sort_by_energy = [&amp;](<span class="keyword">auto</span> &amp;edge_face_max_energy_map) {</div>
<div class="line">        std::map&lt;double, std::tuple&lt;EntityHandle, EntityHandle, double&gt;&gt;</div>
<div class="line">            sort_by_energy;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : edge_face_max_energy_map) {</div>
<div class="line">          <span class="keyword">auto</span> e = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">          <span class="keyword">auto</span> [max_face, energy, opt_angle] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">          sort_by_energy[energy] = std::make_tuple(e, max_face, opt_angle);</div>
<div class="line">        }</div>
<div class="line">        <span class="keywordflow">return</span> sort_by_energy;</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_face_orientation = [&amp;](<span class="keyword">auto</span> &amp;sort_by_energy, <span class="keyword">auto</span> &amp;layers,</div>
<div class="line">                                      <span class="keyword">auto</span> &amp;set_vertices, <span class="keywordtype">double</span> &amp;all_quality) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> body_ents;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, 3, body_ents);</div>
<div class="line">        <span class="keyword">auto</span> body_skin = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, body_ents);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> body_skin_edges;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">            body_skin, 1, <span class="keyword">false</span>, body_skin_edges, moab::Interface::UNION);</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> boundary_skin_verts;</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(body_skin_edges,</div>
<div class="line">                                                  boundary_skin_verts, <span class="keyword">true</span>);</div>
<div class="line"> </div>
<div class="line">        <span class="keyword">auto</span> get_rotated_normal = [&amp;](<span class="keyword">auto</span> e, <span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, <span class="keyword">auto</span> angle) {</div>
<div class="line">          <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">          <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">          <span class="keyword">auto</span> t_edge_dir = calculate_edge_direction(e);</div>
<div class="line">          <span class="keyword">auto</span> [side, sense, offset] = get_sense(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, e);</div>
<div class="line">          t_edge_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= sense;</div>
<div class="line">          t_edge_dir.normalize();</div>
<div class="line">          t_edge_dir(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) *= angle;</div>
<div class="line">          <span class="keyword">auto</span> t_R = <a id="a352" name="a352"></a><a class="code hl_function" href="struct_lie_groups_1_1_s_o3.html#af80491b46de29b3959da57bb3bfce5b9">LieGroups::SO3::exp</a>(t_edge_dir, angle);</div>
<div class="line">          <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_normal;</div>
<div class="line">          <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_tools.html">Tools</a>&gt;()-&gt;getTriNormal(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, &amp;t_normal(0));</div>
<div class="line">          <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a> t_rotated_normal;</div>
<div class="line">          t_rotated_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = t_R(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>, <a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>) * t_normal(<a class="code hl_variable" href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a>);</div>
<div class="line">          <span class="keywordflow">return</span> std::make_tuple(t_normal, t_rotated_normal);</div>
<div class="line">        };</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> rotated_normals;</div>
<div class="line"> </div>
<div class="line">        <span class="comment">// iterate over energies</span></div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = sort_by_energy.rbegin(); it != sort_by_energy.rend();</div>
<div class="line">             ++it) {</div>
<div class="line">          <span class="keyword">auto</span> energy = it-&gt;first;</div>
<div class="line">          <span class="keyword">auto</span> [e, max_face, opt_angle] = it-&gt;second;</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// calculate rotation of max energy face</span></div>
<div class="line">          <span class="keyword">auto</span> [t_normal, t_rotated_normal] =</div>
<div class="line">              get_rotated_normal(e, max_face, opt_angle);</div>
<div class="line">          rotated_normals.insert(max_face);</div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> front_vertex; <span class="comment">// vertices at crack front</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(&amp;e, 1, front_vertex, <span class="keyword">true</span>);</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> adj_tets; <span class="comment">// adjacent tets to max face</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;max_face, 1, 3, <span class="keyword">false</span>,</div>
<div class="line">                                                   adj_tets);</div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">          <span class="keywordflow">if</span> (adj_tets.size() != 2) {</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Wrong number of tets adjacent to max face &quot;</span></div>
<div class="line">                &lt;&lt; adj_tets.size();</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;Wrong number of crack faces&quot;</span>);</div>
<div class="line">          }</div>
<div class="line"><span class="preprocessor">#endif                           </span><span class="comment">// NDEBUG</span></div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> adj_front_faces; <span class="comment">// adjacent faces to front edge</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(&amp;e, 1, 2, <span class="keyword">false</span>,</div>
<div class="line">                                                   adj_front_faces);</div>
<div class="line">          adj_front_faces = subtract(adj_front_faces, *<a class="code hl_variable" href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">crackFaces</a>);</div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> adj_tet_faces; <span class="comment">// adjacent faces to adjacent tets</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">              adj_tets, 2, <span class="keyword">false</span>, adj_tet_faces, moab::Interface::UNION);</div>
<div class="line">          adj_tet_faces =</div>
<div class="line">              intersect(adj_tet_faces, adj_front_faces); <span class="comment">// only three faces</span></div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">          <span class="keywordflow">if</span> (adj_tet_faces.size() != 3) {</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Wrong number of faces adj. to test &quot;</span></div>
<div class="line">                                   &lt;&lt; adj_tet_faces.size();</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                              <span class="stringliteral">&quot;Wrong number of crack faces&quot;</span>);</div>
<div class="line">          }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line"> </div>
<div class="line">          <a class="code hl_class" href="class_range.html">Range</a> adj_front_faces_edges; <span class="comment">// edges adjacent to front faces</span></div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(adj_front_faces, 1, <span class="keyword">false</span>,</div>
<div class="line">                                                   adj_front_faces_edges,</div>
<div class="line">                                                   moab::Interface::UNION);</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// only process to faces</span></div>
<div class="line">          std::array&lt;EntityHandle, 2&gt; processed_faces{0, max_face};</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;<a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a> : layers) {</div>
<div class="line">            <span class="keyword">auto</span> adj_tets_layer = intersect(adj_tets, <a class="code hl_variable" href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a>);</div>
<div class="line">            <span class="keywordflow">if</span> (adj_tets_layer.empty()) {</div>
<div class="line">              <span class="keywordflow">continue</span>;</div>
<div class="line">            }</div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> faces_layer; <span class="comment">// adjacent faces to adjacent tets</span></div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(</div>
<div class="line">                adj_tets_layer, 2, <span class="keyword">false</span>, faces_layer, moab::Interface::UNION);</div>
<div class="line">            faces_layer = intersect(faces_layer, adj_front_faces);</div>
<div class="line">            faces_layer = subtract(faces_layer, <a class="code hl_class" href="class_range.html">Range</a>(max_face, max_face));</div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">            <span class="keywordflow">if</span> (faces_layer.size() != 1) {</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;Wrong number of faces to move &quot;</span> &lt;&lt; faces_layer.size();</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a>(<a class="code hl_enumvalue" href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a>,</div>
<div class="line">                                <span class="stringliteral">&quot;Wrong number of crack faces&quot;</span>);</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line">            processed_faces[0] = faces_layer[0];</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="comment">// [quality] -&gt; [vertex, face, position]</span></div>
<div class="line">          std::map&lt;<a class="code hl_class" href="classdouble.html">double</a>, std::tuple&lt;<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>, <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>,</div>
<div class="line">                                      <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a>&gt;&gt;</div>
<div class="line">              sort_by_quality;</div>
<div class="line"> </div>
<div class="line">          <span class="keywordtype">int</span> face_idx = 0;</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a> : processed_faces) {</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> vertex; <span class="comment">// vertex to move</span></div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(&amp;<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, 1, vertex, <span class="keyword">true</span>);</div>
<div class="line">            vertex = subtract(vertex, front_vertex);</div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">            <span class="keywordflow">if</span> (vertex.size() != 1) {</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;Wrong number of vertex to move &quot;</span> &lt;&lt; vertex.size();</div>
<div class="line">            }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line">            <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a></div>
<div class="line">                t_vertex_coords; <span class="comment">// coords of vertex to move</span></div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(vertex, &amp;t_vertex_coords(0));</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> vertex_edges; <span class="comment">// edges adjacent to vertex</span></div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(vertex, 1, <span class="keyword">false</span>,</div>
<div class="line">                                                     vertex_edges);</div>
<div class="line">            vertex_edges = subtract(vertex_edges, adj_front_faces_edges);</div>
<div class="line">            <span class="keywordflow">if</span> (boundary_skin_verts.find(vertex[0]) !=</div>
<div class="line">                boundary_skin_verts.end()) {</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Boundary vertex&quot;</span>;</div>
<div class="line">              vertex_edges = intersect(vertex_edges, body_skin_edges);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> f0 = front_vertex[0];</div>
<div class="line">            <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> f1 = front_vertex[1];</div>
<div class="line">            <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_v_e0, t_v_e1;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;f0, 1, &amp;t_v_e0(0));</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(&amp;f1, 1, &amp;t_v_e1(0));</div>
<div class="line"> </div>
<div class="line">            std::map&lt;EntityHandle, FTensor::Tensor1&lt;double, SPACE_DIM&gt;&gt;</div>
<div class="line">                node_positions_map;</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> e : vertex_edges) {</div>
<div class="line">              <a class="code hl_class" href="class_range.html">Range</a> edge_conn;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(&amp;e, 1, edge_conn, <span class="keyword">true</span>);</div>
<div class="line">              edge_conn = subtract(edge_conn, vertex);</div>
<div class="line"><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line">              <span class="keywordflow">if</span> (edge_conn.size() != 1) {</div>
<div class="line">                <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                    &lt;&lt; <span class="stringliteral">&quot;Wrong number of edge conn &quot;</span> &lt;&lt; edge_conn.size();</div>
<div class="line">              }</div>
<div class="line"><span class="preprocessor">#endif </span><span class="comment">// NDEBUG</span></div>
<div class="line">              <a class="code hl_define" href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a>(<a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a>, <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">              <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_v0;</div>
<div class="line">              t_v0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) = (t_v_e0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) + t_v_e1(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) / 2;</div>
<div class="line">              <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, 3&gt;</a> t_v3;</div>
<div class="line">              <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(edge_conn, &amp;t_v3(0));</div>
<div class="line">              <span class="keyword">auto</span> <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> = (t_v0(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_rotated_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">              <span class="keyword">auto</span> b = (t_v3(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>)) * t_rotated_normal(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>);</div>
<div class="line">              <span class="keyword">auto</span> gamma = <a class="code hl_variable" href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a> / b;</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                  &lt;&lt; face_idx &lt;&lt; <span class="stringliteral">&quot; edge: &quot;</span> &lt;&lt; e &lt;&lt; <span class="stringliteral">&quot; gamma: &quot;</span> &lt;&lt; gamma;</div>
<div class="line">              <span class="keywordflow">if</span> (std::isnormal(gamma) &amp;&amp;</div>
<div class="line">                  gamma &gt; -std::numeric_limits&lt;double&gt;::epsilon() &amp;&amp;</div>
<div class="line">                  gamma &lt; 1 - std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> : {0, 1, 2}) {</div>
<div class="line">                  node_positions_map[e](<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) =</div>
<div class="line">                      gamma * (t_v3(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) - t_vertex_coords(<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>));</div>
<div class="line">                }</div>
<div class="line">              }</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <a class="code hl_class" href="class_range.html">Range</a> adj_vertex_tets;</div>
<div class="line">            <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(vertex, 3, <span class="keyword">false</span>,</div>
<div class="line">                                                     adj_vertex_tets);</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> &amp;p : node_positions_map) {</div>
<div class="line">              <span class="keywordtype">double</span> min_quality = 1;</div>
<div class="line">              <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a> : adj_vertex_tets) {</div>
<div class="line">                <span class="keyword">const</span> <a class="code hl_class" href="class_entity_handle.html">EntityHandle</a> *conn;</div>
<div class="line">                <span class="keywordtype">int</span> num_nodes;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(<a class="code hl_variable" href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a>, conn, num_nodes,</div>
<div class="line">                                                          <span class="keyword">true</span>);</div>
<div class="line">                std::array&lt;double, 12&gt; coords;</div>
<div class="line">                <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(conn, num_nodes,</div>
<div class="line">                                                    coords.data());</div>
<div class="line">                <span class="keywordtype">int</span> idx = 0;</div>
<div class="line">                <span class="keywordflow">for</span> (; idx &lt; num_nodes; ++idx) {</div>
<div class="line">                  <span class="keywordflow">if</span> (conn[idx] == vertex[0]) {</div>
<div class="line">                    <span class="keywordflow">break</span>;</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordflow">if</span> (set_vertices.find(vertex[0]) == set_vertices.end()) {</div>
<div class="line">                  <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {0, 1, 2}) {</div>
<div class="line">                    coords[3 * idx + ii] += p.second(ii);</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line">                <span class="keywordflow">for</span> (<span class="keyword">auto</span> vv : {0, 1, 2, 3}) {</div>
<div class="line">                  <span class="keyword">auto</span> it = set_vertices.find(conn[vv]);</div>
<div class="line">                  <span class="keywordflow">if</span> (it != set_vertices.end()) {</div>
<div class="line">                    <span class="keyword">auto</span> &amp;[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, energy, t_position] = it-&gt;second;</div>
<div class="line">                    <span class="keywordflow">for</span> (<span class="keyword">auto</span> ii : {0, 1, 2})</div>
<div class="line">                      coords[3 * vv + ii] += t_position(ii);</div>
<div class="line">                  }</div>
<div class="line">                }</div>
<div class="line"> </div>
<div class="line">                <span class="keywordtype">double</span> q = Tools::volumeLengthQuality(coords.data());</div>
<div class="line">                <span class="keywordflow">if</span> (!std::isnormal(q))</div>
<div class="line">                  q = -2;</div>
<div class="line">                min_quality = std::min(min_quality, q);</div>
<div class="line">              }</div>
<div class="line">              sort_by_quality[min_quality] =</div>
<div class="line">                  std::make_tuple(vertex[0], <a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>,</div>
<div class="line">                                  <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a>{</div>
<div class="line">                                      p.second(0), p.second(1), p.second(2)});</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            ++face_idx;</div>
<div class="line">          }</div>
<div class="line"> </div>
<div class="line">          <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">            <span class="keywordflow">for</span> (<span class="keyword">auto</span> s : sort_by_quality) {</div>
<div class="line">              <span class="keyword">auto</span> &amp;[vertex, face, t_position] = s.second;</div>
<div class="line">              <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                  &lt;&lt; <span class="stringliteral">&quot;Quality: &quot;</span> &lt;&lt; s.first &lt;&lt; <span class="stringliteral">&quot; vertex &quot;</span> &lt;&lt; vertex &lt;&lt; <span class="stringliteral">&quot; face &quot;</span></div>
<div class="line">                  &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot; point: &quot;</span> &lt;&lt; t_position;</div>
<div class="line">            }</div>
<div class="line">          }</div>
<div class="line">          <span class="keywordflow">for</span> (<span class="keyword">auto</span> it = sort_by_quality.rbegin(); it != sort_by_quality.rend();</div>
<div class="line">               ++it) {</div>
<div class="line">            <span class="keyword">auto</span> &amp;[vertex, face, t_position] = it-&gt;second;</div>
<div class="line">            all_quality = std::min(all_quality, it-&gt;first);</div>
<div class="line">            <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev)</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot;Set quality: &quot;</span> &lt;&lt; it-&gt;first &lt;&lt; <span class="stringliteral">&quot; vertex &quot;</span> &lt;&lt; vertex</div>
<div class="line">                &lt;&lt; <span class="stringliteral">&quot; face &quot;</span> &lt;&lt; face &lt;&lt; <span class="stringliteral">&quot; point: &quot;</span> &lt;&lt; t_position;</div>
<div class="line">            set_vertices[vertex] = std::make_tuple(face, energy, t_position);</div>
<div class="line">            <span class="keywordflow">break</span>;</div>
<div class="line">          }</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="comment">// map: {edge, {face, energy, optimal_angle}}</span></div>
<div class="line">      std::map&lt;EntityHandle, std::tuple&lt;EntityHandle, double, double&gt;&gt;</div>
<div class="line">          edge_face_max_energy_map;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> find_maximal_face_energy(front_edges, front_faces,</div>
<div class="line">                                      edge_face_max_energy_map);</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> calculate_face_orientation(edge_face_max_energy_map);</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> edge_map_sort_by_energy = sort_by_energy(edge_face_max_energy_map);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Top&quot;</span>;</div>
<div class="line">      <span class="keywordtype">double</span> top_quality = 1;</div>
<div class="line">      std::map&lt;<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>, std::tuple&lt;<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>, <a class="code hl_class" href="classdouble.html">double</a>,</div>
<div class="line">                                        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a>&gt;&gt;</div>
<div class="line">          set_vertices_top;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_face_orientation(edge_map_sort_by_energy, layers_top,</div>
<div class="line">                                  set_vertices_top, top_quality);</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Bottom&quot;</span>;</div>
<div class="line">      <span class="keywordtype">double</span> bottom_quality = 1;</div>
<div class="line">      std::map&lt;<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>, std::tuple&lt;<a class="code hl_class" href="class_entity_handle.html">EntityHandle</a>, <a class="code hl_class" href="classdouble.html">double</a>,</div>
<div class="line">                                        <a class="code hl_class" href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1&lt;double, SPACE_DIM&gt;</a>&gt;&gt;</div>
<div class="line">          set_vertices_bottom;</div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_face_orientation(edge_map_sort_by_energy, layers_bottom,</div>
<div class="line">                                  set_vertices_bottom, bottom_quality);</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Top quality &quot;</span> &lt;&lt; top_quality;</div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Bottom quality &quot;</span> &lt;&lt; bottom_quality;</div>
<div class="line"> </div>
<div class="line">      <span class="keyword">auto</span> set_tag = [&amp;](<span class="keyword">auto</span> &amp;set_vertices, <span class="keyword">auto</span> th_position) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : set_vertices) {</div>
<div class="line">          <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">          <span class="keyword">auto</span> &amp;[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, energy, t_p] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_position[0], &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1, &amp;t_p(0));</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_max_face_energy[0], &amp;<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, 1,</div>
<div class="line">                                                &amp;energy);</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">      };</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (top_quality &gt; bottom_quality) {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag(set_vertices_top, th_position);</div>
<div class="line">      } <span class="keywordflow">else</span> {</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> set_tag(set_vertices_bottom, th_position);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">        <span class="keyword">auto</span> th_front_top = get_tags_vec(<span class="stringliteral">&quot;FrontPositionTop&quot;</span>, 3);</div>
<div class="line">        <span class="keyword">auto</span> th_front_bottom = get_tags_vec(<span class="stringliteral">&quot;FrontPositionBottom&quot;</span>, 3);</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> top_moved_faces;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : set_vertices_top) {</div>
<div class="line">          <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">          <span class="keyword">auto</span> &amp;[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, energy, t_p] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">          top_moved_faces.insert(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_front_top[0], &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1,</div>
<div class="line">                                                &amp;t_p(0));</div>
<div class="line">        }</div>
<div class="line">        <a class="code hl_class" href="class_range.html">Range</a> bottom_moved_faces;</div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : set_vertices_bottom) {</div>
<div class="line">          <span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a> = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.first;</div>
<div class="line">          <span class="keyword">auto</span> &amp;[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, energy, t_p] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">          bottom_moved_faces.insert(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">          <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_front_bottom[0], &amp;<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, 1,</div>
<div class="line">                                                &amp;t_p(0));</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <span class="keywordflow">for</span> (<span class="keyword">auto</span> <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a> : set_vertices_bottom) {</div>
<div class="line">          <span class="keyword">auto</span> &amp;[<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>, energy, t_p] = <a class="code hl_variable" href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a>.second;</div>
<div class="line">          bottom_moved_faces.insert(<a class="code hl_variable" href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">f</a>);</div>
<div class="line">        }</div>
<div class="line"> </div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;top_moved_faces.vtk&quot;</span>,</div>
<div class="line">                          top_moved_faces);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;bottom_moved_faces.vtk&quot;</span>,</div>
<div class="line">                          bottom_moved_faces);</div>
<div class="line">        <span class="keyword">auto</span> front_faces = get_adj_front(<span class="keyword">false</span>);</div>
<div class="line">        <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <span class="stringliteral">&quot;front_move.vtk&quot;</span>, front_faces);</div>
<div class="line">      }</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">    };</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;SELF&quot;</span>, sev) &lt;&lt; <span class="stringliteral">&quot;Front edges &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>-&gt;size();</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> evaluate_face_energy_and_set_orientation(</div>
<div class="line">        *<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, get_adj_front(<span class="keyword">false</span>), sides_pair, th_front_position);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a id="a353" name="a353"></a><a class="code hl_variable" href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>.second);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                             SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                           SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;updateEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>, th_front_position[0]);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(<a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a>.second);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateBegin(<a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                             SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGhostUpdateEnd(<a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a>.second, INSERT_VALUES,</div>
<div class="line">                            SCATTER_FORWARD);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;updateEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a>, th_max_face_energy[0]);</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">if</span> (<a class="code hl_variable" href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a>) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> tets;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_dimension(0, 3, tets);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">        <span class="stringliteral">&quot;projected_tets_&quot;</span> +</div>
<div class="line">            boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">        tets);</div>
<div class="line"> </div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> max_moved_faces;</div>
<div class="line">    <span class="keyword">auto</span> adj_front = get_adj_front(<span class="keyword">false</span>);</div>
<div class="line">    std::vector&lt;double&gt; face_energy(adj_front.size());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_max_face_energy[0], adj_front,</div>
<div class="line">                                          face_energy.data());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != adj_front.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">      <span class="keywordflow">if</span> (face_energy[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] &gt; std::numeric_limits&lt;double&gt;::epsilon()) {</div>
<div class="line">        max_moved_faces.insert(adj_front[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>]);</div>
<div class="line">      }</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a>(</div>
<div class="line">        <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(),</div>
<div class="line">        <span class="stringliteral">&quot;max_moved_faces_&quot;</span> +</div>
<div class="line">            boost::lexical_cast&lt;std::string&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">get_comm_rank</a>()) + <span class="stringliteral">&quot;.vtk&quot;</span>,</div>
<div class="line">        max_moved_faces);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a354" name="a354"></a><a class="code hl_function" href="struct_eshelbian_core.html#a90305e24905e60449369cef8928bda5e">EshelbianCore::setNewFrontCoordinates</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <a class="code hl_class" href="class_tag.html">Tag</a> th_front_position;</div>
<div class="line">  <span class="keyword">auto</span> rval =</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(<span class="stringliteral">&quot;FrontPosition&quot;</span>, th_front_position);</div>
<div class="line">  <span class="keywordflow">if</span> (rval == MB_SUCCESS) {</div>
<div class="line">    <a class="code hl_class" href="class_range.html">Range</a> verts;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(0, MBVERTEX, verts);</div>
<div class="line">    std::vector&lt;double&gt; coords(3 * verts.size());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(verts, coords.data());</div>
<div class="line">    std::vector&lt;double&gt; pos(3 * verts.size());</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_data(th_front_position, verts, pos.data());</div>
<div class="line">    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> = 0; <a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a> != 3 * verts.size(); ++<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>) {</div>
<div class="line">      coords[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>] += pos[<a class="code hl_variable" href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a>];</div>
<div class="line">    }</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().set_coords(verts, coords.data());</div>
<div class="line">    <span class="keywordtype">double</span> zero[] = {0., 0., 0.};</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_clear_data(th_front_position, verts, zero);</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a355" name="a355"></a><a class="code hl_function" href="struct_eshelbian_core.html#add1f886aa91291dceb3477c20f8b9f47">EshelbianCore::addCrackSurfaces</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> add_ents = <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;POTENTIAL&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> crack_front_verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(*<a class="code hl_variable" href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">frontEdges</a>, crack_front_verts,</div>
<div class="line">                                            <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">      crack_front_verts);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> crack_front_faces;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_adjacencies(crack_front_verts, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1,</div>
<div class="line">                                           <span class="keyword">true</span>, crack_front_faces,</div>
<div class="line">                                           moab::Interface::UNION);</div>
<div class="line">  crack_front_faces = intersect(crack_front_faces, add_ents);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_comm_interface.html">CommInterface</a>&gt;()-&gt;synchroniseEntities(</div>
<div class="line">      crack_front_faces);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;()-&gt;addEntitiesToMeshset(</div>
<div class="line">      <a id="a356" name="a356"></a><a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a id="a357" name="a357"></a><a class="code hl_variable" href="struct_eshelbian_core.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>, crack_front_faces);</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// auto get_front_max_energy_faces = [&amp;]() {</span></div>
<div class="line">  <span class="comment">//   Range faces;</span></div>
<div class="line">  <span class="comment">//   for (auto &amp;m : frontMaxEnergyFaces) {</span></div>
<div class="line">  <span class="comment">//     faces.merge(m.second);</span></div>
<div class="line">  <span class="comment">//   }</span></div>
<div class="line">  <span class="comment">//   return faces;</span></div>
<div class="line">  <span class="comment">// };</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// auto get_connected_faces = [&amp;](auto &amp;&amp;faces, Range crack_faces) {</span></div>
<div class="line">  <span class="comment">//   auto get_front_vertices_edges = [&amp;](auto &amp;front_edges) {</span></div>
<div class="line">  <span class="comment">//     Range front_vertices;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_connectivity(front_edges, front_vertices,</span></div>
<div class="line">  <span class="comment">//                                               true);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         front_vertices);</span></div>
<div class="line">  <span class="comment">//     Range front_vertices_edges;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_adjacencies(front_vertices, 1, true,</span></div>
<div class="line">  <span class="comment">//                                              front_vertices_edges,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         front_vertices_edges);</span></div>
<div class="line">  <span class="comment">//     return front_vertices_edges;</span></div>
<div class="line">  <span class="comment">//   };</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   auto get_faces_edges = [&amp;](auto &amp;front_vertices_edges, auto &amp;front_edges)</span></div>
<div class="line">  <span class="comment">//   {</span></div>
<div class="line">  <span class="comment">//     Range faces_edges;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_adjacencies(faces, 1, true, faces_edges,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         faces_edges);</span></div>
<div class="line">  <span class="comment">//     faces_edges = subtract(faces_edges, *frontEdges);</span></div>
<div class="line">  <span class="comment">//     faces_edges = intersect(faces_edges, front_vertices_edges);</span></div>
<div class="line">  <span class="comment">//     return faces_edges;</span></div>
<div class="line">  <span class="comment">//   };</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   auto get_faces = [&amp;](auto &amp;front_vertices_edges, auto &amp;faces_edges) {</span></div>
<div class="line">  <span class="comment">//     Range front_edges_faces; // get faces adjacent to front edges, no need</span></div>
<div class="line">  <span class="comment">//     to</span></div>
<div class="line">  <span class="comment">//                              // synchronise</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_adjacencies(</span></div>
<div class="line">  <span class="comment">//         faces_edges, 2, true, front_edges_faces, moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         front_edges_faces);</span></div>
<div class="line">  <span class="comment">//     Range front_edges_faces_edges;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_adjacencies(front_edges_faces, 1, true,</span></div>
<div class="line">  <span class="comment">//                                              front_edges_faces_edges,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         front_edges_faces_edges);</span></div>
<div class="line">  <span class="comment">//     front_edges_faces_edges =</span></div>
<div class="line">  <span class="comment">//         intersect(front_edges_faces_edges, front_vertices_edges);</span></div>
<div class="line">  <span class="comment">//     front_edges_faces_edges = subtract(front_edges_faces_edges,</span></div>
<div class="line">  <span class="comment">//     *frontEdges); front_edges_faces_edges =</span></div>
<div class="line">  <span class="comment">//     subtract(front_edges_faces_edges, faces_edges); Range</span></div>
<div class="line">  <span class="comment">//     front_edges_faces_edges_faces; CHKERR</span></div>
<div class="line">  <span class="comment">//     mField.get_moab().get_adjacencies(front_edges_faces_edges, 2, true,</span></div>
<div class="line">  <span class="comment">//                                              front_edges_faces_edges_faces,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         front_edges_faces_edges_faces);</span></div>
<div class="line">  <span class="comment">//     front_edges_faces =</span></div>
<div class="line">  <span class="comment">//         subtract(front_edges_faces, front_edges_faces_edges_faces);</span></div>
<div class="line">  <span class="comment">//     return front_edges_faces;</span></div>
<div class="line">  <span class="comment">//   };</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   auto get_faces_of_crack_front_verts = [&amp;](auto &amp;front_edges_faces) {</span></div>
<div class="line">  <span class="comment">//     Range verts;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_connectivity(front_edges_faces, verts,</span></div>
<div class="line">  <span class="comment">//     true); CHKERR</span></div>
<div class="line">  <span class="comment">//     mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(verts); Range</span></div>
<div class="line">  <span class="comment">//     crack_faces; CHKERR mField.get_moab().get_adjacencies(verts, 2, true,</span></div>
<div class="line">  <span class="comment">//     crack_faces,</span></div>
<div class="line">  <span class="comment">//                                              moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.getInterface&lt;CommInterface&gt;()-&gt;synchroniseEntities(</span></div>
<div class="line">  <span class="comment">//         crack_faces);</span></div>
<div class="line">  <span class="comment">//     Range faces_verts;</span></div>
<div class="line">  <span class="comment">//     CHKERR mField.get_moab().get_connectivity(crack_faces, faces_verts,</span></div>
<div class="line">  <span class="comment">//     true); faces_verts = subtract(faces_verts, verts); Range</span></div>
<div class="line">  <span class="comment">//     faces_verts_faces; CHKERR mField.get_moab().get_adjacencies(</span></div>
<div class="line">  <span class="comment">//         faces_verts, 2, true, faces_verts_faces, moab::Interface::UNION);</span></div>
<div class="line">  <span class="comment">//     crack_faces = subtract(crack_faces, faces_verts_faces);</span></div>
<div class="line">  <span class="comment">//     return crack_faces;</span></div>
<div class="line">  <span class="comment">//   };</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   auto front_edges =</span></div>
<div class="line">  <span class="comment">//       get_crack_front_edges(mField, filter_owners(mField, crack_faces));</span></div>
<div class="line">  <span class="comment">//   auto front_vertices_edges = get_front_vertices_edges(front_edges);</span></div>
<div class="line">  <span class="comment">//   auto faces_edges = get_faces_edges(front_vertices_edges, front_edges);</span></div>
<div class="line">  <span class="comment">//   auto front_edges_faces = get_faces(front_vertices_edges, faces_edges);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   auto new_front_edges = get_crack_front_edges(</span></div>
<div class="line">  <span class="comment">//       mField, filter_owners(mField, unite(crack_faces,</span></div>
<div class="line">  <span class="comment">//       front_edges_faces)));</span></div>
<div class="line">  <span class="comment">//   front_edges_faces.merge(get_faces_of_crack_front_verts(new_front_edges));</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">//   return front_edges_faces;</span></div>
<div class="line">  <span class="comment">// };</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// auto new_crack_faces =</span></div>
<div class="line">  <span class="comment">//     get_connected_faces(get_front_max_energy_faces(), *crackFaces);</span></div>
<div class="line">  <span class="comment">// MOFEM_LOG(&quot;EP&quot;, Sev::inform)</span></div>
<div class="line">  <span class="comment">//     &lt;&lt; &quot;Add new crack faces &quot; &lt;&lt; new_crack_faces.size();</span></div>
<div class="line">  <span class="comment">// auto new_crack_faces_meshset =</span></div>
<div class="line">  <span class="comment">//     get_block_meshset(mField, addCrackMeshsetId, BLOCKSET);</span></div>
<div class="line">  <span class="comment">// Range existing_crack_faces;</span></div>
<div class="line">  <span class="comment">// CHKERR mField.get_moab().get_entities_by_handle(new_crack_faces_meshset,</span></div>
<div class="line">  <span class="comment">//                                                 existing_crack_faces,</span></div>
<div class="line">  <span class="comment">//                                                 true);</span></div>
<div class="line">  <span class="comment">// existing_crack_faces.merge(new_crack_faces);</span></div>
<div class="line">  <span class="comment">// CHKERR mField.get_moab().remove_entities(new_crack_faces_meshset,</span></div>
<div class="line">  <span class="comment">//                                          existing_crack_faces);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// // CHKERR mField.getInterface&lt;MeshsetsManager&gt;()-&gt;addEntitiesToMeshset(</span></div>
<div class="line">  <span class="comment">// //     BLOCKSET, 1000, new_crack_faces);</span></div>
<div class="line"> </div>
<div class="line">  <span class="comment">// if (mField.get_comm_size() == 1) {</span></div>
<div class="line">  <span class="comment">//   CHKERR save_range(mField.get_moab(), &quot;new_crack_faces.vtk&quot;,</span></div>
<div class="line">  <span class="comment">//                     new_crack_faces);</span></div>
<div class="line">  <span class="comment">// }</span></div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a358" name="a358"></a><a class="code hl_function" href="struct_eshelbian_core.html#ad4d96dc6ab5dd848b7d8eebf1a08030b">EshelbianCore::saveOrgCoords</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> crack_faces =</div>
<div class="line">      <a class="code hl_function" href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>, <span class="stringliteral">&quot;CRACK_COMPUTED&quot;</span>, <a class="code hl_variable" href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a> - 1);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> conn;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_connectivity(crack_faces, conn, <span class="keyword">true</span>);</div>
<div class="line">  <a class="code hl_class" href="class_range.html">Range</a> verts;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_entities_by_type(0, MBVERTEX, verts);</div>
<div class="line">  verts = subtract(verts, conn);</div>
<div class="line">  std::vector&lt;double&gt; coords(3 * verts.size());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().get_coords(verts, coords.data());</div>
<div class="line">  <span class="keywordtype">double</span> def_coords[] = {0., 0., 0.};</div>
<div class="line">  <a class="code hl_class" href="class_tag.html">Tag</a> th_org_coords;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_get_handle(</div>
<div class="line">      <span class="stringliteral">&quot;ORG_COORDS&quot;</span>, 3, MB_TYPE_DOUBLE, th_org_coords,</div>
<div class="line">      MB_TAG_CREAT | MB_TAG_DENSE, def_coords);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>().tag_set_data(th_org_coords, verts, coords.data());</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a359" name="a359"></a><a class="code hl_function" href="struct_eshelbian_core.html#a113994efe4dd1803d84aeab5c6230096">EshelbianCore::createCrackSurfaceMeshset</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">  <span class="keyword">auto</span> meshset_mng = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_meshsets_manager.html">MeshsetsManager</a>&gt;();</div>
<div class="line">  <span class="keywordflow">while</span> (meshset_mng-&gt;checkMeshset(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>))</div>
<div class="line">    ++<a class="code hl_variable" href="struct_eshelbian_core.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>;</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;Crack added surface meshset &quot;</span> &lt;&lt; <a class="code hl_variable" href="struct_eshelbian_core.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> meshset_mng-&gt;addMeshset(<a class="code hl_enumvalue" href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a>, <a class="code hl_variable" href="struct_eshelbian_core.html#adf7e1000f83af8932625eacd97fcf29b">addCrackMeshsetId</a>, <span class="stringliteral">&quot;CRACK_COMPUTED&quot;</span>);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">};</div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a class="code hl_function" href="struct_eshelbian_core.html#a7980928dbcfa5bf174ac19e22784fe95">EshelbianCore::gettingNorms</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_fe =</div>
<div class="line">      boost::make_shared&lt;VolumeElementForcesAndSourcesCore&gt;(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> post_proc_norm_rule_hook = [](int, int, <span class="keywordtype">int</span> p) -&gt; <span class="keywordtype">int</span> {</div>
<div class="line">    <span class="keywordflow">return</span> 2 * (p);</div>
<div class="line">  };</div>
<div class="line">  post_proc_norm_fe-&gt;getRuleHook = post_proc_norm_rule_hook;</div>
<div class="line"> </div>
<div class="line">  post_proc_norm_fe-&gt;getUserPolynomialBase() =</div>
<div class="line">      boost::shared_ptr&lt;BaseFunction&gt;(<span class="keyword">new</span> CGGUserPolynomialBase());</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_struct" href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps&lt;SPACE_DIM, SPACE_DIM, SPACE_DIM&gt;::add</a>(</div>
<div class="line">      post_proc_norm_fe-&gt;getOpPtrVector(), {L2, H1, HDIV}, <a class="code hl_variable" href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">materialH1Positions</a>,</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">frontAdjEdges</a>);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">enum</span> NORMS { U_NORM_L2 = 0, U_NORM_H1, PIOLA_NORM, U_ERROR_L2, LAST_NORM };</div>
<div class="line">  <span class="keyword">auto</span> norms_vec =</div>
<div class="line">      <a class="code hl_function" href="namespace_mo_f_e_m.html#a77d94d2111c0c988bc3100b3910cc25c">createVectorMPI</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), LAST_NORM, PETSC_DETERMINE);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecZeroEntries(norms_vec);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> u_l2_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  <span class="keyword">auto</span> u_h1_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">spatialL2Disp</a>, u_l2_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">OpCalculateVectorFieldValues&lt;SPACE_DIM&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">spatialH1Disp</a>, u_h1_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a id="_a360" name="_a360"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calc_norm_l2_tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_l2_ptr, norms_vec, U_NORM_L2));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calc_norm_l2_tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_h1_ptr, norms_vec, U_NORM_H1));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calc_norm_l2_tensor1.html">OpCalcNormL2Tensor1&lt;SPACE_DIM&gt;</a>(u_l2_ptr, norms_vec, U_ERROR_L2,</div>
<div class="line">                                         u_h1_ptr));</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> piola_ptr = boost::make_shared&lt;MatrixDouble&gt;();</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">OpCalculateHVecTensorField&lt;3, 3&gt;</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, piola_ptr));</div>
<div class="line">  post_proc_norm_fe-&gt;getOpPtrVector().push_back(</div>
<div class="line">      <span class="keyword">new</span> <a id="_a361" name="_a361"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_op_calc_norm_l2_tensor2.html">OpCalcNormL2Tensor2&lt;3, 3&gt;</a>(piola_ptr, norms_vec, PIOLA_NORM));</div>
<div class="line"> </div>
<div class="line">  TetPolynomialBase::switchCacheBaseOn&lt;HDIV&gt;({post_proc_norm_fe.get()});</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a id="a362" name="a362"></a><a class="code hl_function" href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">loop_finite_elements</a>(<span class="stringliteral">&quot;ELASTIC_PROBLEM&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">elementVolumeName</a>,</div>
<div class="line">                                     *post_proc_norm_fe);</div>
<div class="line">  TetPolynomialBase::switchCacheBaseOff&lt;HDIV&gt;({post_proc_norm_fe.get()});</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyBegin(norms_vec);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecAssemblyEnd(norms_vec);</div>
<div class="line">  <span class="keyword">const</span> <span class="keywordtype">double</span> *norms;</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetArrayRead(norms_vec, &amp;norms);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;norm_u: &quot;</span> &lt;&lt; std::sqrt(norms[U_NORM_L2]);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform) &lt;&lt; <span class="stringliteral">&quot;norm_u_h1: &quot;</span> &lt;&lt; std::sqrt(norms[U_NORM_H1]);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;norm_error_u_l2: &quot;</span> &lt;&lt; std::sqrt(norms[U_ERROR_L2]);</div>
<div class="line">  <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::inform)</div>
<div class="line">      &lt;&lt; <span class="stringliteral">&quot;norm_piola: &quot;</span> &lt;&lt; std::sqrt(norms[PIOLA_NORM]);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecRestoreArrayRead(norms_vec, &amp;norms);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}<span class="comment"></span></div>
<div class="line"><span class="comment">//! [Getting norms]</span></div>
<div class="line"><span class="comment"></span> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a363" name="a363"></a><a class="code hl_function" href="struct_eshelbian_core.html#acd3d79e5922a80cab13f88ff96518c2a">EshelbianCore::getSpatialDispBc</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;<a id="a364" name="a364"></a><a class="code hl_function" href="struct_mo_f_e_m_1_1_bc_manager.html#ad0bbc182baa1622340dbf96ce6da5ef2">pushMarkDOFsOnEntities</a>&lt;<a id="_a365" name="_a365"></a><a class="code hl_struct" href="struct_mo_f_e_m_1_1_displacement_cubit_bc_data.html">DisplacementCubitBcData</a>&gt;(</div>
<div class="line">      <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>, <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a> = boost::make_shared&lt;BcDispVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> disp_bc = bc.second-&gt;dispBcPtr) {</div>
<div class="line"> </div>
<div class="line">      <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EP&quot;</span>, Sev::noisy) &lt;&lt; *disp_bc;</div>
<div class="line"> </div>
<div class="line">      std::vector&lt;double&gt; block_attributes(6, 0.);</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag1 == 1) {</div>
<div class="line">        block_attributes[0] = disp_bc-&gt;data.value1;</div>
<div class="line">        block_attributes[3] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag2 == 1) {</div>
<div class="line">        block_attributes[1] = disp_bc-&gt;data.value2;</div>
<div class="line">        block_attributes[4] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keywordflow">if</span> (disp_bc-&gt;data.flag3 == 1) {</div>
<div class="line">        block_attributes[2] = disp_bc-&gt;data.value3;</div>
<div class="line">        block_attributes[5] = 1;</div>
<div class="line">      }</div>
<div class="line">      <span class="keyword">auto</span> faces = bc.second-&gt;bcEnts.subset_by_dimension(2);</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>-&gt;emplace_back(bc.first, block_attributes, faces);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// old way of naming blocksets for displacement BCs</span></div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a id="a366" name="a366"></a><a class="code hl_function" href="struct_eshelbian_core.html#a56636af14eb66349e0d1fce731e9206e">getBc</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">bcSpatialDispVecPtr</a>, <span class="stringliteral">&quot;SPATIAL_DISP_BC&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a367" name="a367"></a><a class="code hl_function" href="struct_eshelbian_core.html#abe81e33c3abf7e604dfafb99cac6eca4">EshelbianCore::getSpatialTractionBc</a>() {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> bc_mng = <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">getInterface</a>&lt;<a class="code hl_struct" href="struct_mo_f_e_m_1_1_bc_manager.html">BcManager</a>&gt;();</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> bc_mng-&gt;<a class="code hl_function" href="struct_mo_f_e_m_1_1_bc_manager.html#ad0bbc182baa1622340dbf96ce6da5ef2">pushMarkDOFsOnEntities</a>&lt;ForceCubitBcData&gt;(<span class="stringliteral">&quot;&quot;</span>, <a class="code hl_variable" href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">piolaStress</a>,</div>
<div class="line">                                                          <span class="keyword">false</span>, <span class="keyword">false</span>);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a> = boost::make_shared&lt;TractionBcVec&gt;();</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">for</span> (<span class="keyword">auto</span> bc : bc_mng-&gt;getBcMapByBlockName()) {</div>
<div class="line">    <span class="keywordflow">if</span> (<span class="keyword">auto</span> force_bc = bc.second-&gt;forceBcPtr) {</div>
<div class="line">      std::vector&lt;double&gt; block_attributes(6, 0.);</div>
<div class="line">      block_attributes[0] = -force_bc-&gt;data.value3 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[3] = 1;</div>
<div class="line">      block_attributes[1] = -force_bc-&gt;data.value4 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[4] = 1;</div>
<div class="line">      block_attributes[2] = -force_bc-&gt;data.value5 * force_bc-&gt;data.value1;</div>
<div class="line">      block_attributes[5] = 1;</div>
<div class="line">      <span class="keyword">auto</span> faces = bc.second-&gt;bcEnts.subset_by_dimension(2);</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>-&gt;emplace_back(bc.first, block_attributes, faces);</div>
<div class="line">    }</div>
<div class="line">  }</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> <a class="code hl_function" href="struct_eshelbian_core.html#a56636af14eb66349e0d1fce731e9206e">getBc</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">bcSpatialTraction</a>, <span class="stringliteral">&quot;SPATIAL_TRACTION_BC&quot;</span>, 6);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><a class="code hl_typedef" href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEMErrorCode</a> <a id="a368" name="a368"></a><a class="code hl_function" href="struct_eshelbian_core.html#ae1b21da25a876c11c40d9878f299c8a3">EshelbianCore::createExchangeVectors</a>(<a class="code hl_enumeration" href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">Sev</a> sev) {</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#ad481b72d51e6377015a74f929bc6a672">volumeExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 3, 1, sev);</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 2, 1, Sev::inform);</div>
<div class="line">  <a id="a369" name="a369"></a><a class="code hl_variable" href="struct_eshelbian_core.html#ab1bb40274b0b343f49fc45bc2d3de293">edgeExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 1, 1, Sev::inform);</div>
<div class="line">  <a class="code hl_variable" href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a> = CommInterface::createEntitiesPetscVector(</div>
<div class="line">      <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), <a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">get_moab</a>(), 0, 3, Sev::inform);</div>
<div class="line"> </div>
<div class="line">  <span class="keyword">auto</span> print_loc_size = [<span class="keyword">this</span>](<span class="keyword">auto</span> <a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>, <span class="keyword">auto</span> str, <span class="keyword">auto</span> sev) {</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a>;</div>
<div class="line">    <span class="keywordtype">int</span> size;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetLocalSize(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second, &amp;size);</div>
<div class="line">    <span class="keywordtype">int</span> low, high;</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> VecGetOwnershipRange(<a class="code hl_variable" href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a>.second, &amp;low, &amp;high);</div>
<div class="line">    <a class="code hl_define" href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a>(<span class="stringliteral">&quot;EPSYNC&quot;</span>, sev) &lt;&lt; str &lt;&lt; <span class="stringliteral">&quot; local size &quot;</span> &lt;&lt; size &lt;&lt; <span class="stringliteral">&quot; ( &quot;</span> &lt;&lt; low</div>
<div class="line">                             &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; high &lt;&lt; <span class="stringliteral">&quot; ) &quot;</span>;</div>
<div class="line">    <a class="code hl_define" href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a>(<a class="code hl_variable" href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">mField</a>.<a class="code hl_function" href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">get_comm</a>(), sev);</div>
<div class="line">    <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">  };</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="struct_eshelbian_core.html#ad481b72d51e6377015a74f929bc6a672">volumeExchange</a>, <span class="stringliteral">&quot;volumeExchange&quot;</span>, sev);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">faceExchange</a>, <span class="stringliteral">&quot;faceExchange&quot;</span>, sev);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="struct_eshelbian_core.html#ab1bb40274b0b343f49fc45bc2d3de293">edgeExchange</a>, <span class="stringliteral">&quot;edgeExchange&quot;</span>, sev);</div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a> print_loc_size(<a class="code hl_variable" href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">vertexExchange</a>, <span class="stringliteral">&quot;vertexExchange&quot;</span>, sev);</div>
<div class="line"> </div>
<div class="line">  <a class="code hl_define" href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a>(0);</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line">} <span class="comment">// namespace EshelbianPlasticity</span></div>
<div class="line"> </div>
<div class="line"><span class="preprocessor">#include &lt;<a class="code" href="_eshelbian_contact_8cpp.html">impl/EshelbianContact.cpp</a>&gt;</span></div>
<div class="ttc" id="a_c_g_g_tonsorial_bubble_base_8hpp_html"><div class="ttname"><a href="_c_g_g_tonsorial_bubble_base_8hpp.html">CGGTonsorialBubbleBase.hpp</a></div><div class="ttdoc">Implementation of tonsorial bubble base div(v) = 0.</div></div>
<div class="ttc" id="a_c_g_g_tonsorial_bubble_base_8hpp_html_af88c539f45e4ad3e7407169d8539d25e"><div class="ttname"><a href="_c_g_g_tonsorial_bubble_base_8hpp.html#af88c539f45e4ad3e7407169d8539d25e">NBVOLUMETET_CCG_BUBBLE</a></div><div class="ttdeci">#define NBVOLUMETET_CCG_BUBBLE(P)</div><div class="ttdoc">Bubble function for CGG H div space.</div><div class="ttdef"><b>Definition</b> <a href="_c_g_g_tonsorial_bubble_base_8hpp_source.html#l00019">CGGTonsorialBubbleBase.hpp:19</a></div></div>
<div class="ttc" id="a_eshelbian_aux_8hpp_html"><div class="ttname"><a href="_eshelbian_aux_8hpp.html">EshelbianAux.hpp</a></div><div class="ttdoc">Auxilary functions for Eshelbian plasticity.</div></div>
<div class="ttc" id="a_eshelbian_contact_8cpp_html"><div class="ttname"><a href="_eshelbian_contact_8cpp.html">EshelbianContact.cpp</a></div></div>
<div class="ttc" id="a_eshelbian_contact_8hpp_html"><div class="ttname"><a href="_eshelbian_contact_8hpp.html">EshelbianContact.hpp</a></div></div>
<div class="ttc" id="a_eshelbian_monitor_8cpp_html"><div class="ttname"><a href="_eshelbian_monitor_8cpp.html">EshelbianMonitor.cpp</a></div><div class="ttdoc">Contains definition of EshelbianMonitor class.</div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_a08d97e06a4534524e4b6b87cfb27c4ae"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#a08d97e06a4534524e4b6b87cfb27c4ae">get_crack_front_edges</a></div><div class="ttdeci">static auto get_crack_front_edges(MoFEM::Interface &amp;m_field, Range crack_faces, bool parallel=true)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00124">EshelbianPlasticity.cpp:124</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_a652208c3378b6381518790e0b1cdfc96"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#a652208c3378b6381518790e0b1cdfc96">get_block_meshset</a></div><div class="ttdeci">static auto get_block_meshset(MoFEM::Interface &amp;m_field, const int ms_id, const unsigned int cubit_bc_type)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00074">EshelbianPlasticity.cpp:74</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_a682702e0fce3d077405cdabd7af01877"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#a682702e0fce3d077405cdabd7af01877">get_range_from_block</a></div><div class="ttdeci">static auto get_range_from_block(MoFEM::Interface &amp;m_field, const std::string block_name, int dim)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00052">EshelbianPlasticity.cpp:52</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_a711a5a75b4797d9d4f46d1a45dccaf32"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#a711a5a75b4797d9d4f46d1a45dccaf32">get_two_sides_of_crack_surface</a></div><div class="ttdeci">static auto get_two_sides_of_crack_surface(MoFEM::Interface &amp;m_field, Range crack_faces)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00169">EshelbianPlasticity.cpp:169</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_ac47fc7a580388e34129fdde590829ace"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#ac47fc7a580388e34129fdde590829ace">filter_owners</a></div><div class="ttdeci">static auto filter_owners(MoFEM::Interface &amp;m_field, Range skin)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00107">EshelbianPlasticity.cpp:107</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_acbdb074a26e17860f61191108d21d8a8"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#acbdb074a26e17860f61191108d21d8a8">filter_true_skin</a></div><div class="ttdeci">static auto filter_true_skin(MoFEM::Interface &amp;m_field, Range &amp;&amp;skin)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00096">EshelbianPlasticity.cpp:96</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8cpp_html_acd5f3538620db1687d2800eafd99e75d"><div class="ttname"><a href="_eshelbian_plasticity_8cpp.html#acd5f3538620db1687d2800eafd99e75d">get_skin</a></div><div class="ttdeci">static auto get_skin(MoFEM::Interface &amp;m_field, Range body_ents)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00117">EshelbianPlasticity.cpp:117</a></div></div>
<div class="ttc" id="a_eshelbian_plasticity_8hpp_html"><div class="ttname"><a href="_eshelbian_plasticity_8hpp.html">EshelbianPlasticity.hpp</a></div><div class="ttdoc">Eshelbian plasticity interface.</div></div>
<div class="ttc" id="a_log_manager_8hpp_html_a3b22f6000e678d07d69a2c790177a352"><div class="ttname"><a href="_log_manager_8hpp.html#a3b22f6000e678d07d69a2c790177a352">MOFEM_LOG_SEVERITY_SYNC</a></div><div class="ttdeci">#define MOFEM_LOG_SEVERITY_SYNC(comm, severity)</div><div class="ttdoc">Synchronise &quot;SYNC&quot; on curtain severity level.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00352">LogManager.hpp:352</a></div></div>
<div class="ttc" id="a_log_manager_8hpp_html_aef9b5316ec6db54581633adf7c670011"><div class="ttname"><a href="_log_manager_8hpp.html#aef9b5316ec6db54581633adf7c670011">MOFEM_LOG_C</a></div><div class="ttdeci">#define MOFEM_LOG_C(channel, severity, format,...)</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00311">LogManager.hpp:311</a></div></div>
<div class="ttc" id="a_mo_f_e_m_8hpp_html"><div class="ttname"><a href="_mo_f_e_m_8hpp.html">MoFEM.hpp</a></div></div>
<div class="ttc" id="a_set_up_schur_impl_8cpp_html"><div class="ttname"><a href="_set_up_schur_impl_8cpp.html">SetUpSchurImpl.cpp</a></div></div>
<div class="ttc" id="a_t_s_elastic_post_step_8cpp_html"><div class="ttname"><a href="_t_s_elastic_post_step_8cpp.html">TSElasticPostStep.cpp</a></div></div>
<div class="ttc" id="a_templates_8hpp_html_ab9006f32b4309540b5b2a3a4d9fa82ff"><div class="ttname"><a href="_templates_8hpp.html#ab9006f32b4309540b5b2a3a4d9fa82ff">FTENSOR_INDEX</a></div><div class="ttdeci">#define FTENSOR_INDEX(DIM, I)</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l02012">Templates.hpp:2012</a></div></div>
<div class="ttc" id="aapprox__sphere_8cpp_html_a188caae18b60b66f9f44214c7e28ac1f"><div class="ttname"><a href="approx__sphere_8cpp.html#a188caae18b60b66f9f44214c7e28ac1f">a</a></div><div class="ttdeci">constexpr double a</div><div class="ttdef"><b>Definition</b> <a href="approx__sphere_8cpp_source.html#l00030">approx_sphere.cpp:30</a></div></div>
<div class="ttc" id="abase__functions_8c_html_a56d2889a19d8d7affaa85cfca4aadd67"><div class="ttname"><a href="base__functions_8c.html#a56d2889a19d8d7affaa85cfca4aadd67">ierr</a></div><div class="ttdeci">static PetscErrorCode ierr</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00013">base_functions.c:13</a></div></div>
<div class="ttc" id="acheck__base__functions__derivatives__on__tet_8cpp_html_a3d8c24629d725b9ef8c238cf27c9b158"><div class="ttname"><a href="check__base__functions__derivatives__on__tet_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a></div><div class="ttdeci">static const double eps</div><div class="ttdef"><b>Definition</b> <a href="check__base__functions__derivatives__on__tet_8cpp_source.html#l00011">check_base_functions_derivatives_on_tet.cpp:11</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a541ffc988889246e44b233b777828847"><div class="ttname"><a href="child__and__parent_8cpp.html#a541ffc988889246e44b233b777828847">SPACE_DIM</a></div><div class="ttdeci">constexpr int SPACE_DIM</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00016">child_and_parent.cpp:16</a></div></div>
<div class="ttc" id="achild__and__parent_8cpp_html_a81eee41c11480cdc68dc9e63bef4e113"><div class="ttname"><a href="child__and__parent_8cpp.html#a81eee41c11480cdc68dc9e63bef4e113">BoundaryEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::BoundaryEle BoundaryEle</div><div class="ttdef"><b>Definition</b> <a href="child__and__parent_8cpp_source.html#l00039">child_and_parent.cpp:39</a></div></div>
<div class="ttc" id="acholesky_8hpp_html"><div class="ttname"><a href="cholesky_8hpp.html">cholesky.hpp</a></div><div class="ttdoc">cholesky decomposition</div></div>
<div class="ttc" id="aclass_bi_linear_form_html"><div class="ttname"><a href="class_bi_linear_form.html">BiLinearForm</a></div></div>
<div class="ttc" id="aclass_boundary_ele_op_html"><div class="ttname"><a href="class_boundary_ele_op.html">BoundaryEleOp</a></div></div>
<div class="ttc" id="aclass_entity_handle_html"><div class="ttname"><a href="class_entity_handle.html">EntityHandle</a></div></div>
<div class="ttc" id="aclass_f_e_method_html"><div class="ttname"><a href="class_f_e_method.html">FEMethod</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html">FTensor::Tensor1</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor1__value_8hpp_source.html#l00008">Tensor1_value.hpp:9</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html_acd2e7c8da26f682eb6c6b1017f817c19"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html#acd2e7c8da26f682eb6c6b1017f817c19">FTensor::Tensor1::normalize</a></div><div class="ttdeci">Tensor1&lt; T, Tensor_Dim &gt; normalize()</div><div class="ttdef"><b>Definition</b> <a href="_tensor1__value_8hpp_source.html#l00077">Tensor1_value.hpp:77</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor1_html_afebf8aa1d76c7b1f048efd271154adc6"><div class="ttname"><a href="class_f_tensor_1_1_tensor1.html#afebf8aa1d76c7b1f048efd271154adc6">FTensor::Tensor1::l2</a></div><div class="ttdeci">T l2() const</div><div class="ttdef"><b>Definition</b> <a href="_tensor1__value_8hpp_source.html#l00084">Tensor1_value.hpp:84</a></div></div>
<div class="ttc" id="aclass_f_tensor_1_1_tensor2_html"><div class="ttname"><a href="class_f_tensor_1_1_tensor2.html">FTensor::Tensor2</a></div><div class="ttdef"><b>Definition</b> <a href="_tensor2__value_8hpp_source.html#l00016">Tensor2_value.hpp:17</a></div></div>
<div class="ttc" id="aclass_face_element_forces_and_sources_core_html"><div class="ttname"><a href="class_face_element_forces_and_sources_core.html">FaceElementForcesAndSourcesCore</a></div></div>
<div class="ttc" id="aclass_linear_form_html"><div class="ttname"><a href="class_linear_form.html">LinearForm</a></div></div>
<div class="ttc" id="aclass_op_calculate_vector_field_gradient_html"><div class="ttname"><a href="class_op_calculate_vector_field_gradient.html">OpCalculateVectorFieldGradient</a></div></div>
<div class="ttc" id="aclass_range_html"><div class="ttname"><a href="class_range.html">Range</a></div></div>
<div class="ttc" id="aclass_side_ele_op_html"><div class="ttname"><a href="class_side_ele_op.html">SideEleOp</a></div></div>
<div class="ttc" id="aclass_tag_html"><div class="ttname"><a href="class_tag.html">Tag</a></div></div>
<div class="ttc" id="aclass_tet_polynomial_base_html"><div class="ttname"><a href="class_tet_polynomial_base.html">TetPolynomialBase</a></div></div>
<div class="ttc" id="aclassdouble_html"><div class="ttname"><a href="classdouble.html">double</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2ca4e8e36e4a6c3348cb98fd3223fb07b28">QUIET</a></div><div class="ttdeci">@ QUIET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00221">definitions.h:221</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601"><div class="ttname"><a href="definitions_8h.html#a018e38d630e7ebef4cfa48ab69889f2cace3e26676763569084c86b8c3b67d601">VERBOSE</a></div><div class="ttdeci">@ VERBOSE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00222">definitions.h:222</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dba3e66f07732b51f2cb52e13d598f8abda">COL</a></div><div class="ttdeci">@ COL</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0"><div class="ttname"><a href="definitions_8h.html#a194bf71b1f5ddbc56eef764d19ea69dbabf470e461303b909bf0dc58084ebafa0">ROW</a></div><div class="ttdeci">@ ROW</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00136">definitions.h:136</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264"><div class="ttname"><a href="definitions_8h.html#a2c740dc34f8edf00c432912eaa5484c1a0bb920c38e835e0fbae45b0c0c029264">MF_ZERO</a></div><div class="ttdeci">@ MF_ZERO</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00111">definitions.h:111</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5">FieldApproximationBase</a></div><div class="ttdeci">FieldApproximationBase</div><div class="ttdoc">approximation base</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00058">definitions.h:58</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a54a26843865f4712f50a74fa4f8d025d">AINSWORTH_LEGENDRE_BASE</a></div><div class="ttdeci">@ AINSWORTH_LEGENDRE_BASE</div><div class="ttdoc">Ainsworth Cole (Legendre) approx. base nme:nme847.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00061">definitions.h:60</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a82793ffff09a202573242f6ca519e530">USER_BASE</a></div><div class="ttdeci">@ USER_BASE</div><div class="ttdoc">user implemented approximation base</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00068">definitions.h:68</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a8cce63994b9a5ff42c90de590f0bb5c5">NOBASE</a></div><div class="ttdeci">@ NOBASE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00059">definitions.h:59</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf"><div class="ttname"><a href="definitions_8h.html#a2ed4ed94b56d2843840bb7c55adcf0c5a9b4f9fbc1a88eda9b2cde0df10ca23bf">DEMKOWICZ_JACOBI_BASE</a></div><div class="ttdeci">@ DEMKOWICZ_JACOBI_BASE</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00067">definitions.h:66</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a4a351b736710aa3cd92f1cc18c476e61"><div class="ttname"><a href="definitions_8h.html#a4a351b736710aa3cd92f1cc18c476e61">CHK_THROW_MESSAGE</a></div><div class="ttdeci">#define CHK_THROW_MESSAGE(err, msg)</div><div class="ttdoc">Check and throw MoFEM exception.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00609">definitions.h:609</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a59cd650c2f6d3e0dc1ad1c29821e8692"><div class="ttname"><a href="definitions_8h.html#a59cd650c2f6d3e0dc1ad1c29821e8692">MoFEMFunctionReturnHot</a></div><div class="ttdeci">#define MoFEMFunctionReturnHot(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00460">definitions.h:460</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a0adffb24dae0c41be5b803f4d444f066">L2</a></div><div class="ttdeci">@ L2</div><div class="ttdoc">field with C-1 continuity</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00088">definitions.h:88</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12a7ec6526640e5add74fe4b322e6343120">H1</a></div><div class="ttdeci">@ H1</div><div class="ttdoc">continuous field</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00085">definitions.h:85</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8"><div class="ttname"><a href="definitions_8h.html#a5ed4cb303bab8cd0673ae12e5bc73c12ab360a65247d7fe5efc6f3a533d47e5c8">HDIV</a></div><div class="ttdeci">@ HDIV</div><div class="ttdoc">field with continuous normal traction</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00087">definitions.h:87</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a5fe7ca274d3c5ac11ac61888ce74bc13"><div class="ttname"><a href="definitions_8h.html#a5fe7ca274d3c5ac11ac61888ce74bc13">MYPCOMM_INDEX</a></div><div class="ttdeci">#define MYPCOMM_INDEX</div><div class="ttdoc">default communicator number PCOMM</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00228">definitions.h:228</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4"><div class="ttname"><a href="definitions_8h.html#a67495dbd90aaa20212cd56e053e7c717abf5dc69e9e9e2cee1022240fd557dbf4">DISCONTINUOUS</a></div><div class="ttdeci">@ DISCONTINUOUS</div><div class="ttdoc">Broken continuity (No effect on L2 space)</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00101">definitions.h:101</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6c0b52978f1abc88bf8a1ba70b7308e3"><div class="ttname"><a href="definitions_8h.html#a6c0b52978f1abc88bf8a1ba70b7308e3">MoFEMFunctionBegin</a></div><div class="ttdeci">#define MoFEMFunctionBegin</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00359">definitions.h:359</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a6eadfb97993ab556555ad084fe088482"><div class="ttname"><a href="definitions_8h.html#a6eadfb97993ab556555ad084fe088482">CHKERRG</a></div><div class="ttdeci">#define CHKERRG(n)</div><div class="ttdoc">Check error code of MoFEM/MOAB/PETSc function.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00496">definitions.h:496</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a793899f524a281eb88e3ff2b01ce6acb"><div class="ttname"><a href="definitions_8h.html#a793899f524a281eb88e3ff2b01ce6acb">CHK_MOAB_THROW</a></div><div class="ttdeci">#define CHK_MOAB_THROW(err, msg)</div><div class="ttdoc">Check error code of MoAB function and throw MoFEM exception.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00589">definitions.h:589</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab"><div class="ttname"><a href="definitions_8h.html#a82340fd7aca566defb002f93cc299efcac77b6cdcfb446c668fd1d7c66cfd15ab">BLOCKSET</a></div><div class="ttdeci">@ BLOCKSET</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00161">definitions.h:161</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eab22230d41f866f427f7fa9496875bcc9">MOFEM_ATOM_TEST_INVALID</a></div><div class="ttdeci">@ MOFEM_ATOM_TEST_INVALID</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00040">definitions.h:40</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eac345e9ce83307109886a56dcaf5ab724">MOFEM_DATA_INCONSISTENCY</a></div><div class="ttdeci">@ MOFEM_DATA_INCONSISTENCY</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00031">definitions.h:31</a></div></div>
<div class="ttc" id="adefinitions_8h_html_a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf"><div class="ttname"><a href="definitions_8h.html#a980bf270a5c3f2f984262f7e74786a2eaef48b40a28ec42fda55bc4824e906baf">MOFEM_NOT_IMPLEMENTED</a></div><div class="ttdeci">@ MOFEM_NOT_IMPLEMENTED</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00032">definitions.h:32</a></div></div>
<div class="ttc" id="adefinitions_8h_html_acb0a46d159695a01bf667313b7788b45"><div class="ttname"><a href="definitions_8h.html#acb0a46d159695a01bf667313b7788b45">MoFEMFunctionReturn</a></div><div class="ttdeci">#define MoFEMFunctionReturn(a)</div><div class="ttdoc">Last executable line of each PETSc function used for error handling. Replaces return()</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00429">definitions.h:429</a></div></div>
<div class="ttc" id="adefinitions_8h_html_add80e5ef5f847b2d4b637029f0f671c3"><div class="ttname"><a href="definitions_8h.html#add80e5ef5f847b2d4b637029f0f671c3">CHKERR</a></div><div class="ttdeci">#define CHKERR</div><div class="ttdoc">Inline error check.</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00548">definitions.h:548</a></div></div>
<div class="ttc" id="adefinitions_8h_html_aee32377dce975c9a64ed73bd3a003404"><div class="ttname"><a href="definitions_8h.html#aee32377dce975c9a64ed73bd3a003404">MoFEMFunctionBeginHot</a></div><div class="ttdeci">#define MoFEMFunctionBeginHot</div><div class="ttdoc">First executable line of each MoFEM function, used for error handling. Final line of MoFEM functions ...</div><div class="ttdef"><b>Definition</b> <a href="definitions_8h_source.html#l00453">definitions.h:453</a></div></div>
<div class="ttc" id="adg__projection_8cpp_html_ad7eceded84ace5678d9df3e44f47d475"><div class="ttname"><a href="dg__projection_8cpp.html#ad7eceded84ace5678d9df3e44f47d475">order</a></div><div class="ttdeci">constexpr int order</div><div class="ttdef"><b>Definition</b> <a href="dg__projection_8cpp_source.html#l00018">dg_projection.cpp:18</a></div></div>
<div class="ttc" id="adm__create__subdm_8cpp_html_a6295d47efda04de55c38cb8ea1cdb807"><div class="ttname"><a href="dm__create__subdm_8cpp.html#a6295d47efda04de55c38cb8ea1cdb807">debug</a></div><div class="ttdeci">static const bool debug</div><div class="ttdef"><b>Definition</b> <a href="dm__create__subdm_8cpp_source.html#l00012">dm_create_subdm.cpp:12</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a19deff62572d607bc77ed2f82fa639cc"><div class="ttname"><a href="fem__tools_8h.html#a19deff62572d607bc77ed2f82fa639cc">ShapeDiffMBTET</a></div><div class="ttdeci">PetscErrorCode ShapeDiffMBTET(double *diffN)</div><div class="ttdoc">calculate derivatives of shape functions</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8c_source.html#l00319">fem_tools.c:319</a></div></div>
<div class="ttc" id="afem__tools_8h_html_a7878f2dbe482129374d1d05c05f3c670"><div class="ttname"><a href="fem__tools_8h.html#a7878f2dbe482129374d1d05c05f3c670">ShapeMBTET</a></div><div class="ttdeci">PetscErrorCode ShapeMBTET(double *N, const double *G_X, const double *G_Y, const double *G_Z, int DIM)</div><div class="ttdoc">calculate shape functions</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8c_source.html#l00306">fem_tools.c:306</a></div></div>
<div class="ttc" id="afem__tools_8h_html_af39e9dc2be2d3d367f56d6277553ba00"><div class="ttname"><a href="fem__tools_8h.html#af39e9dc2be2d3d367f56d6277553ba00">ShapeMBTRI</a></div><div class="ttdeci">PetscErrorCode ShapeMBTRI(double *N, const double *X, const double *Y, const int G_DIM)</div><div class="ttdoc">calculate shape functions on triangle</div><div class="ttdef"><b>Definition</b> <a href="fem__tools_8c_source.html#l00182">fem_tools.c:182</a></div></div>
<div class="ttc" id="afree__surface_8cpp_html_a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d"><div class="ttname"><a href="free__surface_8cpp.html#a275fe82762dca6ff32ecbb73db0b3b84af382a63cc3d6491bf26b59e66f46826d">F</a></div><div class="ttdeci">@ F</div><div class="ttdef"><b>Definition</b> <a href="free__surface_8cpp_source.html#l00396">free_surface.cpp:396</a></div></div>
<div class="ttc" id="agroup__dm_html_ga15496670ac6293eb1ae412714c6649db"><div class="ttname"><a href="group__dm.html#ga15496670ac6293eb1ae412714c6649db">MoFEM::DMMoFEMSetIsPartitioned</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetIsPartitioned(DM dm, PetscBool is_partitioned)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01123">DMMoFEM.cpp:1123</a></div></div>
<div class="ttc" id="agroup__dm_html_ga175a29f4cdd0e7b7ae6cc2a0d7ed1704"><div class="ttname"><a href="group__dm.html#ga175a29f4cdd0e7b7ae6cc2a0d7ed1704">MoFEM::DMMoFEMCreateSubDM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateSubDM(DM subdm, DM dm, const char problem_name[])</div><div class="ttdoc">Must be called by user to set Sub DM MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00215">DMMoFEM.cpp:215</a></div></div>
<div class="ttc" id="agroup__dm_html_ga20e87100aebf5aa51e07126ae1f5113d"><div class="ttname"><a href="group__dm.html#ga20e87100aebf5aa51e07126ae1f5113d">MoFEM::DMMoFEMAddElement</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddElement(DM dm, std::string fe_name)</div><div class="ttdoc">add element to dm</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00497">DMMoFEM.cpp:497</a></div></div>
<div class="ttc" id="agroup__dm_html_ga27babc6dfb0df28667682a98b5822739"><div class="ttname"><a href="group__dm.html#ga27babc6dfb0df28667682a98b5822739">MoFEM::DMMoFEMSetSquareProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetSquareProblem(DM dm, PetscBool square_problem)</div><div class="ttdoc">set squared problem</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00456">DMMoFEM.cpp:456</a></div></div>
<div class="ttc" id="agroup__dm_html_ga286b3dbf0959ea028035e1d808a9403a"><div class="ttname"><a href="group__dm.html#ga286b3dbf0959ea028035e1d808a9403a">MoFEM::DMMoFEMTSSetIFunction</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIFunction(DM dm, const char fe_name[], MoFEM::FEMethod *method, MoFEM::BasicMethod *pre_only, MoFEM::BasicMethod *post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00800">DMMoFEM.cpp:800</a></div></div>
<div class="ttc" id="agroup__dm_html_ga32f14a8ae536697a4a0356900ecb73fd"><div class="ttname"><a href="group__dm.html#ga32f14a8ae536697a4a0356900ecb73fd">MoFEM::DMMoFEMCreateMoFEM</a></div><div class="ttdeci">PetscErrorCode DMMoFEMCreateMoFEM(DM dm, MoFEM::Interface *m_field_ptr, const char problem_name[], const MoFEM::BitRefLevel bit_level, const MoFEM::BitRefLevel bit_mask=MoFEM::BitRefLevel().set())</div><div class="ttdoc">Must be called by user to set MoFEM data structures.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00114">DMMoFEM.cpp:114</a></div></div>
<div class="ttc" id="agroup__dm_html_ga3fcdbd5c74eba11ee82492e57d730756"><div class="ttname"><a href="group__dm.html#ga3fcdbd5c74eba11ee82492e57d730756">MoFEM::DMoFEMPostProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPostProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00556">DMMoFEM.cpp:556</a></div></div>
<div class="ttc" id="agroup__dm_html_ga490784c9685a7e4068b83ca2babc1ba1"><div class="ttname"><a href="group__dm.html#ga490784c9685a7e4068b83ca2babc1ba1">MoFEM::DMoFEMMeshToLocalVector</a></div><div class="ttdeci">PetscErrorCode DMoFEMMeshToLocalVector(DM dm, Vec l, InsertMode mode, ScatterMode scatter_mode)</div><div class="ttdoc">set local (or ghosted) vector values on mesh for partition only</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00523">DMMoFEM.cpp:523</a></div></div>
<div class="ttc" id="agroup__dm_html_ga62400e040ecf09a00b7ec3767fc7f124"><div class="ttname"><a href="group__dm.html#ga62400e040ecf09a00b7ec3767fc7f124">MoFEM::DMMoFEMAddSubFieldRow</a></div><div class="ttdeci">PetscErrorCode DMMoFEMAddSubFieldRow(DM dm, const char field_name[])</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00238">DMMoFEM.cpp:238</a></div></div>
<div class="ttc" id="agroup__dm_html_ga81d1702e6a5cbe505aa79e94c4aa9d74"><div class="ttname"><a href="group__dm.html#ga81d1702e6a5cbe505aa79e94c4aa9d74">MoFEM::DMMoFEMGetTsCtx</a></div><div class="ttdeci">PetscErrorCode DMMoFEMGetTsCtx(DM dm, MoFEM::TsCtx **ts_ctx)</div><div class="ttdoc">get MoFEM::TsCtx data structure</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01142">DMMoFEM.cpp:1142</a></div></div>
<div class="ttc" id="agroup__dm_html_gaa77602fddf773ab52fee8369cc135d7e"><div class="ttname"><a href="group__dm.html#gaa77602fddf773ab52fee8369cc135d7e">MoFEM::DMoFEMLoopFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElements(DM dm, const char fe_name[], MoFEM::FEMethod *method, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00586">DMMoFEM.cpp:586</a></div></div>
<div class="ttc" id="agroup__dm_html_gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3"><div class="ttname"><a href="group__dm.html#gabda10e5ada2ddd1fa4bdf9f7a6a3fdc3">MoFEM::DMMoFEMTSSetIJacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetIJacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00853">DMMoFEM.cpp:853</a></div></div>
<div class="ttc" id="agroup__dm_html_gac26499a0d7716b8a666c872f0e900254"><div class="ttname"><a href="group__dm.html#gac26499a0d7716b8a666c872f0e900254">MoFEM::createDMVector</a></div><div class="ttdeci">auto createDMVector(DM dm)</div><div class="ttdoc">Get smart vector from DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01099">DMMoFEM.hpp:1099</a></div></div>
<div class="ttc" id="agroup__dm_html_gacb6892c50af6ca032cc69aeead61cd1e"><div class="ttname"><a href="group__dm.html#gacb6892c50af6ca032cc69aeead61cd1e">MoFEM::DMMoFEMTSSetI2Jacobian</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetI2Jacobian(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS Jacobian evaluation function</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l01017">DMMoFEM.cpp:1017</a></div></div>
<div class="ttc" id="agroup__dm_html_gacdda38385eb99fd6fa1257f4cd143053"><div class="ttname"><a href="group__dm.html#gacdda38385eb99fd6fa1257f4cd143053">MoFEM::DMMoFEMTSSetI2Function</a></div><div class="ttdeci">PetscErrorCode DMMoFEMTSSetI2Function(DM dm, const std::string fe_name, boost::shared_ptr&lt; MoFEM::FEMethod &gt; method, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; pre_only, boost::shared_ptr&lt; MoFEM::BasicMethod &gt; post_only)</div><div class="ttdoc">set TS implicit function evaluation function</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00975">DMMoFEM.cpp:975</a></div></div>
<div class="ttc" id="agroup__dm_html_gaef66c04ab918f0e5e965838b12726405"><div class="ttname"><a href="group__dm.html#gaef66c04ab918f0e5e965838b12726405">MoFEM::DMoFEMLoopFiniteElementsUpAndLowRank</a></div><div class="ttdeci">PetscErrorCode DMoFEMLoopFiniteElementsUpAndLowRank(DM dm, const char fe_name[], MoFEM::FEMethod *method, int low_rank, int up_rank, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr())</div><div class="ttdoc">Executes FEMethod for finite elements in DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00567">DMMoFEM.cpp:567</a></div></div>
<div class="ttc" id="agroup__dm_html_gaf4d3fe19e4d76504628e614fd388c33f"><div class="ttname"><a href="group__dm.html#gaf4d3fe19e4d76504628e614fd388c33f">MoFEM::DMoFEMPreProcessFiniteElements</a></div><div class="ttdeci">PetscErrorCode DMoFEMPreProcessFiniteElements(DM dm, MoFEM::FEMethod *method)</div><div class="ttdoc">execute finite element method for each element in dm (problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00546">DMMoFEM.cpp:546</a></div></div>
<div class="ttc" id="agroup__mofem__access_html_gaead3887ddc924ad6d2a0993bfb4a9b27"><div class="ttname"><a href="group__mofem__access.html#gaead3887ddc924ad6d2a0993bfb4a9b27">_IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_</a></div><div class="ttdeci">#define _IT_GET_DOFS_FIELD_BY_NAME_AND_ENT_FOR_LOOP_(MFIELD, NAME, ENT, IT)</div><div class="ttdoc">loop over all dofs from a moFEM field and particular field</div><div class="ttdef"><b>Definition</b> <a href="_interface_8hpp_source.html#l01917">Interface.hpp:1917</a></div></div>
<div class="ttc" id="agroup__mofem__base__functions_html_ga176a495a81c85ce580624a284726521e"><div class="ttname"><a href="group__mofem__base__functions.html#ga176a495a81c85ce580624a284726521e">Legendre_polynomials</a></div><div class="ttdeci">PetscErrorCode Legendre_polynomials(int p, double s, double *diff_s, double *L, double *diffL, const int dim)</div><div class="ttdoc">Calculate Legendre approximation basis.</div><div class="ttdef"><b>Definition</b> <a href="base__functions_8c_source.html#l00015">base_functions.c:15</a></div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga4a5b822f605f1a4faa668595a3f2a5ae"><div class="ttname"><a href="group__mofem__fe.html#ga4a5b822f605f1a4faa668595a3f2a5ae">MoFEM::CoreInterface::add_finite_element</a></div><div class="ttdeci">virtual MoFEMErrorCode add_finite_element(const std::string &amp;fe_name, enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">add finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga735f920686a9c958073ec14ea0dc1da0"><div class="ttname"><a href="group__mofem__fe.html#ga735f920686a9c958073ec14ea0dc1da0">MoFEM::CoreInterface::build_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode build_finite_elements(int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Build finite elements.</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga8a9935d6f31d07ed365e6cc76bd041d2"><div class="ttname"><a href="group__mofem__fe.html#ga8a9935d6f31d07ed365e6cc76bd041d2">MoFEM::CoreInterface::modify_finite_element_add_field_col</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_col(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field col which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_ga9c5d28e66a86646de9e733b34ea03a71"><div class="ttname"><a href="group__mofem__fe.html#ga9c5d28e66a86646de9e733b34ea03a71">MoFEM::CoreInterface::modify_finite_element_adjacency_table</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_adjacency_table(const std::string &amp;fe_name, const EntityType type, ElementAdjacencyFunct function)=0</div><div class="ttdoc">modify finite element table, only for advanced user</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gacbb3bbf1fa80b85848bc3cfcd604182b"><div class="ttname"><a href="group__mofem__fe.html#gacbb3bbf1fa80b85848bc3cfcd604182b">MoFEM::CoreInterface::add_ents_to_finite_element_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_finite_element_by_type(const EntityHandle entities, const EntityType type, const std::string name, const bool recursive=true)=0</div><div class="ttdoc">add entities to finite element</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gad29d66fc5706d3b20e4acd02eac81c9d"><div class="ttname"><a href="group__mofem__fe.html#gad29d66fc5706d3b20e4acd02eac81c9d">MoFEM::CoreInterface::modify_finite_element_add_field_row</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_row(const std::string &amp;fe_name, const std::string name_row)=0</div><div class="ttdoc">set field row which finite element use</div></div>
<div class="ttc" id="agroup__mofem__fe_html_gaef2eb2d85b90b55bd7c4f355e10fa498"><div class="ttname"><a href="group__mofem__fe.html#gaef2eb2d85b90b55bd7c4f355e10fa498">MoFEM::CoreInterface::modify_finite_element_add_field_data</a></div><div class="ttdeci">virtual MoFEMErrorCode modify_finite_element_add_field_data(const std::string &amp;fe_name, const std::string name_field)=0</div><div class="ttdoc">set finite element field data</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga01ac334d9339ed5f1b0bcfa12a8daf1d"><div class="ttname"><a href="group__mofem__field.html#ga01ac334d9339ed5f1b0bcfa12a8daf1d">MoFEM::CoreInterface::get_field_structure</a></div><div class="ttdeci">virtual const Field * get_field_structure(const std::string &amp;name, enum MoFEMTypes bh=MF_EXIST) const =0</div><div class="ttdoc">get field structure</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga126ea0bb04802f9d1946435279c3da56"><div class="ttname"><a href="group__mofem__field.html#ga126ea0bb04802f9d1946435279c3da56">MoFEM::CoreInterface::build_fields</a></div><div class="ttdeci">virtual MoFEMErrorCode build_fields(int verb=DEFAULT_VERBOSITY)=0</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga3f2352d1e29c591592c37cc89d0e4eb4"><div class="ttname"><a href="group__mofem__field.html#ga3f2352d1e29c591592c37cc89d0e4eb4">MoFEM::CoreInterface::add_ents_to_field_by_dim</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_dim(const Range &amp;ents, const int dim, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__field_html_ga86f0c16b69cc30dabc5d7dd292299b07"><div class="ttname"><a href="group__mofem__field.html#ga86f0c16b69cc30dabc5d7dd292299b07">MoFEM::CoreInterface::set_field_order</a></div><div class="ttdeci">virtual MoFEMErrorCode set_field_order(const EntityHandle meshset, const EntityType type, const std::string &amp;name, const ApproximationOrder order, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Set order approximation of the entities in the field.</div></div>
<div class="ttc" id="agroup__mofem__field_html_gaa584a5c9cc28f5ae0a7088d130683be8"><div class="ttname"><a href="group__mofem__field.html#gaa584a5c9cc28f5ae0a7088d130683be8">MoFEM::CoreInterface::add_ents_to_field_by_type</a></div><div class="ttdeci">virtual MoFEMErrorCode add_ents_to_field_by_type(const Range &amp;ents, const EntityType type, const std::string &amp;name, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add entities to field meshset.</div></div>
<div class="ttc" id="agroup__mofem__forms_html_gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced"><div class="ttname"><a href="group__mofem__forms.html#gga2136fdd1cb130ca18f645e799b05569faccb6b64b4a909e6408f40132996fdced">MoFEM::GAUSS</a></div><div class="ttdeci">@ GAUSS</div><div class="ttdef"><b>Definition</b> <a href="_forms_integrators_8hpp_source.html#l00136">FormsIntegrators.hpp:136</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga19fe81dc9081ceb92ced847e619ca654"><div class="ttname"><a href="group__mofem__log__manager.html#ga19fe81dc9081ceb92ced847e619ca654">MOFEM_LOG</a></div><div class="ttdeci">#define MOFEM_LOG(channel, severity)</div><div class="ttdoc">Log.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00308">LogManager.hpp:308</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga1d256cf4cf0b698de94c0907f7f0fe93"><div class="ttname"><a href="group__mofem__log__manager.html#ga1d256cf4cf0b698de94c0907f7f0fe93">MoFEM::LogManager::SeverityLevel</a></div><div class="ttdeci">SeverityLevel</div><div class="ttdoc">Severity levels.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00033">LogManager.hpp:33</a></div></div>
<div class="ttc" id="agroup__mofem__log__manager_html_ga47d7053307c012af4b78f8a09e21fa83"><div class="ttname"><a href="group__mofem__log__manager.html#ga47d7053307c012af4b78f8a09e21fa83">MOFEM_LOG_CHANNEL</a></div><div class="ttdeci">#define MOFEM_LOG_CHANNEL(channel)</div><div class="ttdoc">Set and reset channel.</div><div class="ttdef"><b>Definition</b> <a href="_log_manager_8hpp_source.html#l00284">LogManager.hpp:284</a></div></div>
<div class="ttc" id="agroup__mofem__loops_html_ga06843828fb475925d003a31b991c425e"><div class="ttname"><a href="group__mofem__loops.html#ga06843828fb475925d003a31b991c425e">MoFEM::CoreInterface::loop_dofs</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_dofs(const Problem *problem_ptr, const std::string &amp;field_name, RowColData rc, DofMethod &amp;method, int lower_rank, int upper_rank, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over dofs.</div></div>
<div class="ttc" id="agroup__mofem__loops_html_gab3dc3302de79f29b26605579d77797c9"><div class="ttname"><a href="group__mofem__loops.html#gab3dc3302de79f29b26605579d77797c9">MoFEM::CoreInterface::loop_finite_elements</a></div><div class="ttdeci">virtual MoFEMErrorCode loop_finite_elements(const std::string problem_name, const std::string &amp;fe_name, FEMethod &amp;method, boost::shared_ptr&lt; NumeredEntFiniteElement_multiIndex &gt; fe_ptr=nullptr, MoFEMTypes bh=MF_EXIST, CacheTupleWeakPtr cache_ptr=CacheTupleSharedPtr(), int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Make a loop over finite elements.</div></div>
<div class="ttc" id="agroup__mofem__meshset__mng_html_gaa54e3cb5e57c57a8d03d9c4c7a21a80a"><div class="ttname"><a href="group__mofem__meshset__mng.html#gaa54e3cb5e57c57a8d03d9c4c7a21a80a">MoFEM::MeshsetsManager::getCubitMeshsetPtr</a></div><div class="ttdeci">MoFEMErrorCode getCubitMeshsetPtr(const int ms_id, const CubitBCType cubit_bc_type, const CubitMeshSets **cubit_meshset_ptr) const</div><div class="ttdoc">get cubit meshset</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8cpp_source.html#l00589">MeshsetsManager.cpp:589</a></div></div>
<div class="ttc" id="ah1__hdiv__hcurl__l2_8h_html_afff51d616c826e4714c19b69816fa74f"><div class="ttname"><a href="h1__hdiv__hcurl__l2_8h.html#afff51d616c826e4714c19b69816fa74f">NBVOLUMETET_L2</a></div><div class="ttdeci">#define NBVOLUMETET_L2(P)</div><div class="ttdoc">Number of base functions on tetrahedron for L2 space.</div><div class="ttdef"><b>Definition</b> <a href="h1__hdiv__hcurl__l2_8h_source.html#l00027">h1_hdiv_hcurl_l2.h:27</a></div></div>
<div class="ttc" id="ahanging__node__approx_8cpp_html_ae63ebbb5e1ef5e0a8b9872228c595f8c"><div class="ttname"><a href="hanging__node__approx_8cpp.html#ae63ebbb5e1ef5e0a8b9872228c595f8c">bit</a></div><div class="ttdeci">auto bit</div><div class="ttdoc">set bit</div><div class="ttdef"><b>Definition</b> <a href="hanging__node__approx_8cpp_source.html#l00075">hanging_node_approx.cpp:75</a></div></div>
<div class="ttc" id="ahcurl__check__approx__in__2d_8cpp_html_a0c2ce8a466ed667b4f9f65fa9e1f3439"><div class="ttname"><a href="hcurl__check__approx__in__2d_8cpp.html#a0c2ce8a466ed667b4f9f65fa9e1f3439">a2</a></div><div class="ttdeci">constexpr double a2</div><div class="ttdef"><b>Definition</b> <a href="hcurl__check__approx__in__2d_8cpp_source.html#l00039">hcurl_check_approx_in_2d.cpp:39</a></div></div>
<div class="ttc" id="ahcurl__check__approx__in__2d_8cpp_html_a6c7cb8ddd43ff771629f497cdde37cf0"><div class="ttname"><a href="hcurl__check__approx__in__2d_8cpp.html#a6c7cb8ddd43ff771629f497cdde37cf0">a0</a></div><div class="ttdeci">constexpr double a0</div><div class="ttdef"><b>Definition</b> <a href="hcurl__check__approx__in__2d_8cpp_source.html#l00037">hcurl_check_approx_in_2d.cpp:37</a></div></div>
<div class="ttc" id="ahcurl__check__approx__in__2d_8cpp_html_ab15e689358a615d219482bd56eee383d"><div class="ttname"><a href="hcurl__check__approx__in__2d_8cpp.html#ab15e689358a615d219482bd56eee383d">a1</a></div><div class="ttdeci">constexpr double a1</div><div class="ttdef"><b>Definition</b> <a href="hcurl__check__approx__in__2d_8cpp_source.html#l00038">hcurl_check_approx_in_2d.cpp:38</a></div></div>
<div class="ttc" id="ahcurl__divergence__operator__2d_8cpp_html_a4c0436605284b64f6b0b5482594d86bc"><div class="ttname"><a href="hcurl__divergence__operator__2d_8cpp.html#a4c0436605284b64f6b0b5482594d86bc">i</a></div><div class="ttdeci">FTensor::Index&lt; 'i', SPACE_DIM &gt; i</div><div class="ttdef"><b>Definition</b> <a href="hcurl__divergence__operator__2d_8cpp_source.html#l00027">hcurl_divergence_operator_2d.cpp:27</a></div></div>
<div class="ttc" id="ainitial__diffusion_8cpp_html_af16c6805bd7f1a6a9acfe503216a5555"><div class="ttname"><a href="initial__diffusion_8cpp.html#af16c6805bd7f1a6a9acfe503216a5555">v</a></div><div class="ttdeci">const double v</div><div class="ttdoc">phase velocity of light in medium (cm/ns)</div><div class="ttdef"><b>Definition</b> <a href="initial__diffusion_8cpp_source.html#l00040">initial_diffusion.cpp:40</a></div></div>
<div class="ttc" id="alevel__set_8cpp_html_ae194ec50b15d7b114a4e5e5a4cb8e218"><div class="ttname"><a href="level__set_8cpp.html#ae194ec50b15d7b114a4e5e5a4cb8e218">ts_ctx</a></div><div class="ttdeci">MoFEM::TsCtx * ts_ctx</div><div class="ttdef"><b>Definition</b> <a href="level__set_8cpp_source.html#l01932">level_set.cpp:1932</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a510d8658904ea5f9e62ae641c8122e49"><div class="ttname"><a href="matrix__function_8cpp.html#a510d8658904ea5f9e62ae641c8122e49">l</a></div><div class="ttdeci">FTensor::Index&lt; 'l', 3 &gt; l</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00021">matrix_function.cpp:21</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_a8191f28ba278df9c5d32a75cadb2bbd5"><div class="ttname"><a href="matrix__function_8cpp.html#a8191f28ba278df9c5d32a75cadb2bbd5">j</a></div><div class="ttdeci">FTensor::Index&lt; 'j', 3 &gt; j</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00019">matrix_function.cpp:19</a></div></div>
<div class="ttc" id="amatrix__function_8cpp_html_ac93d777bbf9336cad5c09007df789c95"><div class="ttname"><a href="matrix__function_8cpp.html#ac93d777bbf9336cad5c09007df789c95">k</a></div><div class="ttdeci">FTensor::Index&lt; 'k', 3 &gt; k</div><div class="ttdef"><b>Definition</b> <a href="matrix__function_8cpp_source.html#l00020">matrix_function.cpp:20</a></div></div>
<div class="ttc" id="anamespace_eshelbian_plasticity_html"><div class="ttname"><a href="namespace_eshelbian_plasticity.html">EshelbianPlasticity</a></div><div class="ttdef"><b>Definition</b> <a href="_c_g_g_tonsorial_bubble_base_8hpp_source.html#l00011">CGGTonsorialBubbleBase.hpp:11</a></div></div>
<div class="ttc" id="anamespace_eshelbian_plasticity_html_a68543d06189d85f76d53dfc14a39ecf5"><div class="ttname"><a href="namespace_eshelbian_plasticity.html#a68543d06189d85f76d53dfc14a39ecf5">EshelbianPlasticity::CGG_BubbleBase_MBTET</a></div><div class="ttdeci">MoFEMErrorCode CGG_BubbleBase_MBTET(const int p, const double *N, const double *diffN, FTensor::Tensor2&lt; FTensor::PackPtr&lt; double *, 9 &gt;, 3, 3 &gt; &amp;phi, const int gdim)</div><div class="ttdoc">Calculate CGGT tonsorial bubble base.</div><div class="ttdef"><b>Definition</b> <a href="_c_g_g_tonsorial_bubble_base_8cpp_source.html#l00020">CGGTonsorialBubbleBase.cpp:20</a></div></div>
<div class="ttc" id="anamespace_eshelbian_plasticity_html_a9a8b1d5aaedc0a0225c4c83bed2d60f6"><div class="ttname"><a href="namespace_eshelbian_plasticity.html#a9a8b1d5aaedc0a0225c4c83bed2d60f6">EshelbianPlasticity::StretchSelector</a></div><div class="ttdeci">StretchSelector</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00046">EshelbianPlasticity.hpp:46</a></div></div>
<div class="ttc" id="anamespace_eshelbian_plasticity_html_aad51dbcb3d4d470a0d589df584a43e17"><div class="ttname"><a href="namespace_eshelbian_plasticity.html#aad51dbcb3d4d470a0d589df584a43e17">EshelbianPlasticity::RotSelector</a></div><div class="ttdeci">RotSelector</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00045">EshelbianPlasticity.hpp:45</a></div></div>
<div class="ttc" id="anamespace_eshelbian_plasticity_html_ae337388c661d8b90487c846cd2f361fa"><div class="ttname"><a href="namespace_eshelbian_plasticity.html#ae337388c661d8b90487c846cd2f361fa">EshelbianPlasticity::SymmetrySelector</a></div><div class="ttdeci">SymmetrySelector</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00044">EshelbianPlasticity.hpp:44</a></div></div>
<div class="ttc" id="anamespace_f_tensor_html_a50ff153c38920d1001276f5d857e0599"><div class="ttname"><a href="namespace_f_tensor.html#a50ff153c38920d1001276f5d857e0599">FTensor::levi_civita</a></div><div class="ttdeci">constexpr std::enable_if&lt;(Dim0&lt;=2 &amp;&amp;Dim1&lt;=2), Tensor2_Expr&lt; Levi_Civita&lt; T &gt;, T, Dim0, Dim1, i, j &gt; &gt;::type levi_civita(const Index&lt; i, Dim0 &gt; &amp;, const Index&lt; j, Dim1 &gt; &amp;)</div><div class="ttdoc">levi_civita functions to make for easy adhoc use</div><div class="ttdef"><b>Definition</b> <a href="_levi___civita_8hpp_source.html#l00617">Levi_Civita.hpp:617</a></div></div>
<div class="ttc" id="anamespace_f_tensor_html_ad4a6ecc7f7a6e3b3903a9cff27887f39"><div class="ttname"><a href="namespace_f_tensor.html#ad4a6ecc7f7a6e3b3903a9cff27887f39">FTensor::dd</a></div><div class="ttdeci">const Tensor2_symmetric_Expr&lt; const ddTensor0&lt; T, Dim, i, j &gt;, typename promote&lt; T, double &gt;::V, Dim, i, j &gt; dd(const Tensor0&lt; T * &gt; &amp;a, const Index&lt; i, Dim &gt; index1, const Index&lt; j, Dim &gt; index2, const Tensor1&lt; int, Dim &gt; &amp;d_ijk, const Tensor1&lt; double, Dim &gt; &amp;d_xyz)</div><div class="ttdef"><b>Definition</b> <a href="dd_tensor0_8hpp_source.html#l00033">ddTensor0.hpp:33</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_1_1_exceptions_html_a8fb6351034eac301fc47fdf2748c1b45"><div class="ttname"><a href="namespace_mo_f_e_m_1_1_exceptions.html#a8fb6351034eac301fc47fdf2748c1b45">MoFEM::Exceptions::MoFEMErrorCode</a></div><div class="ttdeci">PetscErrorCode MoFEMErrorCode</div><div class="ttdoc">MoFEM/PETSc error code.</div><div class="ttdef"><b>Definition</b> <a href="_exceptions_8hpp_source.html#l00056">Exceptions.hpp:56</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html"><div class="ttname"><a href="namespace_mo_f_e_m.html">MoFEM</a></div><div class="ttdoc">implementation of Data Operators for Forces and Sources</div><div class="ttdef"><b>Definition</b> <a href="_common_8hpp_source.html#l00010">Common.hpp:10</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a1808931312a0a80aad5a5e769aa9e536"><div class="ttname"><a href="namespace_mo_f_e_m.html#a1808931312a0a80aad5a5e769aa9e536">MoFEM::getDMTsCtx</a></div><div class="ttdeci">auto getDMTsCtx(DM dm)</div><div class="ttdoc">Get TS context data structure used by DM.</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8hpp_source.html#l01141">DMMoFEM.hpp:1141</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a2ae9847dc65a4ed504f68633851f8ddf"><div class="ttname"><a href="namespace_mo_f_e_m.html#a2ae9847dc65a4ed504f68633851f8ddf">MoFEM::DMMoFEMSetDestroyProblem</a></div><div class="ttdeci">PetscErrorCode DMMoFEMSetDestroyProblem(DM dm, PetscBool destroy_problem)</div><div class="ttdef"><b>Definition</b> <a href="_d_m_mo_f_e_m_8cpp_source.html#l00438">DMMoFEM.cpp:438</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a55db6ee7b037f883685d61baabd7ace4"><div class="ttname"><a href="namespace_mo_f_e_m.html#a55db6ee7b037f883685d61baabd7ace4">MoFEM::PetscOptionsGetBool</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetBool(PetscOptions *, const char pre[], const char name[], PetscBool *bval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_petsc_8hpp_source.html#l00182">DeprecatedPetsc.hpp:182</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a5a7a36eeb1e285b8460d36033d514cfd"><div class="ttname"><a href="namespace_mo_f_e_m.html#a5a7a36eeb1e285b8460d36033d514cfd">MoFEM::PetscOptionsGetScalar</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetScalar(PetscOptions *, const char pre[], const char name[], PetscScalar *dval, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_petsc_8hpp_source.html#l00162">DeprecatedPetsc.hpp:162</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a5ad6537f1d6adcc338597770747bc19a"><div class="ttname"><a href="namespace_mo_f_e_m.html#a5ad6537f1d6adcc338597770747bc19a">MoFEM::solveLinearSystem</a></div><div class="ttdeci">MoFEMErrorCode solveLinearSystem(MatrixDouble &amp;mat, VectorDouble &amp;f)</div><div class="ttdoc">solve linear system with lapack dgesv</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01401">Templates.hpp:1401</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a681e912e2d0043503d2da810dc186d73"><div class="ttname"><a href="namespace_mo_f_e_m.html#a681e912e2d0043503d2da810dc186d73">MoFEM::vectorDuplicate</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; vectorDuplicate(Vec vec)</div><div class="ttdoc">Create duplicate vector of smart vector.</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00221">PetscSmartObj.hpp:221</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a75aed9eb5f422c1955dbbdacb26c2b38"><div class="ttname"><a href="namespace_mo_f_e_m.html#a75aed9eb5f422c1955dbbdacb26c2b38">MoFEM::th</a></div><div class="ttdeci">Tag th</div><div class="ttdef"><b>Definition</b> <a href="_projection10_node_coords_on_field_8cpp_source.html#l00122">Projection10NodeCoordsOnField.cpp:122</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_a77d94d2111c0c988bc3100b3910cc25c"><div class="ttname"><a href="namespace_mo_f_e_m.html#a77d94d2111c0c988bc3100b3910cc25c">MoFEM::createVectorMPI</a></div><div class="ttdeci">auto createVectorMPI(MPI_Comm comm, PetscInt n, PetscInt N)</div><div class="ttdoc">Create MPI Vector.</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00202">PetscSmartObj.hpp:202</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_acd15202cb7502a684f8276aae2b4ed70"><div class="ttname"><a href="namespace_mo_f_e_m.html#acd15202cb7502a684f8276aae2b4ed70">MoFEM::PetscOptionsGetString</a></div><div class="ttdeci">PetscErrorCode PetscOptionsGetString(PetscOptions *, const char pre[], const char name[], char str[], size_t size, PetscBool *set)</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_petsc_8hpp_source.html#l00172">DeprecatedPetsc.hpp:172</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ad17eefd5d88d2b51c71ec46cae8569ac"><div class="ttname"><a href="namespace_mo_f_e_m.html#ad17eefd5d88d2b51c71ec46cae8569ac">MoFEM::get_temp_meshset_ptr</a></div><div class="ttdeci">auto get_temp_meshset_ptr(moab::Interface &amp;moab)</div><div class="ttdoc">Create smart pointer to temporary meshset.</div><div class="ttdef"><b>Definition</b> <a href="_templates_8hpp_source.html#l01886">Templates.hpp:1886</a></div></div>
<div class="ttc" id="anamespace_mo_f_e_m_html_ae6b64312d73966f4cc41953bc77a4ba3"><div class="ttname"><a href="namespace_mo_f_e_m.html#ae6b64312d73966f4cc41953bc77a4ba3">MoFEM::createDM</a></div><div class="ttdeci">auto createDM(MPI_Comm comm, const std::string dm_type_name)</div><div class="ttdoc">Creates smart DM object.</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00141">PetscSmartObj.hpp:141</a></div></div>
<div class="ttc" id="anamespacesdf_html_a2f1f399a483aed931a5a8ac3b98f49ba"><div class="ttname"><a href="namespacesdf.html#a2f1f399a483aed931a5a8ac3b98f49ba">sdf.r</a></div><div class="ttdeci">int r</div><div class="ttdef"><b>Definition</b> <a href="jupyter_2skel_2ukacm__autumn__school_2multifield__plasticity_2sdf_8py_source.html#l00008">sdf.py:8</a></div></div>
<div class="ttc" id="aoperators__tests_8cpp_html_aaea25cacd18f8fc7fbbaa4311fe33b72"><div class="ttname"><a href="operators__tests_8cpp.html#aaea25cacd18f8fc7fbbaa4311fe33b72">A</a></div><div class="ttdeci">constexpr AssemblyType A</div><div class="ttdef"><b>Definition</b> <a href="operators__tests_8cpp_source.html#l00030">operators_tests.cpp:30</a></div></div>
<div class="ttc" id="aphoton__diffusion_8cpp_html_ada3f24ae35ae50faea3df2b474ea2f37"><div class="ttname"><a href="photon__diffusion_8cpp.html#ada3f24ae35ae50faea3df2b474ea2f37">OpPPMap</a></div><div class="ttdeci">OpPostProcMapInMoab&lt; SPACE_DIM, SPACE_DIM &gt; OpPPMap</div><div class="ttdef"><b>Definition</b> <a href="photon__diffusion_8cpp_source.html#l00029">photon_diffusion.cpp:29</a></div></div>
<div class="ttc" id="aplastic_8cpp_html_ae9faec98b784e677f51cf7ede5a592b4"><div class="ttname"><a href="plastic_8cpp.html#ae9faec98b784e677f51cf7ede5a592b4">SideEle</a></div><div class="ttdeci">ElementsAndOps&lt; SPACE_DIM &gt;::SideEle SideEle</div><div class="ttdef"><b>Definition</b> <a href="plastic_8cpp_source.html#l00061">plastic.cpp:61</a></div></div>
<div class="ttc" id="aplate_8cpp_html_a95479f31dffaa5e5858822a5e4c231d6"><div class="ttname"><a href="plate_8cpp.html#a95479f31dffaa5e5858822a5e4c231d6">t</a></div><div class="ttdeci">constexpr double t</div><div class="ttdoc">plate stiffness</div><div class="ttdef"><b>Definition</b> <a href="plate_8cpp_source.html#l00058">plate.cpp:58</a></div></div>
<div class="ttc" id="apoisson__2d__dis__galerkin_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="poisson__2d__dis__galerkin_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">static double phi</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__dis__galerkin_8cpp_source.html#l00030">poisson_2d_dis_galerkin.cpp:30</a></div></div>
<div class="ttc" id="apoisson__2d__homogeneous_8cpp_html_a3917f3987bad1f4e24b85c9d0ab84a5e"><div class="ttname"><a href="poisson__2d__homogeneous_8cpp.html#a3917f3987bad1f4e24b85c9d0ab84a5e">field_name</a></div><div class="ttdeci">constexpr auto field_name</div><div class="ttdef"><b>Definition</b> <a href="poisson__2d__homogeneous_8cpp_source.html#l00013">poisson_2d_homogeneous.cpp:13</a></div></div>
<div class="ttc" id="aquad_8h_html"><div class="ttname"><a href="quad_8h.html">quad.h</a></div></div>
<div class="ttc" id="aquad_8h_html_a054557173149016194334ebfa52bdfff"><div class="ttname"><a href="quad_8h.html#a054557173149016194334ebfa52bdfff">QUAD_2D_TABLE_SIZE</a></div><div class="ttdeci">#define QUAD_2D_TABLE_SIZE</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00174">quad.h:174</a></div></div>
<div class="ttc" id="aquad_8h_html_a1595ef6e1d0b6c71455660b4d9219cb6"><div class="ttname"><a href="quad_8h.html#a1595ef6e1d0b6c71455660b4d9219cb6">QUAD_3D_TABLE_SIZE</a></div><div class="ttdeci">#define QUAD_3D_TABLE_SIZE</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00186">quad.h:186</a></div></div>
<div class="ttc" id="aquad_8h_html_a8a7ef1fada6eeb66c2958ecb8480f040"><div class="ttname"><a href="quad_8h.html#a8a7ef1fada6eeb66c2958ecb8480f040">QUAD_2D_TABLE</a></div><div class="ttdeci">static QUAD *const QUAD_2D_TABLE[]</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00175">quad.h:175</a></div></div>
<div class="ttc" id="aquad_8h_html_aeda07179568bdfe515fdb7368b7adec4"><div class="ttname"><a href="quad_8h.html#aeda07179568bdfe515fdb7368b7adec4">QUAD_3D_TABLE</a></div><div class="ttdeci">static QUAD *const QUAD_3D_TABLE[]</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00187">quad.h:187</a></div></div>
<div class="ttc" id="ascalar__check__approximation_8cpp_html_a9e6f88bbff7880d45f1d2c50fbf8ee76"><div class="ttname"><a href="scalar__check__approximation_8cpp.html#a9e6f88bbff7880d45f1d2c50fbf8ee76">EleOnSide</a></div><div class="ttdeci">PipelineManager::ElementsAndOpsByDim&lt; SPACE_DIM &gt;::FaceSideEle EleOnSide</div><div class="ttdef"><b>Definition</b> <a href="scalar__check__approximation_8cpp_source.html#l00027">scalar_check_approximation.cpp:27</a></div></div>
<div class="ttc" id="ashallow__wave_8cpp_html_ac1bb4bfd31a408c2fed3ca69bcad99fc"><div class="ttname"><a href="shallow__wave_8cpp.html#ac1bb4bfd31a408c2fed3ca69bcad99fc">m</a></div><div class="ttdeci">FTensor::Index&lt; 'm', 3 &gt; m</div><div class="ttdef"><b>Definition</b> <a href="shallow__wave_8cpp_source.html#l00080">shallow_wave.cpp:80</a></div></div>
<div class="ttc" id="astruct_data_at_integration_pts_html"><div class="ttname"><a href="struct_data_at_integration_pts.html">DataAtIntegrationPts</a></div><div class="ttdef"><b>Definition</b> <a href="_elasticity_mixed_formulation_8hpp_source.html#l00020">ElasticityMixedFormulation.hpp:20</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_1_1_set_up_schur_html_a6eb28d3a5bfe67448e57dd15eaee5318"><div class="ttname"><a href="struct_eshelbian_core_1_1_set_up_schur.html#a6eb28d3a5bfe67448e57dd15eaee5318">EshelbianCore::SetUpSchur::createSetUpSchur</a></div><div class="ttdeci">static boost::shared_ptr&lt; SetUpSchur &gt; createSetUpSchur(MoFEM::Interface &amp;m_field, EshelbianCore *ep_core_ptr)</div><div class="ttdef"><b>Definition</b> <a href="_set_up_schur_impl_8cpp_source.html#l00573">SetUpSchurImpl.cpp:573</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html"><div class="ttname"><a href="struct_eshelbian_core.html">EshelbianCore</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00012">EshelbianCore.hpp:12</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a0529d7544a0444bc591f0a52e00cd551"><div class="ttname"><a href="struct_eshelbian_core.html#a0529d7544a0444bc591f0a52e00cd551">EshelbianCore::alphaW</a></div><div class="ttdeci">double alphaW</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00127">EshelbianCore.hpp:127</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a085b68a8c557803c873d7cdc6a796cc3"><div class="ttname"><a href="struct_eshelbian_core.html#a085b68a8c557803c873d7cdc6a796cc3">EshelbianCore::alphaRho</a></div><div class="ttdeci">double alphaRho</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00129">EshelbianCore.hpp:129</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a086c46eedf160d647dd5261161545ed4"><div class="ttname"><a href="struct_eshelbian_core.html#a086c46eedf160d647dd5261161545ed4">EshelbianCore::setElasticElementOps</a></div><div class="ttdeci">MoFEMErrorCode setElasticElementOps(const int tag)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a0c39ec57ae27dba1a6fe02b45d971d68"><div class="ttname"><a href="struct_eshelbian_core.html#a0c39ec57ae27dba1a6fe02b45d971d68">EshelbianCore::addVolumeFiniteElement</a></div><div class="ttdeci">MoFEMErrorCode addVolumeFiniteElement(const EntityHandle meshset=0)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a0ccbbae7b9f76b00b39760756c85ca7b"><div class="ttname"><a href="struct_eshelbian_core.html#a0ccbbae7b9f76b00b39760756c85ca7b">EshelbianCore::addFields</a></div><div class="ttdeci">MoFEMErrorCode addFields(const EntityHandle meshset=0)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a0ce204135f6840cd235ce7f1cde1ca11"><div class="ttname"><a href="struct_eshelbian_core.html#a0ce204135f6840cd235ce7f1cde1ca11">EshelbianCore::materialSkeletonFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; materialSkeletonFaces</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00288">EshelbianCore.hpp:288</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a0fa131247db161516b235b0a567300ad"><div class="ttname"><a href="struct_eshelbian_core.html#a0fa131247db161516b235b0a567300ad">EshelbianCore::stretchSelector</a></div><div class="ttdeci">static enum StretchSelector stretchSelector</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00017">EshelbianCore.hpp:17</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a10755de9e354c68d35fbaa4df6721cc4"><div class="ttname"><a href="struct_eshelbian_core.html#a10755de9e354c68d35fbaa4df6721cc4">EshelbianCore::frontAdjEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontAdjEdges</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00285">EshelbianCore.hpp:285</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a113994efe4dd1803d84aeab5c6230096"><div class="ttname"><a href="struct_eshelbian_core.html#a113994efe4dd1803d84aeab5c6230096">EshelbianCore::createCrackSurfaceMeshset</a></div><div class="ttdeci">MoFEMErrorCode createCrackSurfaceMeshset()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a14d44e8866e1201657b06ce8d1d82206"><div class="ttname"><a href="struct_eshelbian_core.html#a14d44e8866e1201657b06ce8d1d82206">EshelbianCore::addBoundaryFiniteElement</a></div><div class="ttdeci">MoFEMErrorCode addBoundaryFiniteElement(const EntityHandle meshset=0)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a15ab431478033e2a923274d52611f715"><div class="ttname"><a href="struct_eshelbian_core.html#a15ab431478033e2a923274d52611f715">EshelbianCore::skeletonElement</a></div><div class="ttdeci">const std::string skeletonElement</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00115">EshelbianCore.hpp:115</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a1b2cd0d3b7edf33d32a29531faff5d43"><div class="ttname"><a href="struct_eshelbian_core.html#a1b2cd0d3b7edf33d32a29531faff5d43">EshelbianCore::inv_f_linear</a></div><div class="ttdeci">static double inv_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00070">EshelbianCore.hpp:70</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a1d8cc6e9d9b36b23f91a57c9d5a371ff"><div class="ttname"><a href="struct_eshelbian_core.html#a1d8cc6e9d9b36b23f91a57c9d5a371ff">EshelbianCore::contactFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; contactFaces</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00282">EshelbianCore.hpp:282</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a211ebd365f858409286dbe3a973daead"><div class="ttname"><a href="struct_eshelbian_core.html#a211ebd365f858409286dbe3a973daead">EshelbianCore::dynamicTime</a></div><div class="ttdeci">static double dynamicTime</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00023">EshelbianCore.hpp:23</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a227e7b13b2bd905c1803d2bc65eacf82"><div class="ttname"><a href="struct_eshelbian_core.html#a227e7b13b2bd905c1803d2bc65eacf82">EshelbianCore::dd_f_log</a></div><div class="ttdeci">static double dd_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00051">EshelbianCore.hpp:51</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a2363fb172da13a753995b83e0555f565"><div class="ttname"><a href="struct_eshelbian_core.html#a2363fb172da13a753995b83e0555f565">EshelbianCore::bitAdjEnt</a></div><div class="ttdeci">BitRefLevel bitAdjEnt</div><div class="ttdoc">bit ref level for parent</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00296">EshelbianCore.hpp:296</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a243cf95e3c9987fef696e3c5547995e3"><div class="ttname"><a href="struct_eshelbian_core.html#a243cf95e3c9987fef696e3c5547995e3">EshelbianCore::mField</a></div><div class="ttdeci">MoFEM::Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00083">EshelbianCore.hpp:83</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a268e2c36941c7d4d519030d525750b15"><div class="ttname"><a href="struct_eshelbian_core.html#a268e2c36941c7d4d519030d525750b15">EshelbianCore::spatialL2Disp</a></div><div class="ttdeci">const std::string spatialL2Disp</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00101">EshelbianCore.hpp:101</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a2767660e68cb6e73ceaf90c95670cc4d"><div class="ttname"><a href="struct_eshelbian_core.html#a2767660e68cb6e73ceaf90c95670cc4d">EshelbianCore::inv_d_f_log</a></div><div class="ttdeci">static double inv_d_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00059">EshelbianCore.hpp:59</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a28419be22dbaad69b585370d6ae66215"><div class="ttname"><a href="struct_eshelbian_core.html#a28419be22dbaad69b585370d6ae66215">EshelbianCore::postProcessSkeletonResults</a></div><div class="ttdeci">MoFEMErrorCode postProcessSkeletonResults(const int tag, const std::string file, Vec f_residual=PETSC_NULL)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a2975cb8401f36e568b72eb027375fe40"><div class="ttname"><a href="struct_eshelbian_core.html#a2975cb8401f36e568b72eb027375fe40">EshelbianCore::materialOrder</a></div><div class="ttdeci">int materialOrder</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00125">EshelbianCore.hpp:125</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a2ab70613ca1c05f21fc1092acf0b0585"><div class="ttname"><a href="struct_eshelbian_core.html#a2ab70613ca1c05f21fc1092acf0b0585">EshelbianCore::l2UserBaseScale</a></div><div class="ttdeci">static PetscBool l2UserBaseScale</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00027">EshelbianCore.hpp:27</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a2cba5b9f29b7035eaa04f7cf24bb0e01"><div class="ttname"><a href="struct_eshelbian_core.html#a2cba5b9f29b7035eaa04f7cf24bb0e01">EshelbianCore::dM</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dM</div><div class="ttdoc">Coupled problem all fields.</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00094">EshelbianCore.hpp:94</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a2d854849515a43de7542231c5dc29570"><div class="ttname"><a href="struct_eshelbian_core.html#a2d854849515a43de7542231c5dc29570">EshelbianCore::elasticBcRhs</a></div><div class="ttdeci">boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; elasticBcRhs</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00091">EshelbianCore.hpp:91</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a33a23a7598af848601fa49a1eb8554a0"><div class="ttname"><a href="struct_eshelbian_core.html#a33a23a7598af848601fa49a1eb8554a0">EshelbianCore::projectGeometry</a></div><div class="ttdeci">MoFEMErrorCode projectGeometry(const EntityHandle meshset=0)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a3bc0c136f40a18991a5f1aca01b5bd20"><div class="ttname"><a href="struct_eshelbian_core.html#a3bc0c136f40a18991a5f1aca01b5bd20">EshelbianCore::materialH1Positions</a></div><div class="ttdeci">const std::string materialH1Positions</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00104">EshelbianCore.hpp:104</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a3e38767261f39bd323b727fd31959284"><div class="ttname"><a href="struct_eshelbian_core.html#a3e38767261f39bd323b727fd31959284">EshelbianCore::setBlockTagsOnSkin</a></div><div class="ttdeci">MoFEMErrorCode setBlockTagsOnSkin()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a3f4520cca364a7edbf442bb09054566b"><div class="ttname"><a href="struct_eshelbian_core.html#a3f4520cca364a7edbf442bb09054566b">EshelbianCore::listTagsToTransfer</a></div><div class="ttdeci">std::vector&lt; Tag &gt; listTagsToTransfer</div><div class="ttdoc">list of tags to transfer to postprocessor</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00308">EshelbianCore.hpp:308</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a3fa759a191f5c61035bc28d824acea64"><div class="ttname"><a href="struct_eshelbian_core.html#a3fa759a191f5c61035bc28d824acea64">EshelbianCore::elasticBcLhs</a></div><div class="ttdeci">boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; elasticBcLhs</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00090">EshelbianCore.hpp:90</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a41356565364f05177e0256f536e42603"><div class="ttname"><a href="struct_eshelbian_core.html#a41356565364f05177e0256f536e42603">EshelbianCore::crackingOn</a></div><div class="ttdeci">static PetscBool crackingOn</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00022">EshelbianCore.hpp:22</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a44780924071e102fcb49da8bc01637e8"><div class="ttname"><a href="struct_eshelbian_core.html#a44780924071e102fcb49da8bc01637e8">EshelbianCore::getTractionFreeBc</a></div><div class="ttdeci">MoFEMErrorCode getTractionFreeBc(const EntityHandle meshset, boost::shared_ptr&lt; TractionFreeBc &gt; &amp;bc_ptr, const std::string contact_set_name)</div><div class="ttdoc">Remove all, but entities where kinematic constrains are applied.</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a4530aa6762e72237e130380c7ce2ba86"><div class="ttname"><a href="struct_eshelbian_core.html#a4530aa6762e72237e130380c7ce2ba86">EshelbianCore::setBaseVolumeElementOps</a></div><div class="ttdeci">MoFEMErrorCode setBaseVolumeElementOps(const int tag, const bool do_rhs, const bool do_lhs, const bool calc_rates, SmartPetscObj&lt; Vec &gt; ver_vec, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; fe)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a4cd3e5bf9787574d458637416d6a06a4"><div class="ttname"><a href="struct_eshelbian_core.html#a4cd3e5bf9787574d458637416d6a06a4">EshelbianCore::eshelbyStress</a></div><div class="ttdeci">const std::string eshelbyStress</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00100">EshelbianCore.hpp:100</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a4dec43826084d833c9058b02f8f8706c"><div class="ttname"><a href="struct_eshelbian_core.html#a4dec43826084d833c9058b02f8f8706c">EshelbianCore::materialVolumeElement</a></div><div class="ttdeci">const std::string materialVolumeElement</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00117">EshelbianCore.hpp:117</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a4e79454d5317f6599db6f06305d2ac3b"><div class="ttname"><a href="struct_eshelbian_core.html#a4e79454d5317f6599db6f06305d2ac3b">EshelbianCore::elasticFeRhs</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; elasticFeRhs</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00088">EshelbianCore.hpp:88</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a4ed1752ba8de143ae8e6733d8713adf5"><div class="ttname"><a href="struct_eshelbian_core.html#a4ed1752ba8de143ae8e6733d8713adf5">EshelbianCore::dynamicStep</a></div><div class="ttdeci">static int dynamicStep</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00025">EshelbianCore.hpp:25</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a4fa3cc82efef2655314eaecdaed879dc"><div class="ttname"><a href="struct_eshelbian_core.html#a4fa3cc82efef2655314eaecdaed879dc">EshelbianCore::elementVolumeName</a></div><div class="ttdeci">const std::string elementVolumeName</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00112">EshelbianCore.hpp:112</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a50a7cd87dab88c005a77cc1843141fa7"><div class="ttname"><a href="struct_eshelbian_core.html#a50a7cd87dab88c005a77cc1843141fa7">EshelbianCore::dd_f_log_e</a></div><div class="ttdeci">static double dd_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00040">EshelbianCore.hpp:40</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a5246a7a72fbbc8943410a3de2b95647b"><div class="ttname"><a href="struct_eshelbian_core.html#a5246a7a72fbbc8943410a3de2b95647b">EshelbianCore::rotSelector</a></div><div class="ttdeci">static enum RotSelector rotSelector</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00015">EshelbianCore.hpp:15</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a54c8137ebc1f4abc27e14b7098aa05a6"><div class="ttname"><a href="struct_eshelbian_core.html#a54c8137ebc1f4abc27e14b7098aa05a6">EshelbianCore::gradApproximator</a></div><div class="ttdeci">static enum RotSelector gradApproximator</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00016">EshelbianCore.hpp:16</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a56636af14eb66349e0d1fce731e9206e"><div class="ttname"><a href="struct_eshelbian_core.html#a56636af14eb66349e0d1fce731e9206e">EshelbianCore::getBc</a></div><div class="ttdeci">MoFEMErrorCode getBc(boost::shared_ptr&lt; BC &gt; &amp;bc_vec_ptr, const std::string block_name, const int nb_attributes)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00142">EshelbianCore.hpp:142</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a59364cd43d5094f0921953a4ab320c7f"><div class="ttname"><a href="struct_eshelbian_core.html#a59364cd43d5094f0921953a4ab320c7f">EshelbianCore::vertexExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector vertexExchange</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00305">EshelbianCore.hpp:305</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a5b883dfed933920248c7e23bf940d6e0"><div class="ttname"><a href="struct_eshelbian_core.html#a5b883dfed933920248c7e23bf940d6e0">EshelbianCore::bcSpatialRotationVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; BcRotVec &gt; bcSpatialRotationVecPtr</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00137">EshelbianCore.hpp:137</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a5d5c5ee0702329b9063b5e2c1ab13979"><div class="ttname"><a href="struct_eshelbian_core.html#a5d5c5ee0702329b9063b5e2c1ab13979">EshelbianCore::dynamicRelaxation</a></div><div class="ttdeci">static PetscBool dynamicRelaxation</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00020">EshelbianCore.hpp:20</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a605912e3d5afe677979a5504184ef21f"><div class="ttname"><a href="struct_eshelbian_core.html#a605912e3d5afe677979a5504184ef21f">EshelbianCore::materialSkeletonElement</a></div><div class="ttdeci">const std::string materialSkeletonElement</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00118">EshelbianCore.hpp:118</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a624aed4afbee14e9087456a050c48387"><div class="ttname"><a href="struct_eshelbian_core.html#a624aed4afbee14e9087456a050c48387">EshelbianCore::spatialH1Disp</a></div><div class="ttdeci">const std::string spatialH1Disp</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00103">EshelbianCore.hpp:103</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a64e2ddd4583aa15ef34929b7c16f6abf"><div class="ttname"><a href="struct_eshelbian_core.html#a64e2ddd4583aa15ef34929b7c16f6abf">EshelbianCore::solveElastic</a></div><div class="ttdeci">MoFEMErrorCode solveElastic(TS ts, Vec x)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a6591b5a3838e0c8dc4452ec9924f1eeb"><div class="ttname"><a href="struct_eshelbian_core.html#a6591b5a3838e0c8dc4452ec9924f1eeb">EshelbianCore::d_f_log</a></div><div class="ttdeci">static double d_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00048">EshelbianCore.hpp:48</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a6ce37c333084d7776612a9165edd487a"><div class="ttname"><a href="struct_eshelbian_core.html#a6ce37c333084d7776612a9165edd487a">EshelbianCore::getOptions</a></div><div class="ttdeci">MoFEMErrorCode getOptions()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a6f708350b49c1ae611628563edecb532"><div class="ttname"><a href="struct_eshelbian_core.html#a6f708350b49c1ae611628563edecb532">EshelbianCore::calculateEnergyRelease</a></div><div class="ttdeci">MoFEMErrorCode calculateEnergyRelease(const int tag, TS ts)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a70d5bde9f06329fff6c2c75ebcd55623"><div class="ttname"><a href="struct_eshelbian_core.html#a70d5bde9f06329fff6c2c75ebcd55623">EshelbianCore::piolaStress</a></div><div class="ttdeci">const std::string piolaStress</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00099">EshelbianCore.hpp:99</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a74019c5d29e41cf539cd905c55497f00"><div class="ttname"><a href="struct_eshelbian_core.html#a74019c5d29e41cf539cd905c55497f00">EshelbianCore::setElasticElementToTs</a></div><div class="ttdeci">MoFEMErrorCode setElasticElementToTs(DM dm)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a767ea904eb33f7f44cbdef68cfe7cdfc"><div class="ttname"><a href="struct_eshelbian_core.html#a767ea904eb33f7f44cbdef68cfe7cdfc">EshelbianCore::contactRefinementLevels</a></div><div class="ttdeci">int contactRefinementLevels</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00131">EshelbianCore.hpp:131</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a7980928dbcfa5bf174ac19e22784fe95"><div class="ttname"><a href="struct_eshelbian_core.html#a7980928dbcfa5bf174ac19e22784fe95">EshelbianCore::gettingNorms</a></div><div class="ttdeci">MoFEMErrorCode gettingNorms()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a7acb9f3d2fc946df28d0616ef12c28ab"><div class="ttname"><a href="struct_eshelbian_core.html#a7acb9f3d2fc946df28d0616ef12c28ab">EshelbianCore::hybridMaterialDisp</a></div><div class="ttdeci">const std::string hybridMaterialDisp</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00106">EshelbianCore.hpp:106</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a7cd6409c576d393175207b84e0fcb8c9"><div class="ttname"><a href="struct_eshelbian_core.html#a7cd6409c576d393175207b84e0fcb8c9">EshelbianCore::spaceOrder</a></div><div class="ttdeci">int spaceOrder</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00123">EshelbianCore.hpp:123</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a7e7a066d74bb6e8258720b709490e138"><div class="ttname"><a href="struct_eshelbian_core.html#a7e7a066d74bb6e8258720b709490e138">EshelbianCore::setVolumeElementOps</a></div><div class="ttdeci">MoFEMErrorCode setVolumeElementOps(const int tag, const bool add_elastic, const bool add_material, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; &amp;fe_rhs, boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; &amp;fe_lhs)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a820bda27c3f0993550839c0e34fa6fa5"><div class="ttname"><a href="struct_eshelbian_core.html#a820bda27c3f0993550839c0e34fa6fa5">EshelbianCore::bubbleField</a></div><div class="ttdeci">const std::string bubbleField</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00110">EshelbianCore.hpp:110</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a832337ab1645d6112dda0d6c0573088b"><div class="ttname"><a href="struct_eshelbian_core.html#a832337ab1645d6112dda0d6c0573088b">EshelbianCore::solveDynamicRelaxation</a></div><div class="ttdeci">MoFEMErrorCode solveDynamicRelaxation(TS ts, Vec x)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a872472e8bf68a52c384c7b1db5aaa084"><div class="ttname"><a href="struct_eshelbian_core.html#a872472e8bf68a52c384c7b1db5aaa084">EshelbianCore::alphaU</a></div><div class="ttdeci">double alphaU</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00126">EshelbianCore.hpp:126</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a8acc61f8b8b3e19a7a32e16f7eb1fa5b"><div class="ttname"><a href="struct_eshelbian_core.html#a8acc61f8b8b3e19a7a32e16f7eb1fa5b">EshelbianCore::calculateOrientation</a></div><div class="ttdeci">MoFEMErrorCode calculateOrientation(const int tag, bool set_orientation)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a8b49e02a24c217a6abc9df5ca4bd7330"><div class="ttname"><a href="struct_eshelbian_core.html#a8b49e02a24c217a6abc9df5ca4bd7330">EshelbianCore::inv_f_log</a></div><div class="ttdeci">static double inv_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00056">EshelbianCore.hpp:56</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a8b6bd30743f5710ddc93c0e003734bcf"><div class="ttname"><a href="struct_eshelbian_core.html#a8b6bd30743f5710ddc93c0e003734bcf">EshelbianCore::elasticFeLhs</a></div><div class="ttdeci">boost::shared_ptr&lt; VolumeElementForcesAndSourcesCore &gt; elasticFeLhs</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00089">EshelbianCore.hpp:89</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a8bf2c044ba26ef8bd7312338957d1aff"><div class="ttname"><a href="struct_eshelbian_core.html#a8bf2c044ba26ef8bd7312338957d1aff">EshelbianCore::noStretch</a></div><div class="ttdeci">static PetscBool noStretch</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00018">EshelbianCore.hpp:18</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a90305e24905e60449369cef8928bda5e"><div class="ttname"><a href="struct_eshelbian_core.html#a90305e24905e60449369cef8928bda5e">EshelbianCore::setNewFrontCoordinates</a></div><div class="ttdeci">MoFEMErrorCode setNewFrontCoordinates()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a912ebbcc505570f26b497c1a788c49c0"><div class="ttname"><a href="struct_eshelbian_core.html#a912ebbcc505570f26b497c1a788c49c0">EshelbianCore::parentAdjSkeletonFunctionDim2</a></div><div class="ttdeci">boost::shared_ptr&lt; ParentFiniteElementAdjacencyFunctionSkeleton&lt; 2 &gt; &gt; parentAdjSkeletonFunctionDim2</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00291">EshelbianCore.hpp:291</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a936e33bf8856af5e152b56abaa83a8e1"><div class="ttname"><a href="struct_eshelbian_core.html#a936e33bf8856af5e152b56abaa83a8e1">EshelbianCore::contactTreeRhs</a></div><div class="ttdeci">boost::shared_ptr&lt; ContactTree &gt; contactTreeRhs</div><div class="ttdoc">Make a contact tree.</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00092">EshelbianCore.hpp:92</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a96ee7d95b3ebb53145897b2ad6f3af2c"><div class="ttname"><a href="struct_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianCore::exponentBase</a></div><div class="ttdeci">static double exponentBase</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00030">EshelbianCore.hpp:30</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a973fec6048052976e4167d61468443fb"><div class="ttname"><a href="struct_eshelbian_core.html#a973fec6048052976e4167d61468443fb">EshelbianCore::setContactElementRhsOps</a></div><div class="ttdeci">MoFEMErrorCode setContactElementRhsOps(boost::shared_ptr&lt; ContactTree &gt; &amp;fe_contact_tree)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a98338d042e94f47e4b0cc5a6e4ede06f"><div class="ttname"><a href="struct_eshelbian_core.html#a98338d042e94f47e4b0cc5a6e4ede06f">EshelbianCore::dd_f_linear</a></div><div class="ttdeci">static double dd_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00068">EshelbianCore.hpp:68</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_a99a3132d0ad53b6ca41822303148d2d6"><div class="ttname"><a href="struct_eshelbian_core.html#a99a3132d0ad53b6ca41822303148d2d6">EshelbianCore::setFaceElementOps</a></div><div class="ttdeci">MoFEMErrorCode setFaceElementOps(const bool add_elastic, const bool add_material, boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; &amp;fe_rhs, boost::shared_ptr&lt; FaceElementForcesAndSourcesCore &gt; &amp;fe_lhs)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aa0a8e2aa21e3ed0d300b23df2b768ed3"><div class="ttname"><a href="struct_eshelbian_core.html#aa0a8e2aa21e3ed0d300b23df2b768ed3">EshelbianCore::d_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; d_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00032">EshelbianCore.hpp:32</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aa1d0ed0c1c01316acde2753c3c1f0733"><div class="ttname"><a href="struct_eshelbian_core.html#aa1d0ed0c1c01316acde2753c3c1f0733">EshelbianCore::spaceH1Order</a></div><div class="ttdeci">int spaceH1Order</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00124">EshelbianCore.hpp:124</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aa2f4d1f9bac948fedcaebe1712299295"><div class="ttname"><a href="struct_eshelbian_core.html#aa2f4d1f9bac948fedcaebe1712299295">EshelbianCore::bcSpatialFreeTraction</a></div><div class="ttdeci">boost::shared_ptr&lt; TractionFreeBc &gt; bcSpatialFreeTraction</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00139">EshelbianCore.hpp:139</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aa5f11b90ad8c461a7dadf74478653104"><div class="ttname"><a href="struct_eshelbian_core.html#aa5f11b90ad8c461a7dadf74478653104">EshelbianCore::skeletonFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; skeletonFaces</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00287">EshelbianCore.hpp:287</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aa69db0ae4b4608a3cd24d92e0191cad0"><div class="ttname"><a href="struct_eshelbian_core.html#aa69db0ae4b4608a3cd24d92e0191cad0">EshelbianCore::physicalEquations</a></div><div class="ttdeci">boost::shared_ptr&lt; PhysicalEquations &gt; physicalEquations</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00086">EshelbianCore.hpp:86</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aa9605a44e464139d163e27e9398e3de4"><div class="ttname"><a href="struct_eshelbian_core.html#aa9605a44e464139d163e27e9398e3de4">EshelbianCore::f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00031">EshelbianCore.hpp:31</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aaa49e9f07f0027b8905bec41e11cabb5"><div class="ttname"><a href="struct_eshelbian_core.html#aaa49e9f07f0027b8905bec41e11cabb5">EshelbianCore::rotAxis</a></div><div class="ttdeci">const std::string rotAxis</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00109">EshelbianCore.hpp:109</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aae203dfeaee5453b2400a66b729b7005"><div class="ttname"><a href="struct_eshelbian_core.html#aae203dfeaee5453b2400a66b729b7005">EshelbianCore::inv_d_f_linear</a></div><div class="ttdeci">static double inv_d_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00071">EshelbianCore.hpp:71</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aaf238d1b79dcea860e0648463d07e698"><div class="ttname"><a href="struct_eshelbian_core.html#aaf238d1b79dcea860e0648463d07e698">EshelbianCore::bitAdjParentMask</a></div><div class="ttdeci">BitRefLevel bitAdjParentMask</div><div class="ttdoc">bit ref level for parent parent</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00294">EshelbianCore.hpp:294</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aafaa9cff0830a9a3e5e5cb00c072b47d"><div class="ttname"><a href="struct_eshelbian_core.html#aafaa9cff0830a9a3e5e5cb00c072b47d">EshelbianCore::inv_dd_f_log</a></div><div class="ttdeci">static double inv_dd_f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00062">EshelbianCore.hpp:62</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aafc4229f9ca50146bbb5d7d51c7482ef"><div class="ttname"><a href="struct_eshelbian_core.html#aafc4229f9ca50146bbb5d7d51c7482ef">EshelbianCore::contactDisp</a></div><div class="ttdeci">const std::string contactDisp</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00107">EshelbianCore.hpp:107</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab0f304517b059efe9c099a16f8c96bc4"><div class="ttname"><a href="struct_eshelbian_core.html#ab0f304517b059efe9c099a16f8c96bc4">EshelbianCore::symmetrySelector</a></div><div class="ttdeci">static enum SymmetrySelector symmetrySelector</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00014">EshelbianCore.hpp:14</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab1bb40274b0b343f49fc45bc2d3de293"><div class="ttname"><a href="struct_eshelbian_core.html#ab1bb40274b0b343f49fc45bc2d3de293">EshelbianCore::edgeExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector edgeExchange</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00304">EshelbianCore.hpp:304</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab3a74e8bad817899b61feff3720d6243"><div class="ttname"><a href="struct_eshelbian_core.html#ab3a74e8bad817899b61feff3720d6243">EshelbianCore::dmPrjSpatial</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dmPrjSpatial</div><div class="ttdoc">Projection spatial displacement.</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00097">EshelbianCore.hpp:97</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab3b94154522357001e15c95e93a32537"><div class="ttname"><a href="struct_eshelbian_core.html#ab3b94154522357001e15c95e93a32537">EshelbianCore::inv_d_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_d_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00035">EshelbianCore.hpp:35</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab71b3402dafb45b0d6d87cbea4dc3200"><div class="ttname"><a href="struct_eshelbian_core.html#ab71b3402dafb45b0d6d87cbea4dc3200">EshelbianCore::bcSpatialDispVecPtr</a></div><div class="ttdeci">boost::shared_ptr&lt; BcDispVec &gt; bcSpatialDispVecPtr</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00136">EshelbianCore.hpp:136</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab74eed1af3e5f8a2e392f1206a4857c7"><div class="ttname"><a href="struct_eshelbian_core.html#ab74eed1af3e5f8a2e392f1206a4857c7">EshelbianCore::inv_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00034">EshelbianCore.hpp:34</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab80783a2910e61c39f8e09c389ebce28"><div class="ttname"><a href="struct_eshelbian_core.html#ab80783a2910e61c39f8e09c389ebce28">EshelbianCore::skinElement</a></div><div class="ttdeci">const std::string skinElement</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00114">EshelbianCore.hpp:114</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab814ca256ebc02aa6c05c16ea01b3a0e"><div class="ttname"><a href="struct_eshelbian_core.html#ab814ca256ebc02aa6c05c16ea01b3a0e">EshelbianCore::bcSpatialTraction</a></div><div class="ttdeci">boost::shared_ptr&lt; TractionBcVec &gt; bcSpatialTraction</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00138">EshelbianCore.hpp:138</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ab8a03cc8007a0a926b9387941141303f"><div class="ttname"><a href="struct_eshelbian_core.html#ab8a03cc8007a0a926b9387941141303f">EshelbianCore::inv_dd_f_linear</a></div><div class="ttdeci">static double inv_dd_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00072">EshelbianCore.hpp:72</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_abe81e33c3abf7e604dfafb99cac6eca4"><div class="ttname"><a href="struct_eshelbian_core.html#abe81e33c3abf7e604dfafb99cac6eca4">EshelbianCore::getSpatialTractionBc</a></div><div class="ttdeci">MoFEMErrorCode getSpatialTractionBc()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_abfb627d240daa3e65a6c556d486c3775"><div class="ttname"><a href="struct_eshelbian_core.html#abfb627d240daa3e65a6c556d486c3775">EshelbianCore::setSingularity</a></div><div class="ttdeci">static PetscBool setSingularity</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00019">EshelbianCore.hpp:19</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_abfe3b15fb8e48c579531e64684a2ecdc"><div class="ttname"><a href="struct_eshelbian_core.html#abfe3b15fb8e48c579531e64684a2ecdc">EshelbianCore::frontLayers</a></div><div class="ttdeci">int frontLayers</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00132">EshelbianCore.hpp:132</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ac1cb92ee0356ce898bfecc6c30a83b87"><div class="ttname"><a href="struct_eshelbian_core.html#ac1cb92ee0356ce898bfecc6c30a83b87">EshelbianCore::d_f_log_e</a></div><div class="ttdeci">static double d_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00039">EshelbianCore.hpp:39</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ac6f12eded8044632f771b705c1b1d6a3"><div class="ttname"><a href="struct_eshelbian_core.html#ac6f12eded8044632f771b705c1b1d6a3">EshelbianCore::materialL2Disp</a></div><div class="ttdeci">const std::string materialL2Disp</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00102">EshelbianCore.hpp:102</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ac9225b726d868b3097e7fc41be2b3acc"><div class="ttname"><a href="struct_eshelbian_core.html#ac9225b726d868b3097e7fc41be2b3acc">EshelbianCore::addDMs</a></div><div class="ttdeci">MoFEMErrorCode addDMs(const BitRefLevel bit=BitRefLevel().set(0), const EntityHandle meshset=0)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ac9603548235b69643ca7b25eebbf7382"><div class="ttname"><a href="struct_eshelbian_core.html#ac9603548235b69643ca7b25eebbf7382">EshelbianCore::alphaOmega</a></div><div class="ttdeci">double alphaOmega</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00128">EshelbianCore.hpp:128</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_acd3d79e5922a80cab13f88ff96518c2a"><div class="ttname"><a href="struct_eshelbian_core.html#acd3d79e5922a80cab13f88ff96518c2a">EshelbianCore::getSpatialDispBc</a></div><div class="ttdeci">MoFEMErrorCode getSpatialDispBc()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_acdf2dd025fc4286ff5719a079c2e61ac"><div class="ttname"><a href="struct_eshelbian_core.html#acdf2dd025fc4286ff5719a079c2e61ac">EshelbianCore::bitAdjParent</a></div><div class="ttdeci">BitRefLevel bitAdjParent</div><div class="ttdoc">bit ref level for parent</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00293">EshelbianCore.hpp:293</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ad481b72d51e6377015a74f929bc6a672"><div class="ttname"><a href="struct_eshelbian_core.html#ad481b72d51e6377015a74f929bc6a672">EshelbianCore::volumeExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector volumeExchange</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00302">EshelbianCore.hpp:302</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ad4d96dc6ab5dd848b7d8eebf1a08030b"><div class="ttname"><a href="struct_eshelbian_core.html#ad4d96dc6ab5dd848b7d8eebf1a08030b">EshelbianCore::saveOrgCoords</a></div><div class="ttdeci">MoFEMErrorCode saveOrgCoords()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ad555ca904803947040a57fd7f056de86"><div class="ttname"><a href="struct_eshelbian_core.html#ad555ca904803947040a57fd7f056de86">EshelbianCore::naturalBcElement</a></div><div class="ttdeci">const std::string naturalBcElement</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00113">EshelbianCore.hpp:113</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_add1f886aa91291dceb3477c20f8b9f47"><div class="ttname"><a href="struct_eshelbian_core.html#add1f886aa91291dceb3477c20f8b9f47">EshelbianCore::addCrackSurfaces</a></div><div class="ttdeci">MoFEMErrorCode addCrackSurfaces()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_add41a67a6d5f76559b0657f214048e8c"><div class="ttname"><a href="struct_eshelbian_core.html#add41a67a6d5f76559b0657f214048e8c">EshelbianCore::f_log_e</a></div><div class="ttdeci">static double f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00038">EshelbianCore.hpp:38</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ade8d241d9d55fac1ca2740756a1bc1bd"><div class="ttname"><a href="struct_eshelbian_core.html#ade8d241d9d55fac1ca2740756a1bc1bd">EshelbianCore::~EshelbianCore</a></div><div class="ttdeci">virtual ~EshelbianCore()</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_adf7e1000f83af8932625eacd97fcf29b"><div class="ttname"><a href="struct_eshelbian_core.html#adf7e1000f83af8932625eacd97fcf29b">EshelbianCore::addCrackMeshsetId</a></div><div class="ttdeci">static int addCrackMeshsetId</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00028">EshelbianCore.hpp:28</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ae1b21da25a876c11c40d9878f299c8a3"><div class="ttname"><a href="struct_eshelbian_core.html#ae1b21da25a876c11c40d9878f299c8a3">EshelbianCore::createExchangeVectors</a></div><div class="ttdeci">MoFEMErrorCode createExchangeVectors(Sev sev)</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ae29198561959eabf72440debf723bf03"><div class="ttname"><a href="struct_eshelbian_core.html#ae29198561959eabf72440debf723bf03">EshelbianCore::dataAtPts</a></div><div class="ttdeci">boost::shared_ptr&lt; DataAtIntegrationPts &gt; dataAtPts</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00085">EshelbianCore.hpp:85</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ae30a1bd4e4b24d06251fae84c4922978"><div class="ttname"><a href="struct_eshelbian_core.html#ae30a1bd4e4b24d06251fae84c4922978">EshelbianCore::crackFaces</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; crackFaces</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00283">EshelbianCore.hpp:283</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_ae7f8e5ee2904085fee03a8f784b71901"><div class="ttname"><a href="struct_eshelbian_core.html#ae7f8e5ee2904085fee03a8f784b71901">EshelbianCore::frontVertices</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontVertices</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00286">EshelbianCore.hpp:286</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aeb84ef335d710054abe0411d4672d3eb"><div class="ttname"><a href="struct_eshelbian_core.html#aeb84ef335d710054abe0411d4672d3eb">EshelbianCore::d_f_linear</a></div><div class="ttdeci">static double d_f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00067">EshelbianCore.hpp:67</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aec476e20bd019e3cb5d0d1584518e31c"><div class="ttname"><a href="struct_eshelbian_core.html#aec476e20bd019e3cb5d0d1584518e31c">EshelbianCore::hybridSpatialDisp</a></div><div class="ttdeci">const std::string hybridSpatialDisp</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00105">EshelbianCore.hpp:105</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aec7eec34db87d222944bbaf74cf7c0f3"><div class="ttname"><a href="struct_eshelbian_core.html#aec7eec34db87d222944bbaf74cf7c0f3">EshelbianCore::solTSStep</a></div><div class="ttdeci">SmartPetscObj&lt; Vec &gt; solTSStep</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00300">EshelbianCore.hpp:300</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aec89ac53f8bdf554768e788c8aa48282"><div class="ttname"><a href="struct_eshelbian_core.html#aec89ac53f8bdf554768e788c8aa48282">EshelbianCore::f_log</a></div><div class="ttdeci">static double f_log(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00045">EshelbianCore.hpp:45</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_aed90af306007a2750053f12415168c7e"><div class="ttname"><a href="struct_eshelbian_core.html#aed90af306007a2750053f12415168c7e">EshelbianCore::faceExchange</a></div><div class="ttdeci">CommInterface::EntitiesPetscVector faceExchange</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00303">EshelbianCore.hpp:303</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af24d4b3e9aa4f578300ee454fe66fe9e"><div class="ttname"><a href="struct_eshelbian_core.html#af24d4b3e9aa4f578300ee454fe66fe9e">EshelbianCore::dmElastic</a></div><div class="ttdeci">SmartPetscObj&lt; DM &gt; dmElastic</div><div class="ttdoc">Elastic problem.</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00095">EshelbianCore.hpp:95</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af3b85cda0efd198ed74405e0a55c5ae2"><div class="ttname"><a href="struct_eshelbian_core.html#af3b85cda0efd198ed74405e0a55c5ae2">EshelbianCore::inv_dd_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_dd_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00036">EshelbianCore.hpp:36</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af61a919de6b8c2c847562e9dc864db72"><div class="ttname"><a href="struct_eshelbian_core.html#af61a919de6b8c2c847562e9dc864db72">EshelbianCore::frontEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontEdges</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00284">EshelbianCore.hpp:284</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af6c7c52dde40c4a5f90afda29a7dad8f"><div class="ttname"><a href="struct_eshelbian_core.html#af6c7c52dde40c4a5f90afda29a7dad8f">EshelbianCore::postProcessResults</a></div><div class="ttdeci">MoFEMErrorCode postProcessResults(const int tag, const std::string file, Vec f_residual=PETSC_NULL, Vec var_vec=PETSC_NULL, std::vector&lt; Tag &gt; tags_to_transfer={})</div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af6d348cacae8133fa2001387610b936c"><div class="ttname"><a href="struct_eshelbian_core.html#af6d348cacae8133fa2001387610b936c">EshelbianCore::dd_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; dd_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00033">EshelbianCore.hpp:33</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af7fd8cd195c5edee463761f2c8e785b1"><div class="ttname"><a href="struct_eshelbian_core.html#af7fd8cd195c5edee463761f2c8e785b1">EshelbianCore::stretchTensor</a></div><div class="ttdeci">const std::string stretchTensor</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00108">EshelbianCore.hpp:108</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_af87b5b277e9ed4a79838f7a04bf7c36f"><div class="ttname"><a href="struct_eshelbian_core.html#af87b5b277e9ed4a79838f7a04bf7c36f">EshelbianCore::bitAdjEntMask</a></div><div class="ttdeci">BitRefLevel bitAdjEntMask</div><div class="ttdoc">bit ref level for parent parent</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00297">EshelbianCore.hpp:297</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_afa60d86e456beaabddc2df730598719d"><div class="ttname"><a href="struct_eshelbian_core.html#afa60d86e456beaabddc2df730598719d">EshelbianCore::f_linear</a></div><div class="ttdeci">static double f_linear(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00066">EshelbianCore.hpp:66</a></div></div>
<div class="ttc" id="astruct_eshelbian_core_html_affca8de1319ab1c42f5a3fa6545996d7"><div class="ttname"><a href="struct_eshelbian_core.html#affca8de1319ab1c42f5a3fa6545996d7">EshelbianCore::contactElement</a></div><div class="ttdeci">const std::string contactElement</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_core_8hpp_source.html#l00116">EshelbianCore.hpp:116</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_add_h_o_ops_html"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_add_h_o_ops.html">EshelbianPlasticity::AddHOOps</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00598">EshelbianPlasticity.hpp:598</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_dynamic_relaxation_time_scale_html_ac2f9d0f0316d04466a9de44dceeeb0d2"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_dynamic_relaxation_time_scale.html#ac2f9d0f0316d04466a9de44dceeeb0d2">EshelbianPlasticity::DynamicRelaxationTimeScale::getScale</a></div><div class="ttdeci">double getScale(const double time) override</div><div class="ttdoc">Get scaling at given time.</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00386">EshelbianPlasticity.cpp:386</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a23fa1126c211ab3a7d43f3fa23d48dbb"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a23fa1126c211ab3a7d43f3fa23d48dbb">EshelbianPlasticity::EshelbianCore::inv_dd_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_dd_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00037">EshelbianPlasticity.hpp:37</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a374c8a768747b54ac4baddcdf32deeeb"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a374c8a768747b54ac4baddcdf32deeeb">EshelbianPlasticity::EshelbianCore::f_log_e</a></div><div class="ttdeci">static double f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00039">EshelbianPlasticity.hpp:39</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a57346b56a7ba2439fbcc44096f5efc6a"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a57346b56a7ba2439fbcc44096f5efc6a">EshelbianPlasticity::EshelbianCore::dynamicTime</a></div><div class="ttdeci">static double dynamicTime</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00024">EshelbianPlasticity.hpp:24</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a57ce234b76d335e73b56513c94b8e689"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a57ce234b76d335e73b56513c94b8e689">EshelbianPlasticity::EshelbianCore::inv_dd_f_log_e</a></div><div class="ttdeci">static double inv_dd_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00044">EshelbianPlasticity.hpp:44</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a57f3ade0a2bae3cf6a447c75864d50e0"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a57f3ade0a2bae3cf6a447c75864d50e0">EshelbianPlasticity::EshelbianCore::inv_d_f_log_e</a></div><div class="ttdeci">static double inv_d_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00043">EshelbianPlasticity.hpp:43</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a5d56beb53f302e471c3627a96733b9a0"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a5d56beb53f302e471c3627a96733b9a0">EshelbianPlasticity::EshelbianCore::setSingularity</a></div><div class="ttdeci">static PetscBool setSingularity</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00020">EshelbianPlasticity.hpp:20</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a68a9aa377549588728583769158e9c2b"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a68a9aa377549588728583769158e9c2b">EshelbianPlasticity::EshelbianCore::d_f_log_e</a></div><div class="ttdeci">static double d_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00040">EshelbianPlasticity.hpp:40</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a7ec2050d610e40a8a05a3dcabe0b40df"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a7ec2050d610e40a8a05a3dcabe0b40df">EshelbianPlasticity::EshelbianCore::query_interface</a></div><div class="ttdeci">MoFEMErrorCode query_interface(boost::typeindex::type_index type_index, UnknownInterface **iface) const</div><div class="ttdoc">Getting interface of core database.</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00922">EshelbianPlasticity.cpp:922</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_a96ee7d95b3ebb53145897b2ad6f3af2c"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#a96ee7d95b3ebb53145897b2ad6f3af2c">EshelbianPlasticity::EshelbianCore::exponentBase</a></div><div class="ttdeci">static double exponentBase</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00031">EshelbianPlasticity.hpp:31</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_ab45e7deb10ac286200a45b8ed18d46c0"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ab45e7deb10ac286200a45b8ed18d46c0">EshelbianPlasticity::EshelbianCore::f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00032">EshelbianPlasticity.hpp:32</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_ab52e3754dac2b60f6b1b3399ef3a1fcd"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ab52e3754dac2b60f6b1b3399ef3a1fcd">EshelbianPlasticity::EshelbianCore::dd_f_log_e</a></div><div class="ttdeci">static double dd_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00041">EshelbianPlasticity.hpp:41</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_add0b04f5998d17d579b7b5192cb1ccec"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#add0b04f5998d17d579b7b5192cb1ccec">EshelbianPlasticity::EshelbianCore::dd_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; dd_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00034">EshelbianPlasticity.hpp:34</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_ae4d99bb98048fba86b627784979fc1e3"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ae4d99bb98048fba86b627784979fc1e3">EshelbianPlasticity::EshelbianCore::d_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; d_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00033">EshelbianPlasticity.hpp:33</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_ae9ec3b2026489759599ce71e048ca5a6"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#ae9ec3b2026489759599ce71e048ca5a6">EshelbianPlasticity::EshelbianCore::inv_d_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_d_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00036">EshelbianPlasticity.hpp:36</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_af2f5e656c08e45228c61eba5585b637d"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af2f5e656c08e45228c61eba5585b637d">EshelbianPlasticity::EshelbianCore::dynamicRelaxation</a></div><div class="ttdeci">static PetscBool dynamicRelaxation</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00021">EshelbianPlasticity.hpp:21</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_af5300bd764a6432f701ebff075f6e5ba"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af5300bd764a6432f701ebff075f6e5ba">EshelbianPlasticity::EshelbianCore::EshelbianCore</a></div><div class="ttdeci">EshelbianCore(MoFEM::Interface &amp;m_field)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00940">EshelbianPlasticity.cpp:940</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_af65f9922d452b7c6579f0491567e5025"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af65f9922d452b7c6579f0491567e5025">EshelbianPlasticity::EshelbianCore::inv_f_log_e</a></div><div class="ttdeci">static double inv_f_log_e(const double v)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00042">EshelbianPlasticity.hpp:42</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_eshelbian_core_html_af7ccd7dc45717d0ffb0f183b95c81919"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_eshelbian_core.html#af7ccd7dc45717d0ffb0f183b95c81919">EshelbianPlasticity::EshelbianCore::inv_f</a></div><div class="ttdeci">static boost::function&lt; double(const double)&gt; inv_f</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00035">EshelbianPlasticity.hpp:35</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_constrain_boundary_h_div_lhs__d_u_html"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_h_div_lhs__d_u.html">EshelbianPlasticity::OpConstrainBoundaryHDivLhs_dU</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_contact_8hpp_source.html#l00198">EshelbianContact.hpp:198</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_constrain_boundary_h_div_rhs_html"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_h_div_rhs.html">EshelbianPlasticity::OpConstrainBoundaryHDivRhs</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_contact_8hpp_source.html#l00134">EshelbianContact.hpp:134</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_lhs__d_p_html"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_lhs__d_p.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_contact_8hpp_source.html#l00172">EshelbianContact.hpp:172</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_lhs__d_u_html"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_lhs__d_u.html">EshelbianPlasticity::OpConstrainBoundaryL2Lhs_dU</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_contact_8hpp_source.html#l00155">EshelbianContact.hpp:155</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_rhs_html"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_constrain_boundary_l2_rhs.html">EshelbianPlasticity::OpConstrainBoundaryL2Rhs</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_contact_8hpp_source.html#l00118">EshelbianContact.hpp:118</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_jacobian_html_a15ad4f8943e9270c375ed5ca5d7caf0e"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_jacobian.html#a15ad4f8943e9270c375ed5ca5d7caf0e">EshelbianPlasticity::OpJacobian::evalRhs</a></div><div class="ttdeci">bool evalRhs</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00032">EshelbianPlasticity.hpp:32</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_jacobian_html_a747fe83f343f4ffd426b2a0792fbe022"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_jacobian.html#a747fe83f343f4ffd426b2a0792fbe022">EshelbianPlasticity::OpJacobian::evaluateRhs</a></div><div class="ttdeci">virtual MoFEMErrorCode evaluateRhs(EntData &amp;data)=0</div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_jacobian_html_a9ace7930bd971e106adc4688e82af754"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_jacobian.html#a9ace7930bd971e106adc4688e82af754">EshelbianPlasticity::OpJacobian::evaluateLhs</a></div><div class="ttdeci">virtual MoFEMErrorCode evaluateLhs(EntData &amp;data)=0</div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_jacobian_html_ae8b1e124a71d3c85bff23022318278d7"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_jacobian.html#ae8b1e124a71d3c85bff23022318278d7">EshelbianPlasticity::OpJacobian::doWork</a></div><div class="ttdeci">MoFEMErrorCode doWork(int side, EntityType type, EntData &amp;data)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00928">EshelbianPlasticity.cpp:928</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_op_jacobian_html_aec3faab23d15be5756fc7664e28adf1f"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_op_jacobian.html#aec3faab23d15be5756fc7664e28adf1f">EshelbianPlasticity::OpJacobian::evalLhs</a></div><div class="ttdeci">bool evalLhs</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8hpp_source.html#l00033">EshelbianPlasticity.hpp:33</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_face_html_a55a01ba77a1e9a4e923d95a00214d5ea"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#a55a01ba77a1e9a4e923d95a00214d5ea">EshelbianPlasticity::SetIntegrationAtFrontFace::frontNodes</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontNodes</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00902">EshelbianPlasticity.cpp:902</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_face_html_abbdb6a592360dd706ccd289d8503c01a"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbdb6a592360dd706ccd289d8503c01a">EshelbianPlasticity::SetIntegrationAtFrontFace::SetIntegrationAtFrontFace</a></div><div class="ttdeci">SetIntegrationAtFrontFace(boost::shared_ptr&lt; Range &gt; front_nodes, boost::shared_ptr&lt; Range &gt; front_edges)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00653">EshelbianPlasticity.cpp:653</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_face_html_abbf66122eef1dc218551708d7fc511b5"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#abbf66122eef1dc218551708d7fc511b5">EshelbianPlasticity::SetIntegrationAtFrontFace::frontEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontEdges</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00903">EshelbianPlasticity.cpp:903</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_face_html_ad294721b379a4a6cea8db53b27fac1ec"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad294721b379a4a6cea8db53b27fac1ec">EshelbianPlasticity::SetIntegrationAtFrontFace::operator()</a></div><div class="ttdeci">MoFEMErrorCode operator()(ForcesAndSourcesCore *fe_raw_ptr, int order_row, int order_col, int order_data)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00657">EshelbianPlasticity.cpp:657</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_face_html_ad6a979fd7063ce295a2d5838ff85ee21"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_face.html#ad6a979fd7063ce295a2d5838ff85ee21">EshelbianPlasticity::SetIntegrationAtFrontFace::mapRefCoords</a></div><div class="ttdeci">static std::map&lt; long int, MatrixDouble &gt; mapRefCoords</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00905">EshelbianPlasticity.cpp:905</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_volume_html_a1b019460b638fe37940b91de58a6e910"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1b019460b638fe37940b91de58a6e910">EshelbianPlasticity::SetIntegrationAtFrontVolume::operator()</a></div><div class="ttdeci">MoFEMErrorCode operator()(ForcesAndSourcesCore *fe_raw_ptr, int order_row, int order_col, int order_data)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00401">EshelbianPlasticity.cpp:401</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_volume_html_a1e20c2dfc8d0572a6a3ba832fc309894"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a1e20c2dfc8d0572a6a3ba832fc309894">EshelbianPlasticity::SetIntegrationAtFrontVolume::frontNodes</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontNodes</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00645">EshelbianPlasticity.cpp:645</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_volume_html_a624e7331dfc478ad470f2e0a40fb7cc5"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a624e7331dfc478ad470f2e0a40fb7cc5">EshelbianPlasticity::SetIntegrationAtFrontVolume::mapRefCoords</a></div><div class="ttdeci">static std::map&lt; long int, MatrixDouble &gt; mapRefCoords</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00648">EshelbianPlasticity.cpp:648</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_volume_html_a7dc972d07b328600c38de68bd13b3d85"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#a7dc972d07b328600c38de68bd13b3d85">EshelbianPlasticity::SetIntegrationAtFrontVolume::SetIntegrationAtFrontVolume</a></div><div class="ttdeci">SetIntegrationAtFrontVolume(boost::shared_ptr&lt; Range &gt; front_nodes, boost::shared_ptr&lt; Range &gt; front_edges)</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00397">EshelbianPlasticity.cpp:397</a></div></div>
<div class="ttc" id="astruct_eshelbian_plasticity_1_1_set_integration_at_front_volume_html_ab7b229f126666030c6df2f79152acd6c"><div class="ttname"><a href="struct_eshelbian_plasticity_1_1_set_integration_at_front_volume.html#ab7b229f126666030c6df2f79152acd6c">EshelbianPlasticity::SetIntegrationAtFrontVolume::frontEdges</a></div><div class="ttdeci">boost::shared_ptr&lt; Range &gt; frontEdges</div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_plasticity_8cpp_source.html#l00646">EshelbianPlasticity.cpp:646</a></div></div>
<div class="ttc" id="astruct_face_rule_html"><div class="ttname"><a href="struct_face_rule.html">FaceRule</a></div><div class="ttdoc">Set integration rule to boundary elements.</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00091">simple_interface.cpp:91</a></div></div>
<div class="ttc" id="astruct_face_rule_html_aa4dbe8a983fafee94833d9f28e4eb5bf"><div class="ttname"><a href="struct_face_rule.html#aa4dbe8a983fafee94833d9f28e4eb5bf">FaceRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00092">simple_interface.cpp:92</a></div></div>
<div class="ttc" id="astruct_lie_groups_1_1_s_o3_html_af80491b46de29b3959da57bb3bfce5b9"><div class="ttname"><a href="struct_lie_groups_1_1_s_o3.html#af80491b46de29b3959da57bb3bfce5b9">LieGroups::SO3::exp</a></div><div class="ttdeci">static auto exp(A &amp;&amp;t_w_vee, B &amp;&amp;theta)</div><div class="ttdef"><b>Definition</b> <a href="_lie_8hpp_source.html#l00049">Lie.hpp:49</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_base_function_html_ab7aacd90b8b076207dc5e7bd070b7e4b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_base_function.html#ab7aacd90b8b076207dc5e7bd070b7e4b">MoFEM::BaseFunction::DofsSideMap</a></div><div class="ttdeci">multi_index_container&lt; DofsSideMapData, indexed_by&lt; ordered_non_unique&lt; tag&lt; TypeSide_mi_tag &gt;, composite_key&lt; DofsSideMapData, member&lt; DofsSideMapData, EntityType, &amp;DofsSideMapData::type &gt;, member&lt; DofsSideMapData, int, &amp;DofsSideMapData::side &gt; &gt; &gt;, ordered_unique&lt; tag&lt; EntDofIdx_mi_tag &gt;, member&lt; DofsSideMapData, int, &amp;DofsSideMapData::dof &gt; &gt; &gt; &gt; DofsSideMap</div><div class="ttdoc">Map entity stype and side to element/entity dof index.</div><div class="ttdef"><b>Definition</b> <a href="_base_function_8hpp_source.html#l00055">BaseFunction.hpp:55</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_base_function_unknown_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_base_function_unknown_interface.html">MoFEM::BaseFunctionUnknownInterface</a></div><div class="ttdef"><b>Definition</b> <a href="_base_function_8hpp_source.html#l00013">BaseFunction.hpp:13</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bc_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bc_manager.html">MoFEM::BcManager</a></div><div class="ttdoc">Simple interface for fast problem set-up.</div><div class="ttdef"><b>Definition</b> <a href="_bc_manager_8hpp_source.html#l00025">BcManager.hpp:25</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bc_manager_html_ad0bbc182baa1622340dbf96ce6da5ef2"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bc_manager.html#ad0bbc182baa1622340dbf96ce6da5ef2">MoFEM::BcManager::pushMarkDOFsOnEntities</a></div><div class="ttdeci">MoFEMErrorCode pushMarkDOFsOnEntities(const std::string problem_name, const std::string block_name, const std::string field_name, int lo, int hi, bool get_low_dim_ents=true)</div><div class="ttdoc">Mark block DOFs.</div><div class="ttdef"><b>Definition</b> <a href="_bc_manager_8cpp_source.html#l00111">BcManager.cpp:111</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_bit_ref_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_bit_ref_manager.html">MoFEM::BitRefManager</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="_bit_ref_manager_8hpp_source.html#l00021">BitRefManager.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_comm_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_comm_interface.html">MoFEM::CommInterface</a></div><div class="ttdoc">Managing BitRefLevels.</div><div class="ttdef"><b>Definition</b> <a href="_comm_interface_8hpp_source.html#l00021">CommInterface.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_comm_interface_html_aaf48742e4832bab940f922703f6176b6"><div class="ttname"><a href="struct_mo_f_e_m_1_1_comm_interface.html#aaf48742e4832bab940f922703f6176b6">MoFEM::CommInterface::synchroniseEntities</a></div><div class="ttdeci">MoFEMErrorCode synchroniseEntities(Range &amp;ent, std::map&lt; int, Range &gt; *received_ents, int verb=DEFAULT_VERBOSITY)</div><div class="ttdoc">synchronize entity range on processors (collective)</div><div class="ttdef"><b>Definition</b> <a href="_comm_interface_8cpp_source.html#l00026">CommInterface.cpp:26</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a093526a60371b07213a0be2aaf7afa35"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a093526a60371b07213a0be2aaf7afa35">MoFEM::CoreInterface::get_comm_size</a></div><div class="ttdeci">virtual int get_comm_size() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a174e70b67f4f235d096d3c45d865645b"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a174e70b67f4f235d096d3c45d865645b">MoFEM::CoreInterface::get_moab</a></div><div class="ttdeci">virtual moab::Interface &amp; get_moab()=0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a4a1460f62976a6d7224b1c280cecedfc"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a4a1460f62976a6d7224b1c280cecedfc">MoFEM::CoreInterface::add_broken_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_broken_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const std::vector&lt; std::pair&lt; EntityType, std::function&lt; MoFEMErrorCode(BaseFunction::DofsSideMap &amp;)&gt; &gt; &gt; list_dof_side_map, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a63fc22416f2a0fbdea7406d3aa21fd17"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a63fc22416f2a0fbdea7406d3aa21fd17">MoFEM::CoreInterface::check_finite_element</a></div><div class="ttdeci">virtual bool check_finite_element(const std::string &amp;name) const =0</div><div class="ttdoc">Check if finite element is in database.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a727653d1367e758daf2a74cb65d4dfa5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a727653d1367e758daf2a74cb65d4dfa5">MoFEM::CoreInterface::build_adjacencies</a></div><div class="ttdeci">virtual MoFEMErrorCode build_adjacencies(const Range &amp;ents, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">build adjacencies</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a8008ad16315eb609dcb0fd88746b991a"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a8008ad16315eb609dcb0fd88746b991a">MoFEM::CoreInterface::add_field</a></div><div class="ttdeci">virtual MoFEMErrorCode add_field(const std::string name, const FieldSpace space, const FieldApproximationBase base, const FieldCoefficientsNumber nb_of_coefficients, const TagType tag_type=MB_TAG_SPARSE, const enum MoFEMTypes bh=MF_EXCL, int verb=DEFAULT_VERBOSITY)=0</div><div class="ttdoc">Add field.</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_a9b2bc8c1b980f49d31a0b5f7fbe756f5"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#a9b2bc8c1b980f49d31a0b5f7fbe756f5">MoFEM::CoreInterface::get_comm</a></div><div class="ttdeci">virtual MPI_Comm &amp; get_comm() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_interface_html_af2224ce77b33637b5cfad66a275a2ffb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_interface.html#af2224ce77b33637b5cfad66a275a2ffb">MoFEM::CoreInterface::get_comm_rank</a></div><div class="ttdeci">virtual int get_comm_rank() const =0</div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_core_tmp_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_core_tmp.html">MoFEM::CoreTmp</a></div><div class="ttdef"><b>Definition</b> <a href="_core_8hpp_source.html#l00036">Core.hpp:36</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_deprecated_core_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_deprecated_core_interface.html">MoFEM::DeprecatedCoreInterface</a></div><div class="ttdoc">Deprecated interface functions.</div><div class="ttdef"><b>Definition</b> <a href="_deprecated_core_interface_8hpp_source.html#l00016">DeprecatedCoreInterface.hpp:16</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_displacement_cubit_bc_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_displacement_cubit_bc_data.html">MoFEM::DisplacementCubitBcData</a></div><div class="ttdoc">Definition of the displacement bc data structure.</div><div class="ttdef"><b>Definition</b> <a href="_b_c_data_8hpp_source.html#l00076">BCData.hpp:76</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_ent_polynomial_base_ctx_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_ent_polynomial_base_ctx.html">MoFEM::EntPolynomialBaseCtx</a></div><div class="ttdoc">Class used to pass element data to calculate base functions on tet,triangle,edge.</div><div class="ttdef"><b>Definition</b> <a href="_ent_polynomial_base_ctx_8hpp_source.html#l00022">EntPolynomialBaseCtx.hpp:22</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data_1_1_ent_data.html">MoFEM::EntitiesFieldData::EntData</a></div><div class="ttdoc">Data on single entity (This is passed as argument to DataOperator::doWork)</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l00128">EntitiesFieldData.hpp:128</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data.html">MoFEM::EntitiesFieldData</a></div><div class="ttdoc">data structure for finite element entity</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l00040">EntitiesFieldData.hpp:40</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_entities_field_data_html_a7cb7671c28a28a884b3b7590c821244f"><div class="ttname"><a href="struct_mo_f_e_m_1_1_entities_field_data.html#a7cb7671c28a28a884b3b7590c821244f">MoFEM::EntitiesFieldData::dataOnEntities</a></div><div class="ttdeci">std::array&lt; boost::ptr_vector&lt; EntData &gt;, MBMAXTYPE &gt; dataOnEntities</div><div class="ttdef"><b>Definition</b> <a href="_entities_field_data_8hpp_source.html#l00057">EntitiesFieldData.hpp:57</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_face_element_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_face_element_forces_and_sources_core.html">MoFEM::FaceElementForcesAndSourcesCore</a></div><div class="ttdoc">Face finite element.</div><div class="ttdef"><b>Definition</b> <a href="_face_element_forces_and_sources_core_8hpp_source.html#l00023">FaceElementForcesAndSourcesCore.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_field_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_field.html">MoFEM::Field</a></div><div class="ttdoc">Provide data structure for (tensor) field approximation.</div><div class="ttdef"><b>Definition</b> <a href="_field_multi_indices_8hpp_source.html#l00051">FieldMultiIndices.hpp:51</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core.html">MoFEM::ForcesAndSourcesCore</a></div><div class="ttdoc">structure to get information form mofem into EntitiesFieldData</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l00022">ForcesAndSourcesCore.hpp:22</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_html_a91c6f5f96b8f4ec76ed7c87ea96bbd9c"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#a91c6f5f96b8f4ec76ed7c87ea96bbd9c">MoFEM::ForcesAndSourcesCore::gaussPts</a></div><div class="ttdeci">MatrixDouble gaussPts</div><div class="ttdoc">Matrix of integration points.</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l00109">ForcesAndSourcesCore.hpp:109</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forces_and_sources_core_html_ac1d7ee38dde697833773a3b8cb197a76"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forces_and_sources_core.html#ac1d7ee38dde697833773a3b8cb197a76">MoFEM::ForcesAndSourcesCore::mField</a></div><div class="ttdeci">Interface &amp; mField</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l00024">ForcesAndSourcesCore.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_forms_integrators_1_1_assembly_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_forms_integrators_1_1_assembly.html">MoFEM::FormsIntegrators::Assembly</a></div><div class="ttdoc">Assembly methods.</div><div class="ttdef"><b>Definition</b> <a href="_forms_integrators_8hpp_source.html#l00317">FormsIntegrators.hpp:317</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_i_s_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_i_s_manager.html">MoFEM::ISManager</a></div><div class="ttdoc">Section manager is used to create indexes and sections.</div><div class="ttdef"><b>Definition</b> <a href="_i_s_manager_8hpp_source.html#l00023">ISManager.hpp:23</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_mesh_refinement_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_mesh_refinement.html">MoFEM::MeshRefinement</a></div><div class="ttdoc">Mesh refinement interface.</div><div class="ttdef"><b>Definition</b> <a href="_mesh_refinement_8hpp_source.html#l00026">MeshRefinement.hpp:26</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_meshsets_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_meshsets_manager.html">MoFEM::MeshsetsManager</a></div><div class="ttdoc">Interface for managing meshsets containing materials and boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="_meshsets_manager_8hpp_source.html#l00104">MeshsetsManager.hpp:104</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_natural_b_c_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_natural_b_c.html">MoFEM::NaturalBC</a></div><div class="ttdoc">Natural boundary conditions.</div><div class="ttdef"><b>Definition</b> <a href="_natural_8hpp_source.html#l00057">Natural.hpp:57</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_broken_loop_side_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_broken_loop_side.html">MoFEM::OpBrokenLoopSide</a></div><div class="ttdef"><b>Definition</b> <a href="_forms_broken_space_constraint_impl_8hpp_source.html#l00015">FormsBrokenSpaceConstraintImpl.hpp:15</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calc_norm_l2_tensor1_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calc_norm_l2_tensor1.html">MoFEM::OpCalcNormL2Tensor1</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor1.</div><div class="ttdef"><b>Definition</b> <a href="_norms_operators_8hpp_source.html#l00044">NormsOperators.hpp:44</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calc_norm_l2_tensor2_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calc_norm_l2_tensor2.html">MoFEM::OpCalcNormL2Tensor2</a></div><div class="ttdoc">Get norm of input MatrixDouble for Tensor2.</div><div class="ttdef"><b>Definition</b> <a href="_norms_operators_8hpp_source.html#l00072">NormsOperators.hpp:72</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_h_tensor_tensor_field.html">MoFEM::OpCalculateHTensorTensorField</a></div><div class="ttdoc">Calculate tenor field using tensor base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l02855">UserDataOperators.hpp:2856</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_divergence_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_divergence.html">MoFEM::OpCalculateHVecTensorDivergence</a></div><div class="ttdoc">Calculate divergence of tonsorial field using vectorial base.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l02950">UserDataOperators.hpp:2951</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_field.html">MoFEM::OpCalculateHVecTensorField</a></div><div class="ttdoc">Calculate tenor field using vectorial base, i.e. Hdiv/Hcurl.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l02628">UserDataOperators.hpp:2629</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_trace_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_h_vec_tensor_trace.html">MoFEM::OpCalculateHVecTensorTrace</a></div><div class="ttdoc">Calculate trace of vector (Hdiv/Hcurl) space.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l03153">UserDataOperators.hpp:3153</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values_dot_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values_dot.html">MoFEM::OpCalculateTensor2SymmetricFieldValuesDot</a></div><div class="ttdoc">Calculate symmetric tensor field rates ant integratio pts.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l01097">UserDataOperators.hpp:1098</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_tensor2_symmetric_field_values.html">MoFEM::OpCalculateTensor2SymmetricFieldValues</a></div><div class="ttdoc">Calculate symmetric tensor field values at integration pts.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l01003">UserDataOperators.hpp:1004</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_gradient_dot_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_gradient_dot.html">MoFEM::OpCalculateVectorFieldGradientDot</a></div><div class="ttdoc">Get field gradients time derivative at integration pts for scalar filed rank 0, i....</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l01576">UserDataOperators.hpp:1577</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values_from_petsc_vec_impl.html">MoFEM::OpCalculateVectorFieldValuesFromPetscVecImpl</a></div><div class="ttdoc">Approximate field values for given petsc vector.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00597">UserDataOperators.hpp:598</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_calculate_vector_field_values_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_calculate_vector_field_values.html">MoFEM::OpCalculateVectorFieldValues</a></div><div class="ttdoc">Get values at integration pts for tensor filed rank 1, i.e. vector field.</div><div class="ttdef"><b>Definition</b> <a href="_user_data_operators_8hpp_source.html#l00468">UserDataOperators.hpp:470</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_get_broken_base_side_data_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_get_broken_base_side_data.html">MoFEM::OpGetBrokenBaseSideData</a></div><div class="ttdef"><b>Definition</b> <a href="_forms_broken_space_constraint_impl_8hpp_source.html#l00068">FormsBrokenSpaceConstraintImpl.hpp:68</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_loop_side_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_loop_side.html">MoFEM::OpLoopSide</a></div><div class="ttdoc">Element used to execute operators on side of the element.</div><div class="ttdef"><b>Definition</b> <a href="_forces_and_sources_core_8hpp_source.html#l01291">ForcesAndSourcesCore.hpp:1291</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_post_proc_map_in_moab_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_post_proc_map_in_moab.html">MoFEM::OpPostProcMapInMoab</a></div><div class="ttdoc">Post post-proc data at points from hash maps.</div><div class="ttdef"><b>Definition</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00698">PostProcBrokenMeshInMoabBase.hpp:698</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_op_set_flux_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_op_set_flux.html">MoFEM::OpSetFlux</a></div><div class="ttdef"><b>Definition</b> <a href="_forms_broken_space_constraint_impl_8hpp_source.html#l00139">FormsBrokenSpaceConstraintImpl.hpp:139</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pair_name_f_e_method_ptr_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pair_name_f_e_method_ptr.html">MoFEM::PairNameFEMethodPtr</a></div><div class="ttdef"><b>Definition</b> <a href="_aux_p_e_t_sc_8hpp_source.html#l00012">AuxPETSc.hpp:12</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_pipeline_manager_1_1_elements_and_ops_by_dim.html">MoFEM::PipelineManager::ElementsAndOpsByDim</a></div><div class="ttdef"><b>Definition</b> <a href="_pipeline_manager_8hpp_source.html#l00038">PipelineManager.hpp:38</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_begin_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_begin_impl.html">MoFEM::PostProcBrokenMeshInMoabBaseBeginImpl</a></div><div class="ttdef"><b>Definition</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00854">PostProcBrokenMeshInMoabBase.hpp:855</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_end_impl_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_post_proc_broken_mesh_in_moab_base_end_impl.html">MoFEM::PostProcBrokenMeshInMoabBaseEndImpl</a></div><div class="ttdef"><b>Definition</b> <a href="_post_proc_broken_mesh_in_moab_base_8hpp_source.html#l00901">PostProcBrokenMeshInMoabBase.hpp:902</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_problems_manager_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_problems_manager.html">MoFEM::ProblemsManager</a></div><div class="ttdoc">Problem manager is used to build and partition problems.</div><div class="ttdef"><b>Definition</b> <a href="_problems_manager_8hpp_source.html#l00021">ProblemsManager.hpp:21</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_projection10_node_coords_on_field_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_projection10_node_coords_on_field.html">MoFEM::Projection10NodeCoordsOnField</a></div><div class="ttdoc">Projection of edge entities with one mid-node on hierarchical basis.</div><div class="ttdef"><b>Definition</b> <a href="_projection10_node_coords_on_field_8hpp_source.html#l00024">Projection10NodeCoordsOnField.hpp:24</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_smart_petsc_obj_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_smart_petsc_obj.html">MoFEM::SmartPetscObj</a></div><div class="ttdoc">intrusive_ptr for managing petsc objects</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00082">PetscSmartObj.hpp:83</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_smart_petsc_obj_html_ab83f85c53d250afafd28487980674a97"><div class="ttname"><a href="struct_mo_f_e_m_1_1_smart_petsc_obj.html#ab83f85c53d250afafd28487980674a97">MoFEM::SmartPetscObj::use_count</a></div><div class="ttdeci">int use_count() const</div><div class="ttdef"><b>Definition</b> <a href="_petsc_smart_obj_8hpp_source.html#l00109">PetscSmartObj.hpp:109</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_time_scale_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_time_scale.html">MoFEM::TimeScale</a></div><div class="ttdoc">Force scale operator for reading two columns.</div><div class="ttdef"><b>Definition</b> <a href="_scaling_method_8hpp_source.html#l00032">ScalingMethod.hpp:32</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_tools_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_tools.html">MoFEM::Tools</a></div><div class="ttdoc">Auxiliary tools.</div><div class="ttdef"><b>Definition</b> <a href="_tools_8hpp_source.html#l00019">Tools.hpp:19</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_ts_ctx_html_a3980182510ce819db5b281b6df595130"><div class="ttname"><a href="struct_mo_f_e_m_1_1_ts_ctx.html#a3980182510ce819db5b281b6df595130">MoFEM::TsCtx::getLoopsMonitor</a></div><div class="ttdeci">FEMethodsSequence &amp; getLoopsMonitor()</div><div class="ttdoc">Get the loops to do Monitor object.</div><div class="ttdef"><b>Definition</b> <a href="_ts_ctx_8hpp_source.html#l00102">TsCtx.hpp:102</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html">MoFEM::UnknownInterface</a></div><div class="ttdoc">base class for all interface classes</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00034">UnknownInterface.hpp:34</a></div></div>
<div class="ttc" id="astruct_mo_f_e_m_1_1_unknown_interface_html_a7ab248ec45fca778800dcd92e5171beb"><div class="ttname"><a href="struct_mo_f_e_m_1_1_unknown_interface.html#a7ab248ec45fca778800dcd92e5171beb">MoFEM::UnknownInterface::getInterface</a></div><div class="ttdeci">MoFEMErrorCode getInterface(IFACE *&amp;iface) const</div><div class="ttdoc">Get interface reference to pointer of interface.</div><div class="ttdef"><b>Definition</b> <a href="_unknown_interface_8hpp_source.html#l00093">UnknownInterface.hpp:93</a></div></div>
<div class="ttc" id="astruct_op_broken_traction_bc_html"><div class="ttname"><a href="struct_op_broken_traction_bc.html">OpBrokenTractionBc</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00334">EshelbianOperators.hpp:335</a></div></div>
<div class="ttc" id="astruct_op_calculate_eshelby_stress_html"><div class="ttname"><a href="struct_op_calculate_eshelby_stress.html">OpCalculateEshelbyStress</a></div><div class="ttdef"><b>Definition</b> <a href="_hooke_element_8hpp_source.html#l00177">HookeElement.hpp:177</a></div></div>
<div class="ttc" id="astruct_op_calculate_rotation_and_spatial_gradient_html"><div class="ttname"><a href="struct_op_calculate_rotation_and_spatial_gradient.html">OpCalculateRotationAndSpatialGradient</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00173">EshelbianOperators.hpp:173</a></div></div>
<div class="ttc" id="astruct_op_disp_bc_html"><div class="ttname"><a href="struct_op_disp_bc.html">OpDispBc</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00295">EshelbianOperators.hpp:295</a></div></div>
<div class="ttc" id="astruct_op_post_proc_data_structure_html"><div class="ttname"><a href="struct_op_post_proc_data_structure.html">OpPostProcDataStructure</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00525">EshelbianOperators.hpp:526</a></div></div>
<div class="ttc" id="astruct_op_release_energy_html"><div class="ttname"><a href="struct_op_release_energy.html">OpReleaseEnergy</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00575">EshelbianOperators.hpp:576</a></div></div>
<div class="ttc" id="astruct_op_rotation_bc_html"><div class="ttname"><a href="struct_op_rotation_bc.html">OpRotationBc</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00326">EshelbianOperators.hpp:326</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency__d_bubble__d_bubble_html"><div class="ttname"><a href="struct_op_spatial_consistency__d_bubble__d_bubble.html">OpSpatialConsistency_dBubble_dBubble</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00471">EshelbianOperators.hpp:471</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency__d_bubble__d_p_html"><div class="ttname"><a href="struct_op_spatial_consistency__d_bubble__d_p.html">OpSpatialConsistency_dBubble_dP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00485">EshelbianOperators.hpp:485</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency__d_bubble__domega_html"><div class="ttname"><a href="struct_op_spatial_consistency__d_bubble__domega.html">OpSpatialConsistency_dBubble_domega</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00512">EshelbianOperators.hpp:512</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency__d_p__d_p_html"><div class="ttname"><a href="struct_op_spatial_consistency__d_p__d_p.html">OpSpatialConsistency_dP_dP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00458">EshelbianOperators.hpp:458</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency__d_p__domega_html"><div class="ttname"><a href="struct_op_spatial_consistency__d_p__domega.html">OpSpatialConsistency_dP_domega</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00499">EshelbianOperators.hpp:499</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency_bubble_html"><div class="ttname"><a href="struct_op_spatial_consistency_bubble.html">OpSpatialConsistencyBubble</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00256">EshelbianOperators.hpp:256</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency_div_term_html"><div class="ttname"><a href="struct_op_spatial_consistency_div_term.html">OpSpatialConsistencyDivTerm</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00265">EshelbianOperators.hpp:265</a></div></div>
<div class="ttc" id="astruct_op_spatial_consistency_p_html"><div class="ttname"><a href="struct_op_spatial_consistency_p.html">OpSpatialConsistencyP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00247">EshelbianOperators.hpp:247</a></div></div>
<div class="ttc" id="astruct_op_spatial_equilibrium__dw__d_p_html"><div class="ttname"><a href="struct_op_spatial_equilibrium__dw__d_p.html">OpSpatialEquilibrium_dw_dP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00350">EshelbianOperators.hpp:350</a></div></div>
<div class="ttc" id="astruct_op_spatial_equilibrium__dw__dw_html"><div class="ttname"><a href="struct_op_spatial_equilibrium__dw__dw.html">OpSpatialEquilibrium_dw_dw</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00361">EshelbianOperators.hpp:361</a></div></div>
<div class="ttc" id="astruct_op_spatial_equilibrium_html"><div class="ttname"><a href="struct_op_spatial_equilibrium.html">OpSpatialEquilibrium</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00221">EshelbianOperators.hpp:221</a></div></div>
<div class="ttc" id="astruct_op_spatial_physical__du__d_bubble_html"><div class="ttname"><a href="struct_op_spatial_physical__du__d_bubble.html">OpSpatialPhysical_du_dBubble</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00386">EshelbianOperators.hpp:386</a></div></div>
<div class="ttc" id="astruct_op_spatial_physical__du__d_p_html"><div class="ttname"><a href="struct_op_spatial_physical__du__d_p.html">OpSpatialPhysical_du_dP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00374">EshelbianOperators.hpp:374</a></div></div>
<div class="ttc" id="astruct_op_spatial_physical__du__domega_html"><div class="ttname"><a href="struct_op_spatial_physical__du__domega.html">OpSpatialPhysical_du_domega</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00398">EshelbianOperators.hpp:398</a></div></div>
<div class="ttc" id="astruct_op_spatial_rotation__domega__d_bubble_html"><div class="ttname"><a href="struct_op_spatial_rotation__domega__d_bubble.html">OpSpatialRotation_domega_dBubble</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00432">EshelbianOperators.hpp:432</a></div></div>
<div class="ttc" id="astruct_op_spatial_rotation__domega__d_p_html"><div class="ttname"><a href="struct_op_spatial_rotation__domega__d_p.html">OpSpatialRotation_domega_dP</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00421">EshelbianOperators.hpp:421</a></div></div>
<div class="ttc" id="astruct_op_spatial_rotation__domega__domega_html"><div class="ttname"><a href="struct_op_spatial_rotation__domega__domega.html">OpSpatialRotation_domega_domega</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00444">EshelbianOperators.hpp:444</a></div></div>
<div class="ttc" id="astruct_op_spatial_rotation__domega__du_html"><div class="ttname"><a href="struct_op_spatial_rotation__domega__du.html">OpSpatialRotation_domega_du</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00410">EshelbianOperators.hpp:410</a></div></div>
<div class="ttc" id="astruct_op_spatial_rotation_html"><div class="ttname"><a href="struct_op_spatial_rotation.html">OpSpatialRotation</a></div><div class="ttdef"><b>Definition</b> <a href="_eshelbian_operators_8hpp_source.html#l00235">EshelbianOperators.hpp:235</a></div></div>
<div class="ttc" id="astruct_q_u_a_d___html_a4ceb3af6a1dd055a067f6c3c1f6d4c86"><div class="ttname"><a href="struct_q_u_a_d__.html#a4ceb3af6a1dd055a067f6c3c1f6d4c86">QUAD_::order</a></div><div class="ttdeci">int order</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00028">quad.h:28</a></div></div>
<div class="ttc" id="astruct_q_u_a_d___html_ad40798bbebc1ea30e30dfcde923eccaa"><div class="ttname"><a href="struct_q_u_a_d__.html#ad40798bbebc1ea30e30dfcde923eccaa">QUAD_::npoints</a></div><div class="ttdeci">int npoints</div><div class="ttdef"><b>Definition</b> <a href="quad_8h_source.html#l00029">quad.h:29</a></div></div>
<div class="ttc" id="astruct_t_s_elastic_post_step_html_a11e5b883541555c29988f8eb9e8dec7a"><div class="ttname"><a href="struct_t_s_elastic_post_step.html#a11e5b883541555c29988f8eb9e8dec7a">TSElasticPostStep::postStepInitialise</a></div><div class="ttdeci">static MoFEMErrorCode postStepInitialise(EshelbianCore *ep_ptr)</div><div class="ttdef"><b>Definition</b> <a href="_t_s_elastic_post_step_8cpp_source.html#l00011">TSElasticPostStep.cpp:11</a></div></div>
<div class="ttc" id="astruct_t_s_elastic_post_step_html_a4c808fe810288d58f8699aff7f947852"><div class="ttname"><a href="struct_t_s_elastic_post_step.html#a4c808fe810288d58f8699aff7f947852">TSElasticPostStep::postStepDestroy</a></div><div class="ttdeci">static MoFEMErrorCode postStepDestroy()</div><div class="ttdef"><b>Definition</b> <a href="_t_s_elastic_post_step_8cpp_source.html#l00085">TSElasticPostStep.cpp:85</a></div></div>
<div class="ttc" id="astruct_t_s_elastic_post_step_html_a970435b55ed522325c979afce73ff046"><div class="ttname"><a href="struct_t_s_elastic_post_step.html#a970435b55ed522325c979afce73ff046">TSElasticPostStep::preStepFun</a></div><div class="ttdeci">static MoFEMErrorCode preStepFun(TS ts)</div><div class="ttdef"><b>Definition</b> <a href="_t_s_elastic_post_step_8cpp_source.html#l00095">TSElasticPostStep.cpp:95</a></div></div>
<div class="ttc" id="astruct_t_s_elastic_post_step_html_ac1f95bc05eb3ef54d799134f8202a753"><div class="ttname"><a href="struct_t_s_elastic_post_step.html#ac1f95bc05eb3ef54d799134f8202a753">TSElasticPostStep::postStepFun</a></div><div class="ttdeci">static MoFEMErrorCode postStepFun(TS ts)</div><div class="ttdef"><b>Definition</b> <a href="_t_s_elastic_post_step_8cpp_source.html#l00156">TSElasticPostStep.cpp:156</a></div></div>
<div class="ttc" id="astruct_vol_rule_html"><div class="ttname"><a href="struct_vol_rule.html">VolRule</a></div><div class="ttdoc">Set integration rule to volume elements.</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00088">simple_interface.cpp:88</a></div></div>
<div class="ttc" id="astruct_vol_rule_html_a6d7b2f53d4d1a0251ea349cfc7f1f637"><div class="ttname"><a href="struct_vol_rule.html#a6d7b2f53d4d1a0251ea349cfc7f1f637">VolRule::operator()</a></div><div class="ttdeci">int operator()(int, int, int) const</div><div class="ttdef"><b>Definition</b> <a href="simple__interface_8cpp_source.html#l00089">simple_interface.cpp:89</a></div></div>
<div class="ttc" id="atest__broken__space_8cpp_html_a7d51850bc3e191e80e4a1b055db5dd49"><div class="ttname"><a href="test__broken__space_8cpp.html#a7d51850bc3e191e80e4a1b055db5dd49">BdyEleOp</a></div><div class="ttdeci">BoundaryEle::UserDataOperator BdyEleOp</div><div class="ttdef"><b>Definition</b> <a href="test__broken__space_8cpp_source.html#l00041">test_broken_space.cpp:41</a></div></div>
<div class="ttc" id="athermo__elastic_8cpp_html_a11853fc6dfa8d79a1adb95c8c02626c9"><div class="ttname"><a href="thermo__elastic_8cpp.html#a11853fc6dfa8d79a1adb95c8c02626c9">save_range</a></div><div class="ttdeci">auto save_range</div><div class="ttdef"><b>Definition</b> <a href="thermo__elastic_8cpp_source.html#l00157">thermo_elastic.cpp:157</a></div></div>
<div class="ttc" id="athermo__elastic_8cpp_html_a650be1395bef846425c9a2cd2cc7a211"><div class="ttname"><a href="thermo__elastic_8cpp.html#a650be1395bef846425c9a2cd2cc7a211">OpBodyForce</a></div><div class="ttdeci">DomainNaturalBCRhs::OpFlux&lt; NaturalMeshsetType&lt; BLOCKSET &gt;, 1, SPACE_DIM &gt; OpBodyForce</div><div class="ttdef"><b>Definition</b> <a href="thermo__elastic_8cpp_source.html#l00101">thermo_elastic.cpp:101</a></div></div>
</div><!-- fragment --> </div><!-- contents -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
