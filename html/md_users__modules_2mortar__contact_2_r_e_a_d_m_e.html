<!-- HTML header for doxygen 1.8.13-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
  <meta http-equiv="X-UA-Compatible" content="IE=9"/>
  <meta name="generator" content="Doxygen 1.12.0"/>
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>MoFEM: README</title>
  <link href="tabs.css" rel="stylesheet" type="text/css"/>
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
  <link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
  <script type="text/x-mathjax-config">
MathJax.Hub.Config({
  extensions: ["tex2jax.js"],
  jax: ["input/TeX","output/HTML-CSS"],
});
</script>
<script type="text/javascript" async="async" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js"></script>
  <script type="text/javascript " src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_HTML "></script>
    <script type="text/x-mathjax-config">
      MathJax.Hub.Config({
        extensions: ["AMSmath.js"],
        TeX: { equationNumbers: { autoNumber: ["all"],
                                  useLabelIds: true
        } 
        }
    });
    </script>
  <link href="customdoxygen.css" rel="stylesheet" type="text/css" />
  <link href="extra_style.css" rel="stylesheet" type="text/css"/>
  <link rel="apple-touch-icon" sizes="57x57" href="apple-icon-57x57.png">
  <link rel="apple-touch-icon" sizes="60x60" href="apple-icon-60x60.png">
  <link rel="apple-touch-icon" sizes="72x72" href="apple-icon-72x72.png">
  <link rel="apple-touch-icon" sizes="76x76" href="apple-icon-76x76.png">
  <link rel="apple-touch-icon" sizes="114x114" href="apple-icon-114x114.png">
  <link rel="apple-touch-icon" sizes="120x120" href="apple-icon-120x120.png">
  <link rel="apple-touch-icon" sizes="144x144" href="apple-icon-144x144.png">
  <link rel="apple-touch-icon" sizes="152x152" href="apple-icon-152x152.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-icon-180x180.png">
  <link rel="icon" type="image/png" sizes="192x192"  href="android-icon-192x192.png">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="96x96" href="favicon-96x96.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="shortcut icon" type="image/png" href="favicon-32x32.png"/>
  <link rel="Bookmark" type="image/png" href="favicon-32x32.png"/>
  <link rel="manifest" href="manifest.json">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="msapplication-TileImage" content="ms-icon-144x144.png">
  <meta name="theme-color" content="#ffffff">
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div style="background-color:#011A40" id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 30px;">
  <td id="projectlogo"><img alt="Logo" src="MoFEMLogo.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <td style="padding-left: 0.5em;" bgcolor="#011A40"
   <div id="projectbrief"><font color="#FFFFFF">v0.14.0</font></div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!--Google analytics tags-->
<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
  ga('create', 'UA-65236130-1', 'auto');
  ga('send', 'pageview');
</script>
<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-2J9RE2P3H5"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());
  gtag('config', 'G-2J9RE2P3H5');
</script>
<!-- Generated by Doxygen 1.12.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',false);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">README</div></div>
</div><!--header-->
<div class="contents">
<div class="toc"><h3>Table of Contents</h3>
<ul>
  <li class="level1 empty">
    <ul>
      <li class="level2">
        <a href="#autotoc_md254">Brief description</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md255">1. Definition of the contact surfaces</a>
        <ul>
          <li class="level3">
            <a href="#autotoc_md256">Geometry</a>
          </li>
          <li class="level3">
            <a href="#autotoc_md257">Mesh</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#autotoc_md258">2. Preparation of the param file</a>
        <ul>
          <li class="level3">
            <a href="#autotoc_md259">Contact parameters</a>
          </li>
        </ul>
      </li>
      <li class="level2">
        <a href="#autotoc_md260">2. Running the contact simulation</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md261">3. Postprocessing</a>
      </li>
      <li class="level2">
        <a href="#autotoc_md262">4. Simulation with internal stress</a>
      </li>
    </ul>
  </li>
</ul>
</div>
<div class="textblock"><h2><a class="anchor" id="autotoc_md254"></a>
Brief description</h2>
<p><a class="el" href="struct_contact.html">Contact</a> interaction between elastic solids having non-matching meshes in the contact interface.</p>
<p><em><b><em>Assumptions:</em></b></em> small rotations, small strains, small relative tangential displacements (moderate if <code>-convect</code> option is switched on, see Contact parameters for more details).</p>
<h2><a class="anchor" id="autotoc_md255"></a>
1. Definition of the contact surfaces</h2>
<p>Pairs of surfaces belonging to two solids that can potentially come into contact have to be marked as <em>BLOCKSET_s, with one surface belonging to the pair with name <code>MORTAR_MASTER</code> and the other surface of the pair named <code>MORTAR_SLAVE</code>. An arbitrary number of pairs of contact surfaces can be defined by adding each side either in <code>MORTAR_MASTER</code> or in <code>MORTAR_SLAVE</code> _BLOCKSET</em>.</p>
<h3><a class="anchor" id="autotoc_md256"></a>
Geometry</h3>
<ul>
<li>Create the contacting solids separately</li>
<li>Create all necessary groups for the partitioned solids:<ul>
<li>Groups of volumes for solid blocks</li>
<li>Groups of faces for fixed BCs</li>
<li>Group of faces for pressure BCs</li>
<li>Group of faces for springs</li>
<li>Group all one side of the contact pairs in the slave faces in the slave blockset and the rest of their counterparts to the master blockset.</li>
</ul>
</li>
</ul>
<p><em><b><em>NOTE:</em></b></em> Springs can be used to eliminate the rigid body motion in a contact simulation under the pressure control.</p>
<h3><a class="anchor" id="autotoc_md257"></a>
Mesh</h3>
<ul>
<li>Mesh each solid separately</li>
</ul>
<h2><a class="anchor" id="autotoc_md258"></a>
2. Preparation of the param file</h2>
<p>Check the essential contact parameters in the file <code>param_file.petsc</code>: </p><div class="fragment"><div class="line">-order 2         </div>
<div class="line">-order_lambda 1          </div>
<div class="line">-cn_value 1.e3               </div>
</div><!-- fragment --><p><em><b><em>NOTE:</em></b></em> <code>cn</code> is the contact augmentation parameter which affects the convergence and has minimal effect on the solution (in a reasonable range of values). Recommended initial value is the Young's modulus of contacting solids (or harmonic mean in case of different values). The optimal value can be found by repetitively increasing/decreasing the initial value by e.g. a factor of 10.</p>
<h3><a class="anchor" id="autotoc_md259"></a>
Contact parameters</h3>
<table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-order</code>   </td><td class="markdownTableBodyNone">Approximation order of the field of spatial positions for the entire mesh   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-order_lambda</code>   </td><td class="markdownTableBodyNone">Approximation order of the field of contact Lagrange multipliers   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>order_contact</code>   </td><td class="markdownTableBodyNone">Approximation order of the field of spatial positions for the contact elements and a given number of tetrahedral element layers adjacent to the contact interface   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-ho_levels_num</code>   </td><td class="markdownTableBodyNone">Number of tetrahedral element layers adjacent to the contact interface with higher order of the field of spatial positions (if <code>-order_contact</code> is higher than <code>order</code>)   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-cn_value</code>   </td><td class="markdownTableBodyNone">Augmentation parameter which affects the convergence and has minimal effect on the solution. Recommended initial value is the Young's modulus of contacting solids (or harmonic mean in case of different values). The optimal value can be found by repetitively increasing/decreasing the initial value by e.g. a factor of 10   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-r_value</code>   </td><td class="markdownTableBodyNone"><a class="el" href="struct_contact.html">Contact</a> regularisation parameter which can lie between 1.0 and 1.1. Values greater than 1 can speed-up the convergence, but will also alter the stiffness of the contact interface, therefore it is not recommended to change this parameter   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-step_num</code>   </td><td class="markdownTableBodyNone">Number of steps used to achieve the specified load value (so-called load control). Note that multi-stepping can be particularly important to obtain a solution for highly nonlinear problems   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-alm_flag</code>   </td><td class="markdownTableBodyNone">Defines the choice of the algorithm: <code>0</code> (False) - Complementarity function approach, <code>1</code> (True) - Augmented Lagrangian method   </td><td class="markdownTableBodyNone"><code>0</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-convect</code>   </td><td class="markdownTableBodyNone">If set to <code>1</code> (True), moderate relative tangential displacements can be taken into account   </td><td class="markdownTableBodyNone"><code>0</code>   </td></tr>
</table>
<h2><a class="anchor" id="autotoc_md260"></a>
2. Running the contact simulation</h2>
<div class="fragment"><div class="line">mpirun -np 2 $HOME/mofem_install/um/build_release/mortar_contact/mortar_contact -file_name $file_name</div>
</div><!-- fragment --><h2><a class="anchor" id="autotoc_md261"></a>
3. Postprocessing</h2>
<p>First, the output <code>h5m</code> files need to be converted to <code>vtk</code> format. Note that these files can be converted one by one using the <code>mbconvert</code> tool: </p><div class="fragment"><div class="line">mbconvert out.h5m out.vtk</div>
<div class="line">mbconvert out_contact.h5m out_contact.vtk</div>
<div class="line">mbconvert out_mortar_contact_integ_pts.h5m out_mortar_contact_integ_pts.vtk</div>
</div><!-- fragment --><p> or all at once by using the multiprocessing script <code><a class="el" href="convert_8py.html">convert.py</a></code>: </p><div class="fragment"><div class="line">$HOME/mofem_install/um/build_release/tools/convert.py -np 2 out*</div>
</div><!-- fragment --><p> The obtained <code>vtk</code> files can be viewed in <em>Paraview</em>, in particular:</p>
<ul>
<li>File <code>out.vtk</code> contains the stress tensor components (tag <code>SPATIAL_POSITION_PIOLA1_STRESS</code>), as well as material coordinates (tag <code>MESH_NODE_POSITIONS</code>) and current coordinates (tag <code>SPATIAL_POSITION</code>), which can be used to compute the displacement field with the <em>Calculator</em> filter as <code>DISPLACEMENT=SPATIAL_POSITION-MESH_NODE_POSITIONS</code></li>
<li>File <code>out_contact.vtk</code> contains the nodal interpolation of the Lagrange multipliers equivalent to the contact pressure (tag <code>LAGMULT</code>)</li>
<li>File <code>out_mortar_contact_integ_pts.vtk</code> contains values of Lagrange multipliers (tag <code>LAGMULT</code>) and the normal gap (tag <code>GAP</code>) at Gauss points of the contact interface. Note that the <em>Point Gaussian</em> representation or alternatively the <em>Glyph</em> filter should be used for their visualisation in <em>Paraview</em>.</li>
</ul>
<h2><a class="anchor" id="autotoc_md262"></a>
4. Simulation with internal stress</h2>
<p>Simulation taking into account non-matching-meshes contact and internal stress is possible using executable <code>mortar_contact_thermal</code>. Furthermore, this program provides possibility to save the value of the internal stress and the corresponding actual stress on the input mesh for subsequent use in the fracture module.</p>
<p>Two options are available for the internal stress:</p>
<ul>
<li>internal stress caused by thermal expansion given by an analytical formula; by default the temperature is decreased by 1 degree compared to the initial one, however, this can be changed to a different formula, e.g. coordinate-dependant in the function <code>thermal_strain</code> in file <code><a class="el" href="mortar__contact__thermal_8cpp.html">mortar_contact_thermal.cpp</a></code></li>
<li>internal stress pre-computed such that its integration points values are saved on tags of the input mesh</li>
</ul>
<p>Two options are available for saving the internal and corresponding actual stress on the mesh:</p>
<ul>
<li>mean values of internal and actual stress saved on tags <code>MED_INTERNAL_STRESS</code> and <code>MED_ACTUAL_STRESS</code>, respectively</li>
<li>values of internal and actual stress at integration points saved using tags <code>INTERNAL_STRESS</code> and <code>ACTUAL_STRESS</code>, respectively</li>
</ul>
<p>In addition to outlined above parameters, the following parameters can be used with <code>mortar_contact_thermal</code>: </p><table class="markdownTable">
<tr class="markdownTableHead">
<th class="markdownTableHeadNone">Name   </th><th class="markdownTableHeadNone">Description   </th><th class="markdownTableHeadNone">Default value    </th></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-analytical_input</code>   </td><td class="markdownTableBodyNone">If set to <code>1</code> (True), compute internal stress using analytical formula for thermal strain, otherwise use pre-computed internal stress saved on tags of the input mesh   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-thermal_expansion_coef</code>   </td><td class="markdownTableBodyNone">Value of thermal expansion coefficient for computing thermal strain (used if <code>-analytical_input</code> is set to <code>1</code>)   </td><td class="markdownTableBodyNone"><code>1e-5</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-init_temp</code>   </td><td class="markdownTableBodyNone">Value of initial temperature for computing thermal strain (used if <code>-analytical_input</code> is set to <code>1</code>)   </td><td class="markdownTableBodyNone"><code>250.0</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-stress_tag_name</code>   </td><td class="markdownTableBodyNone">Tag name used when reading internal stress from the mesh (if <code>-analytical_input</code> is set to <code>0</code>)   </td><td class="markdownTableBodyNone"><code>INTERNAL_STRESS</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-save_mean_stress</code>   </td><td class="markdownTableBodyNone">If set to <code>1</code> (True), save mean values of internal and actual stress on the tags of the mesh, otherwise save integration point values of stresses   </td><td class="markdownTableBodyNone"><code>1</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-scale_factor</code>   </td><td class="markdownTableBodyNone">Scale for the internal stress   </td><td class="markdownTableBodyNone"><code>1.0</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-ignore_contact</code>   </td><td class="markdownTableBodyNone">If set to <code>1</code> (True), ignore contact   </td><td class="markdownTableBodyNone"><code>0</code>    </td></tr>
<tr class="markdownTableRowEven">
<td class="markdownTableBodyNone"><code>-ignore_pressure</code>   </td><td class="markdownTableBodyNone">If set to <code>1</code> (True), ignore pressure   </td><td class="markdownTableBodyNone"><code>0</code>    </td></tr>
<tr class="markdownTableRowOdd">
<td class="markdownTableBodyNone"><code>-output_mesh_file</code>   </td><td class="markdownTableBodyNone">Name of the file for writing the mesh with internal and actual stress saved on tags   </td><td class="markdownTableBodyNone"><code>0</code>   </td></tr>
</table>
<p><a class="el" href="struct_example.html" title="[Example]">Example</a> of running the simulation using the analytical thermal strain for the internal stress and saving the mean values of the internal and external stress on the mesh: </p><div class="fragment"><div class="line">mpirun -np 4 simple_contact_thermal \</div>
<div class="line">-file_name test.cub \</div>
<div class="line">-output_mesh_file med_stress.h5m \</div>
<div class="line">-analytical_input 1</div>
<div class="line">-thermal_expansion_coef 1e-3 \</div>
<div class="line">-init_temp 250. \</div>
<div class="line">-save_mean_stress 1 \</div>
<div class="line">-scale_factor 1 \</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.8.13-->
<!-- start footer part -->
<hr cla ss="footer" />
<style>
  img[src="UoGLogo.png"] {
    height: 20px;
    padding-top: 0px;
    padding-right: 1px;
    padding-bottom: 3px;
    padding-left: 6px;
  }
</style>
<address class="footer">
  <small>
    Generated by
    <a href="http://www.doxygen.org/index.html"> Doxygen </a> 1.12.0
    and hosted at
    <a href="http://www.gla.ac.uk/schools/engineering/">
      <img class="footer" src="UoGLogo.png" alt="University of Glasgow" />
    </a>
  </small>
</address>
</body>
</html>
